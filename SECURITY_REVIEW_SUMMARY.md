# 审查结果分析

## 概览
本次安全审查聚焦于部署包内可用的工件，识别出了 6 项高风险问题和若干补充观察项。由于大量源码（如 `mcp-index` 与 `user-center` 模块）仅以 Git LFS 指针形式存在，审查结论主要基于已解压的部署文件。【F:大数据基座/数字政府张掖市大数据平台基座项目源代码/mcp-index-对接门户代码.zip†L1-L3】【F:大数据基座/数字政府张掖市大数据平台基座项目源代码/user-center.zip†L1-L3】

## 高风险问题分解
| 编号 | 问题 | 风险要点 | 立即措施 | 长期治理建议 |
| --- | --- | --- | --- | --- |
| 1 | 明文数据库 root 凭据 | 任何获得部署包的人都可使用 `root/Infra5@Gep0int` 获取数据库完全控制权，破坏或窃取数据。【F:大数据基座/部署包/DCockpit.war/WEB-INF/classes/jdbc.properties†L1-L45】 | 立刻停用暴露密码，启用新账号并限制权限。 | 建立密钥管理流程，应用端使用最小权限账户并通过环境注入配置。 |
| 2 | 内置 RSA 私钥 | 部署包附带完整密钥对，使攻击者可冒充服务或解密加密流量。【F:大数据基座/部署包/DCockpit.war/WEB-INF/__RSA_PAIR.txt†L1-L23】【F:大数据基座/部署包/dxpmanager/WEB-INF/__RSA_PAIR.txt†L1-L23】 | 撤换相关证书与密钥，阻止旧密钥继续使用。 | 将密钥存放于受控密钥库，运行时加载，不随制品分发。 |
| 3 | CORS 任意源且携带凭据 | `cors.allowOrigin=*` 且允许凭据，攻击者可借助浏览器发起跨站伪造或窃取敏感数据。【F:大数据基座/部署包/DCockpit.war/WEB-INF/web.xml†L41-L90】 | 临时关闭凭据支持或限制可信域名。 | 使用配置中心维护白名单，并引入自动化测试避免回归。 |
| 4 | Druid 监控未鉴权且可重置 | `/druid/*` 暴露重置接口，无登录控制，可泄露 SQL 并导致拒绝服务。【F:大数据基座/部署包/DCockpit.war/WEB-INF/web.xml†L160-L212】 | 在所有环境关闭或限制访问并监控异常重置操作。 | 将运维监控与业务分离，采用 VPN/堡垒机访问并加固鉴权。 |
| 5 | 诊断 servlet 使用默认 `admin/admin` | `/autocheck/*` 任何人可登录，可能访问配置、环境信息甚至执行命令。【F:大数据基座/部署包/DCockpit.war/WEB-INF/web.xml†L308-L417】 | 禁用该 servlet 或立即更换强口令并限制来源 IP。 | 定期安全审计诊断接口，建立上线前检查表，禁止默认凭据。 |
| 6 | RabbitMQ 与调度密钥硬编码 | `epoint/epoint`、`p@ssw0rd` 与 `xxl-job` token 暴露，攻击者可消费/伪造消息或执行恶意任务。【F:大数据基座/部署包/dxpmanager/WEB-INF/classes/spring/appcontext-rabbitmq.xml†L1-L93】【F:大数据基座/部署包/dxpmanager/WEB-INF/classes/application.properties†L1-L66】 | 旋转 RabbitMQ、XXL-JOB 等凭据，并监控异常连接。 | 采用集中密钥服务、按环境隔离账户权限，推行凭据生命周期管理。 |

## 补充观察
* 单点登录客户端仍使用占位密钥 `admin`，可能被伪造客户端滥用。【F:大数据基座/部署包/DCockpit.war/WEB-INF/classes/EpointSSOClient.properties†L1-L152】
* 多个配置文件保留注释示例凭据，应在版本库中剔除真实密码，避免误启用。

## 风险优先级与依赖
1. **凭据泄露问题（编号 1、5、6）**：与现网资产直接相关，优先旋转密码并审计访问日志。
2. **敏感密钥（编号 2）**：立即废止旧密钥并部署新密钥；部署需与证书管理、设备同步。
3. **管理与跨域暴露（编号 3、4）**：需要前端/运维配合调整 CORS 和监控访问策略。
4. **补充项**：随着凭据与接口加固，同步梳理资产并建立上线扫描。

## 建议的行动路线
1. 组建应急响应小组，明确数据库、消息中间件、SSO 等责任人，24 小时内完成凭据更换。
2. 进行全量资产排查，确保部署目录、CI/CD 制品和备份中不再包含私钥与明文密码。
3. 制定密钥/配置管理规范，引入环境变量或秘密管理服务（如 Vault、KMS）。
4. 建立自动化安全基线检查，在构建阶段扫描制品中是否存在密钥或默认密码。
5. 完成 LFS 模块的拉取并开展二次安全审查，覆盖尚未评估的代码面。
