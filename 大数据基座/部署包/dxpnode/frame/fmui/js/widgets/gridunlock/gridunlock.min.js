!function(t,o){"use strict";function e(t){var r=this,i=[{key:t.container,value:"请传入canvas元素id"}];r.environment(i),r.container=o.selector(t.container),console.log(r),r=o.extend({},n,t,r),r.__proto__=e.prototype;var l=r.container,a=l.getContext("2d");l.width=r.cw,l.height=r.ch,r.offsetTop=l.offsetTop;var c=(r.cw-2*r.offsetX-2*r.r*3)/2,f=(r.ch-2*r.offsetY-2*r.r*3)/2;r.pointArr=r._drawLocalPoint(c,f),r._initListeners(l,a,t.itemClick),r._draw(r.pointArr,[],null,a)}var n={r:26,cw:t.body.offsetWidth,ch:320,offsetX:15,offsetY:15,outRoundBorderColor:"#666",lineWidth:"7",lineColor:"#f00",outRoundColor:"#fff",innerRoundColor:"#008080",itemClick:function(t){}};e.prototype={_drawLocalPoint:function(t,o){for(var e=[],n=this,r=n.offsetX,i=n.offsetY,l=n.r,a=0;a<3;a++)for(var c=0;c<3;c++){var f={x:r+c*t+(2*c+1)*l,y:i+a*o+(2*a+1)*l};e.push(f)}return e},environment:function(t){for(var o=0,e=t.length;o<e;o++)if(!t[o].key)throw new Error(t[o].value)},_initListeners:function(t,o,e){var n=[],r=this;t.addEventListener("touchstart",function(t){r._selectPoint(t.touches[0],n)}),t.addEventListener("touchmove",function(t){t.preventDefault();var e=t.touches[0];r._selectPoint(e,n),o.clearRect(0,0,r.cw,r.ch),r._draw(r.pointArr,n,{x:e.pageX,y:e.pageY-r.offsetTop},o)}),t.addEventListener("touchend",function(t){o.clearRect(0,0,r.cw,r.ch),r._draw(r.pointArr,n,null,o),e.call(r,n),n=[]})},_selectPoint:function(t,o){for(var e=this.pointArr,n=0,r=e.length;n<r;n++){var i=e[n],l=Math.abs(i.x-t.pageX),a=Math.abs(i.y-(t.pageY-this.offsetTop)),c=Math.pow(l*l+a*a,.5);if(c<this.r){o.indexOf(n)<0&&o.push(n);break}}},_draw:function(t,o,e,n){var r=this,i=r.r,l=2*Math.PI;if(o.length>0){n.beginPath();for(var a=0,c=o.length;a<c;a++){var f=o[a];n.lineTo(t[f].x,t[f].y)}if(n.lineWidth=r.lineWidth,n.strokeStyle=r.lineColor,n.stroke(),n.closePath(),null!=e){var s=o[o.length-1],h=t[s];n.beginPath(),n.moveTo(h.x,h.y),n.lineTo(e.x,e.y),n.stroke(),n.closePath()}}for(var a=0,c=t.length;a<c;a++){var u=t[a];n.fillStyle=r.outRoundBorderColor,n.beginPath(),n.arc(u.x,u.y,i,0,l,!0),n.closePath(),n.fill(),n.fillStyle=r.outRoundColor,n.beginPath(),n.arc(u.x,u.y,i-3,0,l,!0),n.closePath(),n.fill(),o.indexOf(a)>=0&&(n.fillStyle=r.innerRoundColor,n.beginPath(),n.arc(u.x,u.y,i-16,0,l,!0),n.closePath(),n.fill())}}},window.GridUnlock=e}(document,window.Util);