"use strict";Util.loadJs(["pages/common/common.js"],function(){customBiz.configReady()});var customBiz={configReady:function(){var e=this;Config.configReady(null,function(){e.initListeners()},function(e){})},initListeners:function(){var e=this;mui(".mui-content").on("tap",".version-more-btn",function(){var e=this.parentNode.querySelector(".version-update-bottom"),t=e.querySelector(".version-update-content").getAttribute("height");this.classList.contains("rotate0")?(this.classList.add("rotate180"),this.classList.remove("rotate0"),e.style.height=t,e.style.maxHeight=t,e.querySelector(".version-update-content").style.webkitLineClamp="initial"):(this.classList.remove("rotate180"),this.classList.add("rotate0"),e.style.height="82px",e.querySelector(".version-update-content").style.webkitLineClamp=4)}),e.getList()},getList:function(){var e=this;ejs.ui.showWaiting("正在加载..."),Promise.all([new Promise(function(e,t){ejs.runtime.getAppKey({success:function(t){e(t.appKey)},error:function(e){t(e)}})}),new Promise(function(e,t){ejs.runtime.getPlatformUrl({success:function(t){e(t.platformUrl)},error:function(e){t(e)}})})]).then(function(t){var i={appguid:t[0],platform:Util.os.ios?6:5};common.ajax({url:"getupdatelist",data:i,isShowWaiting:!1,isEncrypt:!1,clientId:t[0]},function(t){if(ejs.ui.closeWaiting(),1===t.status.code){var i=t.custom,n="",o=document.getElementById("template").innerHTML;mui.each(i,function(e,t){t.createdate=DateUtil.getDate(t.createdate,"yyyy-mm-dd"),null===t.message&&(t.message="无更新说明"),n+=Mustache.render(o,t)}),document.getElementById("listdata").innerHTML=n;for(var s=document.querySelectorAll(".version-update-frame"),r=0;r<s.length;r++){var a=e.getStyle(s[r].querySelector(".version-update-content"),"height"),u=parseInt(a.substr(0,a.length-2),10);s[r].querySelector(".version-update-content").setAttribute("height",a),u>84?(s[r].querySelector(".version-more-btn").classList.remove("mui-hidden"),s[r].querySelector(".version-update-bottom").style.height="84px",s[r].querySelector(".version-update-content").style.webkitLineClamp="4",s[r].querySelector(".version-update-bottom").style.padding="0 10% 0 4%"):(s[r].querySelector(".version-more-btn").classList.add("mui-hidden"),s[r].querySelector(".version-update-bottom").style.height=a,s[r].querySelector(".version-update-bottom").style.padding="0 4%")}}else ejs.ui.toast(t.status.text)},function(e){ejs.ui.closeWaiting(),ejs.ui.toast(Config.TIPS_II)},{isDebug:!1})})["catch"](function(e){ejs.ui.toast(e)})},getStyle:function(e,t){return window.getComputedStyle?window.getComputedStyle(e)[t]:e.currentStyle[t]}};