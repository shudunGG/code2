!function(o,t){"use strict";function n(o){if(!o.container)throw new Error("请传入地图容器元素");window._addrFrameCallback=this._addrFrameCallback.bind(this),o.container=this.getHTMLElement(o.container),this.extend(o,i),this.toast=Util.ejs.ui.toast,this.options=o,this._initializationGeo(o)}var i={container:"#amap",map:{resizeEnable:!0},geolocation:{enableHighAccuracy:!0,timeout:1e4,buttonOffset:new o.Pixel(10,20),zoomToAccuracy:!0,buttonPosition:"RB"},radius:1e3};n.prototype={_initializationGeo:function(t){var n,i,e=this;n=new o.Map(t.container,t.map),n.plugin("AMap.Geolocation",function(){i=new o.Geolocation(t.geolocation),n.addControl(i),i.getCurrentPosition(),o.event.addListener(i,"complete",e._onComplete.bind(e)),o.event.addListener(i,"error",e._onError.bind(e))})},_onComplete:function(o){this.position=o.position,this._coordConvert(this.position),o.position=this.position,this.options.onComplete&&this.options.onComplete.call(this,o)},_onError:function(o){this.toast("定位失败"),this.options.onError&&this.options.onError.call(this,o)},_coordConvert:function(o){var n=o.lng,i=o.lat,e=new t.Point(n,i),a=new t.Convertor,r=[],s=this;r.push(e),a.translate(r,3,5,function(t){var n=t.points[0];o.lng=n.lng,o.lat=n.lat,s.searchQuery(o.lng,o.lat)})},searchQuery:function(o,t){var n=document.createElement("script");n.src="http://api.map.baidu.com/geocoder/v2/?callback=_addrFrameCallback&location="+t+","+o+"&output=json&pois=1&ak=K5LXDCfHLnGvLDQsZx0AKyXNV5kLObYF&radius="+this.options.radius,document.body.appendChild(n)},_addrFrameCallback:function(o){this.options.poiCallback&&this.options.poiCallback.call(this,o.result||{})},getHTMLElement:function(o){return o?"string"==typeof o?document.querySelector(o):o:void console.error("请传入要获取的 dom 元素")},extend:function(){for(var o=[].slice.call(arguments),t=o[0],n=1,i=o.length;n<i;n++){var e=o[n];for(var a in e)void 0===t[a]&&(t[a]=e[a])}}},window.AMAP=n}(window.AMap,window.BMap);