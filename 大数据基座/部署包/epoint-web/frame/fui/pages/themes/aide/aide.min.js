/*
 * @Author: chends
 * @Date: 2018-08-19 09:15:52
 * @LastEditors: jjj
 * @LastEditTime: 2018-09-12 19:05:20
 * @Description: 
 */

// 全局变量处理
(function(win,$){win._aideEvent_=new Util.UserEvent;var $coverContainer=$("#cover-wrap");if(Util.browsers.isIE&&window.hasObjectTag)win.createMainContentCover=function(){var iframe=document.createElement("iframe");iframe.width="100%";iframe.height="100%";iframe.scrolling="no";iframe.frameBorder=0;iframe.style.background="transparent";iframe.src="../../activexcover/activexcover.html";var $cover=$('\x3cdiv class\x3d"main-content-cover hidden"\x3e\x3c/div\x3e');return $cover.append(iframe).appendTo($coverContainer)};else win.createMainContentCover=function(){var $cover=$('\x3cdiv class\x3d"main-content-cover hidden"\x3e\x3c/div\x3e');return $cover.appendTo($coverContainer)};win._getData_=function(method,params){return Util.ajax({url:epoint.dealRestfulUrl(getDataUrl+"/"+method),data:params})};var $main=$("#main");win.dealLinkOpen=function(linkData,needLeft){linkData.url=Util.addHtmlToUrl(linkData.url);switch(linkData.openType){case "tabsnav":!needLeft&&$main.addClass("left-none");TabsNav.addTab(linkData);break;case "dialog":epoint.openTopDialog(linkData.name,Util.getRightUrl(linkData.url));break;case "blank":var _id=linkData.id?(linkData.id+"").replace(/-/g,""):"";win.open(Util.getRightUrl(linkData.url),_id);break;default:break}};win._ANIMATION_TIME_={slide:200};win.useWebsocket=Util.getFrameSysParam("useWebsocket")===true;win.eWebSocket=undefined;win.creatWebSocket=function(uid,uname,callback){if(eWebSocket){callback&&callback();return}var cfg=win.EWebSocketConfig?win.EWebSocketConfig:{url:EmsgConfig.websocketUrl};cfg.uid=uid;cfg.uname=uname;if(win.EWebSocket){eWebSocket=new EWebSocket(cfg);callback&&callback();_aideEvent_.fire("websocketCreated")}else Util.loadJs("frame/fui/js/widgets/ewebsocket/ewebsocket.js",function(){eWebSocket=new EWebSocket(cfg);callback&&callback();_aideEvent_.fire("websocketCreated")})};win.randomColor=function(index){var colors=["#3391e5","#58cece","#f16caa","#7d9459","#298aae","#58cece","#ffce3d","#fe5d58","#3391e5","#f16caa"];return colors[index%10]};win.$activeLeftMenu=null;var tabsCache={};win.tab2leftManage=function(){function cache(id,$target,$wrap){tabsCache[id]={$target:$target,$wrap:$wrap}}function deCache(id){if(id)tabsCache[id]=null;else tabsCache={}}function click(id){var it=tabsCache[id];if(!it||!it.$wrap)return $main.addClass("left-none");$activeLeftMenu=it.$wrap;$main.removeClass("left-none");it.$wrap.removeClass("hidden").siblings().addClass("hidden");it.$wrap.find(".left-menu-link.active").removeClass("active");if(it.$target){it.$target.addClass("active");openTarget(it.$target)}}function openTarget($target){var $items=$target.parents(".left-menu-item");var l=$items.length;doOpen($items,l)}function doOpen($items,len){if(len<0)return;var $item=$items.eq(len-1);var $sub=$item.find(".left-menu-sub-list:eq(0)");if($item.find("\x3e.left-menu-link").data("hassub"))$item.addClass("opened");$sub.stop(true).slideDown(_ANIMATION_TIME_.slide,function(){slideDownCb.call(this);doOpen($items,--len)});$item.siblings(".opened").removeClass("opened").find(".left-menu-sub-list:eq(0)").stop(true).slideUp(_ANIMATION_TIME_.slide,slideUpCb)}return{cache:cache,deCache:deCache,click:click}}();win.slideDownCb=function(){$(this).attr("style","display: block;")};win.slideUpCb=function(){$(this).attr("style","display: none;")};win.showEXun=true;win._msgcenterConfig_=win.MsgCenterConfig||{}})(this,jQuery);(function(win,$){var tabWidth=function(){var $tab=$('\x3cli class\x3d"tabsnav-tabs-item"\x3e\x3c/li\x3e');var $tab2=$tab.clone(false);var $list=$('\x3cul class\x3d"hidden-accessible"\x3e\x3c/ul\x3e').append($tab,$tab2).appendTo("body");var w=$tab2.outerWidth(true);$list.empty().remove();$list=$tab=$tab2=null;return w||115}();if(Object.prototype.toString.call(win.EpTabsNav)==="[object Function]"){window.TabsNav=new EpTabsNav({ifrContainer:"#main-ifr-wrap",tabContainer:"#footer",needScrollBtn:true,scrollBtnSite:"sides",smoothItems:3,needQuickNav:true,position:"bottom",tabWidth:tabWidth});TabsNav._$pageCover=createMainContentCover();TabsNav.onTabActive=function(id){if(!id)return;id=id.substr(4);var $tab=$("#tab-"+id);if(!$tab.length)return;tab2leftManage.click(id)}}else console.error('The TabsNav is required! , please add the "frame/fui/js/widgets/tabsnav/tabsnav.js" before theme\'s javascript file')})(this,jQuery);(function(win,$){var $logo=$("#sys-logo-img"),$userInfo=$("#user-info"),$userPortrait=$(".user-portrait",$userInfo);var $cover=createMainContentCover();function hideUserPanel(){$userInfo.removeClass("active");$cover.addClass("hidden")}$userInfo.on("click",".user-info-summary",function(){if(!$userInfo.hasClass("active")){$userInfo.addClass("active");$cover.removeClass("hidden")}else hideUserPanel()}).on("click",".user-action-item",function(){var $this=$(this);if($this.hasClass("person-info"))dealLinkOpen({id:this.getAttribute("data-id"),name:this.getAttribute("data-name"),url:this.getAttribute("data-url"),openType:"tabsnav"});else if($this.hasClass("logout"))mini.confirm("\u60a8\u786e\u5b9a\u8981\u9000\u51fa\u7cfb\u7edf\u5417\uff1f","\u7cfb\u7edf\u63d0\u793a",function(action){if(action=="ok"){eWebSocket&&eWebSocket.close();UserSettings.logout()}});else if($this.hasClass("role-change"))UserSettings.changeRole(_userGuid_);else{var openType=$this.data("opentype"),id=$this.data("id"),url=$this.attr("url"),name=$this.text(),script=$this.attr("script");if(!id){id=Util.uuid();$this.data("id",id).attr("data-id",id)}if(url)dealLinkOpen({id:id,openType:openType,name:name,url:url});else if(script)try{eval(script)}catch(error){console.error(error)}}$userInfo.removeClass("active");$cover.addClass("hidden")});$("body").on("click",function(e){if(!$(e.target).closest("#user-info").length)hideUserPanel()});_getData_("getUserInfo").done(function(data){win._userName_=data.name;win._userGuid_=data.guid;$.extend(win._msgcenterConfig_,{isMsgCenterMaxSize:data.isMsgCenterMaxSize||false,msgCenterOrder:data.msgCenterOrder||"asc",hideCallback:function(){$cover.addClass("hidden")}});if(useWebsocket)creatWebSocket(_userGuid_,_userName_);if(data.portrait){var url=Util.getRightUrl(epoint.dealRestfulUrl(data.portrait));$userPortrait.attr("src",url)}if(data.hasParttime){$userInfo.find(".user-action-item.role-change").removeClass("hidden");if(data.isOpenDefaultOU)UserSettings.changeRole(_userGuid_)}var $userInfoDetail=$("#user-info-detail");$userInfoDetail.find(".user-name").text(data.name).attr("title",data.name);$userInfoDetail.find(".user-dept").text(data.ouName).attr("title",data.ouName)});_getData_("getPageInfo").done(function(data){if(data.logo)$logo.attr("src",Util.getRightUrl(data.logo));if(data.title){document.title=data.title;win.systemTitle=data.title}if(data.fullSearchUrl)win._fullSearchUrl_=data.fullSearchUrl;if(data.showEXun===false)win.showEXun=false;initPortal(data.homes,data.defaultHome);_aideEvent_.fire("afterPageInfo")});$(win).on("message",function(e){try{var data=JSON.parse(e.originalEvent.data);if(data.type==="userPortraitChange")$userPortrait.attr("src",data.imgData)}catch(error){}});var EXT_TAB_TPL='\x3cli class\x3d"user-action-item" title\x3d"{{name}}" url\x3d"{{url}}" data-opentype\x3d"{{openType}}" script\x3d"{{script}}"\x3e\x3cspan class\x3d"{{icon}}"\x3e\x3c/span\x3e{{name}}\x3c/li\x3e';_getData_("getExtTabsInfo").done(function(data){if(data&&data.length){var html="";$.each(data,function(i,item){item.icon=item.icon||"modicon-8";if(/^icon-/.test(item.icon))item.icon="action-icon "+item.icon;html+=Mustache.render(EXT_TAB_TPL,item)});$(html).insertAfter("#person-info-setting")}})})(this,jQuery);(function(win,$){var $main=$("#main");var PORTAL_ITEM_TPL='\x3cli class\x3d"top-portal-item" data-id\x3d"{{code}}" data-url\x3d"{{url}}" data-opentype\x3d"{{openType}}" title\x3d"{{name}}"\x3e\x3cspan class\x3d"top-portal-icon {{icon}}"\x3e\x3c/span\x3e\x3cspan class\x3d"top-portal-name"\x3e{{name}}\x3c/span\x3e\x3c/li\x3e';function initPortal(homes,defaultHome){var home={closeIcon:false,refresh:true};var signleHomes=[];for(var i=0;i<homes.length;i++){var cate=homes[i];var finded=false;if(cate.items!=undefined)!finded&&$.each(cate.items,function(j,item){if(defaultHome){if(item.code==defaultHome){home.id=item.code||"home";home.url=item.url;home.name=item.name;finded=true;return false}}else if(item.openType=="tabsnav"){home.id=item.code||"home";home.url=item.url;home.name=item.name;finded=true;return false}});else{if(!finded)if(defaultHome){if(cate.code==defaultHome){home.id=cate.code||"home";home.url=cate.url;home.name=cate.name;finded=true}}else if(cate.openType=="tabsnav"){home.id=cate.code||"home";home.url=cate.url;home.name=cate.name;finded=true}signleHomes=signleHomes.concat(homes.splice(i,1));i--}}initview(signleHomes,homes);initEvent(home);TabsNav.addTab(home)}function initEvent(defaultHome){var $portal=$("#top-portal-container");var $cover=createMainContentCover();var leaveTimer,enterTimer;$portal.on("click",".top-portal-header",function(){TabsNav.addTab(defaultHome)}).on("click",".top-portal-btn",function(){toggleProtal(!$portal.hasClass("active"))}).on("click",".top-portal-item",function(){dealLinkOpen({url:this.getAttribute("data-url"),name:this.title,openType:this.getAttribute("data-opentype"),id:this.getAttribute("data-id")});toggleProtal(false)}).on("click",".top-portal-cate",function(){var $block=$(this).parent();$block.toggleClass("collapse")});function toggleProtal(show){if(show){$portal.addClass("active");$cover.removeClass("hidden");return}$portal.removeClass("active");$cover.addClass("hidden")}$("body").on("click",function(ev){if(!$(ev.target).closest($portal).length)toggleProtal(false)});var timer,$portalPanel=$portal.find(".top-portal");$(win).on("resize",function(){clearTimeout(timer);timer=setTimeout(function(){var h=$main.height()-50;h>0&&$portalPanel.css("max-height",h)},17)}).trigger("resize")}function initview(signleHomes,homes){var html=[];if(signleHomes){html.push('\x3cul class\x3d"top-portal-list"\x3e');$.each(signleHomes,function(i,item){item.icon=item.icon||"default-modicon";html.push(Mustache.render(PORTAL_ITEM_TPL,item))});html.push("\x3c/ul\x3e")}$.each(homes,function(i,cate){html.push('\x3cdiv class\x3d"top-portal-block"\x3e\x3ch3 class\x3d"top-portal-cate"\x3e'+cate.name+'\x3cspan class\x3d"top-portal-cate-trigger"\x3e\x3c/span\x3e\x3c/h3\x3e\x3cul class\x3d"top-portal-list" style\x3d"max-height:'+30*cate.items.length+'px"\x3e');$.each(cate.items,function(j,item){item.icon=item.icon||"default-modicon";html.push(Mustache.render(PORTAL_ITEM_TPL,item))});html.push("\x3c/ul\x3e\x3c/div\x3e")});$(html.join("")).appendTo("#top-portal-content")}win.initPortal=initPortal})(this,jQuery);(function(win,$){var $main=$("#main");var $cover=createMainContentCover();var $header=$("#header");var $menuPanel=$("#top-menu-panel");var $menuTrigger=$(".header-menu-btn",$header);$header.on("click",".header-menu-btn",function(){toggleMenuPanel(!$(this).hasClass("active"))});function toggleMenuPanel(show){if(show){$cover.removeClass("hidden");$menuTrigger.addClass("active");$menuPanel.addClass("active")}else{$menuTrigger.removeClass("active");$menuPanel.removeClass("active");$cover.addClass("hidden");if($topMenuList.hasClass("in-sort"))epoint.showTips("\u60a8\u7684\u5e94\u7528\u6392\u5e8f\u5c1a\u672a\u4fdd\u5b58\uff0c\u8bf7\u53ca\u65f6\u91cd\u65b0\u6253\u5f00\u8fdb\u884c\u4fdd\u5b58\uff01",{state:"warning"})}}$("body").on("click",function(e){var $target=$(e.target);if(!$menuPanel.hasClass("active"))return;if(!$target.closest($menuTrigger).length&&!$target.closest($menuPanel).length&&!$target.closest(".mini-panel-header").length)toggleMenuPanel(false)});var TOP_MENU_ITEM_TPL='\x3cli class\x3d"top-menu-item l {{#isActived}}active{{/isActived}}" data-id\x3d"{{code}}" data-url\x3d"{{url}}" data-opentype\x3d"{{openType}}" data-hassub\x3d"{{hasSub}}" title\x3d"{{name}}"\x3e\x3cspan class\x3d"top-menu-icon {{icon}}" style\x3d"background:{{bg}};"\x3e\x3c/span\x3e\x3cspan class\x3d"topmenu-text"\x3e{{name}}\x3c/span\x3e\x3c/li\x3e';var $topMenuList=$("#top-menu-list");$topMenuList.on("click",".top-menu-item",function(){if($topMenuList.hasClass("in-sort"))return;var $this=$(this),url=$this.data("url"),name=this.getAttribute("title")||this.innerText,openType=$this.data("opentype"),hasSub=$this.data("hassub");$this.addClass("active").siblings().removeClass("active");if(hasSub){$main.removeClass("left-none");getLeftMenu({code:this.getAttribute("data-id"),name:this.getAttribute("title")||this.innerText,url:url,openType:openType},true)}else $main.addClass("left-none");if(url)dealLinkOpen({openType:openType,name:name,id:$this.data("id"),url:url},true);toggleMenuPanel(false)});function getTopMenu(){_getData_("getMenu",{query:"top"}).done(function(data){if(!data||!data.items)return;var defaultCode=data.code,defaultMenu={},hasSub;if(defaultCode)$.each(data.items,function(i,item){if(item.code==defaultCode){item.isActived=true;defaultMenu=item;hasSub=item.hasSub;return false}});else{data.items[0].isActived=true;defaultMenu=data.items[0];hasSub=data.items[0].hasSub}if(Util.browsers.isIE8)toggleMenuPanel(true);$(render(data.items,TOP_MENU_ITEM_TPL)).appendTo($topMenuList);if(Util.browsers.isIE8)toggleMenuPanel(false);_aideEvent_.fire("topMenuLoad");$main.addClass("left-none")})}function render(data,tpl){var html=[];$.each(data,function(i,item){item.icon=item.icon||"modicon-1";item.bg=item.iconBackColor||randomColor(i);html.push(Mustache.render(tpl,item))});return html.join("")}getTopMenu();var QUICK_MENU_ITEM_TPL='\x3cli class\x3d"quick-menu-item l" data-id\x3d"{{code}}" data-url\x3d"{{url}}" data-opentype\x3d"{{openType}}" title\x3d"{{name}}"\x3e\x3cspan class\x3d"top-menu-icon {{icon}}" style\x3d"background:{{bg}};"\x3e\x3c/span\x3e\x3cspan class\x3d"topmenu-text"\x3e{{name}}\x3c/span\x3e\x3c/li\x3e';var $quickMenuList=$("#quick-menu-list");$quickMenuList.on("click",".quick-menu-item",function(){var $this=$(this),url=$this.data("url"),name=this.getAttribute("title")||this.innerText,openType=$this.data("opentype");url&&dealLinkOpen({openType:openType,name:name,id:$this.data("id"),url:url});toggleMenuPanel(false)});function renderQuickMenu(){return _getData_("getQuickMenu",{showNum:10}).done(function(data){if(!data||!data.length)return;if(Util.browsers.isIE8)toggleMenuPanel(true);$(render(data,QUICK_MENU_ITEM_TPL)).appendTo($quickMenuList.empty());if(Util.browsers.isIE8)toggleMenuPanel(false)})}renderQuickMenu();var quickMenuSettingUrl="frame/fui/pages/quickmenusetting/quickmenusetting"+(/proto\.html/.test(location.pathname)?".proto.html":"");$menuPanel.on("click",".quick-menu-btn",function(){var opt={width:820,height:500};var win_size=Util.getWinSize();if(win_size.height<opt.height)opt.height=win_size.height;if(win_size.width<opt.width)opt.width=win_size.width;epoint.openTopDialog("\u5e38\u7528\u83dc\u5355\u914d\u7f6e",quickMenuSettingUrl,function(isChanged){if(isChanged===true)renderQuickMenu()},opt)})})(this,jQuery);(function(win,$){if(!Util.getFrameSysParam("enableCustomSort"))return;var timer;var saveAjax;var oldSorts;var $topMenuList=$("#top-menu-list");var $btns=$("#top-menu-btns");$btns.find(".start").removeClass("hidden");$topMenuList.sortable({revert:200,delay:300,distance:30,forcePlaceholderSize:true,containment:"parent",disabled:true,tolerance:"pointer",update:function(){},stop:function(){},sort:function(){},start:function(){}});$btns.on("click",".start",function(){sortHandle(true);mini.showTips({content:"\u62d6\u52a8\u83dc\u5355\u8fdb\u884c\u6392\u5e8f\u8c03\u6574\uff0c\u5b8c\u6210\u540e\u70b9\u51fb\u4fdd\u5b58",state:"info",x:"center",y:"center"})}).on("click",".save",function(){var data=getSort();if(data.join("")!==oldSorts.join(""))_save(getSort()).always(function(){sortHandle(false)});else sortHandle(false)}).on("click",".cancel",function(){sortHandle(false);var $children=$topMenuList.children().remove();$.each(oldSorts,function(i,id){$children.filter('[data-id\x3d"'+id+'"]').appendTo($topMenuList)})});function sortHandle(active){if(active){$topMenuList.addClass("in-sort");$topMenuList.sortable("enable");$btns.find(".start").addClass("hidden").siblings().removeClass("hidden")}else{$topMenuList.sortable("disable");$topMenuList.removeClass("in-sort");$btns.find(".start").removeClass("hidden").siblings().addClass("hidden")}}function getSort(){return $topMenuList.sortable("toArray",{attribute:"data-id"})}_aideEvent_.on("topMenuLoad",function(){oldSorts=getSort()});function dealSave(){clearTimeout(timer);timer=setTimeout(save,1*1E3)}function _save(data){return Util.ajax({url:topMenuSaveUrl,data:{sort:JSON.stringify(data)}}).done(function(){mini.showTips({content:"\u4fdd\u5b58\u6210\u529f",state:"success",x:"center",y:"center",timeout:3E3});oldSorts=getSort()})}function save(){if(saveAjax)try{saveAjax.abort()}catch(error){}var data=getSort();if(data.join("")!==oldSorts.join(""))saveAjax=_save(data);else mini.showTips({content:"\u6392\u5e8f\u672a\u66f4\u6539",state:"info",x:"center",y:"center",timeout:3E3});$topMenuList.removeClass("in-sort")}})(this,jQuery);(function(win,$){var leftMenuStatus={};var $main=$("#main"),$leftMenu=$("#left-menu"),$leftMenuContainer=$leftMenu;var LEFT_MENU_ITEM_TPL='\x3cli class\x3d"left-menu-item {{level}}"\x3e\x3ca href\x3d"javascript:void(0);" data-url\x3d"{{url}}" data-rowkey\x3d"{{rowkey}}" data-id\x3d"{{code}}" title\x3d"{{name}}" data-openType\x3d"{{openType}}" data-hasSub\x3d"{{hasSub}}" class\x3d"left-menu-link"style\x3d"padding-left: {{indent}}px;"\x3e{{#isTop}}\x3ci class\x3d"left-menu-icon {{icon}} " style\x3d"background:{{bg}};"\x3e\x3c/i\x3e{{/isTop}}\x3cspan class\x3d"left-menu-name"\x3e{{name}}\x3c/span\x3e{{#hasSub}}\x3ci class\x3d"left-menu-trigger"\x3e\x3c/i\x3e{{/hasSub}}\x3c/a\x3e{{#hasSub}}{{#isTop}}\x3cdiv class\x3d"left-menu-sub"\x3e\x3cdiv class\x3d"left-menu-sub-inner"\x3e\x3cdiv class\x3d"left-menu-sub-header"\x3e\x3cspan class\x3d"left-menu-sub-title"\x3e{{name}}\x3c/span\x3e\x3c/div\x3e{{/isTop}}\x3cul class\x3d"left-menu-sub-list" style\x3d"display:none;"\x3e {{{subMenu}}}\x3c/ul\x3e{{#isTop}}\x3c/div\x3e\x3c/div\x3e{{/isTop}}{{/hasSub}}\x3c/li\x3e';var LEFT_MENU_TPL='\x3cdiv class\x3d"left-menu-wrap" id\x3d"left-menu-{{code}}"\x3e\x3cdiv class\x3d"left-menu-header"\x3e{{name}}\x3c/div\x3e\x3cul class\x3d"left-menu-list"\x3e{{{leftMenuItems}}}\x3c/ul\x3e\x3c/div\x3e';function initEvent(){$leftMenu.on("click",".left-menu-link",function(){var $this=$(this),$item=$this.parent(),isTop=$item.hasClass("level-1"),hasSub=$this.data("hassub"),linkData={url:$this.data("url"),openType:$this.data("opentype"),name:this.title,id:$this.data("id")};if(hasSub){var $sub=isTop?$this.next().find(".left-menu-sub-list:eq(0)"):$this.next();if(!$item.hasClass("opened")){$item.addClass("opened");$sub.stop(true).slideDown(_ANIMATION_TIME_.slide,slideDownCb);$item.siblings(".opened").removeClass("opened").find(".left-menu-sub-list:eq(0)").stop(true).slideUp(_ANIMATION_TIME_.slide,slideUpCb)}else{$item.removeClass("opened");$sub.stop(true).slideUp(_ANIMATION_TIME_.slide,slideUpCb)}}if(linkData.url){$activeLeftMenu.find(".left-menu-link.active").removeClass("active");$this.addClass("active");if(linkData.openType=="tabsnav")tab2leftManage.cache(linkData.id,$this,$activeLeftMenu);dealLinkOpen(linkData,true)}});$("body").on("click",".tabsnav-tabs-item, .tabsnav-quicknav-item",function(e){var id=this.getAttribute("data-id").substr(4);if($(e.target).hasClass("tabsnav-tabs-close"))return tab2leftManage.deCache(id)})}initEvent();function getRowKey(rowkey,i){return rowkey===undefined?i+"":rowkey+"-"+i}var INDENT_INIT=22,INDENT_STEP=14;function getIndent(rowkey,len){len=len||rowkey.split("-").length;if(len<2)return 0;return INDENT_INIT+(len-2)*INDENT_STEP}function buildLeftMenu(data,rowkey){var html="";$.each(data,function(i,item){var view=item;view.hasSub=!!(item.items&&item.items.length);view.rowkey=getRowKey(rowkey,i);var len=view.rowkey.split("-").length;view.isTop=len===1;view.level="level-"+len;view.indent=getIndent(view.rowkey,len);if(view.isTop)view.bg=item.iconBackColor||randomColor(i);if(len===1)view.icon=view.icon||"modicon-1";if(view.hasSub)html+=Mustache.render(LEFT_MENU_ITEM_TPL,$.extend(view,{subMenu:buildLeftMenu(item.items,view.rowkey)}));else html+=Mustache.render(LEFT_MENU_ITEM_TPL,view)});return html}function ininView(data,tMenu){if(data&&data.length){var html=buildLeftMenu(data);var viewData={code:tMenu.code,name:tMenu.name,leftMenuItems:html};$activeLeftMenu=$(Mustache.render(LEFT_MENU_TPL,viewData));$activeLeftMenu.appendTo($leftMenuContainer).siblings(".left-menu-wrap").addClass("hidden");return $activeLeftMenu}}var isFirstEnter=true;function getLeftMenu(tMenu,findSubUrlOpen){var tCode=tMenu.code;if(!leftMenuStatus[tCode]||leftMenuStatus[tCode]==="reject")return _getData_("getMenu",{query:"sub",code:tCode}).done(function(data){var $menu=ininView(data,tMenu);leftMenuStatus[tCode]="resolve";if(tMenu.url&&tMenu.openType==="tabsnav")tab2leftManage.cache(tCode,null,$menu);else findSubUrlOpen&&findFirstSecUrlOpen(tCode+"");if(isFirstEnter){isFirstEnter=false;$main.removeClass("no-trans left-none")}}).fail(function(){leftMenuStatus[tCode]="reject"});if(leftMenuStatus[tCode]==="resolve"){$activeLeftMenu=$("#left-menu-"+tCode);$activeLeftMenu.removeClass("hidden").siblings(".left-menu-wrap").addClass("hidden");if(!tMenu.url||tMenu.openType!=="tabsnav")findSubUrlOpen&&findFirstSecUrlOpen(tCode);return}}win.getLeftMenu=getLeftMenu;var subUrlCache={};function findFirstSecUrlOpen(targetMenu){if(subUrlCache[targetMenu])return TabsNav.addTab(subUrlCache[targetMenu]);var $targetMenu=$leftMenuContainer.find("#left-menu-"+targetMenu);var openType="",url="";$targetMenu.find(".left-menu-link").each(function(i,item){url=item.getAttribute("data-url");openType=item.getAttribute("data-opentype");if(url&&openType=="tabsnav"){subUrlCache[targetMenu]={id:item.getAttribute("data-id"),name:item.title,url:url};tab2leftManage.cache(targetMenu,$(item),$targetMenu);$(item).trigger("click");return false}})}})(this,jQuery);(function(win,$){var $themeBtn=$("#theme-skin-switch"),$cover=createMainContentCover();var themeSelection;function initThemeSkin(){ThemeSelection._styleLoaded=true;themeSelection=new ThemeSelection({getPagesUrl:getPagesUrl,savePageUrl:savePageUrl,showCallback:function(){$cover.removeClass("hidden")},hideCallback:function(){$themeBtn.removeClass("active");$cover.addClass("hidden")}});window.themeSelection=themeSelection;$themeBtn.on("click",function(){if($themeBtn.hasClass("active")){$themeBtn.removeClass("active");themeSelection.hide()}else{themeSelection.show();$themeBtn.addClass("active")}});$("body").on("click",function(e){var $target=$(e.target);if(!$target.closest(".theme-selection-container, #theme-skin-switch").length){$themeBtn.removeClass("active");themeSelection.hide()}})}if(!window.ThemeSelection)Util.loadJs("frame/fui/js/widgets/themeselection/themeselection.js",initThemeSkin);else initThemeSkin()})(this,jQuery);(function(win,$){var SOUND_URL="../../msgsound/sound.html",ROLLER_TEXT="\u60a8\u6709\u65b0\u6d88\u606f\u63d0\u9192\uff0c\u8bf7\u70b9\u51fb\u67e5\u770b\uff01",rollerTip=ROLLER_TEXT,timer=0,title="";var rollDocTitle=function(){title=win.systemTitle||document.title;document.title=rollerTip;clearTimeout(timer);timer=setTimeout(function roll(){document.title=rollerTip.substring(1,rollerTip.length)+rollerTip.substring(0,1);rollerTip=document.title;timer=setTimeout(roll,300)},300)};var restoreDocTitle=function(){clearTimeout(timer);document.title=title||document.title;rollerTip=ROLLER_TEXT};var docTitle={roll:rollDocTitle,stop:restoreDocTitle};var $msgSound=$("#msg-sound");var parseNum=function(num){var n=parseInt(num,10);if(n>99)return"99+";else if(n<=0)return"";return n+""};var $topActionList=$("#header-action-btns"),$eMsgIcon=$(".header-action-btn.chart",$topActionList),$remindNum=$(".remind-num",$topActionList),$eMsgNum=$(".emsg-num",$topActionList),$msgPanel=$("#msg-panel");var $msgEMsg=$("#msgEMsg",$msgPanel),$msgEMsgContent=$(".msg-panel-content",$msgEMsg),$msgEMsgRecent=$(".emsg-recent-list",$msgEMsgContent),$onlineUserNum=$(".online-user-num",$msgEMsg),onlineUserIframe=document.getElementById("online-user");var $tips=$("#new-remind-wrap");var remindTips={show:function(){if(RemindTipsCfg.show){$tips.removeClass("hidden");this.autoHide()}},autoHide:function(){if(RemindTipsCfg.timeout!=0)return function(){clearTimeout(remindTips.timer);remindTips.timer=setTimeout(function(){$tips.addClass("hidden")},RemindTipsCfg.timeout)};return function(){}}(),initEvent:function(){if(RemindTipsCfg.show)$tips.on("click",".icon, .text",function(){$tips.addClass("hidden")}).on("click",".close",function(e){e.stopPropagation();$tips.addClass("hidden")})}};remindTips.initEvent();var getMsgCount=function(useCache){var params={haseXun:win.showEXun,needNum:true};if(useCache)params.inCache=true;return _getData_("getMsgCount",params).done(function(data){updateMsgCount(data)})};var updateMsgCount=function(data){var old=0,hasNew=false;if(data.remind){old=parseInt($remindNum.data("num"),10)||0;if(data.remind>old){hasNew=true;remindTips.show()}$remindNum.removeClass("hidden").text(parseNum(data.remind));$remindNum.data("num",data.remind)}else $remindNum.text("").addClass("hidden");if(data.eXun){old=parseInt($eMsgNum.data("num"),10)||0;if(data.eXun>old)hasNew=true;$eMsgNum.removeClass("hidden").text(parseNum(data.eXun));$eMsgNum.data("num",data.eXun)}else $eMsgNum.text("").addClass("hidden");var winSize=Util.getWinSize();var top=winSize.height/2+75;var left=winSize.width/2-150;if(data.systemUpdate){var myWindow=window.open("","","width\x3d300,height\x3d150,top\x3d"+top+",left\x3d"+left);myWindow.document.write("\x3cp\x3e"+data.systemUpdate+"\x3c/p\x3e");myWindow.focus()}if(hasNew){playNewMsgSound(100);docTitle.roll()}else docTitle.stop()};win.updateMsgTipCount=function(data){var old=0,hasNew=false;if(data.remind){old=parseInt($remindNum.data("num"),10)||0;if(data.remind>old){hasNew=true;remindTips.show()}$remindNum.removeClass("hidden").text(parseNum(data.remind));$remindNum.data("num",data.remind)}else $remindNum.text("").addClass("hidden");if(hasNew){playNewMsgSound(100);docTitle.roll()}else docTitle.stop()};var playNewMsgSound=function($msgSoundContainer,soundIframeUrl,soundFileUrl){if(Util.getFrameSysParam("messageSound")===false)return Util.noop;soundIframeUrl=Util.getRightUrl(soundIframeUrl);if(Util.browsers.isIE){var $soundIframe=$('\x3ciframe src\x3d"" frameborder\x3d"0" class\x3d"hidden"\x3e\x3c/iframe\x3e').appendTo($msgSoundContainer);return function(){$soundIframe[0].src=soundIframeUrl+"?_\x3d"+ +new Date}}var msgAudio=document.createElement("audio");msgAudio.src=Util.getRightUrl(soundFileUrl);msgAudio.className="hidden-accessible";$msgSoundContainer.append(msgAudio);var newMsgAudioTimer=null;return function doPlayNewMsgAudio(retryLimit){if(retryLimit===undefined)retryLimit=100;msgAudio.play()["catch"](function(){clearTimeout(newMsgAudioTimer);if(retryLimit>0)newMsgAudioTimer=setTimeout(function(){doPlayNewMsgAudio(--retryLimit)},50)})}}($msgSound,SOUND_URL,"../../msgsound/newsms.wav");_aideEvent_.on("afterPageInfo",function(){getMsgCount(true);if(!useWebsocket)setInterval(function(){getMsgCount(true)},6E4);if(win.showEXun)initEmsg();else $eMsgIcon.addClass("hidden")});if(useWebsocket)_aideEvent_.on("websocketCreated",function(){eWebSocket.socketEvent.on("messagecount",function(e){updateMsgCount(e.data)})});win.getMessageCount=getMsgCount;var decreaseEmsgCount=function(){var cnt=$eMsgNum.text();if(cnt)cnt=parseInt(cnt,10)-1;if(cnt==0){cnt="";$eMsgNum.data("num",0).addClass("hidden")}$eMsgNum.text(cnt)};var emsgList;function initEMsgList(){emsgList=new EMsgList({content:$msgEMsgRecent,getUrl:EmsgConfig.baseUrl,ignoreUrl:EmsgConfig.baseUrl,userImg:EmsgConfig.userImg,groupImg:EmsgConfig.groupImg,afterOpenEMsg:function(){hidePanel()},onDecEmsgCount:decreaseEmsgCount});win.RefreshEMsg=$.proxy(emsgList.getData,emsgList)}var initEmsg=function(){if(!win.EMsgList)Util.loadJs("frame/fui/js/widgets/emsglist/emsglist.js",function(){initEMsgList()});else initEMsgList();if(win.OnlineUserSettings&&win.OnlineUserSettings.show){$msgEMsg.find(".msg-panel-head").addClass("tab").find(".panel-hd-tab.hidden").removeClass("hidden");$msgEMsg.on("click",".panel-hd-tab",function(){var $this=$(this),ref=$this.data("ref"),hasShow=$this.data("hasShow"),$content=$msgEMsgRecent;if(!$this.hasClass("active")){$this.addClass("active").siblings().removeClass("active");if(ref){$content=$("#"+ref,$msgEMsgContent);if(!hasShow)setTimeout(function(){OnlineUserSettings.onRefreshData(function(count){$onlineUserNum.html(count)});$this.data("hasShow",true)},10)}$content.removeClass("hidden").siblings().addClass("hidden")}})}};function hidePanel(){$cover.addClass("hidden");$msgPanel.stop(true).animate({right:-350},function(){$msgPanel.addClass("hidden")});$topActionList.find("[data-ref].active").removeClass("active")}win.hideMessagePanel=hidePanel;var $cover=createMainContentCover();var msgCenter;win.messageCenter={refresh:function(){if(msgCenter)msgCenter.refresh()},hide:function(){if(msgCenter)msgCenter.hide()}};$topActionList.on("click","[data-ref]",function(){var $el=$(this),ref=$el.data("ref"),$panel=$("#"+ref,$msgPanel);if($el.hasClass("active")){hidePanel();$cover.addClass("hidden")}else{$el.addClass("active").siblings(".active").removeClass("active");if(ref=="msgRemind"){if(!msgCenter)msgCenter=new MsgCenter(win._msgcenterConfig_);msgCenter.show();hideMessagePanel();return}else if(ref=="msgEMsg"){emsgList.getData();if(win.OnlineUserSettings&&win.OnlineUserSettings.show)if(!onlineUserIframe.src){onlineUserIframe.src=OnlineUserSettings.url;if(onlineUserIframe.attachEvent)onlineUserIframe.attachEvent("onload",function(){OnlineUserSettings.onRefreshData(function(count){$onlineUserNum.html(count)})});else onlineUserIframe.onload=function(){OnlineUserSettings.onRefreshData(function(count){$onlineUserNum.html(count)})}}else OnlineUserSettings.onRefreshData(function(count){$onlineUserNum.html(count)})}else if(ref=="msgSkin")win.initSkinView&&win.initSkinView();$panel.removeClass("hidden").siblings(".msg-panel-detail").addClass("hidden");$panel.find(".msg-panel-content").removeClass("hidden");$msgPanel.removeClass("hidden");$msgPanel.stop(true).animate({right:0});$cover.removeClass("hidden")}});$msgPanel.on("click",".msg-panel-hide",function(){hidePanel()});$("body").on("click",function(e){var $target=$(e.target);if(!$target.closest("#msg-panel , .header-action-btn[data-ref]").length)hideMessagePanel()})})(this,jQuery);(function(win,$){var $headerSearch=$("#header-search-container");function doSearch(type,kw){type=type||"all";try{TabsNav.removeTab("fullsearch")}catch(error){}dealLinkOpen({id:"fullsearch",name:"\u5168\u6587\u68c0\u7d22",url:win._fullSearchUrl_+"?wd\x3d"+win.encodeURI(kw)+"\x26type\x3d"+type,openType:"tabsnav"});$("#header-search-container").removeClass("active")}function getCateData(){return Util.ajax({url:win._searchCfg.fullSearchCateUrl}).done(function(data){initTopFullSearch(data.categories)})}function initTopFullSearch(cateData){cateData=cateData||[];if(typeof cateData=="string")cateData=JSON.parse(cateData);var cates=[];$.each(cateData,function(i,item){cates.push({id:item.guid,name:item.name,iconCls:item.icon||"view"})});if(!cates.length)cates.push({id:"all",name:"\u5168\u6587\u68c0\u7d22",iconCls:"modicon-25"});ClassifySearch._styleLoaded=true;ClassifySearch.CLASSIFICATION_TPL='\x3cdiv class\x3d"classify-search-classify-item {{#isActive}}active{{/isActive}}" data-id\x3d"{{id}}" data-title-tpl\x3d"\u4e0e${keyword}\u76f8\u5173\u7684{{name}}"\x3e\x3cspan class\x3d"classify-search-classify-icon {{iconCls}}"\x3e\x3c/span\x3e\u4e0e\x3cspan class\x3d"classify-search-classify-kw"\x3e\x3c/span\x3e\u76f8\u5173\u7684{{name}}\x3cspan class\x3d"classify-search-classify-target hidden"\x3e{{target}}\x3c/span\x3e\x3c/div\x3e';ClassifySearch._$pageCover=createMainContentCover();var classifySearch=new ClassifySearch({id:"header-search",searchTarget:"\u5185\u5bb9",category:cates,placeholder:"\u8bf7\u8f93\u5165",maxShowCharacter:3,enter:function(id,key){doSearch(id,key)}});dealUserModuleSearch(classifySearch);function ieOverflowFixed(show){if(Util.browsers.isIE||Util.browsers.isEdge)$headerSearch[show?"addClass":"removeClass"]("show-overflow")}$headerSearch.on("click",".header-search-btn",function(){ieOverflowFixed(false);$headerSearch.toggleClass("active").trigger("autoFocus")}).on("autoFocus",function(){if(!Util.browsers.isSupportTransition)$headerSearch.hasClass("active")&&classifySearch.$input.trigger("focus")});if(Util.browsers.isSupportTransition)$headerSearch.on(Util.browsers.transitionend,function(ev){if(ev.target===this)if($headerSearch.hasClass("active")){ieOverflowFixed(true);classifySearch.$input.trigger("focus")}});if(Util.browsers.isSupportAnimation)classifySearch.$popup.on(Util.browsers.animationend,function(ev){if(ev.target===this)if(!classifySearch.$container.hasClass("popup")){ieOverflowFixed(false);$headerSearch.removeClass("active")}});else classifySearch.$input.on("blur",function(){Util.browsers.isIE&&$headerSearch.removeClass("show-overflow");$headerSearch.removeClass("active")})}function dealUserModuleSearch(classifySearch){var $userItem=classifySearch.$classifyList.find('[data-id\x3d"user"]'),$modulItem=classifySearch.$classifyList.find('[data-id\x3d"module"]');if(!$userItem.length||!$modulItem.length)return;var $userList=$('\x3cul class\x3d"top-search-user-list"\x3e\x3c/ul\x3e'),$moduleList=$('\x3cul class\x3d"top-search-module-list"\x3e\x3c/ul\x3e');if($userItem.length){$userList.insertAfter($userItem);$userList.on("click",".top-search-user-item",function(){_searchCfg.userClick&&_searchCfg.userClick(this.getAttribute("data-id"),this.title);classifySearch.$input.blur().val("");classifySearch.hidePopup()})}if($modulItem.length){$moduleList.insertAfter($modulItem);$moduleList.on("click",".top-search-module-item",function(){var $this=$(this);$this.data("url")&&dealLinkOpen({id:$this.data("id"),name:this.title,url:$this.data("url"),openType:$this.data("opentype")});classifySearch.$input.blur().val("");classifySearch.hidePopup()})}var timer;var ignoreCodes=[13,16,17,18,27,37,38,39,40];var isSupportInput=function(){var input=document.createElement("input");return"oninput"in input}();if(isSupportInput)classifySearch.$input.on("input",function(){clearTimeout(timer);timer=setTimeout(immediatelySearch,50)});else classifySearch.$input.on("keyup",function(ev){if($.inArray(ev.which,ignoreCodes)!=-1)return;clearTimeout(timer);timer=setTimeout(immediatelySearch,50)});classifySearch.$input.on("setHistoryValue",immediatelySearch);var lastRequest;var USER_ITEM_TPL='\x3cli class\x3d"top-search-user-item" data-id\x3d"{{guid}}" title\x3d"{{name}}" \x3e\x3cimg class\x3d"top-search-user-item-img" src\x3d"{{portrait}}" \x3e{{{hlname}}}\x3c/li\x3e';var MODULE_ITEM_TPL='\x3cli class\x3d"top-search-module-item" data-id\x3d"{{code}}" title\x3d"{{name}}" data-opentype\x3d"{{openType}}" data-url\x3d"{{url}}"\x3e\x3cspan class\x3d"top-search-module-item-icon {{icon}}"\x3e\x3c/span\x3e{{{hlname}}}\x3c/li\x3e';function immediatelySearch(){var value=$.trim(classifySearch.$input.val());if(lastRequest)lastRequest.abort();if(!value)return;lastRequest=Util.ajax({url:epoint.dealRestfulUrl(_searchCfg.userModuleSearchUrl),data:{cnum:"user,module",key:value,rn:3,location:"search"}});lastRequest.done(function(res){var data=mini.decode(res.frameinfo);var userHTML=[],moduleHTML=[],hlReg=new RegExp(value,"ig");data.users&&$.each(data.users,function(i,item){item.portrait=Util.getRightUrl(item.portrait);item.hlname=item.name.replace(hlReg,'\x3cspan class\x3d"top-search-kw"\x3e'+value+"\x3c/span\x3e");userHTML.push(Mustache.render(USER_ITEM_TPL,item))});data.modules&&$.each(data.modules,function(i,item){item.icon=item.icon||"modicon-1";item.hlname=item.name.replace(hlReg,'\x3cspan class\x3d"top-search-kw" \x3e'+value+"\x3c/span\x3e");moduleHTML.push(Mustache.render(MODULE_ITEM_TPL,item))});$(userHTML.join("")).appendTo($userList.empty());$(moduleHTML.join("")).appendTo($moduleList.empty())})}}_aideEvent_.on("afterPageInfo",function(){if(win._fullSearchUrl_)getCateData();else;})})(this,jQuery);window.OpenEMsg=function(sessionid,uid,type){if(window.eMsg)if(typeof uid==="undefined")eMsg.open(sessionid);else eMsg.openSession(sessionid,uid,type);else creatWebSocket(_userGuid_,_userName_,function(){eWebSocket.openEmsg(sessionid,uid,type)})};(function(win,$){var $helpIcon=$("#help-icon");var templ='\x3cdiv class\x3d"notice-remind-cover"\x3e\x3c/div\x3e'+'\x3cdiv class\x3d"notice-remind"\x3e'+'\x3ch2 class\x3d"notice-remind-hd"\x3e\u66f4\u65b0\u516c\u544a\x3c/h2\x3e'+'\x3cspan class\x3d"notice-remind-history"\x3e\u5386\u53f2\u516c\u544a\x3c/span\x3e'+'\x3cdiv class\x3d"notice-remind-bd"\x3e'+"\x3c/div\x3e"+'\x3cbutton class\x3d"notice-remind-btn"\x3e\u6211\u77e5\u9053\u4e86\x3c/button\x3e'+"\x3c/div\x3e",style=".notice-remind-cover{position:absolute;top:0;right:0;bottom:0;left:0;background:#000;opacity:.4;filter:alpha(opacity\x3d40);z-index:9999}.notice-remind{position:absolute;top:50%;left:50%;width:630px;height:380px;margin-left:-315px;margin-top:-190px;border-radius:8px;background:#fff;z-index:10000}.notice-remind-hd{height:70px;line-height:70px;text-align:center;font-size:18px;font-weight:700;color:#4080f5}.notice-remind-history{position:absolute;width:60px;top:25px;right:40px;color:#9fb1d3;font-size:14px;line-height:22px;cursor:pointer}.notice-remind-bd{height:240px;margin:0 40px;overflow:auto}.notice-remind-btn{position:absolute;bottom:26px;left:50%;margin-left:-55px;width:110px;height:34px;border:0;background:#4080f5;color:#fff;border-radius:2px;cursor:pointer}.notice-remind-bd h1,.notice-remind-bd h2,.notice-remind-bd h3,.notice-remind-bd h4,.notice-remind-bd h5,.notice-remind-bd h6{position:relative;margin-top:1em;margin-bottom:16px;font-weight:bold;line-height:1.4}.notice-remind-bd h1 .octicon-link,.notice-remind-bd h2 .octicon-link,.notice-remind-bd h3 .octicon-link,.notice-remind-bd h4 .octicon-link,.notice-remind-bd h5 .octicon-link,.notice-remind-bd h6 .octicon-link{display:none;color:#000;vertical-align:middle}.notice-remind-bd h1:hover .anchor,.notice-remind-bd h2:hover .anchor,.notice-remind-bd h3:hover .anchor,.notice-remind-bd h4:hover .anchor,.notice-remind-bd h5:hover .anchor,.notice-remind-bd h6:hover .anchor{padding-left:8px;margin-left:-30px;text-decoration:none}.notice-remind-bd h1:hover .anchor .octicon-link,.notice-remind-bd h2:hover .anchor .octicon-link,.notice-remind-bd h3:hover .anchor .octicon-link,.notice-remind-bd h4:hover .anchor .octicon-link,.notice-remind-bd h5:hover .anchor .octicon-link,.notice-remind-bd h6:hover .anchor .octicon-link{display:inline-block}.notice-remind-bd h1{padding-bottom:.3em;font-size:2.25em;line-height:1.2;border-bottom:1px solid #eee}.notice-remind-bd h1 .anchor{line-height:1}.notice-remind-bd h2{padding-bottom:.3em;font-size:1.75em;line-height:1.225;border-bottom:1px solid #eee}.notice-remind-bd h2 .anchor{line-height:1}.notice-remind-bd h3{font-size:1.5em;line-height:1.43}.notice-remind-bd h3 .anchor{line-height:1.2}.notice-remind-bd h4{font-size:1.25em}.notice-remind-bd h4 .anchor{line-height:1.2}.notice-remind-bd h5{font-size:1em}.notice-remind-bd h5 .anchor{line-height:1.1}.notice-remind-bd h6{font-size:1em;color:#777}.notice-remind-bd h6 .anchor{line-height:1.1}.notice-remind-bd p,.notice-remind-bd blockquote,.notice-remind-bd ul,.notice-remind-bd ol,.notice-remind-bd dl,.notice-remind-bd table,.notice-remind-bd pre{margin-top:0;margin-bottom:16px}.notice-remind-bd ul,.notice-remind-bd ol{padding-left:2em}.notice-remind-bd ul ul,.notice-remind-bd ul ol,.notice-remind-bd ol ol,.notice-remind-bd ol ul{margin-top:0;margin-bottom:0}.notice-remind-bd li\x3ep{margin-top:16px}",$style=$("\x3cstyle\x3e"+style+"\x3c/style\x3e");$el=$(templ),$content=$(".notice-remind-bd",$el);var bindEvent=function(){$el.on("click",".notice-remind-history",function(){NoticeRemindConfig.onHistoryClick&&NoticeRemindConfig.onHistoryClick();close()}).on("click",".notice-remind-btn",function(){close()})};var close=function(){Util.ajax({url:NoticeRemindConfig.markToReadUrl,data:{cInfoGuid:cInfoGuid}});$el.off("click");$el.remove();$style.remove();$helpIcon.removeClass("new-info")};var show=function(content){insertStyle();bindEvent();$content.html(content);$("body").append($el)};var insertStyle=function(){$style.appendTo("head")};var cInfoGuid="";var getNotice=function(){Util.ajax({url:NoticeRemindConfig.getUrl}).done(function(data){if(data.content){show(data.content);cInfoGuid=data.cInfoGuid}})};var getNoticeCount=function(){Util.ajax({url:NoticeRemindConfig.getCountUrl}).done(function(data){if(data.isRead===false)$helpIcon.addClass("new-info")})};if(win.NoticeRemindConfig)getNoticeCount();$helpIcon.on("click",function(){var $this=$(this);if($this.hasClass("new-info")){getNotice();$helpIcon.removeClass("new-info")}else window.open(NoticeRemindConfig.pageUrl)})})(this,jQuery);