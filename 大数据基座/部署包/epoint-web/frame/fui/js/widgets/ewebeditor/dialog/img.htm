<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<script type="text/javascript" src="dialog.js?v=11.9"></script>

<script type="text/javascript">
document.write ("<link href='../language/" + lang.ActiveLanguage + ".css?v=" + EWEB.V + "' type='text/css' rel='stylesheet'>");
document.write ("<link href='../skin/" + config.Skin + "/dialog.css?v=" + EWEB.V + "' type='text/css' rel='stylesheet'>");

var sAction = "INSERT";
var sTitle = lang["DlgComInsert"];

var oControl;
var oSeletion;


var sFromUrl = "http://";
var sAlt = "";
var sBorder = "0";
var sBorderColor = "";
var sFilter = "";
var sAlign = "";
var sWidth = "";
var sHeight = "";
var sVSpace = "";
var sHSpace = "";

var sSLTUrl = "";
var sCheckFlag = "file";

var bAllowUpload = ((parseFloat(config.AllowImageSize)>0) ? true : false);
var bSYFlag = (((config.SYWZFlag=="2" || config.SYTPFlag=="2") && config.SYVNormal=="1") ? true : false);


if (EWEBSelection.GetType() == "Control") {
	oControl = EWEBSelection.GetSelectedElement();
	if (oControl.tagName=="IMG" && GetAttribute(oControl, "_ewebeditor_fake_tag")==""){
		sAction = "MODI";
		sTitle = lang["DlgComModify"];
		sCheckFlag = "url";
		sFromUrl = GetProtectAttribute(oControl, "src");
		sAlt = GetAttribute(oControl, "alt");
		sBorder = GetAttribute(oControl, "border");
		sBorderColor = oControl.style.borderColor;
		sFilter = oControl.style.filter;
		sAlign = GetAttribute(oControl, "align");
		sWidth = RemovePX(GetStyleAttribute(oControl, "width"));
		sHeight = RemovePX(GetStyleAttribute(oControl, "height"));
		sVSpace = GetAttribute(oControl, "vspace");
		sHSpace = GetAttribute(oControl, "hspace");
	}
}

var sCaption = lang["DlgImg"] + "(" + sTitle + ")";
document.write("<title>" + sCaption + "</title>");


function InitDocument(){
	lang.TranslatePage(document);

	SearchSelectValue($("d_filter"), sFilter);
	SearchSelectValue($("d_align"), sAlign.toLowerCase());

	if (!bAllowUpload){
		sCheckFlag = "url";
	}
	RadioClick(sCheckFlag);

	$("d_fromurl").value = sFromUrl;
	$("d_alt").value = sAlt;
	$("d_border").value = sBorder;
	$("d_bordercolor").value = sBorderColor;
	$("s_bordercolor").style.backgroundColor = sBorderColor;
	$("d_width").value = sWidth;
	$("d_height").value = sHeight;
	$("d_vspace").value = sVSpace;
	$("d_hspace").value = sHSpace;

	//same height
	var o1 = $("TD_Right");
	var o2 = $("Fieldset_Right");
	var h1=o1.offsetHeight;
	var h2=o2.offsetHeight;
	if (h1>h2){
		if (EWEBBrowser.IsIE){
			o2.style.height = h1 + "px";
		}else{
			o2.style.height = (h1-2) + "px";
		}
	}


	doPreview();
	
	if ($("d_fromurl")){
		if (EWEBBrowser.IsIE){
			$("d_fromurl").onpropertychange=_InputUrl_OnChange;
		}else{
			EWEBTools.AddEventListener($("d_fromurl"), "input", _InputUrl_OnChange);
		}
	}
	
	parent.InnerDialogLoaded(sCaption);

	if (bAllowUpload && document.documentMode==5){
		var b_UFDisable = (sCheckFlag=="url")?false:true;
		$("uploadfile").disabled=b_UFDisable;
		$("uploadfile").disabled=!b_UFDisable;
	}
}


function _InputUrl_OnChange(){
	if (EWEBBrowser.IsIE){
		if (event.propertyName!='value'){
			return;
		}
	}

	var s_Url=$("d_fromurl").value;
	var n = s_Url.lastIndexOf(".");
	if (n>=1){
		if (s_Url.length>n+1){
			var s_Ext = "|"+s_Url.substr(n+1)+"|";
			if ("|gif|jpg|jpeg|png|bmp|".indexOf(s_Ext.toLowerCase())>=0){
				doPreview();
				return;
			}
		}
	}

	setPreviewError();
}




function RadioClick(what){
	if (what=="url"){
		$("d_fromurl").disabled=false;
		if (config.AllowBrowse=="1"){
			$("d_browse").disabled=false;
		}
		$("d_checkfromurl").checked=true;
		if (bAllowUpload){
			$("d_checkfromfile").checked=false;
			$("uploadfile").disabled=true;
		}
	}else{
		$("d_checkfromurl").checked=false;
		$("uploadfile").disabled=false;
		$("d_checkfromfile").checked=true;
		$("d_fromurl").disabled=true;
		if (config.AllowBrowse=="1"){
			$("d_browse").disabled=true;
		}
	}
}


function UploadError(s_Flag){
	AbleItems();
	RadioClick('file');
	DLGDoingMsg.Hide();
	try {
		BaseAlert($("uploadfile"), getUploadErrDesc(s_Flag, config.AllowImageExt, config.AllowImageSize));
	}
	catch(e){}
}


function UploadSaved(sOriginalFileName, sPathFileName, sPathFileName_s){
	EWIN.addUploadFile(sOriginalFileName, sPathFileName);
	if (sPathFileName_s){
		EWIN.addUploadFile(sOriginalFileName, sPathFileName_s);
	}

	$("d_fromurl").value = sPathFileName;
	sSLTUrl = sPathFileName_s;
	if (config.SLTMode=="1"){
		sSLTUrl = "";
	}
	ReturnValue();
}


function ReturnValue(){
	sFromUrl = $("d_fromurl").value;
	sAlt = $("d_alt").value;
	sBorder = $("d_border").value;
	sBorderColor = $("d_bordercolor").value;
	sFilter = $("d_filter").options[$("d_filter").selectedIndex].value;
	sAlign = $("d_align").value;
	sWidth = $("d_width").value;
	sHeight = $("d_height").value;
	sVSpace = $("d_vspace").value;
	sHSpace = $("d_hspace").value;

	if (sAction == "MODI") {
		if (sSLTUrl){
			//oControl.src = sSLTUrl;
			SetAttribute(oControl, "src", sSLTUrl);
			SetProtectAttribute(oControl, "src", sSLTUrl);
		}else{
			//oControl.src = sFromUrl;
			SetAttribute(oControl, "src", sFromUrl);
			SetProtectAttribute(oControl, "src", sFromUrl);
		}
		SetAttribute(oControl, "alt", sAlt);
		SetAttribute(oControl, "border", sBorder);
		oControl.style.borderColor = sBorderColor;
		oControl.style.filter = sFilter;
		SetAttribute(oControl, "align", sAlign);
		oControl.style.width = AddUnitPX(sWidth);
		oControl.style.height = AddUnitPX(sHeight);
		SetAttribute(oControl, "width", "");
		SetAttribute(oControl, "height", "");
		SetAttribute(oControl, "vspace", sVSpace);
		SetAttribute(oControl, "hspace", sHSpace);
		if (sSLTUrl){
			EWEB.EditorDocument.execCommand("CreateLink",false,sFromUrl);
			var o_ParentNode = oControl.parentNode;
			if (o_ParentNode.tagName=="A"){
				SetAttribute(o_ParentNode, "target", "_blank");
				SetAttribute(o_ParentNode, "href", sFromUrl)
				SetProtectAttribute(o_ParentNode, "href", sFromUrl)
			}			
		}
	}else{
		var s_Html = '';
		if (sFilter!=''){
			s_Html=s_Html+'filter:'+sFilter+';';
		}
		if (sBorderColor!=''){
			s_Html=s_Html+'border-color:'+sBorderColor+';';
		}
		if (sWidth!=""){
			s_Html=s_Html+'width:'+AddUnitPX(sWidth)+';';
		}
		if (sHeight!=""){
			s_Html=s_Html+'height:'+AddUnitPX(sHeight)+';';
		}

		if (s_Html!=''){
			s_Html=' style="'+s_Html+'"';
		}
		if (sSLTUrl){
			s_Html = '<img src="'+sSLTUrl+'"'+s_Html;
		}else{
			s_Html = '<img src="'+sFromUrl+'"'+s_Html;
		}
		if (sBorder!=''){
			s_Html=s_Html+' border="'+sBorder+'"';
		}
		if (sAlt!=''){
			s_Html=s_Html+' alt="'+sAlt+'"';
		}
		if (sAlign!=''){
			s_Html=s_Html+' align="'+sAlign+'"';
		}
		if (sVSpace!=''){
			s_Html=s_Html+' vspace="'+sVSpace+'"';
		}
		if (sHSpace!=''){
			s_Html=s_Html+' hspace="'+sHSpace+'"';
		}
		s_Html=s_Html+'>';
		if (sSLTUrl){
			s_Html = '<a href="'+sFromUrl+'" target="_blank">'+s_Html+'</a>';
		}
		//EWEBSelection.Restore();
		EWIN.insertHTML(s_Html);

	}

	parent.Ok();
}

var sUploadFormAction = "";
function ok(){
	if (config.FSPath!="" && config.FSL!="ok"){
		alert(lang["ErrFSL"]);
		return;
	}

	$("d_border").value = ToInt($("d_border").value);
	$("d_width").value = BaseTrim($("d_width").value);
	$("d_height").value = BaseTrim($("d_height").value);
	$("d_vspace").value = ToInt($("d_vspace").value);
	$("d_hspace").value = ToInt($("d_hspace").value);

	if (!IsColor($("d_bordercolor").value)){
		BaseAlert($("d_bordercolor"),lang["DlgImgErrBorColor"]);
		return false;
	}
	
	if ($("d_checkfromurl").checked){
		ReturnValue();
	}else{
		if (!IsExt($("uploadfile").value,config.AllowImageExt)){
			UploadError("ext");
			return false;
		}

		CheckSizeAsync($("uploadfile"), config.AllowImageSize,
			function(s_SizeFlag){
				if(s_SizeFlag=="no"){
					UploadError("size");
					return false;
				}

				DisableItems();
				DLGDoingMsg.Show();

				if (bSYFlag){
					if (sUploadFormAction==""){
						sUploadFormAction = document.myuploadform.action;
					}
					if ($("d_syflag").checked){
						document.myuploadform.action = sUploadFormAction + "&syflag=1";
					}else{
						document.myuploadform.action = sUploadFormAction;
					}
				}

				document.myuploadform.submit();
			}
		);
	}
}


function DisableItems(){
	$("d_checkfromfile").disabled=true;
	$("d_checkfromurl").disabled=true;
	$("d_fromurl").disabled=true;
	if (config.AllowBrowse=="1"){
		$("d_browse").disabled=true;
	}
	$("d_alt").disabled=true;
	$("d_border").disabled=true;
	$("d_bordercolor").disabled=true;
	$("d_filter").disabled=true;
	$("d_align").disabled=true;
	$("d_width").disabled=true;
	$("d_height").disabled=true;
	$("d_vspace").disabled=true;
	$("d_hspace").disabled=true;
	$("d_ok").disabled=true;
}


function AbleItems(){
	$("d_checkfromfile").disabled=false;
	$("d_checkfromurl").disabled=false;
	$("d_fromurl").disabled=false;
	if (config.AllowBrowse=="1"){
		$("d_browse").disabled=false;
	}
	$("d_alt").disabled=false;
	$("d_border").disabled=false;
	$("d_bordercolor").disabled=false;
	$("d_filter").disabled=false;
	$("d_align").disabled=false;
	$("d_width").disabled=false;
	$("d_height").disabled=false;
	$("d_vspace").disabled=false;
	$("d_hspace").disabled=false;
	$("d_ok").disabled=false;
}

function doPreview(){
	var s_Url="";
	if ($("d_checkfromurl").checked){
		s_Url = $("d_fromurl").value;
		if(config.BaseHref!=""){
			s_Url = Rel2RootByBase(s_Url);
		}
	}else{
		if (EWEBBrowser.IsIE && !EWEBBrowser.IsIE10P){
			s_Url = $("uploadfile").value;
		}else{
			if ($("uploadfile").files.length>0){
				try{
					s_Url = $("uploadfile").files[0].getAsDataURL();
				}catch(e){
					s_Url = "";
				}
				if (!s_Url){
					try{
						s_Url = window.URL.createObjectURL($("uploadfile").files[0]);
					}catch(e){
						s_Url = "";
					}
				}
			}
		}
	}
	
	
	if ($("d_checkfromurl").checked || (EWEBBrowser.IsIE && !EWEBBrowser.IsIE10P)){	
		if (s_Url.lastIndexOf(".")<=0){
			setPreviewError();
			return;
		}
	}


	var b_IE7Local = false;
	if ((bAllowUpload)&&(EWEBBrowser.IsIE)&& !EWEBBrowser.IsIE10P){
		if ($("d_checkfromfile").checked){
			b_IE7Local = true;
		}
	}

	if (s_Url){
		if (b_IE7Local){
			setPreviewIE7(s_Url);
		}else{
			var img = new Image();
			img.onload = function(){
				setPreview(img.width, img.height, img.src);
			}
			img.onerror = setPreviewError;
			img.src = s_Url;
		}
	}else{
		$("tdPreview").innerHTML = "";
	}

}

function setPreview(w, h, s_Url){
	var bw = $("tdPreview").offsetWidth;
	var bh = $("tdPreview").offsetHeight;
	var sw,sh;
	if ((w>bw)||(h>bh)){
		var nw = bw/w;
		var nh = bh/h;
		if (nw>nh){
			sh = bh;
			sw = w*nh;
		}else{
			sw = bw;
			sh = h*nw;
		}
	}else{
		sw=w;
		sh=h;
	}
	$("tdPreview").innerHTML = "<img border=0 src='"+s_Url+"' width='"+sw+"' height='"+sh+"' style=\"filter:"+$("d_filter").value+"\">";
	$("tdPreviewSize").innerHTML = w+" * "+h;
	WH_W = w;
	WH_H = h;

	setClientThumbWH(w,h);
}

function setPreviewError(){
	$("tdPreview").innerHTML = "";
	$("tdPreviewSize").innerHTML = "";
	WH_W = "";
	WH_H = "";
}


var s_PreviewIE7_PreUrl = "";
function setPreviewIE7(url){
	if ($("imgPreviewDiv") && s_PreviewIE7_PreUrl==url){
		return;
	}
	s_PreviewIE7_PreUrl = url;

	$("tdPreview").innerHTML = "<div id=imgPreviewDiv style=\"filter : progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod='image') "+$("d_filter").value+";WIDTH:1px; HEIGHT:1px; \"></div>";
	$("imgPreviewDiv").filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src = url;

	window.setTimeout("CheckImageLoaderIE7()", 50);
}

function CheckImageLoaderIE7(){
	var w = $("imgPreviewDiv").offsetWidth;
	var h = $("imgPreviewDiv").offsetHeight;

	if (w==1 || h==1){
		window.setTimeout("CheckImageLoaderIE7()", 50);
		return;
	}

	var bw = $("tdPreview").offsetWidth;
	var bh = $("tdPreview").offsetHeight;

	var sw,sh;

	if ((w>bw)||(h>bh)){
		var nw = bw/w;
		var nh = bh/h;
		if (nw>nh){
			sh = bh;
			sw = w*nh;
		}else{
			sw = bw;
			sh = h*nw;
		}
	}else{
		sw = w;
		sh = h;
	}

	$("imgPreviewDiv").style.width = sw;
	$("imgPreviewDiv").style.height = sh;
	$("imgPreviewDiv").filters.item("DXImageTransform.Microsoft.AlphaImageLoader").sizingMethod = 'scale';	

	$("tdPreviewSize").innerHTML = w+" * "+h;
	WH_W = w;
	WH_H = h;

	setClientThumbWH(w,h);
}


function setClientThumbWH(w,h){
	if (config.SLTFlag!="2"){return;}

	var n_MinSize = parseInt(config.SLTMinSize);
	var n_OkSize = parseInt(config.SLTOkSize);
	var tw,th;
	
	switch(config.SLTCheckFlag){
	case "0":
		if (w<=n_MinSize){return;}
		
		tw=n_OkSize;
		th=parseInt(h*(n_OkSize/w));
		break;
	case "1":
		if (h<=n_MinSize){return;}
		
		tw=parseInt(w*(n_OkSize/h));
		th=n_OkSize;
		break;
	case "2":
		if (w<=n_MinSize && h<=n_MinSize){return;}

		if (w>h){
			tw=n_OkSize;
			th=parseInt(h*(n_OkSize/w));
		}else{
			tw=parseInt(w*(n_OkSize/h));
			th=n_OkSize;
		}
		break;
	}

	$("d_width").value=tw+"";
	$("d_height").value=th+"";
}


var WH_bIsLock = true;
var WH_W = "";
var WH_H = "";
function WH_ClickLockOrUnlock(o_Img){
	if (WH_bIsLock){
		WH_bIsLock  = false;
		o_Img.src = "images/unlock.gif";
	}else{
		WH_bIsLock = true;
		o_Img.src = "images/lock.gif";
	}

}

function WH_ClickRefresh(){
	if (($("d_width").value==WH_W+"") && ($("d_height").value==WH_H+"")){
		$("d_width").value = "";
		$("d_height").value = "";
	}else{
		$("d_width").value = WH_W;
		$("d_height").value = WH_H;
	}
}

function WH_Change(s_Flag){
	if (!WH_bIsLock){return;}
	if (!WH_W){return;}

	if (s_Flag=="w"){
		var v = BaseTrim($("d_width").value);
		var w = parseInt(v);
		if (isNaN(w)){
			$("d_width").value = "";
			$("d_height").value = "";
			return;
		}
		if (v.substr(v.length-1)=="%"){
			$("d_height").value = "";
			return;
		}
		$("d_height").value = parseInt(w * WH_H / WH_W) + v.replace(/[^a-zA-Z]/gi,"");
	}else{
		var v = BaseTrim($("d_height").value);
		var h = parseInt(v);
		if (isNaN(h)){
			$("d_width").value = "";
			$("d_height").value = "";
			return;
		}
		if (v.substr(v.length-1)=="%"){
			$("d_width").value = "";
			return;
		}
		$("d_width").value = parseInt(h * WH_W / WH_H) + v.replace(/[^a-zA-Z]/gi,"");
	}

}

function TabOnClick(n_Index, n_Count, s_TabID){
	if (s_TabID=="tab_mfu"){
		DLGMFU.Load("image", $(s_TabID), DLGTab.TabSize[1].Width+"px", DLGTab.TabSize[1].Height+"px");
	}
}

function MFUReturn(s_Value){
	var s_Html="";
	var aFile=s_Value.split("|");
	for (var i=0; i<aFile.length; i++){
		var a = aFile[i].split("::");
		if (a.length==3 && a[1]!=""){
			var s_OriginalFileName = a[0].substr(a[0].lastIndexOf("\\")+1);
			if (a[2]==""){
				s_Html+="<img border=0 src='"+a[1]+"'><br><br>";
				EWIN.addUploadFile(s_OriginalFileName, a[1]);
			}else{
				s_Html+="<a href='"+a[1]+"' target='_blank'><img border=0 src='"+a[2]+"'></a><br><br>";
				EWIN.addUploadFile(s_OriginalFileName, a[1]);
				EWIN.addUploadFile(s_OriginalFileName, a[2]);
			}
		}
	}
	EWIN.insertHTML(s_Html);
	parent.Ok();
}

</script>


</head>
<body onload="InitDocument()">
<table border=0 cellpadding=0 cellspacing=5 id=tabDialogSize><tr><td>

<script type="text/javascript">
if (config.MFUEnable=="1"){
	DLGTab.Create([
		[ lang["DlgComTabNormal"], "tab_normal" ],
		[ lang["DlgComTabMFU"], "tab_mfu" ]
		]);
}
</script>

<table id="tab_normal" border=0 cellpadding=0 cellspacing=5 align=center>
<tr valign=top><td>

	<table border=0 cellpadding=0 cellspacing=0 align=center width="100%">
	<tr>
		<td>
		<fieldset>
		<legend><span lang=DlgImgSource></span></legend>
		<table border=0 cellpadding=5 cellspacing=0 width="100%">
		<tr><td>

			<table border=0 cellpadding=0 cellspacing=0 width="300px"><tr><td></td></tr></table>
			<table border=0 cellpadding=0 cellspacing=2 width="100%">
			<script type="text/javascript">
			if (bAllowUpload){
				document.write("<tr>");
				document.write("<td noWrap width=\"20%\"><input type=radio id=\"d_checkfromfile\" value=\"1\" onclick=\"RadioClick('file')\"><label for=d_checkfromfile>"+lang["DlgFromFile"]+"</label>:</td>");
				document.write("<td noWrap width=\"80%\">");
				document.write(getUploadForm("image"));
				document.write("</td>");
				document.write("</tr>");
			}
			</script>
			<tr>
				<td noWrap width="20%"><input type=radio id="d_checkfromurl" value="1" onclick="RadioClick('url')"><label for=d_checkfromurl><span lang=DlgFromUrl></span></label>:</td>
				<td noWrap width="80%">
				<script type="text/javascript">
				if (config.AllowBrowse=="1"){
					document.write("<table border=0 cellpadding=0 cellspacing=0 width='100%'><tr><td width='100%'><input type=text id='d_fromurl' style='width:180px' size=20 value=''></td><td><input class='dlgBtnBrowse' type=button id='d_browse' onclick=\"SelectBrowse('image','fromurl')\" value='"+lang["DlgBtnBrowse"]+"' align=absmiddle></td></tr></table>");
				} else {
					document.write("<input type=text id='d_fromurl' style='width:242px' size=28 value=''>");
				}
				</script>
				</td>
			</tr>
			</table>

		</td></tr>
		</table>
		</fieldset>
		</td>
	</tr>
	<tr><td height=5></td></tr>
	<tr>
		<td>
		<fieldset>
		<legend><span lang=DlgImgEffect></span></legend>
		<table border=0 cellpadding=5 cellspacing=0 width="100%">
		<tr><td>

			<table border=0 cellpadding=0 cellspacing=2 width="100%">
			<tr>
				<td noWrap width="20%"><span lang=DlgImgAlt></span>:</td>
				<td noWrap width="80%" colspan=4><input type=text id=d_alt size=10 value="" style="width:99%"></td>
			</tr>
			<tr>
				<td noWrap width="20%"><span lang=DlgImgBorder></span>:</td>
				<td noWrap width="29%"><input style="width:80px" type=text id=d_border size=10 value="" onkeydown="OnDigitFieldKeyDown(event);"></td>
				<td width="2%">&nbsp;</td>
				<td noWrap width="20%"><span lang=DlgImgBorderColor></span>:</td>
				<td noWrap width="29%"><input style="width:62px" type=text id=d_bordercolor size=7 value=""><img border=0 src="images/rect.gif" width=18 style="cursor:hand" id=s_bordercolor onclick="SelectColor('bordercolor')" align=absmiddle></td>
			</tr>
			<tr>
				<td noWrap width="20%"><span lang=DlgImgSpecEffect></span>:</td>
				<td noWrap width="29%">
					<select id=d_filter size=1 style="width:80px" onchange="doPreview()">
					<option value='' selected lang=DlgComNone></option>
					<option value='Alpha(Opacity=50)' lang=DlgImgAlpha1></option>
					<option value='Alpha(Opacity=0, FinishOpacity=100, Style=1, StartX=0, StartY=0, FinishX=100, FinishY=140)' lang=DlgImgAlpha2></option>
					<option value='Alpha(Opacity=10, FinishOpacity=100, Style=2, StartX=30, StartY=30, FinishX=200, FinishY=200)' lang=DlgImgAlpha3></option>
					<option value='blur(add=1,direction=14,strength=15)' lang=DlgImgBlur1></option>
					<option value='blur(add=true,direction=45,strength=30)' lang=DlgImgBlur2></option>
					<option value='Wave(Add=0, Freq=60, LightStrength=1, Phase=0, Strength=3)' lang=DlgImgWave></option>
					<option value='gray' lang=DlgImgGray></option>
					<option value='Chroma(Color=#FFFFFF)' lang=DlgImgChroma></option>
					<option value='DropShadow(Color=#999999, OffX=7, OffY=4, Positive=1)' lang=DlgImgDropShadow></option>
					<option value='Shadow(Color=#999999, Direction=45)' lang=DlgImgShadow></option>
					<option value='Glow(Color=#ff9900, Strength=5)' lang=DlgImgGlow></option>
					<option value='flipv' lang=DlgImgFlipv></option>
					<option value='fliph' lang=DlgImgFliph></option>
					<option value='grays' lang=DlgImgGrays></option>
					<option value='xray' lang=DlgImgXray></option>
					<option value='invert' lang=DlgImgInvert></option>
					</select>		
				</td>
				<td width="2%">&nbsp;</td>
				<td noWrap width="20%"><span lang=DlgAlign></span>:</td>
				<td noWrap width="29%">
					<select id=d_align size=1 style="width:80px">
					<option value='' selected lang=DlgComDefault></option>
					<option value='left' lang=DlgAlignLeft></option>
					<option value='right' lang=DlgAlignRight></option>
					<option value='top' lang=DlgAlignTop></option>
					<option value='middle' lang=DlgAlignMiddle></option>
					<option value='bottom' lang=DlgAlignBottom></option>
					<option value='absmiddle' lang=DlgAlignAbsmiddle></option>
					<option value='absbottom' lang=DlgAlignAbsbottom></option>
					<option value='baseline' lang=DlgAlignBaseline></option>
					<option value='texttop' lang=DlgAlignTexttop></option>
					</select>
				</td>
			</tr>
			<tr>
				<td noWrap width="20%"><span lang=DlgImgWidth></span>:</td>
				<td noWrap width="29%"><input style="width:62px" type=text id=d_width size=10 value="" onchange="WH_Change('w')" onkeyup="WH_Change('w')"><input type=image src="images/lock.gif" width=16 border=0 align=absmiddle onclick="WH_ClickLockOrUnlock(this)"></td>
				<td width="2%">&nbsp;</td>
				<td noWrap width="20%"><span lang=DlgImgVSpace></span>:</td>
				<td noWrap width="29%"><input style="width:80px" type=text id=d_vspace size=10 value="" onkeydown="OnDigitFieldKeyDown(event);"></td>
			</tr>
			<tr>
				<td noWrap width="20%"><span lang=DlgImgHeight></span>:</td>
				<td noWrap width="29%"><input style="width:62px" type=text id=d_height size=10 value="" onchange="WH_Change('h')" onkeyup="WH_Change('h')"><input type=image src="images/refresh.gif" width=16 border=0 align=absmiddle onclick="WH_ClickRefresh()"></td>
				<td width="2%">&nbsp;</td>
				<td noWrap width="20%"><span lang=DlgImgHSpace></span>:</td>
				<td noWrap width="29%"><input style="width:80px" type=text id=d_hspace size=10 value="" onkeydown="OnDigitFieldKeyDown(event);"></td>
			</tr>
			</table>

		</td></tr>
		</table>
		</fieldset>
		</td>
	</tr>
	</table>


</td><td id="TD_Right">
	
		<fieldset id="Fieldset_Right">
		<legend><span lang=DlgImgPreview></span></legend>
		<div style="width:200px;height:200px">
		<table border=0 cellpadding=0 cellspacing=5 width="200" height="200" valign=top style="table-layout:fixed;">
		<tr><td colspan=2 bgcolor=#FFFFFF align=center valign=middle id=tdPreview height="150">

		</td></tr>
		<tr><td id=tdPreviewSize></td><td align=right><input type=button class="dlgbtn" id=btnPreivew onclick="doPreview()" lang=DlgImgPreview></td></tr>
		</table>
		</div>
		</fieldset>

</td></tr>
<tr>
	<td noWrap>
		<script type="text/javascript">
		if (bSYFlag){
			document.write('<input type=checkbox id=d_syflag value="1" style="vertical-align:middle;"><label for=d_syflag style="vertical-align:middle;"><span lang=DlgImgSYFlag></span></label>');
		}
		</script>
	</td>
	<td noWrap align=right><input type=submit class="dlgBtnCommon dlgBtn" value='' id="d_ok" onclick="ok()" lang=DlgBtnOK>&nbsp;&nbsp;<input type=button class="dlgBtnCommon dlgBtn" value='' onclick="parent.Cancel()" lang=DlgBtnCancel></td>
</tr>
</table>



<div id="tab_mfu" style="display:none;"></div>



</td></tr></table>





<script type="text/javascript">
DLGDoingMsg.OutHtml(lang["DlgComUploading"]);
</script>


</body>
</html>