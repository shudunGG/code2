<!DOCTYPE html>
<html>

<head>
<title>API函数历史版本列表</title>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<!-- 请修改相对路径 -->
<script src="../../../../../fui/js/cssboot.js"></script>
</head>

<body>
	<!-- 必须有，加载时的loading效果 -->
	<div class="page-loading"></div>
	<!-- 左右布局页面的右侧内容 -->
	<!-- 条件区域 -->
	<div class="fui-condition">
		<div class="fui-form" id="fui-form">
			<div id="cform" role="form">
				<div role="row">
					<div role="control" label="包名">
						<input class="mini-textbox" bind="funcPackageName" />
					</div>
					<div role="control" label="类名">
						<input class="mini-textbox" bind="funcClassName" />
					</div>
				</div>
				<div role="row">
					<div role="control" label="创建时间">
						<span style="width: 100%"> <input name="" id="start-time"
							class="mini-datepicker" format="yyyy-MM-dd"
							bind="searchStartTime" style="width: 46%"
							onvaluechanged="startTimeChanged" /> <span>至</span> <input
							name="" id="finsh-time" class="mini-datepicker"
							format="yyyy-MM-dd" bind="searchFinshTime" style="width: 46%"
							onvaluechanged="finshTimeChanged" />
						</span>
					</div>
					<input id="apiguid" class="mini-hidden" bind="apiguid" />
				</div>
			</div>
		</div>
		<a role="searcher" callback="searchData"></a>
	</div>

	<!-- 内容区域 -->
	<div id="fuiContent" class="fui-content">
		<div id="datagrid" class="mini-datagrid" idField="rowguid"
			action="getDataGridData" sortOrder="desc" showPager="true"
			style="height: 100%;" allowResize="true" multiSelect="true"
			allowCellEdit="true" allowCellSelect="true" editNextOnEnterKey="true"
			editNextRowCell="true">
			<div property="columns">
				<div type="indexcolumn" width="40">序</div>
				<div width="100" field="func_package_name">包名</div>
				<div width="100" field="func_class_name">类名</div>
				<div width="150" field="record_time"
					data-options="{'format' : 'yyyy-MM-dd HH:mm:ss'}">创建时间</div>
				<div width="60" renderer="onSelectRenderer">恢复</div>
			</div>
		</div>
	</div>

	<!-- 请修改相对路径 -->
	<script src="../../../../../../rest/resource/jsboot"></script>
	<script>
		// 初始化页面
		epoint.initPage('selectapifunchistorylistaction', '', function(data) {
			if (data && data.apiguid) {
				var apiguid = data.apiguid;
				mini.get('apiguid').setValue(apiguid);
			} else {
				alert(data.error);
			}
		});

		// 绘制行选择按钮
		var onSelectRenderer = function(e) {
			return epoint.renderCell(e, "action-icon icon-recover",
					"selectFunc", "rowguid");
		};

		// 选中历史版本
		function selectFunc(e) {
			epoint.closeDialog(e);
		}

		function callback(data) {
			if (data.msg) {
				epoint.alert(data.msg, '', searchData);
			}
		}

		// 表格的搜索
		function searchData() {
			epoint.refresh([ 'datagrid', 'fui-form' ]);
		}

		function startTimeChanged() {
			// 获取时间
			var time = mini.get('start-time').getValue();
			mini.get('finsh-time').minDate = time;
		}

		function finshTimeChanged() {
			// 获取时间
			var time = mini.get('finsh-time').getValue();
			mini.get('start-time').maxDate = time;
		}
	</script>
</body>
</html>