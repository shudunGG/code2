<!DOCTYPE html>
<html>

<head>
<title>应用详情</title>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<script src="../../../../../fui/js/cssboot.js"></script>
</head>
<body>
	<!-- 必须有，加载时的loading效果 -->
	<div class="page-loading"></div>
	<!-- toolbar区域 -->
	<div class="fui-toolbar">
		<a class="mini-button" state="success" id="pass" onclick="passAudit">通过</a> <a
			class="mini-button" state="danger" id="notPass"
			onclick="notPassAudit">拒绝</a> <a class="mini-button"
			onclick="epoint.closeDialog">关闭</a>
	</div>
	<!-- 内容区域 -->
	<div class="fui-content">
		<div class="fui-accordions" id="fui-accordions">
			<div role="accordion" opened="true">
				<div role="head" title="应用基本信息"></div>
				<div role="body">
					<div class="fui-form">
						<div role="form">
							<div role="row">
								<label class="form-label">应用logo:</label>
								<div class="form-control span2" starred="true">
									<div class="icon-view">
										<img id="appIcon" width="100px" height="100px" />
									</div>
								</div>
							</div>
							<div role="row">
								<label class="form-label">应用名称:</label>
								<div id="appName" class="form-control span2">
									<input id="appName" bind="appInfo.appname"
										class="mini-outputtext" />
								</div>
								<label class="form-label">系统地址:</label>
								<div class="form-control span2" starred="true">
									<input bind="appInfo.apprealurl" class="mini-outputtext" />
								</div>
							</div>
							<div role="row">
								<div role="control" label="功能介绍">
									<input id="appDesc" bind="appInfo.appdesc"
										class="mini-outputtext" />
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div role="accordion" opened="true">
				<div role="head" title="申请人基本信息"></div>
				<div role="body">
					<div class="fui-form">
						<div role="form">
							<div role="row">
								<label class="form-label">申请人登录名:</label>
								<div class="form-control span2" starred="true">
									<input bind="frameDeveloper.loginId" class="mini-outputtext" />
								</div>
								<label class="form-label">申请人姓名:</label>
								<div id="displayName" class="form-control span2">
									<input id="displayName" bind="appInfo.linkmanname"
										class="mini-outputtext" />
								</div>
							</div>
							<div role="row">
								<div role="control" label="手机号">
									<input id="mobile" bind="frameDeveloper.mobile"
										class="mini-outputtext" />
								</div>
								<div role="control" label=""></div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<input id="controlIds" class="mini-hidden" />
	</div>

	<script src="../../../../../../rest/resource/jsboot"></script>



	<script>
		//<![CDATA[

		//初始化请求
		epoint.initPage('developerportalappeditaction', '', initCallBack);

		var appGuid = '';
		function initCallBack(e) {
			appGuid = e.appGuid;

			/* 	mini.get("selectedServiceType").setText(e.serviceType);
				mini.get("selectedServiceType").setValue(e.serviceType);
				
				mini.get("selectedDistrict").setText(e.allowDistrict);
				mini.get("selectedDistrict").setValue(e.allowDistrict); */

			$("#appIcon").attr('src', e.appIconUrl);

			if (e.showMode != 'audit') {
				mini.get("pass").hide();
				mini.get("notPass").hide();
			}
		}

		// 审核通过
		function passAudit() {
			if (epoint.validate()) {
				epoint.execute('passAudit', '', appGuid, passAuditCallBack);
			}
		}

		// 审核通过回调
		function passAuditCallBack(data) {
			var msg = data.msg;
			if (msg) {
				if (data.success) {
					epoint.closeDialog("success");
				} else {
					epoint.alert(msg, '', '', 'warning');
				}
			} else {
				epoint.alert('操作失败', '', '', 'warning');
			}
		}

		// 审核不通过
		function notPassAudit() {
			epoint
					.openDialog(
							"输入拒绝理由",
							'frame/pages/basic/gateway/app/developerportalappauditmanage/developerportalinputreason',
							function(rtnValue) {
								if (rtnValue != 'close') {
									epoint.execute('notPassAudit', '', [
											appGuid, rtnValue ],
											notPassAuditCallBack);
								}
							}, {
								'width' : 350,
								'height' : 260
							});

		}

		// 审核不通过回调
		function notPassAuditCallBack(data) {
			var msg = data.msg;
			if (msg) {
				if (data.success) {
					epoint.closeDialog("success");
				} else {
					epoint.alert(msg, '', '', 'warning');
				}
			} else {
				epoint.alert('操作失败', '', '', 'warning');
			}
		}

		// 保存
		function saveModify() {
			if (epoint.validate()) {
				epoint.execute('saveModify', '', appGuid, saveModifyCallBack);
			}
		}

		function saveModifyCallBack(data) {
			var msg = data.msg;
			if (msg) {
				if (data.success) {
					epoint.alert('保存成功', '', '', 'success', 'true');
				} else {
					epoint.alert(msg, '', '', 'warning');
				}
			} else {
				epoint.alert('操作失败', '', '', 'warning');
			}
		}

		//]]>
	</script>

</body>
</html>