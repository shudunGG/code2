(function(t){function e(e){for(var o,i,l=e[0],s=e[1],c=e[2],u=0,d=[];u<l.length;u++)i=l[u],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&d.push(r[i][0]),r[i]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(t[o]=s[o]);f&&f(e);while(d.length)d.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],o=!0,i=1;i<n.length;i++){var l=n[i];0!==r[l]&&(o=!1)}o&&(a.splice(e--,1),t=s(s.s=n[0]))}return t}var o={},i={app:0},r={app:0},a=[];function l(t){return s.p+"assets/js/"+({}[t]||t)+"-legacy."+{"chunk-14c5851b":"438805e4"}[t]+".js"}function s(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(t){var e=[],n={"chunk-14c5851b":1};i[t]?e.push(i[t]):0!==i[t]&&n[t]&&e.push(i[t]=new Promise((function(e,n){for(var o="assets/css/"+({}[t]||t)+"."+{"chunk-14c5851b":"5cb8f353"}[t]+".css",r=s.p+o,a=document.getElementsByTagName("link"),l=0;l<a.length;l++){var c=a[l],u=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(u===o||u===r))return e()}var d=document.getElementsByTagName("style");for(l=0;l<d.length;l++){c=d[l],u=c.getAttribute("data-href");if(u===o||u===r)return e()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=e,f.onerror=function(e){var o=e&&e.target&&e.target.src||r,a=new Error("Loading CSS chunk "+t+" failed.\n("+o+")");a.code="CSS_CHUNK_LOAD_FAILED",a.request=o,delete i[t],f.parentNode.removeChild(f),n(a)},f.href=r;var h=document.getElementsByTagName("head")[0];h.appendChild(f)})).then((function(){i[t]=0})));var o=r[t];if(0!==o)if(o)e.push(o[2]);else{var a=new Promise((function(e,n){o=r[t]=[e,n]}));e.push(o[2]=a);var c,u=document.createElement("script");u.charset="utf-8",u.timeout=120,s.nc&&u.setAttribute("nonce",s.nc),u.src=l(t);var d=new Error;c=function(e){u.onerror=u.onload=null,clearTimeout(f);var n=r[t];if(0!==n){if(n){var o=e&&("load"===e.type?"missing":e.type),i=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+o+": "+i+")",d.name="ChunkLoadError",d.type=o,d.request=i,n[1](d)}r[t]=void 0}};var f=setTimeout((function(){c({type:"timeout",target:u})}),12e4);u.onerror=u.onload=c,document.head.appendChild(u)}return Promise.all(e)},s.m=t,s.c=o,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(n,o,function(e){return t[e]}.bind(null,o));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=e,c=c.slice();for(var d=0;d<c.length;d++)e(c[d]);var f=u;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0015":function(t,e,n){"use strict";n("8e39")},"026d":function(t,e,n){"use strict";n("dd1c")},"034f":function(t,e,n){"use strict";n("64a9")},"07db":function(t,e,n){"use strict";n("1b47")},"13f1":function(t,e,n){"use strict";n("7e28")},"165c":function(t,e,n){"use strict";n("46c9")},"1b47":function(t,e,n){},"1f0e":function(t,e,n){"use strict";n("4e92")},"20fd":function(t,e,n){"use strict";n("d5bd")},"25cd":function(t,e,n){"use strict";n("9836")},"279b":function(t,e,n){},"287b":function(t,e,n){},"2cc5":function(t,e,n){},"2e74":function(t,e,n){"use strict";n("89c5")},"2fe4":function(t,e,n){},3176:function(t,e,n){"use strict";n("592a")},"31ec":function(t,e,n){},3552:function(t,e,n){},4131:function(t,e,n){},4260:function(t,e,n){"use strict";n.d(e,"l",(function(){return i})),n.d(e,"g",(function(){return a})),n.d(e,"k",(function(){return l})),n.d(e,"d",(function(){return c})),n.d(e,"i",(function(){return u["b"]})),n.d(e,"h",(function(){return d})),n.d(e,"a",(function(){return g})),n.d(e,"c",(function(){return h["b"]})),n.d(e,"b",(function(){return h["a"]})),n.d(e,"j",(function(){return h["d"]})),n.d(e,"f",(function(){return p})),n.d(e,"e",(function(){return m}));n("ac6a"),n("f3e2"),n("2caf"),n("6b54"),n("87b3");function o(){var t=+new Date,e=1e9*(1e4*Math.random()>>>0),n=(e+t).toString(32);return o._store[n]?o():(o._store[n]=!0,n)}o._store={},o.adapt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t.id},n=o._store;Array.isArray(t)&&t.forEach((function(t){var o=e(t);n[o]?console.warn("id duplicated",t.id):n[o]=o}))};var i=o,r=n("53ca");n("28a5");function a(t,e){var n=e.split(".");if(1===n.length)return t[e];var o,i=0,a=t,l=n.length;while(1){if(i==l-1)return a[n[i]];if(o=a[n[i]],!o||"object"!=Object(r["a"])(o))return console.error("无法获取嵌套属性 at "+n[i],t,e),null;a=o,i++}}function l(t,e,n){var o=e.split(".");if(1===o.length)return t[e]=n;var i,a=0,l=t,s=o.length-1;do{i=l[o[a]],i&&"object"==Object(r["a"])(i)?l=i:console.error("无法设置嵌套属性 at "+o[a],t,e),a++}while(a<s);return l.hasOwnProperty(o[a])||console.warn("设置原来没有的属性："+o[a]+" at ",l),l[o[a]]=n}function s(t){return JSON.parse(JSON.stringify(t))}var c=s,u=n("adb5");function d(t){var e=document.createElement("div");return e.appendChild(document.createTextNode(t)),e.innerHTML}function f(t){var e=document.createElement("div");return e.innerHTML=t,e.innerText}var h=n("9827");function p(t){return window.encodeURIComponent(window.btoa(window.encodeURIComponent(t)))}function m(t){return window.decodeURIComponent(window.atob(window.decodeURIComponent(t)))}function g(t,e,n){var o=t-e,i=n-t;return o>=0&&i>=0?t:Math.abs(o)>=Math.abs(i)?n:e}u["a"],u["b"],h["b"],h["a"]},4277:function(t,e,n){},"46c9":function(t,e,n){},"472d":function(t,e,n){},"4e92":function(t,e,n){},"529d":function(t,e,n){},5443:function(t,e,n){"use strict";n("2fe4")},"56d7":function(t,e,n){"use strict";n.r(e);var o=n("53ca"),i=(n("f4f9"),n("450d"),n("c2cc")),r=n.n(i),a=(n("7a0f"),n("0f6c")),l=n.n(a),s=(n("bd49"),n("18ff")),c=n.n(s),u=(n("960d"),n("defb")),d=n.n(u),f=(n("cb70"),n("b370")),h=n.n(f),p=(n("cbb5"),n("8bbc")),m=n.n(p),g=(n("826b"),n("c263")),v=n.n(g),b=(n("a7cc"),n("df33")),y=n.n(b),C=(n("0c67"),n("299c")),w=n.n(C),x=(n("eca7"),n("3787")),O=n.n(x),D=(n("ae26"),n("845f")),_=n.n(D),k=(n("1951"),n("eedf")),S=n.n(k),j=(n("e960"),n("b35b")),T=n.n(j),I=(n("016f"),n("486c")),E=n.n(I),P=(n("1f1a"),n("4e4b")),L=n.n(P),A=(n("9d4c"),n("e450")),$=n.n(A),F=(n("fe07"),n("6ac5")),M=n.n(F),N=(n("b5d8"),n("f494")),R=n.n(N),V=(n("b0ee"),n("d180")),z=n.n(V),B=(n("a335"),n("c0bb")),U=n.n(B),G=(n("d4df"),n("7fc1")),H=n.n(G),q=(n("560b"),n("dcdc")),W=n.n(q),J=(n("7f7f"),n("10cb"),n("f3ad")),Y=n.n(J),X=(n("9e1f"),n("6ed5")),K=n.n(X),Q=(n("0fb7"),n("f529")),Z=n.n(Q),tt=(n("6611"),n("e772")),et=n.n(tt),nt=(n("425f"),n("4105")),ot=n.n(nt),it=(n("cadf"),n("551c"),n("f751"),n("097d"),n("a026")),rt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{style:"height:"+t.height+"px",attrs:{id:"app"}},[n("Main")],1)},at=[],lt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"design-container"},[n("Header",{ref:"header",attrs:{"in-preview":t.showPreview,load:t.dataLoaded,formTitle:t.formTitle},on:{"form-tpl-change":t.replaceDesign,"save-click":function(e){return t.saveToServer()},"drop-item-click":t.handleCommand}}),t.showPreview?n("Preview",{attrs:{tableGuid:t.tableGuid,designId:t.designId}}):t._e(),t.showPreview?t._e():n("div",{staticClass:"design-body",class:{narrow:t.narrowMode,"view-pc":"pc"===t.viewType,"view-mobile":"mobile"===t.viewType}},[n("div",{staticClass:"design-leftbar"},[n("Tabs",{attrs:{value:t.leftActiveTab},on:{input:t.activeLeftTab}},[n("TabPanel",{attrs:{label:"布局",name:"layout"}},[n("PanelLayout")],1),n("TabPanel",{attrs:{label:"控件",name:"control"}},[n("PanelControl")],1),n("TabPanel",{attrs:{label:"数据域",name:"field"}},[n("PanelShare")],1)],1)],1),n("div",{staticClass:"design-view-container",class:{"view-real":!t.viewDesign,"view-design":t.viewDesign}},[t.dataLoaded?n("Design",{directives:[{name:"show",rawName:"v-show",value:"pc"===t.viewType,expression:"viewType === 'pc'"}],attrs:{data:t.design,size:t.formSize}}):t._e(),t.dataLoaded&&"mobile"===t.viewType?n("MobileDesign"):t._e()],1),n("div",{staticClass:"design-rightbar",class:{pickup:t.narrowMode&&t.rightbarHidden}},[t.narrowMode&&"pc"===t.viewType?n("el-button",{staticClass:"design-rightbar-toggle",attrs:{icon:"el-icon-d-arrow-right",plain:""},on:{click:function(e){t.rightbarHidden=!t.rightbarHidden}}}):t._e(),n("Tabs",{attrs:{"default-active":"form",value:t.rightActiveTab},on:{input:t.activeRightTab}},[n("TabPanel",{attrs:{label:"表单设置",name:"form"}},[t.dataLoaded?n("ConfigForm"):t._e()],1),n("TabPanel",{attrs:{label:"组件设置",name:"control"}},[t.selectedControl?n("ConfigControl",{attrs:{control:t.selectedControl}}):t._e(),t.selectedRowId?n("ConfigRow",{attrs:{"row-id":t.selectedRowId}}):t._e(),t.selectedControl||t.selectedRowId?t._e():n("div",[t._v("请选择控件或行")])],1),n("TabPanel",{attrs:{label:t.cellPanelName,name:"cell"}},[t.selectedColId?n("ConfigCell",{attrs:{"selected-col":t.selectedCol}}):n("div",[t._v("请选择单元格")])],1)],1)],1)]),t.needRender?n("LayoutGender",{ref:"builder",attrs:{list:t.design,"global-style":t.globalStyle}}):t._e(),n("NewFiledDialog"),t._e()],1)},st=[],ct=(n("1c01"),n("58b2"),n("8e6e"),n("456d"),n("a481"),n("4f37"),n("6d67"),n("0cd8"),n("d92a"),n("d25f"),n("2909")),ut=(n("f3e2"),n("2caf"),n("ac6a"),n("5df3"),n("ade3")),dt=(n("386d"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tabs-view"},[n("div",{staticClass:"tabs-head"},t._l(t.panels,(function(e,o){return n("div",{key:e.name,staticClass:"tab-head",class:t.active==e.name?t.activeClass:"",on:{click:function(e){return t.activeTab(o)}}},[t._v(t._s(e.label))])})),0),n("div",{staticClass:"tabs-body-wrap"},[n("div",{staticClass:"tabs-body",style:{width:t.width,marginLeft:t.marginLeft}},[t._t("default")],2)])])}),ft=[],ht={methods:{getPercent:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,n=Math.pow(10,e);return(Math.floor(100*t*n)/n).toFixed(2)+"%"}}},pt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tab-body",style:{width:t.width},attrs:{"data-name":t.name}},[t._t("default")],2)},mt=[];function gt(t,e,n){this.$children.forEach((function(o){var i=o.$options.name;i===t?o.$emit.apply(o,[e].concat(n)):gt.apply(o,[t,e].concat([n]))}))}var vt={methods:{dispatch:function(t,e,n){var o=this.$parent||this.$root,i=o.$options.name;while(o&&(!i||i!==t))o=o.$parent,o&&(i=o.$options.name);o&&o.$emit.apply(o,[e].concat(n))},broadcast:function(t,e,n){gt.call(this,t,e,n)}}},bt={name:"tab-panel",inject:["tabCount","activeIndex"],mixins:[ht,vt],props:{label:{type:String,required:!0},name:{type:String,required:!0}},computed:{width:function(){return this.getPercent(1/this.tabCount)}},methods:{propChange:function(){this.dispatch("Tabs","tab-panel-props-change")}},watch:{label:function(){this.propChange()},name:function(){this.propChange()}}},yt=bt,Ct=n("2877"),wt=Object(Ct["a"])(yt,pt,mt,!1,null,null,null),xt=wt.exports,Ot={name:"Tabs",mixins:[ht],props:{defaultActive:{type:String},activeClass:{type:String,default:"active"},value:{type:String}},components:{TabPanel:xt},provide:function(){return{tabCount:this.tabCount,activeIndex:this.activeIndex}},mounted:function(){this.$on("tab-panel-props-change",this.tabPanelChange)},beforeDestroy:function(){this.$off("tab-panel-props-change")},data:function(){return{active:this.value||this.defaultActive,tabCount:0,panels:this.getPanels()}},computed:{activeIndex:function(){if(this.panels.length)for(var t=0;t<this.panels.length;t++)if(this.panels[t].name==this.active)return t;return 0},width:function(){return this.getPercent(this.tabCount)},marginLeft:function(){return"-"+this.getPercent(this.activeIndex)}},watch:{panels:{immediate:!0,handler:function(){this.tabCount=this.panels.length}},value:function(t){t&&(this.active=t)},active:function(t){this.$emit("input",t)}},methods:{activeTab:function(t){this.active=this.panels[t].name},tabPanelChange:function(){this.panels=this.getPanels()},getPanels:function(){var t=this.$slots.default.filter((function(t){return t.tag&&t.componentOptions&&"tab-panel"===t.componentOptions.Ctor.options.name})),e=t.map((function(t){return t.componentOptions.propsData}));return e}}},Dt=Ot,_t=(n("6f10"),Object(Ct["a"])(Dt,dt,ft,!1,null,null,null)),kt=_t.exports,St=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("draggable",{staticClass:"layout-drag-area left-panel layout",attrs:{list:t.layoutList,group:{name:"layout",pull:"clone",put:!1},swapThreshold:"0.3",sort:!1,clone:t.createLayout,move:t.checkMove},on:{change:t.log,start:t.onDragStart,end:t.onDragEnd}},t._l(t.layoutList,(function(e,o){return n("div",{key:e.id||o,staticClass:"template-item layout-item",class:e.type},[n("span",{staticClass:"template-item-icon layout",class:e.icon}),n("span",{staticClass:"template-item-name"},[t._v(t._s(e.name))])])})),0)},jt=[],Tt=n("2f62"),It=n("4260");function Et(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Pt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Et(Object(n),!0).forEach((function(e){Object(ut["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Et(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Lt={name:"panel-layout",data:function(){return{layoutList:[{name:"一行2列",icon:"col-2",cols:[1,1],type:"row-layout"},{name:"一行4列",icon:"col-4",cols:[1,1,1,1],type:"row-layout"},{name:"一行6列",icon:"col-6",cols:[1,1,1,1,1,1],type:"row-layout"},{name:"1：5",icon:"col-2",cols:[1,5],type:"row-layout"},{name:"1：2：1：2",icon:"col-4",cols:[1,2,1,2],type:"row-layout"},{name:"多行多列",icon:"col-multi",cols:[],type:"row-layout"},{name:"手风琴布局",icon:"col-multi",cols:[1,1,1],type:"acc-layout"}]}},mixins:[vt],computed:Pt(Pt({},Object(Tt["e"])(["formSize"])),{},{initialBorder:function(){return this.$store.state.globalStyle.border}}),mounted:function(){this.dispatch("accordion","updated")},methods:Pt(Pt({},Object(Tt["d"])(["layoutDragStart","layoutDragEnd"])),{},{createLayout:function(t){return"row-layout"==t.type?this.createRowLayout(t):"acc-layout"==t.type?this.createAccLayout(t):void 0},createAccLayout:function(t){var e=this.createRowLayout(t);return e.props={showNav:!1},e.cols.forEach((function(t,e){t.type="acc-item",t.style.width="100%",t.props={title:"手风琴项目-"+(e+1),opened:!0}})),e},createRowLayout:function(t){var e=Object(It["l"])(),n=It["j"].getIndex(t.name),o={id:e,name:"",autoIndex:n,namePrefix:t.name,cols:this.createCols(t.cols,e),type:t.type||"row-layout",height:38};return 0==t.cols.length&&(o.asMulti=!0,o.cols=this.createCols([1],e)),o},createCols:function(t,e){var n=this,o=t.reduce((function(t,e){return t+e}),0),i=this.formSize.width;return t.map((function(t){var r=It["b"].getIndex(e);return{id:"col-".concat(e,"-").concat(r),name:"col-".concat(r),type:"col-item",style:{verticalAlign:"middle",textAlign:"center",width:i*t/o,border:Object(It["d"])(n.initialBorder)},subs:[],controls:[]}}))},checkMove:function(t){if(this.$el==t.to||this.$el.compareDocumentPosition(t.to)&Node.DOCUMENT_POSITION_CONTAINED_BY)return!1;var e=t.draggedContext.element;return!(1==e.cols&&!t.to.classList.contains("level-0"))&&(!("acc-layout"==e.type&&!t.to.classList.contains("level-0"))&&void 0)},onDragStart:function(){this.layoutDragStart()},onDragEnd:function(){this.layoutDragEnd()},log:function(){var t;(t=console).log.apply(t,arguments)}})},At=Lt,$t=Object(Ct["a"])(At,St,jt,!1,null,null,null),Ft=$t.exports,Mt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"left-panel"},[t.baseControls.length?n("Accordion",{attrs:{title:"基础控件"}},[n("draggable",{staticClass:"control-drag-area",attrs:{list:t.baseControls,group:{name:"control",pull:"clone",put:!1},swapThreshold:"0.3",sort:!1,clone:t.createControl,emptyInsertThreshold:20,move:t.checkMove},on:{change:t.log}},t._l(t.baseControls,(function(e,o){return n("div",{key:e.type+o,staticClass:"template-item control-tpl-item",attrs:{"data-control-type":e.type}},[n("span",{staticClass:"template-item-icon control",class:e.icon}),n("span",{staticClass:"template-item-name"},[t._v(t._s(e.name))])])})),0)],1):t._e(),t.extControls.length?n("Accordion",{attrs:{title:"扩展控件"}},[n("draggable",{staticClass:"control-drag-area",attrs:{list:t.extControls,group:{name:"control",pull:"clone",put:!1},swapThreshold:"0.3",sortable:!1,clone:t.createControl,move:t.checkMove},on:{change:t.log}},t._l(t.extControls,(function(e,o){return n("div",{key:e.type+o,staticClass:"template-item control-tpl-item",attrs:{"data-control-type":e.type}},[n("span",{staticClass:"template-item-icon control",class:e.icon}),n("span",{staticClass:"template-item-name"},[t._v(t._s(e.name))])])})),0)],1):t._e(),t.commonControls.length?n("Accordion",{attrs:{title:"通用字段"}},[t._l(t.commonControlsTree,(function(e){return[n("h3",{key:"header-"+e.id,staticClass:"common-control-catalog"},[t._v(t._s(e.name))]),n("draggable",{key:"body-"+e.id,staticClass:"control-drag-area",attrs:{list:e.children,group:{name:"control",pull:"clone",put:!1},swapThreshold:"0.3",sortable:!1,clone:t.createdCommonControl,move:t.checkMove},on:{change:t.log}},t._l(e.children,(function(o){return n("div",{key:e.id+o.name+o.type,staticClass:"template-item control-tpl-item",attrs:{"data-control-type":o.type,title:o.name}},[n("span",{staticClass:"template-item-icon control",class:o.icon}),n("span",{staticClass:"template-item-name"},[t._v(t._s(o.name))])])})),0)]}))],2):t._e()],1)},Nt=[],Rt=(n("57e7"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"accordion"},[n("div",{staticClass:"accordion-header"},[n("span",{staticClass:"accordion-title"},[t._v(t._s(t.title))]),n("span",{staticClass:"accordion-toggle el-icon-arrow-down",class:{collaspe:t.collaspe},on:{click:function(e){t.collaspe=!t.collaspe}}})]),n("transition",{on:{"before-enter":t.beforeEnter,enter:t.enter,"after-enter":t.afterEnter,"before-leave":t.beforeLeave,leave:t.leave,"after-leave":t.afterLeave}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!t.collaspe,expression:"!collaspe"}],ref:"body",staticClass:"accordion-body",class:{collaspe:t.collaspe}},[t._t("default")],2)])],1)}),Vt=[],zt={name:"accordion",props:{title:{type:String,required:!0}},data:function(){return{collaspe:!1,inGroup:!1}},mounted:function(){"accordion-group"==this.$parent.$options.name&&(this.inGroup=!0)},methods:{beforeEnter:function(t){t.classList.add("collapse-transition"),t.dataset||(t.dataset={}),t.dataset.oldPaddingTop=t.style.paddingTop,t.dataset.oldPaddingBottom=t.style.paddingBottom,t.style.height="0",t.style.paddingTop=0,t.style.paddingBottom=0,t.style.opacity=0},enter:function(t){t.dataset.oldOverflow=t.style.overflow,0!==t.scrollHeight?(t.style.height=t.scrollHeight+"px",t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom):(t.style.height="",t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom),t.style.opacity=1,t.style.overflow="hidden"},afterEnter:function(t){t.classList.remove("collapse-transition"),t.style.height="",t.style.overflow=t.dataset.oldOverflow,t.style.opacity=""},beforeLeave:function(t){t.dataset||(t.dataset={}),t.dataset.oldPaddingTop=t.style.paddingTop,t.dataset.oldPaddingBottom=t.style.paddingBottom,t.dataset.oldOverflow=t.style.overflow,t.style.height=t.scrollHeight+"px",t.style.overflow="hidden",t.style.opacity=1},leave:function(t){0!==t.scrollHeight&&t.classList.add("collapse-transition"),t.style.height=0,t.style.paddingTop=0,t.style.paddingBottom=0,t.style.opacity=0},afterLeave:function(t){t.style.height="",t.style.overflow=t.dataset.oldOverflow,t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom,t.style.opacity=""},setCollaspe:function(t){this.collaspe=void 0!==t?!!t:!this.collaspe}},watch:{collaspe:function(t){this.inGroup&&this.$parent.updateStatus(t,this),this.$emit("change",t)}}},Bt=zt,Ut=(n("5443"),Object(Ct["a"])(Bt,Rt,Vt,!1,null,null,null)),Gt=Ut.exports,Ht=window.FORM_DESIGN_CONFIG.controlList,qt={name:"panel-control",components:{Accordion:Gt},data:function(){return{baseControls:Object(It["d"])(Ht)}},computed:{extControls:function(){return this.$store.state.extControls},commonControls:function(){return this.$store.state.commonControls},commonControlsTree:function(){var t=this.commonControls,e={};return t.forEach((function(t){var n=t.businessType,o=t.businessName;n&&o&&(e[n]||(e[n]={id:n,name:o,children:[]}),e[n].children.push(t))})),Object.keys(e).map((function(t){return e[t]}))}},mixins:[vt],mounted:function(){this.update()},methods:{update:function(){this.dispatch("accordion","updated")},createdCommonControl:function(t){var e=this.createControl(t),n=Object(It["d"])(t.props),o={};return Object.keys(e).forEach((function(t){o[t.toLowerCase()]=t})),Object.keys(n).forEach((function(t){var i=t.toLowerCase(),r=o[i];r?e[r]=n[t]:e[t]=n[t]})),void 0!==t.fieldName&&(e.fieldName=t.fieldName),void 0!==t.universalId&&(e.universalId=t.universalId),t.name&&!e.name&&(e.name=t.name),e},createControl:function(t){var e=t.type,n=t.icon,o=t.name,i=window.FORM_DESIGN_CONFIG.controls[e];if(!i)throw new Error("控件的 ".concat(e," 配置信息不存在，无法创建"));var r=Object(It["d"])(i);delete r.configItems;var a=It["c"].getIndex(e),l=Object(It["l"])();return r.id=e+"-"+l,r.namePrefix=o,r.autoIndex=a,r.name="",r.icon=n,r.width||(r.width="100%"),-1!=["title","label","output"].indexOf(e)&&this.copyGlobalStyleToControl(r),r},copyGlobalStyleToControl:function(t){var e=this.$store.state.globalStyle,n=e.fontSize,o=e.fontFamily,i=e.fontColor,r=e.fontBolder,a=e.fontItalic,l=e.fontUnderline;"label"==t.type&&(t.fontSize=n),t.fontFamily=o,t.fontColor=i,t.fontBolder=r,t.fontItalic=a,t.fontUnderline=l},checkMove:function(t){if(this.$el==t.to||this.$el.compareDocumentPosition(t.to)&Node.DOCUMENT_POSITION_CONTAINED_BY)return!1;var e=t.draggedContext.element;return!("hiddenfield"===e.type^t.to.classList.contains("design-hidden-area"))},log:function(){var t;(t=console).log.apply(t,arguments)}},watch:{extControls:function(){this.update()},baseControls:function(){this.update()},commonControls:function(){this.update()}}},Wt=qt,Jt=Object(Ct["a"])(Wt,Mt,Nt,!1,null,null,null),Yt=Jt.exports,Xt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"left-panel"},[n("div",{staticClass:"search-panel left-search"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.keySearch,expression:"keySearch"}],attrs:{type:"text",placeholder:"输入关键字"},domProps:{value:t.keySearch},on:{input:function(e){e.target.composing||(t.keySearch=e.target.value)}}})]),n("el-collapse",{on:{change:t.handleChange},model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},t._l(t.shareFieldList,(function(e,o){return e.hide?t._e():n("el-collapse-item",{key:e.id,attrs:{title:e.name,name:e.id}},[n("draggable",{staticClass:"control-drag-area",attrs:{list:e.children,group:{name:"control",pull:"clone",put:!1},swapThreshold:"0.3",sort:!1,clone:t.createdCommonControl,emptyInsertThreshold:20,move:t.checkMove},on:{start:t.moveStart,end:function(e){return t.moveEnd(e)},change:t.log}},t._l(e.children,(function(e,i){return e.hide?t._e():n("div",{key:e.id,staticClass:"field-item template-item",class:{disable:e.isUse},attrs:{"data-name":e.name,"data-id":o+"_"+i,"data-control-type":e.type}},[n("span",{staticClass:"field-item-name"},[t._v(t._s(e.name))]),e.typeName?n("span",{staticClass:"field-item-type"},[t._v("["+t._s(e.typeName)+"]")]):t._e(),n("i",{staticClass:"field-item-icon",class:{active:t.fieldCurrent==o+"_"+i||e.shareName},on:{click:function(n){return t.showConfig(e,o,i)}}})])})),0)],1)})),1),t.isShowConfig?n("div",{staticClass:"config-panel"},[n("h3",{staticClass:"config-panel-title"},[t._v(t._s(t.currentShowField.name))]),n("i",{staticClass:"el-icon-close config-panel-close",on:{click:t.hideConfig}}),n("div",{staticClass:"search-panel"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.configSearch,expression:"configSearch"}],attrs:{type:"text",placeholder:"输入关键字"},domProps:{value:t.configSearch},on:{input:function(e){e.target.composing||(t.configSearch=e.target.value)}}})]),n("div",{staticClass:"config-panel-collapse"},[n("el-collapse",{on:{change:t.handleChange},model:{value:t.activeConfig,callback:function(e){t.activeConfig=e},expression:"activeConfig"}},t._l(t.configList,(function(e){return e.hide?t._e():n("el-collapse-item",{key:e.id,attrs:{title:e.name,name:e.id}},t._l(e.children,(function(e){return e.hide?t._e():n("el-checkbox",{key:e.id,staticClass:"check-field",class:{"same-field":e.shareName&&t.currentShowField.shareName==e.shareName},attrs:{disabled:e.isUse||!!e.shareName,label:e.name},model:{value:e.check,callback:function(n){t.$set(e,"check",n)},expression:"field.check"}})})),1)})),1)],1),n("div",{staticClass:"config-panel-button"},[n("el-button",{attrs:{type:"primary"},on:{click:t.saveConfig}},[t._v("保存")]),n("el-button",{staticClass:"config-panel-button-right",attrs:{type:"text"},on:{click:t.clearRelative}},[t._v("清空合并关系")])],1)]):t._e()],1)},Kt=[],Qt=(n("28a5"),n("84a2")),Zt=n.n(Qt);function te(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ee(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?te(Object(n),!0).forEach((function(e){Object(ut["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ne=window.FORM_DESIGN_CONFIG.controlList,oe=new URLSearchParams(location.search),ie=oe.get("designId")||"",re=oe.get("tableGuid")||"",ae=function(t){var e={};return t.forEach((function(t){e[t]=!0})),e}(["activeRightTab","updateLineTop","updateLineLeft","showHLine","hideHLine","showVLine","hideVLine","layoutDragStart","layoutDragEnd","controlDragStart","controlDragEnd","toggleViewDesign","updateViewType","setJsCode","setCssCode","addToNewFieldList"]),le=function(t){var e={};return t.forEach((function(t){e[t]=!0})),e}(["updateRowHeight","updateColWidth"]),se={name:"panel-control",data:function(){return{baseControls:Object(It["d"])(ne),activeNames:["1"],activeConfig:["c-1","c-2"],isShowConfig:!1,check:!0,currentShowField:{},keySearch:"",configSearch:"",fieldCurrent:"",configList:[],canMove:!1}},computed:ee(ee({},Object(Tt["e"])(["shareFieldList"])),{},{extControls:function(){return this.$store.state.extControls},design:function(){return this.$store.state.design}}),mixins:[vt],mounted:function(){this.update(),this.getFieldList(),this.subscribeStore()},methods:{update:function(){this.dispatch("accordion","updated")},subscribeStore:function(){var t=this,e=function(e){if("removeControl"===e.type&&e.payload&&e.payload.selectedControl&&t.recoveryCanUse(e.payload.selectedControl.id,!1),"removeRow"===e.type&&e.payload&&e.payload.row){var n=e.payload.row;"row-layout"===n.type?n.cols.forEach((function(e){e.controls.forEach((function(e){t.recoveryCanUse(e.id,!1)})),e.subs.length&&t.recursionRemove(e.subs)})):"acc-layout"===n.type&&n.cols.forEach((function(e){e.subs.length&&t.recursionRemove(e.subs)}))}},n=Zt()(e,300,{leading:!0,trailing:!1});this.$store.subscribe((function(t,o){var i=t.type;ae[i]||(le[i]?n(t,o):e(t,o))}))},recursionRemove:function(t){var e=this;t.forEach((function(t){t.cols.forEach((function(t){t.controls.forEach((function(t){e.recoveryCanUse(t.id,!1)})),t.subs&&e.recursionRemove(t.subs)}))}))},handleChange:function(t){},getFieldList:function(){var t=this;this.$httpPost(window.formDesignerActions.getFieldListUrl,{formId:re,designId:ie}).then((function(e){t.$store.commit("setShareFieldList",{value:e}),t.activeNames=[],e.length&&(t.activeNames=[e[0].id])})).catch((function(t){console.error(t)}))},getFieldConfig:function(){var t=this,e=this.currentShowField.tableId,n=this.currentShowField.fieldName,o=this.currentShowField.formGuid,i=this.currentShowField.fieldType,r=this.currentShowField.type;this.$httpPost(window.formDesignerActions.getFieldConfigUrl,{formId:re,designId:ie,fieldType:i,type:r,tableId:e,fieldName:n,formGuid:o}).then((function(e){t.configList=e,t.isShowConfig=!0,t.activeConfig=[],e.forEach((function(e){t.activeConfig.push(e.id)}))})).catch((function(t){console.error(t)}))},showConfig:function(t,e,n){var o=this;o.fieldCurrent=e+"_"+n,this.currentShowField=t,this.getFieldConfig()},hideConfig:function(){this.isShowConfig=!1,this.fieldCurrent=""},createdCommonControl:function(t){var e=this.createControl(t),n=Object(It["d"])(t.props);return Object.keys(n).forEach((function(t){e[t]=n[t]})),e},createControl:function(t){var e=t.type,n=t.typeIcon,o=t.name,i=t.tableId,r=t.props,a=window.FORM_DESIGN_CONFIG.controls[e];if(!a)throw new Error("控件的 ".concat(e," 配置信息不存在，无法创建"));var l=Object(It["d"])(a);delete l.configItems;var s=It["c"].getIndex(e),c=Object(It["l"])();t["uuid"]=e+"-"+c,l.id=e+"-"+c,l.namePrefix=o,l.autoIndex=s,l.name="",l.icon=n,l.tableId=i;var u=this.$store.getters.fieldMap;return r.bind&&!(r.bind in u)&&(l.bind="",l.props&&(l.props.bind=""),r.bind=""),r.bind2&&!(r.bind2 in u)&&(l.bind2="",l.props&&(l.props.bind2=""),r.bind=""),l.width||(l.width="100%"),-1!=["title","label","output"].indexOf(e)&&this.copyGlobalStyleToControl(l),l},recoveryCanUse:function(t,e){this.shareFieldList.forEach((function(n){n.children.forEach((function(n){n.uuid===t&&(n.isUse=e)}))}))},copyGlobalStyleToControl:function(t){var e=this.$store.state.globalStyle,n=e.fontSize,o=e.fontFamily,i=e.fontColor,r=e.fontBolder,a=e.fontItalic,l=e.fontUnderline;"label"==t.type&&(t.fontSize=n),t.fontFamily=o,t.fontColor=i,t.fontBolder=r,t.fontItalic=a,t.fontUnderline=l},moveStart:function(){this.canMove=!1},moveEnd:function(t){if(this.canMove){var e=t.item.dataset.id,n=e.split("_")[0],o=e.split("_")[1];this.shareFieldList[n].children[o].isUse=!0;var i=this.shareFieldList[n].children[o].props||"";i&&(i.id=this.shareFieldList[n].children[o].uuid,this.$store.commit("updateControlProp",{control:i,prop:"emptytext",value:i.emptytext,shuttle:!1}))}},checkMove:function(t){if(this.$el==t.to||this.$el.compareDocumentPosition(t.to)&Node.DOCUMENT_POSITION_CONTAINED_BY)return!1;var e=t.draggedContext.element;return!t.dragged.classList.contains("disable")&&(this.canMove=!0,!("hiddenfield"===e.type^t.to.classList.contains("design-hidden-area")))},log:function(){var t;(t=console).log.apply(t,arguments)},saveConfig:function(){var t=[],e=[],n=this,o=JSON.parse(JSON.stringify(this.configList));o.forEach((function(n){n.children.forEach((function(n){!n.isUse&&n.check&&(t.push(n),e.push(n.id))}))})),this.saveConfigUrl(t,(function(){n.getFieldList(),n.shareFieldList.forEach((function(t){t.children.forEach((function(t){e.indexOf(t.id)>-1&&(n.currentShowField.isUse||(t.isUse=!1),n.removeFromDesign(t.uuid))}))})),n.isShowConfig=!1,n.fieldCurrent=""}))},saveConfigUrl:function(t,e){var n=this,i=this.currentShowField.tableId,r=this.currentShowField.fieldName,a=this.currentShowField.formGuid,l=this.currentShowField.fieldType,s=this.currentShowField.name,c=this.currentShowField.type;this.$httpPost(window.formDesignerActions.saveFieldConfigUrl,{formId:re,designId:ie,tableId:i,fieldName:r,name:s,type:c,formGuid:a,fieldType:l,list:t}).then((function(t){var i=t.custom||"",r="保存成功";i&&("string"==typeof i&&(i=JSON.parse(i)),"object"==Object(o["a"])(i)&&(r=i.msg||"保存成功")),n.$msgbox({title:"系统提醒",message:r,type:"success",showClose:!0,callback:function(){}}),"function"==typeof e&&e()})).catch((function(t){console.error(t)}))},recursionRemoveSome:function(t,e){var n,o,i=this;t.forEach((function(t){t.cols.forEach((function(t){t.controls.forEach((function(r,a){i.recoveryCanUse(r.id,!1),r.id===e&&(n=a,o=t,o.controls.splice(n,1))})),t.subs&&i.recursionRemoveSome(t.subs,e)}))}))},removeFromDesign:function(t){var e,n,o=this,i=JSON.parse(JSON.stringify(this.design));i.forEach((function(i){"acc-layout"===i.type?i.cols.forEach((function(e){o.recursionRemoveSome(e.subs,t)})):i.cols.forEach((function(i){i.controls.forEach((function(o,r){o.id===t&&(e=r,n=i,n.controls.splice(e,1))})),i.subs.length&&o.recursionRemoveSome(i.subs,t)}))})),this.$store.commit("updateDesign",i)},clearRelative:function(){var t=this,e=this.currentShowField.shareName;e?this.$httpPost(window.formDesignerActions.deleteFieldRelationUrl,{formId:re,shareName:e,designId:ie}).then((function(e){var n=e.custom||"",i="清除成功";n&&("string"==typeof n&&(n=JSON.parse(n)),"object"==Object(o["a"])(n)&&(i=n.msg||"清除成功")),t.$msgbox({title:"系统提醒",message:i,type:"success",showClose:!0,callback:function(){}}),t.getFieldConfig(),t.getFieldList()})).catch((function(t){console.error(t)})):this.configList.forEach((function(t){t.children.forEach((function(t){!t.isUse&&t.check&&(t.check=!1)}))}))}},watch:{extControls:function(){this.update()},baseControls:function(){this.update()},keySearch:function(t){this.shareFieldList.forEach((function(e){var n=!0;e.children.forEach((function(e){e.name.indexOf(t)>-1?(e["hide"]=!1,n=!1):e["hide"]=!0})),e["hide"]=n}))},configSearch:function(t){this.configList.forEach((function(e){var n=!0;e.children.forEach((function(e){e.name.indexOf(t)>-1?(e["hide"]=!1,n=!1):e["hide"]=!0})),e["hide"]=n}))}}},ce=se,ue=(n("8ac3"),Object(Ct["a"])(ce,Xt,Kt,!1,null,null,null)),de=ue.exports,fe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"designArea",staticClass:"design-area",staticStyle:{position:"relative"},style:{width:t.size.width+20+"px"},attrs:{id:"design-area","data-width":t.size.width,"data-height":t.size.height},on:{click:t.handleFormClick}},[n("RowLayout",{attrs:{list:t.data}}),n("HelperLine",{directives:[{name:"show",rawName:"v-show",value:t.showVLine,expression:"showVLine"}],attrs:{type:"v"}}),n("HelperLine",{directives:[{name:"show",rawName:"v-show",value:t.showHLine,expression:"showHLine"}],attrs:{type:"h"}}),n("draggable",{staticClass:"design-hidden-area",attrs:{group:"control",move:t.checkControlMove},model:{value:t.hiddenControls,callback:function(e){t.hiddenControls=e},expression:"hiddenControls"}},t._l(t.hiddenControls,(function(e,o){return n("Control",{key:e.id,class:{selected:e.id==t.selectedControlId},attrs:{"control-data":e},nativeOn:{click:function(n){return n.stopPropagation(),t.onControlClick(e,o,t.hiddenControls)}}})})),1),n("div",{domProps:{innerHTML:t._s(t.colBorderStyle)}}),n("v-contextmenu",{ref:"ctxMenu"},[n("v-contextmenu-item",{on:{click:function(e){return t.ctxMneuItemHandle("insertRowUp")}}},[t._v("向上插入1行")]),n("v-contextmenu-item",{on:{click:function(e){return t.ctxMneuItemHandle("insertRowDown")}}},[t._v("向下插入1行")]),n("v-contextmenu-item",{attrs:{divider:""}}),n("v-contextmenu-item",{attrs:{disabled:"row-layout"!=t.ctxMenuData.type},on:{click:function(e){return t.ctxMneuItemHandle("insertColLeft")}}},[t._v("向左插入1列")]),n("v-contextmenu-item",{attrs:{disabled:"row-layout"!=t.ctxMenuData.type},on:{click:function(e){return t.ctxMneuItemHandle("insertColRight")}}},[t._v("向右插入1列")]),n("v-contextmenu-item",{attrs:{divider:""}}),n("v-contextmenu-item",{attrs:{disabled:!t.ctxMenuData.isControl},on:{click:function(e){return t.ctxMneuItemHandle("deleteControl")}}},[t._v("删除控件")]),"acc-layout"==t.ctxMenuData.type?n("v-contextmenu-item",{attrs:{disabled:!t.ctxMenuData.colDeletable||t.ctxMenuData.isControl},on:{click:function(e){return t.ctxMneuItemHandle("removeCol")}}},[t._v("删除此手风琴项")]):t._e(),"acc-layout"!=t.ctxMenuData.type?n("v-contextmenu-item",{attrs:{disabled:!t.ctxMenuData.colDeletable||t.ctxMenuData.isControl},on:{click:function(e){return t.ctxMneuItemHandle("removeCol")}}},[t._v("删除此列")]):t._e(),"acc-layout"==t.ctxMenuData.type?n("v-contextmenu-item",{attrs:{disabled:t.ctxMenuData.isControl},on:{click:function(e){return t.ctxMneuItemHandle("removeRow")}}},[t._v("删除此手风琴")]):t._e(),"acc-layout"!=t.ctxMenuData.type?n("v-contextmenu-item",{attrs:{disabled:t.ctxMenuData.isControl},on:{click:function(e){return t.ctxMneuItemHandle("removeRow")}}},[t._v("删除此行")]):t._e()],1),n("el-dialog",{staticClass:"multi-row-dialog",attrs:{"append-to-body":"",title:"请输入行列",visible:t.dialogVisible,width:"460px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("el-form",{attrs:{model:t.rowData,size:"mini",inline:"","inline-message":""}},[n("el-form-item",{attrs:{label:"行数目"}},[n("el-input-number",{attrs:{min:1,max:20,controls:!1,autocomplete:"off"},model:{value:t.rowData.rowCount,callback:function(e){t.$set(t.rowData,"rowCount",e)},expression:"rowData.rowCount"}})],1),n("el-form-item",{attrs:{label:"列数目"}},[n("el-input-number",{attrs:{min:1,max:20,controls:!1},model:{value:t.rowData.colCount,callback:function(e){t.$set(t.rowData,"colCount",e)},expression:"rowData.colCount"}})],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.handleDialogClose("cancel")}}},[t._v("取 消")]),n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.handleDialogClose("ok")}}},[t._v("确 定")])],1)],1)],1)},he=[],pe=n("eafa"),me=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"helper-line",class:{"line-v":"v"===t.type,"line-h":"h"===t.type},style:t.styleText})},ge=[],ve={props:{type:{type:String,default:"v"}},computed:{left:function(){return this.$store.state.helper.left},top:function(){return this.$store.state.helper.top},styleText:function(){return"v"==this.type?"left: ".concat(this.left,"px;"):"h"==this.type?"top: ".concat(this.top,"px;"):""}}},be=ve,ye=(n("d56b"),Object(Ct["a"])(be,me,ge,!1,null,null,null)),Ce=ye.exports,we=n("a3de");function xe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Oe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?xe(Object(n),!0).forEach((function(e){Object(ut["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var De={name:"design",components:{RowLayout:pe["default"],HelperLine:Ce,Control:we["a"]},provide:function(){var t=this;return{getDesignContainer:function(){return t.$refs.designArea},showCtxMenu:this.showCtxMenu,showMutliRowConfirm:this.showMutliRowConfirm}},props:{data:{type:Array},size:{type:Object}},data:function(){return{ctxMneuItemHandle:function(){},ctxMenuData:{isControl:!1,colDeletable:!0,type:"row-layout"},rowData:{rowCount:1,colCount:1},dialogVisible:!1,dialogOkCallback:function(){}}},computed:Oe(Oe({},Object(Tt["e"])({showVLine:function(t){return t.helper.showVLine},showHLine:function(t){return t.helper.showHLine}})),{},{selectedControlId:function(){return this.$store.state.selectedControlId},hiddenControls:{get:function(){return this.$store.state.hiddenControls},set:function(t){this.$store.commit("setHiddenControls",t)}},colBorderStyle:function(){return"<style>"+this.$store.getters.colStyleText+"</style>"}}),methods:Oe(Oe({},Object(Tt["b"])(["setSelectedControl","setSelectedLayout","activeRightTab"])),{},{onControlClick:function(t,e,n){this.setSelectedControl({id:t.id}),this.activeRightTab("control")},checkControlMove:function(t){if(!t.to.classList.contains("design-hidden-area"))return!1},handleFormClick:function(t){var e=t.target;e.closest(".row")||this.activeRightTab("form")},showMutliRowConfirm:function(t){this.dialogVisible=!0,this.dialogOkCallback=t},adjustCtxPos:function(t,e){var n=this;this.$nextTick((function(){var o={top:e,left:t},i=n.$refs.ctxMenu.clientWidth,r=n.$refs.ctxMenu.clientHeight;r+e>=window.innerHeight&&(o.top-=r),i+t>=window.innerWidth&&(o.left-=i),n.$refs.ctxMenu.style={top:"".concat(o.top,"px"),left:"".concat(o.left,"px")}}))},showCtxMenu:function(t,e,n){this.ctxMenuData.isControl=!!e.control,this.ctxMenuData.colDeletable=e.colDeletable,this.ctxMenuData.type=e.row.type||"row-layout",this.ctxMneuItemHandle=n;var o=t.pageX,i=t.pageY;this.$refs.ctxMenu.show({top:i,left:o}),this.adjustCtxPos(o,i)},handleDialogClose:function(t){this.dialogVisible=!1;var e=this.rowData,n=e.rowCount,o=e.colCount;"ok"==t?this.dialogOkCallback(n,o):this.dialogOkCallback(1,1),this.rowData.rowCount=1,this.rowData.colCount=1}})},_e=De,ke=(n("026d"),n("f1a3"),Object(Ct["a"])(_e,fe,he,!1,null,null,null)),Se=ke.exports,je=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mobile-designer-area"},[n("div",{staticClass:"right-fixed-area"},[n("el-tooltip",{attrs:{placement:"top",enterable:!1,"open-delay":300,content:"一键同步"}},[n("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:t.onSyncCLick}})],1)],1),n("Device",{attrs:{type:"iphone-8",color:"silver"}},[n("draggable",{staticClass:"mobile-form-container",attrs:{group:"data",list:t.list,direction:"vertical"},on:{add:t.onDataAdd}},t._l(t.list,(function(e,o){return n("div",{key:e.id,staticClass:"mobile-form-item",class:t.getCls(e,o),attrs:{"data-index":o}},[n("label",{staticClass:"mobile-form-label"},[e.label?n("span",[t._v(t._s(e.label.labelText))]):t._e()]),n("span",{staticClass:"mobile-form-control"},[e.control?n("MobileControl",{attrs:{"control-data":e.control}}):t._e()],1),n("div",{staticClass:"mobile-form-helper row-helper"},[n("el-tooltip",{attrs:{placement:"top",enterable:!1,"open-delay":300,content:"切换显示"}},[n("span",{staticClass:"row-helper-btn view el-icon-view",on:{click:function(n){return t.onVisibleChange(e,o)}}})]),n("el-tooltip",{attrs:{placement:"top",enterable:!1,"open-delay":300,content:"选择"}},[n("span",{staticClass:"row-helper-btn selected el-icon-top-left",on:{click:function(n){return n.stopPropagation(),t.onItemClick(e,o)}}})])],1)])})),0)],1)],1)},Te=[],Ie=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(t.getControlComponent(t.controlData.type),{tag:"component",attrs:{"control-data":t.controlData}})},Ee=[],Pe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mui-card"},[n("div",{staticClass:"mui-input-group ep-mui-radiobuttonlist"},t._l(t.dataList,(function(e){return n("div",{key:e.id,staticClass:"mui-input-row mui-radio"},[n("label",[t._v(t._s(e.text))]),n("input",{attrs:{type:"radio",name:t.controlData.id},domProps:{value:e.id}}),n("span",{staticClass:"el-radio__inner"})])})),0)])},Le=[],Ae=n("ab9e"),$e={props:["controlData"],mixins:[Ae["a"]],data:function(){return{currValue:this.controlData.value||"",defaultDataList:[1,2,3].map((function(t){return{id:t,text:"选项-"+t}})),originData:[]}},created:function(){this.getDataList()}},Fe=$e,Me=(n("6da2"),Object(Ct["a"])(Fe,Pe,Le,!1,null,null,null)),Ne=Me.exports,Re=["controlData"],Ve={textbox:{props:Re,template:'<input type="text" :placeholder="controlData.emptyText || controlData.type" />'},textarea:{props:Re,template:'<textarea :placeholder="controlData.emptyText || controlData.type" ></textarea>'},radiobuttonlist:Ne,checkboxlist:Ne,webuploader:{props:Re,template:'<div class="uploader-wrap"><span class="uploader-btn"></span></div>'}},ze={props:Re,template:'<input type="text" :placeholder="controlData.emptyText || controlData.type" />'},Be={name:"mobile-control",props:Re,methods:{getControlComponent:function(t){return t in Ve?Ve[t]:ze}}},Ue=Be,Ge=(n("1f0e"),Object(Ct["a"])(Ue,Ie,Ee,!1,null,null,null)),He=Ge.exports,qe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"device",class:t.className},[n("div",{staticClass:"device-frame"},[n("div",{staticClass:"device-content"},[t._t("default")],2)]),n("div",{staticClass:"device-stripe"}),n("div",{staticClass:"device-header"}),n("div",{staticClass:"device-sensors"}),n("div",{staticClass:"device-btns"}),n("div",{staticClass:"device-power"})])},We=[],Je=(n("7d5a"),{name:"device",props:{type:{type:String,default:"iphone-8"},color:{type:String,default:"silver"}},computed:{className:function(){return"device-".concat(this.type," device-").concat(this.color)}}}),Ye=Je,Xe=Object(Ct["a"])(Ye,qe,We,!1,null,null,null),Ke=Xe.exports;function Qe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Ze(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Qe(Object(n),!0).forEach((function(e){Object(ut["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Qe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var tn=Object.prototype.hasOwnProperty,en={name:"mobile-design",components:{MobileControl:He,Device:Ke},data:function(){return{list:[],activeIndex:-1}},computed:Ze({},Object(Tt["e"])(["mobileDesignData"])),methods:{getCls:function(t,e){var n;return n={hide:!t.visible},Object(ut["a"])(n,t.control&&t.control.type,!0),Object(ut["a"])(n,"active",this.activeIndex===e),n},dealData:function(t){return t.map((function(t){return tn.call(t,"visible")||(t.visible=!0),t}))},pc2mobile:function(){var t=this;return this.loading=!0,this.$parent.getData({withBuild:!1}).then((function(e){return t.$httpPost(window.formDesignerActions.pc2mobileUrl,e)})).then((function(e){t.list=t.dealData(e.mobileDesignData)})).finally((function(){t.loading=!1}))},onSyncCLick:function(){var t=this;this.$msgbox({title:"提示",message:"是否按照当前PC表单配置，同步生成移动端表单？（该操作将覆盖现有移动表单配置）",confirmButtonText:"同步并覆盖",showCancelButton:!0,cancelText:"取消",iconClass:"el-icon-question",callback:function(e){"confirm"==e&&t.pc2mobile()}})},initSync:function(){var t=this;this.$msgbox({title:"初始化",message:"可按照pc表单配置，快速完成移动端表单初始化",confirmButtonText:"一键初始化",showCancelButton:!0,cancelText:"取消",iconClass:"el-icon-question",callback:function(e){"confirm"==e&&t.pc2mobile()}})},onVisibleChange:function(t,e){t.visible=!t.visible},onItemClick:function(t,e){this.activeIndex=e,t.control&&t.control.id?this.$store.commit({type:"setSelectedControl",id:t.control.id}):this.$store.commit({type:"clearSelectedControl"})},onDataAdd:function(t){var e;(e=console).log.apply(e,arguments)}},mounted:function(){this.mobileDesignData.length?this.list=this.mobileDesignData:this.initSync(),this.$store.commit("activeLeftTab","data"),this.$store.commit("activeRightTab","control")},watch:{list:{deep:!0,handler:function(t){this.$store.commit({type:"replaceMobileDesign",mobileDesignData:t})}}}},nn=en,on=(n("e4ac"),n("63e8"),n("b2ce"),Object(Ct["a"])(nn,je,Te,!1,null,"418e7f73",null)),rn=on.exports,an=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(t.componentName,{tag:"component",staticClass:"config-cell",attrs:{selectedCol:t.selectedCol}})},ln=[],sn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("\n      手风琴项配置\n      "),n("el-tooltip",{attrs:{"open-delay":50,content:"复制ID"}},[n("span",{staticClass:"el-icon-copy-document acc-copy-id",on:{click:t.copyId}})])],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("手风琴标题")]),n("div",{staticClass:"form-control"},[n("div",{staticClass:"form-control-item"},[n("el-input",{on:{blur:t.submitTitle},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1)])]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("默认展开")]),n("div",{staticClass:"form-control"},[n("div",{staticClass:"form-control-item"},[n("el-switch",{model:{value:t.opened,callback:function(e){t.opened=e},expression:"opened"}})],1)])])])])},cn=[],un={name:"config-acc-item",props:["selectedCol"],data:function(){var t=this.selectedCol.props;return{title:t.title,opened:t.opened}},methods:{submitTitle:function(){var t=this.title;if(!t||""==t.trim())return this.$message({title:"系统提醒",message:"名称不能为空",type:"error",showClose:!0});var e="acc-item-name";this.$store.commit("setColProps",{value:t,prop:"props.title",group:e,col:this.selectedCol}),t&&this.$store.commit("setColProps",{value:t,prop:"name",group:e,col:this.selectedCol})},submitOpend:function(t){this.$store.commit("setColProps",{value:t,prop:"props.opened",col:this.selectedCol})},copyId:function(){if(this.selectedCol){var t=this.selectedCol.id,e=document.createElement("input");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("COPY"),this.$message({message:"手风琴ID已复制到剪贴版",type:"success"}),e.parentNode.removeChild(e)}}},watch:{opened:function(t){this.submitOpend(t)},"selectedCol.props":function(){var t=this.selectedCol.props;this.title=t.title,this.opened=t.opened}}},dn=un,fn=(n("76fd"),Object(Ct["a"])(dn,sn,cn,!1,null,"70c5360e",null)),hn=fn.exports,pn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.selectedCol?n("div",[n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("\n      对齐\n    ")]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("对齐")]),n("AlignButton",{attrs:{type:"horizontal"},model:{value:t.textAlign,callback:function(e){t.textAlign=e},expression:"textAlign"}}),n("AlignButton",{attrs:{type:"vertical"},model:{value:t.verticalAlign,callback:function(e){t.verticalAlign=e},expression:"verticalAlign"}})],1)]),n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("\n      边框\n      "),n("el-tooltip",{attrs:{content:"normal"==t.currentView?"切换到详细模式":"切换到简易模式"}},[n("span",{staticClass:"border-config-toggle el-icon-d-arrow-right",on:{click:t.toggleView}})])],1),"normal"==t.currentView?n("div",[n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线宽")]),n("BorderWidthSelect",{attrs:{"border-color":t.borderColor,"border-style":t.borderStyle},model:{value:t.borderWidth,callback:function(e){t.borderWidth=e},expression:"borderWidth"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线型")]),n("BorderStyleSelect",{attrs:{"border-width":t.borderWidth,"border-color":t.borderColor,disabled:!t.borderWidth},model:{value:t.borderStyle,callback:function(e){t.borderStyle=e},expression:"borderStyle"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("颜色")]),n("ColorPicker",{model:{value:t.borderColor,callback:function(e){t.borderColor=e},expression:"borderColor"}})],1)]):t._e(),"advance"==t.currentView?n("div",[n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("边框——上")]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线宽")]),n("BorderWidthSelect",{attrs:{"border-color":t.border.top.color},model:{value:t.border.top.width,callback:function(e){t.$set(t.border.top,"width",e)},expression:"border.top.width"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线性")]),n("BorderStyleSelect",{attrs:{"border-color":t.border.top.color,disabled:!t.border.top.width},model:{value:t.border.top.style,callback:function(e){t.$set(t.border.top,"style",e)},expression:"border.top.style"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("颜色")]),n("ColorPicker",{attrs:{disabled:!t.border.top.width},model:{value:t.border.top.color,callback:function(e){t.$set(t.border.top,"color",e)},expression:"border.top.color"}})],1)]),n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("边框——右")]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线宽")]),n("BorderWidthSelect",{attrs:{"border-color":t.border.right.color},model:{value:t.border.right.width,callback:function(e){t.$set(t.border.right,"width",e)},expression:"border.right.width"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线性")]),n("BorderStyleSelect",{attrs:{"border-color":t.border.right.color,disabled:!t.border.right.width},model:{value:t.border.right.style,callback:function(e){t.$set(t.border.right,"style",e)},expression:"border.right.style"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("颜色")]),n("ColorPicker",{attrs:{disabled:!t.border.right.width},model:{value:t.border.right.color,callback:function(e){t.$set(t.border.right,"color",e)},expression:"border.right.color"}})],1)]),n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("边框——下")]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线宽")]),n("BorderWidthSelect",{attrs:{"border-color":t.border.bottom.color},model:{value:t.border.bottom.width,callback:function(e){t.$set(t.border.bottom,"width",e)},expression:"border.bottom.width"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线性")]),n("BorderStyleSelect",{attrs:{"border-color":t.border.bottom.color,disabled:!t.border.bottom.width},model:{value:t.border.bottom.style,callback:function(e){t.$set(t.border.bottom,"style",e)},expression:"border.bottom.style"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("颜色")]),n("ColorPicker",{attrs:{disabled:!t.border.bottom.width},model:{value:t.border.bottom.color,callback:function(e){t.$set(t.border.bottom,"color",e)},expression:"border.bottom.color"}})],1)]),n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("边框——左")]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线宽")]),n("BorderWidthSelect",{attrs:{"border-color":t.border.left.color},model:{value:t.border.left.width,callback:function(e){t.$set(t.border.left,"width",e)},expression:"border.left.width"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线性")]),n("BorderStyleSelect",{attrs:{"border-color":t.border.left.color,disabled:!t.border.left.width},model:{value:t.border.left.style,callback:function(e){t.$set(t.border.left,"style",e)},expression:"border.left.style"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("颜色")]),n("ColorPicker",{attrs:{disabled:!t.border.left.width},model:{value:t.border.left.color,callback:function(e){t.$set(t.border.left,"color",e)},expression:"border.left.color"}})],1)])]):t._e()])]):t._e()},mn=[],gn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"design-button-group align-group",class:t.type,attrs:{"data-value":t.active}},t._l(t.alignList,(function(e){return n("el-tooltip",{key:e,attrs:{"open-delay":500,content:t.tipsText[e]}},[n("MyButton",{class:{active:t.active==e},attrs:{icon:"align-"+e},nativeOn:{click:function(n){return t.activeBtn(e)}}})],1)})),1)},vn=[],bn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"design-button"},[t.icon?n("span",{staticClass:"design-button-icon",class:t.icon}):t._e(),t._t("default")],2)},yn=[],Cn={name:"design-button",props:{icon:{type:String}}},wn=Cn,xn=Object(Ct["a"])(wn,bn,yn,!1,null,null,null),On=xn.exports,Dn={name:"align-button",components:{MyButton:On},props:{type:{type:String,default:"horizontal",validator:function(t){var e=-1!==["horizontal","vertical"].indexOf(t);return e||console.error("type 应为 'horizontal' 或 'vertical'"),e}},value:{type:String,default:function(){return"horizontal"==this.type?"left":"vertical"==this.type?"middle":void 0}}},computed:{alignList:function(){return"horizontal"==this.type?["left","center","right"]:"vertical"==this.type?["top","middle","bottom"]:void 0}},data:function(){return{active:this.value,tipsText:{left:"左对齐",center:"居中对齐",right:"右对齐",top:"顶端对齐",middle:"垂直居中",bottom:"底端对齐"}}},watch:{value:function(){this.active=this.value},active:function(t){this.$emit("input",t)}},methods:{activeBtn:function(t){this.active=t}}},_n=Dn,kn=Object(Ct["a"])(_n,gn,vn,!1,null,null,null),Sn=kn.exports,jn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"colorpicker",staticClass:"color-picker",class:{disabled:t.disabled}},[n("span",{staticClass:"color-picker-toggle",on:{click:function(e){return t.togglePicker()}}},[t._t("default",[n("div",{staticClass:"current-color",style:"background-color: "+t.colorValue},[n("span",{staticClass:"current-color-value"},[t._v(t._s(t.colorValue.toLowerCase()))]),n("label",{staticClass:"current-color-label"},[t._v(t._s(t.label))])])])],2),n("div",{directives:[{name:"show",rawName:"v-show",value:t.displayPicker,expression:"displayPicker"}],ref:"panel",staticClass:"color-picker-panel"},[t.displayPicker?n("Chrome",{staticClass:"color-picker-chrome",attrs:{value:t.colors,disableAlpha:t.disableAlpha},on:{input:t.updateFromPicker}}):t._e()],1)])},Tn=[],In=(n("6b54"),n("87b3"),n("c345")),En={name:"color-picker",components:{Chrome:In["Chrome"]},props:{value:{type:String,default:""},label:{type:String,default:""},referColor:{type:String,default:""},disabled:{type:Boolean,default:!1}},data:function(){return{disableAlpha:!0,colors:{hex:"#000000"},colorValue:"",displayPicker:!1}},mounted:function(){this.setColor(this.value||"#000000"),this.setStyle()},methods:{setStyle:function(){var t=this.value;if("#"==t[0]){var e=[0,1,2].map((function(e,n){return parseInt(t.substr(2*n+1,2),16)||0})),n="drop-shadow(2px 2px 6px rgba( ".concat(e.join(",")," ,.15)");this.$refs.colorpicker.style.setProperty("--color",t),this.$refs.colorpicker.style.setProperty("--dropShadow",n),this.$refs.colorpicker.style.setProperty("--red",e[0]),this.$refs.colorpicker.style.setProperty("--green",e[1]),this.$refs.colorpicker.style.setProperty("--blue",e[2])}},isValid:function(t){return!this.disableAlpha||/^#[0-9a-f]{6}$/i.test(t)},setColor:function(t){this.updateColors(t),this.colorValue=t},updateColors:function(t){if("#"==t.slice(0,1))this.colors={hex:t.substr(0,7)};else if("rgba"==t.slice(0,4)){var e=t.replace(/^rgba?\(|\s+|\)$/g,"").split(","),n="#"+((1<<24)+(parseInt(e[0])<<16)+(parseInt(e[1])<<8)+parseInt(e[2])).toString(16).slice(1);this.colors={hex:n,a:e[3]}}},showPicker:function(){document.addEventListener("click",this.documentClick,!0),this.displayPicker=!0},hidePicker:function(){document.removeEventListener("click",this.documentClick,!0),this.displayPicker=!1},togglePicker:function(){this.disabled||(this.displayPicker?this.hidePicker():this.showPicker())},updateFromPicker:function(t){this.disableAlpha&&(t.rgba.a=1),this.colors=t,1==t.rgba.a?this.colorValue=t.hex:this.colorValue="rgba("+t.rgba.r+", "+t.rgba.g+", "+t.rgba.b+", "+t.rgba.a+")",this.$emit("input",this.colorValue)},documentClick:function(t){var e=this.$refs.colorpicker,n=this.$refs.panel,o=t.target;e&&(e===o||e.contains(o)||n.contains(o)||this.hidePicker())},adjustPos:function(){var t=this.$el.getBoundingClientRect(),e=t.top+t.height,n=t.left,o=this.$refs.panel,i=o.clientHeight,r=o.clientWidth;e+i>=window.innerHeight&&(e=t.top-i),n+r>=window.innerWidth&&(n-=n+r-window.innerWidth),o.style.top="".concat(e,"px"),o.style.left="".concat(n,"px")}},watch:{value:function(){this.setColor(this.value||"#000000"),this.setStyle()},colorValue:function(t){t&&(this.updateColors(t),this.setStyle(),this.$emit("input",t))},displayPicker:function(t){var e=this;t?this.$nextTick((function(){document.body.appendChild(e.$refs.panel),e.$refs.panel.style.position="fixed",e.$refs.panel.style.display="block",e.adjustPos()})):(this.$refs.panel.style.display="none",this.$refs.panel.style.top="-99999px",this.$refs.panel.style.left="-99999px")}}},Pn=En,Ln=(n("5908"),n("b8b5"),Object(Ct["a"])(Pn,jn,Tn,!1,null,null,null)),An=Ln.exports,$n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"border-style-select",class:{disabled:t.disabled}},[n("el-select",{staticStyle:{width:"100px"},attrs:{disabled:t.disabled,placeholder:"请选择",size:"small"},model:{value:t.borderStyle,callback:function(e){t.borderStyle=e},expression:"borderStyle"}},t._l(t.borderStyleList,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label||e.value,title:e.label||e.value,value:e.value}},[e.value?n("span",{staticClass:"border-style-option",style:"border-top-color:"+t.borderColor+";border-top-width:"+(t.borderWidth||3)+"px;border-top-style:"+e.value+";"}):t._e()])})),1),n("span",{staticClass:"border-style-select-curr",style:t.selectedStyle})],1)},Fn=[],Mn={name:"border-style-select",props:["value","borderColor","disabled"],data:function(){return{borderWidth:4,borderStyle:this.value,borderStyleList:["solid","dashed","dotted","double"].map((function(t){return{value:t}}))}},watch:{value:function(t){t!=this.borderStyle&&(this.borderStyle=t)},borderStyle:function(t){this.$emit("input",t)}},computed:{selectedStyle:function(){return"border-top-style:".concat(this.borderStyle,";border-top-color:").concat(this.borderColor,";border-top-width:").concat(this.borderWidth||3,"px;")}}},Nn=Mn,Rn=Object(Ct["a"])(Nn,$n,Fn,!1,null,null,null),Vn=Rn.exports,zn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"border-width-select",class:{disabled:t.disabled,none:0==t.borderWidth,normal:0!=t.borderWidth}},[n("el-select",{staticStyle:{width:"100px"},attrs:{disabled:t.disabled,placeholder:"请选择",size:"small"},model:{value:t.borderWidth,callback:function(e){t.borderWidth=e},expression:"borderWidth"}},t._l(t.borderWidthList,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label||e.value,value:e.value}},[e.value?n("span",{staticClass:"border-width-select-option",style:t.selectedStyle(e.value),attrs:{title:e.label||e.value}}):t._e(),e.value?t._e():n("span",{staticClass:"border-width-select-option-none",style:"color:"+t.borderColor,attrs:{title:e.label}},[t._v(t._s(e.label))])])})),1),n("span",{staticClass:"border-width-select-curr",style:t.selectedStyle()})],1)},Bn=[],Un={name:"border-width-select",props:["value","borderColor","disabled"],data:function(){return{borderStyle:"solid",borderWidth:this.value,borderWidthList:[{label:"none",value:0},{value:1},{value:2},{value:3},{value:4},{value:5}]}},watch:{value:function(t){t!=this.borderWidth&&(this.borderWidth=t)},borderWidth:function(t){this.$emit("input",t)}},methods:{selectedStyle:function(t){return void 0===t&&(t=this.borderWidth),"border-top-style:".concat(this.borderStyle,";border-top-color:").concat(this.borderColor,";border-top-width:").concat(t,"px")}}},Gn=Un,Hn=Object(Ct["a"])(Gn,zn,Bn,!1,null,null,null),qn=Hn.exports;function Wn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Jn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Wn(Object(n),!0).forEach((function(e){Object(ut["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Wn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Yn={name:"config-col",components:{AlignButton:Sn,ColorPicker:An,BorderStyleSelect:Vn,BorderWidthSelect:qn},props:["selectedCol"],computed:{},data:function(){return this.getShowData()},methods:Jn(Jn(Jn({},Object(Tt["d"])(["setColBorder","setColStyle"])),Object(Tt["b"])(["setColAllBorder"])),{},{getShowData:function(){if(!this.selectedCol)return{};var t=Object(It["d"])(this.selectedCol.style.border),e=t.bottom.width,n=t.bottom.style,o=t.bottom.color;return{textAlign:this.selectedCol.style.textAlign||"left",verticalAlign:this.selectedCol.style.verticalAlign||"middle",border:t,borderWidth:e,borderStyle:n,borderColor:o,currentView:"normal"}},toggleView:function(){this.currentView="normal"==this.currentView?"advance":"normal"}}),watch:{selectedCol:function(t,e){if(this.selectedCol){var n=Object(It["d"])(this.selectedCol.style.border),o=n.bottom.width,i=n.bottom.style,r=n.bottom.color;e?(this.border=n,this.verticalAlign=this.selectedCol.style.verticalAlign,this.textAlign=this.selectedCol.style.textAlign,this.borderWidth=o,this.borderStyle=i,this.borderColor=r):(this.$set(this,"border",n),this.$set(this,"verticalAlign",this.selectedCol.style.verticalAlign),this.$set(this,"textAlign",this.selectedCol.style.textAlign),this.$set(this,"borderWidth",o),this.$set(this,"borderStyle",i),this.$set(this,"borderColor",r))}},border:{deep:!0,handler:function(t){var e;JSON.stringify(t)!=JSON.stringify(this.selectedCol.style.border)&&((e=console).log.apply(e,["设置单元格边框"].concat(Array.prototype.slice.call(arguments))),this.setColBorder({border:t,selectedCol:this.selectedCol,shuttle:!0}))}},borderWidth:function(t){this.setColAllBorder({prop:"width",value:t})},borderStyle:function(t){this.setColAllBorder({prop:"style",value:t})},borderColor:function(t){this.setColAllBorder({prop:"color",value:t})},textAlign:function(t){var e;t!=this.selectedCol.style.textAlign&&((e=console).log.apply(e,["设置对齐"].concat(Array.prototype.slice.call(arguments))),this.setColStyle({prop:"textAlign",value:t,selectedCol:this.selectedCol,shuttle:!0}))},verticalAlign:function(t){var e;t!=this.selectedCol.style.verticalAlign&&((e=console).log.apply(e,["设置对齐"].concat(Array.prototype.slice.call(arguments))),this.setColStyle({prop:"verticalAlign",value:t,selectedCol:this.selectedCol,shuttle:!0}))}}},Xn=Yn,Kn=Object(Ct["a"])(Xn,pn,mn,!1,null,null,null),Qn=Kn.exports,Zn={name:"config-cell",components:{ConfigAccItem:hn,ConfigCol:Qn},props:["selectedCol"],computed:{type:function(){this.selectedCol;var t=this.selectedCol?this.selectedCol.type:"";return t||"col-item"},componentName:function(){return"acc-item"==this.type?hn:"col-item"==this.type?Qn:""}}},to=Zn,eo=Object(Ct["a"])(to,an,ln,!1,null,null,null),no=eo.exports,oo=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"config-form"},[n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("\n      全局文字\n      "),n("el-tooltip",{attrs:{placement:"right",content:"将影响所有控件"}},[n("span",{staticClass:"design-help"})])],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("字体")]),n("el-select",{staticClass:"font-set-select",attrs:{size:"small"},model:{value:t.fontFamily,callback:function(e){t.fontFamily=e},expression:"fontFamily"}},t._l(t.fontFamilyList,(function(t){return n("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})})),1),n("el-input-number",{staticClass:"font-set-input",attrs:{size:"small",controls:!1,min:12,max:100},model:{value:t.fontSize,callback:function(e){t.fontSize=e},expression:"fontSize"}}),n("span",{staticClass:"form-control-suffix"},[t._v("px")])],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("样式")]),n("FontColor",{staticStyle:{"margin-right":"10px"},model:{value:t.fontColor,callback:function(e){t.fontColor=e},expression:"fontColor"}}),n("div",{staticClass:"design-button-group font-group"},[n("el-tooltip",{attrs:{"open-delay":500,content:"加粗"}},[n("MyButton",{class:{active:t.fontBolder},attrs:{icon:"font-bold"},nativeOn:{click:function(e){t.fontBolder=!t.fontBolder}}})],1),n("el-tooltip",{attrs:{"open-delay":500,content:"倾斜"}},[n("MyButton",{class:{active:t.fontItalic},attrs:{icon:"font-italic"},nativeOn:{click:function(e){t.fontItalic=!t.fontItalic}}})],1),n("el-tooltip",{attrs:{"open-delay":500,content:"下划线"}},[n("MyButton",{class:{active:t.fontUnderline},attrs:{icon:"font-underline"},nativeOn:{click:function(e){t.fontUnderline=!t.fontUnderline}}})],1)],1)],1)]),n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("\n      全局单元格\n      "),n("el-tooltip",{attrs:{placement:"right",content:"将影响所有单元格"}},[n("span",{staticClass:"design-help"})])],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("对齐")]),n("AlignButton",{attrs:{type:"horizontal"},model:{value:t.textAlign,callback:function(e){t.textAlign=e},expression:"textAlign"}}),n("AlignButton",{attrs:{type:"vertical"},model:{value:t.verticalAlign,callback:function(e){t.verticalAlign=e},expression:"verticalAlign"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("高度")]),n("el-input-number",{staticClass:"height-set-input",attrs:{size:"small",controls:!1,min:38,max:2e3},on:{change:t.setHeight},model:{value:t.height,callback:function(e){t.height=e},expression:"height"}}),n("span",{staticClass:"form-control-suffix"},[t._v("px")])],1)]),n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("\n      全局边框\n      "),n("el-tooltip",{attrs:{placement:"right",content:"将影响所有单元格"}},[n("span",{staticClass:"design-help"})])],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线宽")]),n("BorderWidthSelect",{attrs:{"border-color":t.borderColor,"border-style":t.borderStyle},model:{value:t.borderWidth,callback:function(e){t.borderWidth=e},expression:"borderWidth"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线性")]),n("BorderStyleSelect",{attrs:{"border-width":t.borderWidth,"border-color":t.borderColor,disabled:!t.borderWidth},model:{value:t.borderStyle,callback:function(e){t.borderStyle=e},expression:"borderStyle"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("颜色")]),n("ColorPicker",{attrs:{disabled:!t.borderWidth},model:{value:t.borderColor,callback:function(e){t.borderColor=e},expression:"borderColor"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("外边框")]),n("AllBorderType",{staticClass:"form-control",attrs:{"border-type":t.allBorderType},on:{active:t.handleBorderTypeChange}})],1)]),n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("控件配置")]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("label自动冒号")]),n("el-switch",{attrs:{"border-color":t.borderColor,"border-style":t.borderStyle},model:{value:t.autoColons,callback:function(e){t.autoColons=e},expression:"autoColons"}})],1)]),n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("预设风格")]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("风格选择")]),n("el-select",{staticStyle:{width:"120px","margin-right":"10px",display:"inline-block"},on:{change:t.onSkinChange},model:{value:t.currentSkin,callback:function(e){t.currentSkin=e},expression:"currentSkin"}},t._l(t.skins,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})),1),n("el-button",{attrs:{type:"primary",disabled:!t.isNewSkin},on:{click:t.createNewSkin}},[t._v("存为新风格")])],1)])])},io=[],ro=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ColorPicker",{model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}},[n("span",{staticClass:"font-color-button design-button"},[n("span",{staticClass:"font-color-holder design-button-icon"}),n("span",{staticClass:"font-current-color",style:"background:"+t.currentValue})])])},ao=[],lo={name:"control-font-color",props:["value"],components:{ColorPicker:An},data:function(){return{currentValue:this.value||"#000"}},watch:{value:function(t){this.currentValue=t},currentValue:function(t){this.$emit("input",t)}}},so=lo,co=Object(Ct["a"])(so,ro,ao,!1,null,null,null),uo=co.exports,fo=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"form-control-item  form-all-border"},t._l(t.list1,(function(e){return n("el-tooltip",{key:e,attrs:{"open-delay":500,placement:"top",content:t.tipsText[e]}},[n("MyButton",{class:{active:e==t.currentType},attrs:{icon:"all-border-"+e},nativeOn:{click:function(n){return t.handleChange(e)}}})],1)})),1),n("div",{staticClass:"form-control-item form-all-border"},t._l(t.list2,(function(e){return n("el-tooltip",{key:e,attrs:{"open-delay":500,placement:"top",content:t.tipsText[e]}},[n("MyButton",{class:{active:e==t.currentType},attrs:{icon:"all-border-"+e},nativeOn:{click:function(n){return t.handleChange(e)}}})],1)})),1)])},ho=[],po={name:"form-all-border-config",components:{MyButton:On},props:{borderType:{type:String,default:"all"}},data:function(){return{currentType:this.borderType,list1:["all","inner","hline","vline","outer"],list2:["left","top","right","bottom","none"],tipsText:{all:"全部框线",inner:"仅内框线",hline:"仅水平线",vline:"仅垂直线",outer:"仅外边框",left:"仅左框线",top:"仅上框线",right:"仅右框线",bottom:"仅底框线",none:"无框线"}}},methods:{handleChange:function(t){this.currentType=t,this.$emit("active",t)}},watch:{borderType:function(t){this.currentType=t}}},mo=po,go=Object(Ct["a"])(mo,fo,ho,!1,null,null,null),vo=go.exports;function bo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function yo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?bo(Object(n),!0).forEach((function(e){Object(ut["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bo(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Co=Object(It["d"])(window.FORM_DESIGN_CONFIG.preset.fontFamilyList),wo={name:"config-form",components:{AlignButton:Sn,FontColor:uo,BorderStyleSelect:Vn,BorderWidthSelect:qn,MyButton:On,ColorPicker:An,AllBorderType:vo},computed:yo(yo({},Object(Tt["e"])(["globalStyle","skin"])),{},{fontFamilyList:function(){return Co}}),mounted:function(){this.getSkinList()},data:function(){var t=this.globalStyle||this.$store.state.globalStyle,e=t.border;return{currentSkin:this.skin||"",skins:[],isNewSkin:!1,height:t.cellHeight||38,borderWidth:e.top.width||1,borderStyle:e.top.style||"solid",borderColor:e.top.color||"#dddddd",fontSize:t.fontSize,fontFamily:t.fontFamily,fontColor:t.fontColor,fontBolder:t.fontBolder,fontItalic:t.fontItalic,fontUnderline:t.fontUnderline,textAlign:t.textAlign,verticalAlign:t.verticalAlign,autoColons:t.autoColons,allBorderType:t.allBorderType||"all",heightPerset:{selected:"compact",list:[{label:"紧凑",value:"compact"},{label:"2倍",value:40},{label:"50",value:50},{label:"自定义",value:30}]}}},methods:yo(yo({},Object(Tt["b"])({setBorder:"setGlobalBorder",setStyle:"setGlobalStyle"})),{},{getSkinList:function(){var t=this;return this.$httpPost(window.formDesignerActions.getSkinListUrl).then((function(e){Array.isArray(e.skinList)?t.skins=e.skinList:t.skins=[]}))},onSkinChange:function(t){var e=this,n=this.skins.filter((function(e){return e.id==t}))[0];if(n&&n.data){var o=Object(It["d"])(n.data);this.$store.dispatch({type:"applySkin",skinData:o,skin:this.currentSkin}),this.$nextTick((function(){e.isNewSkin=!1}))}},createNewSkin:function(){var t=this;this.$prompt("请输入新风格名称","创建新风格",{confirmButtonText:"确定",cancelButtonText:"取消",inputValidator:function(t){return t&&t.trim()?!!/^[\d\w-_\u4E00-\u9FA5]+$/.test(t)||"风格名称格式不正确":"风格名称不能为空"}}).then((function(e){var n=e.value;t.saveNewSkin(n)}))},saveNewSkin:function(t){var e=this,n=Object(It["d"])(this.globalStyle);return delete n.cellHeight,this.$httpPost(window.formDesignerActions.addSkinUrl,{skinName:t,data:n}).then((function(o){e.currentSkin=o.id,e.skins.push({id:e.currentSkin,name:t,data:n}),e.$nextTick((function(){e.isNewSkin=!1})),e.$message({type:"success",message:"保存成功"})})).catch((function(t){console.error(t),e.$message({type:"error",message:"保存失败"})}))},getData:function(){var t=this.globalStyle||this.$store.state.globalStyle,e=t.border;return{height:t.cellHeight||38,borderWidth:e.top.width||1,borderStyle:e.top.style||"solid",borderColor:e.top.color||"#dddddd",fontSize:t.fontSize,fontFamily:t.fontFamily,fontColor:t.fontColor,fontBolder:t.fontBolder,fontItalic:t.fontItalic,fontUnderline:t.fontUnderline,textAlign:t.textAlign,verticalAlign:t.verticalAlign,autoColons:t.autoColons}},handleChange:function(t,e){t!==this.globalStyle[e]&&this.setStyle({prop:e,value:t})},setHeight:function(t){this.$store.dispatch("setAllRowHeight",{height:t})},handleBorderTypeChange:function(t){this.isNewSkin=!0,this.borderWidth,this.$store.dispatch("setAllBorderType",{type:t,borderWidth:this.borderWidth})}}),watch:{globalStyle:function(t){var e=t.border;this.height=t.cellHeight||38,this.borderWidth=e.top.width||1,this.borderStyle=e.top.style||"solid",this.borderColor=e.top.color||"#dddddd",this.fontSize=t.fontSize,this.fontFamily=t.fontFamily,this.fontColor=t.fontColor,this.fontBolder=t.fontBolder,this.fontItalic=t.fontItalic,this.fontUnderline=t.fontUnderline,this.textAlign=t.textAlign,this.verticalAlign=t.verticalAlign,this.autoColons=t.autoColons,this.allBorderType!=t.allBorderType&&(this.allBorderType=t.allBorderType,this.handleBorderTypeChange(this.allBorderType))},borderWidth:function(t){this.isNewSkin=!0,this.setBorder({prop:"width",value:t})},borderStyle:function(t){this.isNewSkin=!0,this.setBorder({prop:"style",value:t})},borderColor:function(t){this.isNewSkin=!0,this.setBorder({prop:"color",value:t})},autoColons:function(t){this.isNewSkin=!0,this.handleChange(t,"autoColons")},fontSize:function(t){this.isNewSkin=!0,this.handleChange(t,"fontSize")},fontFamily:function(t){this.isNewSkin=!0,this.handleChange(t,"fontFamily")},fontColor:function(t){this.isNewSkin=!0,this.handleChange(t,"fontColor")},fontBolder:function(t){this.isNewSkin=!0,this.handleChange(t,"fontBolder")},fontItalic:function(t){this.isNewSkin=!0,this.handleChange(t,"fontItalic")},fontUnderline:function(t){this.isNewSkin=!0,this.handleChange(t,"fontUnderline")},textAlign:function(t){this.isNewSkin=!0,this.handleChange(t,"textAlign")},verticalAlign:function(t){this.isNewSkin=!0,this.handleChange(t,"verticalAlign")},skin:{immediate:!0,handler:function(t){t!==this.currentSkin&&(this.isNewSkin=!1,this.currentSkin=t)}}}},xo=wo,Oo=Object(Ct["a"])(xo,oo,io,!1,null,null,null),Do=Oo.exports,_o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.control?n("div",{staticClass:"config-control"},[n("NameConfig",{attrs:{"component-data":t.control,type:t.controlType},on:{change:t.onNameChange,remove:t.removeControl}}),t.supportEvent?n("div",{staticClass:"config-control-tabs"},[n("span",{staticClass:"config-control-tab",class:{active:"attribute"==t.currentView},on:{click:function(e){t.currentView="attribute"}}},[t._v("属性")]),n("span",{staticClass:"config-control-tab",class:{active:"event"==t.currentView},on:{click:function(e){t.currentView="event"}}},[t._v("事件("+t._s(t.eventCount)+")")])]):t._e(),n("div",{staticClass:"config-control-tabcontent",class:{"with-event":t.supportEvent}},["attribute"==t.currentView?n("div",{staticClass:"attribute-block"},t._l(t.controlConfig,(function(e,o){return n("div",{key:o,staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v(t._s(e.category))]),t._l(e.items,(function(e){return n("div",{key:e.label||e.extends+"",class:{"form-item":!e.extends,"form-extend":!!e.extends}},[t._l(t.getExtends(e.extends),(function(e){return n(t.getControlComponent(e),{key:t.control.id+"-"+e,tag:"component",attrs:{"control-data":t.control},on:{change:t.handleExtendChange}})})),e.extends?t._e():n("label",{staticClass:"form-label"},[t._v(t._s(e.label))]),e.extends?t._e():n("div",{staticClass:"form-control"},t._l(e.controls,(function(e){return n(t.getControlComponent(e.type),{key:t.control.id+"-"+e.associatedProp,tag:"component",staticClass:"form-control-item",class:e.type,attrs:{config:e,value:t.getControlValue(t.control,e)},on:{change:t.change}})})),1)],2)}))],2)})),0):t._e(),"event"==t.currentView?n("div",{staticClass:"event-block"},[n("EventComponent",{attrs:{"control-data":t.control}})],1):t._e()])],1):t._e()},ko=[],So=(n("759f"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"component-name-config config-block"},[n("h3",{staticClass:"component-type config-category"},[t._v(t._s(t.type)+" "),n("span",{staticClass:"remove-component",on:{click:t.onComponentRemove}},[t._v("删除")])]),n("div",{staticClass:"component-name-block"},[n("div",{directives:[{name:"show",rawName:"v-show",value:!t.showEditor,expression:"!showEditor"}],staticClass:"component-name",on:{click:function(e){t.editorValue=t.name,t.showEditor=!0}}},[t._v(t._s(t.name))]),t.showEditor?n("div",[n("div",{staticClass:"el-input el-input--mini",staticStyle:{width:"50%","margin-right":"6px"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.editorValue,expression:"editorValue"}],staticClass:"el-input__inner",attrs:{size:"mini"},domProps:{value:t.editorValue},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submitName(e)},input:function(e){e.target.composing||(t.editorValue=e.target.value)}}})]),n("el-button",{attrs:{icon:"el-icon-check",size:"mini",circle:""},on:{click:t.submitName}})],1):t._e()])])}),jo=[],To={name:"name-config",props:["componentData","type"],computed:{},data:function(){return{name:this.componentData.name||this.getComponentName(),showEditor:!1,editorValue:""}},methods:{getComponentName:function(){var t=this.componentData,e=t.namePrefix,n=t.autoIndex;return e&&n?"".concat(e,"_").concat(n):this.type},onComponentRemove:function(){this.$emit("remove")},change:function(t){this.$emit("change",t)},submitName:function(){var t=this.editorValue.trim();return t?/^[^\d][\d\w\u4E00-\u9FA5]+$/.test(t)?(this.componentData.name!=t&&(this.name=t,this.change(t)),void(this.showEditor=!1)):this.$message({message:"组件名称不合法，只接受非数字开头的汉字、字母、数字组合",type:"error",showClose:!0}):this.$message({message:"必须输入组件件名称",type:"error",showClose:!0})}},watch:{"componentData.id":function(){this.showEditor=!1,this.name=this.componentData.name||this.getComponentName()}}},Io=To,Eo=(n("d5c7"),Object(Ct["a"])(Io,So,jo,!1,null,null,null)),Po=Eo.exports,Lo=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-checkbox",{attrs:{value:t.value},on:{change:t.change}},[t._v(t._s(t.config.text))])},Ao=[],$o={name:"control-checkbox",props:{value:{type:Boolean,require:!0},config:{type:Object,require:!0}},methods:{change:function(t){this.$emit("change",t,this.config)}}},Fo=$o,Mo=Object(Ct["a"])(Fo,Lo,Ao,!1,null,null,null),No=Mo.exports,Ro=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-checkbox-group",{class:"direction-"+t.direction,on:{change:t.change},model:{value:t.valueList,callback:function(e){t.valueList=e},expression:"valueList"}},t._l(t.optionList,(function(e){return n("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])})),1)},Vo=[],zo=n("da81"),Bo=n.n(zo),Uo={methods:{getOriginData:function(t,e){var n,o=this;if(!t)throw new Error("url is required!");e&&(n=Bo()({},e)),this.loading=!0,this.$httpPost(t,n).then((function(t){var e=[];if(!Array.isArray(t))throw new Error("远程数据必须为数组");return t.forEach((function(t){void 0!==t.id&&void 0!==t.text?e.push(t):console.warn("id or text is not a valid type! ".concat(JSON.stringify(t)))})),o.loading=!1,o.originOptionList=e,e})).catch((function(t){o.loading=!1,console.error(t)}))}}},Go=window.FORM_DESIGN_CONFIG.preset,Ho={name:"control-checkboxlist",mixins:[Uo],props:{value:{type:String,require:!0},config:{type:Object,require:!0},styleText:{type:String,default:"width:200px"}},data:function(){return{valueList:this.getValueList(),loading:!1,originOptionList:[]}},created:function(){!this.config.data&&this.config.url&&this.getOriginData(this.config.url)},computed:{direction:function(){return this.config.direction||"horizontal"},optionList:function(){return this.config.data?this.staticOptionList:this.originOptionList},staticOptionList:function(){var t=this.config.data;if(!t)return[];if(Array.isArray(t))return t;var e=t+""===t;if(e){if(t in Go)return Go[t];var n=t.replace(/^epointsform\./,"");if(n&&Array.isArray(this.$store.state[n]))return Object(It["d"])(this.$store.state[n])}return[]}},methods:{getValueList:function(){return this.value?this.value.split(","):[]},change:function(t){this.$emit("change",t.join(","),this.config)}}},qo=Ho,Wo=Object(Ct["a"])(qo,Ro,Vo,!1,null,null,null),Jo=Wo.exports,Yo=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-select",{style:t.styleText,attrs:{value:t.value,size:"small",filterable:"",clearable:""},on:{change:t.change}},t._l(t.optionList,(function(t){return n("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})})),1)},Xo=[],Ko=window.FORM_DESIGN_CONFIG.preset,Qo={name:"control-combobox",mixins:[Uo],props:{value:{type:String,require:!0},config:{type:Object,require:!0},styleText:{type:String,default:""}},data:function(){return{loading:!1,originOptionList:[]}},created:function(){!this.config.data&&this.config.url&&this.getOriginData(this.config.url)},computed:{optionList:function(){return this.config.data?this.staticOptionList:this.originOptionList},staticOptionList:function(){var t=this.config.data;if(!t)return[];if(Array.isArray(t))return t;var e=t+""===t;if(e){if(t in Ko)return Ko[t];var n=t.replace(/^epointsform\./,"");if(n&&Array.isArray(this.$store.state[n]))return Object(It["d"])(this.$store.state[n])}return[]}},methods:{change:function(t){this.$emit("change",t,this.config)}}},Zo=Qo,ti=Object(Ct["a"])(Zo,Yo,Xo,!1,null,null,null),ei=ti.exports,ni=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{},[n("el-select",{staticStyle:{display:"block"},attrs:{size:"small"},on:{change:t.typeChange},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},t._l(t.typeList,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1),t.type==t.TYPE_MAP.date?n("el-date-picker",{staticStyle:{"margin-top":"8px"},attrs:{"popper-class":"default-date-popper",type:"datetime",placeholder:"请选择一个日期",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",editable:!1,size:"small"},on:{change:t.dateChange},model:{value:t.selectDate,callback:function(e){t.selectDate=e},expression:"selectDate"}}):t._e()],1)},oi=[];function ii(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ri(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ii(Object(n),!0).forEach((function(e){Object(ut["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ii(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ai="[currDate]",li=/^\d{4}-\d{2}-\d{2}/,si={empty:"empty",currDate:"currDate",date:"date"},ci={name:"control-default-date",props:["config","value"],data:function(){return ri(ri({},this.getDataFromValue(this.value)),{},{TYPE_MAP:si,typeList:[{id:si.empty,text:"留空"},{id:si.currDate,text:"填报日期"},{id:si.date,text:"指定日期"}]})},methods:{getDataFromValue:function(t){return t?/^\[.+\]$/.test(t)?{selectDate:"",type:si.currDate}:{selectDate:this.getValidDate(t),type:si.date}:{selectDate:"",type:si.empty}},getValidDate:function(t){return li.test(t)?t:""},typeChange:function(t){return"empty"==t?this.change(""):"currDate"==t?this.change(ai):"date"==t&&this.selectDate?this.change(this.selectDate):void 0},dateChange:function(){"date"==this.type&&this.change(this.selectDate)},change:function(t){this.$emit("change",t,this.config)}},watch:{value:function(t){var e=this.getDataFromValue(t);e.type!=this.type&&(this.type=e.type),e.selectDate!=this.selectDate&&(this.selectDate=e.selectDate)}}},ui=ci,di=(n("d482"),Object(Ct["a"])(ui,ni,oi,!1,null,null,null)),fi=di.exports,hi=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-select",{attrs:{size:"small"},on:{change:t.configTypeChange},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},t._l(t.typeList,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1),t.type==t.typeMap.select?n("div",{staticStyle:{"margin-top":"8px"}},[n("el-input",{attrs:{placeholder:"请选择",value:t.selectedTypes.join(","),size:"small",readonly:""}},[n("el-button",{attrs:{slot:"append",icon:"el-icon-more"},nativeOn:{click:function(e){return t.showDialog(e)}},slot:"append"})],1)],1):t._e(),t.type==t.typeMap.input?n("div",{staticStyle:{"margin-top":"8px"}},[n("el-input",{attrs:{placeholder:"请输入文件扩展名",size:"small"},on:{change:t.userInputChange},model:{value:t.userInputType,callback:function(e){t.userInputType=e},expression:"userInputType"}}),n("el-tooltip",{attrs:{placement:"top",content:"扩展名不带点，多个逗号分隔"}},[n("span",{staticClass:"design-help"})])],1):t._e(),n("el-dialog",{attrs:{visible:t.dialogVisible,title:"类型选择","append-to-body":""},on:{"update:visible":function(e){t.dialogVisible=e}}},[t.type==t.typeMap.select?n("div",{staticClass:"tree-like"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.dialogSelectedTypes.length,expression:"dialogSelectedTypes.length"}],staticStyle:{"margin-bottom":"10px"}},t._l(t.dialogSelectedTypes,(function(e){return n("el-tag",{key:e,staticStyle:{"margin-right":"4px"},attrs:{size:"mini",closable:""},on:{close:function(n){return t.hanldeRemoveTag(e)}}},[t._v(t._s(e))])})),1),t._l(t.dialogTypeTree,(function(e){return n("div",{key:e.id,staticStyle:{"margin-bottom":"10px"}},[n("div",{staticClass:"file-type-category"},[n("el-checkbox",{attrs:{indeterminate:e.halfChecked,label:e.text},on:{change:function(n){return t.cateCheckedChange(n,e)}},model:{value:e.allChecked,callback:function(n){t.$set(e,"allChecked",n)},expression:"cate.allChecked"}})],1),n("el-checkbox-group",{staticClass:"file-type-group",on:{change:function(n){return t.itemCheckedChange(n,e)}},model:{value:e.checkedArr,callback:function(n){t.$set(e,"checkedArr",n)},expression:"cate.checkedArr"}},t._l(e.items,(function(t){return n("el-checkbox",{key:t.id,staticClass:"file-type-item",attrs:{label:t.id}})})),1)],1)}))],2):t._e(),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:t.submitSelect}},[t._v("确 定")])],1)])],1)},pi=[];n("ac4d"),n("8a81"),n("1c4c");function mi(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=gi(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,r=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw r}}}}function gi(t,e){if(t){if("string"===typeof t)return vi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vi(t,e):void 0}}function vi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var bi="[default]",yi={default:"default",empty:"empty",select:"select",input:"input"},Ci={name:"control-file-type-picker",props:["config","value"],computed:{selectedTypes:function(){if(this.type!=this.typeMap.select)return[];var t=[];return this.typeTree.forEach((function(e){e.checkedArr&&e.checkedArr.length&&t.push.apply(t,Object(ct["a"])(e.checkedArr))})),t},dialogSelectedTypes:function(){if(this.type!=this.typeMap.select)return[];var t=[];return this.dialogTypeTree.forEach((function(e){e.checkedArr&&e.checkedArr.length&&t.push.apply(t,Object(ct["a"])(e.checkedArr))})),t}},data:function(){return{typeMap:yi,dialogVisible:!1,userInputType:"",type:"",typeList:[{id:"default",text:"系统默认"},{id:"empty",text:"不限制"},{id:"select",text:"选择类型"},{id:"input",text:"手动输入"}],typeTree:this.genderTypeTree(this.value),dialogTypeTree:[]}},created:function(){this.type=this.getTypeFromValue(this.value),this.syncConfigValue()},methods:{syncConfigValue:function(){this.type==yi.default||this.type==yi.empty?this.userInputType="":this.type==yi.select?(this.userInputType="",this.typeTree=this.genderTypeTree(this.value)):this.userInputType=this.value},getFileTypeMap:function(){var t={};return this.typeTree.forEach((function(e){e.valueArr.forEach((function(e){t[e]=!0}))})),t},getTypeFromValue:function(t){if(t==bi)return yi.default;if(""==t)return yi.empty;var e,n=t.split(","),o=this.getFileTypeMap(),i=mi(n);try{for(i.s();!(e=i.n()).done;){var r=e.value;if(!o[r])return yi.input}}catch(a){i.e(a)}finally{i.f()}return yi.select},genderTypeTree:function(t){var e=this,n=[],o=Object(It["d"])(window.FORM_DESIGN_CONFIG.preset["epointsform.fileTypes"]),i=(t||"").split(",");return o.forEach((function(t){t.valueArr=t.items,t.items=e.genderItems(t.valueArr);var o=[];t.valueArr.forEach((function(t){-1!==i.indexOf(t)&&o.push(t)})),t.checkedArr=o,0===t.checkedArr.length?t.allChecked=t.halfChecked=!1:t.checkedArr.length!==t.valueArr.length?(t.allChecked=!1,t.halfChecked=!0):(t.allChecked=!0,t.halfChecked=!1),n.push(t)})),n},genderItems:function(t){return t.map((function(t){return{id:t,text:t}}))},cateCheckedChange:function(t,e){var n;t?(e.allChecked=!0,e.halfChecked=!1,(n=e.checkedArr).splice.apply(n,[0,e.checkedArr.length].concat(Object(ct["a"])(e.valueArr)))):(e.allChecked=!1,e.halfChecked=!1,e.checkedArr.splice(0,e.checkedArr.length))},itemCheckedChange:function(t,e){var n;(n=console).log.apply(n,arguments),t.length==e.items.length?(e.allChecked=!0,e.halfChecked=!1):t.length?(e.allChecked=!1,e.halfChecked=!0):(e.allChecked=!1,e.halfChecked=!1)},hanldeRemoveTag:function(t){var e,n,o=mi(this.dialogTypeTree);try{for(o.s();!(n=o.n()).done;){var i=n.value;if(e=i.checkedArr.indexOf(t),-1!==e){i.allChecked=!1,i.checkedArr.splice(e,1),i.halfChecked=0!==i.checkedArr.length&&i.checkedArr.length!=i.valueArr.length;break}}}catch(r){o.e(r)}finally{o.f()}},configTypeChange:function(t){return t==yi.default?this.change(bi):t==yi.empty?this.change(""):t==yi.input?this.userInputType&&this.change(this.userInputType):t==yi.select?this.change(this.selectedTypes.join(",")):void 0},userInputChange:function(t){if(this.type==yi.input)return this.change(this.userInputType)},change:function(t){this.$emit("change",t,this.config)},showDialog:function(){this.dialogTypeTree=Object(It["d"])(this.typeTree),this.dialogVisible=!0},submitSelect:function(){this.dialogVisible=!1,this.change(this.dialogSelectedTypes.join(","))}},watch:{selectedTypes:function(t){},value:function(){this.type=this.getTypeFromValue(this.value),this.type==yi.select&&(this.typeTree=this.genderTypeTree(this.value))}}},wi=Ci,xi=(n("2e74"),Object(Ct["a"])(wi,hi,pi,!1,null,null,null)),Oi=xi.exports,Di=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"control-form-bind"},[n("div",{staticClass:"form-control-item"},[n("el-select",{style:t.styleText,attrs:{value:t.value,size:"small",clearable:!1,placeholder:"请选择关联字段",filterable:""},on:{change:t.change}},t._l(t.tables,(function(e,o){return n("el-option-group",{key:e.sqltablename||o,attrs:{label:e.name}},t._l(e.fields,(function(i,r){return n("el-option",{key:i.actualId||o+"_"+r,attrs:{disabled:t.selectedFieldMap[i.actualId],value:i.actualId,label:i.name+"("+e.name+")"}})})),1)})),1)],1)])},_i=[],ki=n("3835");function Si(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ji(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Si(Object(n),!0).forEach((function(e){Object(ut["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Si(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ti={name:"control-form-data-combobox",props:{value:{type:String,require:!0},config:{type:Object,require:!0},styleText:{type:String,default:""}},computed:ji(ji(ji({controlType:function(){var t=this.$store.state.selectedControlId;if(t){var e=this.$store.getters.controlDataMap[t];if(e&&e.control)return e.control.type}return null}},Object(Tt["e"])(["fieldList"])),Object(Tt["c"])(["selectedFieldMap"])),{},{tables:function(){var t=this,e=this.controlType,n=Object(It["d"])(this.fieldList),o=Object(It["d"])(this.$store.state.newFieldList),i=!this.value||/#/.test(this.value),r=[];if(n.forEach((function(n,a){0==a&&o.length&&(n.fields=o.concat(n.fields)),n.fields.forEach((function(o){o.actualId=t.joinId(n,o,i),e&&o.fielddisplaytype==e&&r.push(Object(It["d"])(o))}))})),r.length){var a={name:"相关字段",id:"adapts",fields:r};n.unshift(a)}return n}}),methods:{joinId:function(t,e,n){return n?"#".concat(t.sqltablename||"",";#").concat(e.fieldname||""):t.id+";"+e.field},change:function(t){var e=t;t&&!/#/.test(t)&&(e=this.getNewBindValue(t)),this.$emit("change",e,this.config)},getNewBindValue:function(t){var e=t.split(";"),n=Object(ki["a"])(e,2),o=n[0],i=n[1];if(!o||!i)return t;for(var r,a,l=this.$store.state.fieldList,s=0;s<l.length;s++)if(l[s].id==o){r=l[s];for(var c=0;c<r.fields.length;c++)if(i==r.fields[c].field){a=r.fields[c];break}break}return r&&a?this.joinId(r,a,!0):t},doBindAfterCreate:function(t){var e=this.fieldList[0];if(e){var n=this.joinId(e,t,!0);n&&this.change(n)}},old2new:function(){if(this.value&&/#/.test(this.value)){var t=this.value.split(";"),e=Object(ki["a"])(t,2),n=e[0],o=e[1];if(!n||!o)return;var i=n.split("#"),r=o.split("#");if(i[1]&&r[1]){var a="#".concat(i[1],";#").concat(r[1]);this.value!==a&&(this.value,this.change(a))}}},handleAddField:function(){var t=this;this.$bus.$emit("createBindField",(function(e){t.doBindAfterCreate(e)}))}},mounted:function(){this.old2new()}},Ii=Ti,Ei=Object(Ct["a"])(Ii,Di,_i,!1,null,null,null),Pi=Ei.exports,Li=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-tooltip",{attrs:{"popper-class":"control-help-popper",placement:t.placement,content:t.currentValue}},[n("div",{attrs:{slot:"content"},domProps:{innerHTML:t._s(t.currentValue)},slot:"content"}),n("span",{staticClass:"design-help"})])},Ai=[],$i={name:"control-help",props:{config:{type:Object,default:function(){return{}},required:!0}},data:function(){return{placement:this.config.placement||"right",currentValue:this.getContent()}},watch:{"config.content":function(){this.currentValue=this.getContent()}},methods:{getContent:function(){var t=this.config.content;return t?(Array.isArray(t)&&(t=t.join("<br>")),t.replace(/<script/,""),t=t.replace(/ /g,"&nbsp;"),t):""}}},Fi=$i,Mi=Object(Ct["a"])(Fi,Li,Ai,!1,null,null,null),Ni=Mi.exports,Ri=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{suffix:t.config.suffix}},[n("el-input-number",{staticStyle:{"text-align":"left"},style:t.styleText,attrs:{placeholder:t.config.placeholder||"请输入"+(t.config.label||""),size:"small","controls-position":"right",controls:!1},on:{change:t.change},model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}}),t.config.suffix?n("span",{staticClass:"form-control-suffix"},[t._v(t._s(t.config.suffix))]):t._e()],1)},Vi=[],zi=(n("c5f6"),{name:"control-number-textbox",props:{value:{type:[Number,String],default:function(){return""}},config:{type:Object,require:!0},styleText:{type:String,default:""}},data:function(){return{currentValue:parseInt(this.value,10)||0}},watch:{value:function(t){this.currentValue=parseInt(t,10)||0}},methods:{change:function(t){this.$emit("change",t,this.config)}}}),Bi=zi,Ui=Object(Ct["a"])(Bi,Ri,Vi,!1,null,null,null),Gi=Ui.exports,Hi=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-radio-group",{class:"direction-"+t.direction,on:{change:t.change},model:{value:t.currValue,callback:function(e){t.currValue=e},expression:"currValue"}},t._l(t.optionList,(function(e){return n("el-radio",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])})),1)},qi=[],Wi=window.FORM_DESIGN_CONFIG.preset,Ji={name:"control-radio-list",mixins:[Uo],props:{value:{type:String,require:!0},config:{type:Object,require:!0}},data:function(){return{currValue:this.value,loading:!1,originOptionList:[]}},created:function(){!this.config.data&&this.config.url&&this.getOriginData(this.config.url)},watch:{value:function(){this.currValue=this.value}},computed:{direction:function(){return this.config.direction||"horizontal"},optionList:function(){return this.config.data?this.staticOptionList:this.originOptionList},staticOptionList:function(){var t=this.config.data;if(!t)return[];if(Array.isArray(t))return t;var e=t+""===t;return e&&t in Wi?Wi[t]:[]}},methods:{change:function(t){this.$emit("change",t,this.config)}}},Yi=Ji,Xi=Object(Ct["a"])(Yi,Hi,qi,!1,null,null,null),Ki=Xi.exports,Qi=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-switch",{on:{change:t.change},model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}})},Zi=[],tr={name:"control-switch",props:{value:{type:Boolean,default:!1},config:{type:Object,require:!0},styleText:{type:String,default:"width:200px"}},data:function(){return{currentValue:this.value||!1}},watch:{value:function(t){this.currentValue=t}},methods:{change:function(t){this.$emit("change",t,this.config)}}},er=tr,nr=Object(Ct["a"])(er,Qi,Zi,!1,null,null,null),or=nr.exports,ir=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{suffix:t.config.suffix}},[n("el-input",{ref:"input",style:t.styleText,attrs:{placeholder:t.config.placeholder||"请输入"+(t.config.label||""),size:"small"},on:{change:t.change},model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}}),t.config.suffix?n("span",{staticClass:"form-control-suffix"},[t._v(t._s(t.config.suffix))]):t._e()],1)},rr=[],ar={name:"control-textbox",props:{value:{type:String,default:""},config:{type:Object,require:!0},styleText:{type:String,default:""}},data:function(){return{currentValue:this.value||""}},watch:{value:function(t){this.currentValue=t}},methods:{focus:function(){this.$refs.input.select()},change:function(t){this.$emit("change",t,this.config)}}},lr=ar,sr=Object(Ct["a"])(lr,ir,rr,!1,null,null,null),cr=sr.exports,ur=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-control-item width-set",style:t.styleText},[n("el-select",{staticClass:"width-set-select",attrs:{size:"small"},on:{change:t.typeChange},model:{value:t.currType,callback:function(e){t.currType=e},expression:"currType"}},[n("el-option",{attrs:{label:"百分比",value:"percent"}}),n("el-option",{attrs:{label:"像素",value:"number"}})],1),n("el-input-number",{staticClass:"width-set-input",attrs:{min:t.min,max:t.max,size:"small",controls:!1},on:{change:t.change},model:{value:t.currValue,callback:function(e){t.currValue=e},expression:"currValue"}}),n("span",{staticClass:"form-unit form-control-suffix"},[t._v(t._s("percent"==this.currType?"%":"px"))])],1)},dr=[];function fr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function hr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?fr(Object(n),!0).forEach((function(e){Object(ut["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):fr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var pr={name:"control-width-set",props:{value:{type:[String,Number],require:!0},config:{type:Object,require:!0},styleText:{type:String,default:""}},data:function(){var t=this.getAdaptedData(this.value);return hr({min:1},t)},watch:{value:function(){var t=this.getAdaptedData(this.value);this.currType=t.currType,this.currValue=t.currValue,this.max=t.max}},methods:{getAdaptedData:function(t){var e=t+""===t,n=parseInt(t,10)||100;return{currType:e?"percent":"number",currValue:e?Math.min(100,n):n,max:e?100:1/0}},typeChange:function(){this.change(this.currValue)},change:function(t){var e="percent"==this.currType?t+"%":t;this.$emit("change",e,this.config)}}},mr=pr,gr=Object(Ct["a"])(mr,ur,dr,!1,null,null,null),vr=gr.exports,br=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"preset-align"},[n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("对齐")]),n("AlignButton",{attrs:{type:"horizontal"},model:{value:t.textAlign,callback:function(e){t.textAlign=e},expression:"textAlign"}})],1)])},yr=[],Cr={name:"extend-font-align",components:{AlignButton:Sn},props:["controlData"],data:function(){return{textAlign:this.controlData.textAlign}},watch:{"controlData.textAlign":function(t){this.textAlign=t},textAlign:function(t){t!=this.controlData.textAlign&&this.$emit("change",t,"textAlign")}}},wr=Cr,xr=Object(Ct["a"])(wr,br,yr,!1,null,null,null),Or=xr.exports,Dr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.controlData.popup?n("div",{staticClass:"extend-buttonedit-field"},[n("div",{staticClass:"form-item"},[n("div",{staticClass:"form-label"},[t._v("值字段")]),n("div",{staticClass:"form-control"},[n("el-select",{attrs:{size:"small"},model:{value:t.idField,callback:function(e){t.idField=e},expression:"idField"}},t._l(t.list,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1)]),n("div",{staticClass:"form-item"},[n("div",{staticClass:"form-label"},[t._v("显示字段")]),n("div",{staticClass:"form-control"},[n("el-select",{attrs:{size:"small"},model:{value:t.textField,callback:function(e){t.textField=e},expression:"textField"}},t._l(t.list,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1)])]):t._e()},_r=[],kr={};function Sr(t,e,n){var o=t+n;return kr[o]||(kr[o]=Object(It["i"])(t,e).catch((function(t){kr[o]=null,delete kr[o],console.error(t)}))),kr[o]}var jr=Sr;function Tr(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Ir(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,r=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw r}}}}function Ir(t,e){if(t){if("string"===typeof t)return Er(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Er(t,e):void 0}}function Er(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var Pr={name:"extend-buttonedit-field",props:["controlData"],data:function(){return{list:[],idField:this.controlData.idField||"",textField:this.controlData.textField||""}},mounted:function(){this.controlData.popup&&this.getList(this.controlData.popup)},methods:{getList:function(t){var e=this;jr(window.formDesignerActions.getListStructUrl,{listGuid:t},"buttoneditStruct-"+t).then((function(t){if(!Array.isArray(t.ListStruct))throw new TypeError("列表必须为数组");e.list=t.ListStruct,e.checkIn(e.idField,"id",e.list)||(e.idField=""),e.checkIn(e.textField,"id",e.list)||(e.textField="")})).catch((function(t){e.list=[],e.idField=e.textField="",e.console.error(t)}))},checkIn:function(t,e,n){var o,i=Tr(n);try{for(i.s();!(o=i.n()).done;){var r=o.value;if(r[e]==t)return!0}}catch(a){i.e(a)}finally{i.f()}return!1},change:function(t,e){this.$emit("change",t,e)}},watch:{"controlData.popup":function(t){t?this.getList(t):(this.list=[],this.idField=this.textField="")},idField:function(t){t!=this.controlData.idField&&this.change(t,"idField")},textField:function(t){t!=this.controlData.textField&&this.change(t,"textField")}}},Lr=Pr,Ar=Object(Ct["a"])(Lr,Dr,_r,!1,null,null,null),$r=Ar.exports,Fr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"preset-data-action",class:{disabled:t.hasAutoCodeItem}},[t.hasAutoCodeItem?n("div",{staticClass:"tips"},[n("i",{staticClass:"el-icon-info",staticStyle:{color:"#409EFF"}}),t._v(" 选中的关联字段已经有对应数据源了")]):t._e(),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("配置方式")]),n("div",{staticClass:"form-control"},[n("el-radio-group",{attrs:{disabled:t.hasAutoCodeItem},model:{value:t.sourceType,callback:function(e){t.sourceType=e},expression:"sourceType"}},t._l(t.sourceList,(function(e){return n("el-radio",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])})),1)],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:"static"==t.sourceType,expression:"sourceType == 'static'"}],staticClass:"form-item"},[n("el-form",{ref:"dataActionForm",attrs:{model:t.customData,inline:!0,disabled:t.hasAutoCodeItem}},t._l(t.customData,(function(e,o){return n("div",{key:o,staticClass:"data-source-item"},[n("el-form-item",{staticClass:"data-source-input value",attrs:{prop:o+".id",rules:t.rules.id}},[n("el-input",{attrs:{placeholder:"值",size:"mini"},model:{value:e.id,callback:function(n){t.$set(e,"id",n)},expression:"item.id"}})],1),n("el-form-item",{staticClass:"data-source-input text",attrs:{prop:o+".text",rules:t.rules.text}},[n("el-input",{attrs:{placeholder:"显示名称",size:"mini"},model:{value:e.text,callback:function(n){t.$set(e,"text",n)},expression:"item.text"}})],1),n("el-button",{staticClass:"data-source-item-btn del",attrs:{type:"danger",plain:"",size:"mini",icon:"el-icon-delete"},on:{click:function(e){return t.deleteItem(o)}}}),n("el-button",{staticClass:"data-source-item-btn up",attrs:{size:"mini",icon:"el-icon-caret-top",disabled:"0"==o},on:{click:function(e){return t.moveUp(o)}}}),n("el-button",{staticClass:"data-source-item-btn down",attrs:{size:"mini",icon:"el-icon-caret-bottom",disabled:o==t.customData.length-1},on:{click:function(e){return t.moveDown(o)}}})],1)})),0),n("el-button",{attrs:{icon:"el-icon-plus",size:"mini"},on:{click:t.addItem}},[t._v("添加选项")]),n("el-button",{attrs:{disabled:!t.customData.length,icon:"el-icon-save",size:"mini"},on:{click:t.applyItem}},[t._v("应用")])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:"action"==t.sourceType,expression:"sourceType == 'action'"}],staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("远程数据源")]),n("div",{staticClass:"form-control"},[n("el-select",{attrs:{placeholder:"请选择远程数据源",disabled:t.hasAutoCodeItem,size:"small",filterable:""},on:{change:t.onActionChange},model:{value:t.selectedAction,callback:function(e){t.selectedAction=e},expression:"selectedAction"}},t._l(t.actionList,(function(t){return n("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})})),1)],1)])])},Mr=[];function Nr(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Rr(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,r=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw r}}}}function Rr(t,e){if(t){if("string"===typeof t)return Vr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Vr(t,e):void 0}}function Vr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var zr={name:"extend-data-action",props:["controlData"],components:{},data:function(){var t=this.controlData,e=t.data,n=t.codeItem,o=Array.isArray(e);return{sourceType:o?"static":"action",sourceList:[{id:"static",text:"自定义"},{id:"action",text:"远程"}],customData:o?Object(It["d"])(e):[],selectedAction:n||"",rules:{id:[{validator:this.validateId,trigger:"blur"}],text:[{required:!0,message:"必须输入显示名称",trigger:"blur"}]}}},computed:{hasAutoCodeItem:function(){return!1},actionList:function(){return Object(It["d"])(this.$store.state.codeList)}},methods:{validateId:function(t,e,n){if(!e)return n(new Error("必填"));var o=this.customData[t.field.split(".")[0]];return this.checkDuplicated(e,o)?n(new Error("值必须唯一")):n()},checkDuplicated:function(t,e){var n,o=Nr(this.customData);try{for(o.s();!(n=o.n()).done;){var i=n.value;if(i!==e&&t==i.id)return!0}}catch(r){o.e(r)}finally{o.f()}return!1},addItem:function(){var t=this;if(this.customData.length)return this.$refs.dataActionForm.validate((function(e){e?t.customData.push({id:"",text:""}):t.$message({message:"请先处理当前内容",customClass:"data-action-error-box",type:"error"})}));this.customData.push({id:"",text:""})},deleteItem:function(t){this.customData.splice(t,1)},applyItem:function(){var t=this;this.$refs.dataActionForm.validate((function(e,n){var o;o=e?Object(It["d"])(t.customData):Object(It["d"])(t.customData.filter((function(t,e){return!(e+".id"in n)&&!(e+".text"in n)}))),Array.isArray(o)&&t.useStaticData(o)}))},moveUp:function(t){if(0!==t){var e=this.customData.splice(t,1)[0];this.customData.splice(t-1,0,e)}},moveDown:function(t){if(t!==this.customData.length-1){var e=this.customData.splice(t,1)[0];this.customData.splice(t+1,0,e)}},onActionChange:function(t){this.useAction(t)},useStaticData:function(t){var e;this.controlData.codeItem&&(e="dataaction"+ +new Date,this.$emit("change","","codeItem",e)),this.$emit("change",t,"data",e)},useAction:function(t){var e;this.controlData.data&&(e="dataaction"+ +new Date,this.$emit("change","","data",e)),this.$emit("change",t,"codeItem",e)}},watch:{sourceType:function(t){"action"==t&&this.useAction(this.selectedAction)},controlData:{deep:!0,handler:function(){var t=this.controlData,e=t.data,n=t.codeItem;Array.isArray(e)?(this.customData=Object(It["d"])(e),this.sourceType="static"):this.sourceType="action",n&&(this.selectedAction=n)}}}},Br=zr,Ur=(n("25cd"),Object(Ct["a"])(Br,Fr,Mr,!1,null,null,null)),Gr=Ur.exports,Hr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"extend-daterange-config"},[n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("日期范围")]),n("div",{staticClass:"form-control"},[n("el-select",{attrs:{size:"small"},on:{change:t.onRangeTypeChange},model:{value:t.rangeType,callback:function(e){t.rangeType=e},expression:"rangeType"}},t._l(t.rangeTypeList,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1)]),"range"==t.rangeType?n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("开始")]),n("div",{staticClass:"form-control"},[n("el-select",{staticClass:"form-control-item",attrs:{size:"small"},on:{change:function(e){return t.selectedChange(e,"start")}},model:{value:t.selectedValue1,callback:function(e){t.selectedValue1=e},expression:"selectedValue1"}},[n("el-option",{attrs:{value:"static",label:"选择固定日期"}}),t._l(t.controlList,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],2),t.selectedValue1==t.typeMap.static?n("el-date-picker",{staticClass:"form-control-item",attrs:{"picker-options":t.startPickerOptions,"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择开始日期",size:"small"},on:{change:function(e){return t.onDateChange("start")}},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}}):t._e()],1)]):t._e(),"range"==t.rangeType?n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("结束")]),n("div",{staticClass:"form-control"},[n("el-select",{staticClass:"form-control-item",attrs:{size:"small"},on:{change:function(e){return t.selectedChange(e,"end")}},model:{value:t.selectedValue2,callback:function(e){t.selectedValue2=e},expression:"selectedValue2"}},[n("el-option",{attrs:{value:"static",label:"选择固定日期"}}),t._l(t.controlList,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],2),t.selectedValue2==t.typeMap.static?n("el-date-picker",{staticClass:"form-control-item",attrs:{"picker-options":t.endPickerOptions,"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择结束日期",size:"small"},on:{change:function(e){return t.onDateChange("end")}},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}}):t._e()],1)]):t._e()])},qr=[];function Wr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Jr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Wr(Object(n),!0).forEach((function(e){Object(ut["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Wr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Yr=/^\d{4}-\d{2}-\d{2}$/,Xr=/^\{.+\}$/,Kr={name:"extend-daterange-config",props:["controlData"],components:{},computed:{startType:function(){return this.getLimitType(this.controlData.minDate)},endType:function(){return this.getLimitType(this.controlData.maxDate)},controlList:function(){var t=this,e=/datepicker/i,n=this.$store.state.hiddenControls,o=this.$store.getters.allControls,i=[];return o.forEach((function(n){e.test(n.type)&&n.id!=t.controlData.id&&i.push({type:n.type,id:n.id,name:n.name||n.namePrefix+"_"+n.autoIndex})})),n.forEach((function(t){i.push({type:t.type,id:t.id,name:t.name||t.namePrefix+"_"+t.autoIndex})})),i}},data:function(){var t=this;return Jr(Jr({rangeType:this.getRangeType(this.controlData.minDate,this.controlData.maxDate),rangeTypeList:[{id:"empty",text:"留空"},{id:"range",text:"指定范围"}]},this.getDateFromControl(this.controlData)),{},{typeMap:{static:"static",control:"control"},startPickerOptions:{disabledDate:function(e){return!!t.endDate&&e.getTime()>new Date(t.endDate).getTime()}},endPickerOptions:{disabledDate:function(e){return!!t.startDate&&e.getTime()<new Date(t.startDate).getTime()}}})},methods:{getDateFromControl:function(t){var e="",n="",o="",i="";return t.minDate&&(Xr.test(t.minDate)?e=t.minDate.substring(1,t.minDate.length-1):Yr.test(t.minDate)?(e="static",o=t.minDate):console.error("日期不合法： "+t.minDate)),t.maxDate&&(Xr.test(t.maxDate)?n=t.maxDate.substring(1,t.maxDate.length-1):Yr.test(t.maxDate)?(n="static",i=t.maxDate):console.error("日期不合法： "+t.maxDate)),{selectedValue1:e,selectedValue2:n,startDate:o,endDate:i}},getRangeType:function(t,e){return!t&&!e||""==t&&""==e?"empty":"range"},getLimitType:function(t){return t&&""!=t?Yr.test(t)?this.typeMap.static:this.typeMap.control:this.typeMap.static},onRangeTypeChange:function(t){"empty"==t?this.clearRange():(this.startDate&&this.onDateChange("start"),this.endDate&&this.onDateChange("end"))},clearRange:function(){""!=this.controlData.minDate&&this.$emit("change","","minDate"),""!=this.controlData.maxDate&&this.$emit("change","","maxDate")},selectedChange:function(t,e){if(t!=this.typeMap.static)t&&this.$emit("change","{".concat(t,"}"),"start"==e?"minDate":"maxDate");else{var n="start"==e?this.startDate:this.endDate;n&&this.$emit("change",n,"start"==e?"minDate":"maxDate")}},onDateChange:function(t){"range"==this.rangeType&&("start"==t&&this.startType==this.typeMap.static&&this.$emit("change",this.startDate,"minDate"),"end"==t&&this.endType==this.typeMap.static&&this.$emit("change",this.endDate,"maxDate"))}}},Qr=Kr,Zr=Object(Ct["a"])(Qr,Hr,qr,!1,null,null,null),ta=Zr.exports,ea=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"extend-fieldname"},[n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("字段英文名")]),n("div",{staticClass:"form-control"},[n("div",{staticClass:"form-control-item"},[n("el-input",{directives:[{name:"popover",rawName:"v-popover",value:"error",expression:"'error'"}],staticClass:"extend-fieldname-input",class:{"in-error":t.hasError},attrs:{disabled:!t.enabled},on:{change:t.onValueChange,focus:t.onFocus},model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}}),n("el-popover",{ref:"error",attrs:{placement:"bottom",width:"200",trigger:"hover",content:"字段名称仅支持以字母开头的字母数字组合"}})],1)])]),t.isMultiField?n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("字段英文名2")]),n("div",{staticClass:"form-control"},[n("div",{staticClass:"form-control-item"},[n("el-input",{directives:[{name:"popover",rawName:"v-popover",value:"error2",expression:"'error2'"}],staticClass:"extend-fieldname-input",class:{"in-error":t.hasError2},attrs:{disabled:!t.enabled},on:{change:t.onValueChange2,focus:t.onFocus},model:{value:t.currentValue2,callback:function(e){t.currentValue2=e},expression:"currentValue2"}}),n("el-popover",{ref:"error2",attrs:{placement:"bottom",width:"200",trigger:"hover",content:"字段名称仅支持以字母开头的字母数字组合"}})],1)])]):t._e()])},na=[],oa={name:"extend-fieldname",props:["controlData"],components:{},mounted:function(){},beforeDestroy:function(){this.hasError=!1,clearTimeout(this.timer)},computed:{isMultiField:function(){return"daterangepicker"==this.controlData.type},enabled:function(){var t=this.controlData;return!t.isCommonField&&!t.universalId&&(!t.bind&&!t.bind2)}},data:function(){return{timer:null,hasError:!1,currentValue:this.controlData.fieldName||"",hasError2:!1,currentValue2:this.controlData.fieldName||""}},methods:{autoHide:function(){var t=this;clearTimeout(this.timer),this.timer=setTimeout((function(){t.hasError=!1}),1e3)},onFocus:function(){this.hasError=!1},onValueChange:function(t){t?/^[^\d][a-zA-Z\d_]+$/.test(t)?this.change(t,"fieldName"):(this.hasError=!0,this.currentValue=""):this.change("","fieldName")},onValueChange2:function(t){t?/^[^\d][a-zA-Z\d_]+$/.test(t)?this.change(t,"fieldName2"):(this.hasError2=!0,this.currentValue2=""):this.change("","fieldName2")},change:function(t,e){e&&void 0!==t&&this.$emit("change",t,e)}},watch:{"controlData.fieldName":function(t){this.currentValue=t||""}}},ia=oa,ra=(n("8e22"),Object(Ct["a"])(ia,ea,na,!1,null,null,null)),aa=ra.exports,la=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"preset-font"},[n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("字体")]),n("el-select",{staticClass:"font-set-select",attrs:{size:"small"},model:{value:t.fontFamily,callback:function(e){t.fontFamily=e},expression:"fontFamily"}},t._l(t.fontFamilyList,(function(t){return n("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})})),1),n("el-input-number",{staticClass:"font-set-input",attrs:{size:"small",controls:!1,min:12,max:100},model:{value:t.fontSize,callback:function(e){t.fontSize=e},expression:"fontSize"}}),n("span",{staticClass:"form-control-suffix"},[t._v("px")])],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("样式")]),n("FontColor",{staticStyle:{"margin-right":"10px"},model:{value:t.fontColor,callback:function(e){t.fontColor=e},expression:"fontColor"}}),n("div",{staticClass:"design-button-group font-group"},[n("el-tooltip",{attrs:{"open-delay":500,content:"加粗"}},[n("MyButton",{class:{active:t.fontBolder},attrs:{icon:"font-bold"},nativeOn:{click:function(e){t.fontBolder=!t.fontBolder}}})],1),n("el-tooltip",{attrs:{"open-delay":500,content:"倾斜"}},[n("MyButton",{class:{active:t.fontItalic},attrs:{icon:"font-italic"},nativeOn:{click:function(e){t.fontItalic=!t.fontItalic}}})],1),n("el-tooltip",{attrs:{"open-delay":500,content:"下划线"}},[n("MyButton",{class:{active:t.fontUnderline},attrs:{icon:"font-underline"},nativeOn:{click:function(e){t.fontUnderline=!t.fontUnderline}}})],1)],1)],1)])},sa=[],ca=window.FORM_DESIGN_CONFIG.preset.fontFamilyList,ua={name:"extend-font-config",props:["controlData"],components:{FontColor:uo,MyButton:On},data:function(){return{fontFamilyList:JSON.parse(JSON.stringify(ca)),fontFamily:this.controlData.fontFamily,fontSize:this.controlData.fontSize,fontColor:this.controlData.fontColor,fontBolder:this.controlData.fontBolder,fontItalic:this.controlData.fontItalic,fontUnderline:this.controlData.fontUnderline}},methods:{handleChange:function(t,e){this.controlData[e]!=t&&this.$emit("change",t,e)}},watch:{controlData:{deep:!0,handler:function(){var t=this.controlData,e=t.fontFamily,n=t.fontSize,o=t.fontColor,i=t.fontBolder,r=t.fontItalic,a=t.fontUnderline;this.fontFamily=e,this.fontSize=n,this.fontColor=o,this.fontBolder=i,this.fontItalic=r,this.fontUnderline=a}},fontFamily:function(t){this.handleChange(t,"fontFamily")},fontSize:function(t){this.handleChange(t,"fontSize")},fontColor:function(t){this.handleChange(t,"fontColor")},fontBolder:function(t){this.handleChange(t,"fontBolder")},fontItalic:function(t){this.handleChange(t,"fontItalic")},fontUnderline:function(t){this.handleChange(t,"fontUnderline")}}},da=ua,fa=Object(Ct["a"])(da,la,sa,!1,null,null,null),ha=fa.exports,pa=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"frozen-column"},[n("div",{staticClass:"form-item"},[n("div",{staticClass:"form-control "},[n("el-checkbox",{on:{change:t.onSwitch},model:{value:t.isFrozen,callback:function(e){t.isFrozen=e},expression:"isFrozen"}},[t._v("冻结列")])],1)]),t.isFrozen?n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("冻结列索引")]),n("div",{staticClass:"form-control "},[n("el-input-number",{attrs:{min:0,max:t.columnLength-2,size:"mini",controls:!1},on:{change:t.change},model:{value:t.frozenIndex,callback:function(e){t.frozenIndex=e},expression:"frozenIndex"}})],1)]):t._e()])},ma=[],ga={name:"extend-frozen-column",props:["controlData"],computed:{columnLength:function(){var t=this.controlData.specialColumns.split(",").length,e=this.controlData.columns.length||4;return t+e}},data:function(){var t=parseInt(this.controlData.frozenColumnIndex,10);return{isFrozen:-1!==t,frozenIndex:t}},methods:{change:function(t){this.controlData.frozenIndex!=t&&this.$emit("change",t,"frozenColumnIndex")},onSwitch:function(t){var e=this;t?this.$nextTick((function(){e.change(e.frozenIndex)})):this.$emit("change",-1,"frozenColumnIndex")}},watch:{"controlData.frozenColumnIndex":function(t){var e=parseInt(t,10);this.frozenIndex=e,this.isFrozen=-1!==e}}},va=ga,ba=Object(Ct["a"])(va,pa,ma,!1,null,null,null),ya=ba.exports,Ca=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"multi-form"},[n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("默认值")]),n("div",{staticClass:"form-control"},[n("virtual-select",{attrs:{clearable:"",multiple:t.multiSelect,placeholder:t.list.length?"请选择默认值":"请先选择数据源",items:t.list,buffer:34,"item-size":34,filterable:"","filter-key":"text"},on:{change:t.onValueChange},scopedSlots:t._u([{key:"default",fn:function(t){var e=t.item;return[n("el-option",{key:e.id,attrs:{slot:"default",label:e.text,value:e.id},slot:"default"})]}}]),model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}})],1)])])},wa=[],xa=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:t.handleClose,expression:"handleClose"}],staticClass:"el-select",class:[t.selectSize?"el-select--"+t.selectSize:""],on:{click:function(e){return e.stopPropagation(),t.toggleMenu(e)}}},[t.multiple?n("div",{ref:"tags",staticClass:"el-select__tags",style:{"max-width":t.inputWidth-32+"px",width:"100%"}},[t.collapseTags&&t.selected.length?n("span",[n("el-tag",{attrs:{closable:!t.selectDisabled,size:t.collapseTagSize,hit:t.selected[0].hitState,type:"info","disable-transitions":""},on:{close:function(e){return t.deleteTag(e,t.selected[0])}}},[n("span",{staticClass:"el-select__tags-text"},[t._v(t._s(t.selected[0].currentLabel))])]),t.selected.length>1?n("el-tag",{attrs:{closable:!1,size:t.collapseTagSize,type:"info","disable-transitions":""}},[n("span",{staticClass:"el-select__tags-text"},[t._v("+ "+t._s(t.selected.length-1))])]):t._e()],1):t._e(),t.collapseTags?t._e():n("transition-group",{on:{"after-leave":t.resetInputHeight}},t._l(t.selected,(function(e){return n("el-tag",{key:t.getValueKey(e),attrs:{closable:!t.selectDisabled,size:t.collapseTagSize,hit:e.hitState,type:"info","disable-transitions":""},on:{close:function(n){return t.deleteTag(n,e)}}},[n("span",{staticClass:"el-select__tags-text"},[t._v(t._s(e.currentLabel))])])})),1),t.filterable?n("input",{directives:[{name:"model",rawName:"v-model",value:t.query,expression:"query"}],ref:"input",staticClass:"el-select__input",class:[t.selectSize?"is-"+t.selectSize:""],style:{"flex-grow":"1",width:t.inputLength/(t.inputWidth-32)+"%","max-width":t.inputWidth-42+"px"},attrs:{type:"text",disabled:t.selectDisabled,autocomplete:t.autoComplete||t.autocomplete},domProps:{value:t.query},on:{focus:t.handleFocus,blur:function(e){t.softFocus=!1},keyup:t.managePlaceholder,keydown:[t.resetInputState,function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:(e.preventDefault(),t.navigateOptions("next"))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:(e.preventDefault(),t.navigateOptions("prev"))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.selectOption(e))},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"]))return null;e.stopPropagation(),e.preventDefault(),t.visible=!1},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete","Del"])?null:t.deletePrevTag(e)},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"tab",9,e.key,"Tab"))return null;t.visible=!1}],compositionstart:t.handleComposition,compositionupdate:t.handleComposition,compositionend:t.handleComposition,input:[function(e){e.target.composing||(t.query=e.target.value)},t.debouncedQueryChange]}}):t._e()],1):t._e(),n("el-input",{ref:"reference",class:{"is-focus":t.visible},attrs:{id:t.id,type:"text",name:t.name,placeholder:t.currentPlaceholder,autocomplete:t.autoComplete||t.autocomplete,size:t.selectSize,disabled:t.selectDisabled,readonly:t.readonly,"validate-event":!1,tabindex:t.multiple&&t.filterable?"-1":null},on:{focus:t.handleFocus,blur:t.handleBlur},nativeOn:{keyup:function(e){return t.debouncedOnInputChange(e)},keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:(e.stopPropagation(),e.preventDefault(),t.navigateOptions("next"))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:(e.stopPropagation(),e.preventDefault(),t.navigateOptions("prev"))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.selectOption(e))},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"]))return null;e.stopPropagation(),e.preventDefault(),t.visible=!1},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"tab",9,e.key,"Tab"))return null;e.stopPropagation(),e.preventDefault(),t.visible=!1}],paste:function(e){return t.debouncedOnInputChange(e)},mouseenter:function(e){t.inputHovering=!0},mouseleave:function(e){t.inputHovering=!1}},model:{value:t.selectedLabel,callback:function(e){t.selectedLabel=e},expression:"selectedLabel"}},[t.$slots.prefix?n("template",{slot:"prefix"},[t._t("prefix")],2):t._e(),n("template",{slot:"suffix"},[n("i",{directives:[{name:"show",rawName:"v-show",value:!t.showClose,expression:"!showClose"}],class:["el-select__caret","el-input__icon","el-icon-"+t.iconClass]}),t.showClose?n("i",{staticClass:"el-select__caret el-input__icon el-icon-circle-close",on:{click:t.handleClearClick}}):t._e()])],2),n("transition",{attrs:{name:"el-zoom-in-top"},on:{"before-enter":t.handleMenuEnter,"after-leave":t.doDestroy}},[n("el-select-menu",{directives:[{name:"show",rawName:"v-show",value:t.visible&&!1!==t.emptyText,expression:"visible && emptyText !== false"}],ref:"popper",attrs:{"append-to-body":t.popperAppendToBody}},[n("div",{staticClass:"el-select-dropdown__wrap el-scrollbar__wrap",staticStyle:{overflow:"hidden",position:"relative"}},[n("recycle-scroller",{ref:"virtualScroller",staticClass:"scroller",style:t.scrollerStyle,attrs:{items:t.data,buffer:t.buffer,"key-field":t.keyField,"item-size":t.itemSize},scopedSlots:t._u([{key:"before",fn:function(){return[t._t("before")]},proxy:!0},{key:"default",fn:function(e){var n=e.item,o=e.index,i=e.active;return[t._t("default",null,{item:n,index:o,active:i})]}},{key:"after",fn:function(){return[t._t("after")]},proxy:!0}],null,!0)}),t.emptyText&&(!t.allowCreate||t.loading||t.allowCreate&&0===t._items.length)?[t.$slots.empty?t._t("empty"):n("p",{staticClass:"el-select-dropdown__empty"},[t._v("\n              "+t._s(t.emptyText)+"\n            ")])]:t._e()],2)])],1)],1)},Oa=[],Da=n("e508");n("a899");function _a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ka(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_a(Object(n),!0).forEach((function(e){Object(ut["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Sa={name:"VirtualSelect",components:ka(ka({},L.a.components),{},{RecycleScroller:Da["a"]}),directives:ka({},L.a.directives),mixins:[L.a],props:ka(ka(ka({},L.a.props),Da["a"].props),{},{filterKey:String}),data:function(){var t=L.a.data.bind(this),e=t();return ka(ka({},e),{},{data:Object(ct["a"])(this.items)})},computed:ka(ka({},L.a.computed),{},{scrollerStyle:function(){var t=Math.min(this.data.length,5),e=this.itemSize*t;return"height: ".concat(e,"px")}}),watch:{items:function(t){this.data=Object(ct["a"])(t)},visible:function(t){t&&(this.data=Object(ct["a"])(this.items))}},created:function(){var t=L.a.created.bind(this);t()},mounted:function(){var t=L.a.mounted.bind(this);t()},methods:ka(ka({},L.a.methods),{},{handleQueryChange:function(t){var e=this;this.previousQuery===t||this.isOnComposition||(null!==this.previousQuery||"function"!==typeof this.filterMethod&&"function"!==typeof this.remoteMethod?(this.previousQuery=t,this.$nextTick((function(){e.visible&&e.broadcast("ElSelectDropdown","updatePopper")})),this.hoverIndex=-1,this.multiple&&this.filterable&&this.$nextTick((function(){var t=15*e.$refs.input.value.length+20;e.inputLength=e.collapseTags?Math.min(50,t):t,e.managePlaceholder(),e.resetInputHeight()})),this.remote&&"function"===typeof this.remoteMethod?(this.hoverIndex=-1,this.remoteMethod(t)):"function"===typeof this.filterMethod?(this.filterMethod(t),this.broadcast("ElOptionGroup","queryChange")):this.filterKey&&(this.query,this.data=t?this.items.filter((function(n){var o=e.filterKey;return n.hasOwnProperty(o)&&n[o].indexOf(t)>-1})):Object(ct["a"])(this.items),this.filteredOptionsCount=this.optionsCount,this.broadcast("ElOption","queryChange",t),this.broadcast("ElOptionGroup","queryChange")),this.defaultFirstOption&&(this.filterable||this.remote)&&this.filteredOptionsCount&&this.checkDefaultFirstOption()):this.previousQuery=t)},scrollToOption:function(t){var e=Array.isArray(t)?t[0]:t;if(e&&e.$vnode){var n=e.$vnode.key;this.$refs.virtualScroller.scrollToItem(n)}}})},ja=Sa,Ta=(n("e06a"),Object(Ct["a"])(ja,xa,Oa,!1,null,null,null)),Ia=Ta.exports;var Ea={components:{VirtualSelect:Ia},name:"extend-list-default-value",props:["controlData"],mounted:function(){this.getValue(),this.getList()},data:function(){return{loading:!1,list:[],currentValue:[]}},computed:{multiSelect:function(){var t=this.controlData.type;return"radiobuttonlist"!=t&&("checkboxlist"==t||"combobox"==t&&!!this.controlData.multiSelect)}},methods:{getList:function(){var t=this.controlData,e=t.data,n=t.codeItem;if(e&&Array.isArray(e))return this.list=Object(It["d"])(e),void this.checkValueInList();this.getData(n)},getData:function(t){var e=this;this.loading=!0,this.list=[],t?jr(window.formDesignerActions.getControlDataListUrl,{controlData:this.controlData},t).then((function(t){if(!t||!Array.isArray(t))throw new Error("代码列表获取失败");e.loading=!1,e.list=t,e.checkValueInList()})).catch((function(t){console.error("请求失败",t),e.loading=!1,e.list=[]})):this.$emit("change","","defaultValue")},getValue:function(){var t=this.controlData.defaultValue,e=this.multiSelect?[]:"";this.currentValue=t?this.multiSelect?t.split(","):t:e},checkValueInList:function(){var t=this.currentValue,e=this.list;if(t&&(!this.multiSelect||t.length)){var n=!0;n=!!Array.isArray(e)&&(this.multiSelect?t.every((function(t){return e.some((function(e){return e.id==t}))})):e.some((function(e){return e.id==t}))),n||this.$emit("change","","defaultValue")}},onValueChange:function(t){var e=t&&t.toString?t.toString():t||"";this.$emit("change",e,"defaultValue")}},watch:{"controlData.codeItem":function(){this.getList()},"controlData.data":function(){this.getList()},"controlData.defaultValue":function(){this.getValue()}}},Pa=Ea,La=Object(Ct["a"])(Pa,Ca,wa,!1,null,null,null),Aa=La.exports,$a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"multi-form"},[n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("所属手风琴")]),n("div",{staticClass:"form-control"},[n("el-select",{staticClass:"form-control-item",on:{change:t.onAccChange},model:{value:t.multiFormAccId,callback:function(e){t.multiFormAccId=e},expression:"multiFormAccId"}},t._l(t.accList,(function(e){return n("el-option",{key:e.id,attrs:{value:e.id,label:e.text}},[t._v(t._s(e.text))])})),1)],1)]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("所属栏目")]),n("div",{staticClass:"form-control"},[n("el-select",{staticClass:"form-control-item",on:{change:t.onSubCateChange},model:{value:t.multiFormColumnId,callback:function(e){t.multiFormColumnId=e},expression:"multiFormColumnId"}},t._l(t.subList,(function(e){return n("el-option",{key:e.id,attrs:{value:e.id,label:e.text}},[t._v(t._s(e.text))])})),1)],1)]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("排序值")]),n("div",{staticClass:"form-control"},[n("el-input-number",{staticClass:"form-control-item",attrs:{controls:!1},on:{change:t.onIndexChange},model:{value:t.multiFormIndex,callback:function(e){t.multiFormIndex=e},expression:"multiFormIndex"}})],1)])])},Fa=[];function Ma(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Na={name:"extend-multi-form",props:["controlData"],mounted:function(){this.getAccList(),this.addMultiFormProps(),this.multiFormColumnId&&this.multiFormAccId&&this.getSubCateList(this.multiFormAccId)},data:function(){var t=this.controlData;return{accList:[],subList:[],multiFormAccId:Ma(t,"multiFormAccId")?t.multiFormAccId:"",multiFormColumnId:Ma(t,"multiFormColumnId")?t.multiFormColumnId:"",multiFormIndex:Ma(t,"multiFormIndex")?t.multiFormIndex:0}},methods:{addMultiFormProps:function(){Ma(this.controlData,"multiFormAccId")&&Ma(this.controlData,"multiFormColumnId")&&Ma(this.controlData,"multiFormIndex")||this.$store.commit({type:"addMultiFormProps",controlData:this.controlData})},getAccList:function(){var t=this;return jr(window.formDesignerActions.getMultiFormAccListUrl,{},"").then((function(e){var n=e.dataValue;Array.isArray(n)?(t.accList=n,t.multiFormAccId&&!t.checkValueInList(t.multiFormAccId,n)&&(t.multiFormAccId="",t.change("multiFormAccId",""))):t.accList=[]}))},getSubCateList:function(t){var e=this;return jr(window.formDesignerActions.getMultiFormSubCateListUrl,{codeId:t},"subid-"+t).then((function(t){var n=t.itemDataValue;Array.isArray(n)?(e.subList=n,e.multiFormColumnId&&!e.checkValueInList(e.multiFormColumnId,n)&&(e.multiFormColumnId="",e.change("","multiFormColumnId"))):(e.subList=[],e.change("","multiFormColumnId"))}))},change:function(t,e){e&&void 0!==t&&this.$emit("change",t,e)},checkValueInList:function(t,e){return e.some((function(e){return e.id==t}))},onAccChange:function(t){this.change(t,"multiFormAccId"),this.subList=[],this.getSubCateList(t)},onSubCateChange:function(t){this.change(t,"multiFormColumnId")},onIndexChange:function(t){this.change(t,"multiFormIndex")}},watch:{controlData:{deep:!0,handler:function(){this.addMultiFormProps(),this.multiFormAccId!=this.controlData.multiFormAccId&&(this.multiFormAccId=this.controlData.multiFormAccId),this.multiFormColumnId!=this.controlData.multiFormColumnId&&(this.multiFormColumnId=this.controlData.multiFormColumnId),this.multiFormIndex!=this.controlData.multiFormIndex&&(this.multiFormIndex=this.controlData.multiFormIndex),this.multiFormColumnId&&this.multiFormAccId&&this.getSubCateList(this.multiFormAccId)}}}},Ra=Na,Va=Object(Ct["a"])(Ra,$a,Fa,!1,null,null,null),za=Va.exports,Ba=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"extend-range-validate"},[n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v(t._s(t.validateTextMap[t.validateType]))]),n("div",{staticClass:"form-control"},[n("el-switch",{on:{change:t.change},model:{value:t.showRangeValidate,callback:function(e){t.showRangeValidate=e},expression:"showRangeValidate"}})],1)]),t.showRangeValidate?n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("值")]),n("div",{staticClass:"form-control"},[n("el-select",{staticClass:"range-validate-operation",attrs:{size:"small"},on:{change:t.change},model:{value:t.operation1,callback:function(e){t.operation1=e},expression:"operation1"}},t._l(t.operationList,(function(t){return n("el-option",{key:t,attrs:{value:t,label:t}})})),1),n("el-select",{staticClass:"range-validate-value",attrs:{size:"small"},on:{change:t.change},model:{value:t.selectedValue1,callback:function(e){t.selectedValue1=e},expression:"selectedValue1"}},[n("el-option",{attrs:{value:"static",label:"输入固定值"}}),t._l(t.controlList,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],2),"static"==t.selectedValue1?n("el-input",{staticClass:"range-validate-input",attrs:{placeholder:"请输入",size:"small"},on:{change:t.change},model:{value:t.operationValue1,callback:function(e){t.operationValue1=e},expression:"operationValue1"}}):t._e(),n("span",{directives:[{name:"show",rawName:"v-show",value:!t.showExt,expression:"!showExt"}],staticClass:"ext-btn el-icon-plus",on:{click:t.showCondition2}})],1)]):t._e(),t.showRangeValidate?n("div",{directives:[{name:"show",rawName:"v-show",value:t.showExt,expression:"showExt"}],staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("且")]),n("div",{staticClass:"form-control"},[n("el-select",{staticClass:"range-validate-operation",attrs:{size:"small"},on:{change:t.change},model:{value:t.operation2,callback:function(e){t.operation2=e},expression:"operation2"}},t._l(t.operationList,(function(t){return n("el-option",{key:t,attrs:{value:t,label:t}})})),1),n("el-select",{staticClass:"range-validate-value",attrs:{size:"small"},on:{change:t.change},model:{value:t.selectedValue2,callback:function(e){t.selectedValue2=e},expression:"selectedValue2"}},[n("el-option",{attrs:{value:"static",label:"输入固定值"}}),t._l(t.controlList,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],2),"static"==t.selectedValue2?n("el-input",{staticClass:"range-validate-input",attrs:{placeholder:"请输入",size:"small"},on:{change:t.change},model:{value:t.operationValue2,callback:function(e){t.operationValue2=e},expression:"operationValue2"}}):t._e(),n("span",{staticClass:"ext-btn el-icon-delete",on:{click:t.hideCondition2}})],1)]):t._e()])},Ua=[];n("55dd");function Ga(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Ha(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ga(Object(n),!0).forEach((function(e){Object(ut["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ga(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var qa={name:"extend-range-validate",props:["controlData"],data:function(){return Ha({validateTextMap:{string:"文本值比较",number:"数值比较"}},this.getCompentValueFromControl(this.controlData))},computed:{controlList:function(){var t=this,e=/textbox|textarea|radiobuttonlist|combobox|macro|treeselect/i,n=this.$store.state.hiddenControls,o=this.$store.getters.allControls,i=[];return o.forEach((function(n){e.test(n.type)&&n.id!=t.controlData.id&&i.push({type:n.type,id:n.id,name:n.name||n.namePrefix+"_"+n.autoIndex})})),n.forEach((function(t){i.push({type:t.type,id:t.id,name:t.name||t.namePrefix+"_"+t.autoIndex})})),i.sort((function(t,e){return t.type==e.type?0:"textbox"==e.type&&"textbox"!=t.type||"hiddenfield"==e.type&&"hiddenfield"!=t.type?1:-1})),i},inputType:function(){var t=this.controlData.vtype;return"int"==t||"float"==t?"number":"string"},operationList:function(){return"number"==this.inputType?["<","<=","==",">",">="]:["=="]},condition1Done:function(){return!(!this.operation1||!this.selectedValue1)&&!("static"==this.selectedValue1&&!this.operationValue1)},condition2Done:function(){return!(!this.operation2||!this.selectedValue2)&&!("static"==this.selectedValue2&&!this.operationValue2)}},methods:{getCompentValueFromControl:function(t){var e=!1,n=!1,o="",i="",r="",a="",l="",s="",c="",u=(t||this.controlData).vtype,d=(t||this.controlData).rangeValidator,f=d&&d.conditions;if(o="int"==u||"float"==u?"number":"string",f&&f.length){if(e=!0,f[0]){i=f[0].operation;var h=this.getOperationInfo(f[0].value);a=h.type,s=h.value}else i="string"==o?"==":"<=",s=a="";if(f[1]){r=f[1].operation;var p=this.getOperationInfo(f[1].value);l=p.type,c=p.value,n=!0}else r="string"==o?"==":">=",c=l="",n=!1}return{showRangeValidate:e,showExt:n,validateType:o,operation1:i,operation2:r,selectedValue1:a,selectedValue2:l,operationValue1:s,operationValue2:c}},getOperationInfo:function(t){if(/^\{.+\}$/.test(t)){var e=t.substring(1,t.length-1);return{type:e,value:""}}return{type:"static",value:t}},showCondition2:function(){if(!this.condition1Done)return this.$message({type:"error",message:"请先填好当前条件"});this.showExt=!0,this.change()},hideCondition2:function(){this.showExt=!1,this.operation2="string"==this.validateType?"==":">=",this.operationValue2=this.selectedValue2="",this.change()},getSubmitValue:function(){var t={type:this.validateType,conditions:[]};return this.condition1Done&&t.conditions.push({operation:this.operation1,value:"static"==this.selectedValue1?this.operationValue1:"{".concat(this.selectedValue1,"}")}),this.showExt&&this.condition2Done&&t.conditions.push({operation:this.operation2,value:"static"==this.selectedValue2?this.operationValue2:"{".concat(this.selectedValue2,"}")}),t},change:function(){var t=this.getSubmitValue();this.showRangeValidate&&t&&t.conditions&&t.conditions.length||(t=null),this.$emit("change",t,"rangeValidator")}},watch:{"controlData.vtype":function(){var t=this.getCompentValueFromControl(this.controlData),e=t.showRangeValidate,n=t.showExt,o=t.validateType,i=t.operation1,r=t.operation2,a=t.selectedValue1,l=t.selectedValue2,s=t.operationValue1,c=t.operationValue2;this.showRangeValidate=e,this.showExt=n,this.validateType=o,this.operation1=i,this.operation2=r,this.selectedValue1=a,this.selectedValue2=l,this.operationValue1=s,this.operationValue2=c}}},Wa=qa,Ja=Object(Ct["a"])(Wa,Ba,Ua,!1,null,null,null),Ya=Ja.exports,Xa=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.showFormSelect?n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("编辑页地址")]),n("div",{staticClass:"form-control"},[n("el-select",{staticClass:"form-control-item",attrs:{size:"mini"},on:{change:t.change},model:{value:t.selectedFormId,callback:function(e){t.selectedFormId=e},expression:"selectedFormId"}},t._l(t.formList,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1)]):t._e()},Ka=[],Qa={name:"extend-sub-table-edit-form",props:["controlData"],computed:{showFormSelect:function(){return"dialog"==this.controlData.editType},tableId:function(){return this.controlData.sourceTable}},data:function(){return{selectedFormId:this.controlData.editFormGuid||"",formList:[]}},mounted:function(){this.getForms()},methods:{getForms:function(){var t=this;if(!this.tableId)return this.formList=[];jr(window.formDesignerActions.getSubTableInfoUrl,{tableId:this.tableId},"subTableData-"+this.tableId).then((function(e){var n=e.SubTableForm;if(!Array.isArray(n))throw new Error("获取编辑表单失败");t.formList=n.map((function(t){return{id:t.formGuid,text:t.formName}}))})).catch((function(t){console.error(t)}))},change:function(t){this.$emit("change",t,"editFormGuid")}},watch:{tableId:function(){this.showFormSelect&&this.getForms()},"controlData.editFormGuid":function(t){this.selectedFormId=t}}},Za=Qa,tl=Object(Ct["a"])(Za,Xa,Ka,!1,null,null,null),el=tl.exports,nl=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"extend-sub-table-fields"},[n("div",{staticClass:"form-item"},[n("el-button",{attrs:{disabled:!t.tableId,size:"mini"},on:{click:function(e){t.showDialog=!0}}},[t._v("点击配置")])],1),n("el-dialog",{staticClass:"column-config-dialog",attrs:{"append-to-body":"",title:"表格字段配置",visible:t.showDialog,"before-close":t.handleClose,width:t.showEditor?"80%":"50%"},on:{"update:visible":function(e){t.showDialog=e}}},[t.showDialog?n("div",[n("div",{staticClass:"column-config-header"},[n("div",{staticClass:"span display"},[t._v("显示")]),n("div",{staticClass:"span move"},[t._v("排序")]),n("div",{staticClass:"span name"},[t._v("名称")]),t.showEditor?n("div",{staticClass:"span editor"},[t._v("编辑类型")]):t._e(),t.showEditor?n("div",{staticClass:"span required"},[t._v("必填")]):t._e(),n("div",{staticClass:"span align"},[t._v("对齐方式")]),n("div",{staticClass:"span width"},[t._v("列宽(px)")]),t.showEditor?n("div",{staticClass:"span vtype"},[t._v("格式校验")]):t._e()]),n("div",{staticClass:"column-config-list"},[n("draggable",{attrs:{list:t.columns,handle:".move",direction:"vertical"},on:{start:function(e){t.drag=!0},end:function(e){t.drag=!1},change:t.change}},t._l(t.columns,(function(e){return n("column-config",{key:e.field,attrs:{field:e,showEditor:t.showEditor},on:{change:t.change}})})),1)],1)]):t._e(),n("span",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.save}},[t._v("确 定")]),n("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.beforeClose()}}},[t._v("取 消")])],1)])],1)},ol=[],il=n("b76a"),rl=n.n(il),al=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"column-config-item"},[n("div",{staticClass:"span display"},[n("el-checkbox",{on:{change:function(e){return t.change("display",t.field.display)}},model:{value:t.field.display,callback:function(e){t.$set(t.field,"display",e)},expression:"field.display"}})],1),t._m(0),n("div",{staticClass:"span name"},[n("el-input",{attrs:{size:"mini"},on:{change:function(e){return t.change("name",t.field.name)}},model:{value:t.field.name,callback:function(e){t.$set(t.field,"name",e)},expression:"field.name"}})],1),t.showEditor?n("div",{staticClass:"span editor"},[n("el-select",{attrs:{size:"mini"},on:{change:function(e){return t.change("controlType",t.field.controlType)}},model:{value:t.field.controlType,callback:function(e){t.$set(t.field,"controlType",e)},expression:"field.controlType"}},t._l(t.controlTypes,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1):t._e(),t.showEditor?n("div",{staticClass:"span required"},[n("el-checkbox",{on:{change:function(e){return t.change("required",t.field.required)}},model:{value:t.field.required,callback:function(e){t.$set(t.field,"required",e)},expression:"field.required"}})],1):t._e(),n("div",{staticClass:"span align"},[n("AlignButton",{attrs:{type:"horizontal"},on:{change:function(e){return t.change("align",t.field.align)}},model:{value:t.field.align,callback:function(e){t.$set(t.field,"align",e)},expression:"field.align"}})],1),n("div",{staticClass:"span width"},[n("el-input-number",{attrs:{size:"mini",controls:!1},on:{change:function(e){return t.change("width",t.field.width)}},model:{value:t.field.width,callback:function(e){t.$set(t.field,"width",e)},expression:"field.width"}})],1),t.showEditor?n("div",{staticClass:"span vtype"},[n("el-select",{attrs:{size:"mini",disabled:"textbox"!=t.field.controlType},on:{change:function(e){return t.change("vtype",t.field.vtype)}},model:{value:t.field.vtype,callback:function(e){t.$set(t.field,"vtype",e)},expression:"field.vtype"}},t._l(t.vtypeList,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1):t._e()])},ll=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"span move"},[n("span",{staticClass:"sort-handle el-icon-rank",staticStyle:{cursor:"move"}})])}],sl={name:"column-config",components:{AlignButton:Sn},props:["field","showEditor"],computed:{},data:function(){return{vtypeList:Object(It["d"])(window.FORM_DESIGN_CONFIG.preset["epointsform.validateTypes"]),controlTypes:Object(It["d"])(window.FORM_DESIGN_CONFIG.preset["epointsform.columnEditors"])}},methods:{change:function(t,e){this.$emit("change",t,e)}}},cl=sl,ul=Object(Ct["a"])(cl,al,ll,!1,null,null,null),dl=ul.exports,fl={width:100,align:"center",required:!1,controlType:"",vtype:""},hl={name:"extend-sub-table-fields",components:{ColumnConfig:dl,draggable:rl.a},props:["controlData"],computed:{tableId:function(){return this.controlData.sourceTable},fieldMap:function(){var t={};return this.fieldList.forEach((function(e){t[e.field]=e})),t},showEditor:function(){return"dialog"!=this.controlData.editType}},mounted:function(){this.getFields()},data:function(){return{fieldList:[],columns:[],showDialog:!1,loading:!1,drag:!1,dataChanged:!1}},methods:{getConfigColumns:function(){var t=this;if(this.fieldList.length){var e=this.controlData.columns||[];if(e.length){var n=[],o={};e.forEach((function(e){t.fieldMap[e.field]&&(o[e.field]=!0,n.push(Bo()({},fl,e)))})),this.fieldList.forEach((function(t){o[t.field]||n.push(Bo()({},fl,t))})),this.columns=n}else this.columns=this.fieldList.map((function(t){var e=Bo()({},fl,t);return e.display=!0,e}))}else this.columns=[]},getRealColumns:function(){if(!this.columns.length)return[];var t=Object(It["d"])(this.columns).filter((function(t){return t.display}));return t.forEach((function(t){t.controlType&&"textbox"!=t.controlType&&(t.vtype="")})),t},change:function(){this.dataChanged=!0},beforeClose:function(t){var e=this;this.dataChanged?this.$confirm("确认不保存直接关闭？").then((function(){t?t():e.showDialog=!1})).catch((function(t){console.error(t)})):this.showDialog=!1},handleClose:function(t){this.beforeClose(t)},getFields:function(){var t=this;if(!this.tableId)return this.fieldList=[];this.loading=!0,jr(window.formDesignerActions.getSubTableInfoUrl,{tableId:this.tableId},"subTableData-"+this.tableId).then((function(e){var n=e.SubTableStruct;if(!Array.isArray(n))throw new Error("获取子表字段失败");n.forEach((function(t){t.required=1==parseInt(t.required,10)})),t.fieldList=n})).catch((function(e){console.error(e),t.loading=!1}))},save:function(){var t=this.getRealColumns();this.$emit("change",t,"columns"),this.showDialog=!1}},watch:{tableId:function(){this.getFields()},fieldList:function(){this.getConfigColumns()},showDialog:function(t){t||(this.dataChanged=!1)}}},pl=hl,ml=(n("f5bd"),Object(Ct["a"])(pl,nl,ol,!1,null,null,null)),gl=ml.exports,vl=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"extend-sub-table-source"},[n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("数据来源")]),n("div",{staticClass:"form-control"},[n("el-select",{attrs:{value:t.value,size:"small",filterable:"",clearable:""},on:{change:t.change}},t._l(t.optionList,(function(t){return n("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})})),1)],1)])])},bl=[],yl={name:"extend-sub-table-source",props:["controlData"],data:function(){return{value:""}},mounted:function(){this.controlData.sourceTable?this.value=this.controlData.sourceTable:this.value=""},computed:{optionList:function(){var t="sourceTables";return this.$store.state[t]}},methods:{change:function(t){var e=this.getTargetItemPid(t);this.$emit("change",t,"sourceTable"),e&&this.$emit("change",e,"sourceTablePid")},getTargetItemPid:function(t){for(var e="",n=this.optionList.length-1;n>=0;n--)if(this.optionList[n]&&this.optionList[n].id==t){e=this.optionList[n].parentId;break}return e}},watch:{"controlData.sourceTable":function(t){this.value=t}}},Cl=yl,wl=Object(Ct["a"])(Cl,vl,bl,!1,null,null,null),xl=wl.exports,Ol=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tooltip-config"},[n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("位置")]),n("div",{staticClass:"form-control"},[n("div",{staticClass:"design-button-group tooltip-group",attrs:{"data-value":t.type}},t._l(t.typeList,(function(e){return n("el-tooltip",{key:e,attrs:{"open-delay":500,content:t.tipsText[e]}},[n("MyButton",{class:{active:t.type==e},attrs:{icon:"tooltip-type-"+e},nativeOn:{click:function(n){return t.activeBtn(e)}}})],1)})),1)])]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("内容")]),n("div",{staticClass:"form-control"},[n("el-input",{staticClass:"form-control-item",attrs:{type:"textarea",rows:"3",placeholder:"请输入提示内容",allowresize:"false"},on:{change:t.onContentChange},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1)])])},Dl=[];function _l(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var kl={name:"extend-tooltip-config",props:["controlData"],components:{MyButton:On},mounted:function(){this.addTooltipConfig()},data:function(){var t=this.controlData.tooltipConfig;return{type:t?t.type:"tooltip",content:t?t.content:"",tipsText:{tooltip:"tooltip 提示",right:"右侧提示",bottom:"底部提示"},typeList:["tooltip","bottom"]}},methods:{activeBtn:function(t){this.type=t,this.change(t,"tooltipConfig.type")},onContentChange:function(t){this.change(t,"tooltipConfig.content")},addTooltipConfig:function(){_l(this.controlData,"tooltipConfig")||this.$store.commit({type:"addTooltipConfig",controlData:this.controlData})},change:function(t,e){e&&void 0!==t&&this.$emit("change",t,e)}},watch:{controlData:{deep:!0,immediate:!0,handler:function(){this.addTooltipConfig();var t=this.controlData.tooltipConfig;t.type!==this.type&&(this.type=t.type),t.content!==this.content&&(this.content=t.content)}}}},Sl=kl,jl=(n("13f1"),Object(Ct["a"])(Sl,Ol,Dl,!1,null,null,null)),Tl=jl.exports,Il={checkbox:No,checkboxlist:Jo,combobox:ei,defaultdate:fi,filetypepicker:Oi,fontcolor:uo,formdatacombobox:Pi,help:Ni,numbertextbox:Gi,radiobuttonlist:Ki,switch:or,textbox:cr,widthconfig:vr,"extend-alignconfig":Or,"extend-buttoneditfield":$r,"extend-dataaction":Gr,"extend-daterangeconfig":ta,"extend-fieldname":aa,"extend-fontconfig":ha,"extend-frozencolumn":ya,"extend-listdefaultvalue":Aa,"extend-multiform":za,"extend-rangevalidate":Ya,"extend-subtableeditform":el,"extend-subtablefields":gl,"extend-subtablesource":xl,"extend-tooltipconfig":Tl},El={name:"default-control-component",inheritAttrs:!1,props:["config","value","controlData"],template:'<div>{{controlData ? "配置功能" : config.type}} 开发中...</div>'},Pl=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{},[n("el-dropdown",{staticClass:"add-event-drop",attrs:{size:"small",trigger:"click",placement:"bottom-start"},on:{command:t.addEvent}},[n("div",{staticClass:"add-event-drop-trigger"},[n("span",{staticClass:"el-icon-plus add-event-icon"}),t._v("添加事件\n    ")]),n("el-dropdown-menu",{staticClass:"add-event-dropmenu",attrs:{slot:"dropdown"},slot:"dropdown"},[t._l(t.eventTypeList,(function(e){return n("el-dropdown-item",{key:"1-"+e.type,attrs:{command:{type:e.type,initRun:!1}}},[t._v(t._s(e.name))])})),n("li",{staticClass:"el-dropdown-menu__item",staticStyle:{"pointer-events":"none",color:"#999","margin-top":"10px"}},[t._v("初始化事件")]),t._l(t.eventTypeList,(function(e){return n("el-dropdown-item",{key:"2-"+e.type,attrs:{command:{type:e.type,initRun:!0}}},[t._v(t._s(e.name))])}))],2)],1),t.eventList.length?n("div",{},t._l(t.controlData.events,(function(e,o){return n("div",{key:o},t._l(e,(function(e,i){return n("EventCard",{key:e.type+"-"+i,attrs:{"event-data":e,"target-name-map":t.targetNameMap},on:{"edit-event":function(e){return t.editEvent(o,i)},"remove-event":function(e){return t.removeEvent(o,i)},"remove-action":function(e){var n=arguments.length,r=Array(n);while(n--)r[n]=arguments[n];return t.removeEventAction.apply(void 0,[o,i].concat(r))}}})})),1)})),0):t._e(),n("el-dialog",{staticClass:"event-config-dialog",attrs:{width:"800px",visible:t.dialogVisible,title:"add"==t.configData.editType?"新增事件":"修改事件","close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":t.cancel,"append-to-body":""}},[t.dialogVisible?n("EventConfig",{attrs:{"control-data":t.controlData,"target-name-map":t.targetNameMap,"edit-type":t.configData.editType,"default-event-type":t.configData.eventType,"event-description":t.configData.evData,"event-type-list":t.eventTypeList},on:{save:t.saveEvent,cancel:t.cancel}}):t._e()],1)],1)},Ll=[],Al=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"event-config"},[n("div",{staticClass:"event-config-header"},[n("el-select",{staticClass:"event-config-typeselect",attrs:{size:"small",disabled:!t.eventTypeChangeable||!t.eventTypeList.length||1==t.eventTypeList.length},on:{change:t.onEventTypeChanged},model:{value:t.eventType,callback:function(e){t.eventType=e},expression:"eventType"}},t._l(t.eventTypeList,(function(t){return n("el-option",{key:t.type,attrs:{value:t.type,label:t.name}})})),1),n("div",{directives:[{name:"show",rawName:"v-show",value:t.showCondition,expression:"showCondition"}],staticClass:"event-config-condition"},[t._v("\n      当满足 This\n      "),n("el-select",{staticClass:"event-operation",attrs:{size:"small"},model:{value:t.condition.operation,callback:function(e){t.$set(t.condition,"operation",e)},expression:"condition.operation"}},t._l(t.operationList,(function(e){return n("el-option",{key:e,attrs:{value:e,label:t.operationNames[e]}})})),1),n("virtual-select",{attrs:{clearable:"",size:"small",items:t.controlDataList,buffer:34,"item-size":34,filterable:"","filter-key":"text"},scopedSlots:t._u([{key:"default",fn:function(t){var e=t.item;return[n("el-option",{key:e.id,attrs:{slot:"default",label:e.text,value:e.id},slot:"default"})]}}]),model:{value:t.condition.target,callback:function(e){t.$set(t.condition,"target",e)},expression:"condition.target"}})],1)],1),n("div",{staticClass:"event-config-body"},[n("div",{staticClass:"event-config-lane choice"},[n("h3",{staticClass:"event-config-title"},[t._v("选择动作")]),t.eventConfigMap[t.eventType]?n("div",{staticClass:"event-config-list choice"},t._l(t.eventConfigMap[t.eventType].actionList,(function(e){return n("div",{key:e.type,staticClass:"choice-action-item",class:{disabled:t.selectedActions[e.type]},on:{click:function(n){return t.addAction(e.type)}}},[t._v(t._s(e.name))])})),0):t._e()]),n("div",{staticClass:"event-config-lane action-config"},[n("h3",{staticClass:"event-config-title"},[t._v("组织动作")]),t.actions.length?n("div",{staticClass:"event-config-list"},t._l(t.actions,(function(e,o){return n("div",{key:e.type,staticClass:"action-item"},[n("h4",{staticClass:"action-header",class:{active:e.type==t.currentAction,collaspe:e.collaspe},on:{click:function(n){t.currentAction=e.type}}},[n("span",{staticClass:"el-icon-arrow-down action-toggle",on:{click:function(t){t.stopPropagation(),e.targets.length&&(e.collaspe=!e.collaspe)}}}),n("span",{staticClass:"action-name"},[t._v(t._s(e.name))]),n("span",{staticClass:"action-remove el-icon-close",on:{click:function(n){return n.stopPropagation(),t.removeAction(o,e.type==t.currentAction)}}})]),e.targets.length?n("div",{staticClass:"action-targets",style:"height:"+30*e.targets.length+"px"},t._l(e.targets,(function(e){return n("div",{key:e.id},[t._v("\n              "+t._s(t.targetNameMap[e.id])+"\n              "),e.setValueField?n("span",[t._v(t._s(t.fieldNameMap[e.setValueField]))]):t._e()])})),0):n("span",[t._v("请在右侧为动作选择目标")])])})),0):n("span",[t._v("请先从左侧添加动作")])]),n("div",{staticClass:"event-config-lane targets"},[n("h3",{staticClass:"event-config-title"},[t._v("\n        对象目标 "+t._s(t.currentActionName)+"\n        "),"assignment"==t.currentAction?n("div",[n("div",{staticClass:"event-config-target-table"},[n("label",[t._v("赋值来源数据表：")]),n("el-select",{staticStyle:{float:"right","margin-right":"10px"},attrs:{size:"mini",filterable:""},on:{change:t.onTargetTableChange},model:{value:t.targetTable,callback:function(e){t.targetTable=e},expression:"targetTable"}},t._l(t.dataTables,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1),"assignment"==t.currentAction?n("div",{staticClass:"event-config-target-tablefield"},[n("label",[t._v("数据查询字段：")]),n("el-select",{staticStyle:{float:"right","margin-right":"10px"},attrs:{size:"mini",filterable:""},model:{value:t.targetTableField,callback:function(e){t.targetTableField=e},expression:"targetTableField"}},t._l(t.fieldList,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1):t._e()]):t._e()]),t.currentAction?n("TargetDisplay",{staticClass:"event-config-list",class:{table:"assignment"==t.currentAction,tablefield:"assignment"==t.currentAction},attrs:{type:t.treeDisplayType,"default-targets":t.currentActionTargets,"action-type":t.currentAction,"field-list":t.fieldList,"field-name-map":t.fieldNameMap,"except-id":t.controlData.id},on:{"ckecked-change":t.handleTargetChange}}):n("span",[t._v("请先选择动作")])],1)]),n("div",{staticClass:"event-config-footer"},[n("el-checkbox",{model:{value:t.runAtInit,callback:function(e){t.runAtInit=e},expression:"runAtInit"}},[t._v("初始化执行")]),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.save}},[t._v("保存")]),n("el-button",{attrs:{size:"mini"},on:{click:t.cancel}},[t._v("取消")])],1)])},$l=[],Fl={valuechanged:{name:"值变更",originType:"valuechanged",actions:["assignment"]},"valuechanged:compare":{name:"值变更(关系比较)",originType:"valuechanged",actions:["show","hide","assignment","clear"]},"valuechanged:getcodelist":{name:"值变更(获取代码项)",originType:"valuechanged",actions:["setData"]}},Ml={show:{name:"显示"},hide:{name:"隐藏"},assignment:{name:"赋值"},clear:{name:"清空"},setData:{name:"数据源设置"}},Nl=(Object.keys(Ml).map((function(t){return Ml[t].type=t,Ml})),Object.keys(Fl).map((function(t){return Fl[t].type=t,Fl[t].actionList=Fl[t].actions.map((function(t){return Ml[t]})),Fl[t]}))),Rl={"<=":"小于等于","<":"小于","!=":"不等于","==":"等于",">":"大于",">=":"大于等于"};function Vl(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function zl(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Vl(Object(n),!0).forEach((function(e){Object(ut["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Vl(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Bl(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Ul(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,r=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw r}}}}function Ul(t,e){if(t){if("string"===typeof t)return Gl(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gl(t,e):void 0}}function Gl(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var Hl={name:"event-config",components:{TargetDisplay:function(){return n.e("chunk-14c5851b").then(n.bind(null,"22f8"))},VirtualSelect:Ia},props:{editType:{type:String,required:!0,validator:function(t){return/^(?:add|edit)$/.test(t)}},defaultEventType:{type:String,required:!0},eventTypeList:{type:Array,default:function(){return Nl}},controlData:{type:Object},eventDescription:[Object,null],targetNameMap:{type:Object}},computed:{eventTypeChangeable:function(){return"add"==this.editType},dataTables:function(){return this.$store.state.dataTables},selectedActions:function(){var t={};return this.actions.forEach((function(e){t[e.type]=!0})),t},showCondition:function(){return"valuechanged:compare"==this.eventType},treeDisplayType:function(){return/^(?:show|hide|clear)$/.test(this.currentAction)?"all":"assignment"==this.currentAction?"controls":"setData"==this.currentAction?"combobox":""},currentActionName:function(){var t=this.actionInfo[this.currentAction];return t?"(".concat(t.name,")"):""},currentActionTargets:function(){var t,e=Bl(this.actions);try{for(e.s();!(t=e.n()).done;){var n=t.value;if(n.type==this.currentAction)return n.targets||[]}}catch(o){e.e(o)}finally{e.f()}return[]},fieldNameMap:function(){var t={};return this.fieldList.forEach((function(e){t[e.id]=e.text})),t}},data:function(){return{actionInfo:Ml,eventType:this.defaultEventType,eventConfigMap:Fl,condition:{operation:"==",target:""},operationList:["==","!="],operationNames:Rl,actions:[],currentAction:"",runAtInit:!1,targetTable:"",targetTableField:"",fieldList:[],controlDataList:[]}},created:function(){this.getFieldList(),this.getControlDataList(),this.setEditEventData()},mounted:function(){"add"==this.editType&&1==this.eventConfigMap[this.eventType].actionList.length&&this.addAction(this.eventConfigMap[this.eventType].actionList[0].type)},methods:{setEditEventData:function(){var t=this,e=Object(It["d"])(this.eventDescription),n=e.type,o=e.runAtInit,i=e.conditions,r=e.actions;n&&(this.eventType=n),i&&i.length&&(this.condition.operation=i[0].operation,this.condition.target=i[0].target),Array.isArray(r)?(this.actions=r.map((function(e){return"assignment"==e.type&&(t.targetTable=e.sourceTableId,t.targetTableField=e.sourceTableField||""),zl(zl({},e),{},{name:Ml[e.type].name,collaspe:!1})})),this.currentAction=this.actions[0].type):(this.actions.length&&(this.actions=[]),this.currentAction=""),this.runAtInit=o},getFieldList:function(){var t=this;if(!this.targetTable)return this.fieldList=[];Sr(window.formDesignerActions.getTableFieldsUrl,{tableId:this.targetTable},"targerTable-"+this.targetTable).then((function(e){var n=e.TableStruct;Array.isArray(n)?t.fieldList=n:t.fieldList=[]})).catch((function(t){console.error(t)}))},getControlDataList:function(){var t=this;if(this.controlDataList=[],this.showCondition)return this.controlData.data?this.controlDataList=Object(It["d"])(this.controlData.data):this.$httpPost(window.formDesignerActions.getControlDataListUrl,{controlData:this.controlData}).then((function(e){if(!Array.isArray(e))throw new Error("获取控件数据出错!");t.controlDataList=e})).catch((function(t){console.error(t)}))},addAction:function(t){this.selectedActions[t]||(this.actions.push(this.createAction(t)),this.currentAction=t)},createAction:function(t){var e=Ml[t].name,n={type:t,name:e,targets:[],collaspe:!1};return n},removeAction:function(t,e){this.actions.splice(t,1),e&&(this.currentAction="")},handleTargetChange:function(t){var e=this,n=this.actions.filter((function(t){return t.type==e.currentAction}))[0];n?n.targets=t:console.error("目标动作不存在")},onEventTypeChanged:function(){this.actions=[],this.currentAction=""},validate:function(){var t=this;return new Promise((function(e,n){var o=[];!t.showCondition||t.condition.operation&&t.condition.target||o.push({type:"condition",message:"事件条件未填写完整"}),t.actions.length?t.actions.forEach((function(e){e.targets&&e.targets.length||o.push({type:"action",target:e,message:"【".concat(e.name,"】动作未配置任何操作目标！")}),"assignment"==e.type&&(t.targetTable||o.push({type:"targetTable",message:"赋值必须选择数据来源表"}),t.targetTableField||o.push({type:"targetTableField",message:"必须选择查询字段"}),e.targets.forEach((function(t){t.setValueField||o.push({type:"target",message:"【".concat(e.name,"】动作下的 ").concat(t.nodeName," 控件未配置赋值字段！！")})})))})):o.push({type:"action",message:"还未配置任何事件动作！"}),o.length?n(o):e()}))},save:function(){var t=this;return this.validate().then((function(){t._doSave()})).catch((function(e){var n;Array.isArray(e)?(console.error(e),n=1==e.length?e[0].message:"事件配置信息不完整，请检查",t.$message({message:n,type:"error",customClass:"event-config-error",showClose:!0})):console.error(e)}))},_doSave:function(){var t=this,e={type:this.eventType,originType:Fl[this.eventType].originType,runAtInit:this.runAtInit};this.showCondition&&(e.conditions=[Object(It["d"])(this.condition)]),e.actions=this.actions.map((function(e){var n={type:e.type,targets:e.targets.map((function(t){var e={type:t.nodeType||t.type,id:t.id};return t.setValueField&&(e.setValueField=t.setValueField),e}))};return"assignment"==e.type&&(n.sourceTableId=t.targetTable,n.sourceTableField=t.targetTableField),n})),JSON.stringify(e,0,2),this.$emit("save",this.eventType,e)},cancel:function(){this.$emit("cancel")},clearBindValueField:function(){var t=this.actions.filter((function(t){return"assignment"==t.type}))[0];t.sourceTableField="",t&&t.targets&&t.targets.forEach((function(t){t.setValueField=""}))},onTargetTableChange:function(){this.clearBindValueField()}},watch:{targetTable:function(){this.fieldList=[],this.getFieldList()},showCondition:function(t){t&&this.getControlDataList()}}},ql=Hl,Wl=(n("165c"),Object(Ct["a"])(ql,Al,$l,!1,null,null,null)),Jl=Wl.exports,Yl=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"event-card"},[n("div",{staticClass:"event-card-header"},[n("span",{staticClass:"el-icon-arrow-down event-card-toggle"}),n("span",{staticClass:"event-name"},[t._v(t._s(t.eventInfo[t.eventData.type].name))]),n("span",{staticClass:"event-card-config"},[n("span",{staticClass:"el-icon-setting event-card-setting",on:{click:t.editEvent}}),n("span",{staticClass:"el-icon-delete event-card-delete",on:{click:t.removeEvent}})])]),t.eventData.conditions&&t.eventData.conditions.length?n("div",{staticClass:"event-card-condition"},[t._v("当满足 This "+t._s(t.operationNames[t.eventData.conditions[0].operation])+" "+t._s(t.eventData.conditions[0].target)+" 时")]):t._e(),n("div",{staticClass:"event-card-actions"},t._l(t.eventData.actions,(function(e,o){return n("div",{key:e.type,staticClass:"event-card-action"},[n("span",{staticClass:"event-card-action-remove el-icon-close",on:{click:function(n){return t.removeAction(e.type,o,1==t.eventData.actions.length)}}}),n("div",{staticClass:"event-card-action-name"},[t._v(t._s(t.actionInfo[e.type].name))]),n("div",{staticClass:"event-card-action-targets"},t._l(e.targets,(function(e){return n("div",{key:e.id,staticClass:"event-card-action-target"},[t._v("\n          "+t._s(t.targetNameMap[e.id])+" "),e.setValueField?n("span",{staticStyle:{"margin-left":"10px"}},[t._v("[ "+t._s(e.setValueField)+" ]")]):t._e()])})),0)])})),0),t.eventData.runAtInit?n("div",{staticClass:"event-card-init"},[n("span",{staticClass:"el-icon-s-flag"}),t._v(" 初始化时执行")]):t._e()])},Xl=[],Kl={name:"event-card",components:{},props:{eventData:{type:Object},targetNameMap:{type:Object}},data:function(){return{eventInfo:Fl,actionInfo:Ml,operationNames:Rl}},methods:{removeAction:function(t,e,n){var o=this;this.$confirm(n?"此事件下仅有此一个动作，将删除事件，是否继续？":"确认移除此此事件动作？").then((function(){o.$emit("remove-action",t,e)})).catch((function(){}))},editEvent:function(){this.$emit("edit-event")},removeEvent:function(){var t=this;this.$confirm("确认移除此事件？").then((function(){t.$emit("remove-event")})).catch((function(){}))}}},Ql=Kl,Zl=(n("b020"),Object(Ct["a"])(Ql,Yl,Xl,!1,null,null,null)),ts=Zl.exports;function es(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ns(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?es(Object(n),!0).forEach((function(e){Object(ut["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):es(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var os={add:"add",edit:"edit"},is={name:"event",components:{EventConfig:Jl,EventCard:ts},props:["controlData"],computed:{eventTypeList:function(){var t=this.controlData.type,e=window.FORM_DESIGN_CONFIG.controls[t].supportEvents;return Nl.filter((function(t){return-1!=e.indexOf(t.type)}))},eventList:function(){var t=this.controlData.events;if(t){var e=[];return Object.keys(t).forEach((function(n){e.push.apply(e,Object(ct["a"])(t[n]))})),e}return[]},targetNameMap:function(){var t=this.$store.getters.controlNameMap,e=this.$store.getters.allRows,n={};return e.forEach((function(t){n[t.id]=t.name||"".concat(t.namePrefix,"_").concat(t.autoIndex)})),ns(ns({},t),n)}},data:function(){return{dialogVisible:!1,configData:{editType:os.add,eventType:"",evData:null,editingIndex:-1,editingType:""}}},methods:ns(ns({},Object(Tt["b"])(["setControlProp"])),{},{addEvent:function(t){var e=t.type,n=t.initRun;this.configData.eventType=e,this.configData.editType=os.add,this.configData.evData={runAtInit:n},this.dialogVisible=!0},editEvent:function(t,e){this.configData.eventType=t,this.configData.editType=os.edit,this.configData.evData=this.controlData.events[t][e],this.configData.editingIndex=e,this.configData.editingType=t,this.dialogVisible=!0},saveEvent:function(t,e){var n=this.controlData.events?Object(It["d"])(this.controlData.events):{};if(this.configData.editType==os.add)n[t]?n[t].push(e):n[t]=[e];else{var o=this.configData,i=o.editingType,r=o.editingIndex;i&&-1!=r?n[i][r]=e:console.error("修改事件发生错误！")}this.setControlProp({prop:"events",value:n,control:this.controlData}),this.dialogVisible=!1},saveEditEvent:function(){},cancel:function(){this.dialogVisible=!1},removeEvent:function(t,e){var n=this,o=this.controlData.events;JSON.stringify(o[t][e],0,2);var i=Object(It["d"])(o);1==i[t].length?delete i[t]:i[t].splice(e,1),JSON.stringify(i,0,2);var r="remove-event";if("valuechanged:getcodelist"==t){var a=this.controlData.id,l=this.$store.getters.allControls.filter((function(t){return t.codeSyncPid==a}));l.length&&l.forEach((function(t){n.setControlProp({group:r,prop:"codeSyncPid",value:"",control:t})}))}this.setControlProp({group:r,prop:"events",value:i,control:this.controlData})},removeEventAction:function(t,e,n,o){if(void 0===o)return console.error("无法删除，错误的动作索引："+o);var i=this.controlData.events;JSON.stringify(i[t][e].actions[o],0,2);var r=Object(It["d"])(i),a=r[t][e];a.actions&&a.actions.length?(a.actions.splice(o,1),a.actions.length||(a=null,1==r[t].length?delete r[t]:r[t].splice(e,1)),JSON.stringify(r,0,2),this.setControlProp({prop:"events",value:r,control:this.controlData})):console.error("无法删除")}})},rs=is,as=(n("ec83"),Object(Ct["a"])(rs,Pl,Ll,!1,null,null,null)),ls=as.exports;function ss(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function cs(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ss(Object(n),!0).forEach((function(e){Object(ut["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ss(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var us={name:"config-control",components:{NameConfig:Po,EventComponent:ls},props:["control"],computed:cs(cs({},Object(Tt["c"])(["controlType2nameMap"])),{},{controlType:function(){var t=this.control.type;return this.controlType2nameMap[t]},controlConfig:function(){var t=this.control.type,e=window.FORM_DESIGN_CONFIG.controls[t];return e?Object(It["d"])(e.configItems):(console.error("".concat(t," 类型控件的配置不存在，请检查！！！")),[])},supportEvent:function(){var t=this.control.type,e=window.FORM_DESIGN_CONFIG.controls[t].supportEvents;return e&&e.length},eventCount:function(){if(!this.supportEvent)return 0;var t=this.control.events;return t?Object.keys(t).map((function(e){return t[e].length})).reduce((function(t,e){return t+e}),0):0}}),created:function(){if(this.$bus.$on("cntrolClick",this.labelTextAutoFocus),document.addEventListener("keyup",this.deleteShortcurKey),this.control){var t=this.control&&this.control.customValidate;t&&t.regExp&&(t.regSource=t.regExp,delete t.regExp)}},beforeDestroy:function(){this.$bus.$off("cntrolClick"),document.removeEventListener("keyup",this.deleteShortcurKey)},data:function(){return{currentView:"attribute"}},methods:{deleteShortcurKey:function(t){46===t.which&&this.$store.state.selectedControlId&&this.removeControl()},removeControl:function(){this.$store.dispatch("deleteControl")},onNameChange:function(t){this.$store.dispatch("setControlProp",{value:t,prop:"name",control:this.control})},labelTextAutoFocus:function(){var t=this;this.$nextTick((function(){if("title"==t.control.type||"label"==t.control.type)try{t.$children.some((function(t){if(t.focus)return t.focus(),!0}))}catch(e){console.error(e)}}))},getControlValue:function(t,e){return/\./.test(e.associatedProp)?Object(It["g"])(t,e.associatedProp):t[e.associatedProp]},change:function(t,e,n){this.$store.dispatch("setControlProp",{value:t,prop:e.associatedProp,control:this.control,group:n})},getExtends:function(t){return t?t+""===t?[("extend-"+t).toLowerCase()]:t.map((function(t){return("extend-"+t).toLowerCase()})):[]},handleExtendChange:function(t,e,n){this.$store.dispatch("setControlProp",{value:t,prop:e,control:this.control,group:n})},getControlComponent:function(t){var e=t.toLowerCase();return e in Il?Il[e]:El}},watch:{"control.id":function(){this.currentView="attribute"}}},ds=us,fs=Object(Ct["a"])(ds,_o,ko,!1,null,null,null),hs=fs.exports,ps=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.rowId?n("div",{staticClass:"config-row"},[n("NameConfig",{attrs:{"component-data":t.row,type:t.rowType},on:{change:t.onNameChange,remove:t.removeRow}}),"row-layout"==t.type?n("div",{staticClass:"config-control-tabcontent"},[t._m(0)]):t._e(),"acc-layout"==t.type?n("ConfigAcc",{staticClass:"config-control-tabcontent",attrs:{"layout-data":t.row}}):t._e()],1):t._e()},ms=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"}),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("行")]),n("div",{staticClass:"form-control"})])])}],gs=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h3",{staticClass:"config-category"},[t._v("手风琴配置")]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("显示导航")]),n("div",{staticClass:"form-control"},[n("div",{staticClass:"form-control-item"},[n("el-switch",{model:{value:t.showNav,callback:function(e){t.showNav=e},expression:"showNav"}})],1)])]),n("h3",{staticClass:"config-category"},[t._v("手风琴项配置")]),n("div",{staticClass:"form-item"},t._l(t.items,(function(e,o){return n("div",{key:e.id,staticClass:"form-control-item acc",on:{click:function(n){return t.handleItemClick(e)}}},[n("span",{staticStyle:{"margin-right":"4px"}},[t._v(t._s(t._f("getOrder")(o)))]),n("span",[t._v(t._s(e.props.title))])])})),0),n("div",{staticClass:"form-item"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.editing,expression:"editing"}],staticClass:"form-control-item"},[n("el-input",{ref:"nameInput",staticStyle:{width:"160px","margin-right":"8px"},attrs:{placeholder:"请输入手风琴项标题"},model:{value:t.itemName,callback:function(e){t.itemName=e},expression:"itemName"}}),n("el-tooltip",{attrs:{"open-delay":500,content:"新增"}},[n("el-button",{staticClass:"el-icon-check",attrs:{disabled:!t.itemNameValidated},on:{click:t.addItem}})],1)],1),n("el-tooltip",{attrs:{"open-delay":500,content:"添加手风琴项"}},[n("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.editing,expression:"!editing"}],staticClass:"el-icon-plus",on:{click:t.handleAdd}})],1)],1)])},vs=[];function bs(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ys(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?bs(Object(n),!0).forEach((function(e){Object(ut["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bs(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Cs={name:"config-acc",props:["layoutData"],data:function(){var t=this.layoutData;return{showNav:t.props.showNav,itemName:"",editing:!1}},computed:{items:function(){return this.layoutData.cols},itemNameValidated:function(){return this.itemName&&this.itemName.trim()}},filters:{getOrder:function(t){var e=t+1;return e>=10?e:"0"+e}},methods:ys(ys({},Object(Tt["b"])(["activeRightTab","setSelectedCol"])),{},{submit:function(t,e){this.$store.commit({type:"setRowProps",prop:t,value:e,row:this.layoutData})},handleItemClick:function(t){var e=t.id;this.setSelectedCol({id:e}),this.activeRightTab("cell")},handleAdd:function(){var t=this;this.editing=!0,this.$nextTick((function(){t.$refs["nameInput"].focus()}))},addItem:function(){var t=this.itemName,e=this.layoutData.id,n=this.layoutData.cols.length,o={id:"col-".concat(e,"-").concat(n+1),name:t,type:"acc-item",props:{title:t,opened:!0},style:{verticalAlign:"middle",textAlign:"center",width:"100%",border:Object(It["d"])(this.$store.state.globalStyle.border)},subs:[],controls:[]};this.$store.commit({type:"addAccItem",item:o,parentRow:this.layoutData,shuttle:!0}),this.editing=!1,this.itemName=""}}),watch:{showNav:function(t){this.submit("props.showNav",t)}}},ws=Cs,xs=(n("bc87"),Object(Ct["a"])(ws,gs,vs,!1,null,null,null)),Os=xs.exports;function Ds(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=_s(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,r=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw r}}}}function _s(t,e){if(t){if("string"===typeof t)return ks(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ks(t,e):void 0}}function ks(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var Ss={name:"config-row",props:["rowId"],components:{NameConfig:Po,ConfigAcc:Os},computed:{row:function(){var t=this.rowId;return this.$store.getters.rowDataMap[t].row},rowType:function(){return this.row.namePrefix||this.row.name},type:function(){var t=this.row.type;return t||"row-layout"}},mounted:function(){document.addEventListener("keyup",this.deleteShortcurKey)},beforeDestroy:function(){document.removeEventListener("keyup",this.deleteShortcurKey)},methods:{deleteShortcurKey:function(t){46===t.which&&this.rowId&&this.removeRow()},onNameChange:function(t){this.$store.dispatch("setLayoutProp",{value:t,prop:"name"})},removeRow:function(){var t=this,e=this.isEmptyRow(this.row);return e?this.doRemoveRow():this.$confirm("此操作将移除此行，以及此行内的所有内容，是否确认？"," 删除提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.doRemoveRow()})).catch((function(){}))},doRemoveRow:function(){var t=this.$store.getters.selectedLayoutData,e=t.index,n=t.layout,o=this.$store.getters.selectedRowParentCol;-1!=e&&n?this.$store.dispatch("deleteRow",{parentCol:o,row:n,index:e}):console.error("出现错误 无法删除")},isEmptyRow:function(t){var e,n=Ds(t.cols);try{for(n.s();!(e=n.n()).done;){var o=e.value;if(o.subs.length||o.controls.length)return!1}}catch(i){n.e(i)}finally{n.f()}return!0}}},js=Ss,Ts=Object(Ct["a"])(js,ps,ms,!1,null,null,null),Is=Ts.exports,Es=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"preview-wrap"},[n("iframe",{ref:"preview",attrs:{src:t.iframeUrl,height:"100%",width:"100%",frameborder:"0"}})])},Ps=[],Ls=(/.html/.test(location.pathname),{name:"preview",props:["designId","tableGuid"],computed:{iframeUrl:function(){var t=previewUrl;return"".concat(t,"?tableGuid=").concat(this.tableGuid,"&designId=").concat(this.designId)}},mounted:function(){var t=this,e=this.$refs["preview"];this.$parent.autoSave(!0),this.$parent.getData().then((function(n){t.retry((function(){return"function"==typeof e.contentWindow.getPreviewHtml}),(function(){e.contentWindow.getPreviewHtml,e.contentWindow.getPreviewHtml(n)}))}))},methods:{retry:function(t,e){var n=this,o=0,i=function(){var i=t();if(i)e();else{if(!(o++<500))throw new Error("预览加载超时");setTimeout((function(){n.retry(t,e)}),20)}};i()}}}),As=Ls,$s=(n("07db"),Object(Ct["a"])(As,Es,Ps,!1,null,"047aa7cb",null)),Fs=$s.exports,Ms=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{width:"720px","append-to-body":"",title:"创建新字段",visible:t.dialogVisible,"show-close":!1}},[n("el-form",{ref:"form",attrs:{model:t.fieldProps,"label-width":"100px",rules:t.rules}},[n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"字段英文名",prop:"fieldname"}},[n("el-input",{model:{value:t.fieldProps.fieldname,callback:function(e){t.$set(t.fieldProps,"fieldname",e)},expression:"fieldProps.fieldname"}})],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"字段中文名",prop:"name"}},[n("el-input",{model:{value:t.fieldProps.name,callback:function(e){t.$set(t.fieldProps,"name",e)},expression:"fieldProps.name"}})],1)],1)],1),n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"字段类型",prop:"dbtype"}},[n("el-select",{staticStyle:{width:"100%"},on:{change:t.onDBTypeChange},model:{value:t.fieldProps.dbtype,callback:function(e){t.$set(t.fieldProps,"dbtype",e)},expression:"fieldProps.dbtype"}},t._l(t.DBDataTypes,(function(e){return n("el-option",{key:e.id,attrs:{value:e.id,label:e.text}},[t._v(t._s(e.text))])})),1)],1)],1),t.showLength?n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"字段长度"}},[n("el-input-number",{staticStyle:{width:"100%"},attrs:{controls:!1},model:{value:t.fieldProps.length,callback:function(e){t.$set(t.fieldProps,"length",e)},expression:"fieldProps.length"}})],1)],1):t._e()],1),t.showPrecision?n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"字段精度"}},[n("el-input-number",{staticStyle:{width:"100%"},attrs:{controls:!1},model:{value:t.fieldProps.precision,callback:function(e){t.$set(t.fieldProps,"precision",e)},expression:"fieldProps.precision"}})],1)],1)],1):t._e(),n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"显示类型",prop:"fielddisplaytype"}},[n("el-select",{staticStyle:{width:"100%"},model:{value:t.fieldProps.fielddisplaytype,callback:function(e){t.$set(t.fieldProps,"fielddisplaytype",e)},expression:"fieldProps.fielddisplaytype"}},t._l(t.displayTypeList,(function(e){return n("el-option",{key:e.id,attrs:{value:e.id,label:e.text}},[t._v(t._s(e.text))])})),1)],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"代码项"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{clearable:""},model:{value:t.fieldProps.datasource,callback:function(e){t.$set(t.fieldProps,"datasource",e)},expression:"fieldProps.datasource"}},t._l(t.codeList,(function(e){return n("el-option",{key:e.text,attrs:{value:e.id,label:e.text}},[t._v(t._s(e.text))])})),1)],1)],1)],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary",loading:t.inSave},on:{click:function(e){return t.create()}}},[t._v("创建")]),n("el-button",{attrs:{type:"primary",loading:t.inSave},on:{click:function(e){return t.create(!0)}}},[t._v("创建并绑定")])],1)],1)},Ns=[];function Rs(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Vs(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Rs(Object(n),!0).forEach((function(e){Object(ut["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Rs(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var zs={computed:Vs(Vs({},Object(Tt["e"])(["DBDataTypes","codeList","newFieldList","fieldList"])),{},{allFiledList:function(){var t=this.fieldList.length?this.fieldList[0].fields:[];return[].concat(Object(ct["a"])(t),Object(ct["a"])(this.newFieldList))},showPrecision:function(){return"Numeric"==this.fieldProps.dbtype},showLength:function(){return"nvarchar"==this.fieldProps.dbtype||"Numeric"==this.fieldProps.dbtype},displayTypeList:function(){var t=window.FORM_DESIGN_CONFIG.controlList,e=this.$store.state.extControls,n=[];return t.forEach((function(t){n.push({id:t.type,text:t.name})})),e.forEach((function(t){n.push({id:t.type,text:t.name})})),n}}),data:function(){var t=this;return{fieldProps:{fieldname:"",name:"",dbtype:"",length:18,precision:2,fielddisplaytype:"",datasource:"",fieldtype:""},displayTypeLoading:!1,dialogVisible:!1,inSave:!1,rules:{fieldname:[{required:!0,message:"字段英文名必填",trigger:"blur"},{validator:function(e,n,o){if(!/^[a-zA-Z][\da-zA-Z_]*$/.test(n))return o(new Error("仅能是字母开头加数字、字母、下划线的组合"));var i=t.allFiledList.some((function(t){return t.fieldname==n}));return i?o(new Error("字段英文名必须唯一")):o()},trigger:"blur"}],name:[{required:!0,message:"字段中文名必填",trigger:"blur"}],dbtype:[{required:!0,message:"字段类型必填",trigger:"blur"}],fielddisplaytype:[{required:!0,message:"显示类型必填",trigger:"blur"}]},autoBindFn:function(){}}},mounted:function(){this.init()},methods:{init:function(){var t=this;this.$bus.$on("createBindField",(function(e){t.dialogVisible=!0,t.autoBindFn=e,t.autoFillDisplayType()}))},setInitData:function(){this.fieldProps={fieldname:"",name:"",dbtype:"",length:18,precision:2,fielddisplaytype:"",datasource:"",fieldtype:""}},autoFillDisplayType:function(){var t=this.$store.getters.selectedControl.control;this.fieldProps.fielddisplaytype=t?t.type:""},create:function(t){var e=this;this.inSave=!0,this.$refs.form.validate((function(n){n?(e.save(t),e.$message({message:"新增成功，字段将在保存表单时进行创建",type:"success"}),e.setInitData(),e.inSave=!1,e.dialogVisible=!1):(e.$message({message:"字段信息不完整，请检查",type:"error"}),e.inSave=!1)}))},save:function(t){var e=Object(It["d"])(this.fieldProps);this.showLength||delete e.length,this.showPrecision||delete e.precision,this.$store.commit({type:"addToNewFieldList",fieldProps:e}),t&&this.autoBindFn(e)},onDBTypeChange:function(){var t=this.fieldProps.dbtype;"Numeric"==t?(this.fieldProps.fieldtype="1",this.fieldProps.length=18):"Integer"==t?this.fieldProps.fieldtype="2":(this.fieldProps.fieldtype="0","nvarchar"==t&&(this.fieldProps.length=50))},adaptDisplayType:function(){if(this.fieldProps.fielddisplaytype){var t=this.fieldProps.fielddisplaytype,e=this.displayTypeList.some((function(e){return e.id==t}));e||(this.fieldProps.fielddisplaytype="")}}}},Bs=zs,Us=Object(Ct["a"])(Bs,Ms,Ns,!1,null,null,null),Gs=Us.exports,Hs=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.list.length?n("div",{staticClass:"row-container"},[t._l(t.list,(function(e,o){return n("RowGender",{key:e.id,attrs:{level:t.level,row:e,index:o,"parent-col":t.parentCol,"is-last-row":o==t.list.length-1,"prev-row":0==o?null:t.list[o-1]}})})),0===t.level?n("div",{staticClass:"hidden-area",staticStyle:{display:"none"}},t._l(t.hiddenControls,(function(t){return n("ControlGender",{key:t.id,attrs:{"control-data":t}})})),1):t._e()],2):t._e()},qs=[],Ws=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"row",class:t.className,style:t.style,attrs:{"row-id":t.row.id,"data-name":t.row.name,"data-level":t.level}},t._l(t.row.cols,(function(e,o){return n("ColGender",{key:e.id,attrs:{"is-last-row":t.isLastRow,index:o,col:e,row:t.row,level:t.level,"row-index":t.index}})})),1)},Js=[],Ys=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"col",class:t.getColCls(t.col,t.index,t.row.cols.length),style:t.colStyle,attrs:{id:t.col.id,role:"acc-item"==t.col.type?"accordion":""}},["acc-item"==t.type?n("div",{attrs:{role:"head",title:t.col.props.title,opened:t.col.props.opened?"true":"false"}}):t._e(),"acc-item"==t.type?n("div",{attrs:{role:"body"}},[n("LayoutGender",{attrs:{list:t.col.subs,level:t.levelNext,parentCol:t.col,parentRow:t.row}}),t._l(t.col.controls,(function(t){return n("ControlGender",{key:t.id,attrs:{"control-data":t}})}))],2):t._e(),"acc-item"!=t.type?n("LayoutGender",{attrs:{list:t.col.subs,level:t.levelNext,parentCol:t.col,parentRow:t.row}}):t._e(),t._l(t.col.controls,(function(e){return"acc-item"!=t.type?n("ControlGender",{key:e.id,attrs:{"control-data":e}}):t._e()}))],2)},Xs=[],Ks=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(t.getControl(t.controlData.type),{tag:"component",attrs:{id:t.controlData.id,"control-data":t.controlData,asControl:!0}})},Qs=[],Zs=n("d718"),tc=n("9e0a"),ec={label:Zs["a"],title:tc["a"]},nc={inheritAttrs:!1,props:["id"],template:'<span class="design-control-holder" :id="id"></span>'},oc={props:["control-data"],methods:{getControl:function(t){return t in ec?ec[t]:nc}}},ic=oc,rc=Object(Ct["a"])(ic,Ks,Qs,!1,null,null,null),ac=rc.exports;function lc(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function sc(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?lc(Object(n),!0).forEach((function(e){Object(ut["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lc(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var cc={name:"ColLayout",components:{ControlGender:ac},data:function(){return{}},props:{row:{type:Object,required:!0},rowIndex:{type:Number,required:!0},col:{type:Object,required:!0},index:{type:Number,required:!0},level:{type:Number,required:!0},isLastRow:{type:Boolean,required:!0}},computed:sc(sc({},Object(Tt["e"])(["globalStyle"])),{},{type:function(){var t=this.col;return t&&t.type?t.type:"col-item"},levelNext:function(){return this.level+1},colStyle:function(){var t=this.col.style.width,e=t+""===t?t:"".concat(t,"px");return{width:e}}}),methods:{getColCls:function(t,e,n){var o,i=this.globalStyle,r=t.subs.length,a=t.style,l=(o={isSub:!r,hasSub:r},Object(ut["a"])(o,"text-"+(a.textAlign||i.textAlign),!0),Object(ut["a"])(o,"vertical-"+(a.verticalAlign||i.verticalAlign),!0),o);return l[this.type]=!0,"col-item"==this.type&&(l.first=0===e,l.mid=e&&e!==n-1,l.last=e===n-1),l}}},uc=cc,dc=Object(Ct["a"])(uc,Ys,Xs,!1,null,null,null),fc=dc.exports,hc={name:"row-gender",components:{ColGender:fc},props:{row:{type:Object},index:{type:Number},level:{type:Number},parentCol:{type:Object,default:null},isLastRow:{type:Boolean},prevRow:{type:Object,default:null}},computed:{type:function(){var t=this.row;return t&&t.type?t.type:"row-layout"},style:function(){var t=this.row.height,e=t+""===t?t:t+"px",n={};return"acc-layout"==this.type&&(n.marginTop="16px",n.marginBottom="16px"),"row-layout"==this.type&&(n["min-height"]=e),n},className:function(){var t,e=this.type,n=(t={},Object(ut["a"])(t,e,!0),Object(ut["a"])(t,"isTop",0==this.level),t);return"acc-layout"==e?(n["fui-accordions"]=!0,n):(0===this.index||this.prevRow&&this.prevRow.type&&"row-layout"!=this.prevRow.type?n.first=!0:n.mid=!0,n)}}},pc=hc,mc=Object(Ct["a"])(pc,Ws,Js,!1,null,null,null),gc=mc.exports,vc={name:"LayoutGender",components:{RowGender:gc,ControlGender:ac},props:{list:{type:Array,default:function(){return[]}},level:{type:Number,default:0},parentCol:{type:Object,default:null},parentRow:{type:Object,default:null}},computed:{hiddenControls:function(){return this.$store.state.hiddenControls}},methods:{getHtmlContent:function(){var t=this;return new Promise((function(e,n){t.$nextTick((function(){e(t.$el.innerHTML)}))}))}}},bc=vc,yc=Object(Ct["a"])(bc,Hs,qs,!1,null,null,null),Cc=yc.exports,wc=n("4be7"),xc=n("9827"),Oc=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"design-head"},[n("span",{staticClass:"design-tittle"},[t._v(t._s(t.formTitle))]),n("Shuttle",{directives:[{name:"show",rawName:"v-show",value:!t.showPreview,expression:"!showPreview"}],ref:"shuttle",staticClass:"header-btn-group"}),n("span",{directives:[{name:"show",rawName:"v-show",value:!t.showPreview,expression:"!showPreview"}],staticClass:"header-btn-group"},[n("span",{staticClass:"header-btn js-btn",attrs:{type:"text",size:"mini",title:"打开js编辑"},on:{click:function(e){return t.openEditor("js")}}}),n("span",{staticClass:"header-btn css-btn",attrs:{type:"text",size:"mini",title:"打开css编辑"},on:{click:function(e){return t.openEditor("css")}}}),n("span",{staticClass:"header-btn view-design-btn",class:{active:!0===t.viewDesign},attrs:{title:t.viewDesign?"切换为真实模式":"切换为设计模式",size:"mini",type:"text"},on:{click:t.toggleViewDesign}}),n("span",{staticClass:"header-btn design-select-btn",attrs:{title:"重新选择表单",size:"mini",type:"text"},on:{click:t.showDesignSelect}})]),n("div",{staticClass:"design-head-right",staticStyle:{float:"right"}},[n("el-button",{staticClass:"preview-btn",attrs:{size:"mini"},on:{click:function(e){return t.setShowPreview(!t.showPreview)}}},[t._v(t._s(t.showPreview?"退出预览":"预览"))]),t.load?n("el-dropdown",{staticStyle:{"margin-left":"10px"},attrs:{"split-button":"",type:"primary",trigger:"click",size:"mini"},on:{click:t.onSaveClick,command:t.onDropDownItemClick}},[t._v("\n      保存\n      "),n("el-dropdown-menu",{staticClass:"save-menu",attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"saveToTpl"}},[t._v("另存为模板")]),n("el-dropdown-item",{attrs:{command:"saveToNewVersion"}},[t._v("生成新版本")]),n("el-dropdown-item",{attrs:{command:"saveToCopy"}},[t._v("生成副本")])],1)],1):t._e(),t.load?t._e():n("el-dropdown",{staticClass:"split-disabled",staticStyle:{"margin-left":"10px"},attrs:{"split-button":"",type:"primary",size:"mini"}},[t._v("\n      保存\n    ")])],1),n("el-dialog",{attrs:{"append-to-body":"",title:t.editorDialog.title,visible:t.editorDialog.show,width:"90","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!0,fullscreen:"","custom-class":"code-editor-dialog","before-close":t.closeEditorDialog},on:{"update:visible":function(e){return t.$set(t.editorDialog,"show",e)},opened:t.onEditorDialogOpened}},[t.editorDialog.display?n("Editor",{attrs:{code:t.editorDialog.code,language:t.editorDialog.lang},on:{save:t.saveEditorCode,cancel:t.closeEditorDialog}}):t._e()],1),n("el-dialog",{attrs:{"append-to-body":"",title:"选择表单",visible:t.dialogVisible,width:"50%","custom-class":"select-form","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("iframe",{attrs:{src:t.reSetSelectUrl,width:"100%",height:"100%",frameborder:"0"}})])],1)},Dc=[],_c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"form-shuttle-btns"},[n("el-tooltip",{attrs:{"open-delay":200,content:t.canUndo?"撤销":"无可撤销的操作"}},[n("span",{staticClass:"header-btn form-icon-undo",class:{disabled:!t.canUndo},on:{click:t.undo}})]),n("el-tooltip",{attrs:{"open-delay":200,content:t.canRedo?"还原":"无可还原的操作"}},[n("span",{staticClass:"header-btn form-icon-redo",class:{disabled:!t.canRedo},on:{click:t.redo}})])],1)},kc=[],Sc=null,jc=function(t){var e={};return t.forEach((function(t){e[t]=!0})),e}(["activeRightTab","updateLineTop","updateLineLeft","showHLine","hideHLine","showVLine","hideVLine","layoutDragStart","layoutDragEnd","controlDragStart","controlDragEnd","toggleViewDesign","updateViewType","setJsCode","setCssCode","addToNewFieldList"]),Tc=function(t){var e={};return t.forEach((function(t){e[t]=!0})),e}(["updateRowHeight","updateColWidth"]),Ic={name:"shuttle",data:function(){return{history:[],future:[]}},mounted:function(){document.addEventListener("keyup",this.initShortcutKey)},beforeDestroy:function(){document.removeEventListener("keyup",this.initShortcutKey)},computed:{canUndo:function(){return this.history.length},canRedo:function(){return this.future.length}},methods:{init:function(){window.shuttleManager=this,this.subscribeStore()},subscribeStore:function(){var t=this;Sc=JSON.stringify(this.$store.state);var e=function(e,n){var o=e.type;e.payload&&e.payload.shuttle&&t.storeState(o,Sc,e.payload.group),Sc=JSON.stringify(n)},n=Zt()(e,300,{leading:!0,trailing:!1});this.$store.subscribe((function(t,o){var i=t.type;jc[i]||(Tc[i]?n(t,o):e(t,o))}))},addHistory:function(t){if(t.group){for(var e=-1,n=0,o=this.history.length;n<o;n++){if(this.history[n].group!=t.group)break;e=n}-1===e&&this.history.unshift(t)}else this.history.unshift(t);this.history.length>10&&(this.history.length=10)},addFuture:function(t){this.future.unshift(t),this.future.length>10&&(this.future.length=10)},storeState:function(t,e,n){var o={name:t,state:e,group:n};this.addHistory(o),this.future=[]},undo:function(){if(this.canUndo){var t={name:"undo",state:JSON.stringify(this.$store.state)};this.addFuture(t);var e=this.history.shift();this.shuttle(e.state),Sc=JSON.stringify(this.$store.state)}},redo:function(){if(this.canRedo){var t={name:"undo",state:JSON.stringify(this.$store.state)};this.addHistory(t);var e=this.future.shift();this.shuttle(e.state),Sc=JSON.stringify(this.$store.state)}},shuttle:function(t){var e=JSON.parse(t);e.helper.showVLine=!1,e.helper.showHLine=!1,e.helper.inControlDragging=!1,e.helper.inLayoutDragging=!1,e.leftActiveTab=this.$store.state.leftActiveTab,e.rightActiveTab=this.$store.state.rightActiveTab,this.$store.replaceState(e)},initShortcutKey:function(t){t.ctrlKey&&90==t.which?this.undo():t.ctrlKey&&89==t.which&&this.redo()}}},Ec=Ic,Pc=(n("aeeb"),Object(Ct["a"])(Ec,_c,kc,!1,null,null,null)),Lc=Pc.exports,Ac=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"editor-wrap"},[n("div",{staticClass:"editor-toolbar"},[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.handleDialogClose("save")}}},[t._v("保存")]),n("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.handleDialogClose("cancel")}}},[t._v("取 消")]),n("el-tooltip",{attrs:{"open-delay":200,content:"格式化"}},[n("el-button",{attrs:{size:"mini",icon:"el-icon-s-grid"},on:{click:t.format}})],1),n("el-tooltip",{attrs:{"open-delay":200,content:"搜索替换"}},[n("el-button",{attrs:{size:"mini",icon:"el-icon-search"},on:{click:t.search}})],1)],1),n("div",{staticClass:"editor-main"},[n("div",{ref:"editorEl",staticClass:"editor-el",class:{"with-right":"javascript"==t.language}}),"javascript"==t.language?n("div",{staticClass:"editor-right"},[n("div",{staticClass:"editor-right-search"},[n("el-input",{attrs:{placeholder:"输入关键词进行过滤"},model:{value:t.searchInputValue,callback:function(e){t.searchInputValue=e},expression:"searchInputValue"}},[n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),n("Accordion",{attrs:{title:"控件"}},[t.filteredControlList.length?n("ul",{staticClass:"control-list"},t._l(t.filteredControlList,(function(e){return n("li",{key:e.id,on:{click:function(n){return t.addControl(e.id)}}},[t._v(t._s(e.name))])})),0):n("div",{staticClass:"control-list empty"},[t._v("无匹配控件")])]),n("Accordion",{attrs:{title:"常用值"}},[n("ul",{staticClass:"control-list"},t._l(t.valueList,(function(e){return n("li",{key:e.id,on:{click:function(n){return t.addValue(e.id)}}},[t._v(t._s(e.text))])})),0)])],1):t._e()])])},$c=[],Fc=(n("3b2b"),"./monaco-editor/vs");function Mc(){if(window.__MONACO_PROMISE__)return window.__MONACO_PROMISE__;var t="\n    require.config({\n      paths: {\n        'vs': '".concat(Fc,"'\n      }\n    });\n    require.config({\n      'vs/nls' : {\n        availableLanguages: {\n          '*': 'zh-cn'\n        }\n      }\n    });\n    require(['vs/editor/editor.main'], function () {\n      window.__monaco_editor__ = monaco;\n    });\n  "),e=new Promise((function(t,e){var n=document.createElement("script");n.id="monaco-editor-loader",n.src=Fc+"/loader.js",n.onload=function(){n.onload=null,t("loader")},n.onerror=function(){n.onerror=null,e("monaco-editor资源加载失败")},document.body.appendChild(n)})).then((function(){return new Promise((function(e,n){var o=document.createElement("script");o.text=t,o.onerror=function(){o.onerror=null,n("monaco-editor资源加载失败")},document.body.appendChild(o),e("editor")}))})).then((function(){return new Promise((function(t,e){var n,o=0;function i(){window.__monaco_editor__?(clearTimeout(n),t(window.__monaco_editor__)):o++<1e3?setTimeout(i,30):e("monaco-editor资源加载失败")}i()}))}));return window.__MONACO_PROMISE__=e}function Nc(t,e,n){var o;return e=e||17,function(){var i=arguments,r=n||this;clearTimeout(o),o=setTimeout((function(){t.apply(r,i)}),e)}}var Rc={name:"Editor",components:{Accordion:Gt},props:{language:{type:String,default:"javascript",validator:function(t){return-1!==["javascript","css"].indexOf(t)}},code:{type:String,default:["function x() {",'    console.log("Hello world!");',"}",""].join("\n")}},data:function(){var t={defaultCode:{javascript:["function myScriptFn() {","\t/* todo something */\n\t","}",""].join("\n"),css:"/* 在下面加入您的 css  */ \n"},editor:null,searchInputValue:""};return t.codeText=this.code||t.defaultCode[this.language],t},computed:{valueList:function(){return Object(It["d"])(window.FORM_DESIGN_CONFIG.preset["epointsform.specificValues"])},controlList:function(){var t=this.$store.state.hiddenControls,e=this.$store.getters.allControls,n=[];return t.forEach((function(t){n.push({id:t.id,name:t.name||t.namePrefix+"_"+t.autoIndex})})),e.forEach((function(t){n.push({id:t.id,name:t.name||t.namePrefix+"_"+t.autoIndex})})),n},filteredControlList:function(){var t=this.controlList,e=this.searchInputValue;if(!e)return t;var n=new RegExp(e,"i");return t.filter((function(t){return n.test(t.name)}))}},mounted:function(){var t=this;"javascript"!=this.language?this.initEditor(this.codeText):this.loadTypes().then((function(){t.initEditor(t.codeText)}))},beforeDestroy:function(){window.removeEventListener("resize",this.adaptLayout),this.editor&&this.editor.dispose()},methods:{handleDialogClose:function(t){this.$emit(t,this.editor.getValue())},_adaptLayout:function(){this.editor&&this.editor.layout()},search:function(){this.editor._actions["actions.find"].run()},format:function(){this.editor._actions["editor.action.formatDocument"].run()},addControl:function(t){var e="mini.get('".concat(t,"').");this.insertText(e),this.editor._actions["editor.action.triggerSuggest"].run()},addValue:function(t){this.insertText(t)},insertText:function(t){var e=this.editor.getPosition();this.editor.executeEdits("",[{range:{startLineNumber:e.lineNumber,startColumn:e.column,endLineNumber:e.lineNumber,endColumn:e.column},text:t}]);var n=this.editor.getSelection();n.selectionStartColumn=n.startColumn=n.endColumn,n.selectionStartLineNumber=n.startLineNumber=n.endLineNumber,this.editor.setSelection(n),this.editor.focus()},initEditor:function(t){var e=this;this.adaptLayout=Nc(this._adaptLayout,200),window.addEventListener("resize",this.adaptLayout),Mc().then((function(n){window.__meditor=e.editor=n.editor.create(e.$refs.editorEl,{value:t||"",language:e.language,lineHeight:26,autoIndent:!0,formatOnPaste:!0,lineNumbers:"on",minimap:!0,tabCompletion:"on",quickSuggestions:{comments:!0},snippetSuggestions:"top",accessibilitySupport:"on",suggest:{}}),e.editor.focus()}))},loadTypes:function(){var t=this,e={"content-type":"text/plain; charset=UTF-8"};return Mc().then((function(n){return t.$httpGet("./types/mini-snippets.json",!0,e).then((function(t){var e=JSON.parse(t);e.forEach((function(t){t.kind=n.languages.CompletionItemKind.Function,t.detail=t.documentation})),n.languages.registerCompletionItemProvider("javascript",{provideCompletionItems:function(){return{suggestions:e}}})})).then((function(){t.$httpGet("./types/jquery.d.ts",!0,e).then((function(t){n.languages.typescript.javascriptDefaults.addExtraLib(t,"jquery.d.ts")})),t.$httpGet("./types/miniui.d.ts",!0,e).then((function(t){n.languages.typescript.javascriptDefaults.addExtraLib(t,"miniui.d.ts")})),t.$httpGet("./types/epoint.d.ts",!0,e).then((function(t){n.languages.typescript.javascriptDefaults.addExtraLib(t,"epoint.d.ts")}))}))}))}}},Vc=Rc,zc=(n("58d3"),Object(Ct["a"])(Vc,Ac,$c,!1,null,null,null)),Bc=zc.exports,Uc=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",[n("span",{staticStyle:{color:"#666","margin-right":"6px","font-size":"14px"}},[t._v("模板选择")]),n("el-select",{attrs:{size:"mini"},on:{change:t.handleTplSelect},model:{value:t.currentTpl,callback:function(e){t.currentTpl=e},expression:"currentTpl"}},t._l(t.list,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1)},Gc=[],Hc={name:"form-tpl-select",data:function(){return{currentTpl:"",list:[]}},computed:{currentTplData:function(){var t=this,e=this.list.filter((function(e){return e.id===t.currentTpl}))[0];return e?e.data:null}},mounted:function(){this.getData()},methods:{getData:function(){var t=this;this.$httpPost(window.formDesignerActions.getAllFormTplUrl).then((function(e){var n=e.list;Array.isArray(n)&&(t.list=n)}))},handleTplSelect:function(t){var e=this;this.currentTplData,this.currentTplData||console.error();var n=Object(It["d"])(this.currentTplData);this.$confirm("使用模板将完全替换当前设计器内容，是否继续？","确认信息",{}).then((function(){e.$emit("change",n)})).catch((function(){e.currentTpl=""}))}}},qc=Hc,Wc=Object(Ct["a"])(qc,Uc,Gc,!1,null,null,null),Jc=Wc.exports;function Yc(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Xc(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Yc(Object(n),!0).forEach((function(e){Object(ut["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Yc(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Kc={name:"Header",props:{formTitle:{type:String},inPreview:{type:Boolean},load:{type:Boolean}},components:{Shuttle:Lc,Editor:Bc,FormTplSelect:Jc},data:function(){return{showLocalBtns:!1,dialogVisible:!1,reSetSelectUrl:reSetSelectUrl,editorDialog:{title:"",show:!1,code:"",display:!1,lang:""}}},computed:Xc(Xc({},Object(Tt["e"])(["jsCode","cssCode"])),Object(Tt["e"])({viewType:function(t){return t.helper.viewType},viewDesign:function(t){return t.helper.viewDesign},showPreview:function(t){return t.helper.showPreview}})),methods:Xc(Xc({},Object(Tt["d"])(["setJsCode","setCssCode","updateViewType","toggleViewDesign"])),{},{setShowPreview:function(t){this.$store.commit({type:"setShowPreview",showPreview:t})},handleClose:function(){this.dialogVisible=!1},showDesignSelect:function(){this.dialogVisible=!0},openEditor:function(t){var e,n,o;"js"==t?(e=this.jsCode,n="js编辑",o="javascript"):(e=this.cssCode,n="css编辑",o="css"),this.editorDialog.title=n,this.editorDialog.code=e,this.editorDialog.lang=o,this.editorDialog.show=!0},onEditorDialogOpened:function(){this.editorDialog.display=!0},saveEditorCode:function(t){"javascript"==this.editorDialog.lang?this.setJsCode(t):"css"==this.editorDialog.lang&&this.setCssCode(t),this._closeEditorDialog()},_closeEditorDialog:function(){this.editorDialog.display=this.editorDialog.show=!1},closeEditorDialog:function(){var t=this;this.$confirm("不需要保存此次的代码修改吗？","保存提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t._closeEditorDialog()})).catch((function(t){console.error(t)}))},onFormTplChange:function(t){this.$emit("form-tpl-change",t)},onSaveClick:function(){var t=this,e=this.$store.state.design&&this.$store.state.design.length;e?this.$emit("save-click"):this.$confirm("无设计数据，继续保存将提交空数据是否继续？","删除保存",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$emit("save-click")})).catch((function(t){t&&console.error(t)}))},onDropDownItemClick:function(t){this.$emit("drop-item-click",t)}})},Qc=Kc,Zc=(n("c0a5"),n("20fd"),Object(Ct["a"])(Qc,Oc,Dc,!1,null,null,null)),tu=Zc.exports,eu=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{title:"生成新版本",visible:!0,"custom-class":"new-version-dialog",width:"420px",top:"calc(50vh - 100px)","show-close":!1}},[n("p",{staticStyle:{margin:"0"}},[t._v("在一个新版本中编辑表单，原版本将被保留")]),n("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules}},[n("el-form-item",{attrs:{label:"选择模板结构",prop:"tplId"}},[n("el-select",{attrs:{size:"mini"},model:{value:t.form.tplId,callback:function(e){t.$set(t.form,"tplId",e)},expression:"form.tplId"}},t._l(t.list,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:t.cancel}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v("确 定")])],1)],1)},nu=[],ou={props:["visible"],data:function(){return{form:{tplId:""},list:[],rules:{tplId:[{required:!0,message:"必须选择模板",trigger:"blur"}]}}},mounted:function(){this.getData()},methods:{getData:function(){var t=this;this.$httpPost(window.formDesignerActions.getSFormTplUrl).then((function(e){var n=e.list;Array.isArray(n)&&(t.list=n)}))},confirm:function(){var t=this;this.$refs.form.validate((function(e){e&&t.save(t.form.tplId).then((function(){t.cancel()}))}))},cancel:function(){document.body.removeChild(this.$el),this.$destroy()}}},iu=ou,ru=(n("caff"),Object(Ct["a"])(iu,eu,nu,!1,null,null,null)),au=ru.exports;function lu(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function su(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?lu(Object(n),!0).forEach((function(e){Object(ut["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lu(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var cu=it["default"].extend(au),uu=new URLSearchParams(location.search),du=uu.get("designId")||"",fu=uu.get("tableGuid")||"",hu={name:"app-main",components:{Header:tu,Preview:Fs,Tabs:kt,TabPanel:xt,PanelLayout:Ft,PanelShare:de,Design:Se,MobileDesign:rn,ConfigCell:no,ConfigForm:Do,PanelControl:Yt,ConfigControl:hs,ConfigRow:Is,LayoutGender:Cc,NewFiledDialog:Gs},data:function(){return{autoSaveTimer:null,autoSaveInterval:6e4,needAutoSave:!1,dataLoaded:!1,formTitle:"表单设计器",needRender:!1,showLocalBtns:/useMock/i.test(location.search),enableRightBarCover:!0,narrowMode:!1,rightbarHidden:!1,designId:du,tableGuid:fu}},computed:su(su(su(su({},Object(Tt["e"])(["leftActiveTab","rightActiveTab","formSize","selectedColId","hiddenControls","selectedRowId","jsCode","cssCode","newFieldList","mobileDesignData"])),Object(Tt["e"])({viewDesign:function(t){return t.helper.viewDesign},viewType:function(t){return t.helper.viewType},showPreview:function(t){return t.helper.showPreview}})),Object(Tt["c"])(["codeListMap","selectedCol"])),{},{selectedControl:function(){var t=this.$store.state.selectedControlId;if(t){var e=this.$store.getters.controlDataMap[t];if(e&&e.control)return e.control}return null},cellPanelName:function(){return this.selectedColId&&this.selectedCol&&"acc-item"==this.selectedCol.type?"手风琴项":"单元格"},globalStyle:{get:function(){return this.$store.state.globalStyle},set:function(t){this.$store.commit("updateGlobalStyle",{style:t})}},design:{get:function(){return this.$store.state.design},set:function(t){this.$store.commit("updateDesign",t)}}}),mounted:function(){var t=this,e=this;window.FORM_DESIGNER.save=function(t){return e.saveToServer(t)},this.enableRightBarCover&&(this.calcWidth(),window.addEventListener("resize",this.calcWidth)),wc["Promise"].all([this.$httpPost(window.formDesignerActions.getUrl,{designId:du,tableGuid:fu}),this.$httpPost(window.formDesignerActions.getCodeItemUrl,{designId:du,tableGuid:fu})]).then((function(e){var n=e[0],o=e[1].codeMain,i=n.extControls,r=n.fieldList,a=n.designData,l=n.macroTypes,s=n.sourceTables,c=n.dataTables,u=n.dataType,d=n.commonFields;if(Array.isArray(d)&&t.setCommonControls(d),r&&r.length&&(r.forEach((function(t){t.fields.forEach((function(t){t.required=1==parseInt(t.required,10),t.fieldtype=parseInt(t.fieldtype,10)}))})),t.setFieldList(r)),n.name&&(t.formTitle=n.name,document.title=t.formTitle),o&&o.length&&t.setCodeList(o),l&&l.length&&t.setMacroTypes(l),i&&i.length&&t.setExtControls(i),s&&s.length&&t.setSourceTables(s),c&&c.length&&t.setDataTables(c),n.jsCode&&t.setJsCode(Object(It["e"])(n.jsCode)),n.cssCode&&t.setCssCode(Object(It["e"])(n.cssCode)),u&&t.setDBDataTypes(u),a){a.globalStyle&&(t.globalStyle=a.globalStyle),a.design&&(t.design=a.design),a.mobileDesignData&&t.$store.commit({type:"replaceMobileDesign",mobileDesignData:a.mobileDesignData}),a.hiddenControls&&t.$store.commit("setHiddenControls",a.hiddenControls),a.skin&&t.$store.commit("setSkin",{skinName:a.skin}),xc["c"].control.adapt(t.$store.getters.allControls),xc["c"].control.adapt(t.$store.state.hiddenControls),xc["c"].col.adapt(t.design),It["l"].adapt(t.$store.getters.allRows,(function(t){return t.id})),t.dataLoaded=!0;var f=parseInt(n.autoSaveTime,10);f&&(t.autoSaveInterval=f),t.$nextTick((function(){t.$refs.header.$refs.shuttle.init()})),t.subscribeStore(),t.doAutoSave(),t.checkFields(n)}})).catch((function(t){console.error(t)})),this.$httpPost(window.formDesignerActions.getListInfoUrl,{designId:du,tableGuid:fu}).then((function(e){var n=e.SformListInfo;Array.isArray(n)&&t.$store.commit("setButtonEditPopupList",n)})).catch((function(t){console.error(t)}))},methods:su(su(su({},Object(Tt["d"])(["activeLeftTab","setFieldList","setCodeList","setMacroTypes","setExtControls","setSourceTables","setDataTables","setJsCode","setCssCode","setDBDataTypes","setCommonControls"])),Object(Tt["b"])(["activeRightTab"])),{},{calcWidth:Zt()((function(){this.narrowMode=window.innerWidth<1610}),20,{leading:!0,trailing:!0}),checkFields:function(t){var e=this;t.msg?t.fields&&t.fields.length&&(e.clearHighlight(),this.$message({showClose:!0,message:t.msg,type:"warning",duration:0}),t.fields.forEach((function(t){e.$store.commit("highlightDesignField",{id:t.controlId,tableId:t.tableId})}))):this.clearHighlight()},clearHighlight:function(){this.$message.closeAll(),this.$store.commit("clearAllHighlightField")},clear:function(){this.design=[]},preview:function(){var t=this;return this.getData().then((function(e){var n=e.build,o='\n      <!DOCTYPE html>\n      <html lang="en">\n      <head>\n          <meta charset="UTF-8">\n          <meta name="viewport" content="width=device-width, initial-scale=1.0">\n          <meta http-equiv="X-UA-Compatible" content="ie=edge">\n          <title>Document</title>\n          <style>html,body{margin:0;padding:0;}.container{margin:0 auto;}</style>\n          <style>.row{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap}.col{position:relative;-webkit-box-sizing:border-box;box-sizing:border-box;box-sizing:border-box;min-height:30px;padding:6px;line-height:30px;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0}.col.hasSub{padding:0}.col>*{position:relative;z-index:1}.col:after{position:absolute;z-index:0;top:0;right:0;bottom:0;left:0;display:block;-webkit-box-sizing:border-box;box-sizing:border-box;content:"";background:transparent}.col.hasSub:after{border-top-width:0 !important;border-right-width:0 !important;border-bottom-width:0 !important;border-left-width:0 !important}.col.mid:after{border-left-width:0 !important}.col.mid>.row>.col.first:after,.col.mid>.row-container>.row>.col.first:after,.col.last>.row>.col.first:after,.col.last>.row-container>.row>.col.first:after{border-left-width:0 !important}.col.mid ~ .col.last:after,.col.first ~ .col.last:after{border-left-width:0 !important}.row.mid>.col:after{border-top-width:0 !important}.row.mid>.col>.row>.col:after,.row.mid>.col>.dropArea>.row>.col:after{border-top-width:0 !important}.col{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}.col.text-left{text-align:left}.col.text-center{text-align:center}.col.text-right{text-align:right}.col.vertical-top{vertical-align:top}.col.vertical-middle{vertical-align:middle}.col.vertical-bottom{vertical-align:bottom}.col.text-left{-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start}.col.text-center{-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.col.text-right{-webkit-box-align:end;-webkit-align-items:flex-end;-ms-flex-align:end;align-items:flex-end}.col.vertical-top{-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start}.col.vertical-middle{-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center}.col.vertical-bottom{-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end}.design-form-title,.design-form-label{position:relative;display:block;-webkit-box-sizing:border-box;box-sizing:border-box;width:100%}.design-form-label{padding-right:8px}.design-form-label.required:after{position:absolute;top:50%;right:-2px;display:block;width:8px;height:16px;margin-top:-8px;font-size:16px;line-height:16px;content:"*";color:red}.mini-textbox-readOnly .mini-textbox-border,.mini-textbox-readOnly .mini-textbox-input,.mini-buttonedit-readOnly .mini-buttonedit-border,.mini-buttonedit-readOnly .mini-buttonedit-input,.mini-readonly .mini-textboxlist-border{cursor:default;border:0;background:none}.mini-buttonedit-readOnly .mini-buttonedit-button,.mini-readonly .mini-textboxlist-close{display:none}.mini-readonly .mini-textboxlist-item{padding-right:8px}.row.acc-layout{display:block;padding-left:0;padding-right:0}.col.acc-item{display:block}.col.acc-item>.fui-acc-bd{padding-left:0;padding-right:0}.col.acc-item:after{border:none !important}</style>\n          <style>'.concat(n.style,'</style>\n      </head>\n      <body>\n          <div class="container" style="width:').concat(t.formSize.width,'px;">').concat(n.html,"</div>\n      </body>\n      </html>\n      "),i=new Blob([o],{type:"text/html"}),r=document.createElement("a");r.download="测试表单设计器生成布局",r.href=URL.createObjectURL(i),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.html=o}))},getMobileData:function(){var t=Object(It["d"])(this.mobileDesignData),e=this.$store.getters.controlDataMap;return t.forEach((function(t){if(t.control){var n=t.control.id;e[n]&&(t.control=e[n].control)}})),this.$store.commit({type:"replaceMobileDesign",mobileDesignData:t}),t},getData:function(){var t,e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{htmlEncode:!0,withBuild:!0},o="";return n.withBuild?(t=this.getHtml(),o=this.getStyle()):t=wc["Promise"].resolve(""),t.then((function(t,i){if(i)return console.error(i);var r=e.getDesignData(),a=r.hiddenControls,l=Object(It["d"])(e.$store.getters.allControls);l.push.apply(l,Object(ct["a"])(a));var s={designData:r,build:{html:t,style:o},controls:l,jsCode:Object(It["f"])(e.jsCode),cssCode:Object(It["f"])(e.cssCode),newFieldList:Object(It["d"])(e.newFieldList),designId:du,tableGuid:fu};return n.withBuild&&0!=n.htmlEncode&&s.build.html&&(s.build.html=Object(It["h"])(s.build.html)),s}))},getDesignData:function(){this.$store.dispatch("dealSubmitControl");var t=Object(It["d"])(this.hiddenControls);return{globalStyle:Object(It["d"])(this.globalStyle),hiddenControls:t,design:Object(It["d"])(this.design),skin:this.$store.state.skin,mobileDesignData:this.getMobileData()}},autoCreateField:function(){var t=this,e=[].concat(Object(ct["a"])(this.$store.getters.allControls),Object(ct["a"])(this.$store.state.hiddenControls));if(!e||!e.length)return wc["Promise"].resolve();var n=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o=e.filter((function(t){return n(t,"bind")&&""==t.bind}));if(!o.length)return wc["Promise"].resolve();var i=Object(It["d"])(o);return i.forEach((function(t){t.name||(t.name=t.namePrefix+(t.autoIndex||""))})),this.$httpPost(window.formDesignerActions.autoCreateFieldUrl,{designId:du,tableGuid:fu,controls:i}).then((function(e){var n=e.fieldList,i=n.reduce((function(t,e){return t[e.controlId]=e,t}),{});t.$store.dispatch({type:"bindFieldToControl",fieldMaps:i,controls:o,newFieldList:n.map((function(t){var e=Object(It["d"])(t);return delete e.controlId,e}))})}))},saveToServer:function(t){var e=this;return this.autoCreateField().then((function(){return e.getData()})).then((function(n){if(window.FORM_DESIGNER&&window.FORM_DESIGNER.validateBeforeSave&&"function"==typeof window.FORM_DESIGNER.validate){var o=window.FORM_DESIGNER.validate(n);if(!1===o)return wc["Promise"].reject();if(o&&o.then)return o}return e.toSave(t,n)}))},toSave:function(t,e){var n=this;return this.$httpPost(window.formDesignerActions.saveUrl,e).then((function(e){var o=e;if(1!=parseInt(o.msg,10))throw new Error(o.msg||o);!t&&n.$msgbox({title:"系统提醒",message:"保存成功",type:"success",showClose:!0,callback:function(){location.reload()}})})).catch((function(t){n.$msgbox({title:"系统提醒",message:"保存失败 "+(t.message||""),type:"error",showClose:!0})}))},promptAndSave:function(t,e){return this.$msgbox(Bo()({closeOnClickModal:!1,showInput:!0,confirmButtonText:"确定",cancelButtonText:"取消",showCancelButton:!0,showConfirmButton:!0,beforeClose:function(t,n,o){if("confirm"===t){n.$type="prompt";var i=n.validate();if(!i)return;n.confirmButtonLoading=!0,e(n.inputValue).then((function(){o()})).finally((function(){n.confirmButtonLoading=!1}))}else o()}},t))},handleCommand:function(t){var e=this;return"saveToTpl"==t?this.promptAndSave({message:"请输入模板名称",title:"创建模板",inputValue:"".concat(this.formTitle,"_模板_1"),inputValidator:function(t){return t&&t.trim()?!!/^[.\d\w-_\u4E00-\u9FA5]+$/.test(t)||"模板名称格式不正确":"模板名称不能为空"}},(function(t){return e.saveAsTpl(t)})):("saveToNewVersion"===t&&this.confirmNewVersion(),"saveToCopy"===t?this.promptAndSave({confirmButtonText:"生成",message:"请输入表单名称",title:"生成副本",inputValue:"".concat(this.formTitle,"_副本_1"),inputValidator:function(t){return t&&t.trim()?!!/^[.\d\w-_\u4E00-\u9FA5]+$/.test(t)||"表单名称格式不正确":"表单名称不能为空"}},(function(t){return e.saveAsCopy(t)})):void 0)},saveAsTpl:function(t){var e=this;return this.getData().then((function(n){return n.name=t,e.$httpPost(window.formDesignerActions.saveAsTplUrl,n)})).then((function(t){return e.$message({type:"success",message:"模板保存成功"}),wc["Promise"].resolve()})).catch((function(t){return console.error(t),e.$message({type:"error",message:"模板保存失败",showClose:!0,duration:3e3}),wc["Promise"].reject()}))},confirmNewVersion:function(){var t=this,e=new cu({el:document.createElement("div")});e.save=function(e){return t.saveAsNewVersion(e)},document.body.appendChild(e.$el)},saveAsNewVersion:function(t){var e=this;return this.getData({withBuild:!1}).then((function(n){return n.tplId=t,e.$httpPost(window.formDesignerActions.saveAsNewVersionUrl,n)})).then((function(t){e.$confirm("新版本创建成功，是否进入新表单进行设计","提示",{confirmButtonText:"开始设计",cancelButtonText:"留在当前页"}).then((function(){var e=t.tableGuid,n=t.designId,o="".concat(location.pathname,"?tableGuid=").concat(e||"","&designId=").concat(n||"");location.replace(o)}))})).catch((function(t){return console.error(t),e.$message({type:"error",message:"新版本创建失败",showClose:!0,duration:3e3,offset:window.innerHeight/4*3>>0}),wc["Promise"].reject()}))},saveAsCopy:function(t){var e=this;return this.getData({withBuild:!1}).then((function(n){return n.name=t,e.$httpPost(window.formDesignerActions.saveAsCopyUrl,n)})).then((function(t){return e.$message({type:"success",message:"表单副本保存成功"}),setTimeout((function(){e.$confirm("新表单创建成功，是否进入新表单进行设计","提示",{confirmButtonText:"开始设计",cancelButtonText:"留在当前页"}).then((function(){var e=t.tableGuid,n=t.designId,o="".concat(location.pathname,"?tableGuid=").concat(e||"","&designId=").concat(n||"");location.replace(o)}))}),100),wc["Promise"].resolve()})).catch((function(t){return console.error(t),e.$message({type:"error",message:"表单副本保存失败",showClose:!0,duration:3e3,offset:window.innerHeight/4*3>>0}),wc["Promise"].reject()}))},replaceDesign:function(t){t.globalStyle&&(this.globalStyle=t.globalStyle),this.design=t.design||[],this.$store.commit("setHiddenControls",t.hiddenControls||[]),this.$store.commit("setSkin",{skinName:t.skin}),xc["c"].control.adapt(this.$store.getters.allControls),xc["c"].control.adapt(this.$store.state.hiddenControls),xc["c"].col.adapt(this.design),It["l"].adapt(this.$store.getters.allRows,(function(t){return t.id}))},subscribeStore:function(){var t=this;this.$store.subscribe((function(){t.needAutoSave=!0})),this.subscribeStore=function(){}},autoSave:function(t){var e=this;if(!this.needAutoSave)return wc["Promise"].resolve();var n={designData:this.getDesignData(),newFieldList:Object(It["d"])(this.newFieldList)};return this.$httpPost(window.formDesignerActions.autoSaveUrl,Bo()({designId:du,tableGuid:fu},n)).then((function(n){var o=n;if(1!=parseInt(o.msg,10))throw new Error(o.msg||o);!t&&e.$message({title:"系统提醒",message:"自动保存成功",type:"success",showClose:!0}),e.$store.commit("submitNewFieldList"),e.needAutoSave=!1})).catch((function(t){e.$message({title:"系统提醒",message:"自动保存失败 "+t.message,type:"error",showClose:!0})}))},doAutoSave:function(){var t=this;clearTimeout(this.autoSaveTimer),this.autoSaveTimer=setTimeout((function(){t.autoSave().finally((function(){t.doAutoSave()}))}),this.autoSaveInterval||6e4)},getStyle:function(){return this.$store.getters.colStyleText},getHtml:function(){var t=this;return this.needRender=!0,new wc["Promise"]((function(e,n){var o=setTimeout((function(){n({msg:"渲染超时！！！"})}),3e3);t.$nextTick((function(){t.$refs.builder.getHtmlContent().then((function(n){e(n),clearTimeout(o),t.needRender=!1}))}))})).catch((function(e){t.needRender=!1,console.error(e)}))}}),beforeDestroy:function(){this.enableRightBarCover&&window.removeEventListener("resize",this.calcWidth),clearTimeout(this.autoSaveTimer)},watch:{design:{deep:!1,handler:function(t){JSON.stringify(t)!=JSON.stringify(this.design)&&this.$store.commit("updateDesign",t)}}}},pu=hu,mu=(n("bec5"),n("3176"),Object(Ct["a"])(pu,lt,st,!1,null,null,null)),gu=mu.exports,vu={name:"app",components:{Main:gu},data:function(){return{height:window.innerHeight}},mounted:function(){window.addEventListener("resize",this.handelResize),this.handleIE()},methods:{handelResize:function(){var t=this;clearTimeout(this._resizeTimer),this._resizeTimer=setTimeout((function(){t.height=window.innerHeight}),200)},handleIE:function(){(document.all&&document.compatMode||"-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style)&&(document.body.className?document.body.className+=" ie":document.body.className=" ie",this.$message({message:"为了有更好的体验，请使用最新版Chrome浏览器。",type:"error",showClose:!0,duration:1e4}))}},beforeDestroy:function(){window.removeEventListener("resize",this.handelResize)}},bu=vu,yu=(n("034f"),Object(Ct["a"])(bu,rt,at,!1,null,null,null)),Cu=yu.exports,wu=n("9aba"),xu=n.n(wu);function Ou(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Du(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,r=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw r}}}}function Du(t,e){if(t){if("string"===typeof t)return _u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_u(t,e):void 0}}function _u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var ku={getters:{rowDataMap:function(t){var e={};function n(t,o){e[t.id]&&console.warn("行id出现重复！！！",e[t.id],t),e[t.id]={row:t,index:o},t.cols&&(t.cols.forEach(n),t.cols.forEach((function(t){t.subs&&t.subs.forEach(n)})))}return t.design.forEach(n),e},allRows:function(t,e){var n=e.rowDataMap,o=[];for(var i in n)n.hasOwnProperty(i)&&o.push(n[i].row);return o},subRowPathMap:function(t,e){var n={};function o(t){n[t.id]||(n[t.id]=[]),t.cols&&t.cols.forEach((function(e){e.subs&&(e.subs.forEach((function(e){n[e.id]=[t].concat(n[t.id])})),e.subs.forEach(o))}))}for(var i in t.design.forEach(o),n)if(n.hasOwnProperty(i)){if(!n[i]||!n[i].length){delete n[i];continue}e.rowDataMap[i].row.name,document.querySelector('[row-id="'+e.rowDataMap[i].row.id+'"]'),n[i].forEach((function(t){document.querySelector('[row-id="'+t.id+'"]')}))}return n},selectedRowParentCol:function(t,e){var n=t.selectedRowId;if(!n)return null;var o=e.subRowPathMap[n];if(o&&o.length){var i,r=Ou(o[0].cols);try{for(r.s();!(i=r.n()).done;){var a=i.value;if(a.subs&&a.subs.length){var l,s=Ou(a.subs);try{for(s.s();!(l=s.n()).done;){var c=l.value;if(c.id==n)return a}}catch(u){s.e(u)}finally{s.f()}}}}catch(u){r.e(u)}finally{r.f()}}return null},selectedLayoutData:function(t,e){var n=t.selectedRowId;if(!n)return{layout:null,index:-1};var o=e.rowDataMap[n];return{layout:o.row,index:o.index}}},mutations:{updateSelectedLayout:function(t,e){var n=e.id;t.selectedRowId=n},setRowProps:function(t,e){void 0===e.shuttle&&(e.shuttle=!0);var n=e.prop,o=e.value,i=e.row;Object(It["k"])(i,n,o)},removeRow:function(t,e){var n=e.parentCol,o=e.index;n?n.subs?n.subs.splice(o,1):console.error("删除时找不到上级！！！"):t.design.splice(o,1)},updateRowHeight:function(t,e){var n=e.row,o=e.height,i=o-n.height;function r(t,e){t.cols&&t.cols.forEach((function(t){var n=t.subs;if(n&&n.length){var o=n[n.length-1],i=n.reduce((function(t,e){return t+e.height}),0),a=e-i;if(a>0)o.height+=a;else{var l=o.height+a;o.height=l<30?30:l}r(o,o.height)}}))}function a(t,e){if(t&&t.length){var n=t[0];n.height+=e,void 0!=n.type&&"row-layout"!=n.type||r(n,n.height),a(t.slice(1),e)}}n.height=o,r(n,o),!1!==e.bubble&&a(e.parentRowPath,i)},replaceToMulti:function(t,e){var n=e.row,o=e.rowIndex,i=e.rowCount,r=e.colCount,a=e.parentCol,l=a&&a.subs?a.subs:t.design,s=c(n,i,r);function c(t,e,o){var i=Object(It["d"])(t),r=n.cols[0];i.cols=[],i.asMulti=!1,delete i.asMulti,r.style.width=r.style.width/o;var a=Object(ct["a"])(new Array(e)).map((function(){var t=Object(It["l"])(),e=Object(It["d"])(i);return e.id=t,e.autoIndex=It["j"].getIndex(e.namePrefix||e.name),e.cols=Object(ct["a"])(new Array(o)).map((function(){var e=It["b"].getIndex(t),n=Object(It["d"])(r);return n.id="col-".concat(t,"-").concat(e),n.name="col-".concat(e),n})),e}));return a}l.splice.apply(l,[o,1].concat(Object(ct["a"])(s)))},copyRow:function(t,e){var n=e.aimIndex,o=e.newRow,i=e.parentCol?e.parentCol.subs:t.design;i.splice(n,0,o)},updateLayoutProp:function(t,e){var n=e.prop,o=e.value,i=e.layout;i?i[n]=o:console.error("组件件不存在")},updateAllRowHeight:function(t,e){var n=e.rows,o=e.height;Array.isArray(n)&&n.forEach((function(t){t.height=o}))}},actions:{setAllRowHeight:function(t,e){var n=e.height,o=t.state.design.filter((function(t){var e,n=Ou(t.cols);try{for(n.s();!(e=n.n()).done;){var o=e.value;if(o.subs&&o.subs.length)return!1}}catch(i){n.e(i)}finally{n.f()}return!0})),i="allRowHeight"+ +new Date;t.commit("updateGlobalStyleProp",{prop:"cellHeight",value:n,shuttle:!0,group:i}),o.length&&t.commit("updateAllRowHeight",{rows:o,height:n,shuttle:!0,group:i})},setSelectedLayout:function(t,e){t.commit("updateSelectedLayout",e),t.commit({type:"setSelectedCol",selectedColId:""}),t.commit("clearSelectedControl")},setLayoutProp:function(t,e){var n=e.layout,o=e.prop,i=e.value;n||(n=t.getters.selectedLayoutData.layout),t.commit("updateLayoutProp",{layout:n,prop:o,value:i})},deleteRow:function(t,e){void 0===e.shuttle&&(e.shuttle=!0),e.row==t.getters.selectedLayoutData.layout&&t.commit("updateSelectedLayout",{id:""}),t.commit("removeRow",e)}}};n("4917"),n("9865");function Su(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=ju(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,r=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw r}}}}function ju(t,e){if(t){if("string"===typeof t)return Tu(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Tu(t,e):void 0}}function Tu(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var Iu={getters:{allCol:function(t,e){var n,o=[],i=e.rowDataMap;for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n=i[r].row,n.cols&&n.cols.length&&n.cols.forEach((function(t){o.push(t)})));return o},colStyleText:function(t,e){var n=e.allCol,o=[];return n.forEach((function(t){var e=t.style.border,n=["#".concat(t.id,":after{"),"border-top: ".concat(e.top.width,"px ").concat(e.top.style," ").concat(e.top.color,";"),"border-right: ".concat(e.right.width,"px ").concat(e.right.style," ").concat(e.right.color,";"),"border-bottom: ".concat(e.bottom.width,"px ").concat(e.bottom.style," ").concat(e.bottom.color,";"),"border-left: ".concat(e.left.width,"px ").concat(e.left.style," ").concat(e.left.color,";}")].join("");o.push(n)})),o.join("")},selectedCol:function(t,e){var n=t.selectedColId;if(!n)return null;var o=n.replace(/^col-([\w-]+)-\d{1,2}$/,"$1"),i=e.rowDataMap[o];if(!i){var r,a=Su(e.allCol);try{for(a.s();!(r=a.n()).done;){var l=r.value;if(l.id===n)return l}}catch(d){a.e(d)}finally{a.f()}return null}if(!i.row.cols)return i.row;var s,c=Su(i.row.cols);try{for(c.s();!(s=c.n()).done;){var u=s.value;if(u.id==n)return u}}catch(d){c.e(d)}finally{c.f()}return null}},mutations:{setSelectedCol:function(t,e){t.selectedColId=e.id},setColProps:function(t,e){void 0===e.shuttle&&(e.shuttle=!0);var n=e.prop,o=e.value,i=e.col;Object(It["k"])(i,n,o)},addAccItem:function(t,e){var n=e.item,o=e.parentRow;o.cols.push(n)},removeCol:function(t,e){var n=e.col,o=e.parentRow,i=e.colIndex;if(o.cols&&1!=o.cols.length){var r=o.cols[i-1];if(r)r.style.width+=n.style.width;else{var a=o.cols[i+1];a&&(a.style.width+=n.style.width)}o.cols.splice(i,1)}},splitCol:function(t,e){var n=e.col,o=e.colIndex,i=e.parentRow,r=e.direction,a=void 0===r?"right":r;if(!i)return e.shuttle=!1,void console.error("未指定所在行！！");var l=Object(It["d"])(n);f(i,l);var s=n.style.width,c=s/2>>0,u=s-c;n.style.width=c,l.style.width=u,l.style.border=Object(It["d"])(n.style.border),l.controls=[];var d="left"==a?o:o+1;function f(t,e){var n=t.id,o=Math.max.apply(Math,Object(ct["a"])(t.cols.map((function(t){return parseInt(t.id.substr(t.id.lastIndexOf("-")+1),10)}))));e.id="col-".concat(n,"-").concat(o+1),e.name="col-".concat(o+1)}i.cols.splice(d,0,l)},updateColAllBorder:function(t,e){var n=e.directions,o=e.prop,i=e.value;n.forEach((function(t){t&&(t[o]=i)}))},setColBorder:function(t,e){var n=e.border,o=e.selectedCol;JSON.stringify(e),o.style.border=Object(It["d"])(n)},setColStyle:function(t,e){JSON.stringify(e);var n=e.prop,o=e.value,i=e.selectedCol;i.style[n]=o},setAllColBorderWidth:function(t,e){var n=e.cols,o=e.borderWidth;Eu(n,o)},setAllColBorder_inner:function(t,e){var n=e.cols,o=e.borderWidth;Eu(n,o),Pu(t.design[0],0),Lu(t.design[t.design.length-1],0),Au(t.design,0),$u(t.design,0)},setAllColBorder_hline:function(t,e){var n=e.cols,o=e.borderWidth;n.forEach((function(t){t.style.border.left.width=0,t.style.border.right.width=0,t.style.border.top.width=o,t.style.border.bottom.width=o}))},setAllColBorder_vline:function(t,e){var n=e.cols,o=e.borderWidth;n.forEach((function(t){t.style.border.left.width=o,t.style.border.right.width=o,t.style.border.top.width=0,t.style.border.bottom.width=0}))},setAllColBorder_outer:function(t,e){var n=e.cols,o=e.borderWidth;Eu(n,0),Pu(t.design[0],o),Lu(t.design[t.design.length-1],o),Au(t.design,o),$u(t.design,o)},setAllColBorder_left:function(t,e){var n=e.cols,o=e.borderWidth;Eu(n,0),Au(t.design,o)},setAllColBorder_top:function(t,e){var n=e.cols,o=e.borderWidth;Eu(n,0),Pu(t.design[0],o)},setAllColBorder_right:function(t,e){var n=e.cols,o=e.borderWidth;Eu(n,0),$u(t.design,o)},setAllColBorder_bottom:function(t,e){var n=e.cols,o=e.borderWidth;Eu(n,0);var i=t.design.length;if(i){var r=t.design[i-1];Lu(r,o)}},updateColWidth:function(t,e){var n=e.col,o=e.width,i=e.nextCol,r=o-n.style.width;function a(t,e,n){t.subs.forEach((function(t){var o=t.cols;if(o&&o.length){var i=o["right"==n?0:o.length-1];i.style.width+=e,a(i,e,n)}}))}i&&i.style&&(i.style.width-=r,i.subs&&a(i,-r,"right")),n.style.width=o,n.subs&&a(n,r,"left")},updateRowColWidth:function(t,e){var n=e.row,o=e.ratio;function i(t){t.cols.forEach((function(t){t.style.width*=o,t.subs&&t.subs.length&&t.subs.forEach(i)}))}i(n)}},actions:{setSelectedCol:function(t,e){t.commit("setSelectedCol",e),t.commit("updateSelectedLayout",{id:"",shuttle:!1}),t.commit("clearSelectedControl")},removeCol:function(t,e){var n=e.col;n.id==t.state.selectedColId&&t.commit("setSelectedCol",{id:"",shuttle:!1}),t.commit("removeCol",e)},setColAllBorder:function(t,e){var n,o,i=e.prop,r=e.value,a=t.getters.selectedCol,l=a.style.border.right,s=a.style.border.bottom,c=t.state.selectedColId.match(/col-(\w+)-\d/);if(!c)return console.error("单元格不存在！！！");var u=c[1];if(!u)return console.error("无法匹配目标行");var d=t.getters.rowDataMap[u].row,f=t.getters.rowDataMap[u].index,h=d.cols.indexOf(a);if(-1===h)return console.error("单元格不存在！！！");if(n=0===h?a.style.border.left:d.cols[h-1].style.border.right,0==f)o=a.style.border.top;else{var p,m=t.getters.subRowPathMap[u];p=m&&m.length?m[0].cols[f-1]:t.state.design[f-1],o=p.cols[h]?p.cols[h].style.border.bottom:null}t.commit("updateColAllBorder",{directions:[o,l,s,n],prop:i,value:r,shuttle:!0})}}};function Eu(t,e){t.forEach((function(t){t.style.border.top.width=e,t.style.border.right.width=e,t.style.border.bottom.width=e,t.style.border.left.width=e}))}function Pu(t,e){t&&t.cols.forEach((function(t){t.style.border.top.width=e;var n=t.subs[0];Pu(n)}))}function Lu(t,e){t&&t.cols.forEach((function(t){t.style.border.bottom.width=e;var n=t.subs.length;n&&Lu(t.subs[n-1],e)}))}function Au(t,e){Array.isArray(t)&&t.length&&t.forEach((function(t){var n=t.cols[0];n&&(n.style.border.left.width=e,Au(n.subs,e))}))}function $u(t,e){Array.isArray(t)&&t.length&&t.forEach((function(t){var n=t.cols[t.cols.length-1];n&&(n.style.border.right.width=e,$u(n.subs,e))}))}n("f400");function Fu(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Mu(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,r=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw r}}}}function Mu(t,e){if(t){if("string"===typeof t)return Nu(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Nu(t,e):void 0}}function Nu(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var Ru={getters:{controlType2nameMap:function(t){var e=window.FORM_DESIGN_CONFIG.controlList,n=t.extControls,o={};return e.concat(n).forEach((function(t){o[t.type]=t.name})),o},fieldMap:function(t){var e={},n=t.newFieldList;function o(t,n){e[(t.id||"")+";"+(n.field||"")]=n;var o="#".concat(t.sqltablename||"",";#").concat(n.fieldname||"");e[o]=n}return t.fieldList.forEach((function(t,e){0==e&&n.forEach((function(e){o(t,e)})),t.fields.forEach((function(e){o(t,e)}))})),e},codeListMap:function(t){var e=t.codeList,n={};return e.forEach((function(t){n[t.id]=t})),n},selectedFieldMap:function(t,e){var n=e.allControls;if(!n.length)return{};var o={};return n.forEach((function(t){t.bind&&(o[t.bind]=!0)})),o},allControls:function(t,e){var n=e.allCol;if(!n||!n.length)return[];var o=[];return n.forEach((function(t){t.controls&&t.controls.length&&o.push.apply(o,Object(ct["a"])(t.controls))})),o},controlNameMap:function(t,e){var n=t.hiddenControls,o=e.allControls,i={};return n.forEach((function(t){i[t.id]=t.name||"".concat(t.namePrefix,"_").concat(t.autoIndex)})),o.forEach((function(t){i[t.id]=t.name||"".concat(t.namePrefix,"_").concat(t.autoIndex)})),i},controlDataMap:function(t,e){var n=t.hiddenControls,o=e.allCol,i={};return n.forEach((function(t,e){i[t.id]={control:t,index:e}})),o.forEach((function(t){t.controls&&t.controls.length&&t.controls.forEach((function(t,e){i[t.id]={control:t,index:e}}))})),i},selectedControl:function(t,e){var n=t.selectedControlId,o=e.controlDataMap;if(!n)return{control:null,index:-1};var i=o[n];return i&&i.control?i:{control:null,index:-1}},selectedControlParentCol:function(t,e){var n,o=t.selectedControlId,i=t.hiddenControls,r=e.allCol,a=Fu(r);try{for(a.s();!(n=a.n()).done;){var l=n.value;if(l.controls){var s,c=Fu(l.controls);try{for(c.s();!(s=c.n()).done;){var u=s.value;if(u.id==o)return l}}catch(p){c.e(p)}finally{c.f()}}}}catch(p){a.e(p)}finally{a.f()}var d,f=Fu(i);try{for(f.s();!(d=f.n()).done;){var h=d.value;if(h.id==o)return{controls:i}}}catch(p){f.e(p)}finally{f.f()}return null},selectedControlParentColInfo:function(t,e){var n=e.selectedControlParentCol,o=e.rowDataMap,i={row:null,index:-1};if(!n)return i;var r=n.id,a=r.replace(/^col-(\w+)-\d{1,2}$/,"$1"),l=o[a];return l?{row:l.row,index:l.row.cols.indexOf(n)}:i}},mutations:{setHiddenControls:function(t,e){t.hiddenControls=e},setSourceTables:function(t,e){t.sourceTables=e},setDataTables:function(t,e){t.dataTables=e},setFieldList:function(t,e){t.fieldList=e},setCodeList:function(t,e){t.codeList=e},setMacroTypes:function(t,e){t.macroTypes=e},setExtControls:function(t,e){t.extControls=e},setCommonControls:function(t,e){t.commonControls=e},setButtonEditPopupList:function(t,e){t.buttonEditPopupList=e},removeControl:function(t,e){var n=e.selectedControl,o=e.selectedControlParentCol,i=e.selectedControlIndex;if(!n||!o||-1===i)return console.error("删除控件出错！！！");o.controls.splice(i,1)},removeHiddenControl:function(t,e){var n=e.index;t.hiddenControls.splice(n,1)},addControl:function(t,e){var n=e.parentCol,o=e.control;n.controls.push(o)},setSelectedControl:function(t,e){t.selectedControlId=e.id},clearSelectedControl:function(t){t.selectedControlId=""},updateControlProp:function(t,e){JSON.stringify(e);var n=e.control;n?/\./.test(e.prop)?(e.prop,Object(It["g"])(n,e.prop),Object(It["k"])(n,e.prop,e.value),Object(It["g"])(n,e.prop)):n[e.prop]=e.value:console.error("无选中控件")},addMultiFormProps:function(t,e){var n=e.controlData;n&&(n.multiFormAccId="",n.multiFormColumnId="",n.multiFormIndex=0)},addTooltipConfig:function(t,e){var n=e.controlData;n&&(n.tooltipConfig={type:"tooltip",content:""})},updateControlStyle:function(t,e){var n=e.controls,o=e.skinData;if(n){var i=Array.isArray(n)?n:[n],r=["fontSize","fontFamily","fontColor","fontBolder","fontItalic","fontUnderline","textAlign","verticalAlign"];i.forEach((function(t){r.forEach((function(e){o[e]&&(t[e]=o[e])}))}))}}},actions:{deleteControl:function(t,e){if(e){var n=e.selectedControl,o=e.selectedControlParentCol,i=e.selectedControlIndex;t.commit("removeControl",{selectedControl:n,selectedControlParentCol:o,selectedControlIndex:i,shuttle:!0})}else{var r=t.getters.selectedControl,a=r.control,l=r.index;if(!a||-1===l)return console.error("出现错误，无法删除！");if("hiddenfield"===a.type)return t.commit("clearSelectedControl"),void t.commit("removeHiddenControl",{index:l,shuttle:!0});var s=t.getters.selectedControlParentCol;if(!s)return console.error("出现错误，无法删除！");t.commit("clearSelectedControl"),t.commit("removeControl",{selectedControl:a,selectedControlParentCol:s,selectedControlIndex:l,shuttle:!0})}},setSelectedControl:function(t,e){t.commit("setSelectedControl",e),t.commit("setSelectedCol",{id:""}),t.commit("updateSelectedLayout",{id:""})},autoAddLabel:function(t,e){var n=e.parentCol,o=e.prevName||"",i=Wu(o,t.state.globalStyle);t.commit("addControl",{parentCol:n,control:i})},bindFieldToControl:function(t,e){var n=e.fieldMaps,o=e.controls,i=e.newFieldList;t.commit({type:"submitNewFieldList",newFieldList:i});var r=t.state.fieldList[0].sqltablename;function a(t){return"#".concat(r,";#").concat(t.fieldname||"")}var l="bindFieldToControl";o.forEach((function(e){var o,i,r=n[e.id];if(Array.isArray(r)?(o=r[0],i=r[1]):o=r,o&&o.fieldname){e.id!=t.state.selectedControlId&&t.commit({type:"setSelectedControl",id:e.id});var s=a(o);t.dispatch({type:"setControlProp",prop:"bind",value:s,group:l,control:e}),i&&t.dispatch({type:"setControlProp",prop:"bind2",value:a(i),group:l,control:e})}}))},setControlProp:function(t,e){var n=e.prop,o=e.value,i=e.control,r=e.group||"updateCtrProp-"+ +new Date;if(t.commit({control:i,type:"updateControlProp",prop:n,value:o,shuttle:!0,group:r}),"bind"==n){var a=t.getters.fieldMap[o];if(a&&a.datasource&&(t.commit({control:i,type:"updateControlProp",prop:"data",value:"",shuttle:!1}),t.commit({control:i,type:"updateControlProp",prop:"codeItem",value:a.datasource,shuttle:!1})),i&&o&&void 0!==!i.emptyText)try{t.commit({control:i,type:"updateControlProp",prop:"emptyText",value:"请输入"+t.getters.fieldMap[o].name,shuttle:!1})}catch(l){console.error("自动设置 emptyText",l)}if(i.id!=t.state.selectedControlId)return;qu(t,i),Uu(t,t.getters.fieldMap[i.bind].name),Bu(t,o,i),zu(t,o,i)}i.id==t.state.selectedControlId&&("uniqueValidate"==n&&!0===o&&(t.commit({control:i,type:"updateControlProp",prop:"required",value:!0,shuttle:!0,group:r}),Gu(t,!0)),"required"==n&&Gu(t,o),"sourceTable"==n&&Vu(t,i),"name"!=n||!o||"label"==i.type&&"title"==i.type||Uu(t,o,!1))},dealSubmitControl:function(t){Ju(t)}}};function Vu(t,e){e&&"subtable"==e.type&&t.commit({control:e,type:"updateControlProp",prop:"columns",value:[],shuttle:!1})}function zu(t,e,n){var o=t.getters.fieldMap[e];if(o.fieldtype){var i;switch(o.fieldtype){case 1:i="float";break;case 2:i="int";break;default:break}i&&t.commit({control:n,type:"updateControlProp",prop:"vtype",value:i,shuttle:!1})}}function Bu(t,e,n){var o=t.getters.fieldMap[e];o.required&&n&&"required"in n&&(t.commit({control:n,type:"updateControlProp",prop:"required",value:!0,shuttle:!1}),Gu(t,!0))}function Uu(t,e,n){var o=Hu(t);o&&(n||"控件label"==o.labelText)&&t.commit("updateControlProp",{control:o,prop:"labelText",value:e,shuttle:!1})}function Gu(t,e){var n=Hu(t);n&&t.commit("updateControlProp",{control:n,prop:"showStar",value:e,shuttle:!1})}function Hu(t){var e=t.getters.selectedControlParentColInfo,n=e.row,o=e.index;if(n&&-1!==o){var i=n.cols[o-1];if(i&&i.controls.length){var r,a=Fu(i.controls);try{for(a.s();!(r=a.n()).done;){var l=r.value;if("label"==l.type)return l}}catch(s){a.e(s)}finally{a.f()}return null}}}function qu(t,e){var n=t.getters.selectedControlParentColInfo,o=n.row,i=n.index;if(e&&o){var r=o.cols[i-1];if(r&&!r.controls.length&&!r.subs.length){var a=Wu(t.getters.fieldMap[e.bind].name,t.state.globalStyle);t.commit("addControl",{parentCol:r,control:a,shuttle:!1})}}}function Wu(t,e){var n=Object(It["d"])(window.FORM_DESIGN_CONFIG.controls.label),o=It["c"].getIndex("label");n.id="label-"+o,n.namePrefix="label",n.autoIndex=o,n.name="",n.width="100%",t&&(n.labelText=t),delete n.configItems;var i=e.fontSize,r=e.fontFamily,a=e.fontColor,l=e.fontBolder,s=e.fontItalic,c=e.fontUnderline;return n.fontSize=i,n.fontFamily=r,n.fontColor=a,n.fontBolder=l,n.fontItalic=s,n.fontUnderline=c,n}function Ju(t){var e=t.getters.allControls,n=e.filter((function(t){return"combobox"==t.type})),o=new Map,i=new Map;n.forEach((function(t){o.set(t.id,t),t.events&&t.events["valuechanged:getcodelist"]&&t.events["valuechanged:getcodelist"].length&&i.set(t.id,t)})),Yu(i,o,t,{})}function Yu(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=!1,r=!1;t.forEach((function(t){if(t.codeItem){var a=t.events["valuechanged:getcodelist"].reduce((function(t,e){var n=e.actions.filter((function(t){return"setData"==t.type}))[0];return n&&t.push.apply(t,Object(ct["a"])(n.targets)),t}),[]);a.forEach((function(r){var a=r.id;o[a]||(n.commit({control:e.get(a),type:"updateControlProp",prop:"codeItem",value:t.codeItem,shuttle:!1}),n.commit({control:e.get(a),type:"updateControlProp",prop:"codeSyncPid",value:t.id,shuttle:!1}),o[a]=!0,i=!0)}))}else r=!0})),r&&i&&Yu(t,e,n,o)}var Xu,Ku={getters:{inControlDragging:function(t){return t.helper.inControlDragging},inLayoutDragging:function(t){return t.helper.inLayoutDragging}},mutations:{updateLineTop:function(t,e){t.helper.top=e},updateLineLeft:function(t,e){t.helper.left=e},showHLine:function(t){t.helper.showHLine=!0},hideHLine:function(t){t.helper.showHLine=!1},showVLine:function(t){t.helper.showVLine=!0},hideVLine:function(t){t.helper.showVLine=!1},layoutDragStart:function(t){t.helper.inLayoutDragging=!0},layoutDragEnd:function(t){t.helper.inLayoutDragging=!1},controlDragStart:function(t){t.helper.inControlDragging=!0},controlDragEnd:function(t){t.helper.inControlDragging=!1},updateViewType:function(t,e){/^(pc|mobile)$/.test(e)?t.helper.viewType=e:console.error("unsupport viewType")},toggleViewDesign:function(t){t.helper.viewDesign=!t.helper.viewDesign},setShowPreview:function(t,e){t.helper.showPreview=e.showPreview}},actions:{}};function Qu(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Zu(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Qu(Object(n),!0).forEach((function(e){Object(ut["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Qu(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}it["default"].use(Tt["a"]);var td=new Tt["a"].Store({strict:!1,state:(Xu={formSize:{width:900,height:0},design:[],mobileDesignData:[],hiddenControls:[],skin:"",globalStyle:{autoColons:!0,fontSize:13,fontFamily:"Microsoft Yahei",fontColor:"#333333",fontBolder:!1,fontItalic:!1,fontUnderline:!1,textAlign:"left",verticalAlign:"middle",cellHeight:38,border:{top:{width:1,style:"solid",color:"#ddd"},right:{width:1,style:"solid",color:"#ddd"},bottom:{width:1,style:"solid",color:"#ddd"},left:{width:1,style:"solid",color:"#ddd"}},allBorderType:"all"},helper:{showVLine:!1,showHLine:!1,left:0,top:0,inControlDragging:!1,inLayoutDragging:!1,viewDesign:!1,viewType:"pc",showPreview:!1},jsCode:"",cssCode:"",fieldList:[],codeList:[],macroTypes:[],sourceTables:[],dataTables:[],DBDataTypes:[],newFieldList:[],buttonEditPopupList:[],commonControls:[],extControls:[]},Object(ut["a"])(Xu,"commonControls",[]),Object(ut["a"])(Xu,"leftActiveTab","layout"),Object(ut["a"])(Xu,"rightActiveTab","form"),Object(ut["a"])(Xu,"selectedControlId",""),Object(ut["a"])(Xu,"selectedColId",""),Object(ut["a"])(Xu,"selectedRowId",""),Object(ut["a"])(Xu,"shareFieldList",[]),Xu),getters:Zu(Zu(Zu(Zu(Zu({},ku.getters),Iu.getters),Ru.getters),Ku.getters),{},{globalStyleText:function(t){var e=t.globalStyle,n=e.fontSize,o=e.fontFamily,i=e.fontColor,r=e.fontBolder,a=e.fontItalic,l=e.fontUnderline,s=e.textAlign,c=e.verticalAlign;return"\n        font-size: ".concat(n,"px;\n        font-family: ").concat(o,";\n        color: ").concat(i,";\n        font-weight: ").concat(r?"bold":"normal",";\n        font-style: ").concat(a?"italic":"normal",";\n        text-decoration: ").concat(l?"underline":"none",";\n        text-align: ").concat(s,";\n        vertical-align: ").concat(c,";\n      ")}}),mutations:Zu(Zu(Zu(Zu(Zu({},ku.mutations),Iu.mutations),Ru.mutations),Ku.mutations),{},{setSkin:function(t,e){var n=e.skinName;t.skin=n},setJsCode:function(t,e){t.jsCode=e},setCssCode:function(t,e){t.cssCode=e},setDBDataTypes:function(t,e){Array.isArray(e)?t.DBDataTypes=e:console.error("设置创建新字段时可选的数据库类型时出错",e)},addToNewFieldList:function(t,e){t.newFieldList.push(e.fieldProps)},submitNewFieldList:function(t,e){var n=e&&e.newFieldList?e.newFieldList:t.newFieldList,o=t.fieldList[0]&&t.fieldList[0].fields;n.length&&Array.isArray(o)&&(o.push.apply(o,Object(ct["a"])(n)),t.newFieldList.length&&(t.newFieldList=[]))},updateGlobalStyleProp:function(t,e){JSON.stringify(e),t.globalStyle[e.prop]=e.value},updateGlobalBorder:function(t,e){JSON.stringify(e),t.globalStyle.border.top[e.prop]=e.value,t.globalStyle.border.right[e.prop]=e.value,t.globalStyle.border.bottom[e.prop]=e.value,t.globalStyle.border.left[e.prop]=e.value},updateGlobalStyle:function(t,e){var n=e.style;t.globalStyle=Bo()({},t.globalStyle,n)},applyGlobalStyle:function(t,e){var n=e.cols,o=e.prop,i=e.value;n.forEach((function(t){t.style[o]=i,t.controls&&t.controls.length&&-1!==["fontSize","fontFamily","fontColor","fontBolder","fontItalic","fontUnderline"].indexOf(o)&&t.controls.filter((function(t){return"label"==t.type||"title"==t.type})).forEach((function(t){t[o]=i}))}))},applyGlobalBorder:function(t,e){var n=e.cols,o=e.prop,i=e.value;n.forEach((function(t){t.style.border.top[o]=i,t.style.border.right[o]=i,t.style.border.bottom[o]=i,t.style.border.left[o]=i}))},activeLeftTab:function(t,e){t.leftActiveTab=e},activeRightTab:function(t,e){t.rightActiveTab=e},updateDesign:function(t,e){t.design=e,t.design},tryMergeAcc:function(t,e){var n=e.row,o=e.rowIndex;if(n&&void 0!==o&&1!=t.design.length){var i,r=t.design[o-1],a=t.design[o+1],l=r&&"acc-layout"==r.type,s=a&&"acc-layout"==a.type;return l?(i=Object(It["d"])(r),n.cols.forEach((function(t){i.cols.push(Object(It["d"])(t))})),void t.design.splice(o-1,2,i)):s?(i=Object(It["d"])(n),a.cols.forEach((function(t){i.cols.push(Object(It["d"])(t))})),void t.design.splice(o,2,i)):void 0}},replaceMobileDesign:function(t,e){t.mobileDesignData=e.mobileDesignData},setShareFieldList:function(t,e){t.shareFieldList=e.value},highlightDesignField:function(t,e){var n,o,i=e.id;t.design.forEach((function(t){"row-layout"===t.type?t.cols.forEach((function(t){t.controls.forEach((function(e,r){if(e.id===i){var a=Object.assign({},e,{highlight:!0});n=r,o=t,o.controls.splice(n,1,a)}})),t.subs.length&&nd(t.subs,i)})):"acc-layout"===t.type&&t.cols.forEach((function(t){t.subs.length&&nd(t.subs,i)}))}))},clearAllHighlightField:function(t){var e,n;t.design.forEach((function(t){"row-layout"===t.type?t.cols.forEach((function(t){t.controls.forEach((function(o,i){var r=Object.assign({},o);delete r["highlight"],e=i,n=t,n.controls.splice(e,1,r)})),t.subs.length&&od(t.subs)})):"acc-layout"===t.type&&t.cols.forEach((function(t){t.subs.length&&od(t.subs)}))}))}}),actions:Zu(Zu(Zu(Zu(Zu({},ku.actions),Iu.actions),Ru.actions),Ku.actions),{},{activeRightTab:function(t,e){var n=t.state,o=t.commit;n.rightActiveTab!=e&&o("activeRightTab",e)},setGlobalStyle:function(t,e){t.commit("updateGlobalStyleProp",e),t.commit("applyGlobalStyle",Zu(Zu({cols:t.getters.allCol},e),{},{shuttle:!0}))},setGlobalBorder:function(t,e){t.commit("updateGlobalBorder",e),t.commit("applyGlobalBorder",Zu(Zu({cols:t.getters.allCol},e),{},{shuttle:!0}))},setAllBorderType:function(t,e){var n=e.type,o=e.borderWidth,i="bordertype-"+ +new Date;t.commit("updateGlobalStyleProp",{prop:"allBorderType",value:n,group:i,shuttle:!0}),ed(t,n,o,i)},applySkin:function(t,e){var n=e.skin,o=e.skinData;t.commit({type:"setSkin",skinName:n,group:"skin",shuttle:!0}),t.commit({type:"updateGlobalStyle",style:o,group:"skin",shuttle:!0});var i=t.getters.allControls.filter((function(t){return-1!=["title","label","output"].indexOf(t.type)}));i.length&&t.commit({type:"updateControlStyle",controls:i,group:"skin",skinData:o,shuttle:!0})},setShareFieldList:function(t,e){t.commit("setShareFieldList",e.value)},highlightDesignField:function(t,e){t.commit("highlightDesignField",e)}})});function ed(t,e,n,o){var i=t.getters.allCol;return"all"==e?t.commit("setAllColBorderWidth",{cols:i,group:o,borderWidth:n}):"none"==e?t.commit("setAllColBorderWidth",{cols:i,group:o,borderWidth:0}):void t.commit("setAllColBorder_"+e,{cols:i,group:o,borderWidth:n})}function nd(t,e){var n,o;t.forEach((function(t){t.cols.forEach((function(t){t.controls.forEach((function(i,r){if(i.id===e){var a=Object.assign({},i,{highlight:!0});n=r,o=t,o.controls.splice(n,1,a)}})),t.subs&&nd(t.subs,e)}))}))}function od(t){var e,n;t.forEach((function(t){t.cols.forEach((function(t){t.controls.forEach((function(o,i){var r=Object.assign({},o);delete r["highlight"],e=i,n=t,n.controls.splice(e,1,r)})),t.subs&&od(t.subs)}))}))}var id=n("adb5"),rd=n("2fdd");n("8e1f"),n("64d2");window.jsoncParse=rd["a"],ot.a.props.model=[Object,Array];var ad=it["default"].extend({extends:et.a,mounted:function(){this.$el&&!this.$el.title&&this.label&&this.label.length>10&&this.$el.setAttribute("title",this.label)}});it["default"].prototype.$ELEMENT={size:"small"},it["default"].prototype.$bus=new it["default"],it["default"].prototype.$httpGet=id["a"],it["default"].prototype.$httpPost=id["b"],it["default"].prototype.$message=Z.a,it["default"].prototype.$confirm=K.a.confirm,it["default"].prototype.$prompt=K.a.prompt,it["default"].prototype.$msgbox=K.a,it["default"].config.productionTip=!1,it["default"].component("draggable",rl.a),it["default"].component(Y.a.name,Y.a),it["default"].component(W.a.name,W.a),it["default"].component(H.a.name,H.a),it["default"].component(U.a.name,U.a),it["default"].component(z.a.name,z.a),it["default"].component(R.a.name,R.a),it["default"].component(M.a.name,M.a),it["default"].component($.a.name,$.a),it["default"].component(L.a.name,L.a),it["default"].component(et.a.name,ad),it["default"].component(E.a.name,E.a),it["default"].component(T.a.name,T.a),it["default"].component(S.a.name,S.a),it["default"].component(_.a.name,_.a),it["default"].component(ot.a.name,ot.a),it["default"].component(O.a.name,O.a),it["default"].component(w.a.name,w.a),it["default"].component(Z.a.name,Z.a),it["default"].component(y.a.name,y.a),it["default"].component(v.a.name,v.a),it["default"].component(m.a.name,m.a),it["default"].component(h.a.name,h.a),it["default"].component(d.a.name,d.a),it["default"].component(c.a.name,c.a),it["default"].component(l.a.name,l.a),it["default"].component(r.a.name,r.a),it["default"].component("LayoutGender",Cc),it["default"].use(xu.a),"object"!=Object(o["a"])(window.FORM_DESIGNER)&&(window.FORM_DESIGNER={}),window.FORM_DESIGNER.app=new it["default"]({store:td,render:function(t){return t(Cu)}}).$mount("#app")},"58d3":function(t,e,n){"use strict";n("d87d")},5908:function(t,e,n){"use strict";n("31ec")},"592a":function(t,e,n){},"5bdd":function(t,e,n){},"63e8":function(t,e,n){"use strict";n("2cc5")},"64a9":function(t,e,n){},"690b":function(t,e,n){},"6da2":function(t,e,n){"use strict";n("ff06")},"6f10":function(t,e,n){"use strict";n("739e")},"739e":function(t,e,n){},"76fd":function(t,e,n){"use strict";n("472d")},"7d5a":function(t,e,n){},"7e28":function(t,e,n){},"81ec":function(t,e,n){},"89c5":function(t,e,n){},"8ac3":function(t,e,n){"use strict";n("4131")},"8e1f":function(t,e,n){},"8e22":function(t,e,n){"use strict";n("287b")},"8e39":function(t,e,n){},"8feb":function(t,e,n){},9827:function(t,e,n){"use strict";n.d(e,"d",(function(){return p})),n.d(e,"b",(function(){return m})),n.d(e,"a",(function(){return g}));n("2397"),n("7f7f"),n("ac6a"),n("f3e2"),n("2caf");var o=n("262e"),i=n("99de"),r=n("7e84"),a=n("d4ec"),l=n("bee2");function s(t){var e=c();return function(){var n,o=Object(r["a"])(t);if(e){var a=Object(r["a"])(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return Object(i["a"])(this,n)}}function c(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}var u=function(){function t(){Object(a["a"])(this,t),this.store={}}return Object(l["a"])(t,[{key:"_get",value:function(t){if(!t)throw new Error("type is required!");return this.store[t]?++this.store[t]:this.store[t]=1}},{key:"adaptProp",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.store[t]?this.store[t]+=e:this.store[t]=e}}]),t}(),d=function(t){Object(o["a"])(n,t);var e=s(n);function n(){return Object(a["a"])(this,n),e.call(this)}return Object(l["a"])(n,[{key:"getIndex",value:function(t){return this._get("control-"+t)}},{key:"adapt",value:function(t){var e=this;if(Array.isArray(t)){var n={};for(var o in t.forEach((function(t){var o=t.type,i=t.autoIndex||e.getIndex(o);n[o]?n[o]=Math.max(i,n[o]):n[o]=i})),n)this.adaptProp("control-"+o,n[o])}}}]),n}(u),f=function(t){Object(o["a"])(n,t);var e=s(n);function n(){return Object(a["a"])(this,n),e.call(this)}return Object(l["a"])(n,[{key:"getIndex",value:function(t){return this._get("col-"+t)}},{key:"adapt",value:function(t){var e=this;Array.isArray(t)&&t.forEach((function(t){t.cols.forEach((function(n){e.adaptProp("col-"+t.id),n.subs&&n.subs.length&&e.adapt(n.subs)}))}))}}]),n}(u),h=function(t){Object(o["a"])(n,t);var e=s(n);function n(){return Object(a["a"])(this,n),e.call(this)}return Object(l["a"])(n,[{key:"getIndex",value:function(t){return this._get("row-"+t)}},{key:"adapt",value:function(t){var e=this;if(Array.isArray(t)){var n={};for(var o in t.forEach((function(t){var o=t.namePrefix||t.name||"行",i=t.autoIndex||e.getIndex(o);n[o]?n[o]=Math.max(i,n[o]):n[o]=i})),n)this.adaptProp("control-"+o,n[o])}}}]),n}(u),p=new h,m=new d,g=new f;window.rowAutoIndex=p,window.controlAutoIndex=m,window.colAutoIndex=g,e["c"]={row:p,control:m,col:g}},9836:function(t,e,n){},"9cb4":function(t,e,n){},"9e0a":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("h1",{staticClass:"title",class:t.asControl?"design-form-title ":"design-control-holder",style:t.styleText},[t._v(t._s(t.controlData.textContent||t.controlData.name))])},i=[],r={name:"placeholder-title",props:{controlData:{type:Object,default:function(){return{}}},asControl:{type:Boolean,default:!1}},computed:{styleText:function(){var t=this.controlData,e=t.fontSize,n=t.fontFamily,o=t.fontColor,i=t.fontBolder,r=t.fontItalic,a=t.fontUnderline,l=t.textAlign,s=t.verticalAlign,c=[];return c.push("font-size:".concat(e,"px")),c.push("font-family:".concat(n)),c.push("color:".concat(o)),c.push("font-weight:".concat(i?"bold":"normal")),c.push("font-style:".concat(r?"italic":"normal")),c.push("text-decoration:".concat(a?"underline":"none")),c.push("text-align:".concat(l)),c.push("vertical-align:".concat(s)),c.join(";")}},data:function(){return{}}},a=r,l=n("2877"),s=Object(l["a"])(a,o,i,!1,null,null,null);e["a"]=s.exports},a3de:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"design-control",class:t.extCls,style:"width:"+t.controlWidth,attrs:{"data-id":t.controlData.id}},[t._t("default"),n(t.getControlComponent(t.controlData.type),{tag:"component",attrs:{"control-data":t.controlData}}),n("span",{directives:[{name:"show",rawName:"v-show",value:t.controlData.icon,expression:"controlData.icon"}],staticClass:"design-control-icon",class:t.controlIconMap[t.controlData.type]}),n("span",{staticClass:"design-control-remove",on:{click:function(e){return e.stopPropagation(),t.removeControl(e)}}}),n("ToolTip",{attrs:{"control-data":t.controlData}})],2)},i=[],r=(n("ac6a"),n("f3e2"),n("d718")),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("input",{staticClass:"design-control-holder textbox",attrs:{type:"text",placeholder:t.controlData.emptyText||t.name,readonly:""},domProps:{value:t.controlData.value}})},l=[],s=(n("7f7f"),{name:"placeholder-textbox",props:["controlData"],computed:{name:function(){var t=this.controlData,e=t.name,n=t.namePrefix,o=t.autoIndex;return e||(n&&o?"".concat(n,"_").concat(o):"")}}}),c=s,u=n("2877"),d=Object(u["a"])(c,a,l,!1,null,null,null),f=d.exports,h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"design-control-holder ewebeditor",style:{height:(t.controlData.height||260)+"px"}},[t._v(t._s(t.controlData.emptyText||t.name))])},p=[],m={name:"placeholder-ewebeditor",props:["controlData"],computed:{name:function(){var t=this.controlData,e=t.name,n=t.namePrefix,o=t.autoIndex;return e||(n&&o?"".concat(n,"_").concat(o):"")}}},g=m,v=Object(u["a"])(g,h,p,!1,null,null,null),b=v.exports,y=n("9e0a"),C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("textarea",{staticClass:"design-control-holder textbox",staticStyle:{resize:"none"},style:"height:"+(t.controlData.height||26)+"px",attrs:{type:"text",placeholder:t.controlData.emptyText||t.controlData.name,readonly:""},domProps:{value:t.controlData.value}})},w=[],x={name:"placeholder-textarea",props:["controlData"]},O=x,D=Object(u["a"])(O,C,w,!1,null,null,null),_=D.exports,k=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"design-control-holder checkboxlist",class:"vertical"==t.controlData.repeatDirection?"vertical":"horizontal"},[n("el-checkbox-group",{model:{value:t.valueList,callback:function(e){t.valueList=e},expression:"valueList"}},t._l(t.dataList,(function(e){return n("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])})),1)],1)},S=[],j=(n("28a5"),n("6d67"),n("ab9e")),T={name:"placeholder-checkboxlist",props:["controlData"],mixins:[j["a"]],data:function(){return{valueList:this.getValueList(),defaultDataList:[1,2,3].map((function(t){return{id:t,text:"选项-"+t}})),originData:[]}},methods:{getValueList:function(){return this.controlData.value&&this.controlData.value.split(",")||[]}},created:function(){this.getDataList()},watch:{"controlData.value":function(){this.valueList=this.getValueList()},"controlData.bind":function(){this.valueList=this.getValueList()}}},I=T,E=Object(u["a"])(I,k,S,!1,null,null,null),P=E.exports,L=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"design-control-holder radiobuttonlist",class:"vertical"==t.controlData.repeatDirection?"vertical":"horizontal"},[n("el-radio-group",{model:{value:t.currValue,callback:function(e){t.currValue=e},expression:"currValue"}},t._l(t.dataList,(function(e){return n("el-radio",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])})),1)],1)},A=[],$={name:"placeholder-radio-button-list",props:["controlData"],mixins:[j["a"]],data:function(){return{currValue:this.controlData.value||"",defaultDataList:[1,2,3].map((function(t){return{id:t,text:"选项-"+t}})),originData:[]}},created:function(){this.getDataList()}},F=$,M=Object(u["a"])(F,L,A,!1,null,null,null),N=M.exports,R=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("table",{staticClass:"design-control-holder sub-table"},[n("colgroup",[n("col",{attrs:{for:"checkcolumn",width:"50px"}}),n("col",{attrs:{for:"indexcolumn",width:"50px"}}),t._l(t.columns,(function(t){return n("col",{key:t.field,attrs:{for:"normal",width:t.width+"px"}})})),n("col",{attrs:{for:"actioncolumn",width:"100px"}})],2),n("thead",[n("tr",[t.checkcolumn?n("th",{staticClass:"text-center",class:{frozen:t.checkcolumnFrozen},attrs:{"data-column-type":"checkcolumn"}},[n("span",{staticClass:"checkcolumn-icon"})]):t._e(),t.indexcolumn?n("th",{staticClass:"text-center",class:{frozen:1==t.frozenIndex},attrs:{"data-column-type":"indexcolumn"}},[t._v("序")]):t._e(),t._l(t.columns,(function(e,o){var i;return n("th",{key:e.field,class:(i={},i["text-"+e.align]=!0,i.frozen=t.frozenIndex==o+t.prevColumnCount,i),attrs:{"data-column-type":"normal"}},[t._v(t._s(e.name))])})),t.actioncolumn?n("th",{staticClass:"text-center",attrs:{"data-column-type":"actioncolumn"}},[t._v("操作")]):t._e()],2)]),n("tbody",[n("tr",[t.checkcolumn?n("td",{staticClass:"text-center",class:{frozen:t.checkcolumnFrozen}},[n("span",{staticClass:"checkcolumn-icon"})]):t._e(),t.indexcolumn?n("td",{staticClass:"text-center",class:{frozen:1==t.frozenIndex}},[t._v("1")]):t._e(),t._l(t.columns,(function(e,o){var i;return n("td",{key:e.field,class:(i={},i["text-"+e.align]=!0,i.frozen=t.frozenIndex==o+t.prevColumnCount,i)},[t._v("...")])})),t.actioncolumn?n("td",{staticClass:"text-center"},[t._m(0)]):t._e()],2),n("tr",[t.checkcolumn?n("td",{staticClass:"text-center",class:{frozen:t.checkcolumnFrozen}},[n("span",{staticClass:"checkcolumn-icon"})]):t._e(),t.indexcolumn?n("td",{staticClass:"text-center",class:{frozen:1==t.frozenIndex}},[t._v("2")]):t._e(),t._l(t.columns,(function(e,o){var i;return n("td",{key:e.field,class:(i={},i["text-"+e.align]=!0,i.frozen=t.frozenIndex==o+t.prevColumnCount,i)},[t._v("...")])})),t.actioncolumn?n("td",{staticClass:"text-center"},[t._m(1)]):t._e()],2)])])},V=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",[n("i",{staticClass:"action-btn el-icon-plus"}),n("i",{staticClass:"action-btn el-icon-edit"}),n("i",{staticClass:"action-btn el-icon-delete"})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",[n("i",{staticClass:"action-btn el-icon-plus"}),n("i",{staticClass:"action-btn el-icon-edit"}),n("i",{staticClass:"action-btn el-icon-delete"})])}],z=(n("57e7"),{name:"placeholder-sub-table",props:["controlData"],computed:{specificColumns:function(){return this.controlData?this.controlData.specialColumns.split(","):[]},checkcolumn:function(){return-1!==this.specificColumns.indexOf("checkcolumn")},checkcolumnFrozen:function(){return!(!this.checkcolumn||0!=this.frozenIndex)},indexcolumn:function(){return-1!==this.specificColumns.indexOf("indexcolumn")},indexcolumnForzen:function(){return this.checkcolumn?1==this.frozenIndex:0==this.frozenIndex},actioncolumn:function(){return-1!==this.specificColumns.indexOf("actioncolumn")},frozenIndex:function(){return this.controlData.frozenColumnIndex},prevColumnCount:function(){return this.checkcolumn&&this.indexcolumn?2:this.checkcolumn||this.indexcolumn?1:(this.checkcolumn||this.indexcolumn,0)},columns:function(){return this.controlData.columns.length?this.controlData.columns:[{field:"name",name:"姓名",width:100,align:"center",required:!0,vtype:"number"}]}},data:function(){return{}},methods:{}}),B=z,U=Object(u["a"])(B,R,V,!1,null,null,null),G=U.exports,H=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"output",class:{"design-form-output":t.asControl,"design-control-holder":!t.asControl},style:t.styleText},[t._v(t._s(t.controlData.name||t.controlData.namePrefix+"_"+t.controlData.autoIndex))])},q=[],W={name:"placeholder-output",props:{controlData:{type:Object,default:function(){return{}}},asControl:{type:Boolean,default:!1}},computed:{controlWidth:function(){var t=this.controlData.width;return t?t+""===t?t:"".concat(t,"px"):""},styleText:function(){var t=this.controlData,e=t.fontSize,n=t.fontFamily,o=t.fontColor,i=t.fontBolder,r=t.fontItalic,a=t.fontUnderline,l=t.textAlign,s=(t.width,[]);return s.push("display:inline-block"),s.push("-webkit-box-sizing:border-box;box-sizing:border-box;"),s.push("font-size:".concat(e,"px")),s.push("font-family:".concat(n)),s.push("color:".concat(o)),s.push("font-weight:".concat(i?"bold":"normal")),s.push("font-style:".concat(r?"italic":"normal")),s.push("text-decoration:".concat(a?"underline":"none")),s.push("text-align:".concat(l)),this.controlWidth&&s.push("width:".concat(this.controlWidth)),s.join(";")}},data:function(){return{}}},J=W,Y=Object(u["a"])(J,H,q,!1,null,null,null),X=Y.exports,K=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.show?n("span",{class:t.cls,attrs:{"data-tooltip":t.tooltip,title:t.tooltip}},[t._v(t._s("tooltip"!==t.config.type?t.config.content:""))]):t._e()},Q=[],Z={name:"control-tooltip",props:["controlData"],computed:{cls:function(){var t="control-tooltip";return this.config&&this.config.type&&(t+=" tips-"+this.config.type,"tooltip"==this.config.type&&(t+=" el-icon-question")),t},show:function(){return!!(this.config&&this.config.type&&this.config.content)},tooltip:function(){return this.config&&"tooltip"===this.config.type?this.config.content:""}},data:function(){return{config:this.controlData.tooltipConfig}},methods:{doUpdate:function(){this.config=this.controlData.tooltipConfig}},watch:{controlData:{deep:!0,handler:function(t){this.doUpdate()}}}},tt=Z,et=(n("a58f"),Object(u["a"])(tt,K,Q,!1,null,null,null)),nt=et.exports,ot={label:r["a"],textbox:f,ewebeditor:b,title:y["a"],textarea:_,checkboxlist:P,radiobuttonlist:N,subtable:G,output:X},it={props:["controlData"],template:'<span class="design-control-holder" :class="controlData.type">{{controlData.name || (controlData.namePrefix + "_" + controlData.autoIndex)}}</span>'},rt={name:"control",props:{controlData:{type:Object,required:!0}},components:{PlaceholderLabel:r["a"],PlaceholderTextbox:f,PlaceholderTitle:y["a"],PlaceholderTextArea:_,PlaceholderCheckboxList:P,PlaceholderRadioButtonList:N,ToolTip:nt},data:function(){return{}},computed:{controlIconMap:function(){var t={};return window.FORM_DESIGN_CONFIG.controlList.concat(this.$store.state.extControls).forEach((function(e){t[e.type]=e.icon})),t},controlWidth:function(){var t=this.controlData.width;return t?t+""===t?t:"".concat(t,"px"):""},extCls:function(){var t,e=this.controlData.tooltipConfig;return t=e&&e.content?"with-tooltip tooltip-".concat(e.type):"","".concat(t," ").concat(this.controlData.type)}},methods:{removeControl:function(){this.$store.dispatch("deleteControl")},getControlComponent:function(t){return t in ot?ot[t]:it}}},at=rt,lt=Object(u["a"])(at,o,i,!1,null,null,null);e["a"]=lt.exports},a58f:function(t,e,n){"use strict";n("ab45")},ab45:function(t,e,n){},ab9e:function(t,e,n){"use strict";n("2caf");e["a"]={computed:{dataList:function(){var t=this.controlData;return Array.isArray(t.data)?t.data:this.originData&&this.originData.length?this.originData:this.defaultDataList}},methods:{getDataList:function(){var t=this,e=this.controlData;if(Array.isArray(e.data)||!e.codeItem)return this.originData=[];this.$httpPost(window.formDesignerActions.getControlDataListUrl,{controlData:this.controlData}).then((function(e){if(!Array.isArray(e))throw new Error("获取控件数据出错!");t.originData=e})).catch((function(e){t.originData=[],console.error(e)}))}},watch:{"controlData.codeItem":function(t){t&&this.getDataList()}}}},adb5:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a}));var o=n("53ca");n("456d"),n("ac6a"),n("f3e2");function i(t){return t.custom&&(t=t.custom,"string"==typeof t&&(t=JSON.parse(t))),t}function r(t,e,n){return new Promise((function(o,r){var a=new XMLHttpRequest;a.onreadystatechange=function(){if(a.readyState===XMLHttpRequest.DONE)if(200===a.status)try{o(e?a.responseText:i(JSON.parse(a.responseText)))}catch(t){console.error(t),o(a.responseText)}else r("There was a problem with the request.")},a.open("GET",t),n&&Object.keys(n).forEach((function(t){a.setRequestHeader(t,n[t])})),a.send()}))}function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return new Promise((function(r,a){var l=new XMLHttpRequest;l.onreadystatechange=function(){if(l.readyState===XMLHttpRequest.DONE)if(200===l.status)try{r(i(JSON.parse(l.responseText)))}catch(t){console.error(t),r(l.responseText)}else a({state:l.status})},l.open("POST",t),l.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8"),n&&Object.keys(n).forEach((function(t){l.setRequestHeader(t,n[t])}));var s=new URLSearchParams;for(var c in e)s.append(c,"object"==Object(o["a"])(e[c])?JSON.stringify(e[c]):e[c]);l.send(s)}))}},ae24:function(t,e,n){},aeeb:function(t,e,n){"use strict";n("529d")},af23:function(t,e,n){},b020:function(t,e,n){"use strict";n("81ec")},b0c7:function(t,e,n){},b2ce:function(t,e,n){"use strict";n("cd52")},b8b5:function(t,e,n){"use strict";n("ae24")},bc50:function(t,e,n){},bc87:function(t,e,n){"use strict";n("279b")},bec5:function(t,e,n){"use strict";n("5bdd")},c0a5:function(t,e,n){"use strict";n("bc50")},c131:function(t,e,n){"use strict";n("690b")},c28b:function(t,e,n){},caff:function(t,e,n){"use strict";n("3552")},cd52:function(t,e,n){},ce0a:function(t,e,n){},d3d4:function(t,e,n){},d482:function(t,e,n){"use strict";n("af23")},d56b:function(t,e,n){"use strict";n("d3d4")},d5bd:function(t,e,n){},d5c7:function(t,e,n){"use strict";n("9cb4")},d718:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",{staticClass:"label",class:{"design-form-label":t.asControl,"design-control-holder":!t.asControl,colons:t.autoColons,required:t.controlData.showStar},style:t.styleText,attrs:{title:t.controlData.labelText||""},domProps:{innerHTML:t._s(t.contentHtml)}})},i=[],r=(n("7f7f"),n("a481"),{methods:{lineFeed:function(t){return t&&t+""===t?t.replace(/\\n/g,"<br>").replace(/ /g,"&nbsp;"):""}}}),a={name:"placeholder-label",props:{controlData:{type:Object,default:function(){return{}}},asControl:{type:Boolean,default:!1}},mixins:[r],computed:{contentHtml:function(){var t=this.controlData.labelText||this.controlData.name,e=this.controlData.hideColon;return this.lineFeed(t)+(this.autoColons&&!e?"：":"")},autoColons:function(){return this.$store.state.globalStyle.autoColons},styleText:function(){var t=this.controlData,e=t.fontSize,n=t.fontFamily,o=t.fontColor,i=t.fontBolder,r=t.fontItalic,a=t.fontUnderline,l=t.textAlign,s=t.verticalAlign,c=[];return c.push("font-size:".concat(e,"px")),c.push("font-family:".concat(n)),c.push("color:".concat(o)),c.push("font-weight:".concat(i?"bold":"normal")),c.push("font-style:".concat(r?"italic":"normal")),c.push("text-decoration:".concat(a?"underline":"none")),c.push("text-align:".concat(l||"")),c.push("vertical-align:".concat(s||"")),c.join(";")}},data:function(){return{}}},l=a,s=n("2877"),c=Object(s["a"])(l,o,i,!1,null,null,null);e["a"]=c.exports},d87d:function(t,e,n){},dd1c:function(t,e,n){},e06a:function(t,e,n){"use strict";n("8feb")},e4ac:function(t,e,n){"use strict";n("4277")},eafa:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("draggable",{staticClass:"dropArea layout",class:"level-"+t.level,attrs:{group:"layout",swapThreshold:.3,delay:0,list:t.list,move:t.checkLayoutMove,filter:".col-helper-line",preventOnFilter:!1,disabled:!1},on:{change:t.onLayoutChange,start:t.onLayoutDragStart,end:t.onLayoutDragEnd,choose:t.onDragChoose}},t._l(t.list,(function(e,o){return n("Row",{key:e.id,attrs:{level:t.level,row:e,index:o,"parent-col":t.parentCol,"is-last-row":o==t.list.length-1,"prev-row":0==o?null:t.list[o-1]}})})),1)},i=[],r=(n("1c01"),n("58b2"),n("8e6e"),n("f3e2"),n("d25f"),n("ac6a"),n("456d"),n("0cd8"),n("7f7f"),n("ade3")),a=(n("c5f6"),n("2f62")),l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"row",class:t.className,style:t.style,attrs:{"row-id":t.row.id,"data-name":t.row.name,"data-level":t.level}},[t._l(t.row.cols,(function(e,o){return n("ColLayout",{key:e.id,attrs:{"is-last-row":t.isLastRow,index:o,col:e,row:t.row,level:t.level,"row-index":t.index},on:{"on-context-menu":function(n){return t.onContextmenu(n,{row:t.row,rowIndex:t.index,parentCol:t.parentCol,col:e,colIndex:o,colDeletable:!!t.row.cols.length})}}})})),n("div",{staticClass:"row-helper"},[n("el-tooltip",{attrs:{placement:"top",enterable:!1,"open-delay":300,content:"移除行"}},[n("span",{staticClass:"row-helper-btn remove el-icon-delete",on:{click:function(e){return e.stopPropagation(),t.handleRowRemove(t.row,t.index)}}})]),n("el-tooltip",{attrs:{placement:"top",enterable:!1,"open-delay":300,content:"复制行"}},[n("span",{staticClass:"row-helper-btn copy el-icon-copy-document",on:{click:function(e){return t.handleRowCopy(t.row,t.index,t.parentCol)}}})]),n("el-tooltip",{attrs:{placement:"top",enterable:!1,"open-delay":300,content:"选择"}},[n("span",{staticClass:"row-helper-btn selected el-icon-top-left",on:{click:function(e){return e.stopPropagation(),t.handleRowSelect(t.row.id)}}})])],1)],2)},s=[],c=(n("2caf"),n("ac4d"),n("8a81"),n("5df3"),n("1c4c"),n("6b54"),n("87b3"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.hideTables.indexOf(t.col.id)<0?n("div",{staticClass:"col",class:t.getColCls(t.col,t.index,t.row.cols.length),style:t.colStyle,attrs:{id:t.col.id,name:t.col.name},on:{click:function(e){return e.stopPropagation(),t.handleColClick(t.index,t.col,e)},contextmenu:function(e){return e.stopPropagation(),e.preventDefault(),t.onContextMenu(e)}}},["acc-item"==t.type?n("h2",{staticClass:"acc-item-header",class:{closed:!t.col.props.opened}},[n("span",{staticClass:"acc-item-index"},[t._v(t._s(t.getAccItemIndex(t.index)))]),n("span",{staticClass:"acc-item-title"},[t._v(t._s(t.col.props.title))]),n("span",{staticClass:"acc-item-toggle",on:{click:t.toggleAccItem}})]):t._e(),t.showNested?n("RowLayout",{directives:[{name:"show",rawName:"v-show",value:"acc-item"==t.type||t.col.subs&&t.col.subs.length||t.inLayoutDragging,expression:"type == 'acc-item' || (col.subs && col.subs.length) || inLayoutDragging"}],attrs:{list:t.col.subs,level:t.levelNext,parentCol:t.col,parentRow:t.row}}):t._e(),t.showControlContainer?n("draggable",{staticClass:"dropArea controls",class:{active:t.col.controls.length||t.inControlDragging},attrs:{group:"control",list:t.col.controls,draggable:".design-control",swapThreshold:1,invertedSwapThreshold:1,invertSwap:!1,direction:"vertical",move:t.checkControlMove},on:{start:t.onControlDragStart,end:t.onControlDragEnd,add:function(e){return t.onControlAdd(e,{col:t.col,colIndex:t.index,row:t.row})}}},t._l(t.col.controls,(function(e){return n("Control",{key:e.id,class:{selected:e.id==t.selectedControlId},staticStyle:{display:"inline-block"},attrs:{"control-data":e},nativeOn:{click:function(n){return n.stopPropagation(),t.onControlClick(e.id)}}})})),1):t._e(),t.showXResizer?n("div",{staticClass:"col-helper-line line-v",attrs:{"data-row-index":t.rowIndex,"data-col-index":t.index,"data-level":t.level}}):t._e(),t.showYResizer?n("div",{staticClass:"col-helper-line line-h",attrs:{"data-row-index":t.rowIndex,"data-col-index":t.index}}):t._e()],1):t._e()}),u=[],d=(n("28a5"),n("386d"),n("a3de")),f={methods:{closestComponent:function(t,e){var n=e||this,o=n.$parent||n.$root;if(t+""===t){var i=o.$options.name;while(o&&(!i||i!==t))o=o.$parent,o&&(i=o.$options.name)}else while(o&&!t(o))o=o.$parent;return o}}};function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function p(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m=new URLSearchParams(location.search),g=m.get("hideTables")||"",v={name:"ColLayout",components:{RowLayout:function(){return Promise.resolve().then(n.bind(null,"eafa"))},Control:d["a"]},data:function(){return{hideTables:[]}},mixins:[f],props:{row:{type:Object,required:!0},rowIndex:{type:Number,required:!0},col:{type:Object,required:!0},index:{type:Number,required:!0},level:{type:Number,required:!0},isLastRow:{type:Boolean,required:!0}},created:function(){this.hideTables=g.split(",")},computed:p(p(p({},Object(a["e"])(["globalStyle","selectedColId","selectedControlId"])),Object(a["c"])(["inControlDragging","inLayoutDragging"])),{},{showNested:function(){return"col-item"!==this.type||!this.col.controls.length&&1!=this.row.cols.length},type:function(){var t=this.col;return t&&t.type?t.type:"col-item"},showControlContainer:function(){return"col-item"==this.type&&(!this.col.subs||!this.col.subs.length)},levelNext:function(){return this.level+1},colStyle:function(){var t=this.col.style.width,e=t+""===t?t:"".concat(t,"px");return{width:e}},showXResizer:function(){return"acc-item"!=this.type&&this.index!==this.row.cols.length-1},showYResizer:function(){if("acc-item"==this.type)return!1;if(1==this.level&&"col-item"==this.type){var t=this.closestComponent("ColLayout",this.$parent);if(t&&"acc-item"==t.type)return!0}return 0===this.level||!this.isLastRow}}),methods:p(p({},Object(a["b"])(["setSelectedControl","activeRightTab","setSelectedCol"])),{},{getColCls:function(t,e,n){var o,i=this.globalStyle,a=t.subs.length,l=t.style,s=(o={selected:this.selectedColId==t.id,isSub:!a,hasSub:a},Object(r["a"])(o,"text-"+(l.textAlign||i.textAlign),!0),Object(r["a"])(o,"vertical-"+(l.verticalAlign||i.verticalAlign),!0),o);return s[this.type]=!0,"col-item"==this.type&&(s.first=0===e,s.mid=e&&e!==n-1,s.last=e===n-1),s},handleColClick:function(t,e,n){var o=n.target;if(!o.classList.contains("col-helper-line")){var i=o.closest(".col");if(i){var r=e.id==this.selectedColId;r?this.setSelectedCol({id:""}):(this.setSelectedCol({id:e.id}),this.activeRightTab("cell"))}}},onControlDragStart:function(){this.controlDragStart()},onControlDragEnd:function(t){this.controlDragEnd()},onControlAdd:function(t,e){var n=e.col.controls&&e.col.controls[t.newIndex];if(n&&n.id&&this.onControlClick(n.id),t.from.classList.contains("control-drag-area")){var o=t.item.dataset.controlType;if("title"==o||"label"==o||"subtable"==o)return;var i=e.row,r=e.colIndex,a=i.cols[r-1];if(!a)return;var l=!a.controls.length&&!a.subs.length;if(l){var s=t.item.dataset.name||"";this.$store.dispatch("autoAddLabel",{parentCol:a,prevName:s})}}},checkControlMove:function(t){if(t.to.classList.contains("design-hidden-area"))return!1},onControlClick:function(t){var e=this;this.setSelectedControl({id:t}),this.activeRightTab("control"),setTimeout((function(){e.$bus.$emit("cntrolClick")}),100)},onContextMenu:function(t){var e;(e=console).log.apply(e,arguments),this.$emit("on-context-menu",t)},getAccItemIndex:function(t){var e=t+1;return e<10?"0"+e:e},toggleAccItem:function(t){t.stopPropagation();var e=t.target.closest(".acc-item-header");e&&e.classList.toggle("closed")}})},b=v,y=n("2877"),C=Object(y["a"])(b,c,u,!1,null,null,null),w=C.exports,x=n("4260"),O=n("42a0"),D=n.n(O),_={methods:{onContextmenu:function(t,e){var n=t.target;(1==e.row.cols.length||2===e.row.cols.length&&e.parentCol)&&(e.colDeletable=!1);var o=n.closest(".design-control");if(o){for(var i,r,a,l=o.dataset.id,s=0,c=e.col.controls.length;s<c;s++)if(a=e.col.controls[s],a.id==l){i=s,r=a;break}r&&(e.control=r,e.controlIndex=i)}this.$data._ctxMenuData=e,this.showCtxMenu(t,e,this.handleContextMenu)},handleContextMenu:function(t){var e=this.$data._ctxMenuData;switch(t){case"deleteControl":this.deleteControl({selectedControl:e.control,selectedControlParentCol:e.col,selectedControlIndex:e.controlIndex});break;case"removeCol":this.removeCol({col:e.col,parentRow:e.row,colIndex:e.colIndex});break;case"removeRow":this.handleRowRemove(e.row,e.rowIndex);break;case"insertRowUp":this.copyRow({aimIndex:e.rowIndex,parentCol:e.parentCol,newRow:this.getRowCopyData(e.row,!0),shuttle:!0});break;case"insertRowDown":this.copyRow({aimIndex:e.rowIndex+1,parentCol:e.parentCol,newRow:this.getRowCopyData(e.row,!0),shuttle:!0});break;case"insertColLeft":this.splitCol({col:e.col,colIndex:e.colIndex,parentRow:e.row,direction:"left",shuttle:!0});break;case"insertColRight":this.splitCol({col:e.col,colIndex:e.colIndex,parentRow:e.row,direction:"right",shuttle:!0});break;default:break}}}};function k(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=S(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,r=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw r}}}}function S(t,e){if(t){if("string"===typeof t)return j(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(t,e):void 0}}function j(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function T(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function I(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?T(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var E={name:"Row",components:{ColLayout:w},inject:{showCtxMenu:"showCtxMenu"},props:{row:{type:Object},index:{type:Number},level:{type:Number},parentCol:{type:Object,default:null},isLastRow:{type:Boolean},prevRow:{type:Object,default:null}},computed:I(I({},Object(a["e"])(["selectedRowId"])),{},{type:function(){var t=this.row;return t&&t.type?t.type:"row-layout"},style:function(){var t=this.row.height,e=t+""===t?t:t+"px",n={};return"acc-layout"==this.type&&(n.marginTop="16px",n.marginBottom="16px"),"row-layout"==this.type&&(n["min-height"]=e),n},className:function(){var t,e=this.type,n=(t={},Object(r["a"])(t,e,!0),Object(r["a"])(t,"isTop",0==this.level),Object(r["a"])(t,"selected",this.selectedRowId==this.row.id),t);return"acc-layout"==e||(0===this.index||this.prevRow&&this.prevRow.type&&"row-layout"!=this.prevRow.type?n.first=!0:n.mid=!0),n}}),mixins:[_],data:function(){return{_ctxMenuData:null}},methods:I(I(I({},Object(a["d"])(["copyRow","splitCol"])),Object(a["b"])(["setSelectedLayout","deleteRow","activeRightTab","deleteControl"])),{},{handleRowSelect:function(t){this.setSelectedLayout({id:t}),this.activeRightTab("control")},handleRowCopy:function(t,e,n){var o=this.getRowCopyData(t);this.copyRow({aimIndex:e+1,parentCol:n,newRow:o,shuttle:!0})},getRowCopyData:function(t,e){var n=Object(x["d"])(t);return o(n),n;function o(t){var n=Object(x["l"])(),r=t.namePrefix||t.name;t.id=n,t.autoIndex=x["j"].getIndex(r),t.name&&(t.name="".concat(t.name,"_").concat(t.autoIndex)),t.cols.forEach((function(t){t.id="col-".concat(n,"-").concat(x["b"].getIndex(n)),t.subs&&t.subs.forEach(o),e?t.controls=[]:t.controls.forEach(i)}))}function i(t){var e=t.type,n=window.FORM_DESIGN_CONFIG.controls[e];if(!n)throw new Error("控件的 ".concat(e," 配置信息不存在，无法创建"));var o=Object(x["d"])(n);delete o.configItems,delete o.name,delete o.width,delete o.id,delete o.type,"label"!=e&&"title"!=e&&D()(t,o);var i=x["c"].getIndex(e);t.id=e+"-"+i,t.autoIndex=i,t.name&&(t.name="".concat(t.name,"_").concat(i))}},handleRowRemove:function(t,e){var n=this;if(this.isEmptyRow(t))return this.doRowRemove(t,e);this.$confirm("此操作将移除此行，以及此行内的所有内容，是否确认？"," 删除提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n.doRowRemove(t,e)})).catch((function(){}))},doRowRemove:function(t,e){this.parentCol,this.deleteRow({parentCol:this.parentCol,row:t,index:e})},isEmptyRow:function(t){var e,n=k(t.cols);try{for(n.s();!(e=n.n()).done;){var o=e.value;if(o.subs.length||o.controls.length)return!1}}catch(i){n.e(i)}finally{n.f()}return!0},removeCol:function(t){var e=this,n=t.col,o=t.parentRow,i=t.colIndex;if(this.isEmptyCol(n))return this.doColRemove(n,o,i);this.$confirm("删除后此单元格内的所有内容将一并删除，是否继续？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.doColRemove(n,o,i)})).catch((function(t){t&&console.error(t)}))},doColRemove:function(t,e,n){this.$store.dispatch("removeCol",{col:t,parentRow:e,colIndex:n,shuttle:!0})},isEmptyCol:function(t){return!(t.subs.length||t.controls.length)}})},P=E,L=(n("c131"),Object(y["a"])(P,l,s,!1,null,null,null)),A=L.exports,$=n("84a2"),F=n.n($),M=(n("f400"),n("4f7f"),n("2909")),N=(n("6d67"),{methods:{onMouseDown:function(t){var e=t.target;if(!e.classList.contains("col-helper-line"))return!0;window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp);var n=this.rowEl=e.closest(".row"),o=this.colEl=e.closest(".col");this.rowId=n&&n.getAttribute("row-id"),this.rowData=this.findRow(this.rowId),this.startHeight=this.rowData.height||30;var i=this.getDesignContainer(),r=i.getBoundingClientRect();this.mouseOffset=this.getMouseOffset(t),this.stagElementsOffset(t,r);var a=parseInt(e.dataset.colIndex,10);this.colData=this.rowData.cols[a],this.nextColData=this.rowData.cols[a+1],this.colData.width+""===this.colData.width?this.startWidth=o.getBoundingClientRect().width:this.startWidth=this.colData.style.width,this.rowId,this.inMoving=!0,e.classList.contains("line-v")?(this.getXLimit(t,r),this.resizeMode="v",this.startOffsetX=this.getXOffset(t),this.updateLineLeft(this.startOffsetX),this.showVLine()):e.classList.contains("line-h")&&(this.getYLimit(t,r),this.resizeMode="h",this.startOffsetY=this.getYOffset(t),this.updateLineTop(this.startOffsetY),this.showHLine())},onMouseMove:function(t){if("h"==this.resizeMode){var e=this.getYOffset(t);e=Object(x["a"])(e,this.moveRange.y[0],this.moveRange.y[1]),this.updateLineTop(e);var n=e-this.startOffsetY,o=this.startHeight+n;o<30&&(o=30),this.updateRowHeight({rowId:this.rowId,height:o,row:this.rowData,parentRowPath:this.pathMap[this.rowId],shuttle:!0})}else if("v"==this.resizeMode){var i=this.getXOffset(t);i=Object(x["a"])(i,this.moveRange.x[0],this.moveRange.x[1]);var r=this.getSnapOffset(i);r&&(i=r),this.updateLineLeft(i);var a=i-this.startOffsetX,l=this.startWidth+a;l<10&&(l=10),this.updateColWidth({col:this.colData,width:l,nextCol:this.nextColData,shuttle:!0})}},getXLimit:function(t,e){var n,o,i=30;function r(t,e){if(!t.subs||!t.subs.length)return t.style.width;var n=t.subs.map((function(t){return r(t.cols["first"==e?0:t.cols.length-1])}));return Math.min.apply(Math,Object(M["a"])(n))}this.colData?(n=r(this.colData,"last"),n=n<i?0:n-i):n=0,this.nextColData?(o=r(this.nextColData,"first"),o=o<i?0:o-i):o=0,n=t.pageX-e.left-this.mouseOffset.x-n,o=t.pageX-e.left-this.mouseOffset.x+o,this.moveRange.x=[n,o]},getYLimit:function(t,e){var n,o,i=38,r=a(this.rowData)||i;return n=r-i,n<0&&(n=0),n=t.pageY-e.top-this.mouseOffset.y-n,o=1/0,this.moveRange.y=[n,o],[n,o];function a(t){var e=!1,n=[];return t.cols.forEach((function(t){t.subs&&t.subs.length&&(e=!0,n.push(a(t.subs[t.subs.length-1])))})),t.height,e?Math.min.apply(Math,n):t.height}},getLimitedOffset:function(){},getYOffset:function(t){var e=this.getDesignContainer(),n=e.getBoundingClientRect(),o=t.pageY-n.top-this.mouseOffset.y;return o},getXOffset:function(t){var e=this.getDesignContainer(),n=e.getBoundingClientRect(),o=t.pageX-n.left-this.mouseOffset.x;return o},getMouseOffset:function(t){var e=t.target,n=e.getBoundingClientRect();return{x:t.pageX-n.left-n.width/2,y:t.pageY-n.top-n.height/2}},stagElementsOffset:function(t,e){var n=this.getDesignContainer(),o=t.target.closest("col"),i=[].slice.call(n.querySelectorAll(".col.isSub")),r=[];i.forEach((function(t){if(!t.classList.contains("last")&&t!=o){var n=t.getBoundingClientRect(),i=n.left+n.width-e.left;r.push(i)}})),this.otherColOffSets=Array.from(new Set(r)),this.otherColOffSets},getSnapOffset:function(t){var e=new Map;return this.otherColOffSets.forEach((function(n){var o=Math.abs(t-n);o<=10&&e.set(o,n)})),!!e.size&&e.get(Math.min.apply(Math,Object(M["a"])(e.keys())))},onMouseUp:function(){this.hideHLine(),this.hideVLine(),this.resetMoveData(),this.removeEventListener()},resetMoveData:function(){this.inMoving=!1,this.rowEl=null,this.colEl=null,this.rowId="",this.rowData=null,this.colData=null,this.nextColData=null,this.startOffsetX=0,this.startOffsetY=0,this.mouseOffset.x=0,this.mouseOffset.y=0,this.moveRange.x=[0,0],this.moveRange.y=[0,0],this.otherColOffSets=[],this.startHeight=0,this.startWidth=0,this.resizeMode=!1},removeEventListener:function(){window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp)}}});function R(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function V(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?R(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var z={name:"row-layout",inject:{getDesignContainer:{default:function(){return document.getElementById("design-area")}},showCtxMenu:"showCtxMenu",showMutliRowConfirm:"showMutliRowConfirm"},mixins:[N],props:{list:{type:Array,default:function(){return[]}},level:{type:Number,default:0},parentCol:{type:Object,default:null},parentRow:{type:Object,default:null}},data:function(){return{inMoving:!1,rowEl:null,colEl:null,rowId:"",rowData:null,colData:null,nextColData:null,startOffsetX:0,startOffsetY:0,mouseOffset:{x:0,y:0},moveRange:{x:[0,0],y:[0,0]},otherColOffSets:[],startHeight:0,startWidth:0,resizeMode:!1}},mounted:function(){0===this.level&&this.$el.addEventListener("mousedown",this.onMouseDown)},components:{Row:A},computed:V(V({},Object(a["e"])(["formSize"])),{},{levelNext:function(){return this.level+1},dataMap:function(){return this.$store.getters.rowDataMap},pathMap:function(){return this.$store.getters.subRowPathMap}}),methods:V(V(V({},Object(a["d"])(["updateLineTop","updateLineLeft","showHLine","hideHLine","showVLine","hideVLine","updateRowHeight","updateColWidth","layoutDragStart","layoutDragEnd","controlDragStart","controlDragEnd"])),Object(a["b"])(["setSelectedControl","setSelectedCol","setSelectedLayout","deleteRow","deleteControl","activeRightTab"])),{},{throttle:F()((function(t,e){t.name,t(e)}),20,{leading:!0,trailing:!1}),checkLayoutMove:function(t){var e=t.draggedContext.element;return!(1==e.cols.length&&!t.to.classList.contains("level-0"))&&(!("acc-layout"==e.type&&!t.to.classList.contains("level-0"))&&void 0)},checkControlMove:function(t){if(t.to.classList.contains("design-hidden-area"))return!1},onLayoutChange:function(t){var e=this;if(t.added){var n=t.added.element,o=this.parentCol;if(this.parentCol,n.asMulti)return this.showMutliRowConfirm((function(i,r){if(o&&1==i&&1==r)return e.$store.dispatch({type:"deleteRow",parentCol:e.parentCol,row:n,index:t.added.newIndex,shuttle:!1}),e.$message({type:"error",message:"单行单列不能被嵌套在单元格中"});e.$store.commit("replaceToMulti",{row:n,rowIndex:t.added.newIndex,rowCount:i,colCount:r,parentCol:o,shuttle:!0})}));if("acc-layout"==n.type)return this.$store.commit({type:"tryMergeAcc",row:n,rowIndex:t.added.newIndex});if(this.handleColWidthChange(n),this.parentCol){var i=this.pathMap[n.id],r=i[0],a=r.height,l=this.parentCol.subs.reduce((function(t,e){return t+e.height}),0),s=a-l;s<=0?this.updateRowHeight({rowId:r.id,row:r,height:l,bubble:!0,rowPath:this.pathMap[r.id],shuttle:!0,group:"adjust"}):this.updateRowHeight({rowId:n.id,height:n.height+s,row:n,bubble:!1,shuttle:!0,group:"adjust"})}}if(t.removed&&this.parentCol&&this.parentRow){var c=this.parentCol.subs,u=this.parentRow.height,d=c.reduce((function(t,e){return t+e.height}),0),f=c[c.length-1],h=f.height+(u-d);h&&this.updateRowHeight({rowId:f.id,row:f,height:h,bubble:!1,shuttle:!0,group:"adjust"})}},handleColWidthChange:function(t){if("acc-layout"!=t.type){var e=this.parentCol?this.parentCol.style.width:this.formSize.width,n=t.cols.reduce((function(t,e){return t+e.style.width}),0),o=e/n;isNaN(o)&&(o=1),this.$store.commit({type:"updateRowColWidth",rowId:t.id,row:t,ratio:o,shuttle:!0,group:"adjust"})}},onLayoutDragStart:function(){this.layoutDragStart()},onLayoutDragEnd:function(){this.layoutDragEnd()},onControlDragStart:function(){this.controlDragStart()},onControlDragEnd:function(t){this.controlDragEnd()},onDragChoose:function(){},findRow:function(t){var e=this.dataMap[t];return e?e.row:null}}),beforeDestroy:function(){this.$el.removeEventListener("mousedown",this.onMouseDown)}},B=z,U=(n("0015"),Object(y["a"])(B,o,i,!1,null,null,null));e["default"]=U.exports},ec83:function(t,e,n){"use strict";n("c28b")},f1a3:function(t,e,n){"use strict";n("b0c7")},f5bd:function(t,e,n){"use strict";n("ce0a")},ff06:function(t,e,n){}});