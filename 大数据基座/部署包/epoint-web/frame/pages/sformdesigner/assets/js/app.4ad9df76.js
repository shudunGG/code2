(function(t){function e(e){for(var n,i,l=e[0],a=e[1],c=e[2],d=0,u=[];d<l.length;d++)i=l[d],Object.prototype.hasOwnProperty.call(s,i)&&s[i]&&u.push(s[i][0]),s[i]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n]);h&&h(e);while(u.length)u.shift()();return r.push.apply(r,c||[]),o()}function o(){for(var t,e=0;e<r.length;e++){for(var o=r[e],n=!0,i=1;i<o.length;i++){var l=o[i];0!==s[l]&&(n=!1)}n&&(r.splice(e--,1),t=a(a.s=o[0]))}return t}var n={},i={app:0},s={app:0},r=[];function l(t){return a.p+"assets/js/"+({}[t]||t)+"."+{"chunk-16a1e32a":"5123b560"}[t]+".js"}function a(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,a),o.l=!0,o.exports}a.e=function(t){var e=[],o={"chunk-16a1e32a":1};i[t]?e.push(i[t]):0!==i[t]&&o[t]&&e.push(i[t]=new Promise((function(e,o){for(var n="assets/css/"+({}[t]||t)+"."+{"chunk-16a1e32a":"9bfcac0d"}[t]+".css",s=a.p+n,r=document.getElementsByTagName("link"),l=0;l<r.length;l++){var c=r[l],d=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(d===n||d===s))return e()}var u=document.getElementsByTagName("style");for(l=0;l<u.length;l++){c=u[l],d=c.getAttribute("data-href");if(d===n||d===s)return e()}var h=document.createElement("link");h.rel="stylesheet",h.type="text/css",h.onload=e,h.onerror=function(e){var n=e&&e.target&&e.target.src||s,r=new Error("Loading CSS chunk "+t+" failed.\n("+n+")");r.code="CSS_CHUNK_LOAD_FAILED",r.request=n,delete i[t],h.parentNode.removeChild(h),o(r)},h.href=s;var p=document.getElementsByTagName("head")[0];p.appendChild(h)})).then((function(){i[t]=0})));var n=s[t];if(0!==n)if(n)e.push(n[2]);else{var r=new Promise((function(e,o){n=s[t]=[e,o]}));e.push(n[2]=r);var c,d=document.createElement("script");d.charset="utf-8",d.timeout=120,a.nc&&d.setAttribute("nonce",a.nc),d.src=l(t);var u=new Error;c=function(e){d.onerror=d.onload=null,clearTimeout(h);var o=s[t];if(0!==o){if(o){var n=e&&("load"===e.type?"missing":e.type),i=e&&e.target&&e.target.src;u.message="Loading chunk "+t+" failed.\n("+n+": "+i+")",u.name="ChunkLoadError",u.type=n,u.request=i,o[1](u)}s[t]=void 0}};var h=setTimeout((function(){c({type:"timeout",target:d})}),12e4);d.onerror=d.onload=c,document.head.appendChild(d)}return Promise.all(e)},a.m=t,a.c=n,a.d=function(t,e,o){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)a.d(o,n,function(e){return t[e]}.bind(null,n));return o},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],d=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var h=d;r.push([0,"chunk-vendors"]),o()})({0:function(t,e,o){t.exports=o("56d7")},"0015":function(t,e,o){"use strict";o("8e39")},"026d":function(t,e,o){"use strict";o("dd1c")},"034f":function(t,e,o){"use strict";o("64a9")},"13f1":function(t,e,o){"use strict";o("7e28")},"165c":function(t,e,o){"use strict";o("46c9")},"1f0e":function(t,e,o){"use strict";o("4e92")},"20fd":function(t,e,o){"use strict";o("d5bd")},"250c":function(t,e,o){},"25cd":function(t,e,o){"use strict";o("9836")},"279b":function(t,e,o){},"2e74":function(t,e,o){"use strict";o("89c5")},"2fe4":function(t,e,o){},3176:function(t,e,o){"use strict";o("592a")},"31ec":function(t,e,o){},3552:function(t,e,o){},4260:function(t,e,o){"use strict";o.d(e,"l",(function(){return i})),o.d(e,"g",(function(){return s})),o.d(e,"k",(function(){return r})),o.d(e,"d",(function(){return a})),o.d(e,"i",(function(){return c["b"]})),o.d(e,"h",(function(){return d})),o.d(e,"a",(function(){return f})),o.d(e,"c",(function(){return h["b"]})),o.d(e,"b",(function(){return h["a"]})),o.d(e,"j",(function(){return h["d"]})),o.d(e,"f",(function(){return p})),o.d(e,"e",(function(){return m}));o("ac6a"),o("6b54");function n(){var t=+new Date,e=1e9*(1e4*Math.random()>>>0);const o=(e+t).toString(32);return n._store[o]?n():(n._store[o]=!0,o)}n._store={},n.adapt=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t=>t.id;const o=n._store;Array.isArray(t)&&t.forEach(t=>{const n=e(t);o[n]?console.warn("id duplicated",t.id):o[n]=n})};var i=n;o("28a5");function s(t,e){const o=e.split(".");if(1===o.length)return t[e];let n,i=0,s=t,r=o.length;while(1){if(i==r-1)return s[o[i]];if(n=s[o[i]],!n||"object"!=typeof n)return console.error("无法获取嵌套属性 at "+o[i],t,e),null;s=n,i++}}function r(t,e,o){const n=e.split(".");if(1===n.length)return t[e]=o;let i,s=0,r=t,l=n.length-1;do{i=r[n[s]],i&&"object"==typeof i?r=i:console.error("无法设置嵌套属性 at "+n[s],t,e),s++}while(s<l);return r.hasOwnProperty(n[s])||console.warn("设置原来没有的属性："+n[s]+" at ",r),r[n[s]]=o}function l(t){return JSON.parse(JSON.stringify(t))}var a=l,c=o("adb5");function d(t){const e=document.createElement("div");return e.appendChild(document.createTextNode(t)),e.innerHTML}function u(t){const e=document.createElement("div");return e.innerHTML=t,e.innerText}var h=o("9827");function p(t){return window.encodeURIComponent(window.btoa(window.encodeURIComponent(t)))}function m(t){return window.decodeURIComponent(window.atob(window.decodeURIComponent(t)))}function f(t,e,o){var n=t-e,i=o-t;return n>=0&&i>=0?t:Math.abs(n)>=Math.abs(i)?o:e}c["a"],c["b"],h["b"],h["a"]},4277:function(t,e,o){},"46c9":function(t,e,o){},"472d":function(t,e,o){},"4e92":function(t,e,o){},"529d":function(t,e,o){},5389:function(t,e,o){},5443:function(t,e,o){"use strict";o("2fe4")},"56d7":function(t,e,o){"use strict";o.r(e);o("f4f9"),o("450d");var n=o("c2cc"),i=o.n(n),s=(o("7a0f"),o("0f6c")),r=o.n(s),l=(o("bd49"),o("18ff")),a=o.n(l),c=(o("960d"),o("defb")),d=o.n(c),u=(o("cb70"),o("b370")),h=o.n(u),p=(o("cbb5"),o("8bbc")),m=o.n(p),f=(o("826b"),o("c263")),g=o.n(f),b=(o("a7cc"),o("df33")),y=o.n(b),v=(o("0c67"),o("299c")),C=o.n(v),w=(o("eca7"),o("3787")),x=o.n(w),D=(o("ae26"),o("845f")),O=o.n(D),_=(o("1951"),o("eedf")),k=o.n(_),S=(o("e960"),o("b35b")),T=o.n(S),j=(o("016f"),o("486c")),$=o.n(j),I=(o("1f1a"),o("4e4b")),P=o.n(I),E=(o("9d4c"),o("e450")),L=o.n(E),A=(o("fe07"),o("6ac5")),M=o.n(A),F=(o("b5d8"),o("f494")),R=o.n(F),N=(o("d4df"),o("7fc1")),V=o.n(N),B=(o("560b"),o("dcdc")),z=o.n(B),H=(o("10cb"),o("f3ad")),G=o.n(H),q=(o("9e1f"),o("6ed5")),W=o.n(q),U=(o("0fb7"),o("f529")),J=o.n(U),Y=(o("6611"),o("e772")),X=o.n(Y),K=(o("425f"),o("4105")),Q=o.n(K),Z=o("a026"),tt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{style:"height:"+t.height+"px",attrs:{id:"app"}},[o("Main")],1)},et=[],ot=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"design-container"},[o("Header",{ref:"header",attrs:{"in-preview":t.showPreview,formTitle:t.formTitle},on:{"save-click":function(e){return t.saveToServer()},"drop-item-click":t.handleCommand}}),t.showPreview?o("Preview",{attrs:{tableGuid:t.tableGuid,designId:t.designId,type:t.viewType}}):t._e(),t.showPreview?t._e():o("div",{staticClass:"design-body",class:{narrow:t.narrowMode,"view-pc":"pc"===t.viewType,"view-mobile":"mobile"===t.viewType}},[o("div",{staticClass:"design-leftbar"},[o("Tabs",{attrs:{value:t.leftActiveTab},on:{input:t.activeLeftTab}},[o("TabPanel",{attrs:{label:"布局",name:"layout",disabled:"mobile"===t.viewType}},[o("PanelLayout")],1),o("TabPanel",{attrs:{label:"控件",name:"control",disabled:"mobile"===t.viewType}},[o("PanelControl")],1),o("TabPanel",{attrs:{label:"数据域",name:"data"}},[o("PanelData")],1)],1)],1),o("div",{staticClass:"design-view-container",class:{"view-real":!t.viewDesign,"view-design":t.viewDesign}},[t.dataLoaded?o("Design",{directives:[{name:"show",rawName:"v-show",value:"pc"===t.viewType,expression:"viewType === 'pc'"}],attrs:{data:t.design,size:t.formSize}}):t._e(),t.dataLoaded&&"mobile"===t.viewType?o("MobileDesign"):t._e()],1),o("div",{staticClass:"design-rightbar",class:{pickup:t.narrowMode&&t.rightbarHidden}},[t.narrowMode&&"pc"===t.viewType?o("el-button",{staticClass:"design-rightbar-toggle",attrs:{icon:"el-icon-d-arrow-right",plain:""},on:{click:function(e){t.rightbarHidden=!t.rightbarHidden}}}):t._e(),o("Tabs",{attrs:{"default-active":"form",value:t.rightActiveTab},on:{input:t.activeRightTab}},[o("TabPanel",{attrs:{label:"表单设置",name:"form",disabled:"mobile"===t.viewType}},[t.dataLoaded?o("ConfigForm"):t._e()],1),o("TabPanel",{attrs:{label:"组件设置",name:"control"}},[t.selectedControl?o("ConfigControl",{attrs:{control:t.selectedControl}}):t._e(),t.selectedRowId?o("ConfigRow",{attrs:{"row-id":t.selectedRowId}}):t._e(),t.selectedControl||t.selectedRowId?t._e():o("div",[t._v("请选择控件或行")])],1),o("TabPanel",{attrs:{label:t.cellPanelName,name:"cell",disabled:"mobile"===t.viewType}},[t.selectedColId?o("ConfigCell",{attrs:{"selected-col":t.selectedCol}}):o("div",[t._v("请选择单元格")])],1)],1)],1)]),t.needRender?o("LayoutGender",{ref:"builder",attrs:{list:t.design,"global-style":t.globalStyle}}):t._e(),o("NewFiledDialog"),t._e()],1)},nt=[],it=(o("a481"),o("097d"),o("ac6a"),o("ade3")),st=(o("386d"),function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"tabs-view"},[o("div",{staticClass:"tabs-head"},t._l(t.panels,(function(e,n){return o("div",{key:e.name,staticClass:"tab-head",class:t.getTabHeadCls(e),on:{click:function(e){return t.activeTab(n)}}},[t._v(t._s(e.label))])})),0),o("div",{staticClass:"tabs-body-wrap"},[o("div",{staticClass:"tabs-body",style:{width:t.width,marginLeft:t.marginLeft}},[t._t("default")],2)])])}),rt=[],lt={methods:{getPercent(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;const o=Math.pow(10,e);return(Math.floor(100*t*o)/o).toFixed(2)+"%"}}},at=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"tab-body",style:{width:t.width},attrs:{"data-name":t.name}},[t._t("default")],2)},ct=[];function dt(t,e,o){this.$children.forEach(n=>{const i=n.$options.name;i===t?n.$emit.apply(n,[e].concat(o)):dt.apply(n,[t,e].concat([o]))})}var ut={methods:{dispatch(t,e,o){let n=this.$parent||this.$root,i=n.$options.name;while(n&&(!i||i!==t))n=n.$parent,n&&(i=n.$options.name);n&&n.$emit.apply(n,[e].concat(o))},broadcast(t,e,o){dt.call(this,t,e,o)}}},ht={name:"tab-panel",inject:["tabCount","activeIndex"],mixins:[lt,ut],props:{label:{type:String,required:!0},name:{type:String,required:!0},disabled:{type:Boolean,default:!1}},computed:{width(){return this.getPercent(1/this.tabCount)}},methods:{propChange(){this.dispatch("Tabs","tab-panel-props-change")}},watch:{label(){this.propChange()},name(){this.propChange()},disabled(){this.propChange()}}},pt=ht,mt=o("2877"),ft=Object(mt["a"])(pt,at,ct,!1,null,null,null),gt=ft.exports,bt={name:"Tabs",mixins:[lt],props:{defaultActive:{type:String},activeClass:{type:String,default:"active"},value:{type:String}},components:{TabPanel:gt},provide(){return{tabCount:this.tabCount,activeIndex:this.activeIndex}},mounted(){this.$on("tab-panel-props-change",this.tabPanelChange)},beforeDestroy(){this.$off("tab-panel-props-change")},data(){return{active:this.value||this.defaultActive,tabCount:0,panels:this.getPanels()}},computed:{activeIndex(){if(this.panels.length)for(let t=0;t<this.panels.length;t++)if(this.panels[t].name==this.active)return t;return 0},width(){return this.getPercent(this.tabCount)},marginLeft(){return"-"+this.getPercent(this.activeIndex)}},watch:{panels:{immediate:!0,handler(){this.tabCount=this.panels.length}},value(t){t&&(this.active=t)},active(t){this.$emit("input",t)}},methods:{getTabHeadCls(t){return{[this.activeClass]:this.active==t.name,disabled:t.disabled}},activeTab(t){const e=this.panels[t];e.disabled||(this.active=this.panels[t].name)},tabPanelChange(){this.panels=this.getPanels()},getPanels(){const t=this.$slots.default.filter(t=>t.tag&&t.componentOptions&&"tab-panel"===t.componentOptions.Ctor.options.name),e=t.map(t=>t.componentOptions.propsData);return e}}},yt=bt,vt=(o("6f10"),Object(mt["a"])(yt,st,rt,!1,null,null,null)),Ct=vt.exports,wt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("draggable",{staticClass:"layout-drag-area left-panel layout",attrs:{list:t.layoutList,group:{name:"layout",pull:"clone",put:!1},swapThreshold:"0.3",sort:!1,clone:t.createLayout,move:t.checkMove},on:{change:t.log,start:t.onDragStart,end:t.onDragEnd}},t._l(t.layoutList,(function(e,n){return o("div",{key:e.id||n,staticClass:"template-item layout-item",class:e.type},[o("span",{staticClass:"template-item-icon layout",class:e.icon}),o("span",{staticClass:"template-item-name"},[t._v(t._s(e.name))])])})),0)},xt=[],Dt=o("2f62"),Ot=o("4260"),_t=o("db49");function kt(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function St(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?kt(Object(o),!0).forEach((function(e){Object(it["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):kt(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var Tt={name:"panel-layout",data(){return{layoutList:[{name:"一行2列",icon:"col-2",cols:[1,1],type:"row-layout"},{name:"一行4列",icon:"col-4",cols:[1,1,1,1],type:"row-layout"},{name:"一行6列",icon:"col-6",cols:[1,1,1,1,1,1],type:"row-layout"},{name:"1：5",icon:"col-2",cols:[1,5],type:"row-layout"},{name:"1：2：1：2",icon:"col-4",cols:[1,2,1,2],type:"row-layout"},{name:"多行多列",icon:"col-multi",cols:[],type:"row-layout"},{name:"手风琴布局",icon:"col-multi",cols:[1,1,1],type:"acc-layout"}]}},mixins:[ut],computed:St(St({},Object(Dt["e"])(["formSize"])),{},{rowHeight(){const t=this.$store.state.globalStyle;return t&&t.cellHeight?t.cellHeight:_t["b"]},initialBorder(){return this.$store.state.globalStyle.border}}),mounted(){this.dispatch("accordion","updated")},methods:St(St({},Object(Dt["d"])(["layoutDragStart","layoutDragEnd"])),{},{createLayout(t){return"row-layout"==t.type?this.createRowLayout(t):"acc-layout"==t.type?this.createAccLayout(t):void 0},createAccLayout(t){const e=this.createRowLayout(t);return e.props={showNav:!1},e.cols.forEach((t,e)=>{t.type="acc-item",t.style.width="100%",t.props={title:"手风琴项目-"+(e+1),opened:!0}}),e},createRowLayout(t){const e=Object(Ot["l"])(),o=Ot["j"].getIndex(t.name),n={id:e,name:"",autoIndex:o,namePrefix:t.name,cols:this.createCols(t.cols,e),type:t.type||"row-layout",height:this.rowHeight};return 0==t.cols.length&&(n.asMulti=!0,n.cols=this.createCols([1],e)),n},createCols(t,e){const o=t.reduce((t,e)=>t+e,0),n=this.formSize.width;return t.map(t=>{const i=Ot["b"].getIndex(e);return{id:`col-${e}-${i}`,name:"col-"+i,type:"col-item",style:{verticalAlign:"middle",textAlign:"center",width:n*t/o,border:Object(Ot["d"])(this.initialBorder)},subs:[],controls:[]}})},checkMove(t){if(this.$el==t.to||this.$el.compareDocumentPosition(t.to)&Node.DOCUMENT_POSITION_CONTAINED_BY)return!1;const e=t.draggedContext.element;return!(1==e.cols&&!t.to.classList.contains("level-0")&&!t.to.parentElement.classList.contains("acc-item"))&&(!("acc-layout"==e.type&&!t.to.classList.contains("level-0"))&&void 0)},onDragStart(){this.layoutDragStart()},onDragEnd(){this.layoutDragEnd()},log(){}})},jt=Tt,$t=Object(mt["a"])(jt,wt,xt,!1,null,null,null),It=$t.exports,Pt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"left-panel"},[t.baseControls.length?o("Accordion",{attrs:{title:"基础控件"}},[o("draggable",{staticClass:"control-drag-area",attrs:{list:t.baseControls,group:{name:"control",pull:"clone",put:!1},swapThreshold:"0.3",sort:!1,clone:t.createControl,emptyInsertThreshold:20,move:t.checkMove},on:{change:t.log}},t._l(t.baseControls,(function(e){return o("div",{key:e.type,staticClass:"template-item control-tpl-item",attrs:{"data-control-type":e.type,title:e.name}},[o("span",{staticClass:"template-item-icon control",class:e.icon}),o("span",{staticClass:"template-item-name"},[t._v(t._s(e.name))])])})),0)],1):t._e(),t.extControls.length?o("Accordion",{attrs:{title:"扩展控件"}},[o("draggable",{staticClass:"control-drag-area",attrs:{list:t.extControls,group:{name:"control",pull:"clone",put:!1},swapThreshold:"0.3",sortable:!1,clone:t.createControl,move:t.checkMove},on:{change:t.log}},t._l(t.extControls,(function(e){return o("div",{key:e.type,staticClass:"template-item control-tpl-item",attrs:{"data-control-type":e.type,title:e.name}},[o("span",{staticClass:"template-item-icon control",class:e.icon}),o("span",{staticClass:"template-item-name"},[t._v(t._s(e.name))])])})),0)],1):t._e(),t.commonControls.length?o("Accordion",{attrs:{title:"通用字段"}},[t._l(t.commonControlsTree,(function(e){return[o("h3",{key:"header-"+e.id,staticClass:"common-control-catalog"},[t._v(t._s(e.name))]),o("draggable",{key:"body-"+e.id,staticClass:"control-drag-area",attrs:{list:e.children,group:{name:"control",pull:"clone",put:!1},swapThreshold:"0.3",sortable:!1,clone:t.createdCommonControl,move:t.checkMove},on:{change:t.log}},t._l(e.children,(function(n){return o("div",{key:e.id+n.name+n.type,staticClass:"template-item control-tpl-item",attrs:{"data-control-type":n.type,title:n.name}},[o("span",{staticClass:"template-item-icon control",class:n.icon}),o("span",{staticClass:"template-item-name"},[t._v(t._s(n.name))])])})),0)]}))],2):t._e()],1)},Et=[],Lt={methods:{createControl(t){const e=t.type,o=t.icon,n=t.name,i=window.FORM_DESIGN_CONFIG.controls[e];if(!i)throw new Error(`控件的 ${e} 配置信息不存在，无法创建`);const s=Object(Ot["d"])(i);delete s.configItems;const r=Ot["c"].getIndex(e),l=Object(Ot["l"])();return s.id=e+"-"+l,s.namePrefix=n,s.autoIndex=r,s.name="",s.icon=o,s.width||(s.width="100%"),-1!=["title","label","output"].indexOf(e)&&this.copyGlobalStyleToControl(s),s},copyGlobalStyleToControl(t){const e=this.$store.state.globalStyle,o=e.fontSize,n=e.fontFamily,i=e.fontColor,s=e.fontBolder,r=e.fontItalic,l=e.fontUnderline;e.textAlign,e.verticalAlign;"label"==t.type&&(t.fontSize=o),t.fontFamily=n,t.fontColor=i,t.fontBolder=s,t.fontItalic=r,t.fontUnderline=l}}},At=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"accordion"},[o("div",{staticClass:"accordion-header"},[o("span",{staticClass:"accordion-title"},[t._v(t._s(t.title))]),o("span",{staticClass:"accordion-toggle el-icon-arrow-down",class:{collaspe:t.collaspe},on:{click:function(e){t.collaspe=!t.collaspe}}})]),o("transition",{on:{"before-enter":t.beforeEnter,enter:t.enter,"after-enter":t.afterEnter,"before-leave":t.beforeLeave,leave:t.leave,"after-leave":t.afterLeave}},[o("div",{directives:[{name:"show",rawName:"v-show",value:!t.collaspe,expression:"!collaspe"}],ref:"body",staticClass:"accordion-body",class:{collaspe:t.collaspe}},[t._t("default")],2)])],1)},Mt=[],Ft={name:"accordion",props:{title:{type:String,required:!0}},data(){return{collaspe:!1,inGroup:!1}},mounted(){"accordion-group"==this.$parent.$options.name&&(this.inGroup=!0)},methods:{beforeEnter(t){t.classList.add("collapse-transition"),t.dataset||(t.dataset={}),t.dataset.oldPaddingTop=t.style.paddingTop,t.dataset.oldPaddingBottom=t.style.paddingBottom,t.style.height="0",t.style.paddingTop=0,t.style.paddingBottom=0,t.style.opacity=0},enter(t){t.dataset.oldOverflow=t.style.overflow,0!==t.scrollHeight?(t.style.height=t.scrollHeight+"px",t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom):(t.style.height="",t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom),t.style.opacity=1,t.style.overflow="hidden"},afterEnter(t){t.classList.remove("collapse-transition"),t.style.height="",t.style.overflow=t.dataset.oldOverflow,t.style.opacity=""},beforeLeave(t){t.dataset||(t.dataset={}),t.dataset.oldPaddingTop=t.style.paddingTop,t.dataset.oldPaddingBottom=t.style.paddingBottom,t.dataset.oldOverflow=t.style.overflow,t.style.height=t.scrollHeight+"px",t.style.overflow="hidden",t.style.opacity=1},leave(t){0!==t.scrollHeight&&t.classList.add("collapse-transition"),t.style.height=0,t.style.paddingTop=0,t.style.paddingBottom=0,t.style.opacity=0},afterLeave(t){t.style.height="",t.style.overflow=t.dataset.oldOverflow,t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom,t.style.opacity=""},setCollaspe(t){this.collaspe=void 0!==t?!!t:!this.collaspe}},watch:{collaspe(t){this.inGroup&&this.$parent.updateStatus(t,this),this.$emit("change",t)}}},Rt=Ft,Nt=(o("5443"),Object(mt["a"])(Rt,At,Mt,!1,null,null,null)),Vt=Nt.exports;const Bt=window.FORM_DESIGN_CONFIG.controlList;var zt={name:"panel-control",components:{Accordion:Vt},data(){return{baseControls:Object(Ot["d"])(Bt)}},computed:{extControls(){return this.$store.state.extControls},commonControls(){return this.$store.state.commonControls},commonControlsTree(){const t=this.commonControls,e={};return t.forEach(t=>{const o=t.businessType,n=t.businessName;o&&n&&(e[o]||(e[o]={id:o,name:n,children:[]}),e[o].children.push(t))}),Object.keys(e).map(t=>e[t])}},mixins:[ut,Lt],mounted(){this.update()},methods:{update(){this.dispatch("accordion","updated")},createdCommonControl(t){const e=this.createControl(t),o=Object(Ot["d"])(t.props),n={};return Object.keys(e).forEach(t=>{n[t.toLowerCase()]=t}),Object.keys(o).forEach(t=>{const i=t.toLowerCase(),s=n[i];s?e[s]=o[t]:e[t]=o[t]}),void 0!==t.fieldName&&(e.fieldName=t.fieldName),void 0!==t.universalId&&(e.universalId=t.universalId),t.name&&!e.name&&(e.name=t.name),e},checkMove(t){if(this.$el==t.to||this.$el.compareDocumentPosition(t.to)&Node.DOCUMENT_POSITION_CONTAINED_BY)return!1;const e=t.draggedContext.element;return!("hiddenfield"===e.type^t.to.classList.contains("design-hidden-area"))},log(){}},watch:{extControls(){this.update()},baseControls(){this.update()},commonControls(){this.update()}}},Ht=zt,Gt=Object(mt["a"])(Ht,Pt,Et,!1,null,null,null),qt=Gt.exports,Wt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"left-panel"},[t._l(t.tables,(function(e){return o("Accordion",{key:e.id,attrs:{title:e.name+"中的字段"}},[o("draggable",{staticClass:"control-drag-area mis-field-list",attrs:{list:e.fields,group:{name:"control",pull:"clone",put:!1},swapThreshold:"0.3",sort:!1,clone:t.createFieldControl,emptyInsertThreshold:20,filter:".disabled",move:t.checkMove},on:{filter:t.onFilter}},t._l(e.fields,(function(n){return o("div",{key:e.id+n.field,staticClass:"template-item data-tpl-item",class:{disabled:t.selectedFieldMap["#"+(e.sqltablename||"")+";#"+(n.fieldname||"")]},attrs:{"data-control-type":n.fielddisplaytype}},[o("div",{staticClass:"template-item-inner"},[o("span",{staticClass:"template-item-icon control",class:t.getControlIcon({type:n.fielddisplaytype})}),o("span",{staticClass:"template-item-name"},[t._v(t._s(n.name))]),o("span",{staticClass:"template-item-type"},[t._v("["+t._s(t.controlCNameMap[n.fielddisplaytype]||"文本框")+"]")])])])})),0)],1)})),o("Accordion",{attrs:{title:"已使用的字段"}},[o("draggable",{staticClass:"data-drag-area",attrs:{list:t.dataList,group:{name:"data",pull:"clone",put:!1},swapThreshold:"0.3",sort:!1,clone:t.createArea,emptyInsertThreshold:20,move:t.checkMove,filter:".disabled"},on:{change:t.log,filter:t.onFilter}},t._l(t.dataList,(function(e){return o("div",{key:e.id,staticClass:"template-item data-tpl-item",class:{disabled:t.usedMap[e.id]},attrs:{"data-control-type":e.type}},[o("span",{staticClass:"template-item-icon control",class:e.icon}),o("span",{staticClass:"template-item-name"},[t._v(t._s(t._f("getName")(e)))]),o("span",{staticClass:"template-item-type"},[t._v("["+t._s(t.controlCNameMap[e.type]||e.type)+"]")])])})),0)],1)],2)},Ut=[];function Jt(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function Yt(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?Jt(Object(o),!0).forEach((function(e){Object(it["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):Jt(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}const Xt={title:"",label:"",textbox:"textbox",textarea:"textarea",spinner:"spinner",radiobuttonlist:"radio",checkboxlist:"check",combobox:"drop",buttonedit:"drop",datepicker:"date",daterangepicker:"dates",monthpicker:"month",macro:"macro",organizationselect:"person",treeselect:"tree",webuploader:"upload",subtable:"subtable",ewebeditor:"ewebeditor",output:"output",hiddenfield:"textbox"},Kt=window.FORM_DESIGN_CONFIG.controlList;var Qt={name:"panel-data",data(){return{}},mixins:[Lt],components:{Accordion:Vt},computed:Yt(Yt(Yt({},Object(Dt["c"])(["allControls","selectedFieldMap"])),Object(Dt["e"])(["hiddenControls","mobileDesignData"])),{},{dataList(){const t=this.allControls,e=[];return t.forEach(t=>{"label"!=t.type&&"title"!=t.type&&e.push(Object(Ot["d"])(t))}),e},controlCNameMap(){const t={};return Kt.forEach(e=>{t[e.type]=e.name}),this.$store.state.extControls.forEach(e=>{t[e.type]=e.name}),t},usedMap(){const t={};return this.mobileDesignData.forEach(e=>{const o=e.control;o&&(t[o.id]=!0)}),t},tables(){const t=Object(Ot["d"])(this.$store.state.fieldList);return t.forEach((t,e)=>{t.fields.forEach(e=>{e.actualId=`#${t.sqltablename||""};#${e.fieldname||""}`})}),t}}),filters:{getName(t){return t.name||t.namePrefix}},methods:{createArea(t){const e={labelText:t.name||`${t.namePrefix||"控件"}_${t.autoIndex||1}`};return{label:e,visible:!0,control:Object(Ot["d"])(t)}},log(){},checkMove(t){if(this.$el==t.to||this.$el.compareDocumentPosition(t.to)&Node.DOCUMENT_POSITION_CONTAINED_BY)return!1;const e=t.draggedContext.element;return!("hiddenfield"===e.type^t.to.classList.contains("design-hidden-area"))},onFilter(t){if(t.target.classList.contains("disabled"))return!1},getControlIcon(t){return Xt[t.type]||""},createFieldControl(t){const e=t.fielddisplaytype||"textbox",o={type:e,name:this.controlCNameMap[e],icon:this.getControlIcon({type:e})},n=this.createControl(o);return void 0!==n.bind&&(n.bind=t.actualId),void 0!==n.required&&(n.required=t.required),t.datasource&&void 0!==n.codeItem&&(n.codeItem=t.datasource),t.multiSelect&&void 0!==n.multiSelect&&(n.multiSelect=t.multiSelect),t.mode&&void 0!==n.mode&&(n.mode=t.mode),n.name=n.name=t.name,n}}},Zt=Qt,te=(o("ef38"),Object(mt["a"])(Zt,Wt,Ut,!1,null,null,null)),ee=te.exports,oe=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{ref:"designArea",staticClass:"design-area",staticStyle:{position:"relative"},style:{width:t.size.width+20+"px"},attrs:{id:"design-area","data-width":t.size.width,"data-height":t.size.height},on:{click:t.handleFormClick}},[o("RowLayout",{attrs:{list:t.data}}),o("HelperLine",{directives:[{name:"show",rawName:"v-show",value:t.showVLine,expression:"showVLine"}],attrs:{type:"v"}}),o("HelperLine",{directives:[{name:"show",rawName:"v-show",value:t.showHLine,expression:"showHLine"}],attrs:{type:"h"}}),o("draggable",{staticClass:"design-hidden-area",attrs:{group:"control",move:t.checkControlMove},model:{value:t.hiddenControls,callback:function(e){t.hiddenControls=e},expression:"hiddenControls"}},t._l(t.hiddenControls,(function(e,n){return o("Control",{key:e.id,class:{selected:e.id==t.selectedControlId},attrs:{"control-data":e},nativeOn:{click:function(o){return o.stopPropagation(),t.onControlClick(e,n,t.hiddenControls)}}})})),1),o("div",{domProps:{innerHTML:t._s(t.colBorderStyle)}}),o("v-contextmenu",{ref:"ctxMenu"},[o("v-contextmenu-item",{on:{click:function(e){return t.ctxMneuItemHandle("insertRowUp")}}},[t._v("向上插入1行")]),o("v-contextmenu-item",{on:{click:function(e){return t.ctxMneuItemHandle("insertRowDown")}}},[t._v("向下插入1行")]),o("v-contextmenu-item",{attrs:{divider:""}}),o("v-contextmenu-item",{attrs:{disabled:"row-layout"!=t.ctxMenuData.type},on:{click:function(e){return t.ctxMneuItemHandle("insertColLeft")}}},[t._v("向左插入1列")]),o("v-contextmenu-item",{attrs:{disabled:"row-layout"!=t.ctxMenuData.type},on:{click:function(e){return t.ctxMneuItemHandle("insertColRight")}}},[t._v("向右插入1列")]),o("v-contextmenu-item",{attrs:{divider:""}}),o("v-contextmenu-item",{attrs:{disabled:!t.ctxMenuData.isControl},on:{click:function(e){return t.ctxMneuItemHandle("deleteControl")}}},[t._v("删除控件")]),o("v-contextmenu-item",{attrs:{disabled:!t.ctxMenuData.colDeletable||t.ctxMenuData.isControl},on:{click:function(e){return t.ctxMneuItemHandle("removeCol")}}},[t._v(t._s("acc-layout"==t.ctxMenuData.type?"删除此手风琴项":"删除此列"))]),o("v-contextmenu-item",{attrs:{disabled:t.ctxMenuData.isControl},on:{click:function(e){return t.ctxMneuItemHandle("removeRow")}}},[t._v(t._s("acc-layout"==t.ctxMenuData.type?"删除此手风琴":"删除此行"))]),t.ctxMenuData.isCol?o("v-contextmenu-item",{attrs:{divider:""}}):t._e(),t.ctxMenuData.isCol?o("v-contextmenu-item",{attrs:{disabled:t.ctxMenuData.isControl||t.ctxMenuData.hasControl},on:{click:function(e){return t.handleQuickSplit()}}},[t._v("快速拆分")]):t._e()],1),o("el-dialog",{staticClass:"multi-row-dialog",attrs:{"append-to-body":"",title:"请输入行列",visible:t.dialogVisible,width:"460px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[o("el-form",{attrs:{model:t.rowData,size:"mini",inline:"","inline-message":""}},[o("el-form-item",{attrs:{label:"行数目"}},[o("el-input-number",{attrs:{min:1,max:20,controls:!1,autocomplete:"off"},model:{value:t.rowData.rowCount,callback:function(e){t.$set(t.rowData,"rowCount",e)},expression:"rowData.rowCount"}})],1),o("el-form-item",{attrs:{label:"列数目"}},[o("el-input-number",{attrs:{min:1,max:20,controls:!1},model:{value:t.rowData.colCount,callback:function(e){t.$set(t.rowData,"colCount",e)},expression:"rowData.colCount"}})],1)],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.handleDialogClose("cancel")}}},[t._v("取 消")]),o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.handleDialogClose("ok")}}},[t._v("确 定")])],1)],1)],1)},ne=[],ie=o("eafa"),se=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"helper-line",class:{"line-v":"v"===t.type,"line-h":"h"===t.type},style:t.styleText})},re=[],le={props:{type:{type:String,default:"v"}},computed:{left(){return this.$store.state.helper.left},top(){return this.$store.state.helper.top},styleText(){return"v"==this.type?`left: ${this.left}px;`:"h"==this.type?`top: ${this.top}px;`:""}}},ae=le,ce=(o("d56b"),Object(mt["a"])(ae,se,re,!1,null,null,null)),de=ce.exports,ue=o("a3de");function he(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function pe(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?he(Object(o),!0).forEach((function(e){Object(it["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):he(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var me={name:"design",components:{RowLayout:ie["default"],HelperLine:de,Control:ue["a"]},provide(){return{getDesignContainer:()=>this.$refs.designArea,showCtxMenu:this.showCtxMenu,hideCtxMenu:this.hideCtxMenu,showMutliRowConfirm:this.showMutliRowConfirm}},props:{data:{type:Array},size:{type:Object}},data(){return{ctxMneuItemHandle:()=>{},ctxMenuData:{isControl:!1,colDeletable:!0,type:"row-layout",hasControl:!1,isCol:!1},rowData:{rowCount:1,colCount:1},dialogVisible:!1,dialogOkCallback:()=>{}}},computed:pe(pe({},Object(Dt["e"])({showVLine:t=>t.helper.showVLine,showHLine:t=>t.helper.showHLine})),{},{selectedControlId(){return this.$store.state.selectedControlId},hiddenControls:{get(){return this.$store.state.hiddenControls},set(t){this.$store.commit("setHiddenControls",t)}},colBorderStyle(){return"<style>"+this.$store.getters.colStyleText+"</style>"}}),methods:pe(pe({},Object(Dt["b"])(["setSelectedControl","setSelectedLayout","activeRightTab"])),{},{onControlClick(t,e,o){this.setSelectedControl({id:t.id}),this.activeRightTab("control")},checkControlMove(t){if(!t.to.classList.contains("design-hidden-area"))return!1},handleFormClick(t){const e=t.target;e.closest(".row")||this.activeRightTab("form")},showMutliRowConfirm(t){this.dialogVisible=!0,this.dialogOkCallback=t},adjustCtxPos(t,e){this.$nextTick(()=>{const o={top:e,left:t},n=this.$refs.ctxMenu.$el.clientWidth,i=this.$refs.ctxMenu.$el.clientHeight;i+e>=window.innerHeight&&(o.top-=i),n+t>=window.innerWidth&&(o.left-=n),this.$refs.ctxMenu.$el.style.top=o.top+"px",this.$refs.ctxMenu.$el.style.left=o.left+"px"})},showCtxMenu(t,e,o){this.ctxMenuData.isControl=!!e.control,this.ctxMenuData.colDeletable=e.colDeletable,this.ctxMenuData.type=e.row.type||"row-layout",this.ctxMenuData.hasControl=e.hasControl,this.ctxMenuData.isCol=!this.ctxMenuData.isControl&&"row-layout"==this.ctxMenuData.type,this.ctxMneuItemHandle=o;const n=t.pageX,i=t.pageY;this.$refs.ctxMenu.show({top:i,left:n}),this.adjustCtxPos(n,i)},hideCtxMenu(){this.$refs.ctxMenu.hide()},handleDialogClose(t){this.dialogVisible=!1;const e=this.rowData,o=e.rowCount,n=e.colCount;"ok"==t&&this.dialogOkCallback(o,n),this.rowData.rowCount=1,this.rowData.colCount=1},handleQuickSplit(){this.rowData.rowCount=2,this.rowData.colCount=2,this.showMutliRowConfirm(()=>{this.rowData;const t=this.rowData,e=t.rowCount,o=t.colCount;e&&o&&(1!==e||1===o?this.ctxMneuItemHandle("insertMultiRowCol",{rowCount:e,colCount:o}):this.ctxMneuItemHandle("insertMultiCol",{colCount:o}))})}})},fe=me,ge=(o("026d"),o("f1a3"),Object(mt["a"])(fe,oe,ne,!1,null,null,null)),be=ge.exports,ye=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"mobile-designer-area"},[o("div",{staticClass:"right-fixed-area"},[o("el-tooltip",{attrs:{placement:"top",enterable:!1,"open-delay":300,content:"一键同步"}},[o("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:t.onSyncCLick}})],1)],1),o("Device",{attrs:{type:"iphone-8",color:"silver"}},[o("draggable",{staticClass:"mobile-form-container",attrs:{group:"data",list:t.list,direction:"vertical",filter:".hide"},on:{add:t.onDataAdd,sort:t.onMobileControlSort,filter:t.onFilter}},t._l(t.list,(function(e,n){return o("div",{key:"item-"+n,staticClass:"mobile-form-item",class:t.getCls(e,n),attrs:{"data-index":n}},[o("label",{staticClass:"mobile-form-label"},[e.label?o("span",[t._v(t._s(t._f("removeLineFeed")(e.label.labelText)))]):t._e()]),o("span",{staticClass:"mobile-form-control"},[e.control?o("MobileControl",{attrs:{"control-data":e.control}}):t._e()],1),o("div",{staticClass:"mobile-form-helper row-helper"},[o("el-tooltip",{attrs:{placement:"top",enterable:!1,"open-delay":300,content:"切换显示"}},[o("span",{staticClass:"row-helper-btn view el-icon-view",on:{click:function(o){return t.onVisibleChange(e,n)}}})]),o("el-tooltip",{attrs:{placement:"top",enterable:!1,"open-delay":300,content:"选择"}},[o("span",{staticClass:"row-helper-btn selected el-icon-top-left",on:{click:function(o){return o.stopPropagation(),t.onItemClick(e,n)}}})])],1)])})),0)],1)],1)},ve=[],Ce=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o(t.getControlComponent(t.controlData.type),{tag:"component",attrs:{"control-data":t.controlData}})},we=[],xe=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"mui-card"},[o("div",{staticClass:"mui-input-group ep-mui-radiobuttonlist"},t._l(t.dataList,(function(e){return o("div",{key:e.id,staticClass:"mui-input-row mui-radio"},[o("label",[t._v(t._s(e.text))]),o("input",{attrs:{type:"radio",name:t.controlData.id},domProps:{value:e.id}}),o("span",{staticClass:"el-radio__inner"})])})),0)])},De=[],Oe=o("ab9e"),_e={props:["controlData"],mixins:[Oe["a"]],data(){return{currValue:this.controlData.value||"",defaultDataList:[1,2,3].map(t=>({id:t,text:"选项-"+t})),originData:[]}},created(){this.getDataList()}},ke=_e,Se=(o("6da2"),Object(mt["a"])(ke,xe,De,!1,null,null,null)),Te=Se.exports;const je=["controlData"],$e={title:{props:je,template:'<span class="mobile-form-title">{{controlData.textContent || ""}}</span>'},textbox:{props:je,template:'<input type="text" :placeholder="controlData.emptyText || controlData.type" />'},textarea:{props:je,template:'<textarea :placeholder="controlData.emptyText || controlData.type" ></textarea>'},radiobuttonlist:Te,checkboxlist:Te,webuploader:{props:je,template:'<div class="uploader-wrap"><span class="uploader-btn"></span></div>'}},Ie={props:je,template:'<input type="text" :placeholder="controlData.emptyText || controlData.type" />'};var Pe={name:"mobile-control",props:je,methods:{getControlComponent(t){return t in $e?$e[t]:Ie}}},Ee=Pe,Le=(o("1f0e"),Object(mt["a"])(Ee,Ce,we,!1,null,null,null)),Ae=Le.exports,Me=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"device",class:t.className},[o("div",{staticClass:"device-frame"},[o("div",{staticClass:"device-content"},[t._t("default")],2)]),o("div",{staticClass:"device-stripe"}),o("div",{staticClass:"device-header"}),o("div",{staticClass:"device-sensors"}),o("div",{staticClass:"device-btns"}),o("div",{staticClass:"device-power"})])},Fe=[],Re=(o("7d5a"),{name:"device",props:{type:{type:String,default:"iphone-8"},color:{type:String,default:"silver"}},computed:{className(){return`device-${this.type} device-${this.color}`}}}),Ne=Re,Ve=Object(mt["a"])(Ne,Me,Fe,!1,null,null,null),Be=Ve.exports;function ze(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function He(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?ze(Object(o),!0).forEach((function(e){Object(it["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):ze(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}const Ge=Object.prototype.hasOwnProperty;var qe={name:"mobile-design",components:{MobileControl:Ae,Device:Be},data(){return{list:[],activeIndex:-1}},computed:He({},Object(Dt["e"])(["mobileDesignData"])),filters:{removeLineFeed(t){return t&&t+""===t?t.replace(/\\n/g,"").replace(/ /g,"&nbsp;"):""}},methods:{getCls(t,e){return{hide:!t.visible,[t.control&&t.control.type]:!0,active:this.activeIndex===e,"only-control":t.control&&!t.label,"only-label":t.label&&!t.control}},dealData(t){return t.map(t=>(Ge.call(t,"visible")||(t.visible=!0),t))},pc2mobile(){return this.loading=!0,this.$parent.getData({withBuild:!1}).then(t=>this.$httpPost(window.formDesignerActions.pc2mobileUrl,t)).then(t=>{this.list=this.dealData(t.mobileDesignData),this.restorePcSelected()}).finally(()=>{this.loading=!1})},onSyncCLick(){this.$msgbox({title:"提示",message:"是否按照当前PC表单配置，同步生成移动端表单？（该操作将覆盖现有移动表单配置）",confirmButtonText:"同步并覆盖",showCancelButton:!0,cancelText:"取消",iconClass:"el-icon-question",callback:t=>{"confirm"==t&&this.pc2mobile()}})},initSync(){this.$msgbox({title:"初始化",message:"可按照pc表单配置，快速完成移动端表单初始化",confirmButtonText:"一键初始化",showCancelButton:!0,cancelText:"取消",iconClass:"el-icon-question",callback:t=>{"confirm"==t&&this.pc2mobile()}})},onVisibleChange(t,e){t.visible=!t.visible},onItemClick(t,e){this.activeIndex=e,t.control&&t.control.id?this.$store.commit({type:"setSelectedControl",id:t.control.id}):this.$store.commit({type:"clearSelectedControl"})},onDataAdd(t){window.FORM_DESIGNER_ANALYSIS.mobileDesignAdd=!0},onMobileControlSort(){window.FORM_DESIGNER_ANALYSIS.mobileDesignMoved=!0},onFilter(t){if(t.target.classList.contains("hide"))return!1},restorePcSelected(){const t=this.$store.state.selectedControlId;if(t){for(let e=this.list.length-1;e>=0;e--){let o=this.list[e];if(o.control&&o.control.id==t)return void(this.activeIndex=e)}this.activeIndex=-1}else this.activeIndex=-1}},mounted(){window.FORM_DESIGNER_ANALYSIS.mobileDesignEntered=!0,this.mobileDesignData.length?(this.list=this.mobileDesignData,this.restorePcSelected()):this.initSync(),this.$store.commit("activeLeftTab","data"),this.$store.commit("activeRightTab","control")},watch:{list:{deep:!0,handler(t){this.$store.commit({type:"replaceMobileDesign",mobileDesignData:t})}}}},We=qe,Ue=(o("e4ac"),o("f4d4"),o("b2ce"),Object(mt["a"])(We,ye,ve,!1,null,"b6c62ce2",null)),Je=Ue.exports,Ye=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o(t.componentName,{tag:"component",staticClass:"config-cell",attrs:{selectedCol:t.selectedCol}})},Xe=[],Ke=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"config-block"},[o("h3",{staticClass:"config-category"},[t._v("\n      手风琴项配置\n      "),o("el-tooltip",{attrs:{"open-delay":50,content:"复制ID"}},[o("span",{staticClass:"el-icon-copy-document acc-copy-id",on:{click:t.copyId}})])],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("手风琴标题")]),o("div",{staticClass:"form-control"},[o("div",{staticClass:"form-control-item"},[o("el-input",{on:{blur:t.submitTitle},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1)])]),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("默认展开")]),o("div",{staticClass:"form-control"},[o("div",{staticClass:"form-control-item"},[o("el-switch",{model:{value:t.opened,callback:function(e){t.opened=e},expression:"opened"}})],1)])])])])},Qe=[],Ze={name:"config-acc-item",props:["selectedCol"],data(){const t=this.selectedCol.props;return{title:t.title,opened:t.opened}},methods:{submitTitle(){const t=this.title;if(!t||""==t.trim())return this.$message({title:"系统提醒",message:"名称不能为空",type:"error",showClose:!0});const e="acc-item-name";this.$store.commit("setColProps",{value:t,prop:"props.title",group:e,col:this.selectedCol}),t&&this.$store.commit("setColProps",{value:t,prop:"name",group:e,col:this.selectedCol})},submitOpend(t){this.$store.commit("setColProps",{value:t,prop:"props.opened",col:this.selectedCol})},copyId(){if(!this.selectedCol)return;const t=this.selectedCol.id,e=document.createElement("input");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("COPY"),this.$message({message:"手风琴ID已复制到剪贴版",type:"success"}),e.parentNode.removeChild(e)}},watch:{opened(t){this.submitOpend(t)},"selectedCol.props"(){const t=this.selectedCol.props;this.title=t.title,this.opened=t.opened}}},to=Ze,eo=(o("76fd"),Object(mt["a"])(to,Ke,Qe,!1,null,"70c5360e",null)),oo=eo.exports,no=function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.selectedCol?o("div",[o("div",{staticClass:"config-block"},[o("h3",{staticClass:"config-category"},[t._v("\n      对齐\n    ")]),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("对齐")]),o("AlignButton",{attrs:{type:"horizontal"},model:{value:t.textAlign,callback:function(e){t.textAlign=e},expression:"textAlign"}}),o("AlignButton",{attrs:{type:"vertical"},model:{value:t.verticalAlign,callback:function(e){t.verticalAlign=e},expression:"verticalAlign"}})],1)]),o("div",{staticClass:"config-block"},[o("h3",{staticClass:"config-category"},[t._v("\n      边框\n      "),o("el-tooltip",{attrs:{content:"normal"==t.currentView?"切换到详细模式":"切换到简易模式"}},[o("span",{staticClass:"border-config-toggle el-icon-d-arrow-right",on:{click:t.toggleView}})])],1),"normal"==t.currentView?o("div",[o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("线宽")]),o("BorderWidthSelect",{attrs:{"border-color":t.borderColor,"border-style":t.borderStyle},model:{value:t.borderWidth,callback:function(e){t.borderWidth=e},expression:"borderWidth"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("线型")]),o("BorderStyleSelect",{attrs:{"border-width":t.borderWidth,"border-color":t.borderColor,disabled:!t.borderWidth},on:{change:t.onBorderStyleChange},model:{value:t.borderStyle,callback:function(e){t.borderStyle=e},expression:"borderStyle"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("颜色")]),o("ColorPicker",{model:{value:t.borderColor,callback:function(e){t.borderColor=e},expression:"borderColor"}})],1)]):t._e(),"advance"==t.currentView?o("div",[o("div",{staticClass:"config-block"},[o("h3",{staticClass:"config-category"},[t._v("边框——上")]),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("线宽")]),o("BorderWidthSelect",{attrs:{"border-color":t.border.top.color},on:{change:function(e){return t.onBorderChange("top","width",e)}},model:{value:t.border.top.width,callback:function(e){t.$set(t.border.top,"width",e)},expression:"border.top.width"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("线性")]),o("BorderStyleSelect",{attrs:{"border-color":t.border.top.color,disabled:!t.border.top.width},on:{change:function(e){return t.onBorderChange("top","style",e)}},model:{value:t.border.top.style,callback:function(e){t.$set(t.border.top,"style",e)},expression:"border.top.style"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("颜色")]),o("ColorPicker",{attrs:{disabled:!t.border.top.width},on:{change:function(e){return t.onBorderChange("top","color",e)}},model:{value:t.border.top.color,callback:function(e){t.$set(t.border.top,"color",e)},expression:"border.top.color"}})],1)]),o("div",{staticClass:"config-block"},[o("h3",{staticClass:"config-category"},[t._v("边框——右")]),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("线宽")]),o("BorderWidthSelect",{attrs:{"border-color":t.border.right.color},on:{change:function(e){return t.onBorderChange("right","width",e)}},model:{value:t.border.right.width,callback:function(e){t.$set(t.border.right,"width",e)},expression:"border.right.width"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("线性")]),o("BorderStyleSelect",{attrs:{"border-color":t.border.right.color,disabled:!t.border.right.width},on:{change:function(e){return t.onBorderChange("right","style",e)}},model:{value:t.border.right.style,callback:function(e){t.$set(t.border.right,"style",e)},expression:"border.right.style"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("颜色")]),o("ColorPicker",{attrs:{disabled:!t.border.right.width},on:{change:function(e){return t.onBorderChange("right","color",e)}},model:{value:t.border.right.color,callback:function(e){t.$set(t.border.right,"color",e)},expression:"border.right.color"}})],1)]),o("div",{staticClass:"config-block"},[o("h3",{staticClass:"config-category"},[t._v("边框——下")]),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("线宽")]),o("BorderWidthSelect",{attrs:{"border-color":t.border.bottom.color},on:{change:function(e){return t.onBorderChange("bottom","width",e)}},model:{value:t.border.bottom.width,callback:function(e){t.$set(t.border.bottom,"width",e)},expression:"border.bottom.width"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("线性")]),o("BorderStyleSelect",{attrs:{"border-color":t.border.bottom.color,disabled:!t.border.bottom.width},on:{change:function(e){return t.onBorderChange("bottom","style",e)}},model:{value:t.border.bottom.style,callback:function(e){t.$set(t.border.bottom,"style",e)},expression:"border.bottom.style"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("颜色")]),o("ColorPicker",{attrs:{disabled:!t.border.bottom.width},on:{change:function(e){return t.onBorderChange("bottom","color",e)}},model:{value:t.border.bottom.color,callback:function(e){t.$set(t.border.bottom,"color",e)},expression:"border.bottom.color"}})],1)]),o("div",{staticClass:"config-block"},[o("h3",{staticClass:"config-category"},[t._v("边框——左")]),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("线宽")]),o("BorderWidthSelect",{attrs:{"border-color":t.border.left.color},on:{change:function(e){return t.onBorderChange("left","width",e)}},model:{value:t.border.left.width,callback:function(e){t.$set(t.border.left,"width",e)},expression:"border.left.width"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("线性")]),o("BorderStyleSelect",{attrs:{"border-color":t.border.left.color,disabled:!t.border.left.width},on:{change:function(e){return t.onBorderChange("left","style",e)}},model:{value:t.border.left.style,callback:function(e){t.$set(t.border.left,"style",e)},expression:"border.left.style"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("颜色")]),o("ColorPicker",{attrs:{disabled:!t.border.left.width},on:{change:function(e){return t.onBorderChange("left","color",e)}},model:{value:t.border.left.color,callback:function(e){t.$set(t.border.left,"color",e)},expression:"border.left.color"}})],1)])]):t._e()])]):t._e()},io=[],so=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"design-button-group align-group",class:t.type,attrs:{"data-value":t.active}},t._l(t.alignList,(function(e){return o("el-tooltip",{key:e,attrs:{"open-delay":500,content:t.tipsText[e]}},[o("MyButton",{class:{active:t.active==e},attrs:{icon:"align-"+e},nativeOn:{click:function(o){return t.activeBtn(e)}}})],1)})),1)},ro=[],lo=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("span",{staticClass:"design-button"},[t.icon?o("span",{staticClass:"design-button-icon",class:t.icon}):t._e(),t._t("default")],2)},ao=[],co={name:"design-button",props:{icon:{type:String}}},uo=co,ho=Object(mt["a"])(uo,lo,ao,!1,null,null,null),po=ho.exports;var mo={name:"align-button",components:{MyButton:po},props:{type:{type:String,default:"horizontal",validator(t){const e=-1!==["horizontal","vertical"].indexOf(t);return e||console.error("type 应为 'horizontal' 或 'vertical'"),e}},value:{type:String,default(){return"horizontal"==this.type?"left":"vertical"==this.type?"middle":void 0}}},computed:{alignList(){return"horizontal"==this.type?["left","center","right"]:"vertical"==this.type?["top","middle","bottom"]:void 0}},data(){return{active:this.value,tipsText:{left:"左对齐",center:"居中对齐",right:"右对齐",top:"顶端对齐",middle:"垂直居中",bottom:"底端对齐"}}},watch:{value(){this.active=this.value},active(t){this.$emit("input",t)}},methods:{activeBtn(t){this.active=t}}},fo=mo,go=Object(mt["a"])(fo,so,ro,!1,null,null,null),bo=go.exports,yo=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{ref:"colorpicker",staticClass:"color-picker",class:{disabled:t.disabled}},[o("span",{staticClass:"color-picker-toggle",on:{click:function(e){return t.togglePicker()}}},[t._t("default",[o("div",{staticClass:"current-color",style:"background-color: "+t.colorValue},[o("span",{staticClass:"current-color-value"},[t._v(t._s(t.colorValue.toLowerCase()))]),o("label",{staticClass:"current-color-label"},[t._v(t._s(t.label))])])])],2),o("div",{directives:[{name:"show",rawName:"v-show",value:t.displayPicker,expression:"displayPicker"}],ref:"panel",staticClass:"color-picker-panel"},[t.displayPicker?o("Chrome",{staticClass:"color-picker-chrome",attrs:{value:t.colors,disableAlpha:t.disableAlpha},on:{input:t.updateFromPicker}}):t._e()],1)])},vo=[],Co=(o("6b54"),o("28a5"),o("c345")),wo={name:"color-picker",components:{Chrome:Co["Chrome"]},props:{value:{type:String,default:""},label:{type:String,default:""},referColor:{type:String,default:""},disabled:{type:Boolean,default:!1}},data(){return{disableAlpha:!0,colors:{hex:"#000000"},colorValue:"",displayPicker:!1}},mounted(){this.setColor(this.value||"#000000"),this.setStyle()},methods:{setStyle(){const t=this.value;if("#"!=t[0])return;const e=[0,1,2].map((e,o)=>parseInt(t.substr(2*o+1,2),16)||0),o=`drop-shadow(2px 2px 6px rgba( ${e.join(",")} ,.15)`;this.$refs.colorpicker.style.setProperty("--color",t),this.$refs.colorpicker.style.setProperty("--dropShadow",o),this.$refs.colorpicker.style.setProperty("--red",e[0]),this.$refs.colorpicker.style.setProperty("--green",e[1]),this.$refs.colorpicker.style.setProperty("--blue",e[2])},isValid(t){return!this.disableAlpha||/^#[0-9a-f]{6}$/i.test(t)},setColor(t){this.updateColors(t),this.colorValue=t},updateColors(t){if("#"==t.slice(0,1))this.colors={hex:t.substr(0,7)};else if("rgba"==t.slice(0,4)){var e=t.replace(/^rgba?\(|\s+|\)$/g,"").split(","),o="#"+((1<<24)+(parseInt(e[0])<<16)+(parseInt(e[1])<<8)+parseInt(e[2])).toString(16).slice(1);this.colors={hex:o,a:e[3]}}},showPicker(){document.addEventListener("click",this.documentClick,!0),this.displayPicker=!0},hidePicker(){document.removeEventListener("click",this.documentClick,!0),this.displayPicker=!1},togglePicker(){this.disabled||(this.displayPicker?this.hidePicker():this.showPicker())},updateFromPicker(t){this.disableAlpha&&(t.rgba.a=1),this.colors=t,1==t.rgba.a?this.colorValue=t.hex:this.colorValue="rgba("+t.rgba.r+", "+t.rgba.g+", "+t.rgba.b+", "+t.rgba.a+")",this.$emit("input",this.colorValue)},documentClick(t){var e=this.$refs.colorpicker,o=this.$refs.panel,n=t.target;e&&(e===n||e.contains(n)||o.contains(n)||this.hidePicker())},adjustPos(){const t=this.$el.getBoundingClientRect();let e=t.top+t.height,o=t.left;const n=this.$refs.panel,i=n.clientHeight,s=n.clientWidth;e+i>=window.innerHeight&&(e=t.top-i),o+s>=window.innerWidth&&(o-=o+s-window.innerWidth),n.style.top=e+"px",n.style.left=o+"px"},change:function(t){this.$emit("change",t)}},watch:{value(t,e){this.setColor(this.value||"#000000"),this.setStyle(),t!=e&&this.$emit("change",t)},colorValue(t){t&&(this.updateColors(t),this.setStyle(),this.$emit("input",t))},displayPicker(t){t?this.$nextTick(()=>{document.body.appendChild(this.$refs.panel),this.$refs.panel.style.position="fixed",this.$refs.panel.style.display="block",this.adjustPos()}):(this.$refs.panel.style.display="none",this.$refs.panel.style.top="-99999px",this.$refs.panel.style.left="-99999px")}}},xo=wo,Do=(o("5908"),o("b8b5"),Object(mt["a"])(xo,yo,vo,!1,null,null,null)),Oo=Do.exports,_o=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"border-style-select",class:{disabled:t.disabled}},[o("el-select",{staticStyle:{width:"100px"},attrs:{disabled:t.disabled,placeholder:"请选择",size:"small"},on:{change:t.change},model:{value:t.borderStyle,callback:function(e){t.borderStyle=e},expression:"borderStyle"}},t._l(t.borderStyleList,(function(e){return o("el-option",{key:e.value,attrs:{label:e.label||e.value,title:e.label||e.value,value:e.value}},[e.value?o("span",{staticClass:"border-style-option",style:"border-top-color:"+t.borderColor+";border-top-width:"+(t.borderWidth||3)+"px;border-top-style:"+e.value+";"}):t._e()])})),1),o("span",{staticClass:"border-style-select-curr",style:t.selectedStyle})],1)},ko=[],So={name:"border-style-select",props:["value","borderColor","disabled"],data(){return{borderWidth:4,borderStyle:this.value,borderStyleList:["solid","dashed","dotted","double"].map(t=>({value:t}))}},watch:{value(t){t!=this.borderStyle&&(this.borderStyle=t)},borderStyle(t){this.$emit("input",t)}},methods:{change:function(t){this.$emit("change",t)}},computed:{selectedStyle(){return`border-top-style:${this.borderStyle};border-top-color:${this.borderColor};border-top-width:${this.borderWidth||3}px;`}}},To=So,jo=Object(mt["a"])(To,_o,ko,!1,null,null,null),$o=jo.exports,Io=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"border-width-select",class:{disabled:t.disabled,none:0==t.borderWidth,normal:0!=t.borderWidth}},[o("el-select",{staticStyle:{width:"100px"},attrs:{disabled:t.disabled,placeholder:"请选择",size:"small"},on:{change:t.change},model:{value:t.borderWidth,callback:function(e){t.borderWidth=e},expression:"borderWidth"}},t._l(t.borderWidthList,(function(e){return o("el-option",{key:e.value,attrs:{label:e.label||e.value,value:e.value}},[e.value?o("span",{staticClass:"border-width-select-option",style:t.selectedStyle(e.value),attrs:{title:e.label||e.value}}):t._e(),e.value?t._e():o("span",{staticClass:"border-width-select-option-none",style:"color:"+t.borderColor,attrs:{title:e.label}},[t._v(t._s(e.label))])])})),1),o("span",{staticClass:"border-width-select-curr",style:t.selectedStyle()})],1)},Po=[],Eo={name:"border-width-select",props:["value","borderColor","disabled"],data(){return{borderStyle:"solid",borderWidth:this.value,borderWidthList:[{label:"none",value:0},{value:1},{value:2},{value:3},{value:4},{value:5}]}},watch:{value(t){t!=this.borderWidth&&(this.borderWidth=t)},borderWidth(t){this.$emit("input",t)}},methods:{selectedStyle(t){return void 0===t&&(t=this.borderWidth),`border-top-style:${this.borderStyle};border-top-color:${this.borderColor};border-top-width:${t}px`},change:function(t){this.$emit("change",t)}}},Lo=Eo,Ao=Object(mt["a"])(Lo,Io,Po,!1,null,null,null),Mo=Ao.exports;function Fo(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function Ro(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?Fo(Object(o),!0).forEach((function(e){Object(it["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):Fo(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var No={name:"config-col",components:{AlignButton:bo,ColorPicker:Oo,BorderStyleSelect:$o,BorderWidthSelect:Mo},props:["selectedCol"],computed:{},data(){return this.getShowData()},methods:Ro(Ro(Ro({},Object(Dt["d"])(["setColBorder","setColStyle"])),Object(Dt["b"])(["setColAllBorder","setColBorderDetail"])),{},{getShowData(){if(!this.selectedCol)return{};const t=Object(Ot["d"])(this.selectedCol.style.border),e=t.bottom.width,o=t.bottom.style,n=t.bottom.color;return{textAlign:this.selectedCol.style.textAlign||"left",verticalAlign:this.selectedCol.style.verticalAlign||"middle",border:t,borderWidth:e,borderStyle:o,borderColor:n,currentView:"normal"}},toggleView(){this.currentView="normal"==this.currentView?"advance":"normal"},onBorderChange(t,e,o){this.setColBorderDetail({dir:t,prop:e,value:o,selectedCol:this.selectedCol,group:"adv-border"}),"style"==e&&"double"==o&&this.border[t].width<4&&this.showBorderStyleMessage()},onBorderStyleChange(t){"double"==t&&this.borderWidth<4&&this.showBorderStyleMessage()},showBorderStyleMessage(){this.$message({type:"info",message:"双线边框效果仅可在边框宽度大于3px时呈现"})}}),watch:{selectedCol(t,e){if(this.selectedCol){const t=Object(Ot["d"])(this.selectedCol.style.border),o=t.bottom.width,n=t.bottom.style,i=t.bottom.color;e?(this.border=t,this.verticalAlign=this.selectedCol.style.verticalAlign,this.textAlign=this.selectedCol.style.textAlign,this.borderWidth=o,this.borderStyle=n,this.borderColor=i):(this.$set(this,"border",t),this.$set(this,"verticalAlign",this.selectedCol.style.verticalAlign),this.$set(this,"textAlign",this.selectedCol.style.textAlign),this.$set(this,"borderWidth",o),this.$set(this,"borderStyle",n),this.$set(this,"borderColor",i))}},borderWidth(t){this.setColAllBorder({prop:"width",value:t})},borderStyle(t){this.setColAllBorder({prop:"style",value:t})},borderColor(t){this.setColAllBorder({prop:"color",value:t})},textAlign(t){t!=this.selectedCol.style.textAlign&&this.setColStyle({prop:"textAlign",value:t,selectedCol:this.selectedCol,shuttle:!0})},verticalAlign(t){t!=this.selectedCol.style.verticalAlign&&this.setColStyle({prop:"verticalAlign",value:t,selectedCol:this.selectedCol,shuttle:!0})}}},Vo=No,Bo=Object(mt["a"])(Vo,no,io,!1,null,null,null),zo=Bo.exports,Ho={name:"config-cell",components:{ConfigAccItem:oo,ConfigCol:zo},props:["selectedCol"],computed:{type(){const t=this.selectedCol.type;return t||"col-item"},componentName(){return"acc-item"==this.type?oo:"col-item"==this.type?zo:""}}},Go=Ho,qo=Object(mt["a"])(Go,Ye,Xe,!1,null,null,null),Wo=qo.exports,Uo=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"config-form"},[o("div",{staticClass:"config-block"},[o("h3",{staticClass:"config-category"},[t._v("\n      全局文字\n      "),o("el-tooltip",{attrs:{placement:"right",content:"将影响所有控件"}},[o("span",{staticClass:"design-help"})])],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("字体")]),o("el-select",{staticClass:"font-set-select",attrs:{size:"small"},model:{value:t.fontFamily,callback:function(e){t.fontFamily=e},expression:"fontFamily"}},t._l(t.fontFamilyList,(function(t){return o("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})})),1),o("el-input-number",{staticClass:"font-set-input",attrs:{size:"small",controls:!1,min:12,max:100},model:{value:t.fontSize,callback:function(e){t.fontSize=e},expression:"fontSize"}}),o("span",{staticClass:"form-control-suffix"},[t._v("px")])],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("样式")]),o("FontColor",{staticStyle:{"margin-right":"10px"},model:{value:t.fontColor,callback:function(e){t.fontColor=e},expression:"fontColor"}}),o("div",{staticClass:"design-button-group font-group"},[o("el-tooltip",{attrs:{"open-delay":500,content:"加粗"}},[o("MyButton",{class:{active:t.fontBolder},attrs:{icon:"font-bold"},nativeOn:{click:function(e){t.fontBolder=!t.fontBolder}}})],1),o("el-tooltip",{attrs:{"open-delay":500,content:"倾斜"}},[o("MyButton",{class:{active:t.fontItalic},attrs:{icon:"font-italic"},nativeOn:{click:function(e){t.fontItalic=!t.fontItalic}}})],1),o("el-tooltip",{attrs:{"open-delay":500,content:"下划线"}},[o("MyButton",{class:{active:t.fontUnderline},attrs:{icon:"font-underline"},nativeOn:{click:function(e){t.fontUnderline=!t.fontUnderline}}})],1)],1)],1)]),o("div",{staticClass:"config-block"},[o("h3",{staticClass:"config-category"},[t._v("\n      全局单元格\n      "),o("el-tooltip",{attrs:{placement:"right",content:"将影响所有单元格"}},[o("span",{staticClass:"design-help"})])],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("对齐")]),o("AlignButton",{attrs:{type:"horizontal"},model:{value:t.textAlign,callback:function(e){t.textAlign=e},expression:"textAlign"}}),o("AlignButton",{attrs:{type:"vertical"},model:{value:t.verticalAlign,callback:function(e){t.verticalAlign=e},expression:"verticalAlign"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("高度")]),o("el-input-number",{staticClass:"height-set-input",attrs:{size:"small",controls:!1,min:t.MIN_ROW_HEIGHT,max:2e3},on:{change:t.setHeight},model:{value:t.height,callback:function(e){t.height=e},expression:"height"}}),o("span",{staticClass:"form-control-suffix"},[t._v("px")])],1)]),o("div",{staticClass:"config-block"},[o("h3",{staticClass:"config-category"},[t._v("\n      全局边框\n      "),o("el-tooltip",{attrs:{placement:"right",content:"将影响所有单元格"}},[o("span",{staticClass:"design-help"})])],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("线宽")]),o("BorderWidthSelect",{attrs:{"border-color":t.borderColor,"border-style":t.borderStyle},model:{value:t.borderWidth,callback:function(e){t.borderWidth=e},expression:"borderWidth"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("线性")]),o("BorderStyleSelect",{attrs:{"border-width":t.borderWidth,"border-color":t.borderColor,disabled:!t.borderWidth},on:{change:t.onBorderStyleChange},model:{value:t.borderStyle,callback:function(e){t.borderStyle=e},expression:"borderStyle"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("颜色")]),o("ColorPicker",{attrs:{disabled:!t.borderWidth},model:{value:t.borderColor,callback:function(e){t.borderColor=e},expression:"borderColor"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("外边框")]),o("AllBorderType",{staticClass:"form-control",attrs:{"border-type":t.allBorderType},on:{active:t.handleBorderTypeChange}})],1)]),o("div",{staticClass:"config-block"},[o("h3",{staticClass:"config-category"},[t._v("控件配置")]),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("label自动冒号")]),o("el-switch",{attrs:{"border-color":t.borderColor,"border-style":t.borderStyle},model:{value:t.autoColons,callback:function(e){t.autoColons=e},expression:"autoColons"}})],1)]),o("div",{staticClass:"config-block"},[o("h3",{staticClass:"config-category"},[t._v("预设风格")]),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("风格选择")]),o("el-select",{staticStyle:{width:"120px","margin-right":"10px",display:"inline-block"},on:{change:t.onSkinChange},model:{value:t.currentSkin,callback:function(e){t.currentSkin=e},expression:"currentSkin"}},t._l(t.skins,(function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})),1),o("el-button",{attrs:{type:"primary",disabled:!t.isNewSkin},on:{click:t.createNewSkin}},[t._v("存为新风格")])],1)])])},Jo=[],Yo=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("ColorPicker",{model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}},[o("span",{staticClass:"font-color-button design-button"},[o("span",{staticClass:"font-color-holder design-button-icon"}),o("span",{staticClass:"font-current-color",style:"background:"+t.currentValue})])])},Xo=[],Ko={name:"control-font-color",props:["value"],components:{ColorPicker:Oo},data(){return{currentValue:this.value||"#000"}},watch:{value(t){this.currentValue=t},currentValue(t){this.$emit("input",t)}}},Qo=Ko,Zo=Object(mt["a"])(Qo,Yo,Xo,!1,null,null,null),tn=Zo.exports,en=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"form-control-item  form-all-border"},t._l(t.list1,(function(e){return o("el-tooltip",{key:e,attrs:{"open-delay":500,placement:"top",content:t.tipsText[e]}},[o("MyButton",{class:{active:e==t.currentType},attrs:{icon:"all-border-"+e},nativeOn:{click:function(o){return t.handleChange(e)}}})],1)})),1),o("div",{staticClass:"form-control-item form-all-border"},t._l(t.list2,(function(e){return o("el-tooltip",{key:e,attrs:{"open-delay":500,placement:"top",content:t.tipsText[e]}},[o("MyButton",{class:{active:e==t.currentType},attrs:{icon:"all-border-"+e},nativeOn:{click:function(o){return t.handleChange(e)}}})],1)})),1)])},on=[],nn={name:"form-all-border-config",components:{MyButton:po},props:{borderType:{type:String,default:"all"}},data(){return{currentType:this.borderType,list1:["all","inner","hline","vline","outer"],list2:["left","top","right","bottom","none"],tipsText:{all:"全部框线",inner:"仅内框线",hline:"仅水平线",vline:"仅垂直线",outer:"仅外边框",left:"仅左框线",top:"仅上框线",right:"仅右框线",bottom:"仅底框线",none:"无框线"}}},methods:{handleChange(t){this.currentType=t,this.$emit("active",t)}},watch:{borderType(t){this.currentType=t}}},sn=nn,rn=Object(mt["a"])(sn,en,on,!1,null,null,null),ln=rn.exports;function an(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function cn(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?an(Object(o),!0).forEach((function(e){Object(it["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):an(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}const dn=Object(Ot["d"])(window.FORM_DESIGN_CONFIG.preset.fontFamilyList);var un={name:"config-form",components:{AlignButton:bo,FontColor:tn,BorderStyleSelect:$o,BorderWidthSelect:Mo,MyButton:po,ColorPicker:Oo,AllBorderType:ln},computed:cn(cn({},Object(Dt["e"])(["globalStyle","skin"])),{},{fontFamilyList(){return dn}}),mounted(){this.getSkinList()},data(){const t=this.globalStyle||this.$store.state.globalStyle,e=t.border;return{MIN_ROW_HEIGHT:_t["b"],currentSkin:this.skin||"",skins:[],isNewSkin:!1,height:t.cellHeight||_t["b"],borderWidth:e.top.width||1,borderStyle:e.top.style||"solid",borderColor:e.top.color||"#dddddd",fontSize:t.fontSize,fontFamily:t.fontFamily,fontColor:t.fontColor,fontBolder:t.fontBolder,fontItalic:t.fontItalic,fontUnderline:t.fontUnderline,textAlign:t.textAlign,verticalAlign:t.verticalAlign,autoColons:t.autoColons,allBorderType:t.allBorderType||"all",heightPerset:{selected:"compact",list:[{label:"紧凑",value:"compact"},{label:"2倍",value:40},{label:"50",value:50},{label:"自定义",value:30}]}}},methods:cn(cn({},Object(Dt["b"])({setBorder:"setGlobalBorder",setStyle:"setGlobalStyle"})),{},{getSkinList(){return this.$httpPost(window.formDesignerActions.getSkinListUrl).then(t=>{Array.isArray(t.skinList)?this.skins=t.skinList:this.skins=[]})},onBorderStyleChange(t){"double"==t&&this.borderWidth<4&&this.$message({type:"info",message:"双线边框效果仅可在边框宽度大于3px时呈现"})},onSkinChange(t){const e=this.skins.filter(e=>e.id==t)[0];if(!e||!e.data)return;const o=Object(Ot["d"])(e.data);this.$store.dispatch({type:"applySkin",skinData:o,skin:this.currentSkin}),this.$nextTick(()=>{this.isNewSkin=!1})},createNewSkin(){this.$prompt("请输入新风格名称","创建新风格",{confirmButtonText:"确定",cancelButtonText:"取消",inputValidator(t){return t&&t.trim()?!!/^[\d\w-_\u4E00-\u9FA5]+$/.test(t)||"风格名称格式不正确":"风格名称不能为空"}}).then(t=>{let e=t.value;this.saveNewSkin(e)})},saveNewSkin(t){const e=Object(Ot["d"])(this.globalStyle);return delete e.cellHeight,this.$httpPost(window.formDesignerActions.addSkinUrl,{skinName:t,data:e}).then(o=>{this.currentSkin=o.id,this.skins.push({id:this.currentSkin,name:t,data:e}),this.$nextTick(()=>{this.isNewSkin=!1}),this.$message({type:"success",message:"保存成功"})}).catch(t=>{console.error(t),this.$message({type:"error",message:"保存失败"})})},getData(){const t=this.globalStyle||this.$store.state.globalStyle,e=t.border;return{height:t.cellHeight||_t["b"],borderWidth:e.top.width||1,borderStyle:e.top.style||"solid",borderColor:e.top.color||"#dddddd",fontSize:t.fontSize,fontFamily:t.fontFamily,fontColor:t.fontColor,fontBolder:t.fontBolder,fontItalic:t.fontItalic,fontUnderline:t.fontUnderline,textAlign:t.textAlign,verticalAlign:t.verticalAlign,autoColons:t.autoColons}},handleChange(t,e){t!==this.globalStyle[e]&&this.setStyle({prop:e,value:t})},setHeight(t){this.$store.dispatch("setAllRowHeight",{height:t})},handleBorderTypeChange(t){this.isNewSkin=!0,this.borderWidth,this.$store.dispatch("setAllBorderType",{type:t,borderWidth:this.borderWidth})}}),watch:{globalStyle(t){const e=t.border;this.height=t.cellHeight||_t["b"],this.borderWidth=e.top.width||1,this.borderStyle=e.top.style||"solid",this.borderColor=e.top.color||"#dddddd",this.fontSize=t.fontSize,this.fontFamily=t.fontFamily,this.fontColor=t.fontColor,this.fontBolder=t.fontBolder,this.fontItalic=t.fontItalic,this.fontUnderline=t.fontUnderline,this.textAlign=t.textAlign,this.verticalAlign=t.verticalAlign,this.autoColons=t.autoColons,this.allBorderType!=t.allBorderType&&(this.allBorderType=t.allBorderType,this.handleBorderTypeChange(this.allBorderType))},borderWidth(t){this.isNewSkin=!0,this.setBorder({prop:"width",value:t})},borderStyle(t){this.isNewSkin=!0,this.setBorder({prop:"style",value:t})},borderColor(t){this.isNewSkin=!0,this.setBorder({prop:"color",value:t})},autoColons(t){this.isNewSkin=!0,this.handleChange(t,"autoColons")},fontSize(t){this.isNewSkin=!0,this.handleChange(t,"fontSize")},fontFamily(t){this.isNewSkin=!0,this.handleChange(t,"fontFamily")},fontColor(t){this.isNewSkin=!0,this.handleChange(t,"fontColor")},fontBolder(t){this.isNewSkin=!0,this.handleChange(t,"fontBolder")},fontItalic(t){this.isNewSkin=!0,this.handleChange(t,"fontItalic")},fontUnderline(t){this.isNewSkin=!0,this.handleChange(t,"fontUnderline")},textAlign(t){this.isNewSkin=!0,this.handleChange(t,"textAlign")},verticalAlign(t){this.isNewSkin=!0,this.handleChange(t,"verticalAlign")},skin:{immediate:!0,handler(t){t!==this.currentSkin&&(this.isNewSkin=!1,this.currentSkin=t)}}}},hn=un,pn=Object(mt["a"])(hn,Uo,Jo,!1,null,null,null),mn=pn.exports,fn=function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.control?o("div",{staticClass:"config-control"},[o("NameConfig",{attrs:{"component-data":t.control,type:t.controlType},on:{change:t.onNameChange,remove:t.removeControl}}),t.supportEvent?o("div",{staticClass:"config-control-tabs"},[o("span",{staticClass:"config-control-tab",class:{active:"attribute"==t.currentView},on:{click:function(e){t.currentView="attribute"}}},[t._v("属性")]),o("span",{staticClass:"config-control-tab",class:{active:"event"==t.currentView},on:{click:function(e){t.currentView="event"}}},[t._v("事件("+t._s(t.eventCount)+")")])]):t._e(),o("div",{staticClass:"config-control-tabcontent",class:{"with-event":t.supportEvent}},["attribute"==t.currentView?o("div",{staticClass:"attribute-block"},t._l(t.controlConfig,(function(e,n){return o("div",{key:n,staticClass:"config-block"},[o("h3",{staticClass:"config-category"},[t._v(t._s(e.category))]),t._l(e.items,(function(e){return o("div",{key:e.label||e.extends+"",class:{"form-item":!e.extends,"form-extend":!!e.extends}},[t._l(t.getExtends(e.extends),(function(e){return o(t.getControlComponent(e),{key:t.control.id+"-"+e,tag:"component",attrs:{"control-data":t.control},on:{change:t.handleExtendChange}})})),e.extends?t._e():o("label",{staticClass:"form-label"},[t._v(t._s(e.label))]),e.extends?t._e():o("div",{staticClass:"form-control"},t._l(e.controls,(function(e){return o(t.getControlComponent(e.type),{key:t.control.id+"-"+e.associatedProp,tag:"component",staticClass:"form-control-item",class:e.type,attrs:{config:e,value:t.getControlValue(t.control,e)},on:{change:t.change}})})),1)],2)}))],2)})),0):t._e(),"event"==t.currentView?o("div",{staticClass:"event-block"},[o("EventComponent",{attrs:{"control-data":t.control}})],1):t._e()])],1):t._e()},gn=[],bn=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"component-name-config config-block"},[o("h3",{staticClass:"component-type config-category"},[t._v("\n    "+t._s(t.type)+"\n    "),o("span",{staticClass:"remove-component",on:{click:t.onComponentRemove}},[t._v("删除")])]),o("div",{staticClass:"component-name-block"},[o("div",{directives:[{name:"show",rawName:"v-show",value:!t.showEditor,expression:"!showEditor"}],staticClass:"component-name",attrs:{title:t.name},on:{click:function(e){t.editorValue=t.name,t.showEditor=!0}}},[t._v(t._s(t.name))]),t.showEditor?o("div",[o("div",{staticClass:"el-input el-input--mini",staticStyle:{width:"50%","margin-right":"6px"}},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.editorValue,expression:"editorValue"}],staticClass:"el-input__inner",attrs:{size:"mini"},domProps:{value:t.editorValue},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submitName(e)},input:function(e){e.target.composing||(t.editorValue=e.target.value)}}})]),o("el-button",{attrs:{icon:"el-icon-check",size:"mini",circle:""},on:{click:t.submitName}})],1):t._e()])])},yn=[],vn={name:"name-config",props:["componentData","type"],computed:{},data(){return{name:this.componentData.name||this.getComponentName(),showEditor:!1,editorValue:""}},methods:{getComponentName(){const t=this.componentData,e=t.namePrefix,o=t.autoIndex;return e&&o?`${e}${o}`:this.type},onComponentRemove(){this.$emit("remove")},change(t){this.$emit("change",t)},submitName(){const t=this.editorValue.trim();return t?/^[^\d][\d\w\u4E00-\u9FA5]+$/.test(t)?(this.componentData.name!=t&&(this.name=t,this.change(t)),void(this.showEditor=!1)):this.$message({message:"组件名称不合法，只接受非数字开头的汉字、字母、数字组合",type:"error",showClose:!0}):this.$message({message:"必须输入组件件名称",type:"error",showClose:!0})}},watch:{"componentData.id"(){this.showEditor=!1,this.name=this.componentData.name||this.getComponentName()}}},Cn=vn,wn=(o("d5c7"),Object(mt["a"])(Cn,bn,yn,!1,null,null,null)),xn=wn.exports,Dn=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-checkbox",{attrs:{value:t.value},on:{change:t.change}},[t._v(t._s(t.config.text))])},On=[],_n={name:"control-checkbox",props:{value:{type:Boolean,require:!0},config:{type:Object,require:!0}},methods:{change(t){this.$emit("change",t,this.config)}}},kn=_n,Sn=Object(mt["a"])(kn,Dn,On,!1,null,null,null),Tn=Sn.exports,jn=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-checkbox-group",{class:"direction-"+t.direction,on:{change:t.change},model:{value:t.valueList,callback:function(e){t.valueList=e},expression:"valueList"}},t._l(t.optionList,(function(e){return o("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])})),1)},$n=[],In=o("da81"),Pn=o.n(In),En={methods:{getOriginData(t,e){if(!t)throw new Error("url is required!");let o;e&&(o=Pn()({},e)),this.loading=!0,this.$httpPost(t,o).then(t=>{const e=[];if(!Array.isArray(t))throw new Error("远程数据必须为数组");return t.forEach(t=>{void 0!==t.id&&void 0!==t.text?e.push(t):console.warn("id or text is not a valid type! "+JSON.stringify(t))}),this.loading=!1,this.originOptionList=e,e}).catch(t=>{this.loading=!1,console.error(t)})}}};const Ln=window.FORM_DESIGN_CONFIG.preset;var An={name:"control-checkboxlist",mixins:[En],props:{value:{type:String,require:!0},config:{type:Object,require:!0},styleText:{type:String,default:"width:200px"}},data(){return{valueList:this.getValueList(),loading:!1,originOptionList:[]}},created(){!this.config.data&&this.config.url&&this.getOriginData(this.config.url)},computed:{direction(){return this.config.direction||"horizontal"},optionList(){return this.config.data?this.staticOptionList:this.originOptionList},staticOptionList(){const t=this.config.data;if(!t)return[];if(Array.isArray(t))return t;const e=t+""===t;if(e){if(t in Ln)return Ln[t];const e=t.replace(/^epointsform\./,"");if(e&&Array.isArray(this.$store.state[e]))return Object(Ot["d"])(this.$store.state[e])}return[]}},methods:{getValueList(){return this.value?this.value.split(","):[]},change(t){this.$emit("change",t.join(","),this.config)}}},Mn=An,Fn=Object(mt["a"])(Mn,jn,$n,!1,null,null,null),Rn=Fn.exports,Nn=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-select",{style:t.styleText,attrs:{value:t.value,size:"small",filterable:"",clearable:""},on:{change:t.change}},t._l(t.optionList,(function(t){return o("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})})),1)},Vn=[];const Bn=window.FORM_DESIGN_CONFIG.preset;var zn={name:"control-combobox",mixins:[En],props:{value:{type:String,require:!0},config:{type:Object,require:!0},styleText:{type:String,default:""}},data(){return{loading:!1,originOptionList:[]}},created(){!this.config.data&&this.config.url&&this.getOriginData(this.config.url)},computed:{optionList(){return this.config.data?this.staticOptionList:this.originOptionList},staticOptionList(){const t=this.config.data;if(!t)return[];if(Array.isArray(t))return t;const e=t+""===t;if(e){if(t in Bn)return Bn[t];const e=t.replace(/^epointsform\./,"");if(e&&Array.isArray(this.$store.state[e]))return Object(Ot["d"])(this.$store.state[e])}return[]}},methods:{change(t){this.$emit("change",t,this.config)}}},Hn=zn,Gn=Object(mt["a"])(Hn,Nn,Vn,!1,null,null,null),qn=Gn.exports,Wn=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{},[o("el-select",{staticStyle:{display:"block"},attrs:{size:"small"},on:{change:t.typeChange},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},t._l(t.typeList,(function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1),t.type==t.TYPE_MAP.date?o("el-date-picker",{staticStyle:{"margin-top":"8px"},attrs:{"popper-class":"default-date-popper",type:"datetime",placeholder:"请选择一个日期",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",editable:!1,size:"small"},on:{change:t.dateChange},model:{value:t.selectDate,callback:function(e){t.selectDate=e},expression:"selectDate"}}):t._e()],1)},Un=[];function Jn(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function Yn(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?Jn(Object(o),!0).forEach((function(e){Object(it["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):Jn(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}const Xn="[currDate]",Kn=/^\d{4}-\d{2}-\d{2}/,Qn={empty:"empty",currDate:"currDate",date:"date"};var Zn={name:"control-default-date",props:["config","value"],data(){return Yn(Yn({},this.getDataFromValue(this.value)),{},{TYPE_MAP:Qn,typeList:[{id:Qn.empty,text:"留空"},{id:Qn.currDate,text:"填报日期"},{id:Qn.date,text:"指定日期"}]})},methods:{getDataFromValue(t){return t?/^\[.+\]$/.test(t)?{selectDate:"",type:Qn.currDate}:{selectDate:this.getValidDate(t),type:Qn.date}:{selectDate:"",type:Qn.empty}},getValidDate(t){return Kn.test(t)?t:""},typeChange(t){return"empty"==t?this.change(""):"currDate"==t?this.change(Xn):"date"==t&&this.selectDate?this.change(this.selectDate):void 0},dateChange(){"date"==this.type&&this.change(this.selectDate)},change(t){this.$emit("change",t,this.config)}},watch:{value(t){const e=this.getDataFromValue(t);e.type!=this.type&&(this.type=e.type),e.selectDate!=this.selectDate&&(this.selectDate=e.selectDate)}}},ti=Zn,ei=(o("d482"),Object(mt["a"])(ti,Wn,Un,!1,null,null,null)),oi=ei.exports,ni=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("el-select",{attrs:{size:"small"},on:{change:t.configTypeChange},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},t._l(t.typeList,(function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1),t.type==t.typeMap.select?o("div",{staticStyle:{"margin-top":"8px"}},[o("el-input",{attrs:{placeholder:"请选择",value:t.selectedTypes.join(","),size:"small",readonly:""}},[o("el-button",{attrs:{slot:"append",icon:"el-icon-more"},nativeOn:{click:function(e){return t.showDialog(e)}},slot:"append"})],1)],1):t._e(),t.type==t.typeMap.input?o("div",{staticStyle:{"margin-top":"8px"}},[o("el-input",{attrs:{placeholder:"请输入文件扩展名",size:"small"},on:{change:t.userInputChange},model:{value:t.userInputType,callback:function(e){t.userInputType=e},expression:"userInputType"}}),o("el-tooltip",{attrs:{placement:"top",content:"扩展名不带点，多个逗号分隔"}},[o("span",{staticClass:"design-help"})])],1):t._e(),o("el-dialog",{attrs:{visible:t.dialogVisible,title:"类型选择","append-to-body":""},on:{"update:visible":function(e){t.dialogVisible=e}}},[t.type==t.typeMap.select?o("div",{staticClass:"tree-like"},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.dialogSelectedTypes.length,expression:"dialogSelectedTypes.length"}],staticStyle:{"margin-bottom":"10px"}},t._l(t.dialogSelectedTypes,(function(e){return o("el-tag",{key:e,staticStyle:{"margin-right":"4px"},attrs:{size:"mini",closable:""},on:{close:function(o){return t.hanldeRemoveTag(e)}}},[t._v(t._s(e))])})),1),t._l(t.dialogTypeTree,(function(e){return o("div",{key:e.id,staticStyle:{"margin-bottom":"10px"}},[o("div",{staticClass:"file-type-category"},[o("el-checkbox",{attrs:{indeterminate:e.halfChecked,label:e.text},on:{change:function(o){return t.cateCheckedChange(o,e)}},model:{value:e.allChecked,callback:function(o){t.$set(e,"allChecked",o)},expression:"cate.allChecked"}})],1),o("el-checkbox-group",{staticClass:"file-type-group",on:{change:function(o){return t.itemCheckedChange(o,e)}},model:{value:e.checkedArr,callback:function(o){t.$set(e,"checkedArr",o)},expression:"cate.checkedArr"}},t._l(e.items,(function(t){return o("el-checkbox",{key:t.id,staticClass:"file-type-item",attrs:{label:t.id}})})),1)],1)}))],2):t._e(),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:t.submitSelect}},[t._v("确 定")])],1)])],1)},ii=[];const si="[default]",ri={default:"default",empty:"empty",select:"select",input:"input"};var li={name:"control-file-type-picker",props:["config","value"],computed:{selectedTypes(){if(this.type!=this.typeMap.select)return[];const t=[];return this.typeTree.forEach(e=>{e.checkedArr&&e.checkedArr.length&&t.push(...e.checkedArr)}),t},dialogSelectedTypes(){if(this.type!=this.typeMap.select)return[];const t=[];return this.dialogTypeTree.forEach(e=>{e.checkedArr&&e.checkedArr.length&&t.push(...e.checkedArr)}),t}},data(){return{typeMap:ri,dialogVisible:!1,userInputType:"",type:"",typeList:[{id:"default",text:"系统默认"},{id:"empty",text:"不限制"},{id:"select",text:"选择类型"},{id:"input",text:"手动输入"}],typeTree:this.genderTypeTree(this.value),dialogTypeTree:[]}},created(){this.type=this.getTypeFromValue(this.value),this.syncConfigValue()},methods:{syncConfigValue(){this.type==ri.default||this.type==ri.empty?this.userInputType="":this.type==ri.select?(this.userInputType="",this.typeTree=this.genderTypeTree(this.value)):this.userInputType=this.value},getFileTypeMap(){const t={};return this.typeTree.forEach(e=>{e.valueArr.forEach(e=>{t[e]=!0})}),t},getTypeFromValue(t){if(t==si)return ri.default;if(""==t)return ri.empty;const e=t.split(","),o=this.getFileTypeMap();for(let n of e)if(!o[n])return ri.input;return ri.select},genderTypeTree(t){const e=[],o=Object(Ot["d"])(window.FORM_DESIGN_CONFIG.preset["epointsform.fileTypes"]),n=(t||"").split(",");return o.forEach(t=>{t.valueArr=t.items,t.items=this.genderItems(t.valueArr);const o=[];t.valueArr.forEach(t=>{-1!==n.indexOf(t)&&o.push(t)}),t.checkedArr=o,0===t.checkedArr.length?t.allChecked=t.halfChecked=!1:t.checkedArr.length!==t.valueArr.length?(t.allChecked=!1,t.halfChecked=!0):(t.allChecked=!0,t.halfChecked=!1),e.push(t)}),e},genderItems(t){return t.map(t=>({id:t,text:t}))},cateCheckedChange(t,e){t?(e.allChecked=!0,e.halfChecked=!1,e.checkedArr.splice(0,e.checkedArr.length,...e.valueArr)):(e.allChecked=!1,e.halfChecked=!1,e.checkedArr.splice(0,e.checkedArr.length))},itemCheckedChange(t,e){t.length==e.items.length?(e.allChecked=!0,e.halfChecked=!1):t.length?(e.allChecked=!1,e.halfChecked=!0):(e.allChecked=!1,e.halfChecked=!1)},hanldeRemoveTag(t){let e;for(let o of this.dialogTypeTree)if(e=o.checkedArr.indexOf(t),-1!==e){o.allChecked=!1,o.checkedArr.splice(e,1),o.halfChecked=0!==o.checkedArr.length&&o.checkedArr.length!=o.valueArr.length;break}},configTypeChange(t){return t==ri.default?this.change(si):t==ri.empty?this.change(""):t==ri.input?this.userInputType&&this.change(this.userInputType):t==ri.select?this.change(this.selectedTypes.join(",")):void 0},userInputChange(t){if(this.type==ri.input)return this.change(this.userInputType)},change(t){this.$emit("change",t,this.config)},showDialog(){this.dialogTypeTree=Object(Ot["d"])(this.typeTree),this.dialogVisible=!0},submitSelect(){this.dialogVisible=!1,this.change(this.dialogSelectedTypes.join(","))}},watch:{selectedTypes(t){},value(){this.type=this.getTypeFromValue(this.value),this.type==ri.select&&(this.typeTree=this.genderTypeTree(this.value))}}},ai=li,ci=(o("2e74"),Object(mt["a"])(ai,ni,ii,!1,null,null,null)),di=ci.exports,ui=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"control-form-bind"},[o("div",{staticClass:"form-control-item"},[o("el-select",{style:t.styleText,attrs:{value:t.value,size:"small",clearable:"",placeholder:"请选择关联字段",filterable:""},on:{change:t.change}},t._l(t.tables,(function(e,n){return o("el-option-group",{key:e.sqltablename||n,attrs:{label:e.name}},t._l(e.fields,(function(i,s){return o("el-option",{key:i.actualId||n+"_"+s,attrs:{disabled:t.selectedFieldMap[i.actualId],value:i.actualId,label:i.name+"("+e.name+")"}})})),1)})),1),o("el-tooltip",{attrs:{"open-delay":500,content:"新增字段"}},[o("el-button",{staticStyle:{"margin-left":"10px",display:"none"},attrs:{icon:"el-icon-plus",size:"small"},on:{click:t.handleAddField}})],1)],1)])},hi=[],pi=o("3835");function mi(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function fi(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?mi(Object(o),!0).forEach((function(e){Object(it["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):mi(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var gi={name:"control-form-data-combobox",props:{value:{type:String,require:!0},config:{type:Object,require:!0},styleText:{type:String,default:""}},computed:fi(fi(fi({controlType(){const t=this.$store.state.selectedControlId;if(t){const e=this.$store.getters.controlDataMap[t];if(e&&e.control)return e.control.type}return null}},Object(Dt["e"])(["fieldList"])),Object(Dt["c"])(["selectedFieldMap"])),{},{tables(){const t=this.controlType,e=Object(Ot["d"])(this.fieldList),o=Object(Ot["d"])(this.$store.state.newFieldList),n=!this.value||/#/.test(this.value),i=[];if(e.forEach((e,s)=>{0==s&&o.length&&(e.fields=o.concat(e.fields)),e.fields.forEach(o=>{o.actualId=this.joinId(e,o,n),t&&o.fielddisplaytype==t&&i.push(Object(Ot["d"])(o))})}),i.length){const t={name:"相关字段",id:"adapts",fields:i};e.unshift(t)}return e}}),methods:{joinId(t,e,o){return o?`#${t.sqltablename||""};#${e.fieldname||""}`:t.id+";"+e.field},change(t){let e=t;t&&!/#/.test(t)&&(e=this.getNewBindValue(t)),this.$emit("change",e,this.config)},getNewBindValue(t){const e=t.split(";"),o=Object(pi["a"])(e,2),n=o[0],i=o[1];if(!n||!i)return t;const s=this.$store.state.fieldList;let r,l;for(let a=0;a<s.length;a++)if(s[a].id==n){r=s[a];for(let t=0;t<r.fields.length;t++)if(i==r.fields[t].field){l=r.fields[t];break}break}return r&&l?this.joinId(r,l,!0):t},doBindAfterCreate(t){const e=this.fieldList[0];if(e){const o=this.joinId(e,t,!0);o&&this.change(o)}},old2new(){if(this.value&&/#/.test(this.value)){const t=this.value.split(";"),e=Object(pi["a"])(t,2),o=e[0],n=e[1];if(!o||!n)return;const i=o.split("#"),s=n.split("#");if(i[1]&&s[1]){const t=`#${i[1]};#${s[1]}`;this.value!==t&&(this.value,this.change(t))}}},handleAddField(){this.$bus.$emit("createBindField",t=>{this.doBindAfterCreate(t)})}},mounted(){this.old2new()}},bi=gi,yi=Object(mt["a"])(bi,ui,hi,!1,null,null,null),vi=yi.exports,Ci=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-tooltip",{attrs:{"popper-class":"control-help-popper",placement:t.placement,content:t.currentValue}},[o("div",{attrs:{slot:"content"},domProps:{innerHTML:t._s(t.currentValue)},slot:"content"}),o("span",{staticClass:"design-help"})])},wi=[],xi={name:"control-help",props:{config:{type:Object,default:()=>({}),required:!0}},data(){return{placement:this.config.placement||"right",currentValue:this.getContent()}},watch:{"config.content"(){this.currentValue=this.getContent()}},methods:{getContent(){let t=this.config.content;return t?(Array.isArray(t)&&(t=t.join("<br>")),t.replace(/<script/,""),t=t.replace(/ /g,"&nbsp;"),t):""}}},Di=xi,Oi=Object(mt["a"])(Di,Ci,wi,!1,null,null,null),_i=Oi.exports,ki=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-date-picker",{attrs:{type:"month",placeholder:"请选择月份",format:"yyyy-MM","value-format":"yyyy-MM",editable:!1,size:"small"},on:{change:t.change},model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}})},Si=[],Ti={name:"control-monthpicker",props:{value:{type:String,default:""},config:{type:Object,require:!0},styleText:{type:String,default:"width:200px"}},data(){return{currentValue:this.value||""}},watch:{value(t){this.currentValue=t}},methods:{change(t){this.$emit("change",t,this.config)}}},ji=Ti,$i=Object(mt["a"])(ji,ki,Si,!1,null,null,null),Ii=$i.exports,Pi=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{class:{suffix:t.config.suffix}},[o("el-input-number",{staticStyle:{"text-align":"left"},style:t.styleText,attrs:{placeholder:t.config.placeholder||"请输入"+(t.config.label||""),size:"small","controls-position":"right",controls:!1},on:{change:t.change},model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}}),t.config.suffix?o("span",{staticClass:"form-control-suffix"},[t._v(t._s(t.config.suffix))]):t._e()],1)},Ei=[],Li={name:"control-number-textbox",props:{value:{type:[Number,String],default:()=>""},config:{type:Object,require:!0},styleText:{type:String,default:""}},data(){return{currentValue:parseInt(this.value,10)||0}},watch:{value(t){this.currentValue=parseInt(t,10)||0}},methods:{change(t){this.$emit("change",t,this.config)}}},Ai=Li,Mi=Object(mt["a"])(Ai,Pi,Ei,!1,null,null,null),Fi=Mi.exports,Ri=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-radio-group",{class:"direction-"+t.direction,on:{change:t.change},model:{value:t.currValue,callback:function(e){t.currValue=e},expression:"currValue"}},t._l(t.optionList,(function(e){return o("el-radio",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])})),1)},Ni=[];const Vi=window.FORM_DESIGN_CONFIG.preset;var Bi={name:"control-radio-list",mixins:[En],props:{value:{type:String,require:!0},config:{type:Object,require:!0}},data(){return{currValue:this.value,loading:!1,originOptionList:[]}},created(){!this.config.data&&this.config.url&&this.getOriginData(this.config.url)},watch:{value(){this.currValue=this.value}},computed:{direction(){return this.config.direction||"horizontal"},optionList(){return this.config.data?this.staticOptionList:this.originOptionList},staticOptionList(){const t=this.config.data;if(!t)return[];if(Array.isArray(t))return t;const e=t+""===t;return e&&t in Vi?Vi[t]:[]}},methods:{change(t){this.$emit("change",t,this.config)}}},zi=Bi,Hi=Object(mt["a"])(zi,Ri,Ni,!1,null,null,null),Gi=Hi.exports,qi=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-switch",{on:{change:t.change},model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}})},Wi=[],Ui={name:"control-switch",props:{value:{type:Boolean,default:!1},config:{type:Object,require:!0},styleText:{type:String,default:"width:200px"}},data(){return{currentValue:this.value||!1}},watch:{value(t){this.currentValue=t}},methods:{change(t){this.$emit("change",t,this.config)}}},Ji=Ui,Yi=Object(mt["a"])(Ji,qi,Wi,!1,null,null,null),Xi=Yi.exports,Ki=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{class:{suffix:t.config.suffix}},[o("el-input",{ref:"input",style:t.styleText,attrs:{placeholder:t.config.placeholder||"请输入"+(t.config.label||""),size:"small"},on:{change:t.change},model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}}),t.config.suffix?o("span",{staticClass:"form-control-suffix"},[t._v(t._s(t.config.suffix))]):t._e()],1)},Qi=[],Zi={name:"control-textbox",props:{value:{type:String,default:""},config:{type:Object,require:!0},styleText:{type:String,default:""}},data(){return{currentValue:this.value||""}},watch:{value(t){this.currentValue=t}},methods:{focus(){this.$refs.input.select()},change(t){this.$emit("change",t,this.config)}}},ts=Zi,es=Object(mt["a"])(ts,Ki,Qi,!1,null,null,null),os=es.exports,ns=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"form-control-item width-set",style:t.styleText},[o("el-select",{staticClass:"width-set-select",attrs:{size:"small"},on:{change:t.typeChange},model:{value:t.currType,callback:function(e){t.currType=e},expression:"currType"}},[o("el-option",{attrs:{label:"百分比",value:"percent"}}),o("el-option",{attrs:{label:"像素",value:"number"}})],1),o("el-input-number",{staticClass:"width-set-input",attrs:{min:t.min,max:t.max,size:"small",controls:!1},on:{change:t.change},model:{value:t.currValue,callback:function(e){t.currValue=e},expression:"currValue"}}),o("span",{staticClass:"form-unit form-control-suffix"},[t._v(t._s("percent"==this.currType?"%":"px"))])],1)},is=[];function ss(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function rs(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?ss(Object(o),!0).forEach((function(e){Object(it["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):ss(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var ls={name:"control-width-set",props:{value:{type:[String,Number],require:!0},config:{type:Object,require:!0},styleText:{type:String,default:""}},data(){const t=this.getAdaptedData(this.value);return rs({min:1},t)},watch:{value(){const t=this.getAdaptedData(this.value);this.currType=t.currType,this.currValue=t.currValue,this.max=t.max}},methods:{getAdaptedData(t){const e=t+""===t,o=parseInt(t,10)||100;return{currType:e?"percent":"number",currValue:e?Math.min(100,o):o,max:e?100:1/0}},typeChange(){this.change(this.currValue)},change(t){const e="percent"==this.currType?t+"%":t;this.$emit("change",e,this.config)}}},as=ls,cs=Object(mt["a"])(as,ns,is,!1,null,null,null),ds=cs.exports,us=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"preset-align"},[o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("对齐")]),o("AlignButton",{attrs:{type:"horizontal"},model:{value:t.textAlign,callback:function(e){t.textAlign=e},expression:"textAlign"}})],1)])},hs=[],ps={name:"extend-font-align",components:{AlignButton:bo},props:["controlData"],data(){return{textAlign:this.controlData.textAlign}},watch:{"controlData.textAlign"(t){this.textAlign=t},textAlign(t){t!=this.controlData.textAlign&&this.$emit("change",t,"textAlign")}}},ms=ps,fs=Object(mt["a"])(ms,us,hs,!1,null,null,null),gs=fs.exports,bs=function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.controlData.popup?o("div",{staticClass:"extend-buttonedit-field"},[o("div",{staticClass:"form-item"},[o("div",{staticClass:"form-label"},[t._v("值字段")]),o("div",{staticClass:"form-control"},[o("el-select",{attrs:{size:"small"},model:{value:t.idField,callback:function(e){t.idField=e},expression:"idField"}},t._l(t.list,(function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1)]),o("div",{staticClass:"form-item"},[o("div",{staticClass:"form-label"},[t._v("显示字段")]),o("div",{staticClass:"form-control"},[o("el-select",{attrs:{size:"small"},model:{value:t.textField,callback:function(e){t.textField=e},expression:"textField"}},t._l(t.list,(function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1)])]):t._e()},ys=[];const vs={};function Cs(t,e,o){const n=t+o;return vs[n]||(vs[n]=Object(Ot["i"])(t,e).catch(t=>{vs[n]=null,delete vs[n],console.error(t)})),vs[n]}var ws=Cs,xs={name:"extend-buttonedit-field",props:["controlData"],data(){return{list:[],idField:this.controlData.idField||"",textField:this.controlData.textField||""}},mounted(){this.controlData.popup&&this.getList(this.controlData.popup)},methods:{getList(t){ws(window.formDesignerActions.getListStructUrl,{listGuid:t},"buttoneditStruct-"+t).then(t=>{if(!Array.isArray(t.ListStruct))throw new TypeError("列表必须为数组");this.list=t.ListStruct,this.checkIn(this.idField,"id",this.list)||(this.idField=""),this.checkIn(this.textField,"id",this.list)||(this.textField="")}).catch(t=>{this.list=[],this.idField=this.textField="",this.console.error(t)})},checkIn(t,e,o){for(let n of o)if(n[e]==t)return!0;return!1},change(t,e){this.$emit("change",t,e)}},watch:{"controlData.popup"(t){t?this.getList(t):(this.list=[],this.idField=this.textField="")},idField(t){t!=this.controlData.idField&&this.change(t,"idField")},textField(t){t!=this.controlData.textField&&this.change(t,"textField")}}},Ds=xs,Os=Object(mt["a"])(Ds,bs,ys,!1,null,null,null),_s=Os.exports,ks=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"preset-data-action",class:{disabled:t.hasAutoCodeItem}},[t.hasAutoCodeItem?o("div",{staticClass:"tips"},[o("i",{staticClass:"el-icon-info",staticStyle:{color:"#409EFF"}}),t._v(" 选中的关联字段已经有对应数据源了")]):t._e(),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("配置方式")]),o("div",{staticClass:"form-control"},[o("el-radio-group",{attrs:{disabled:t.hasAutoCodeItem},model:{value:t.sourceType,callback:function(e){t.sourceType=e},expression:"sourceType"}},t._l(t.sourceList,(function(e){return o("el-radio",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])})),1)],1)]),o("div",{directives:[{name:"show",rawName:"v-show",value:"static"==t.sourceType,expression:"sourceType == 'static'"}],staticClass:"form-item"},[o("el-form",{ref:"dataActionForm",attrs:{model:t.customData,inline:!0,disabled:t.hasAutoCodeItem}},t._l(t.customData,(function(e,n){return o("div",{key:n,staticClass:"data-source-item"},[o("el-form-item",{staticClass:"data-source-input value",attrs:{prop:n+".id",rules:t.rules.id}},[o("el-input",{attrs:{placeholder:"值",size:"mini"},model:{value:e.id,callback:function(o){t.$set(e,"id",o)},expression:"item.id"}})],1),o("el-form-item",{staticClass:"data-source-input text",attrs:{prop:n+".text",rules:t.rules.text}},[o("el-input",{attrs:{placeholder:"显示名称",size:"mini"},model:{value:e.text,callback:function(o){t.$set(e,"text",o)},expression:"item.text"}})],1),o("el-button",{staticClass:"data-source-item-btn del",attrs:{type:"danger",plain:"",size:"mini",icon:"el-icon-delete"},on:{click:function(e){return t.deleteItem(n)}}}),o("el-button",{staticClass:"data-source-item-btn up",attrs:{size:"mini",icon:"el-icon-caret-top",disabled:"0"==n},on:{click:function(e){return t.moveUp(n)}}}),o("el-button",{staticClass:"data-source-item-btn down",attrs:{size:"mini",icon:"el-icon-caret-bottom",disabled:n==t.customData.length-1},on:{click:function(e){return t.moveDown(n)}}})],1)})),0),o("el-button",{attrs:{icon:"el-icon-plus",size:"mini"},on:{click:t.addItem}},[t._v("添加选项")]),o("el-button",{attrs:{disabled:!t.customData.length,icon:"el-icon-save",size:"mini"},on:{click:t.applyItem}},[t._v("应用")])],1),o("div",{directives:[{name:"show",rawName:"v-show",value:"action"==t.sourceType,expression:"sourceType == 'action'"}],staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("远程数据源")]),o("div",{staticClass:"form-control"},[o("el-select",{attrs:{placeholder:"请选择远程数据源",disabled:t.hasAutoCodeItem,size:"small",filterable:""},on:{change:t.onActionChange},model:{value:t.selectedAction,callback:function(e){t.selectedAction=e},expression:"selectedAction"}},t._l(t.actionList,(function(t){return o("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})})),1)],1)])])},Ss=[],Ts={name:"extend-data-action",props:["controlData"],components:{},data(){const t=this.controlData,e=t.data,o=t.codeItem,n=Array.isArray(e);return{sourceType:n?"static":"action",sourceList:[{id:"static",text:"自定义"},{id:"action",text:"远程"}],customData:n?Object(Ot["d"])(e):[],selectedAction:o||"",rules:{id:[{validator:this.validateId,trigger:"blur"}],text:[{required:!0,message:"必须输入显示名称",trigger:"blur"}]}}},computed:{hasAutoCodeItem(){return!1},actionList(){return Object(Ot["d"])(this.$store.state.codeList)}},methods:{validateId(t,e,o){if(!e)return o(new Error("必填"));const n=this.customData[t.field.split(".")[0]];return this.checkDuplicated(e,n)?o(new Error("值必须唯一")):o()},checkDuplicated(t,e){for(let o of this.customData)if(o!==e&&t==o.id)return!0;return!1},addItem(){if(this.customData.length)return this.$refs.dataActionForm.validate(t=>{t?this.customData.push({id:"",text:""}):this.$message({message:"请先处理当前内容",customClass:"data-action-error-box",type:"error"})});this.customData.push({id:"",text:""})},deleteItem(t){this.customData.splice(t,1)},applyItem(){this.$refs.dataActionForm.validate((t,e)=>{let o;o=t?Object(Ot["d"])(this.customData):Object(Ot["d"])(this.customData.filter((t,o)=>!(o+".id"in e)&&!(o+".text"in e))),Array.isArray(o)&&this.useStaticData(o)})},moveUp(t){if(0===t)return;const e=this.customData.splice(t,1)[0];this.customData.splice(t-1,0,e)},moveDown(t){if(t===this.customData.length-1)return;const e=this.customData.splice(t,1)[0];this.customData.splice(t+1,0,e)},onActionChange(t){this.useAction(t)},useStaticData(t){let e;this.controlData.codeItem&&(e="dataaction"+ +new Date,this.$emit("change","","codeItem",e)),this.$emit("change",t,"data",e)},useAction(t){let e;this.controlData.data&&(e="dataaction"+ +new Date,this.$emit("change","","data",e)),this.$emit("change",t,"codeItem",e)}},watch:{sourceType(t){"action"==t?this.useAction(this.selectedAction):this.applyItem()},controlData:{deep:!0,handler(){const t=this.controlData,e=t.data,o=t.codeItem;Array.isArray(e)?(this.customData=Object(Ot["d"])(e),this.sourceType="static"):this.sourceType="action",o&&(this.selectedAction=o)}}}},js=Ts,$s=(o("25cd"),Object(mt["a"])(js,ks,Ss,!1,null,null,null)),Is=$s.exports,Ps=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"extend-daterange-config"},[o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("日期范围")]),o("div",{staticClass:"form-control"},[o("el-select",{attrs:{size:"small"},on:{change:t.onRangeTypeChange},model:{value:t.rangeType,callback:function(e){t.rangeType=e},expression:"rangeType"}},t._l(t.rangeTypeList,(function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1)]),"range"==t.rangeType?o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("开始")]),o("div",{staticClass:"form-control"},[o("el-select",{staticClass:"form-control-item",attrs:{size:"small"},on:{change:function(e){return t.selectedChange(e,"start")}},model:{value:t.selectedValue1,callback:function(e){t.selectedValue1=e},expression:"selectedValue1"}},[o("el-option",{attrs:{value:"static",label:"选择固定日期"}}),t._l(t.controlList,(function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],2),t.selectedValue1==t.typeMap.static?o("el-date-picker",{staticClass:"form-control-item",attrs:{"picker-options":t.startPickerOptions,"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择开始日期",size:"small"},on:{change:function(e){return t.onDateChange("start")}},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}}):t._e()],1)]):t._e(),"range"==t.rangeType?o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("结束")]),o("div",{staticClass:"form-control"},[o("el-select",{staticClass:"form-control-item",attrs:{size:"small"},on:{change:function(e){return t.selectedChange(e,"end")}},model:{value:t.selectedValue2,callback:function(e){t.selectedValue2=e},expression:"selectedValue2"}},[o("el-option",{attrs:{value:"static",label:"选择固定日期"}}),t._l(t.controlList,(function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],2),t.selectedValue2==t.typeMap.static?o("el-date-picker",{staticClass:"form-control-item",attrs:{"picker-options":t.endPickerOptions,"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择结束日期",size:"small"},on:{change:function(e){return t.onDateChange("end")}},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}}):t._e()],1)]):t._e()])},Es=[];function Ls(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function As(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?Ls(Object(o),!0).forEach((function(e){Object(it["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):Ls(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}const Ms=/^\d{4}-\d{2}-\d{2}$/,Fs=/^\{.+\}$/;var Rs={name:"extend-daterange-config",props:["controlData"],components:{},computed:{startType(){return this.getLimitType(this.controlData.minDate)},endType(){return this.getLimitType(this.controlData.maxDate)},controlList(){const t=/datepicker/i,e=this.$store.state.hiddenControls,o=this.$store.getters.allControls,n=[];return o.forEach(e=>{t.test(e.type)&&e.id!=this.controlData.id&&n.push({type:e.type,id:e.id,name:e.name||e.namePrefix+"_"+e.autoIndex})}),e.forEach(t=>{n.push({type:t.type,id:t.id,name:t.name||t.namePrefix+"_"+t.autoIndex})}),n}},data(){return As(As({rangeType:this.getRangeType(this.controlData.minDate,this.controlData.maxDate),rangeTypeList:[{id:"empty",text:"留空"},{id:"range",text:"指定范围"}]},this.getDateFromControl(this.controlData)),{},{typeMap:{static:"static",control:"control"},startPickerOptions:{disabledDate:t=>!!this.endDate&&t.getTime()>new Date(this.endDate).getTime()},endPickerOptions:{disabledDate:t=>!!this.startDate&&t.getTime()<new Date(this.startDate).getTime()}})},methods:{getDateFromControl(t){let e="",o="",n="",i="";return t.minDate&&(Fs.test(t.minDate)?e=t.minDate.substring(1,t.minDate.length-1):Ms.test(t.minDate)?(e="static",n=t.minDate):console.error("日期不合法： "+t.minDate)),t.maxDate&&(Fs.test(t.maxDate)?o=t.maxDate.substring(1,t.maxDate.length-1):Ms.test(t.maxDate)?(o="static",i=t.maxDate):console.error("日期不合法： "+t.maxDate)),{selectedValue1:e,selectedValue2:o,startDate:n,endDate:i}},getRangeType(t,e){return!t&&!e||""==t&&""==e?"empty":"range"},getLimitType(t){return t&&""!=t?Ms.test(t)?this.typeMap.static:this.typeMap.control:this.typeMap.static},onRangeTypeChange(t){"empty"==t?this.clearRange():(this.startDate&&this.onDateChange("start"),this.endDate&&this.onDateChange("end"))},clearRange(){""!=this.controlData.minDate&&this.$emit("change","","minDate"),""!=this.controlData.maxDate&&this.$emit("change","","maxDate")},selectedChange(t,e){if(t!=this.typeMap.static)t&&this.$emit("change",`{${t}}`,"start"==e?"minDate":"maxDate");else{const t="start"==e?this.startDate:this.endDate;t&&this.$emit("change",t,"start"==e?"minDate":"maxDate")}},onDateChange(t){"range"==this.rangeType&&("start"==t&&this.startType==this.typeMap.static&&this.$emit("change",this.startDate,"minDate"),"end"==t&&this.endType==this.typeMap.static&&this.$emit("change",this.endDate,"maxDate"))}}},Ns=Rs,Vs=Object(mt["a"])(Ns,Ps,Es,!1,null,null,null),Bs=Vs.exports,zs=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"preset-font"},[o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("字体")]),o("el-select",{staticClass:"font-set-select",attrs:{size:"small"},model:{value:t.fontFamily,callback:function(e){t.fontFamily=e},expression:"fontFamily"}},t._l(t.fontFamilyList,(function(t){return o("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})})),1),o("el-input-number",{staticClass:"font-set-input",attrs:{size:"small",controls:!1,min:12,max:100},model:{value:t.fontSize,callback:function(e){t.fontSize=e},expression:"fontSize"}}),o("span",{staticClass:"form-control-suffix"},[t._v("px")])],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("样式")]),o("FontColor",{staticStyle:{"margin-right":"10px"},model:{value:t.fontColor,callback:function(e){t.fontColor=e},expression:"fontColor"}}),o("div",{staticClass:"design-button-group font-group"},[o("el-tooltip",{attrs:{"open-delay":500,content:"加粗"}},[o("MyButton",{class:{active:t.fontBolder},attrs:{icon:"font-bold"},nativeOn:{click:function(e){t.fontBolder=!t.fontBolder}}})],1),o("el-tooltip",{attrs:{"open-delay":500,content:"倾斜"}},[o("MyButton",{class:{active:t.fontItalic},attrs:{icon:"font-italic"},nativeOn:{click:function(e){t.fontItalic=!t.fontItalic}}})],1),o("el-tooltip",{attrs:{"open-delay":500,content:"下划线"}},[o("MyButton",{class:{active:t.fontUnderline},attrs:{icon:"font-underline"},nativeOn:{click:function(e){t.fontUnderline=!t.fontUnderline}}})],1)],1)],1)])},Hs=[];const Gs=window.FORM_DESIGN_CONFIG.preset.fontFamilyList;var qs={name:"extend-font-config",props:["controlData"],components:{FontColor:tn,MyButton:po},data(){return{fontFamilyList:JSON.parse(JSON.stringify(Gs)),fontFamily:this.controlData.fontFamily,fontSize:this.controlData.fontSize,fontColor:this.controlData.fontColor,fontBolder:this.controlData.fontBolder,fontItalic:this.controlData.fontItalic,fontUnderline:this.controlData.fontUnderline}},methods:{handleChange(t,e){this.controlData[e]!=t&&this.$emit("change",t,e)}},watch:{controlData:{deep:!0,handler(){const t=this.controlData,e=t.fontFamily,o=t.fontSize,n=t.fontColor,i=t.fontBolder,s=t.fontItalic,r=t.fontUnderline;this.fontFamily=e,this.fontSize=o,this.fontColor=n,this.fontBolder=i,this.fontItalic=s,this.fontUnderline=r}},fontFamily(t){this.handleChange(t,"fontFamily")},fontSize(t){this.handleChange(t,"fontSize")},fontColor(t){this.handleChange(t,"fontColor")},fontBolder(t){this.handleChange(t,"fontBolder")},fontItalic(t){this.handleChange(t,"fontItalic")},fontUnderline(t){this.handleChange(t,"fontUnderline")}}},Ws=qs,Us=Object(mt["a"])(Ws,zs,Hs,!1,null,null,null),Js=Us.exports,Ys=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"frozen-column"},[o("div",{staticClass:"form-item"},[o("div",{staticClass:"form-control "},[o("el-checkbox",{on:{change:t.onSwitch},model:{value:t.isFrozen,callback:function(e){t.isFrozen=e},expression:"isFrozen"}},[t._v("冻结列")])],1)]),t.isFrozen?o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("冻结列索引")]),o("div",{staticClass:"form-control "},[o("el-input-number",{attrs:{min:0,max:t.columnLength-2,size:"mini",controls:!1},on:{change:t.change},model:{value:t.frozenIndex,callback:function(e){t.frozenIndex=e},expression:"frozenIndex"}})],1)]):t._e()])},Xs=[],Ks={name:"extend-frozen-column",props:["controlData"],computed:{columnLength(){const t=this.controlData.specialColumns.split(",").length,e=this.controlData.columns.length||4;return t+e}},data(){const t=parseInt(this.controlData.frozenColumnIndex,10);return{isFrozen:-1!==t,frozenIndex:t}},methods:{change(t){this.controlData.frozenIndex!=t&&this.$emit("change",t,"frozenColumnIndex")},onSwitch(t){t?this.$nextTick(()=>{this.change(this.frozenIndex)}):this.$emit("change",-1,"frozenColumnIndex")}},watch:{"controlData.frozenColumnIndex"(t){const e=parseInt(t,10);this.frozenIndex=e,this.isFrozen=-1!==e}}},Qs=Ks,Zs=Object(mt["a"])(Qs,Ys,Xs,!1,null,null,null),tr=Zs.exports,er=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"multi-form"},[o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("默认值")]),o("div",{staticClass:"form-control"},[o("virtual-select",{attrs:{clearable:"",multiple:t.multiSelect,placeholder:t.list.length?"请选择默认值":"请先选择数据源",items:t.list,buffer:34,"item-size":34,filterable:"","filter-key":"text"},on:{change:t.onValueChange},scopedSlots:t._u([{key:"default",fn:function(t){var e=t.item;return[o("el-option",{key:e.id,attrs:{slot:"default",label:e.text,value:e.id},slot:"default"})]}}]),model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}})],1)])])},or=[],nr=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:t.handleClose,expression:"handleClose"}],staticClass:"el-select",class:[t.selectSize?"el-select--"+t.selectSize:""],on:{click:function(e){return e.stopPropagation(),t.toggleMenu(e)}}},[t.multiple?o("div",{ref:"tags",staticClass:"el-select__tags",style:{"max-width":t.inputWidth-32+"px",width:"100%"}},[t.collapseTags&&t.selected.length?o("span",[o("el-tag",{attrs:{closable:!t.selectDisabled,size:t.collapseTagSize,hit:t.selected[0].hitState,type:"info","disable-transitions":""},on:{close:function(e){return t.deleteTag(e,t.selected[0])}}},[o("span",{staticClass:"el-select__tags-text"},[t._v(t._s(t.selected[0].currentLabel))])]),t.selected.length>1?o("el-tag",{attrs:{closable:!1,size:t.collapseTagSize,type:"info","disable-transitions":""}},[o("span",{staticClass:"el-select__tags-text"},[t._v("+ "+t._s(t.selected.length-1))])]):t._e()],1):t._e(),t.collapseTags?t._e():o("transition-group",{on:{"after-leave":t.resetInputHeight}},t._l(t.selected,(function(e){return o("el-tag",{key:t.getValueKey(e),attrs:{closable:!t.selectDisabled,size:t.collapseTagSize,hit:e.hitState,type:"info","disable-transitions":""},on:{close:function(o){return t.deleteTag(o,e)}}},[o("span",{staticClass:"el-select__tags-text"},[t._v(t._s(e.currentLabel))])])})),1),t.filterable?o("input",{directives:[{name:"model",rawName:"v-model",value:t.query,expression:"query"}],ref:"input",staticClass:"el-select__input",class:[t.selectSize?"is-"+t.selectSize:""],style:{"flex-grow":"1",width:t.inputLength/(t.inputWidth-32)+"%","max-width":t.inputWidth-42+"px"},attrs:{type:"text",disabled:t.selectDisabled,autocomplete:t.autoComplete||t.autocomplete},domProps:{value:t.query},on:{focus:t.handleFocus,blur:function(e){t.softFocus=!1},keyup:t.managePlaceholder,keydown:[t.resetInputState,function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:(e.preventDefault(),t.navigateOptions("next"))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:(e.preventDefault(),t.navigateOptions("prev"))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.selectOption(e))},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"]))return null;e.stopPropagation(),e.preventDefault(),t.visible=!1},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete","Del"])?null:t.deletePrevTag(e)},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"tab",9,e.key,"Tab"))return null;t.visible=!1}],compositionstart:t.handleComposition,compositionupdate:t.handleComposition,compositionend:t.handleComposition,input:[function(e){e.target.composing||(t.query=e.target.value)},t.debouncedQueryChange]}}):t._e()],1):t._e(),o("el-input",{ref:"reference",class:{"is-focus":t.visible},attrs:{id:t.id,type:"text",name:t.name,placeholder:t.currentPlaceholder,autocomplete:t.autoComplete||t.autocomplete,size:t.selectSize,disabled:t.selectDisabled,readonly:t.readonly,"validate-event":!1,tabindex:t.multiple&&t.filterable?"-1":null},on:{focus:t.handleFocus,blur:t.handleBlur},nativeOn:{keyup:function(e){return t.debouncedOnInputChange(e)},keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:(e.stopPropagation(),e.preventDefault(),t.navigateOptions("next"))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:(e.stopPropagation(),e.preventDefault(),t.navigateOptions("prev"))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.selectOption(e))},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"]))return null;e.stopPropagation(),e.preventDefault(),t.visible=!1},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"tab",9,e.key,"Tab"))return null;e.stopPropagation(),e.preventDefault(),t.visible=!1}],paste:function(e){return t.debouncedOnInputChange(e)},mouseenter:function(e){t.inputHovering=!0},mouseleave:function(e){t.inputHovering=!1}},model:{value:t.selectedLabel,callback:function(e){t.selectedLabel=e},expression:"selectedLabel"}},[t.$slots.prefix?o("template",{slot:"prefix"},[t._t("prefix")],2):t._e(),o("template",{slot:"suffix"},[o("i",{directives:[{name:"show",rawName:"v-show",value:!t.showClose,expression:"!showClose"}],class:["el-select__caret","el-input__icon","el-icon-"+t.iconClass]}),t.showClose?o("i",{staticClass:"el-select__caret el-input__icon el-icon-circle-close",on:{click:t.handleClearClick}}):t._e()])],2),o("transition",{attrs:{name:"el-zoom-in-top"},on:{"before-enter":t.handleMenuEnter,"after-leave":t.doDestroy}},[o("el-select-menu",{directives:[{name:"show",rawName:"v-show",value:t.visible&&!1!==t.emptyText,expression:"visible && emptyText !== false"}],ref:"popper",attrs:{"append-to-body":t.popperAppendToBody}},[o("div",{staticClass:"el-select-dropdown__wrap el-scrollbar__wrap",staticStyle:{overflow:"hidden",position:"relative"}},[o("recycle-scroller",{ref:"virtualScroller",staticClass:"scroller",style:t.scrollerStyle,attrs:{items:t.data,buffer:t.buffer,"key-field":t.keyField,"item-size":t.itemSize},scopedSlots:t._u([{key:"before",fn:function(){return[t._t("before")]},proxy:!0},{key:"default",fn:function(e){var o=e.item,n=e.index,i=e.active;return[t._t("default",null,{item:o,index:n,active:i})]}},{key:"after",fn:function(){return[t._t("after")]},proxy:!0}],null,!0)}),t.emptyText&&(!t.allowCreate||t.loading||t.allowCreate&&0===t._items.length)?[t.$slots.empty?t._t("empty"):o("p",{staticClass:"el-select-dropdown__empty"},[t._v("\n              "+t._s(t.emptyText)+"\n            ")])]:t._e()],2)])],1)],1)},ir=[],sr=o("e508");o("a899");function rr(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function lr(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?rr(Object(o),!0).forEach((function(e){Object(it["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):rr(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var ar={name:"VirtualSelect",components:lr(lr({},P.a.components),{},{RecycleScroller:sr["a"]}),directives:lr({},P.a.directives),mixins:[P.a],props:lr(lr(lr({},P.a.props),sr["a"].props),{},{filterKey:String}),data(){const t=P.a.data.bind(this),e=t();return lr(lr({},e),{},{data:[...this.items]})},computed:lr(lr({},P.a.computed),{},{scrollerStyle(){const t=Math.min(this.data.length,5),e=this.itemSize*t;return`height: ${e}px`}}),watch:{items(t){this.data=[...t]},visible(t){t&&(this.data=[...this.items])}},created(){const t=P.a.created.bind(this);t()},mounted(){const t=P.a.mounted.bind(this);t()},methods:lr(lr({},P.a.methods),{},{handleQueryChange(t){this.previousQuery===t||this.isOnComposition||(null!==this.previousQuery||"function"!==typeof this.filterMethod&&"function"!==typeof this.remoteMethod?(this.previousQuery=t,this.$nextTick(()=>{this.visible&&this.broadcast("ElSelectDropdown","updatePopper")}),this.hoverIndex=-1,this.multiple&&this.filterable&&this.$nextTick(()=>{const t=15*this.$refs.input.value.length+20;this.inputLength=this.collapseTags?Math.min(50,t):t,this.managePlaceholder(),this.resetInputHeight()}),this.remote&&"function"===typeof this.remoteMethod?(this.hoverIndex=-1,this.remoteMethod(t)):"function"===typeof this.filterMethod?(this.filterMethod(t),this.broadcast("ElOptionGroup","queryChange")):this.filterKey&&(this.query,this.data=t?this.items.filter(e=>{const o=this.filterKey;return e.hasOwnProperty(o)&&e[o].indexOf(t)>-1}):[...this.items],this.filteredOptionsCount=this.optionsCount,this.broadcast("ElOption","queryChange",t),this.broadcast("ElOptionGroup","queryChange")),this.defaultFirstOption&&(this.filterable||this.remote)&&this.filteredOptionsCount&&this.checkDefaultFirstOption()):this.previousQuery=t)},scrollToOption(t){const e=Array.isArray(t)?t[0]:t;if(e&&e.$vnode){const t=e.$vnode.key;this.$refs.virtualScroller.scrollToItem(t)}}})},cr=ar,dr=(o("e06a"),Object(mt["a"])(cr,nr,ir,!1,null,null,null)),ur=dr.exports;var hr={components:{VirtualSelect:ur},name:"extend-list-default-value",props:["controlData"],mounted(){this.getValue(),this.getList()},data(){return{loading:!1,list:[],currentValue:[]}},computed:{multiSelect(){const t=this.controlData.type;return"radiobuttonlist"!=t&&("checkboxlist"==t||"combobox"==t&&!!this.controlData.multiSelect)}},methods:{getList(){const t=this.controlData,e=t.data,o=t.codeItem;if(e&&Array.isArray(e))return this.list=Object(Ot["d"])(e),void this.checkValueInList();this.getData(o)},getData(t){this.loading=!0,this.list=[],t?ws(window.formDesignerActions.getControlDataListUrl,{controlData:this.controlData},t).then(t=>{if(!t||!Array.isArray(t))throw new Error("代码列表获取失败");this.loading=!1,this.list=t,this.checkValueInList()}).catch(t=>{console.error("请求失败",t),this.loading=!1,this.list=[]}):this.$emit("change","","defaultValue")},getValue(){const t=this.controlData.defaultValue,e=this.multiSelect?[]:"";this.currentValue=t?this.multiSelect?t.split(","):t:e},checkValueInList(){const t=this.currentValue,e=this.list;if(!t||this.multiSelect&&!t.length)return;let o=!0;o=!!Array.isArray(e)&&(this.multiSelect?t.every(t=>e.some(e=>e.id==t)):e.some(e=>e.id==t)),o||this.$emit("change","","defaultValue")},onValueChange(t){const e=t&&t.toString?t.toString():t||"";this.$emit("change",e,"defaultValue")}},watch:{"controlData.codeItem"(){this.getList()},"controlData.data"(){this.getList()},"controlData.defaultValue"(){this.getValue()}}},pr=hr,mr=Object(mt["a"])(pr,er,or,!1,null,null,null),fr=mr.exports,gr=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"multi-form"},[o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("所属手风琴")]),o("div",{staticClass:"form-control"},[o("el-select",{staticClass:"form-control-item",on:{change:t.onAccChange},model:{value:t.multiFormAccId,callback:function(e){t.multiFormAccId=e},expression:"multiFormAccId"}},t._l(t.accList,(function(e){return o("el-option",{key:e.id,attrs:{value:e.id,label:e.text}},[t._v(t._s(e.text))])})),1)],1)]),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("所属栏目")]),o("div",{staticClass:"form-control"},[o("el-select",{staticClass:"form-control-item",on:{change:t.onSubCateChange},model:{value:t.multiFormColumnId,callback:function(e){t.multiFormColumnId=e},expression:"multiFormColumnId"}},t._l(t.subList,(function(e){return o("el-option",{key:e.id,attrs:{value:e.id,label:e.text}},[t._v(t._s(e.text))])})),1)],1)]),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("排序值")]),o("div",{staticClass:"form-control"},[o("el-input-number",{staticClass:"form-control-item",attrs:{controls:!1},on:{change:t.onIndexChange},model:{value:t.multiFormIndex,callback:function(e){t.multiFormIndex=e},expression:"multiFormIndex"}})],1)])])},br=[];function yr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var vr={name:"extend-multi-form",props:["controlData"],mounted(){this.getAccList(),this.addMultiFormProps(),this.multiFormColumnId&&this.multiFormAccId&&this.getSubCateList(this.multiFormAccId)},data(){const t=this.controlData;return{accList:[],subList:[],multiFormAccId:yr(t,"multiFormAccId")?t.multiFormAccId:"",multiFormColumnId:yr(t,"multiFormColumnId")?t.multiFormColumnId:"",multiFormIndex:yr(t,"multiFormIndex")?t.multiFormIndex:0}},methods:{addMultiFormProps(){yr(this.controlData,"multiFormAccId")&&yr(this.controlData,"multiFormColumnId")&&yr(this.controlData,"multiFormIndex")||this.$store.commit({type:"addMultiFormProps",controlData:this.controlData})},getAccList(){return ws(window.formDesignerActions.getMultiFormAccListUrl,{},"").then(t=>{const e=t.dataValue;Array.isArray(e)?(this.accList=e,this.multiFormAccId&&!this.checkValueInList(this.multiFormAccId,e)&&(this.multiFormAccId="",this.change("multiFormAccId",""))):this.accList=[]})},getSubCateList(t){return ws(window.formDesignerActions.getMultiFormSubCateListUrl,{codeId:t},"subid-"+t).then(t=>{const e=t.itemDataValue;Array.isArray(e)?(this.subList=e,this.multiFormColumnId&&!this.checkValueInList(this.multiFormColumnId,e)&&(this.multiFormColumnId="",this.change("","multiFormColumnId"))):(this.subList=[],this.change("","multiFormColumnId"))})},change(t,e){e&&void 0!==t&&this.$emit("change",t,e)},checkValueInList(t,e){return e.some(e=>e.id==t)},onAccChange(t){this.change(t,"multiFormAccId"),this.subList=[],this.getSubCateList(t)},onSubCateChange(t){this.change(t,"multiFormColumnId")},onIndexChange(t){this.change(t,"multiFormIndex")}},watch:{controlData:{deep:!0,handler(){this.addMultiFormProps(),this.multiFormAccId!=this.controlData.multiFormAccId&&(this.multiFormAccId=this.controlData.multiFormAccId),this.multiFormColumnId!=this.controlData.multiFormColumnId&&(this.multiFormColumnId=this.controlData.multiFormColumnId),this.multiFormIndex!=this.controlData.multiFormIndex&&(this.multiFormIndex=this.controlData.multiFormIndex),this.multiFormColumnId&&this.multiFormAccId&&this.getSubCateList(this.multiFormAccId)}}}},Cr=vr,wr=Object(mt["a"])(Cr,gr,br,!1,null,null,null),xr=wr.exports,Dr=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"extend-range-validate"},[o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v(t._s(t.validateTextMap[t.validateType]))]),o("div",{staticClass:"form-control"},[o("el-switch",{on:{change:t.change},model:{value:t.showRangeValidate,callback:function(e){t.showRangeValidate=e},expression:"showRangeValidate"}})],1)]),t.showRangeValidate?o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("值")]),o("div",{staticClass:"form-control"},[o("el-select",{staticClass:"range-validate-operation",attrs:{size:"small"},on:{change:t.change},model:{value:t.operation1,callback:function(e){t.operation1=e},expression:"operation1"}},t._l(t.operationList,(function(t){return o("el-option",{key:t,attrs:{value:t,label:t}})})),1),o("el-select",{staticClass:"range-validate-value",attrs:{size:"small"},on:{change:t.change},model:{value:t.selectedValue1,callback:function(e){t.selectedValue1=e},expression:"selectedValue1"}},[o("el-option",{attrs:{value:"static",label:"输入固定值"}}),t._l(t.controlList,(function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],2),"static"==t.selectedValue1?o("el-input",{staticClass:"range-validate-input",attrs:{placeholder:"请输入",size:"small"},on:{change:t.change},model:{value:t.operationValue1,callback:function(e){t.operationValue1=e},expression:"operationValue1"}}):t._e(),o("span",{directives:[{name:"show",rawName:"v-show",value:!t.showExt,expression:"!showExt"}],staticClass:"ext-btn el-icon-plus",on:{click:t.showCondition2}})],1)]):t._e(),t.showRangeValidate?o("div",{directives:[{name:"show",rawName:"v-show",value:t.showExt,expression:"showExt"}],staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("且")]),o("div",{staticClass:"form-control"},[o("el-select",{staticClass:"range-validate-operation",attrs:{size:"small"},on:{change:t.change},model:{value:t.operation2,callback:function(e){t.operation2=e},expression:"operation2"}},t._l(t.operationList,(function(t){return o("el-option",{key:t,attrs:{value:t,label:t}})})),1),o("el-select",{staticClass:"range-validate-value",attrs:{size:"small"},on:{change:t.change},model:{value:t.selectedValue2,callback:function(e){t.selectedValue2=e},expression:"selectedValue2"}},[o("el-option",{attrs:{value:"static",label:"输入固定值"}}),t._l(t.controlList,(function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],2),"static"==t.selectedValue2?o("el-input",{staticClass:"range-validate-input",attrs:{placeholder:"请输入",size:"small"},on:{change:t.change},model:{value:t.operationValue2,callback:function(e){t.operationValue2=e},expression:"operationValue2"}}):t._e(),o("span",{staticClass:"ext-btn el-icon-delete",on:{click:t.hideCondition2}})],1)]):t._e()])},Or=[];o("55dd");function _r(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function kr(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?_r(Object(o),!0).forEach((function(e){Object(it["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):_r(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var Sr={name:"extend-range-validate",props:["controlData"],data(){return kr({validateTextMap:{string:"文本值比较",number:"数值比较"}},this.getCompentValueFromControl(this.controlData))},computed:{controlList(){const t=/textbox|textarea|radiobuttonlist|combobox|macro|treeselect/i,e=this.$store.state.hiddenControls,o=this.$store.getters.allControls,n=[];return o.forEach(e=>{t.test(e.type)&&e.id!=this.controlData.id&&n.push({type:e.type,id:e.id,name:e.name||e.namePrefix+"_"+e.autoIndex})}),e.forEach(t=>{n.push({type:t.type,id:t.id,name:t.name||t.namePrefix+"_"+t.autoIndex})}),n.sort((t,e)=>t.type==e.type?0:"textbox"==e.type&&"textbox"!=t.type||"hiddenfield"==e.type&&"hiddenfield"!=t.type?1:-1),n},inputType(){const t=this.controlData.vtype;return"int"==t||"float"==t?"number":"string"},operationList(){return"number"==this.inputType?["<","<=","==",">",">="]:["=="]},condition1Done(){return!(!this.operation1||!this.selectedValue1)&&!("static"==this.selectedValue1&&!this.operationValue1)},condition2Done(){return!(!this.operation2||!this.selectedValue2)&&!("static"==this.selectedValue2&&!this.operationValue2)}},methods:{getCompentValueFromControl(t){let e=!1,o=!1,n="",i="",s="",r="",l="",a="",c="";const d=(t||this.controlData).vtype,u=(t||this.controlData).rangeValidator,h=u&&u.conditions;if(n="int"==d||"float"==d?"number":"string",h&&h.length){if(e=!0,h[0]){i=window.decodeURIComponent(h[0].operation);const t=this.getOperationInfo(h[0].value);r=t.type,a=t.value}else i="string"==n?"==":"<=",a=r="";if(h[1]){s=window.decodeURIComponent(h[1].operation);const t=this.getOperationInfo(h[1].value);l=t.type,c=t.value,o=!0}else s="string"==n?"==":">=",c=l="",o=!1}return{showRangeValidate:e,showExt:o,validateType:n,operation1:i,operation2:s,selectedValue1:r,selectedValue2:l,operationValue1:a,operationValue2:c}},getOperationInfo(t){if(/^\{.+\}$/.test(t)){const e=t.substring(1,t.length-1);return{type:e,value:""}}return{type:"static",value:t}},showCondition2(){if(!this.condition1Done)return this.$message({type:"error",message:"请先填好当前条件"});this.showExt=!0,this.change()},hideCondition2(){this.showExt=!1,this.operation2="string"==this.validateType?"==":">=",this.operationValue2=this.selectedValue2="",this.change()},getSubmitValue(){const t={type:this.validateType,conditions:[]};return this.condition1Done&&t.conditions.push({operation:window.encodeURIComponent(this.operation1),value:"static"==this.selectedValue1?this.operationValue1:`{${this.selectedValue1}}`}),this.showExt&&this.condition2Done&&t.conditions.push({operation:window.encodeURIComponent(this.operation2),value:"static"==this.selectedValue2?this.operationValue2:`{${this.selectedValue2}}`}),t},change(){let t=this.getSubmitValue();this.showRangeValidate&&t&&t.conditions&&t.conditions.length||(t=null),this.$emit("change",t,"rangeValidator")}},watch:{"controlData.vtype"(){const t=this.getCompentValueFromControl(this.controlData),e=t.showRangeValidate,o=t.showExt,n=t.validateType,i=t.operation1,s=t.operation2,r=t.selectedValue1,l=t.selectedValue2,a=t.operationValue1,c=t.operationValue2;this.showRangeValidate=e,this.showExt=o,this.validateType=n,this.operation1=i,this.operation2=s,this.selectedValue1=r,this.selectedValue2=l,this.operationValue1=a,this.operationValue2=c}}},Tr=Sr,jr=Object(mt["a"])(Tr,Dr,Or,!1,null,null,null),$r=jr.exports,Ir=function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.showFormSelect?o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("编辑页地址")]),o("div",{staticClass:"form-control"},[o("el-select",{staticClass:"form-control-item",attrs:{size:"mini"},on:{change:t.change},model:{value:t.selectedFormId,callback:function(e){t.selectedFormId=e},expression:"selectedFormId"}},t._l(t.formList,(function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1)]):t._e()},Pr=[],Er={name:"extend-sub-table-edit-form",props:["controlData"],computed:{showFormSelect(){return"dialog"==this.controlData.editType},tableId(){return this.controlData.sourceTable}},data(){return{selectedFormId:this.controlData.editFormGuid||"",formList:[]}},mounted(){this.getForms()},methods:{getForms(){if(!this.tableId)return this.formList=[];ws(window.formDesignerActions.getSubTableInfoUrl,{tableId:this.tableId},"subTableData-"+this.tableId).then(t=>{const e=t.SubTableForm;if(!Array.isArray(e))throw new Error("获取编辑表单失败");this.formList=e.map(t=>({id:t.formGuid,text:t.formName}))}).catch(t=>{console.error(t)})},change(t){this.$emit("change",t,"editFormGuid")}},watch:{tableId(){this.showFormSelect&&this.getForms()},"controlData.editFormGuid"(t){this.selectedFormId=t}}},Lr=Er,Ar=Object(mt["a"])(Lr,Ir,Pr,!1,null,null,null),Mr=Ar.exports,Fr=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"extend-sub-table-fields"},[o("div",{staticClass:"form-item"},[o("el-button",{attrs:{disabled:!t.tableId,size:"mini"},on:{click:function(e){t.showDialog=!0}}},[t._v("点击配置")])],1),o("el-dialog",{staticClass:"column-config-dialog",attrs:{"append-to-body":"",title:"表格字段配置",visible:t.showDialog,"before-close":t.handleClose,width:t.showEditor?"80%":"50%"},on:{"update:visible":function(e){t.showDialog=e}}},[t.showDialog?o("div",[o("div",{staticClass:"column-config-header"},[o("div",{staticClass:"span display"},[t._v("显示")]),o("div",{staticClass:"span move"},[t._v("排序")]),o("div",{staticClass:"span name"},[t._v("名称")]),t.showEditor?o("div",{staticClass:"span editor"},[t._v("编辑类型")]):t._e(),t.showEditor?o("div",{staticClass:"span required"},[t._v("必填")]):t._e(),o("div",{staticClass:"span align"},[t._v("对齐方式")]),o("div",{staticClass:"span width"},[t._v("列宽(px)")]),t.showEditor?o("div",{staticClass:"span vtype"},[t._v("格式校验")]):t._e()]),o("div",{staticClass:"column-config-list"},[o("draggable",{attrs:{list:t.columns,handle:".move",direction:"vertical"},on:{start:function(e){t.drag=!0},end:function(e){t.drag=!1},change:t.change}},t._l(t.columns,(function(e){return o("column-config",{key:e.field,attrs:{field:e,showEditor:t.showEditor},on:{change:t.change}})})),1)],1)]):t._e(),o("span",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.save}},[t._v("确 定")]),o("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.beforeClose()}}},[t._v("取 消")])],1)])],1)},Rr=[],Nr=o("b76a"),Vr=o.n(Nr),Br=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"column-config-item"},[o("div",{staticClass:"span display"},[o("el-checkbox",{on:{change:function(e){return t.change("display",t.field.display)}},model:{value:t.field.display,callback:function(e){t.$set(t.field,"display",e)},expression:"field.display"}})],1),t._m(0),o("div",{staticClass:"span name"},[o("el-input",{attrs:{size:"mini"},on:{change:function(e){return t.change("name",t.field.name)}},model:{value:t.field.name,callback:function(e){t.$set(t.field,"name",e)},expression:"field.name"}})],1),t.showEditor?o("div",{staticClass:"span editor"},[o("el-select",{attrs:{size:"mini"},on:{change:function(e){return t.change("controlType",t.field.controlType)}},model:{value:t.field.controlType,callback:function(e){t.$set(t.field,"controlType",e)},expression:"field.controlType"}},t._l(t.controlTypes,(function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1):t._e(),t.showEditor?o("div",{staticClass:"span required"},[o("el-checkbox",{on:{change:function(e){return t.change("required",t.field.required)}},model:{value:t.field.required,callback:function(e){t.$set(t.field,"required",e)},expression:"field.required"}})],1):t._e(),o("div",{staticClass:"span align"},[o("AlignButton",{attrs:{type:"horizontal"},on:{change:function(e){return t.change("align",t.field.align)}},model:{value:t.field.align,callback:function(e){t.$set(t.field,"align",e)},expression:"field.align"}})],1),o("div",{staticClass:"span width"},[o("el-input-number",{attrs:{size:"mini",controls:!1},on:{change:function(e){return t.change("width",t.field.width)}},model:{value:t.field.width,callback:function(e){t.$set(t.field,"width",e)},expression:"field.width"}})],1),t.showEditor?o("div",{staticClass:"span vtype"},[o("el-select",{attrs:{size:"mini",disabled:"textbox"!=t.field.controlType},on:{change:function(e){return t.change("vtype",t.field.vtype)}},model:{value:t.field.vtype,callback:function(e){t.$set(t.field,"vtype",e)},expression:"field.vtype"}},t._l(t.vtypeList,(function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1):t._e()])},zr=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"span move"},[o("span",{staticClass:"sort-handle el-icon-rank",staticStyle:{cursor:"move"}})])}],Hr={name:"column-config",components:{AlignButton:bo},props:["field","showEditor"],computed:{},data(){return{vtypeList:Object(Ot["d"])(window.FORM_DESIGN_CONFIG.preset["epointsform.validateTypes"]),controlTypes:Object(Ot["d"])(window.FORM_DESIGN_CONFIG.preset["epointsform.columnEditors"])}},methods:{change(t,e){this.$emit("change",t,e)}}},Gr=Hr,qr=Object(mt["a"])(Gr,Br,zr,!1,null,null,null),Wr=qr.exports;const Ur={width:100,align:"center",required:!1,controlType:"",vtype:""};var Jr={name:"extend-sub-table-fields",components:{ColumnConfig:Wr,draggable:Vr.a},props:["controlData"],computed:{tableId(){return this.controlData.sourceTable},fieldMap(){const t={};return this.fieldList.forEach(e=>{t[e.field]=e}),t},showEditor(){return"dialog"!=this.controlData.editType}},mounted(){this.getFields()},data(){return{fieldList:[],columns:[],showDialog:!1,loading:!1,drag:!1,dataChanged:!1}},methods:{getConfigColumns(){if(!this.fieldList.length)return void(this.columns=[]);const t=this.controlData.columns||[];if(t.length){const e=[],o={};t.forEach(t=>{this.fieldMap[t.field]&&(o[t.field]=!0,e.push(Pn()({},Ur,t)))}),this.fieldList.forEach(t=>{o[t.field]||e.push(Pn()({},Ur,t))}),this.columns=e}else this.columns=this.fieldList.map(t=>{const e=Pn()({},Ur,t);return e.display=!0,e})},getRealColumns(){if(!this.columns.length)return[];const t=Object(Ot["d"])(this.columns).filter(t=>t.display);return t.forEach(t=>{t.controlType&&"textbox"!=t.controlType&&(t.vtype="")}),t},change(){this.dataChanged=!0},beforeClose(t){this.dataChanged?this.$confirm("确认不保存直接关闭？").then(()=>{t?t():this.showDialog=!1}).catch(t=>{console.error(t)}):this.showDialog=!1},handleClose(t){this.beforeClose(t)},getFields(){if(!this.tableId)return this.fieldList=[];this.loading=!0,ws(window.formDesignerActions.getSubTableInfoUrl,{tableId:this.tableId},"subTableData-"+this.tableId).then(t=>{const e=t.SubTableStruct;if(!Array.isArray(e))throw new Error("获取子表字段失败");e.forEach(t=>{t.required=1==parseInt(t.required,10)}),this.fieldList=e}).catch(t=>{console.error(t),this.loading=!1})},save(){const t=this.getRealColumns();this.$emit("change",t,"columns"),this.showDialog=!1}},watch:{tableId(){this.getFields()},fieldList(){this.getConfigColumns()},showDialog(t){t||(this.dataChanged=!1)}}},Yr=Jr,Xr=(o("f5bd"),Object(mt["a"])(Yr,Fr,Rr,!1,null,null,null)),Kr=Xr.exports,Qr=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"extend-sub-table-source"},[o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("数据来源")]),o("div",{staticClass:"form-control"},[o("el-select",{attrs:{value:t.value,size:"small",filterable:"",clearable:""},on:{change:t.change}},t._l(t.optionList,(function(t){return o("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})})),1)],1)])])},Zr=[],tl={name:"extend-sub-table-source",props:["controlData"],data(){return{value:""}},mounted(){this.controlData.sourceTable?this.value=this.controlData.sourceTable:this.value=""},computed:{optionList(){const t="sourceTables";return this.$store.state[t]}},methods:{change(t){const e=this.getTargetItemPid(t);this.$emit("change",t,"sourceTable"),e&&this.$emit("change",e,"sourceTablePid")},getTargetItemPid(t){let e="";for(let o=this.optionList.length-1;o>=0;o--)if(this.optionList[o]&&this.optionList[o].id==t){e=this.optionList[o].parentId;break}return e}},watch:{"controlData.sourceTable"(t){this.value=t}}},el=tl,ol=Object(mt["a"])(el,Qr,Zr,!1,null,null,null),nl=ol.exports,il=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"tooltip-config"},[o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("位置")]),o("div",{staticClass:"form-control"},[o("div",{staticClass:"design-button-group tooltip-group",attrs:{"data-value":t.type}},t._l(t.typeList,(function(e){return o("el-tooltip",{key:e,attrs:{"open-delay":500,content:t.tipsText[e]}},[o("MyButton",{class:{active:t.type==e},attrs:{icon:"tooltip-type-"+e},nativeOn:{click:function(o){return t.activeBtn(e)}}})],1)})),1)])]),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("内容")]),o("div",{staticClass:"form-control"},[o("el-input",{staticClass:"form-control-item",attrs:{type:"textarea",rows:"3",placeholder:"请输入提示内容",allowresize:"false"},on:{change:t.onContentChange},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1)])])},sl=[];function rl(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var ll={name:"extend-tooltip-config",props:["controlData"],components:{MyButton:po},mounted(){this.addTooltipConfig()},data(){const t=this.controlData.tooltipConfig;return{type:t?t.type:"tooltip",content:t?t.content:"",tipsText:{tooltip:"tooltip 提示",right:"右侧提示",bottom:"底部提示"},typeList:["tooltip","bottom"]}},methods:{activeBtn(t){this.type=t,this.change(t,"tooltipConfig.type")},onContentChange(t){this.change(t,"tooltipConfig.content")},addTooltipConfig(){rl(this.controlData,"tooltipConfig")||this.$store.commit({type:"addTooltipConfig",controlData:this.controlData})},change(t,e){e&&void 0!==t&&this.$emit("change",t,e)}},watch:{controlData:{deep:!0,immediate:!0,handler(){this.addTooltipConfig();const t=this.controlData.tooltipConfig;t.type!==this.type&&(this.type=t.type),t.content!==this.content&&(this.content=t.content)}}}},al=ll,cl=(o("13f1"),Object(mt["a"])(al,il,sl,!1,null,null,null)),dl=cl.exports;const ul={checkbox:Tn,checkboxlist:Rn,combobox:qn,defaultdate:oi,filetypepicker:di,fontcolor:tn,formdatacombobox:vi,help:_i,monthpicker:Ii,numbertextbox:Fi,radiobuttonlist:Gi,switch:Xi,textbox:os,widthconfig:ds,"extend-alignconfig":gs,"extend-buttoneditfield":_s,"extend-dataaction":Is,"extend-daterangeconfig":Bs,"extend-fontconfig":Js,"extend-frozencolumn":tr,"extend-listdefaultvalue":fr,"extend-multiform":xr,"extend-rangevalidate":$r,"extend-subtableeditform":Mr,"extend-subtablefields":Kr,"extend-subtablesource":nl,"extend-tooltipconfig":dl},hl={name:"default-control-component",inheritAttrs:!1,props:["config","value","controlData"],template:'<div>{{controlData ? "配置功能" : config.type}} 开发中...</div>'};var pl=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{},[o("el-dropdown",{staticClass:"add-event-drop",attrs:{size:"small",trigger:"click",placement:"bottom-start"},on:{command:t.addEvent}},[o("div",{staticClass:"add-event-drop-trigger"},[o("span",{staticClass:"el-icon-plus add-event-icon"}),t._v("添加事件\n    ")]),o("el-dropdown-menu",{staticClass:"add-event-dropmenu",attrs:{slot:"dropdown"},slot:"dropdown"},[t._l(t.eventTypeList,(function(e){return o("el-dropdown-item",{key:"1-"+e.type,attrs:{command:{type:e.type,initRun:!1}}},[t._v(t._s(e.name))])})),o("li",{staticClass:"el-dropdown-menu__item",staticStyle:{"pointer-events":"none",color:"#999","margin-top":"10px"}},[t._v("初始化事件")]),t._l(t.eventTypeList,(function(e){return o("el-dropdown-item",{key:"2-"+e.type,attrs:{command:{type:e.type,initRun:!0}}},[t._v(t._s(e.name))])}))],2)],1),t.eventList.length?o("div",{},t._l(t.controlData.events,(function(e,n){return o("div",{key:n},t._l(e,(function(e,i){return o("EventCard",{key:e.type+"-"+i,attrs:{"event-data":e,"target-name-map":t.targetNameMap},on:{"edit-event":function(e){return t.editEvent(n,i)},"remove-event":function(e){return t.removeEvent(n,i)},"remove-action":function(e){var o=arguments.length,s=Array(o);while(o--)s[o]=arguments[o];return t.removeEventAction.apply(void 0,[n,i].concat(s))}}})})),1)})),0):t._e(),o("el-dialog",{staticClass:"event-config-dialog",attrs:{width:"800px",visible:t.dialogVisible,title:"add"==t.configData.editType?"新增事件":"修改事件","close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":t.cancel,"append-to-body":""}},[t.dialogVisible?o("EventConfig",{attrs:{"control-data":t.controlData,"target-name-map":t.targetNameMap,"edit-type":t.configData.editType,"default-event-type":t.configData.eventType,"event-description":t.configData.evData,"event-type-list":t.eventTypeList},on:{save:t.saveEvent,cancel:t.cancel}}):t._e()],1)],1)},ml=[],fl=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"event-config"},[o("div",{staticClass:"event-config-header"},[o("el-select",{staticClass:"event-config-typeselect",attrs:{size:"small",disabled:!t.eventTypeChangeable||!t.eventTypeList.length||1==t.eventTypeList.length},on:{change:t.onEventTypeChanged},model:{value:t.eventType,callback:function(e){t.eventType=e},expression:"eventType"}},t._l(t.eventTypeList,(function(t){return o("el-option",{key:t.type,attrs:{value:t.type,label:t.name}})})),1),o("div",{directives:[{name:"show",rawName:"v-show",value:t.showCondition,expression:"showCondition"}],staticClass:"event-config-condition"},[t._v("\n      当满足 This\n      "),o("el-select",{staticClass:"event-operation",attrs:{size:"small"},model:{value:t.condition.operation,callback:function(e){t.$set(t.condition,"operation",e)},expression:"condition.operation"}},t._l(t.operationList,(function(e){return o("el-option",{key:e,attrs:{value:e,label:t.operationNames[e]}})})),1),o("virtual-select",{attrs:{clearable:"",size:"small",items:t.controlDataList,buffer:34,"item-size":34,filterable:"","filter-key":"text"},scopedSlots:t._u([{key:"default",fn:function(t){var e=t.item;return[o("el-option",{key:e.id,attrs:{slot:"default",label:e.text,value:e.id},slot:"default"})]}}]),model:{value:t.condition.target,callback:function(e){t.$set(t.condition,"target",e)},expression:"condition.target"}})],1)],1),o("div",{staticClass:"event-config-body"},[o("div",{staticClass:"event-config-lane choice"},[o("h3",{staticClass:"event-config-title"},[t._v("选择动作")]),t.eventConfigMap[t.eventType]?o("div",{staticClass:"event-config-list choice"},t._l(t.eventConfigMap[t.eventType].actionList,(function(e){return o("div",{key:e.type,staticClass:"choice-action-item",class:{disabled:t.selectedActions[e.type]},on:{click:function(o){return t.addAction(e.type)}}},[t._v(t._s(e.name))])})),0):t._e()]),o("div",{staticClass:"event-config-lane action-config"},[o("h3",{staticClass:"event-config-title"},[t._v("组织动作")]),t.actions.length?o("div",{staticClass:"event-config-list"},t._l(t.actions,(function(e,n){return o("div",{key:e.type,staticClass:"action-item"},[o("h4",{staticClass:"action-header",class:{active:e.type==t.currentAction,collaspe:e.collaspe},on:{click:function(o){t.currentAction=e.type}}},[o("span",{staticClass:"el-icon-arrow-down action-toggle",on:{click:function(t){t.stopPropagation(),e.targets.length&&(e.collaspe=!e.collaspe)}}}),o("span",{staticClass:"action-name"},[t._v(t._s(e.name))]),o("span",{staticClass:"action-remove el-icon-close",on:{click:function(o){return o.stopPropagation(),t.removeAction(n,e.type==t.currentAction)}}})]),e.targets.length?o("div",{staticClass:"action-targets",style:"height:"+30*e.targets.length+"px"},t._l(e.targets,(function(e){return o("div",{key:e.id},[t._v("\n              "+t._s(t.targetNameMap[e.id])+"\n              "),e.setValueField?o("span",[t._v(t._s(t.fieldNameMap[e.setValueField]))]):t._e()])})),0):o("span",[t._v("请在右侧为动作选择目标")])])})),0):o("span",[t._v("请先从左侧添加动作")])]),o("div",{staticClass:"event-config-lane targets"},[o("h3",{staticClass:"event-config-title"},[t._v("\n        对象目标 "+t._s(t.currentActionName)+"\n        "),"assignment"==t.currentAction?o("div",[o("div",{staticClass:"event-config-target-table"},[o("label",[t._v("赋值来源数据表：")]),o("el-select",{staticStyle:{float:"right","margin-right":"10px"},attrs:{size:"mini",filterable:""},on:{change:t.onTargetTableChange},model:{value:t.targetTable,callback:function(e){t.targetTable=e},expression:"targetTable"}},t._l(t.dataTables,(function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1),"assignment"==t.currentAction?o("div",{staticClass:"event-config-target-tablefield"},[o("label",[t._v("数据查询字段：")]),o("el-select",{staticStyle:{float:"right","margin-right":"10px"},attrs:{size:"mini",filterable:""},model:{value:t.targetTableField,callback:function(e){t.targetTableField=e},expression:"targetTableField"}},t._l(t.fieldList,(function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1):t._e()]):t._e()]),t.currentAction?o("TargetDisplay",{staticClass:"event-config-list",class:{table:"assignment"==t.currentAction,tablefield:"assignment"==t.currentAction},attrs:{type:t.treeDisplayType,"default-targets":t.currentActionTargets,"action-type":t.currentAction,"field-list":t.fieldList,"field-name-map":t.fieldNameMap,"except-id":t.controlData.id},on:{"ckecked-change":t.handleTargetChange}}):o("span",[t._v("请先选择动作")])],1)]),o("div",{staticClass:"event-config-footer"},[o("el-checkbox",{model:{value:t.runAtInit,callback:function(e){t.runAtInit=e},expression:"runAtInit"}},[t._v("初始化执行")]),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.save}},[t._v("保存")]),o("el-button",{attrs:{size:"mini"},on:{click:t.cancel}},[t._v("取消")])],1)])},gl=[];const bl={valuechanged:{name:"值变更",originType:"valuechanged",actions:["assignment"]},"valuechanged:compare":{name:"值变更(关系比较)",originType:"valuechanged",actions:["show","hide","assignment","clear"]},"valuechanged:getcodelist":{name:"值变更(获取代码项)",originType:"valuechanged",actions:["setData"]}},yl={show:{name:"显示"},hide:{name:"隐藏"},assignment:{name:"赋值"},clear:{name:"清空"},setData:{name:"数据源设置"}},vl=(Object.keys(yl).map(t=>(yl[t].type=t,yl)),Object.keys(bl).map(t=>(bl[t].type=t,bl[t].actionList=bl[t].actions.map(t=>yl[t]),bl[t]))),Cl={"<=":"小于等于","<":"小于","!=":"不等于","==":"等于",">":"大于",">=":"大于等于"};function wl(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function xl(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?wl(Object(o),!0).forEach((function(e){Object(it["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):wl(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var Dl={name:"event-config",components:{TargetDisplay:()=>o.e("chunk-16a1e32a").then(o.bind(null,"22f8")),VirtualSelect:ur},props:{editType:{type:String,required:!0,validator(t){return/^(?:add|edit)$/.test(t)}},defaultEventType:{type:String,required:!0},eventTypeList:{type:Array,default:()=>vl},controlData:{type:Object},eventDescription:[Object,null],targetNameMap:{type:Object}},computed:{eventTypeChangeable(){return"add"==this.editType},dataTables(){return this.$store.state.dataTables},selectedActions(){const t={};return this.actions.forEach(e=>{t[e.type]=!0}),t},showCondition(){return"valuechanged:compare"==this.eventType},treeDisplayType(){return/^(?:show|hide|clear)$/.test(this.currentAction)?"all":"assignment"==this.currentAction?"controls":"setData"==this.currentAction?"combobox":""},currentActionName(){const t=this.actionInfo[this.currentAction];return t?`(${t.name})`:""},currentActionTargets(){for(let t of this.actions)if(t.type==this.currentAction)return t.targets||[];return[]},fieldNameMap(){const t={};return this.fieldList.forEach(e=>{t[e.id]=e.text}),t}},data(){return{actionInfo:yl,eventType:this.defaultEventType,eventConfigMap:bl,condition:{operation:"==",target:""},operationList:["==","!="],operationNames:Cl,actions:[],currentAction:"",runAtInit:!1,targetTable:"",targetTableField:"",fieldList:[],controlDataList:[]}},created(){this.getFieldList(),this.getControlDataList(),this.setEditEventData()},mounted(){"add"==this.editType&&1==this.eventConfigMap[this.eventType].actionList.length&&this.addAction(this.eventConfigMap[this.eventType].actionList[0].type)},methods:{setEditEventData(){const t=Object(Ot["d"])(this.eventDescription),e=t.type,o=t.runAtInit,n=t.conditions,i=t.actions;e&&(this.eventType=e),n&&n.length&&(this.condition.operation=n[0].operation,this.condition.target=n[0].target),Array.isArray(i)?(this.actions=i.map(t=>("assignment"==t.type&&(this.targetTable=t.sourceTableId,this.targetTableField=t.sourceTableField||""),xl(xl({},t),{},{name:yl[t.type].name,collaspe:!1}))),this.currentAction=this.actions[0].type):(this.actions.length&&(this.actions=[]),this.currentAction=""),this.runAtInit=o},getFieldList(){if(!this.targetTable)return this.fieldList=[];Cs(window.formDesignerActions.getTableFieldsUrl,{tableId:this.targetTable},"targerTable-"+this.targetTable).then(t=>{const e=t.TableStruct;Array.isArray(e)?this.fieldList=e:this.fieldList=[]}).catch(t=>{console.error(t)})},getControlDataList(){if(this.controlDataList=[],this.showCondition)return this.controlData.data?this.controlDataList=Object(Ot["d"])(this.controlData.data):this.$httpPost(window.formDesignerActions.getControlDataListUrl,{controlData:this.controlData}).then(t=>{if(!Array.isArray(t))throw new Error("获取控件数据出错!");this.controlDataList=t}).catch(t=>{console.error(t)})},addAction(t){this.selectedActions[t]||(this.actions.push(this.createAction(t)),this.currentAction=t)},createAction(t){const e=yl[t].name,o={type:t,name:e,targets:[],collaspe:!1};return o},removeAction(t,e){this.actions.splice(t,1),e&&(this.currentAction="")},handleTargetChange(t){const e=this.actions.filter(t=>t.type==this.currentAction)[0];e?e.targets=t:console.error("目标动作不存在")},onEventTypeChanged(){this.actions=[],this.currentAction=""},validate(){return new Promise((t,e)=>{const o=[];!this.showCondition||this.condition.operation&&this.condition.target||o.push({type:"condition",message:"事件条件未填写完整"}),this.actions.length?this.actions.forEach(t=>{t.targets&&t.targets.length||o.push({type:"action",target:t,message:`【${t.name}】动作未配置任何操作目标！`}),"assignment"==t.type&&(this.targetTable||o.push({type:"targetTable",message:"赋值必须选择数据来源表"}),this.targetTableField||o.push({type:"targetTableField",message:"必须选择查询字段"}),t.targets.forEach(e=>{e.setValueField||o.push({type:"target",message:`【${t.name}】动作下的 ${e.nodeName} 控件未配置赋值字段！！`})}))}):o.push({type:"action",message:"还未配置任何事件动作！"}),o.length?e(o):t()})},save(){return this.validate().then(()=>{this._doSave()}).catch(t=>{if(Array.isArray(t)){let e;console.error(t),e=1==t.length?t[0].message:"事件配置信息不完整，请检查",this.$message({message:e,type:"error",customClass:"event-config-error",showClose:!0})}else console.error(t)})},_doSave(){const t={type:this.eventType,originType:bl[this.eventType].originType,runAtInit:this.runAtInit};this.showCondition&&(t.conditions=[Object(Ot["d"])(this.condition)]),t.actions=this.actions.map(t=>{const e={type:t.type,targets:t.targets.map(t=>{const e={type:t.nodeType||t.type,id:t.id};return t.setValueField&&(e.setValueField=t.setValueField),e})};return"assignment"==t.type&&(e.sourceTableId=this.targetTable,e.sourceTableField=this.targetTableField),e}),JSON.stringify(t,0,2),this.$emit("save",this.eventType,t)},cancel(){this.$emit("cancel")},clearBindValueField(){const t=this.actions.filter(t=>"assignment"==t.type)[0];t.sourceTableField="",t&&t.targets&&t.targets.forEach(t=>{t.setValueField=""})},onTargetTableChange(){this.clearBindValueField()}},watch:{targetTable(){this.fieldList=[],this.getFieldList()},showCondition(t){t&&this.getControlDataList()}}},Ol=Dl,_l=(o("165c"),Object(mt["a"])(Ol,fl,gl,!1,null,null,null)),kl=_l.exports,Sl=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"event-card"},[o("div",{staticClass:"event-card-header"},[o("span",{staticClass:"el-icon-arrow-down event-card-toggle"}),o("span",{staticClass:"event-name"},[t._v(t._s(t.eventInfo[t.eventData.type].name))]),o("span",{staticClass:"event-card-config"},[o("span",{staticClass:"el-icon-setting event-card-setting",on:{click:t.editEvent}}),o("span",{staticClass:"el-icon-delete event-card-delete",on:{click:t.removeEvent}})])]),t.eventData.conditions&&t.eventData.conditions.length?o("div",{staticClass:"event-card-condition"},[t._v("当满足 This "+t._s(t.operationNames[t.eventData.conditions[0].operation])+" "+t._s(t.eventData.conditions[0].target)+" 时")]):t._e(),o("div",{staticClass:"event-card-actions"},t._l(t.eventData.actions,(function(e,n){return o("div",{key:e.type,staticClass:"event-card-action"},[o("span",{staticClass:"event-card-action-remove el-icon-close",on:{click:function(o){return t.removeAction(e.type,n,1==t.eventData.actions.length)}}}),o("div",{staticClass:"event-card-action-name"},[t._v(t._s(t.actionInfo[e.type].name))]),o("div",{staticClass:"event-card-action-targets"},t._l(e.targets,(function(e){return o("div",{key:e.id,staticClass:"event-card-action-target"},[t._v("\n          "+t._s(t.targetNameMap[e.id])+" "),e.setValueField?o("span",{staticStyle:{"margin-left":"10px"}},[t._v("[ "+t._s(e.setValueField)+" ]")]):t._e()])})),0)])})),0),t.eventData.runAtInit?o("div",{staticClass:"event-card-init"},[o("span",{staticClass:"el-icon-s-flag"}),t._v(" 初始化时执行")]):t._e()])},Tl=[],jl={name:"event-card",components:{},props:{eventData:{type:Object},targetNameMap:{type:Object}},data(){return{eventInfo:bl,actionInfo:yl,operationNames:Cl}},methods:{removeAction(t,e,o){this.$confirm(o?"此事件下仅有此一个动作，将删除事件，是否继续？":"确认移除此此事件动作？").then(()=>{this.$emit("remove-action",t,e)}).catch(()=>{})},editEvent(){this.$emit("edit-event")},removeEvent(){this.$confirm("确认移除此事件？").then(()=>{this.$emit("remove-event")}).catch(()=>{})}}},$l=jl,Il=(o("b020"),Object(mt["a"])($l,Sl,Tl,!1,null,null,null)),Pl=Il.exports;function El(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function Ll(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?El(Object(o),!0).forEach((function(e){Object(it["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):El(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}const Al={add:"add",edit:"edit"};var Ml={name:"event",components:{EventConfig:kl,EventCard:Pl},props:["controlData"],computed:{eventTypeList(){const t=this.controlData.type,e=window.FORM_DESIGN_CONFIG.controls[t].supportEvents;return vl.filter(t=>-1!=e.indexOf(t.type))},eventList(){const t=this.controlData.events;if(t){const e=[];return Object.keys(t).forEach(o=>{e.push(...t[o])}),e}return[]},targetNameMap(){const t=this.$store.getters.controlNameMap,e=this.$store.getters.allRows,o={};return e.forEach(t=>{o[t.id]=t.name||`${t.namePrefix}_${t.autoIndex}`}),Ll(Ll({},t),o)}},data(){return{dialogVisible:!1,configData:{editType:Al.add,eventType:"",evData:null,editingIndex:-1,editingType:""}}},methods:Ll(Ll({},Object(Dt["b"])(["setControlProp"])),{},{addEvent(t){const e=t.type,o=t.initRun;this.configData.eventType=e,this.configData.editType=Al.add,this.configData.evData={runAtInit:o},this.dialogVisible=!0},editEvent(t,e){this.configData.eventType=t,this.configData.editType=Al.edit,this.configData.evData=this.controlData.events[t][e],this.configData.editingIndex=e,this.configData.editingType=t,this.dialogVisible=!0},saveEvent(t,e){const o=this.controlData.events?Object(Ot["d"])(this.controlData.events):{};if(this.configData.editType==Al.add)o[t]?o[t].push(e):o[t]=[e];else{const t=this.configData,n=t.editingType,i=t.editingIndex;n&&-1!=i?o[n][i]=e:console.error("修改事件发生错误！")}this.setControlProp({prop:"events",value:o,control:this.controlData}),this.dialogVisible=!1},saveEditEvent(){},cancel(){this.dialogVisible=!1},removeEvent(t,e){const o=this.controlData.events;JSON.stringify(o[t][e],0,2);const n=Object(Ot["d"])(o);1==n[t].length?delete n[t]:n[t].splice(e,1),JSON.stringify(n,0,2);const i="remove-event";if("valuechanged:getcodelist"==t){const t=this.controlData.id,e=this.$store.getters.allControls.filter(e=>e.codeSyncPid==t);e.length&&e.forEach(t=>{this.setControlProp({group:i,prop:"codeSyncPid",value:"",control:t})})}this.setControlProp({group:i,prop:"events",value:n,control:this.controlData})},removeEventAction(t,e,o,n){if(void 0===n)return console.error("无法删除，错误的动作索引："+n);const i=this.controlData.events;JSON.stringify(i[t][e].actions[n],0,2);const s=Object(Ot["d"])(i);let r=s[t][e];r.actions&&r.actions.length?(r.actions.splice(n,1),r.actions.length||(r=null,1==s[t].length?delete s[t]:s[t].splice(e,1)),JSON.stringify(s,0,2),this.setControlProp({prop:"events",value:s,control:this.controlData})):console.error("无法删除")}})},Fl=Ml,Rl=(o("ec83"),Object(mt["a"])(Fl,pl,ml,!1,null,null,null)),Nl=Rl.exports;function Vl(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function Bl(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?Vl(Object(o),!0).forEach((function(e){Object(it["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):Vl(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var zl={name:"config-control",components:{NameConfig:xn,EventComponent:Nl},props:["control"],computed:Bl(Bl({},Object(Dt["c"])(["controlType2nameMap"])),{},{controlType(){const t=this.control.type;return this.controlType2nameMap[t]},controlConfig(){const t=this.control.type,e=window.FORM_DESIGN_CONFIG.controls[t];return e?Object(Ot["d"])(e.configItems):(console.error(t+" 类型控件的配置不存在，请检查！！！"),[])},supportEvent(){const t=this.control.type,e=window.FORM_DESIGN_CONFIG.controls[t].supportEvents;return e&&e.length},eventCount(){if(!this.supportEvent)return 0;const t=this.control.events;return t?Object.keys(t).map(e=>t[e].length).reduce((t,e)=>t+e,0):0}}),created(){if(this.$bus.$on("controlClick",this.labelTextAutoFocus),document.addEventListener("keyup",this.deleteShortcutKey),this.control){var t=this.control&&this.control.customValidate;t&&t.regExp&&(t.regSource=t.regExp,delete t.regExp)}},beforeDestroy(){this.$bus.$off("controlClick"),document.removeEventListener("keyup",this.deleteShortcutKey)},data(){return{currentView:"attribute"}},methods:{deleteShortcutKey(t){t.target&&-1!==["TEXTAREA","INPUT"].indexOf(t.target.nodeName)||46===t.which&&this.$store.state.selectedControlId&&this.removeControl()},removeControl(){this.$store.dispatch("deleteControl")},onNameChange(t){this.$store.dispatch("setControlProp",{value:t,prop:"name",control:this.control})},labelTextAutoFocus(){this.$nextTick(()=>{if("title"==this.control.type||"label"==this.control.type)try{this.$children.some(t=>{if(t.focus)return t.focus(),!0})}catch(t){console.error(t)}})},getControlValue(t,e){return/\./.test(e.associatedProp)?Object(Ot["g"])(t,e.associatedProp):t[e.associatedProp]},change(t,e,o){this.$store.dispatch("setControlProp",{value:t,prop:e.associatedProp,control:this.control,group:o})},getExtends(t){return t?t+""===t?[("extend-"+t).toLowerCase()]:t.map(t=>("extend-"+t).toLowerCase()):[]},handleExtendChange(t,e,o){this.$store.dispatch("setControlProp",{value:t,prop:e,control:this.control,group:o})},getControlComponent(t){const e=t.toLowerCase();return e in ul?ul[e]:hl}},watch:{"control.id"(){this.currentView="attribute"}}},Hl=zl,Gl=Object(mt["a"])(Hl,fn,gn,!1,null,null,null),ql=Gl.exports,Wl=function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.rowId?o("div",{staticClass:"config-row"},[o("NameConfig",{attrs:{"component-data":t.row,type:t.rowType},on:{change:t.onNameChange,remove:t.removeRow}}),"row-layout"==t.type?o("div",{staticClass:"config-control-tabcontent"},[t._m(0)]):t._e(),"acc-layout"==t.type?o("ConfigAcc",{staticClass:"config-control-tabcontent",attrs:{"layout-data":t.row}}):t._e()],1):t._e()},Ul=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"config-block"},[o("h3",{staticClass:"config-category"}),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("行")]),o("div",{staticClass:"form-control"})])])}],Jl=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("h3",{staticClass:"config-category"},[t._v("手风琴配置")]),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("显示导航")]),o("div",{staticClass:"form-control"},[o("div",{staticClass:"form-control-item"},[o("el-switch",{model:{value:t.showNav,callback:function(e){t.showNav=e},expression:"showNav"}})],1)])]),o("h3",{staticClass:"config-category"},[t._v("手风琴项配置")]),o("div",{staticClass:"form-item"},t._l(t.items,(function(e,n){return o("div",{key:e.id,staticClass:"form-control-item acc",on:{click:function(o){return t.handleItemClick(e)}}},[o("span",{staticStyle:{"margin-right":"4px"}},[t._v(t._s(t._f("getOrder")(n)))]),o("span",[t._v(t._s(e.props.title))])])})),0),o("div",{staticClass:"form-item"},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.editing,expression:"editing"}],staticClass:"form-control-item"},[o("el-input",{ref:"nameInput",staticStyle:{width:"160px","margin-right":"8px"},attrs:{placeholder:"请输入手风琴项标题"},model:{value:t.itemName,callback:function(e){t.itemName=e},expression:"itemName"}}),o("el-tooltip",{attrs:{"open-delay":500,content:"新增"}},[o("el-button",{staticClass:"el-icon-check",attrs:{disabled:!t.itemNameValidated},on:{click:t.addItem}})],1)],1),o("el-tooltip",{attrs:{"open-delay":500,content:"添加手风琴项"}},[o("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.editing,expression:"!editing"}],staticClass:"el-icon-plus",on:{click:t.handleAdd}})],1)],1)])},Yl=[];function Xl(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function Kl(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?Xl(Object(o),!0).forEach((function(e){Object(it["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):Xl(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var Ql={name:"config-acc",props:["layoutData"],data(){const t=this.layoutData;return{showNav:t.props.showNav,itemName:"",editing:!1}},computed:{items(){return this.layoutData.cols},itemNameValidated(){return this.itemName&&this.itemName.trim()}},filters:{getOrder(t){const e=t+1;return e>=10?e:"0"+e}},methods:Kl(Kl({},Object(Dt["b"])(["activeRightTab","setSelectedCol"])),{},{submit(t,e){this.$store.commit({type:"setRowProps",prop:t,value:e,row:this.layoutData})},handleItemClick(t){const e=t.id;this.setSelectedCol({id:e}),this.activeRightTab("cell")},handleAdd(){this.editing=!0,this.$nextTick(()=>{this.$refs["nameInput"].focus()})},addItem(){const t=this.itemName,e=this.layoutData.id,o=this.layoutData.cols.length,n={id:`col-${e}-${o+1}`,name:t,type:"acc-item",props:{title:t,opened:!0},style:{verticalAlign:"middle",textAlign:"center",width:"100%",border:Object(Ot["d"])(this.$store.state.globalStyle.border)},subs:[],controls:[]};this.$store.commit({type:"addAccItem",item:n,parentRow:this.layoutData,shuttle:!0}),this.editing=!1,this.itemName=""}}),watch:{showNav(t){this.submit("props.showNav",t)}}},Zl=Ql,ta=(o("bc87"),Object(mt["a"])(Zl,Jl,Yl,!1,null,null,null)),ea=ta.exports,oa={name:"config-row",props:["rowId"],components:{NameConfig:xn,ConfigAcc:ea},computed:{row(){const t=this.rowId;return this.$store.getters.rowDataMap[t].row},rowType(){return this.row.namePrefix||this.row.name},type(){const t=this.row.type;return t||"row-layout"}},mounted(){document.addEventListener("keyup",this.deleteShortcurKey)},beforeDestroy(){document.removeEventListener("keyup",this.deleteShortcurKey)},methods:{deleteShortcurKey(t){46===t.which&&this.rowId&&this.removeRow()},onNameChange(t){this.$store.dispatch("setLayoutProp",{value:t,prop:"name"})},removeRow(){const t=this.isEmptyRow(this.row);return t?this.doRemoveRow():this.$confirm("此操作将移除此行，以及此行内的所有内容，是否确认？"," 删除提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.doRemoveRow()}).catch(()=>{})},doRemoveRow(){const t=this.$store.getters.selectedLayoutData,e=t.index,o=t.layout,n=this.$store.getters.selectedRowParentCol;-1!=e&&o?this.$store.dispatch("deleteRow",{parentCol:n,row:o,index:e}):console.error("出现错误 无法删除")},isEmptyRow(t){for(let e of t.cols)if(e.subs.length||e.controls.length)return!1;return!0}}},na=oa,ia=Object(mt["a"])(na,Wl,Ul,!1,null,null,null),sa=ia.exports,ra=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"preview-wrap"},[o("iframe",{ref:"preview",attrs:{src:t.iframeUrl,height:"100%",width:"100%",frameborder:"0"}})])},la=[];const aa=/.html/.test(location.pathname);var ca={name:"preview",props:["designId","tableGuid","type"],computed:{iframeUrl(){const t="./preview/preview"+(aa?".html":"");return`${t}?tableGuid=${this.tableGuid}&designId=${this.designId}&viewType=${this.type||""}`}},mounted(){const t=this.$refs["preview"];this.$parent.autoSave(!0),this.$parent.getData().then(e=>{this.retry(()=>"function"==typeof t.contentWindow.getPreviewHtml,()=>{t.contentWindow.getPreviewHtml,t.contentWindow.getPreviewHtml(e)})})},methods:{retry(t,e){let o=0;const n=()=>{var n=t();if(n)e();else{if(!(o++<500))throw new Error("预览加载超时");setTimeout(()=>{this.retry(t,e)},20)}};n()}}},da=ca,ua=(o("6758"),Object(mt["a"])(da,ra,la,!1,null,"5ae0da59",null)),ha=ua.exports,pa=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-dialog",{attrs:{width:"720px","append-to-body":"",title:"创建新字段",visible:t.dialogVisible,"show-close":!1}},[o("el-form",{ref:"form",attrs:{model:t.fieldProps,"label-width":"100px",rules:t.rules}},[o("el-row",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"字段英文名",prop:"fieldname"}},[o("el-input",{model:{value:t.fieldProps.fieldname,callback:function(e){t.$set(t.fieldProps,"fieldname",e)},expression:"fieldProps.fieldname"}})],1)],1),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"字段中文名",prop:"name"}},[o("el-input",{model:{value:t.fieldProps.name,callback:function(e){t.$set(t.fieldProps,"name",e)},expression:"fieldProps.name"}})],1)],1)],1),o("el-row",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"字段类型",prop:"dbtype"}},[o("el-select",{staticStyle:{width:"100%"},on:{change:t.onDBTypeChange},model:{value:t.fieldProps.dbtype,callback:function(e){t.$set(t.fieldProps,"dbtype",e)},expression:"fieldProps.dbtype"}},t._l(t.DBDataTypes,(function(e){return o("el-option",{key:e.id,attrs:{value:e.id,label:e.text}},[t._v(t._s(e.text))])})),1)],1)],1),t.showLength?o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"字段长度"}},[o("el-input-number",{staticStyle:{width:"100%"},attrs:{controls:!1},model:{value:t.fieldProps.length,callback:function(e){t.$set(t.fieldProps,"length",e)},expression:"fieldProps.length"}})],1)],1):t._e()],1),t.showPrecision?o("el-row",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"字段精度"}},[o("el-input-number",{staticStyle:{width:"100%"},attrs:{controls:!1},model:{value:t.fieldProps.precision,callback:function(e){t.$set(t.fieldProps,"precision",e)},expression:"fieldProps.precision"}})],1)],1)],1):t._e(),o("el-row",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"显示类型",prop:"fielddisplaytype"}},[o("el-select",{staticStyle:{width:"100%"},model:{value:t.fieldProps.fielddisplaytype,callback:function(e){t.$set(t.fieldProps,"fielddisplaytype",e)},expression:"fieldProps.fielddisplaytype"}},t._l(t.displayTypeList,(function(e){return o("el-option",{key:e.id,attrs:{value:e.id,label:e.text}},[t._v(t._s(e.text))])})),1)],1)],1),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"代码项"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{clearable:""},model:{value:t.fieldProps.datasource,callback:function(e){t.$set(t.fieldProps,"datasource",e)},expression:"fieldProps.datasource"}},t._l(t.codeList,(function(e){return o("el-option",{key:e.text,attrs:{value:e.id,label:e.text}},[t._v(t._s(e.text))])})),1)],1)],1)],1)],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),o("el-button",{attrs:{type:"primary",loading:t.inSave},on:{click:function(e){return t.create()}}},[t._v("创建")]),o("el-button",{attrs:{type:"primary",loading:t.inSave},on:{click:function(e){return t.create(!0)}}},[t._v("创建并绑定")])],1)],1)},ma=[];function fa(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function ga(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?fa(Object(o),!0).forEach((function(e){Object(it["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):fa(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var ba={computed:ga(ga({},Object(Dt["e"])(["DBDataTypes","codeList","newFieldList","fieldList"])),{},{allFiledList(){const t=this.fieldList.length?this.fieldList[0].fields:[];return[...t,...this.newFieldList]},showPrecision(){return"Numeric"==this.fieldProps.dbtype},showLength(){return"nvarchar"==this.fieldProps.dbtype||"Numeric"==this.fieldProps.dbtype},displayTypeList(){const t=window.FORM_DESIGN_CONFIG.controlList,e=this.$store.state.extControls,o=[];return t.forEach(t=>{o.push({id:t.type,text:t.name})}),e.forEach(t=>{o.push({id:t.type,text:t.name})}),o}}),data(){return{fieldProps:{fieldname:"",name:"",dbtype:"",length:18,precision:2,fielddisplaytype:"",datasource:"",fieldtype:""},displayTypeLoading:!1,dialogVisible:!1,inSave:!1,rules:{fieldname:[{required:!0,message:"字段英文名必填",trigger:"blur"},{validator:(t,e,o)=>{if(!/^[a-zA-Z][\da-zA-Z_]*$/.test(e))return o(new Error("仅能是字母开头加数字、字母、下划线的组合"));const n=this.allFiledList.some(t=>t.fieldname==e);return n?o(new Error("字段英文名必须唯一")):o()},trigger:"blur"}],name:[{required:!0,message:"字段中文名必填",trigger:"blur"}],dbtype:[{required:!0,message:"字段类型必填",trigger:"blur"}],fielddisplaytype:[{required:!0,message:"显示类型必填",trigger:"blur"}]},autoBindFn:()=>{}}},mounted(){this.init()},methods:{init(){this.$bus.$on("createBindField",t=>{this.dialogVisible=!0,this.autoBindFn=t,this.autoFillDisplayType()})},setInitData(){this.fieldProps={fieldname:"",name:"",dbtype:"",length:18,precision:2,fielddisplaytype:"",datasource:"",fieldtype:""}},autoFillDisplayType(){const t=this.$store.getters.selectedControl.control;this.fieldProps.fielddisplaytype=t?t.type:""},create(t){this.inSave=!0,this.$refs.form.validate(e=>{e?(this.save(t),this.$message({message:"新增成功，字段将在保存表单时进行创建",type:"success"}),this.setInitData(),this.inSave=!1,this.dialogVisible=!1):(this.$message({message:"字段信息不完整，请检查",type:"error"}),this.inSave=!1)})},save(t){const e=Object(Ot["d"])(this.fieldProps);this.showLength||delete e.length,this.showPrecision||delete e.precision,this.$store.commit({type:"addToNewFieldList",fieldProps:e}),t&&this.autoBindFn(e)},onDBTypeChange(){const t=this.fieldProps.dbtype;"Numeric"==t?(this.fieldProps.fieldtype="1",this.fieldProps.length=18):"Integer"==t?this.fieldProps.fieldtype="2":(this.fieldProps.fieldtype="0","nvarchar"==t&&(this.fieldProps.length=50))},adaptDisplayType(){if(!this.fieldProps.fielddisplaytype)return;const t=this.fieldProps.fielddisplaytype,e=this.displayTypeList.some(e=>e.id==t);e||(this.fieldProps.fielddisplaytype="")}}},ya=ba,va=Object(mt["a"])(ya,pa,ma,!1,null,null,null),Ca=va.exports,wa=function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.list.length?o("div",{staticClass:"row-container"},[t._l(t.list,(function(e,n){return o("RowGender",{key:e.id,attrs:{level:t.level,row:e,index:n,"parent-col":t.parentCol,"is-last-row":n==t.list.length-1,"prev-row":0==n?null:t.list[n-1]}})})),0===t.level?o("div",{staticClass:"hidden-area",staticStyle:{display:"none"}},t._l(t.hiddenControls,(function(t){return o("ControlGender",{key:t.id,attrs:{"control-data":t}})})),1):t._e()],2):t._e()},xa=[],Da=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"row",class:t.className,style:t.style,attrs:{"row-id":t.row.id,"data-name":t.row.name,"data-level":t.level}},t._l(t.row.cols,(function(e,n){return o("ColGender",{key:e.id,attrs:{"is-last-row":t.isLastRow,index:n,col:e,row:t.row,level:t.level,"row-index":t.index}})})),1)},Oa=[],_a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"col",class:t.getColCls(t.col,t.index,t.row.cols.length),style:t.colStyle,attrs:{id:t.col.id,role:"acc-item"==t.col.type?"accordion":"",opened:t.col.props&&t.col.props.opened?"true":"false"}},["acc-item"==t.type?o("div",{attrs:{role:"head",title:t.col.props.title}}):t._e(),"acc-item"==t.type?o("div",{attrs:{role:"body"}},[o("LayoutGender",{attrs:{list:t.col.subs,level:t.levelNext,parentCol:t.col,parentRow:t.row}}),t._l(t.col.controls,(function(t){return o("ControlGender",{key:t.id,attrs:{"control-data":t}})}))],2):t._e(),"acc-item"!=t.type?o("LayoutGender",{attrs:{list:t.col.subs,level:t.levelNext,parentCol:t.col,parentRow:t.row}}):t._e(),t._l(t.col.controls,(function(e){return"acc-item"!=t.type?o("ControlGender",{key:e.id,attrs:{"control-data":e}}):t._e()}))],2)},ka=[],Sa=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("section",{attrs:{"need-remove":"true"}},[o(t.getControl(t.controlData.type),{tag:"component",attrs:{id:t.controlData.id,"control-data":t.controlData,asControl:!0}}),t.showTips?o("span",{staticClass:"control-tips",class:{"tips-tooltip":t.isToolTip,"action-icon":t.isToolTip,"tips-bottom":!t.isToolTip},attrs:{"data-tooltip":t.isToolTip?t.tipsContent:""}},[t._v(t._s(t.isToolTip?"":t.tipsContent))]):t._e()],1)},Ta=[],ja=o("d718"),$a=o("9e0a");const Ia={label:ja["a"],title:$a["a"]},Pa={inheritAttrs:!1,props:["id"],template:'<span class="design-control-holder" :id="id"></span>'};var Ea={props:["control-data"],computed:{showTips(){const t=this.controlData.tooltipConfig;return t&&t.content},isToolTip(){const t=this.controlData.tooltipConfig;return t&&"tooltip"==t.type},tipsContent(){const t=this.controlData.tooltipConfig;return t&&t.content?t.content:""}},methods:{getControl(t){return t in Ia?Ia[t]:Pa}}},La=Ea,Aa=Object(mt["a"])(La,Sa,Ta,!1,null,null,null),Ma=Aa.exports;function Fa(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function Ra(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?Fa(Object(o),!0).forEach((function(e){Object(it["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):Fa(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var Na={name:"ColLayout",components:{ControlGender:Ma},data(){return{}},props:{row:{type:Object,required:!0},rowIndex:{type:Number,required:!0},col:{type:Object,required:!0},index:{type:Number,required:!0},level:{type:Number,required:!0},isLastRow:{type:Boolean,required:!0}},computed:Ra(Ra({},Object(Dt["e"])(["globalStyle"])),{},{type(){const t=this.col;return t&&t.type?t.type:"col-item"},levelNext(){return this.level+1},colStyle(){const t=this.col.style.width,e=t+""===t?t:t+"px";return{width:e}}}),methods:{getColCls(t,e,o){const n=this.globalStyle,i=t.subs.length,s=t.style,r={isSub:!i,hasSub:i,["text-"+(s.textAlign||n.textAlign)]:!0,["vertical-"+(s.verticalAlign||n.verticalAlign)]:!0};return r[this.type]=!0,"col-item"==this.type&&(r.first=0===e,r.mid=e&&e!==o-1,r.last=e===o-1),r}}},Va=Na,Ba=Object(mt["a"])(Va,_a,ka,!1,null,null,null),za=Ba.exports,Ha={name:"row-gender",components:{ColGender:za},props:{row:{type:Object},index:{type:Number},level:{type:Number},parentCol:{type:Object,default:null},isLastRow:{type:Boolean},prevRow:{type:Object,default:null}},computed:{type(){const t=this.row;return t&&t.type?t.type:"row-layout"},style(){const t=this.row.height,e=t+""===t?t:t+"px",o={};return"acc-layout"==this.type&&(o.marginTop="16px",o.marginBottom="16px"),"row-layout"==this.type&&(o["min-height"]=e),o},className(){const t=this.type,e={[t]:!0,isTop:0==this.level};return"acc-layout"==t?(e["fui-accordions"]=!0,e):(0===this.index||this.prevRow&&this.prevRow.type&&"row-layout"!=this.prevRow.type?e.first=!0:e.mid=!0,e)}}},Ga=Ha,qa=Object(mt["a"])(Ga,Da,Oa,!1,null,null,null),Wa=qa.exports,Ua={name:"LayoutGender",components:{RowGender:Wa,ControlGender:Ma},props:{list:{type:Array,default:()=>[]},level:{type:Number,default:0},parentCol:{type:Object,default:null},parentRow:{type:Object,default:null}},computed:{hiddenControls(){return this.$store.state.hiddenControls}},methods:{getHtmlContent(){return new Promise((t,e)=>{this.$nextTick(()=>{let e=this.$el.innerHTML;if(!e)return t("");e=e.replace(/<!---->/g,""),e=e.replace(/<section need-remove="true">(.*?)<\/section>/g,"$1"),t(e)})})}}},Ja=Ua,Ya=Object(mt["a"])(Ja,wa,xa,!1,null,null,null),Xa=Ya.exports,Ka=o("4be7"),Qa=o("9827"),Za=o("84a2"),tc=o.n(Za),ec=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"design-head"},[o("span",{staticClass:"design-tittle"},[t._v(t._s(t.formTitle))]),o("Shuttle",{directives:[{name:"show",rawName:"v-show",value:!t.showPreview,expression:"!showPreview"}],ref:"shuttle",staticClass:"header-btn-group"}),o("span",{directives:[{name:"show",rawName:"v-show",value:!t.showPreview,expression:"!showPreview"}],staticClass:"header-btn-group"},[o("span",{staticClass:"header-btn js-btn",attrs:{type:"text",size:"mini",title:"打开js编辑"},on:{click:function(e){return t.openEditor("js")}}}),o("span",{staticClass:"header-btn css-btn",attrs:{type:"text",size:"mini",title:"打开css编辑"},on:{click:function(e){return t.openEditor("css")}}}),o("span",{staticClass:"header-btn view-design-btn",class:{active:!0===t.viewDesign},attrs:{title:t.viewDesign?"切换为真实模式":"切换为设计模式",size:"mini",type:"text"},on:{click:t.toggleViewDesign}})]),o("span",{directives:[{name:"show",rawName:"v-show",value:!t.showPreview,expression:"!showPreview"}],staticClass:"header-btn-group"},[o("span",{staticClass:"header-btn pc",class:{active:"pc"==t.viewType},attrs:{title:"查看pc端设计"},on:{click:function(e){return t.updateViewType("pc")}}}),o("span",{staticClass:"header-btn mobile",class:{active:"mobile"==t.viewType},attrs:{title:"查看移动端设计"},on:{click:function(e){return t.updateViewType("mobile")}}})]),o("div",{staticClass:"design-head-right",staticStyle:{float:"right"}},[o("el-button",{staticClass:"preview-btn",attrs:{size:"mini"},on:{click:function(e){return t.setShowPreview(!t.showPreview)}}},[t._v(t._s(t.showPreview?"退出预览":"预览"))]),o("el-dropdown",{staticStyle:{"margin-left":"10px"},attrs:{"split-button":"",type:"primary",trigger:"click",size:"mini"},on:{click:t.onSaveClick,command:t.onDropDownItemClick}},[t._v("\n      保存\n      "),o("el-dropdown-menu",{staticClass:"save-menu",attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-dropdown-item",{attrs:{command:"saveToTpl"}},[t._v("另存为模板")]),o("el-dropdown-item",{attrs:{command:"saveToNewVersion"}},[t._v("生成新版本")]),o("el-dropdown-item",{attrs:{command:"saveToCopy"}},[t._v("生成副本")])],1)],1)],1),o("el-dialog",{attrs:{"append-to-body":"",title:t.editorDialog.title,visible:t.editorDialog.show,width:"90","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!0,fullscreen:"","custom-class":"code-editor-dialog","before-close":t.closeEditorDialog},on:{"update:visible":function(e){return t.$set(t.editorDialog,"show",e)},opened:t.onEditorDialogOpened}},[t.editorDialog.display?o("Editor",{attrs:{code:t.editorDialog.code,language:t.editorDialog.lang},on:{save:t.saveEditorCode,cancel:t.closeEditorDialog}}):t._e()],1)],1)},oc=[],nc=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("span",{staticClass:"form-shuttle-btns"},[o("el-tooltip",{attrs:{"open-delay":200,content:t.canUndo?"撤销":"无可撤销的操作"}},[o("span",{staticClass:"header-btn form-icon-undo",class:{disabled:!t.canUndo},on:{click:t.undo}})]),o("el-tooltip",{attrs:{"open-delay":200,content:t.canRedo?"还原":"无可还原的操作"}},[o("span",{staticClass:"header-btn form-icon-redo",class:{disabled:!t.canRedo},on:{click:t.redo}})])],1)},ic=[];let sc=null;const rc=(t=>{const e={};return t.forEach(t=>{e[t]=!0}),e})(["activeRightTab","updateLineTop","updateLineLeft","showHLine","hideHLine","showVLine","hideVLine","layoutDragStart","layoutDragEnd","controlDragStart","controlDragEnd","toggleViewDesign","updateViewType","setJsCode","setCssCode","addToNewFieldList"]),lc=(t=>{const e={};return t.forEach(t=>{e[t]=!0}),e})(["updateRowHeight","updateColWidth"]);var ac={name:"shuttle",data(){return{history:[],future:[]}},mounted(){document.addEventListener("keyup",this.initShortcutKey)},beforeDestroy(){document.removeEventListener("keyup",this.initShortcutKey)},computed:{canUndo(){return this.history.length},canRedo(){return this.future.length}},methods:{init(){window.shuttleManager=this,this.subscribeStore()},subscribeStore(){sc=JSON.stringify(this.$store.state);const t=(t,e)=>{const o=t.type;t.payload&&t.payload.shuttle&&this.storeState(o,sc,t.payload.group),sc=JSON.stringify(e)},e=tc()(t,300,{leading:!0,trailing:!1});this.$store.subscribe((o,n)=>{const i=o.type;rc[i]||(lc[i]?e(o,n):t(o,n))})},addHistory(t){if(t.group){let e=-1;for(let o=0,n=this.history.length;o<n;o++){if(this.history[o].group!=t.group)break;e=o}-1===e&&this.history.unshift(t)}else this.history.unshift(t);this.history.length>10&&(this.history.length=10)},addFuture(t){this.future.unshift(t),this.future.length>10&&(this.future.length=10)},storeState(t,e,o){const n={name:t,state:e,group:o};this.addHistory(n),this.future=[]},undo(){if(!this.canUndo)return;const t={name:"undo",state:JSON.stringify(this.$store.state)};this.addFuture(t);const e=this.history.shift();this.shuttle(e.state),sc=JSON.stringify(this.$store.state)},redo(){if(!this.canRedo)return;const t={name:"undo",state:JSON.stringify(this.$store.state)};this.addHistory(t);const e=this.future.shift();this.shuttle(e.state),sc=JSON.stringify(this.$store.state)},shuttle(t){const e=JSON.parse(t);e.helper.showVLine=!1,e.helper.showHLine=!1,e.helper.inControlDragging=!1,e.helper.inLayoutDragging=!1,e.leftActiveTab=this.$store.state.leftActiveTab,e.rightActiveTab=this.$store.state.rightActiveTab,this.$store.replaceState(e)},initShortcutKey(t){t.ctrlKey&&90==t.which?this.undo():t.ctrlKey&&89==t.which&&this.redo()}}},cc=ac,dc=(o("aeeb"),Object(mt["a"])(cc,nc,ic,!1,null,null,null)),uc=dc.exports,hc=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"editor-wrap"},[o("div",{staticClass:"editor-toolbar"},[o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.handleDialogClose("save")}}},[t._v("保存")]),o("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.handleDialogClose("cancel")}}},[t._v("取 消")]),o("el-tooltip",{attrs:{"open-delay":200,content:"格式化"}},[o("el-button",{attrs:{size:"mini",icon:"el-icon-s-grid"},on:{click:t.format}})],1),o("el-tooltip",{attrs:{"open-delay":200,content:"搜索替换"}},[o("el-button",{attrs:{size:"mini",icon:"el-icon-search"},on:{click:t.search}})],1)],1),o("div",{staticClass:"editor-main"},[o("div",{ref:"editorEl",staticClass:"editor-el",class:{"with-right":"javascript"==t.language}}),"javascript"==t.language?o("div",{staticClass:"editor-right"},[o("div",{staticClass:"editor-right-search"},[o("el-input",{attrs:{placeholder:"输入关键词进行过滤"},model:{value:t.searchInputValue,callback:function(e){t.searchInputValue=e},expression:"searchInputValue"}},[o("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),o("div",{staticClass:"scroll-wrap"},[o("Accordion",{attrs:{title:"控件"}},[t.filteredControlList.length?o("ul",{staticClass:"control-list"},t._l(t.filteredControlList,(function(e){return o("li",{key:e.id,on:{click:function(o){return t.addControl(e.id,e.type)}}},[t._v(t._s(e.name))])})),0):o("div",{staticClass:"control-list empty"},[t._v("无匹配控件")])]),o("Accordion",{attrs:{title:"常用值"}},[o("ul",{staticClass:"control-list"},t._l(t.valueList,(function(e){return o("li",{key:e.id,on:{click:function(o){return t.addValue(e.id)}}},[t._v(t._s(e.text))])})),0)])],1)]):t._e()])])},pc=[];o("3b2b");const mc="./monaco-editor/vs";function fc(){if(window.__MONACO_PROMISE__)return window.__MONACO_PROMISE__;const t=`\n    require.config({\n      paths: {\n        'vs': '${mc}'\n      }\n    });\n    require.config({\n      'vs/nls' : {\n        availableLanguages: {\n          '*': 'zh-cn'\n        }\n      }\n    });\n    require(['vs/editor/editor.main'], function () {\n      window.__monaco_editor__ = monaco;\n    });\n  `,e=new Promise((t,e)=>{const o=document.createElement("script");o.id="monaco-editor-loader",o.src=mc+"/loader.js",o.onload=()=>{o.onload=null,t("loader")},o.onerror=()=>{o.onerror=null,e("monaco-editor资源加载失败")},document.body.appendChild(o)}).then(()=>new Promise((e,o)=>{const n=document.createElement("script");n.text=t,n.onerror=()=>{n.onerror=null,o("monaco-editor资源加载失败")},document.body.appendChild(n),e("editor")})).then(()=>new Promise((t,e)=>{let o,n=0;function i(){window.__monaco_editor__?(clearTimeout(o),t(window.__monaco_editor__)):n++<1e3?setTimeout(i,30):e("monaco-editor资源加载失败")}i()}));return window.__MONACO_PROMISE__=e}function gc(t,e,o){var n;return e=e||17,function(){var i=arguments,s=o||this;clearTimeout(n),n=setTimeout((function(){t.apply(s,i)}),e)}}var bc={name:"Editor",components:{Accordion:Vt},props:{language:{type:String,default:"javascript",validator(t){return-1!==["javascript","css"].indexOf(t)}},code:{type:String,default:["function x() {",'    console.log("Hello world!");',"}",""].join("\n")}},data(){const t={defaultCode:{javascript:["epoint.onAfterInit = function (customData) {","    // 这个方法将在 页面initPage之后被调用\n    ","};","function myScriptFn() {","\t/* todo something */\n\t","}",""].join("\n"),css:"/* 在下面加入您的 css  */ \n"},editor:null,searchInputValue:""};return t.codeText=this.code||t.defaultCode[this.language],t},computed:{valueList(){return Object(Ot["d"])(window.FORM_DESIGN_CONFIG.preset["epointsform.specificValues"])},controlList(){const t=this.$store.state.hiddenControls,e=this.$store.getters.allControls,o=[];return t.forEach(t=>{o.push({id:t.id,type:t.type,name:t.name||t.namePrefix+t.autoIndex})}),e.forEach(t=>{o.push({id:t.id,type:t.type,name:t.name||t.namePrefix+t.autoIndex})}),o},filteredControlList(){const t=this.controlList,e=this.searchInputValue;if(!e)return t;const o=new RegExp(e,"i");return t.filter(t=>o.test(t.name))}},mounted(){"javascript"!=this.language?this.initEditor(this.codeText):this.loadTypes().then(()=>{this.initEditor(this.codeText)})},beforeDestroy(){window.removeEventListener("resize",this.adaptLayout),this.editor&&this.editor.dispose()},methods:{handleDialogClose(t){this.$emit(t,this.editor.getValue())},_adaptLayout(){this.editor&&this.editor.layout()},search(){this.editor._actions["actions.find"].run()},format(){this.editor._actions["editor.action.formatDocument"].run()},addControl(t,e){const o="label"==e||"title"==e?`$('#${t}').`:`mini.get('${t}').`;this.insertText(o),this.editor._actions["editor.action.triggerSuggest"].run()},addValue(t){this.insertText(t)},insertText(t){const e=this.editor.getPosition();this.editor.executeEdits("",[{range:{startLineNumber:e.lineNumber,startColumn:e.column,endLineNumber:e.lineNumber,endColumn:e.column},text:t}]);const o=this.editor.getSelection();o.selectionStartColumn=o.startColumn=o.endColumn,o.selectionStartLineNumber=o.startLineNumber=o.endLineNumber,this.editor.setSelection(o),this.editor.focus()},initEditor(t){this.adaptLayout=gc(this._adaptLayout,200),window.addEventListener("resize",this.adaptLayout),fc().then(e=>{window.__meditor=this.editor=e.editor.create(this.$refs.editorEl,{value:t||"",language:this.language,lineHeight:26,autoIndent:!0,formatOnPaste:!0,lineNumbers:"on",minimap:!0,tabCompletion:"on",quickSuggestions:{comments:!0},snippetSuggestions:"top",accessibilitySupport:"on",suggest:{}}),this.editor.focus()})},loadTypes(){const t={"content-type":"text/plain; charset=UTF-8"};return fc().then(e=>this.$httpGet("./types/mini-snippets.json",!0,t).then(t=>{const o=JSON.parse(t);o.forEach(t=>{t.kind=e.languages.CompletionItemKind.Function,t.detail=t.documentation}),e.languages.registerCompletionItemProvider("javascript",{provideCompletionItems:function(){return{suggestions:o}}})}).then(()=>{this.$httpGet("./types/jquery.d.ts",!0,t).then(t=>{e.languages.typescript.javascriptDefaults.addExtraLib(t,"jquery.d.ts")}),this.$httpGet("./types/miniui.d.ts",!0,t).then(t=>{e.languages.typescript.javascriptDefaults.addExtraLib(t,"miniui.d.ts")}),this.$httpGet("./types/epoint.d.ts",!0,t).then(t=>{e.languages.typescript.javascriptDefaults.addExtraLib(t,"epoint.d.ts")})}))}}},yc=bc,vc=(o("58d3"),Object(mt["a"])(yc,hc,pc,!1,null,null,null)),Cc=vc.exports;function wc(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function xc(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?wc(Object(o),!0).forEach((function(e){Object(it["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):wc(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var Dc={name:"Header",props:{formTitle:{type:String},inPreview:{type:Boolean}},components:{Shuttle:uc,Editor:Cc},data(){return{editorDialog:{title:"",show:!1,code:"",display:!1,lang:""}}},computed:xc(xc({},Object(Dt["e"])(["jsCode","cssCode"])),Object(Dt["e"])({viewType:t=>t.helper.viewType,viewDesign:t=>t.helper.viewDesign,showPreview:t=>t.helper.showPreview})),methods:xc(xc({},Object(Dt["d"])(["setJsCode","setCssCode","updateViewType","toggleViewDesign"])),{},{setShowPreview(t){this.$store.commit({type:"setShowPreview",showPreview:t})},openEditor(t){let e,o,n;"js"==t?(e=this.jsCode,o="js编辑",n="javascript"):(e=this.cssCode,o="css编辑",n="css"),this.editorDialog.title=o,this.editorDialog.code=e,this.editorDialog.lang=n,this.editorDialog.show=!0},onEditorDialogOpened(){this.editorDialog.display=!0},saveEditorCode(t){"javascript"==this.editorDialog.lang?this.setJsCode(t):"css"==this.editorDialog.lang&&this.setCssCode(t),this._closeEditorDialog()},_closeEditorDialog(){this.editorDialog.display=this.editorDialog.show=!1},closeEditorDialog(){this.$confirm("不需要保存此次的代码修改吗？","保存提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this._closeEditorDialog()}).catch(t=>{console.error(t)})},onSaveClick(){const t=this.$store.state.design&&this.$store.state.design.length;t?this.$emit("save-click"):this.$confirm("无设计数据，继续保存将提交空数据，是否继续？","保存提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$emit("save-click")}).catch(t=>{t&&console.error(t)})},onDropDownItemClick(t){this.$emit("drop-item-click",t)}})},Oc=Dc,_c=(o("c0a5"),o("20fd"),Object(mt["a"])(Oc,ec,oc,!1,null,null,null)),kc=_c.exports,Sc=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-dialog",{attrs:{title:"生成新版本",visible:!0,"custom-class":"new-version-dialog",width:"420px",top:"calc(50vh - 100px)","show-close":!1}},[o("p",{staticStyle:{margin:"0"}},[t._v("在一个新版本中编辑表单，原版本将被保留")]),o("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules}},[o("el-form-item",{attrs:{label:"选择模板结构",prop:"tplId"}},[o("el-select",{attrs:{size:"mini",filterable:""},model:{value:t.form.tplId,callback:function(e){t.$set(t.form,"tplId",e)},expression:"form.tplId"}},t._l(t.list,(function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1)],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:t.cancel}},[t._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v("确 定")])],1)],1)},Tc=[],jc={props:["visible"],data(){return{form:{tplId:""},list:[],rules:{tplId:[{required:!0,message:"必须选择模板",trigger:"blur"}]}}},mounted(){this.getData()},methods:{getData(){this.$httpPost(window.formDesignerActions.getSFormTplUrl).then(t=>{const e=t.list;Array.isArray(e)&&(this.list=e)})},confirm(){this.$refs.form.validate(t=>{t&&this.save(this.form.tplId).then(()=>{this.cancel()})})},cancel(){document.body.removeChild(this.$el),this.$destroy()}}},$c=jc,Ic=(o("caff"),Object(mt["a"])($c,Sc,Tc,!1,null,null,null)),Pc=Ic.exports;function Ec(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function Lc(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?Ec(Object(o),!0).forEach((function(e){Object(it["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):Ec(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}const Ac=Z["default"].extend(Pc),Mc=new URLSearchParams(location.search),Fc=Mc.get("designId")||"",Rc=Mc.get("tableGuid")||"";var Nc={name:"app-main",components:{Header:kc,Preview:ha,Tabs:Ct,TabPanel:gt,PanelLayout:It,PanelData:ee,Design:be,MobileDesign:Je,ConfigCell:Wo,ConfigForm:mn,PanelControl:qt,ConfigControl:ql,ConfigRow:sa,LayoutGender:Xa,NewFiledDialog:Ca},data(){return{autoSaveTimer:null,autoSaveInterval:6e4,needAutoSave:!1,dataLoaded:!1,formTitle:"表单设计器",needRender:!1,showLocalBtns:/useMock/i.test(location.search),enableRightBarCover:!0,narrowMode:!1,rightbarHidden:!1,designId:Fc,tableGuid:Rc}},computed:Lc(Lc(Lc(Lc({},Object(Dt["e"])(["leftActiveTab","rightActiveTab","formSize","selectedColId","hiddenControls","selectedRowId","jsCode","cssCode","newFieldList","mobileDesignData"])),Object(Dt["e"])({viewDesign:t=>t.helper.viewDesign,viewType:t=>t.helper.viewType,showPreview:t=>t.helper.showPreview})),Object(Dt["c"])(["codeListMap","selectedCol"])),{},{selectedControl(){const t=this.$store.state.selectedControlId;if(t){const e=this.$store.getters.controlDataMap[t];if(e&&e.control)return e.control}return null},cellPanelName(){return this.selectedColId&&this.selectedCol&&"acc-item"==this.selectedCol.type?"手风琴项":"单元格"},globalStyle:{get(){return this.$store.state.globalStyle},set(t){this.$store.commit("updateGlobalStyle",{style:t})}},design:{get(){return this.$store.state.design},set(t){this.$store.commit("updateDesign",t)}}}),mounted(){const t=this;window.FORM_DESIGNER.save=function(e){return t.saveToServer(e)},this.enableRightBarCover&&(this.calcWidth(),window.addEventListener("resize",this.calcWidth)),Ka["Promise"].all([this.$httpPost(window.formDesignerActions.getUrl,{designId:Fc,tableGuid:Rc}),this.$httpPost(window.formDesignerActions.getCodeItemUrl,{designId:Fc,tableGuid:Rc})]).then(t=>{const e=t[0],o=t[1].codeMain,n=e.extControls,i=e.fieldList,s=e.designData,r=e.macroTypes,l=e.sourceTables,a=e.dataTables,c=e.dataType,d=e.commonFields;if(Array.isArray(d)&&this.setCommonControls(d),i&&i.length&&(i.forEach(t=>{t.fields.forEach(t=>{t.required=1==parseInt(t.required,10),t.fieldtype=parseInt(t.fieldtype,10)})}),this.setFieldList(i)),e.name&&(this.formTitle=e.name,document.title=this.formTitle),o&&o.length&&this.setCodeList(o),r&&r.length&&this.setMacroTypes(r),n&&n.length&&this.setExtControls(n),l&&l.length&&this.setSourceTables(l),a&&a.length&&this.setDataTables(a),e.jsCode&&this.setJsCode(Object(Ot["e"])(e.jsCode)),e.cssCode&&this.setCssCode(Object(Ot["e"])(e.cssCode)),c&&this.setDBDataTypes(c),s){s.globalStyle&&(this.globalStyle=s.globalStyle),s.design&&(this.design=s.design),s.mobileDesignData&&this.$store.commit({type:"replaceMobileDesign",mobileDesignData:s.mobileDesignData}),s.hiddenControls&&this.$store.commit("setHiddenControls",s.hiddenControls),s.skin&&this.$store.commit("setSkin",{skinName:s.skin}),Qa["c"].control.adapt(this.$store.getters.allControls),Qa["c"].control.adapt(this.$store.state.hiddenControls),Qa["c"].col.adapt(this.design),Ot["l"].adapt(this.$store.getters.allRows,t=>t.id),this.$store.commit({type:"controlCompatible",controls:this.$store.getters.allControls}),this.dataLoaded=!0;const t=parseInt(e.autoSaveTime,10);t&&(this.autoSaveInterval=t),this.$nextTick(()=>{this.$refs.header.$refs.shuttle.init()}),this.subscribeStore(),this.doAutoSave()}}).catch(t=>{console.error(t)}),this.$httpPost(window.formDesignerActions.getListInfoUrl,{designId:Fc,tableGuid:Rc}).then(t=>{const e=t.SformListInfo;Array.isArray(e)&&this.$store.commit("setButtonEditPopupList",e)}).catch(t=>{console.error(t)})},methods:Lc(Lc(Lc({},Object(Dt["d"])(["activeLeftTab","setFieldList","setCodeList","setMacroTypes","setExtControls","setSourceTables","setDataTables","setJsCode","setCssCode","setDBDataTypes","setCommonControls"])),Object(Dt["b"])(["activeRightTab"])),{},{calcWidth:tc()((function(){this.narrowMode=window.innerWidth<1610}),20,{leading:!0,trailing:!0}),clear(){this.design=[]},preview(){return this.getData().then(t=>{const e=t.build,o=`\n      <!DOCTYPE html>\n      <html lang="en">\n      <head>\n          <meta charset="UTF-8">\n          <meta name="viewport" content="width=device-width, initial-scale=1.0">\n          <meta http-equiv="X-UA-Compatible" content="ie=edge">\n          <title>Document</title>\n          <style>html,body{margin:0;padding:0;}.container{margin:0 auto;}</style>\n          <style>.row{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap}.col{position:relative;-webkit-box-sizing:border-box;box-sizing:border-box;box-sizing:border-box;min-height:30px;padding:6px;line-height:30px;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0}.col.hasSub{padding:0}.col>*{position:relative;z-index:1}.col:after{position:absolute;z-index:0;top:0;right:0;bottom:0;left:0;display:block;-webkit-box-sizing:border-box;box-sizing:border-box;content:"";background:transparent}.col.hasSub:after{border-top-width:0 !important;border-right-width:0 !important;border-bottom-width:0 !important;border-left-width:0 !important}.col.mid:after{border-left-width:0 !important}.col.mid>.row>.col.first:after,.col.mid>.row-container>.row>.col.first:after,.col.last>.row>.col.first:after,.col.last>.row-container>.row>.col.first:after{border-left-width:0 !important}.col.mid ~ .col.last:after,.col.first ~ .col.last:after{border-left-width:0 !important}.row.mid>.col:after{border-top-width:0 !important}.row.mid>.col>.row>.col:after,.row.mid>.col>.dropArea>.row>.col:after{border-top-width:0 !important}.col{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}.col.text-left{text-align:left}.col.text-center{text-align:center}.col.text-right{text-align:right}.col.vertical-top{vertical-align:top}.col.vertical-middle{vertical-align:middle}.col.vertical-bottom{vertical-align:bottom}.col.text-left{-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start}.col.text-center{-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.col.text-right{-webkit-box-align:end;-webkit-align-items:flex-end;-ms-flex-align:end;align-items:flex-end}.col.vertical-top{-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start}.col.vertical-middle{-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center}.col.vertical-bottom{-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end}.design-form-title,.design-form-label{position:relative;display:block;-webkit-box-sizing:border-box;box-sizing:border-box;width:100%}.design-form-label{padding-right:8px}.design-form-label.required:after{position:absolute;top:50%;right:-2px;display:block;width:8px;height:16px;margin-top:-8px;font-size:16px;line-height:16px;content:"*";color:red}.mini-textbox-readOnly .mini-textbox-border,.mini-textbox-readOnly .mini-textbox-input,.mini-buttonedit-readOnly .mini-buttonedit-border,.mini-buttonedit-readOnly .mini-buttonedit-input,.mini-readonly .mini-textboxlist-border{cursor:default;border:0;background:none}.mini-buttonedit-readOnly .mini-buttonedit-button,.mini-readonly .mini-textboxlist-close{display:none}.mini-readonly .mini-textboxlist-item{padding-right:8px}.row.acc-layout{display:block;padding-left:0;padding-right:0}.col.acc-item{display:block}.col.acc-item>.fui-acc-bd{padding-left:0;padding-right:0}.col.acc-item:after{border:none !important}</style>\n          <style>${e.style}</style>\n      </head>\n      <body>\n          <div class="container" style="width:${this.formSize.width}px;">${e.html}</div>\n      </body>\n      </html>\n      `,n=new Blob([o],{type:"text/html"});var i=document.createElement("a");i.download="测试表单设计器生成布局",i.href=URL.createObjectURL(n),document.body.appendChild(i),i.click(),document.body.removeChild(i),window.html=o})},getMobileData(){const t=Object(Ot["d"])(this.mobileDesignData),e=this.$store.getters.controlDataMap;return t.forEach(t=>{if(t.control){const o=t.control.id;e[o]&&(t.control=e[o].control)}}),this.$store.commit({type:"replaceMobileDesign",mobileDesignData:t}),t},getData(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{htmlEncode:!0,withBuild:!0},o="";return e.withBuild?(t=this.getHtml(),o=this.getStyle()):t=Ka["Promise"].resolve(""),t.then((t,n)=>{if(n)return console.error(n);const i=this.getDesignData(),s=i.hiddenControls;let r=Object(Ot["d"])(this.$store.getters.allControls);r.push(...s);const l={designData:i,build:{html:t,style:o},controls:r,jsCode:Object(Ot["f"])(this.jsCode),cssCode:Object(Ot["f"])(this.cssCode),newFieldList:Object(Ot["d"])(this.newFieldList),designId:Fc,tableGuid:Rc};return e.withBuild&&0!=e.htmlEncode&&l.build.html&&(l.build.html=Object(Ot["h"])(l.build.html)),l})},getDesignData(){this.$store.dispatch("dealSubmitControl");const t=Object(Ot["d"])(this.hiddenControls);return{globalStyle:Object(Ot["d"])(this.globalStyle),hiddenControls:t,design:Object(Ot["d"])(this.design),skin:this.$store.state.skin,mobileDesignData:this.getMobileData()}},autoCreateField(){const t=[...this.$store.getters.allControls,...this.$store.state.hiddenControls];if(!t||!t.length)return Ka["Promise"].resolve();const e=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o=t.filter(t=>e(t,"bind")&&""==t.bind);if(!o.length)return Ka["Promise"].resolve();const n=Object(Ot["d"])(o);return n.forEach(t=>{t.name||(t.name=t.namePrefix+(t.autoIndex||""))}),this.$httpPost(window.formDesignerActions.autoCreateFieldUrl,{designId:Fc,tableGuid:Rc,controls:n}).then(t=>{const e=t.fieldList;if(!Array.isArray(e)||!e.length)return console.error("未获取到自动创建的字段数据"),Ka["Promise"].reject(new Error("自动创建字段时失败"));const n=e.reduce((t,e)=>(t[e.controlId]?t[e.controlId]=[t[e.controlId],e]:t[e.controlId]=e,t),{});this.$store.dispatch({type:"bindFieldToControl",fieldMaps:n,controls:o,newFieldList:e.map(t=>{const e=Object(Ot["d"])(t);return delete e.controlId,e})})})},mergeAndRestAnalyData(t){return Pn()(t,{analysis:Lc({},window.FORM_DESIGNER_ANALYSIS)}),window.FORM_DESIGNER_ANALYSIS.reset(),t},saveToServer(t){return this.autoCreateField().then(()=>this.getData()).then(t=>{if(window.FORM_DESIGNER&&window.FORM_DESIGNER.validateBeforeSave&&"function"==typeof window.FORM_DESIGNER.validate){const e=window.FORM_DESIGNER.validate(t);if(!1===e)return Ka["Promise"].reject(new Error("校验失败"));if(e&&e.then)return e.then(()=>this.$httpPost(window.formDesignerActions.saveUrl,this.mergeAndRestAnalyData(t)))}return this.$httpPost(window.formDesignerActions.saveUrl,this.mergeAndRestAnalyData(t))}).then(e=>{const o=e;if(1!=parseInt(o.msg,10))throw new Error(o.msg||o);!t&&this.$msgbox({title:"系统提醒",message:"保存成功",type:"success",showClose:!0,callback(){location.reload()}})}).catch(t=>{this.$msgbox({title:"系统提醒",message:"保存失败 "+(t&&t.message||""),type:"error",showClose:!0})})},promptAndSave(t,e){return this.$msgbox(Pn()({closeOnClickModal:!1,showInput:!0,confirmButtonText:"确定",cancelButtonText:"取消",showCancelButton:!0,showConfirmButton:!0,beforeClose:(t,o,n)=>{if("confirm"===t){o.$type="prompt";const t=o.validate();if(!t)return;o.confirmButtonLoading=!0,e(o.inputValue).then(()=>{n()}).finally(()=>{o.confirmButtonLoading=!1})}else n()}},t))},handleCommand(t){return"saveToTpl"==t?this.promptAndSave({message:"请输入模板名称",title:"创建模板",inputValue:this.formTitle+"_模板_1",inputValidator(t){return t&&t.trim()?!!/^[.\d\w-_\u4E00-\u9FA5]+$/.test(t)||"模板名称格式不正确":"模板名称不能为空"}},t=>this.saveAsTpl(t)):("saveToNewVersion"===t&&this.confirmNewVersion(),"saveToCopy"===t?this.promptAndSave({confirmButtonText:"生成",message:"请输入表单名称",title:"生成副本",inputValue:this.formTitle+"_副本_1",inputValidator(t){return t&&t.trim()?!!/^[.\d\w-_\u4E00-\u9FA5]+$/.test(t)||"表单名称格式不正确":"表单名称不能为空"}},t=>this.saveAsCopy(t)):void 0)},saveAsTpl(t){return this.getData().then(e=>(e.name=t,this.$httpPost(window.formDesignerActions.saveAsTplUrl,e))).then(t=>(this.$message({type:"success",message:"模板保存成功"}),Ka["Promise"].resolve())).catch(t=>(console.error(t),this.$message({type:"error",message:"模板保存失败",showClose:!0,duration:3e3}),Ka["Promise"].reject()))},confirmNewVersion(){const t=new Ac({el:document.createElement("div")});t.save=t=>this.saveAsNewVersion(t),document.body.appendChild(t.$el)},saveAsNewVersion(t){return this.getData({withBuild:!1}).then(e=>(e.tplId=t,this.$httpPost(window.formDesignerActions.saveAsNewVersionUrl,e))).then(t=>{this.$confirm("新版本创建成功，是否进入新表单进行设计","提示",{confirmButtonText:"开始设计",cancelButtonText:"留在当前页"}).then(()=>{const e=t.tableGuid,o=t.designId,n=`${location.pathname}?tableGuid=${e||""}&designId=${o||""}`;location.replace(n)})}).catch(t=>(console.error(t),this.$message({type:"error",message:"新版本创建失败",showClose:!0,duration:3e3,offset:window.innerHeight/4*3>>0}),Ka["Promise"].reject()))},saveAsCopy(t){return this.getData({withBuild:!1}).then(e=>(e.name=t,this.$httpPost(window.formDesignerActions.saveAsCopyUrl,e))).then(t=>(this.$message({type:"success",message:"表单副本保存成功"}),setTimeout(()=>{this.$confirm("新表单创建成功，是否进入新表单进行设计","提示",{confirmButtonText:"开始设计",cancelButtonText:"留在当前页"}).then(()=>{const e=t.tableGuid,o=t.designId,n=`${location.pathname}?tableGuid=${e||""}&designId=${o||""}`;location.replace(n)})},100),Ka["Promise"].resolve())).catch(t=>(console.error(t),this.$message({type:"error",message:"表单副本保存失败",showClose:!0,duration:3e3,offset:window.innerHeight/4*3>>0}),Ka["Promise"].reject()))},replaceDesign(t){t.globalStyle&&(this.globalStyle=t.globalStyle),this.design=t.design||[],this.$store.commit("setHiddenControls",t.hiddenControls||[]),this.$store.commit("setSkin",{skinName:t.skin}),Qa["c"].control.adapt(this.$store.getters.allControls),Qa["c"].control.adapt(this.$store.state.hiddenControls),Qa["c"].col.adapt(this.design),Ot["l"].adapt(this.$store.getters.allRows,t=>t.id)},subscribeStore(){this.$store.subscribe(()=>{this.needAutoSave=!0}),this.subscribeStore=function(){}},autoSave(t){if(!this.needAutoSave)return Ka["Promise"].resolve();const e={designData:this.getDesignData(),newFieldList:Object(Ot["d"])(this.newFieldList)};return this.$httpPost(window.formDesignerActions.autoSaveUrl,Pn()({designId:Fc,tableGuid:Rc},e)).then(e=>{const o=e;if(1!=parseInt(o.msg,10))throw new Error(o.msg||o);!t&&this.$message({title:"系统提醒",message:"自动保存成功",type:"success",showClose:!0}),this.$store.commit("submitNewFieldList"),this.needAutoSave=!1}).catch(t=>{this.$message({title:"系统提醒",message:"自动保存失败 "+t.message,type:"error",showClose:!0})})},doAutoSave(){clearTimeout(this.autoSaveTimer),this.autoSaveTimer=setTimeout(()=>{this.autoSave().finally(()=>{this.doAutoSave()})},this.autoSaveInterval||6e4)},getStyle(){return this.$store.getters.colStyleText},getHtml(){return this.needRender=!0,new Ka["Promise"]((t,e)=>{const o=setTimeout(()=>{e({msg:"渲染超时！！！"})},3e3);this.$nextTick(()=>{this.$refs.builder.getHtmlContent().then(e=>{t(e),clearTimeout(o),this.needRender=!1})})}).catch(t=>{this.needRender=!1,console.error(t)})}}),beforeDestroy(){this.enableRightBarCover&&window.removeEventListener("resize",this.calcWidth),clearTimeout(this.autoSaveTimer)},watch:{design:{deep:!1,handler(t){JSON.stringify(t)!=JSON.stringify(this.design)&&this.$store.commit("updateDesign",t)}}}},Vc=Nc,Bc=(o("bec5"),o("3176"),Object(mt["a"])(Vc,ot,nt,!1,null,null,null)),zc=Bc.exports,Hc={name:"app",components:{Main:zc},data(){return{height:window.innerHeight}},mounted(){window.addEventListener("resize",this.handelResize),this.handleIE()},methods:{handelResize(){clearTimeout(this._resizeTimer),this._resizeTimer=setTimeout(()=>{this.height=window.innerHeight},200)},handleIE(){(document.all&&document.compatMode||"-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style)&&(document.body.className?document.body.className+=" ie":document.body.className=" ie",this.$message({message:"为了有更好的体验，请使用最新版Chrome浏览器。",type:"error",showClose:!0,duration:1e4}))}},beforeDestroy(){window.removeEventListener("resize",this.handelResize)}},Gc=Hc,qc=(o("034f"),Object(mt["a"])(Gc,tt,et,!1,null,null,null)),Wc=qc.exports,Uc=o("9aba"),Jc=o.n(Uc),Yc={getters:{rowDataMap:t=>{const e={};function o(t,n){e[t.id]&&console.warn("行id出现重复！！！",e[t.id],t),e[t.id]={row:t,index:n},t.cols&&t.cols.forEach(t=>{t.subs&&t.subs.forEach(o)})}return t.design.forEach(o),e},allRows:(t,e)=>{let o=e.rowDataMap;const n=[];for(let i in o)o.hasOwnProperty(i)&&n.push(o[i].row);return n},subRowPathMap:(t,e)=>{const o={};function n(t){o[t.id]||(o[t.id]=[]),t.cols&&t.cols.forEach(e=>{e.subs&&(e.subs.forEach(e=>{o[e.id]=[t].concat(o[t.id])}),e.subs.forEach(n))})}t.design.forEach(n);for(let i in o)!o.hasOwnProperty(i)||o[i]&&o[i].length||delete o[i];return o},selectedRowParentCol:(t,e)=>{const o=t.selectedRowId;if(!o)return null;const n=e.subRowPathMap[o];if(n&&n.length)for(let i of n[0].cols)if(i.subs&&i.subs.length)for(let t of i.subs)if(t.id==o)return i;return null},selectedLayoutData:(t,e)=>{const o=t.selectedRowId;if(!o)return{layout:null,index:-1};const n=e.rowDataMap[o];return{layout:n.row,index:n.index}}},mutations:{updateSelectedLayout(t,e){const o=e.id;t.selectedRowId=o},setRowProps(t,e){void 0===e.shuttle&&(e.shuttle=!0);const o=e.prop,n=e.value,i=e.row;Object(Ot["k"])(i,o,n)},removeRow(t,e){const o=e.parentCol,n=e.index;o?o.subs?o.subs.splice(n,1):console.error("删除时找不到上级！！！"):t.design.splice(n,1)},updateRowHeight(t,e){const o=e.row,n=e.height,i=n-o.height;function s(t,e){t.cols&&t.cols.forEach(t=>{const o=t.subs;if(!o||!o.length)return;const n=o[o.length-1],i=o.reduce((t,e)=>t+e.height,0),r=e-i;if(r>0)n.height+=r;else{const t=n.height+r;n.height=t<_t["b"]?_t["b"]:t}s(n,n.height)})}function r(t,e){if(!t||!t.length)return;const o=t[0];o.height+=e,void 0!=o.type&&"row-layout"!=o.type||s(o,o.height),r(t.slice(1),e)}o.height=n,s(o,n),!1!==e.bubble&&r(e.parentRowPath,i)},replaceToMulti(t,e){const o=e.row,n=e.rowIndex,i=e.rowCount,s=e.colCount,r=e.parentCol,l=r&&r.subs?r.subs:t.design;let a=900;r&&r.style.width&&"number"==typeof r.style.width&&(a=r.style.width);const c=d(o,i,s,a);function d(t,e,n,i){const s=Object(Ot["d"])(t),r=o.cols[0];s.cols=[],s.asMulti=!1,delete s.asMulti,r.style.width=i/n;const l=[...new Array(e)].map(()=>{const t=Object(Ot["l"])(),e=Object(Ot["d"])(s);return e.id=t,e.autoIndex=Ot["j"].getIndex(e.namePrefix||e.name),e.cols=[...new Array(n)].map(()=>{const e=Ot["b"].getIndex(t),o=Object(Ot["d"])(r);return o.id=`col-${t}-${e}`,o.name="col-"+e,o}),e});return l}l.splice(n,1,...c)},copyRow(t,e){const o=e.aimIndex,n=e.newRow,i=e.parentCol?e.parentCol.subs:t.design;i.splice(o,0,n)},updateLayoutProp(t,e){const o=e.prop,n=e.value,i=e.layout;i?i[o]=n:console.error("组件件不存在")},updateAllRowHeight(t,e){const o=e.rows,n=e.height;function i(t){t.cols.forEach(t=>{t.subs.forEach(t=>{for(let e of t.cols)if(e.subs&&e.subs.length)return!1;t.height=n})})}Array.isArray(o)&&o.forEach(t=>{t.height=n,"acc-layout"==t.type&&i(t)})}},actions:{setAllRowHeight(t,e){const o=e.height,n=t.state.design.filter(t=>{if("acc-layout"==t.type)return!0;for(let e of t.cols)if(e.subs&&e.subs.length)return!1;return!0}),i="allRowHeight"+ +new Date;t.commit("updateGlobalStyleProp",{prop:"cellHeight",value:o,shuttle:!0,group:i}),n.length&&t.commit("updateAllRowHeight",{rows:n,height:o,shuttle:!0,group:i})},setSelectedLayout(t,e){t.commit("updateSelectedLayout",e),t.commit({type:"setSelectedCol",selectedColId:""}),t.commit("clearSelectedControl")},setLayoutProp(t,e){let o=e.layout,n=e.prop,i=e.value;o||(o=t.getters.selectedLayoutData.layout),t.commit("updateLayoutProp",{layout:o,prop:n,value:i})},deleteRow(t,e){void 0===e.shuttle&&(e.shuttle=!0),void 0===e.group&&(e.group="deleteRow-"+ +new Date),e.row==t.getters.selectedLayoutData.layout&&t.commit("updateSelectedLayout",{id:""});const o=e.row.height;t.commit("removeRow",e);const n=e.parentCol;if(n){const e=n.subs;if(!e.length)return;const i=e[e.length-1],s=i.height+o;t.commit("updateRowHeight",{row:i,height:s,bubble:!1})}}}},Xc=(o("4917"),{getters:{allCol:(t,e)=>{const o=[],n=e.rowDataMap;let i;for(let s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i=n[s].row,i.cols.forEach(t=>{o.push(t)}));return o},colStyleText:(t,e)=>{const o=e.allCol,n=[];return o.forEach(t=>{const e=t.style.border,o=[`#${t.id}:after{`,`border-top: ${e.top.width}px ${e.top.style} ${e.top.color};`,`border-right: ${e.right.width}px ${e.right.style} ${e.right.color};`,`border-bottom: ${e.bottom.width}px ${e.bottom.style} ${e.bottom.color};`,`border-left: ${e.left.width}px ${e.left.style} ${e.left.color};}`].join("");n.push(o)}),n.join("")},selectedCol:(t,e)=>{const o=t.selectedColId;if(!o)return null;const n=o.replace(/^col-([\w-]+)-\d{1,2}$/,"$1"),i=e.rowDataMap[n];if(!i){for(let t of e.allCol)if(t.id===o)return t;return null}for(let s of i.row.cols)if(s.id==o)return s;return null}},mutations:{setSelectedCol(t,e){t.selectedColId=e.id},setColProps(t,e){void 0===e.shuttle&&(e.shuttle=!0);const o=e.prop,n=e.value,i=e.col;Object(Ot["k"])(i,o,n)},addAccItem(t,e){const o=e.item,n=e.parentRow;n.cols.push(o)},removeCol(t,e){const o=e.col,n=e.parentRow,i=e.colIndex;if(!n.cols||1==n.cols.length)return;const s=n.cols[i-1];if(s)s.style.width+=o.style.width;else{const t=n.cols[i+1];t&&(t.style.width+=o.style.width)}n.cols.splice(i,1)},splitCol(t,e){const o=e.col,n=e.colIndex,i=e.count,s=e.parentRow,r=e.direction,l=void 0===r?"right":r;if(!s)return e.shuttle=!1,void console.error("未指定所在行！！");const a=o.style.width,c=a/i>>0;o.style.width=a-c*(i-1);const d=[],u=i-1;let h=0;while(h++<u){const t=Object(Ot["d"])(o);m(s,t),t.style.width=c,t.style.border=Object(Ot["d"])(o.style.border),t.controls=[],d.push(t)}const p="left"==l?n:n+1;function m(t,e){const o=t.id,n=Ot["b"].getIndex(o);e.id=`col-${o}-${n}`,e.name="col-"+n}s.cols.splice(p,0,...d)},intertRowsInCol(t,e){const o=e.rowDataArr,n=e.col;n.subs=o},replaceSingleColToRows(t,e){const o=e.rowIndex,n=e.rowDataArr,i=e.parentRowPath;let s;s=i&&i[0]?i[0]:t.design,s.splice(o,1,...n)},updateColAllBorder(t,e){const o=e.directions,n=e.prop,i=e.value;o.forEach(t=>{t&&(t[n]=i)})},setColBorder(t,e){const o=e.border,n=e.selectedCol;JSON.stringify(e),n.style.border=Object(Ot["d"])(o)},setColStyle(t,e){JSON.stringify(e);const o=e.prop,n=e.value,i=e.selectedCol;i.style[o]=n},setAllColBorderWidth(t,e){const o=e.cols,n=e.borderWidth;Kc(o,n)},setAllColBorder_inner(t,e){const o=e.cols,n=e.borderWidth;Kc(o,n),Qc(t.design[0],0),Zc(t.design[t.design.length-1],0),td(t.design,0),ed(t.design,0)},setAllColBorder_hline(t,e){const o=e.cols,n=e.borderWidth;o.forEach(t=>{t.style.border.left.width=0,t.style.border.right.width=0,t.style.border.top.width=n,t.style.border.bottom.width=n})},setAllColBorder_vline(t,e){const o=e.cols,n=e.borderWidth;o.forEach(t=>{t.style.border.left.width=n,t.style.border.right.width=n,t.style.border.top.width=0,t.style.border.bottom.width=0})},setAllColBorder_outer(t,e){const o=e.cols,n=e.borderWidth;Kc(o,0),Qc(t.design[0],n),Zc(t.design[t.design.length-1],n),td(t.design,n),ed(t.design,n)},setAllColBorder_left(t,e){const o=e.cols,n=e.borderWidth;Kc(o,0),td(t.design,n)},setAllColBorder_top(t,e){const o=e.cols,n=e.borderWidth;Kc(o,0),Qc(t.design[0],n)},setAllColBorder_right(t,e){const o=e.cols,n=e.borderWidth;Kc(o,0),ed(t.design,n)},setAllColBorder_bottom(t,e){const o=e.cols,n=e.borderWidth;Kc(o,0);const i=t.design.length;if(i){const e=t.design[i-1];Zc(e,n)}},updateColWidth(t,e){const o=e.col,n=e.width,i=e.nextCol,s=n-o.style.width;function r(t,e,o){t.subs.forEach(t=>{const n=t.cols;if(!n||!n.length)return;const i=n["right"==o?0:n.length-1];i.style.width+=e,r(i,e,o)})}i&&i.style&&(i.style.width-=s,i.subs&&r(i,-s,"right")),o.style.width=n,o.subs&&r(o,s,"left")},updateRowColWidth(t,e){const o=e.row,n=e.ratio;function i(t){t.cols.forEach(t=>{t.style.width*=n,t.subs&&t.subs.length&&t.subs.forEach(i)})}i(o)},updateColBorder(t,e){const o=e.prop,n=e.value,i=e.targetBorderConfig;i&&(i[o]=n)}},actions:{setSelectedCol(t,e){t.commit("setSelectedCol",e),t.commit("updateSelectedLayout",{id:"",shuttle:!1}),t.commit("clearSelectedControl")},removeCol(t,e){const o=e.col;o.id==t.state.selectedColId&&t.commit("setSelectedCol",{id:"",shuttle:!1}),t.commit("removeCol",e)},setColAllBorder(t,e){const o=e.prop,n=e.value,i=t.getters.selectedCol,s=i.style.border.right,r=i.style.border.bottom;let l,a;const c=t.state.selectedColId.match(/col-(\w+)-\d/);if(!c)return console.error("单元格不存在！！！");const d=c[1];if(!d)return console.error("无法匹配目标行");const u=t.getters.rowDataMap[d].row,h=t.getters.rowDataMap[d].index,p=u.cols.indexOf(i);if(-1===p)return console.error("单元格不存在！！！");if(l=0===p?i.style.border.left:u.cols[p-1].style.border.right,0==h)a=i.style.border.top;else{let e;const o=t.getters.subRowPathMap[d];e=o&&o.length?o[0].cols[h-1]:t.state.design[h-1],a=e.cols[p]?e.cols[p].style.border.bottom:null}t.commit("updateColAllBorder",{directions:[a,s,r,l],prop:o,value:n,shuttle:!0})},setColBorderDetail(t,e){const o=e.dir,n=e.prop,i=e.value,s=e.selectedCol;if(!s)return;if(t.commit("updateColBorder",{prop:n,value:i,targetBorderConfig:s.style.border[o],group:e.group}),"right"==o||"bottom"==o)return;let r,l;const a=s,c=t.state.selectedColId.match(/col-(\w+)-\d/);if(!c)return console.error("单元格不存在！！！");const d=c[1];if(!d)return console.error("无法匹配目标行");const u=t.getters.rowDataMap[d].row,h=t.getters.rowDataMap[d].index,p=u.cols.indexOf(a);if(-1===p)return console.error("单元格不存在！！！");if("left"==o)return r=0===p?a.style.border.left:u.cols[p-1].style.border.right,void(r&&t.commit("updateColBorder",{prop:n,value:i,targetBorderConfig:r,group:e.group}));if("top"!=o);else{if(0==h)l=a.style.border.top;else{let e,o;const n=t.getters.subRowPathMap[d];n&&n.length?(n[0].cols.forEach(t=>{e||t.subs&&t.subs[h]===u&&(e=t)}),o=e?e.subs[h-1]:null):o=t.state.design[h-1],l=o&&o.cols[p]?o.cols[p].style.border.bottom:null}l&&t.commit("updateColBorder",{prop:n,value:i,targetBorderConfig:l,group:e.group})}},insertMultiRowCol(t,e){const o=e.col,n=e.parentRow,i=e.parentRowIndex,s=e.rowCount,r=e.colCount,l=new Array(s).fill(1).map(()=>od(r,o.style.width,t.state.globalStyle)),a="insertMultiRowCol"+ +new Date,c=n.height,d=t.state.globalStyle.cellHeight*s;d>c?t.commit({type:"updateRowHeight",row:n,height:d,group:a}):l[s-1].height+=c-d,1!==n.cols.length?t.commit({type:"intertRowsInCol",group:a,col:o,rowDataArr:l}):t.commit({type:"replaceSingleColToRows",group:a,parentRowPath:t.getters.subRowPathMap[n.id],row:n,rowIndex:i,rowDataArr:l})}}});function Kc(t,e){t.forEach(t=>{t.style.border.top.width=e,t.style.border.right.width=e,t.style.border.bottom.width=e,t.style.border.left.width=e})}function Qc(t,e){t&&t.cols.forEach(t=>{t.style.border.top.width=e;const o=t.subs[0];Qc(o)})}function Zc(t,e){t&&t.cols.forEach(t=>{t.style.border.bottom.width=e;const o=t.subs.length;o&&Zc(t.subs[o-1],e)})}function td(t,e){Array.isArray(t)&&t.length&&t.forEach(t=>{const o=t.cols[0];o&&(o.style.border.left.width=e,td(o.subs,e))})}function ed(t,e){Array.isArray(t)&&t.length&&t.forEach(t=>{const o=t.cols[t.cols.length-1];o&&(o.style.border.right.width=e,ed(o.subs,e))})}function od(t,e,o){const n=Object(Ot["l"])(),i={id:n,type:"row-layout",name:"行",autoIndex:Ot["j"].getIndex("row"),namePrefix:"行",height:o.cellHeight,cols:[]},s=e/t;let r,l=0;while(l++<t)r=Ot["b"].getIndex(n),i.cols.push({id:`col-${n}-${r}`,name:"col-"+r,type:"col-item",style:{verticalAlign:o.verticalAlign,textAlign:o.textAlign,width:s,border:Object(Ot["d"])(o.border)},subs:[],controls:[]});return i}var nd={getters:{controlType2nameMap:t=>{const e=window.FORM_DESIGN_CONFIG.controlList,o=t.extControls,n={};return e.concat(o).forEach(t=>{n[t.type]=t.name}),n},fieldMap:t=>{const e={},o=t.newFieldList;function n(t,o){e[(t.id||"")+";"+(o.field||"")]=o;const n=`#${t.sqltablename||""};#${o.fieldname||""}`;e[n]=o}return t.fieldList.forEach((t,e)=>{0==e&&o.forEach(e=>{n(t,e)}),t.fields.forEach(e=>{n(t,e)})}),e},codeListMap:t=>{let e=t.codeList;const o={};return e.forEach(t=>{o[t.id]=t}),o},selectedFieldMap:(t,e)=>{let o=e.allControls;if(!o.length)return{};const n={};return o.forEach(t=>{t.bind&&(n[t.bind]=!0)}),n},allControls:(t,e)=>{let o=e.allCol;if(!o||!o.length)return[];const n=[];return o.forEach(t=>{t.controls&&t.controls.length&&n.push(...t.controls)}),n},controlNameMap:(t,e)=>{let o=t.hiddenControls,n=e.allControls;const i={};return o.forEach(t=>{i[t.id]=t.name||`${t.namePrefix}${t.autoIndex}`}),n.forEach(t=>{i[t.id]=t.name||`${t.namePrefix}${t.autoIndex}`}),i},controlDataMap:(t,e)=>{let o=t.hiddenControls,n=e.allCol;const i={};return o.forEach((t,e)=>{i[t.id]={control:t,index:e}}),n.forEach(t=>{t.controls&&t.controls.length&&t.controls.forEach((function(t,e){i[t.id]={control:t,index:e}}))}),i},selectedControl:(t,e)=>{let o=t.selectedControlId,n=e.controlDataMap;if(!o)return{control:null,index:-1};const i=n[o];return i&&i.control?i:{control:null,index:-1}},selectedControlParentCol:(t,e)=>{let o=t.selectedControlId,n=t.hiddenControls,i=e.allCol;for(let s of i)if(s.controls)for(let t of s.controls)if(t.id==o)return s;for(let s of n)if(s.id==o)return{controls:n};return null},selectedControlParentColInfo:(t,e)=>{let o=e.selectedControlParentCol,n=e.rowDataMap;const i={row:null,index:-1};if(!o)return i;const s=o.id,r=s.replace(/^col-(\w+)-\d{1,2}$/,"$1"),l=n[r];return l?{row:l.row,index:l.row.cols.indexOf(o)}:i}},mutations:{setHiddenControls(t,e){t.hiddenControls=e},setSourceTables(t,e){t.sourceTables=e},setDataTables(t,e){t.dataTables=e},setFieldList(t,e){t.fieldList=e},setCodeList(t,e){t.codeList=e},setMacroTypes(t,e){t.macroTypes=e},setExtControls(t,e){t.extControls=e},setCommonControls(t,e){t.commonControls=e},setButtonEditPopupList(t,e){t.buttonEditPopupList=e},removeControl(t,e){const o=e.selectedControl,n=e.selectedControlParentCol,i=e.selectedControlIndex;if(!o||!n||-1===i)return console.error("删除控件出错！！！");n.controls.splice(i,1)},removeHiddenControl(t,e){const o=e.index;t.hiddenControls.splice(o,1)},addControl(t,e){const o=e.parentCol,n=e.control;o.controls.push(n)},setSelectedControl(t,e){t.selectedControlId=e.id},clearSelectedControl(t){t.selectedControlId=""},updateControlProp(t,e){JSON.stringify(e);const o=e.control;o?/\./.test(e.prop)?(e.prop,Object(Ot["g"])(o,e.prop),Object(Ot["k"])(o,e.prop,e.value),Object(Ot["g"])(o,e.prop)):o[e.prop]=e.value:console.error("无选中控件")},addMultiFormProps(t,e){let o=e.controlData;o&&(o.multiFormAccId="",o.multiFormColumnId="",o.multiFormIndex=0)},addTooltipConfig(t,e){let o=e.controlData;o&&(o.tooltipConfig={type:"tooltip",content:""})},updateControlStyle(t,e){const o=e.controls,n=e.skinData;if(!o)return;const i=Array.isArray(o)?o:[o],s=["fontSize","fontFamily","fontColor","fontBolder","fontItalic","fontUnderline","textAlign","verticalAlign"];i.forEach(t=>{s.forEach(e=>{n[e]&&(t[e]=n[e])})})}},actions:{deleteControl(t,e){if(e){const o=e.selectedControl,n=e.selectedControlParentCol,i=e.selectedControlIndex;t.commit("removeControl",{selectedControl:o,selectedControlParentCol:n,selectedControlIndex:i,shuttle:!0})}else{const e=t.getters.selectedControl,o=e.control,n=e.index;if(!o||-1===n)return console.error("出现错误，无法删除！");if("hiddenfield"===o.type)return t.commit("clearSelectedControl"),void t.commit("removeHiddenControl",{index:n,shuttle:!0});let i=t.getters.selectedControlParentCol;if(!i)return console.error("出现错误，无法删除！");t.commit("clearSelectedControl"),t.commit("removeControl",{selectedControl:o,selectedControlParentCol:i,selectedControlIndex:n,shuttle:!0})}},setSelectedControl(t,e){t.commit("setSelectedControl",e),t.commit("setSelectedCol",{id:""}),t.commit("updateSelectedLayout",{id:""})},autoAddLabel(t,e){const o=e.parentCol,n=ud(e.controlData.name||"",t.state.globalStyle,e.controlData);t.commit("addControl",{parentCol:o,control:n})},bindFieldToControl(t,e){const o=e.fieldMaps,n=e.controls,i=e.newFieldList;t.commit({type:"submitNewFieldList",newFieldList:i});const s=t.state.fieldList[0].sqltablename;function r(t){return`#${s};#${t.fieldname||""}`}const l="bindFieldToControl";n.forEach(e=>{const n=o[e.id];let i,s;if(Array.isArray(n)?(i=n[0],s=n[1]):i=n,i&&i.fieldname){e.id!=t.state.selectedControlId&&t.commit({type:"setSelectedControl",id:e.id});const o=r(i);t.dispatch({type:"setControlProp",prop:"bind",value:o,group:l,control:e}),s&&t.dispatch({type:"setControlProp",prop:"bind2",value:r(s),group:l,control:e})}})},setControlProp(t,e){const o=e.prop,n=e.value,i=e.control,s=e.group||"updateCtrProp-"+ +new Date;if(t.commit({control:i,type:"updateControlProp",prop:o,value:n,shuttle:!0,group:s}),"bind"==o){const e=t.getters.fieldMap[n];if(e&&e.datasource&&(t.commit({control:i,type:"updateControlProp",prop:"data",value:"",shuttle:!1}),t.commit({control:i,type:"updateControlProp",prop:"codeItem",value:e.datasource,shuttle:!1})),i&&n&&void 0!==!i.emptyText)try{t.commit({control:i,type:"updateControlProp",prop:"emptyText",value:"请输入"+t.getters.fieldMap[n].name,shuttle:!1})}catch(r){console.error("自动设置 emptyText",r)}if(i.id!=t.state.selectedControlId)return;dd(t,i),ld(t,t.getters.fieldMap[i.bind].name),rd(t,n,i),sd(t,n,i)}i.id==t.state.selectedControlId&&("uniqueValidate"==o&&!0===n&&(t.commit({control:i,type:"updateControlProp",prop:"required",value:!0,shuttle:!0,group:s}),ad(t,!0)),"required"==o&&ad(t,n),"sourceTable"==o&&id(t,i),"name"!=o||!n||"label"==i.type&&"title"==i.type||ld(t,n,!1))},dealSubmitControl(t){hd(t)}}};function id(t,e){e&&"subtable"==e.type&&t.commit({control:e,type:"updateControlProp",prop:"columns",value:[],shuttle:!1})}function sd(t,e,o){const n=t.getters.fieldMap[e];if(!n.fieldtype)return;let i;switch(n.fieldtype){case 1:i="float";break;case 2:i="int";break;default:break}i&&t.commit({control:o,type:"updateControlProp",prop:"vtype",value:i,shuttle:!1})}function rd(t,e,o){const n=t.getters.fieldMap[e];n.required&&o&&"required"in o&&(t.commit({control:o,type:"updateControlProp",prop:"required",value:!0,shuttle:!1}),ad(t,!0))}function ld(t,e,o){const n=cd(t);n&&(o||"控件label"==n.labelText)&&t.commit("updateControlProp",{control:n,prop:"labelText",value:e,shuttle:!1})}function ad(t,e){const o=cd(t);o&&t.commit("updateControlProp",{control:o,prop:"showStar",value:e,shuttle:!1})}function cd(t){const e=t.getters.selectedControlParentColInfo,o=e.row,n=e.index;if(!o||-1===n)return;const i=o.cols[n-1];if(i&&i.controls.length){for(let t of i.controls)if("label"==t.type)return t;return null}}function dd(t,e){const o=t.getters.selectedControlParentColInfo,n=o.row,i=o.index;if(!e||!n)return;const s=n.cols[i-1];if(!s||s.controls.length||s.subs.length)return;const r=ud(t.getters.fieldMap[e.bind].name,t.state.globalStyle);t.commit("addControl",{parentCol:s,control:r,shuttle:!1})}function ud(t,e,o){const n=Object(Ot["d"])(window.FORM_DESIGN_CONFIG.controls.label),i=Ot["c"].getIndex("label");n.id="label-"+Object(Ot["l"])(),n.namePrefix="label",n.autoIndex=i,n.name="",n.width="100%",t&&(n.labelText=t),o&&void 0!==o.required&&(n.showStar=o.required),delete n.configItems;const s=e.fontSize,r=e.fontFamily,l=e.fontColor,a=e.fontBolder,c=e.fontItalic,d=e.fontUnderline;return n.fontSize=s,n.fontFamily=r,n.fontColor=l,n.fontBolder=a,n.fontItalic=c,n.fontUnderline=d,n}function hd(t){const e=t.getters.allControls,o=e.filter(t=>"combobox"==t.type);if(!o.length)return;const n=new Map,i=new Map;o.forEach(t=>{n.set(t.id,t),t.events&&t.events["valuechanged:getcodelist"]&&t.events["valuechanged:getcodelist"].length&&i.set(t.id,t)}),pd(i,n,t,{})}function pd(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=!1,s=!1;t.forEach(t=>{if(t.codeItem){const s=t.events["valuechanged:getcodelist"].reduce((t,e)=>{const o=e.actions.filter(t=>"setData"==t.type)[0];return o&&t.push(...o.targets),t},[]);s.forEach(s=>{const r=s.id;n[r]||(o.commit({control:e.get(r),type:"updateControlProp",prop:"codeItem",value:t.codeItem,shuttle:!1}),o.commit({control:e.get(r),type:"updateControlProp",prop:"codeSyncPid",value:t.id,shuttle:!1}),n[r]=!0,i=!0)})}else s=!0}),s&&i&&pd(t,e,o,n)}var md={getters:{inControlDragging(t){return t.helper.inControlDragging},inLayoutDragging(t){return t.helper.inLayoutDragging}},mutations:{updateLineTop(t,e){t.helper.top=e},updateLineLeft(t,e){t.helper.left=e},showHLine(t){t.helper.showHLine=!0},hideHLine(t){t.helper.showHLine=!1},showVLine(t){t.helper.showVLine=!0},hideVLine(t){t.helper.showVLine=!1},layoutDragStart(t){t.helper.inLayoutDragging=!0},layoutDragEnd(t){t.helper.inLayoutDragging=!1},controlDragStart(t){t.helper.inControlDragging=!0},controlDragEnd(t){t.helper.inControlDragging=!1},updateViewType(t,e){/^(pc|mobile)$/.test(e)?t.helper.viewType=e:console.error("unsupport viewType")},toggleViewDesign(t){t.helper.viewDesign=!t.helper.viewDesign},setShowPreview(t,e){t.helper.showPreview=e.showPreview}},actions:{}};function fd(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function gd(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?fd(Object(o),!0).forEach((function(e){Object(it["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):fd(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}Z["default"].use(Dt["a"]);var bd=new Dt["a"].Store({strict:!1,state:{formSize:{width:900,height:0},design:[],mobileDesignData:[],hiddenControls:[],skin:"",globalStyle:{autoColons:!0,fontSize:13,fontFamily:"Microsoft Yahei",fontColor:"#333333",fontBolder:!1,fontItalic:!1,fontUnderline:!1,textAlign:"left",verticalAlign:"middle",cellHeight:48,border:{top:{width:1,style:"solid",color:"#ddd"},right:{width:1,style:"solid",color:"#ddd"},bottom:{width:1,style:"solid",color:"#ddd"},left:{width:1,style:"solid",color:"#ddd"}},allBorderType:"all"},helper:{showVLine:!1,showHLine:!1,left:0,top:0,inControlDragging:!1,inLayoutDragging:!1,viewDesign:!1,viewType:"pc",showPreview:!1},jsCode:"",cssCode:"",fieldList:[],codeList:[],macroTypes:[],sourceTables:[],dataTables:[],DBDataTypes:[],newFieldList:[],buttonEditPopupList:[],extControls:[],commonControls:[],leftActiveTab:"layout",rightActiveTab:"form",selectedControlId:"",selectedColId:"",selectedRowId:""},getters:gd(gd(gd(gd(gd({},Yc.getters),Xc.getters),nd.getters),md.getters),{},{globalStyleText:t=>{const e=t.globalStyle,o=e.fontSize,n=e.fontFamily,i=e.fontColor,s=e.fontBolder,r=e.fontItalic,l=e.fontUnderline,a=e.textAlign,c=e.verticalAlign;return`\n        font-size: ${o}px;\n        font-family: ${n};\n        color: ${i};\n        font-weight: ${s?"bold":"normal"};\n        font-style: ${r?"italic":"normal"};\n        text-decoration: ${l?"underline":"none"};\n        text-align: ${a};\n        vertical-align: ${c};\n      `}}),mutations:gd(gd(gd(gd(gd({},Yc.mutations),Xc.mutations),nd.mutations),md.mutations),{},{setSkin(t,e){const o=e.skinName;t.skin=o},setJsCode(t,e){t.jsCode=e},setCssCode(t,e){t.cssCode=e},setDBDataTypes(t,e){Array.isArray(e)?t.DBDataTypes=e:console.error("设置创建新字段时可选的数据库类型时出错",e)},addToNewFieldList(t,e){t.newFieldList.push(e.fieldProps)},submitNewFieldList(t,e){const o=e&&e.newFieldList?e.newFieldList:t.newFieldList,n=t.fieldList[0]&&t.fieldList[0].fields;o.length&&Array.isArray(n)&&(n.push(...o),t.newFieldList.length&&(t.newFieldList=[]))},updateGlobalStyleProp(t,e){JSON.stringify(e),t.globalStyle[e.prop]=e.value},updateGlobalBorder(t,e){JSON.stringify(e),t.globalStyle.border.top[e.prop]=e.value,t.globalStyle.border.right[e.prop]=e.value,t.globalStyle.border.bottom[e.prop]=e.value,t.globalStyle.border.left[e.prop]=e.value},updateGlobalStyle(t,e){const o=e.style;t.globalStyle=Pn()({},t.globalStyle,o)},applyGlobalStyle(t,e){const o=e.cols,n=e.prop,i=e.value;o.forEach(t=>{t.style[n]=i,t.controls&&t.controls.length&&-1!==["fontSize","fontFamily","fontColor","fontBolder","fontItalic","fontUnderline"].indexOf(n)&&t.controls.filter(t=>"label"==t.type||"title"==t.type).forEach(t=>{t[n]=i})})},applyGlobalBorder(t,e){const o=e.cols,n=e.prop,i=e.value;o.forEach(t=>{t.style.border.top[n]=i,t.style.border.right[n]=i,t.style.border.bottom[n]=i,t.style.border.left[n]=i})},activeLeftTab(t,e){t.leftActiveTab=e},activeRightTab(t,e){t.rightActiveTab=e},updateDesign(t,e){t.design=e,t.design},tryMergeAcc(t,e){const o=e.row,n=e.rowIndex;if(!o||void 0===n)return;if(1==t.design.length)return;const i=t.design[n-1],s=t.design[n+1],r=i&&"acc-layout"==i.type,l=s&&"acc-layout"==s.type;let a,c;if(r)return a=Object(Ot["d"])(i),c=a.id,o.cols.forEach(t=>{a.cols.push(d(t,c))}),void t.design.splice(n-1,2,a);if(l)return a=Object(Ot["d"])(o),c=a.id,s.cols.forEach(t=>{a.cols.push(d(t,c))}),void t.design.splice(n,2,a);function d(t,e){const o=Ot["b"].getIndex(e),n=Object(Ot["d"])(t);return n.id=`col-${e}-${o}`,n}},replaceMobileDesign(t,e){t.mobileDesignData=e.mobileDesignData},controlCompatible(t,e){let o=e.controls;Array.isArray(o)&&o.forEach(t=>{let e=t.customValidate;e&&void 0!==e.regExp&&(e.regSource=e.regExp,delete e.regExp)})}}),actions:gd(gd(gd(gd(gd({},Yc.actions),Xc.actions),nd.actions),md.actions),{},{activeRightTab(t,e){let o=t.state,n=t.commit;o.rightActiveTab!=e&&n("activeRightTab",e)},setGlobalStyle(t,e){t.commit("updateGlobalStyleProp",e),t.commit("applyGlobalStyle",gd(gd({cols:t.getters.allCol},e),{},{shuttle:!0}))},setGlobalBorder(t,e){t.commit("updateGlobalBorder",e),t.commit("applyGlobalBorder",gd(gd({cols:t.getters.allCol},e),{},{shuttle:!0}))},setAllBorderType(t,e){const o=e.type,n=e.borderWidth,i="bordertype-"+ +new Date;t.commit("updateGlobalStyleProp",{prop:"allBorderType",value:o,group:i,shuttle:!0}),yd(t,o,n,i)},applySkin(t,e){const o=e.skin,n=e.skinData;t.commit({type:"setSkin",skinName:o,group:"skin",shuttle:!0}),t.commit({type:"updateGlobalStyle",style:n,group:"skin",shuttle:!0});const i=t.getters.allControls.filter(t=>-1!=["title","label","output"].indexOf(t.type));i.length&&t.commit({type:"updateControlStyle",controls:i,group:"skin",skinData:n,shuttle:!0})}})});function yd(t,e,o,n){const i=t.getters.allCol;return"all"==e?t.commit("setAllColBorderWidth",{cols:i,group:n,borderWidth:o}):"none"==e?t.commit("setAllColBorderWidth",{cols:i,group:n,borderWidth:0}):void t.commit("setAllColBorder_"+e,{cols:i,group:n,borderWidth:o})}var vd=o("adb5"),Cd=o("2fdd");o("8e1f"),o("64d2");window.jsoncParse=Cd["a"],Q.a.props.model=[Object,Array];const wd=Z["default"].extend({extends:X.a,mounted:function(){this.$el&&!this.$el.title&&this.label&&this.label.length>10&&this.$el.setAttribute("title",this.label)}});Z["default"].prototype.$ELEMENT={size:"small"},Z["default"].prototype.$bus=new Z["default"],Z["default"].prototype.$httpGet=vd["a"],Z["default"].prototype.$httpPost=vd["b"],Z["default"].prototype.$message=J.a,Z["default"].prototype.$confirm=W.a.confirm,Z["default"].prototype.$prompt=W.a.prompt,Z["default"].prototype.$msgbox=W.a,Z["default"].config.productionTip=!1,Z["default"].component("draggable",Vr.a),Z["default"].component(G.a.name,G.a),Z["default"].component(z.a.name,z.a),Z["default"].component(V.a.name,V.a),Z["default"].component(R.a.name,R.a),Z["default"].component(M.a.name,M.a),Z["default"].component(L.a.name,L.a),Z["default"].component(P.a.name,P.a),Z["default"].component(X.a.name,wd),Z["default"].component($.a.name,$.a),Z["default"].component(T.a.name,T.a),Z["default"].component(k.a.name,k.a),Z["default"].component(O.a.name,O.a),Z["default"].component(Q.a.name,Q.a),Z["default"].component(x.a.name,x.a),Z["default"].component(C.a.name,C.a),Z["default"].component(J.a.name,J.a),Z["default"].component(y.a.name,y.a),Z["default"].component(g.a.name,g.a),Z["default"].component(m.a.name,m.a),Z["default"].component(h.a.name,h.a),Z["default"].component(d.a.name,d.a),Z["default"].component(a.a.name,a.a),Z["default"].component(r.a.name,r.a),Z["default"].component(i.a.name,i.a),Z["default"].component("LayoutGender",Xa),Z["default"].use(Jc.a),"object"!=typeof window.FORM_DESIGNER&&(window.FORM_DESIGNER={}),window.FORM_DESIGNER.app=new Z["default"]({store:bd,render:t=>t(Wc)}).$mount("#app"),window.FORM_DESIGNER_ANALYSIS={mobileDesignEntered:!1,mobileDesignMoved:!1,mobileDesignAdd:!1},Object.defineProperty(window.FORM_DESIGNER_ANALYSIS,"reset",{enumerable:!1,value:function(){this.mobileDesignEntered=!1,this.mobileDesignMoved=!1,this.mobileDesignAdd=!1}})},"58d3":function(t,e,o){"use strict";o("d87d")},5908:function(t,e,o){"use strict";o("31ec")},"592a":function(t,e,o){},"5bdd":function(t,e,o){},"64a9":function(t,e,o){},6758:function(t,e,o){"use strict";o("5389")},"6da2":function(t,e,o){"use strict";o("ff06")},"6f10":function(t,e,o){"use strict";o("739e")},"739e":function(t,e,o){},"76fd":function(t,e,o){"use strict";o("472d")},"7b52":function(t,e,o){"use strict";o("a481");e["a"]={methods:{lineFeed(t){return t&&t+""===t?t.replace(/\\n/g,"<br>").replace(/ /g,"&nbsp;"):""}}}},"7d5a":function(t,e,o){},"7e28":function(t,e,o){},"81ec":function(t,e,o){},"89c5":function(t,e,o){},"8e1f":function(t,e,o){},"8e39":function(t,e,o){},"8feb":function(t,e,o){},9827:function(t,e,o){"use strict";o.d(e,"d",(function(){return l})),o.d(e,"b",(function(){return a})),o.d(e,"a",(function(){return c}));o("ac6a");class n{constructor(){this.store={}}_get(t){if(!t)throw new Error("type is required!");return this.store[t]?++this.store[t]:this.store[t]=1}adaptProp(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.store[t]?this.store[t]+=e:this.store[t]=e}}class i extends n{constructor(){super()}getIndex(t){return this._get("control-"+t)}adapt(t){if(Array.isArray(t)){const e={};t.forEach(t=>{const o=t.type,n=t.autoIndex||this.getIndex(o);e[o]?e[o]=Math.max(n,e[o]):e[o]=n});for(let t in e)this.adaptProp("control-"+t,e[t])}}}class s extends n{constructor(){super()}getIndex(t){return this._get("col-"+t)}adapt(t){Array.isArray(t)&&t.forEach(t=>{t.cols.forEach(e=>{this.adaptProp("col-"+t.id),e.subs&&e.subs.length&&this.adapt(e.subs)})})}}class r extends n{constructor(){super()}getIndex(t){return this._get("row-"+t)}adapt(t){if(Array.isArray(t)){const e={};t.forEach(t=>{const o=t.namePrefix||t.name||"行",n=t.autoIndex||this.getIndex(o);e[o]?e[o]=Math.max(n,e[o]):e[o]=n});for(let t in e)this.adaptProp("control-"+t,e[t])}}}const l=new r,a=new i,c=new s;window.rowAutoIndex=l,window.controlAutoIndex=a,window.colAutoIndex=c,e["c"]={row:l,control:a,col:c}},9836:function(t,e,o){},"9cb4":function(t,e,o){},"9e0a":function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("h1",{staticClass:"title",class:t.asControl?"design-form-title ":"design-control-holder",style:t.styleText,attrs:{title:t.controlData.textContent||""},domProps:{innerHTML:t._s(t.contentHtml)}})},i=[],s=o("7b52"),r={name:"placeholder-title",props:{controlData:{type:Object,default:()=>({})},asControl:{type:Boolean,default:!1}},mixins:[s["a"]],computed:{styleText(){const t=this.controlData,e=t.fontSize,o=t.fontFamily,n=t.fontColor,i=t.fontBolder,s=t.fontItalic,r=t.fontUnderline,l=t.textAlign,a=t.verticalAlign,c=[];return c.push(`font-size:${e}px`),c.push("font-family:"+o),c.push("color:"+n),c.push("font-weight:"+(i?"bold":"normal")),c.push("font-style:"+(s?"italic":"normal")),c.push("text-decoration:"+(r?"underline":"none")),c.push("text-align:"+l),c.push("vertical-align:"+a),c.join(";")},contentHtml(){const t=this.controlData.textContent||this.controlData.name;return this.lineFeed(t)}},data(){return{}}},l=r,a=o("2877"),c=Object(a["a"])(l,n,i,!1,null,null,null);e["a"]=c.exports},a3de:function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"design-control",class:t.extCls,style:"width:"+t.controlWidth,attrs:{"data-id":t.controlData.id}},[t._t("default"),o(t.getControlComponent(t.controlData.type),{tag:"component",attrs:{"control-data":t.controlData}}),o("span",{directives:[{name:"show",rawName:"v-show",value:t.controlData.icon,expression:"controlData.icon"}],staticClass:"design-control-icon",class:t.controlIconMap[t.controlData.type]}),o("span",{staticClass:"design-control-remove",on:{click:function(e){return e.stopPropagation(),t.removeControl(e)}}}),o("ToolTip",{attrs:{"control-data":t.controlData}})],2)},i=[],s=(o("ac6a"),o("d718")),r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("input",{staticClass:"design-control-holder textbox",attrs:{type:"text",placeholder:t.controlData.emptyText||t.name,readonly:""},domProps:{value:t.controlData.value}})},l=[],a={name:"placeholder-textbox",props:["controlData"],computed:{name(){const t=this.controlData,e=t.name,o=t.namePrefix,n=t.autoIndex;return e||(o&&n?`${o}_${n}`:"")}}},c=a,d=o("2877"),u=Object(d["a"])(c,r,l,!1,null,null,null),h=u.exports,p=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"design-control-holder ewebeditor",style:{height:(t.controlData.height||260)+"px"}},[t._v(t._s(t.controlData.emptyText||t.name))])},m=[],f={name:"placeholder-ewebeditor",props:["controlData"],computed:{name(){const t=this.controlData,e=t.name,o=t.namePrefix,n=t.autoIndex;return e||(o&&n?`${o}_${n}`:"")}}},g=f,b=Object(d["a"])(g,p,m,!1,null,null,null),y=b.exports,v=o("9e0a"),C=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("textarea",{staticClass:"design-control-holder textbox",staticStyle:{resize:"none"},style:"height:"+(t.controlData.height||26)+"px",attrs:{type:"text",placeholder:t.controlData.emptyText||t.controlData.name,readonly:""},domProps:{value:t.controlData.value}})},w=[],x={name:"placeholder-textarea",props:["controlData"]},D=x,O=Object(d["a"])(D,C,w,!1,null,null,null),_=O.exports,k=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("span",{staticClass:"design-control-holder checkboxlist",class:"vertical"==t.controlData.repeatDirection?"vertical":"horizontal"},[o("el-checkbox-group",{model:{value:t.valueList,callback:function(e){t.valueList=e},expression:"valueList"}},t._l(t.dataList,(function(e){return o("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])})),1)],1)},S=[],T=(o("28a5"),o("ab9e")),j={name:"placeholder-checkboxlist",props:["controlData"],mixins:[T["a"]],data(){return{valueList:this.getValueList(),defaultDataList:[1,2,3].map(t=>({id:t,text:"选项-"+t})),originData:[]}},methods:{getValueList(){const t=this.controlData.value||this.controlData.defaultValue;return t&&t.split(",")||[]}},created(){this.getDataList()},watch:{"controlData.value"(){this.valueList=this.getValueList()},"controlData.defaultValue"(){this.valueList=this.getValueList()}}},$=j,I=Object(d["a"])($,k,S,!1,null,null,null),P=I.exports,E=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("span",{staticClass:"design-control-holder radiobuttonlist",class:"vertical"==t.controlData.repeatDirection?"vertical":"horizontal"},[o("el-radio-group",{model:{value:t.currValue,callback:function(e){t.currValue=e},expression:"currValue"}},t._l(t.dataList,(function(e){return o("el-radio",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])})),1)],1)},L=[],A={name:"placeholder-radio-button-list",props:["controlData"],mixins:[T["a"]],data(){return{currValue:this.controlData.value||this.controlData.defaultValue||"",defaultDataList:[1,2,3].map(t=>({id:t,text:"选项-"+t})),originData:[]}},created(){this.getDataList()},watch:{"controlData.value"(){this.valueList=this.controlData.value||this.controlData.defaultValue||""},"controlData.defaultValue"(){this.valueList=this.controlData.value||this.controlData.defaultValue||""}}},M=A,F=Object(d["a"])(M,E,L,!1,null,null,null),R=F.exports,N=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("table",{staticClass:"design-control-holder sub-table"},[o("colgroup",[o("col",{attrs:{for:"checkcolumn",width:"50px"}}),o("col",{attrs:{for:"indexcolumn",width:"50px"}}),t._l(t.columns,(function(t){return o("col",{key:t.field,attrs:{for:"normal",width:t.width+"px"}})})),o("col",{attrs:{for:"actioncolumn",width:"100px"}})],2),o("thead",[o("tr",[t.checkcolumn?o("th",{staticClass:"text-center",class:{frozen:t.checkcolumnFrozen},attrs:{"data-column-type":"checkcolumn"}},[o("span",{staticClass:"checkcolumn-icon"})]):t._e(),t.indexcolumn?o("th",{staticClass:"text-center",class:{frozen:1==t.frozenIndex},attrs:{"data-column-type":"indexcolumn"}},[t._v("序")]):t._e(),t._l(t.columns,(function(e,n){var i;return o("th",{key:e.field,class:(i={},i["text-"+e.align]=!0,i.frozen=t.frozenIndex==n+t.prevColumnCount,i),attrs:{"data-column-type":"normal"}},[t._v(t._s(e.name))])})),t.actioncolumn?o("th",{staticClass:"text-center",attrs:{"data-column-type":"actioncolumn"}},[t._v("操作")]):t._e()],2)]),o("tbody",[o("tr",[t.checkcolumn?o("td",{staticClass:"text-center",class:{frozen:t.checkcolumnFrozen}},[o("span",{staticClass:"checkcolumn-icon"})]):t._e(),t.indexcolumn?o("td",{staticClass:"text-center",class:{frozen:1==t.frozenIndex}},[t._v("1")]):t._e(),t._l(t.columns,(function(e,n){var i;return o("td",{key:e.field,class:(i={},i["text-"+e.align]=!0,i.frozen=t.frozenIndex==n+t.prevColumnCount,i)},[t._v("...")])})),t.actioncolumn?o("td",{staticClass:"text-center"},[t._m(0)]):t._e()],2),o("tr",[t.checkcolumn?o("td",{staticClass:"text-center",class:{frozen:t.checkcolumnFrozen}},[o("span",{staticClass:"checkcolumn-icon"})]):t._e(),t.indexcolumn?o("td",{staticClass:"text-center",class:{frozen:1==t.frozenIndex}},[t._v("2")]):t._e(),t._l(t.columns,(function(e,n){var i;return o("td",{key:e.field,class:(i={},i["text-"+e.align]=!0,i.frozen=t.frozenIndex==n+t.prevColumnCount,i)},[t._v("...")])})),t.actioncolumn?o("td",{staticClass:"text-center"},[t._m(1)]):t._e()],2)])])},V=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("span",[o("i",{staticClass:"action-btn el-icon-plus"}),o("i",{staticClass:"action-btn el-icon-edit"}),o("i",{staticClass:"action-btn el-icon-delete"})])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("span",[o("i",{staticClass:"action-btn el-icon-plus"}),o("i",{staticClass:"action-btn el-icon-edit"}),o("i",{staticClass:"action-btn el-icon-delete"})])}],B={name:"placeholder-sub-table",props:["controlData"],computed:{specificColumns(){return this.controlData?this.controlData.specialColumns.split(","):[]},checkcolumn(){return-1!==this.specificColumns.indexOf("checkcolumn")},checkcolumnFrozen(){return!(!this.checkcolumn||0!=this.frozenIndex)},indexcolumn(){return-1!==this.specificColumns.indexOf("indexcolumn")},indexcolumnForzen(){return this.checkcolumn?1==this.frozenIndex:0==this.frozenIndex},actioncolumn(){return-1!==this.specificColumns.indexOf("actioncolumn")},frozenIndex(){return this.controlData.frozenColumnIndex},prevColumnCount(){return this.checkcolumn&&this.indexcolumn?2:this.checkcolumn||this.indexcolumn?1:(this.checkcolumn||this.indexcolumn,0)},columns(){return this.controlData.columns.length?this.controlData.columns:[{field:"name",name:"姓名",width:100,align:"center",required:!0,vtype:"number"}]}},data(){return{}},methods:{}},z=B,H=Object(d["a"])(z,N,V,!1,null,null,null),G=H.exports,q=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("span",{staticClass:"output",class:{"design-form-output":t.asControl,"design-control-holder":!t.asControl},style:t.styleText},[t._v(t._s(t.controlData.name||t.controlData.namePrefix+"_"+t.controlData.autoIndex))])},W=[],U={name:"placeholder-output",props:{controlData:{type:Object,default:()=>({})},asControl:{type:Boolean,default:!1}},computed:{controlWidth(){const t=this.controlData.width;return t?t+""===t?t:t+"px":""},styleText(){const t=this.controlData,e=t.fontSize,o=t.fontFamily,n=t.fontColor,i=t.fontBolder,s=t.fontItalic,r=t.fontUnderline,l=t.textAlign,a=(t.width,[]);return a.push("display:inline-block"),a.push("-webkit-box-sizing:border-box;box-sizing:border-box;"),a.push(`font-size:${e}px`),a.push("font-family:"+o),a.push("color:"+n),a.push("font-weight:"+(i?"bold":"normal")),a.push("font-style:"+(s?"italic":"normal")),a.push("text-decoration:"+(r?"underline":"none")),a.push("text-align:"+l),this.controlWidth&&a.push("width:"+this.controlWidth),a.join(";")}},data(){return{}}},J=U,Y=Object(d["a"])(J,q,W,!1,null,null,null),X=Y.exports,K=function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.show?o("span",{class:t.cls,attrs:{"data-tooltip":t.tooltip,title:t.tooltip}},[t._v(t._s("tooltip"!==t.config.type?t.config.content:""))]):t._e()},Q=[],Z={name:"control-tooltip",props:["controlData"],computed:{cls(){let t="control-tooltip";return this.config&&this.config.type&&(t+=" tips-"+this.config.type,"tooltip"==this.config.type&&(t+=" el-icon-question")),t},show(){return!!(this.config&&this.config.type&&this.config.content)},tooltip(){return this.config&&"tooltip"===this.config.type?this.config.content:""}},data(){return{config:this.controlData.tooltipConfig}},methods:{doUpdate(){this.config=this.controlData.tooltipConfig}},watch:{controlData:{deep:!0,handler(t){this.doUpdate()}}}},tt=Z,et=(o("a58f"),Object(d["a"])(tt,K,Q,!1,null,null,null)),ot=et.exports;const nt={label:s["a"],textbox:h,ewebeditor:y,title:v["a"],textarea:_,checkboxlist:P,radiobuttonlist:R,subtable:G,output:X},it={props:["controlData"],template:'<span class="design-control-holder" :class="controlData.type">{{controlData.name || (controlData.namePrefix + "_" + controlData.autoIndex)}}</span>'};var st={name:"control",props:{controlData:{type:Object,required:!0}},components:{PlaceholderLabel:s["a"],PlaceholderTextbox:h,PlaceholderTitle:v["a"],PlaceholderTextArea:_,PlaceholderCheckboxList:P,PlaceholderRadioButtonList:R,ToolTip:ot},data(){return{}},computed:{controlIconMap(){const t={};return window.FORM_DESIGN_CONFIG.controlList.concat(this.$store.state.extControls).forEach(e=>{t[e.type]=e.icon}),t},controlWidth(){const t=this.controlData.width;return t?t+""===t?t:t+"px":""},extCls(){const t=this.controlData.tooltipConfig;let e;return e=t&&t.content?"with-tooltip tooltip-"+t.type:"",`${e} ${this.controlData.type}`}},methods:{removeControl(){this.$store.dispatch("deleteControl")},getControlComponent(t){return t in nt?nt[t]:it}}},rt=st,lt=Object(d["a"])(rt,n,i,!1,null,null,null);e["a"]=lt.exports},a58f:function(t,e,o){"use strict";o("ab45")},ab45:function(t,e,o){},ab9e:function(t,e,o){"use strict";e["a"]={computed:{dataList(){const t=this.controlData;return Array.isArray(t.data)?t.data:this.originData&&this.originData.length?this.originData:this.defaultDataList}},methods:{getDataList(){const t=this.controlData;if(Array.isArray(t.data)||!t.codeItem)return this.originData=[];this.$httpPost(window.formDesignerActions.getControlDataListUrl,{controlData:this.controlData}).then(t=>{if(!Array.isArray(t))throw new Error("获取控件数据出错!");this.originData=t}).catch(t=>{this.originData=[],console.error(t)})}},watch:{"controlData.codeItem"(t){t&&this.getDataList()}}}},adb5:function(t,e,o){"use strict";o.d(e,"a",(function(){return s})),o.d(e,"b",(function(){return r}));o("ac6a"),o("6b54"),o("386d");function n(t){return t.custom&&(t=t.custom,"string"==typeof t&&(t=JSON.parse(t))),t}function i(t){const e=new URLSearchParams(location.search),o=e.toString();return o?t+(/\?/.test(t)?"&":"?")+o:t}function s(t,e,o){return new Promise((function(s,r){var l=new XMLHttpRequest;l.onreadystatechange=function(){if(l.readyState===XMLHttpRequest.DONE)if(200===l.status)try{s(e?l.responseText:n(JSON.parse(l.responseText)))}catch(t){console.error(t),s(l.responseText)}else r("There was a problem with the request.")},l.open("GET",i(t)),o&&Object.keys(o).forEach(t=>{l.setRequestHeader(t,o[t])}),l.send()}))}function r(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;return new Promise((function(s,r){var l=new XMLHttpRequest;l.onreadystatechange=function(){if(l.readyState===XMLHttpRequest.DONE)if(200===l.status)try{s(n(JSON.parse(l.responseText)))}catch(t){console.error(t),s(l.responseText)}else r({state:l.status})},l.open("POST",i(t)),l.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8"),o&&Object.keys(o).forEach(t=>{l.setRequestHeader(t,o[t])});const a=new URLSearchParams;for(let t in e)a.append(t,"object"==typeof e[t]?JSON.stringify(e[t]):e[t]);l.send(a)}))}},ae24:function(t,e,o){},aea2:function(t,e,o){},aeeb:function(t,e,o){"use strict";o("529d")},af23:function(t,e,o){},b020:function(t,e,o){"use strict";o("81ec")},b0c7:function(t,e,o){},b2ce:function(t,e,o){"use strict";o("cd52")},b8b5:function(t,e,o){"use strict";o("ae24")},bc50:function(t,e,o){},bc87:function(t,e,o){"use strict";o("279b")},bec5:function(t,e,o){"use strict";o("5bdd")},c0a5:function(t,e,o){"use strict";o("bc50")},c28b:function(t,e,o){},caff:function(t,e,o){"use strict";o("3552")},cd52:function(t,e,o){},ce0a:function(t,e,o){},d3d4:function(t,e,o){},d482:function(t,e,o){"use strict";o("af23")},d56b:function(t,e,o){"use strict";o("d3d4")},d5bd:function(t,e,o){},d5c7:function(t,e,o){"use strict";o("9cb4")},d718:function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("label",{staticClass:"label",class:{"design-form-label":t.asControl,"design-control-holder":!t.asControl,colons:t.autoColons,required:t.controlData.showStar},style:t.styleText,attrs:{title:t.controlData.labelText||""},domProps:{innerHTML:t._s(t.contentHtml)}})},i=[],s=o("7b52"),r={name:"placeholder-label",props:{controlData:{type:Object,default:()=>({})},asControl:{type:Boolean,default:!1}},mixins:[s["a"]],computed:{contentHtml(){const t=this.controlData.labelText||this.controlData.name,e=this.controlData.hideColon;return this.lineFeed(t)+(this.autoColons&&!e?"：":"")},autoColons(){return this.$store.state.globalStyle.autoColons},styleText(){const t=this.controlData,e=t.fontSize,o=t.fontFamily,n=t.fontColor,i=t.fontBolder,s=t.fontItalic,r=t.fontUnderline,l=t.textAlign,a=t.verticalAlign,c=[];return c.push(`font-size:${e}px`),c.push("font-family:"+o),c.push("color:"+n),c.push("font-weight:"+(i?"bold":"normal")),c.push("font-style:"+(s?"italic":"normal")),c.push("text-decoration:"+(r?"underline":"none")),c.push("text-align:"+(l||"")),c.push("vertical-align:"+(a||"")),c.join(";")}},data(){return{}}},l=r,a=o("2877"),c=Object(a["a"])(l,n,i,!1,null,null,null);e["a"]=c.exports},d87d:function(t,e,o){},db49:function(t,e,o){"use strict";o.d(e,"b",(function(){return n})),o.d(e,"a",(function(){return i}));const n=48,i=30},dd1c:function(t,e,o){},e06a:function(t,e,o){"use strict";o("8feb")},e4ac:function(t,e,o){"use strict";o("4277")},eafa:function(t,e,o){"use strict";o.r(e);var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("draggable",{staticClass:"dropArea layout",class:"level-"+t.level,attrs:{group:"layout",swapThreshold:.3,delay:0,list:t.list,move:t.checkLayoutMove,filter:".col-helper-line",preventOnFilter:!1,disabled:!1},on:{change:t.onLayoutChange,start:t.onLayoutDragStart,end:t.onLayoutDragEnd,choose:t.onDragChoose}},t._l(t.list,(function(e,n){return o("Row",{key:e.id,attrs:{level:t.level,row:e,index:n,"parent-col":t.parentCol,"is-last-row":n==t.list.length-1,"prev-row":0==n?null:t.list[n-1]}})})),1)},i=[],s=(o("ac6a"),o("ade3")),r=o("2f62"),l=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"row",class:t.className,style:t.style,attrs:{"row-id":t.row.id,"data-name":t.row.name,"data-level":t.level}},[t._l(t.row.cols,(function(e,n){return o("ColLayout",{key:e.id,attrs:{"is-last-row":t.isLastRow,index:n,col:e,row:t.row,level:t.level,"row-index":t.index},on:{"on-context-menu":function(o){return t.onContextmenu(o,{row:t.row,rowIndex:t.index,parentCol:t.parentCol,col:e,colIndex:n,colDeletable:!!t.row.cols.length})}}})})),o("div",{staticClass:"row-helper"},[o("el-tooltip",{attrs:{placement:"top",enterable:!1,"open-delay":300,content:"移除行"}},[o("span",{staticClass:"row-helper-btn remove el-icon-delete",on:{click:function(e){return e.stopPropagation(),t.handleRowRemove(t.row,t.index)}}})]),o("el-tooltip",{attrs:{placement:"top",enterable:!1,"open-delay":300,content:"复制行"}},[o("span",{staticClass:"row-helper-btn copy el-icon-copy-document",on:{click:function(e){return t.handleRowCopy(t.row,t.index,t.parentCol)}}})]),o("el-tooltip",{attrs:{placement:"top",enterable:!1,"open-delay":300,content:"选择"}},[o("span",{staticClass:"row-helper-btn selected el-icon-top-left",on:{click:function(e){return e.stopPropagation(),t.handleRowSelect(t.row.id)}}})])],1)],2)},a=[],c=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"col",class:t.getColCls(t.col,t.index,t.row.cols.length),style:t.colStyle,attrs:{id:t.col.id,name:t.col.name},on:{click:function(e){return e.stopPropagation(),t.handleColClick(t.index,t.col,e)},contextmenu:function(e){return e.stopPropagation(),e.preventDefault(),t.onContextMenu(e)}}},["acc-item"==t.type?o("h2",{staticClass:"acc-item-header",class:{closed:!t.col.props.opened}},[o("span",{staticClass:"acc-item-index"},[t._v(t._s(t.getAccItemIndex(t.index)))]),o("span",{staticClass:"acc-item-title"},[t._v(t._s(t.col.props.title))]),o("span",{staticClass:"acc-item-toggle",on:{click:t.toggleAccItem}})]):t._e(),t.showNested?o("RowLayout",{directives:[{name:"show",rawName:"v-show",value:"acc-item"==t.type||t.col.subs&&t.col.subs.length||t.inLayoutDragging,expression:"type == 'acc-item' || (col.subs && col.subs.length) || inLayoutDragging"}],attrs:{list:t.col.subs,level:t.levelNext,parentCol:t.col,parentRow:t.row}}):t._e(),t.showControlContainer?o("draggable",{staticClass:"dropArea controls",class:{active:t.col.controls.length||t.inControlDragging},attrs:{group:"control",list:t.col.controls,draggable:".design-control",swapThreshold:1,invertedSwapThreshold:1,invertSwap:!1,direction:"vertical",move:t.checkControlMove},on:{start:t.onControlDragStart,end:t.onControlDragEnd,add:function(e){return t.onControlAdd(e,{col:t.col,colIndex:t.index,row:t.row})}}},t._l(t.col.controls,(function(e){return o("Control",{key:e.id,class:{selected:e.id==t.selectedControlId},attrs:{"control-data":e},nativeOn:{click:function(o){return o.stopPropagation(),t.onControlClick(e.id)}}})})),1):t._e(),t.showXResizer?o("div",{staticClass:"col-helper-line line-v",attrs:{"data-row-index":t.rowIndex,"data-col-index":t.index,"data-level":t.level}}):t._e(),t.showYResizer?o("div",{staticClass:"col-helper-line line-h",attrs:{"data-row-index":t.rowIndex,"data-col-index":t.index}}):t._e()],1)},d=[],u=o("a3de"),h={methods:{closestComponent(t,e){const o=e||this;let n=o.$parent||o.$root;if(t+""===t){let e=n.$options.name;while(n&&(!e||e!==t))n=n.$parent,n&&(e=n.$options.name)}else while(n&&!t(n))n=n.$parent;return n}}};function p(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function m(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?p(Object(o),!0).forEach((function(e){Object(s["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):p(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var f={name:"ColLayout",components:{RowLayout:()=>Promise.resolve().then(o.bind(null,"eafa")),Control:u["a"]},data(){return{}},inject:{hideCtxMenu:"hideCtxMenu"},mixins:[h],props:{row:{type:Object,required:!0},rowIndex:{type:Number,required:!0},col:{type:Object,required:!0},index:{type:Number,required:!0},level:{type:Number,required:!0},isLastRow:{type:Boolean,required:!0}},computed:m(m(m({},Object(r["e"])(["globalStyle","selectedColId","selectedControlId"])),Object(r["c"])(["inControlDragging","inLayoutDragging"])),{},{showNested(){return"col-item"!==this.type||!this.col.controls.length&&1!=this.row.cols.length},type(){const t=this.col;return t&&t.type?t.type:"col-item"},showControlContainer(){return"col-item"==this.type&&(!this.col.subs||!this.col.subs.length)},levelNext(){return this.level+1},colStyle(){const t=this.col.style.width,e=t+""===t?t:t+"px";return{width:e}},showXResizer(){return"acc-item"!=this.type&&this.index!==this.row.cols.length-1},showYResizer(){if("acc-item"==this.type)return!1;if(1==this.level&&"col-item"==this.type){const t=this.closestComponent("ColLayout",this.$parent);if(t&&"acc-item"==t.type)return!0}return 0===this.level||!this.isLastRow}}),methods:m(m({},Object(r["b"])(["setSelectedControl","activeRightTab","setSelectedCol"])),{},{getColCls(t,e,o){const n=this.globalStyle,i=t.subs.length,s=t.style,r={selected:this.selectedColId==t.id,isSub:!i,hasSub:i,["text-"+(s.textAlign||n.textAlign)]:!0,["vertical-"+(s.verticalAlign||n.verticalAlign)]:!0};return r[this.type]=!0,"col-item"==this.type&&(r.first=0===e,r.mid=e&&e!==o-1,r.last=e===o-1),r},handleColClick(t,e,o){this.hideCtxMenu();const n=o.target;if(n.classList.contains("col-helper-line"))return;const i=n.closest(".col");if(!i)return;const s=e.id==this.selectedColId;s?this.setSelectedCol({id:""}):(this.setSelectedCol({id:e.id}),this.activeRightTab("cell"))},onControlDragStart(){this.controlDragStart()},onControlDragEnd(t){this.controlDragEnd()},onControlAdd(t,e){const o=e.col.controls&&e.col.controls[t.newIndex];if(o&&o.id&&this.onControlClick(o.id),t.from.classList.contains("control-drag-area")){const n=t.item.dataset.controlType;if("title"==n||"label"==n||"subtable"==n)return;const i=e.row,s=e.colIndex,r=i.cols[s-1];if(!r)return;const l=!r.controls.length&&!r.subs.length;l&&this.$store.dispatch("autoAddLabel",{parentCol:r,controlData:o})}},checkControlMove(t){if(t.to.classList.contains("design-hidden-area"))return!1},onControlClick(t){this.setSelectedControl({id:t}),this.activeRightTab("control"),setTimeout(()=>{this.$bus.$emit("cntrolClick")},100)},onContextMenu(t){this.$emit("on-context-menu",t)},getAccItemIndex(t){const e=t+1;return e<10?"0"+e:e},toggleAccItem(t){t.stopPropagation();const e=t.target.closest(".acc-item-header");e&&e.classList.toggle("closed")}})},g=f,b=o("2877"),y=Object(b["a"])(g,c,d,!1,null,null,null),v=y.exports,C=o("4260"),w=o("42a0"),x=o.n(w),D={methods:{onContextmenu(t,e){const o=t.target;(1==e.row.cols.length||2===e.row.cols.length&&e.parentCol&&1===e.parentCol.subs.length)&&(e.colDeletable=!1),e.col&&e.col.controls&&e.col.controls.length&&(e.hasControl=!0);const n=o.closest(".design-control");if(n){const t=n.dataset.id;let o,i,s;for(let n=0,r=e.col.controls.length;n<r;n++)if(s=e.col.controls[n],s.id==t){o=n,i=s;break}i&&(e.control=i,e.controlIndex=o)}this.$data._ctxMenuData=e,this.showCtxMenu(t,e,this.handleContextMenu)},handleContextMenu(t,e){const o=this.$data._ctxMenuData;switch(t){case"deleteControl":this.deleteControl({selectedControl:o.control,selectedControlParentCol:o.col,selectedControlIndex:o.controlIndex});break;case"removeCol":this.removeCol({col:o.col,parentRow:o.row,colIndex:o.colIndex});break;case"removeRow":this.handleRowRemove(o.row,o.rowIndex);break;case"insertRowUp":this.copyRow({aimIndex:o.rowIndex,parentCol:o.parentCol,newRow:this.getRowCopyData(o.row,!0),shuttle:!0});break;case"insertRowDown":this.copyRow({aimIndex:o.rowIndex+1,parentCol:o.parentCol,newRow:this.getRowCopyData(o.row,!0),shuttle:!0});break;case"insertColLeft":this.splitCol({col:o.col,colIndex:o.colIndex,count:2,parentRow:o.row,direction:"left",shuttle:!0});break;case"insertColRight":this.splitCol({col:o.col,colIndex:o.colIndex,count:2,parentRow:o.row,direction:"right",shuttle:!0});break;case"insertMultiCol":this.splitCol({col:o.col,colIndex:o.colIndex,count:e.colCount||2,parentRow:o.row,direction:"right",shuttle:!0});break;case"insertMultiRowCol":this.$store.dispatch("insertMultiRowCol",{col:o.col,parentCol:o.parentCol,parentRow:o.row,parentRowIndex:o.rowIndex,rowCount:e.rowCount,colCount:e.colCount,shuttle:!0});break;default:break}}}};function O(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function _(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?O(Object(o),!0).forEach((function(e){Object(s["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):O(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var k={name:"Row",components:{ColLayout:v},inject:{showCtxMenu:"showCtxMenu"},props:{row:{type:Object},index:{type:Number},level:{type:Number},parentCol:{type:Object,default:null},isLastRow:{type:Boolean},prevRow:{type:Object,default:null}},computed:_(_({},Object(r["e"])(["selectedRowId"])),{},{type(){const t=this.row;return t&&t.type?t.type:"row-layout"},style(){const t=this.row.height,e=t+""===t?t:t+"px",o={};return"acc-layout"==this.type&&(o.marginTop="16px",o.marginBottom="16px"),"row-layout"==this.type&&(o["min-height"]=e),o},className(){const t=this.type,e={[t]:!0,isTop:0==this.level,selected:this.selectedRowId==this.row.id};return"acc-layout"==t||(0===this.index||this.prevRow&&this.prevRow.type&&"row-layout"!=this.prevRow.type?e.first=!0:e.mid=!0),e}}),mixins:[D],data(){return{_ctxMenuData:null}},methods:_(_(_({},Object(r["d"])(["copyRow","splitCol"])),Object(r["b"])(["setSelectedLayout","deleteRow","activeRightTab","deleteControl"])),{},{handleRowSelect(t){this.setSelectedLayout({id:t}),this.activeRightTab("control")},handleRowCopy(t,e,o){const n=this.getRowCopyData(t);this.copyRow({aimIndex:e+1,parentCol:o,newRow:n,shuttle:!0})},getRowCopyData(t,e){const o=Object(C["d"])(t);return n(o),o;function n(t){const o=Object(C["l"])(),s=t.namePrefix||t.name;t.id=o,t.autoIndex=C["j"].getIndex(s),t.name&&(t.name=`${t.name}_${t.autoIndex}`),t.cols.forEach(t=>{t.id=`col-${o}-${C["b"].getIndex(o)}`,t.subs&&t.subs.forEach(n),e?t.controls=[]:t.controls.forEach(i)})}function i(t){const e=t.type,o=window.FORM_DESIGN_CONFIG.controls[e];if(!o)throw new Error(`控件的 ${e} 配置信息不存在，无法创建`);const n=Object(C["d"])(o);delete n.configItems,delete n.name,delete n.width,delete n.id,delete n.type,"label"!=e&&"title"!=e&&x()(t,n);const i=C["c"].getIndex(e);t.id=e+"-"+i,t.autoIndex=i,t.name&&(t.name=`${t.name}_${i}`)}},handleRowRemove(t,e){if(this.isEmptyRow(t))return this.doRowRemove(t,e);this.$confirm("此操作将移除此行，以及此行内的所有内容，是否确认？"," 删除提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.doRowRemove(t,e)}).catch(()=>{})},doRowRemove(t,e){this.deleteRow({parentCol:this.parentCol,row:t,index:e})},isEmptyRow(t){for(let e of t.cols)if(e.subs.length||e.controls.length)return!1;return!0},removeCol(t){const e=t.col,o=t.parentRow,n=t.colIndex;if(this.isEmptyCol(e))return this.doColRemove(e,o,n);this.$confirm("删除后此单元格内的所有内容将一并删除，是否继续？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.doColRemove(e,o,n)}).catch(t=>{t&&console.error(t)})},doColRemove(t,e,o){this.$store.dispatch("removeCol",{col:t,parentRow:e,colIndex:o,shuttle:!0})},isEmptyCol(t){return!(t.subs.length||t.controls.length)}})},S=k,T=Object(b["a"])(S,l,a,!1,null,null,null),j=T.exports,$=o("84a2"),I=o.n($),P=o("db49"),E={methods:{onMouseDown(t){const e=t.target;if(!e.classList.contains("col-helper-line"))return!0;window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp);var o=this.rowEl=e.closest(".row"),n=this.colEl=e.closest(".col");this.rowId=o&&o.getAttribute("row-id"),this.rowData=this.findRow(this.rowId),this.startHeight=this.rowData.height||P["b"];const i=this.getDesignContainer(),s=i.getBoundingClientRect();this.mouseOffset=this.getMouseOffset(t),this.stagElementsOffset(t,s);const r=parseInt(e.dataset.colIndex,10);this.colData=this.rowData.cols[r],this.nextColData=this.rowData.cols[r+1],this.colData.width+""===this.colData.width?this.startWidth=n.getBoundingClientRect().width:this.startWidth=this.colData.style.width,this.rowId,this.inMoving=!0,e.classList.contains("line-v")?(this.getXLimit(t,s),this.resizeMode="v",this.startOffsetX=this.getXOffset(t),this.updateLineLeft(this.startOffsetX),this.showVLine()):e.classList.contains("line-h")&&(this.getYLimit(t,s),this.resizeMode="h",this.startOffsetY=this.getYOffset(t),this.updateLineTop(this.startOffsetY),this.showHLine())},onMouseMove(t){if("h"==this.resizeMode){let e=this.getYOffset(t);e=Object(C["a"])(e,this.moveRange.y[0],this.moveRange.y[1]),this.updateLineTop(e);const o=e-this.startOffsetY;let n=this.startHeight+o;n<P["b"]&&(n=P["b"]),this.updateRowHeight({rowId:this.rowId,height:n,row:this.rowData,parentRowPath:this.pathMap[this.rowId],shuttle:!0})}else if("v"==this.resizeMode){let e=this.getXOffset(t);e=Object(C["a"])(e,this.moveRange.x[0],this.moveRange.x[1]);const o=this.getSnapOffset(e);o&&(e=o),this.updateLineLeft(e);const n=e-this.startOffsetX;let i=this.startWidth+n;i<10&&(i=10),this.updateColWidth({col:this.colData,width:i,nextCol:this.nextColData,shuttle:!0})}},getXLimit(t,e){let o,n;function i(t,e){if(!t.subs||!t.subs.length)return t.style.width;const o=t.subs.map(t=>i(t.cols["first"==e?0:t.cols.length-1]));return Math.min(...o)}this.colData?(o=i(this.colData,"last"),o=o<P["a"]?0:o-P["a"]):o=0,this.nextColData?(n=i(this.nextColData,"first"),n=n<P["a"]?0:n-P["a"]):n=0,o=t.pageX-e.left-this.mouseOffset.x-o,n=t.pageX-e.left-this.mouseOffset.x+n,this.moveRange.x=[o,n]},getYLimit(t,e){let o,n;const i=s(this.rowData)||P["b"];return o=i-P["b"],o<0&&(o=0),o=t.pageY-e.top-this.mouseOffset.y-o,n=1/0,this.moveRange.y=[o,n],[o,n];function s(t){let e=!1;const o=[];return t.cols.forEach(t=>{t.subs&&t.subs.length&&(e=!0,o.push(s(t.subs[t.subs.length-1])))}),t.height,e?Math.min(...o):t.height}},getLimitedOffset(){},getYOffset(t){const e=this.getDesignContainer(),o=e.getBoundingClientRect(),n=t.pageY-o.top-this.mouseOffset.y;return n},getXOffset(t){const e=this.getDesignContainer(),o=e.getBoundingClientRect(),n=t.pageX-o.left-this.mouseOffset.x;return n},getMouseOffset(t){const e=t.target,o=e.getBoundingClientRect();return{x:t.pageX-o.left-o.width/2,y:t.pageY-o.top-o.height/2}},stagElementsOffset(t,e){const o=this.getDesignContainer(),n=t.target.closest("col"),i=[].slice.call(o.querySelectorAll(".col.isSub")),s=[];i.forEach(t=>{if(t.classList.contains("last")||t==n)return;const o=t.getBoundingClientRect(),i=o.left+o.width-e.left;s.push(i)}),this.otherColOffSets=Array.from(new Set(s)),this.otherColOffSets},getSnapOffset(t){const e=new Map;return this.otherColOffSets.forEach(o=>{const n=Math.abs(t-o);n<=10&&e.set(n,o)}),!!e.size&&e.get(Math.min(...e.keys()))},onMouseUp(){this.hideHLine(),this.hideVLine(),this.resetMoveData(),this.removeEventListener()},resetMoveData(){this.inMoving=!1,this.rowEl=null,this.colEl=null,this.rowId="",this.rowData=null,this.colData=null,this.nextColData=null,this.startOffsetX=0,this.startOffsetY=0,this.mouseOffset.x=0,this.mouseOffset.y=0,this.moveRange.x=[0,0],this.moveRange.y=[0,0],this.otherColOffSets=[],this.startHeight=0,this.startWidth=0,this.resizeMode=!1},removeEventListener(){window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp)}}};function L(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function A(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?L(Object(o),!0).forEach((function(e){Object(s["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):L(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var M={name:"row-layout",inject:{getDesignContainer:{default:()=>document.getElementById("design-area")},showCtxMenu:"showCtxMenu",showMutliRowConfirm:"showMutliRowConfirm"},mixins:[E],props:{list:{type:Array,default:()=>[]},level:{type:Number,default:0},parentCol:{type:Object,default:null},parentRow:{type:Object,default:null}},data(){return{inMoving:!1,rowEl:null,colEl:null,rowId:"",rowData:null,colData:null,nextColData:null,startOffsetX:0,startOffsetY:0,mouseOffset:{x:0,y:0},moveRange:{x:[0,0],y:[0,0]},otherColOffSets:[],startHeight:0,startWidth:0,resizeMode:!1}},mounted(){0===this.level&&this.$el.addEventListener("mousedown",this.onMouseDown)},components:{Row:j},computed:A(A({},Object(r["e"])(["formSize"])),{},{levelNext(){return this.level+1},dataMap(){return this.$store.getters.rowDataMap},pathMap(){return this.$store.getters.subRowPathMap}}),methods:A(A(A({},Object(r["d"])(["updateLineTop","updateLineLeft","showHLine","hideHLine","showVLine","hideVLine","updateRowHeight","updateColWidth","layoutDragStart","layoutDragEnd","controlDragStart","controlDragEnd"])),Object(r["b"])(["setSelectedControl","setSelectedCol","setSelectedLayout","deleteRow","deleteControl","activeRightTab"])),{},{throttle:I()((t,e)=>{t.name,t(e)},20,{leading:!0,trailing:!1}),checkLayoutMove(t){const e=t.draggedContext.element;return!(1==e.cols.length&&!t.to.classList.contains("level-0")&&!t.to.parentElement.classList.contains("acc-item"))&&(!("acc-layout"==e.type&&!t.to.classList.contains("level-0"))&&void 0)},checkControlMove(t){if(t.to.classList.contains("design-hidden-area"))return!1},onLayoutChange(t){if(t.added){const e=t.added.element,o=this.parentCol;if(this.parentCol,e.asMulti)return this.showMutliRowConfirm((n,i)=>{if(o&&"acc-item"!=o.type&&1==n&&1==i)return this.$store.dispatch({type:"deleteRow",parentCol:this.parentCol,row:e,index:t.added.newIndex,shuttle:!1}),this.$message({type:"error",message:"单行单列不能被嵌套在单元格中"});this.$store.commit("replaceToMulti",{row:e,rowIndex:t.added.newIndex,rowCount:n,colCount:i,parentCol:o,shuttle:!0})});if("acc-layout"==e.type)return this.$store.commit({type:"tryMergeAcc",row:e,rowIndex:t.added.newIndex});if(this.handleColWidthChange(e),this.parentCol&&"acc-item"!=this.parentCol.type){const t=this.pathMap[e.id],o=t[0],n=o.height,i=this.parentCol.subs.reduce((t,e)=>t+e.height,0),s=n-i;s<=0?this.updateRowHeight({rowId:o.id,row:o,height:i,bubble:!0,rowPath:this.pathMap[o.id],shuttle:!0,group:"adjust"}):this.updateRowHeight({rowId:e.id,height:e.height+s,row:e,bubble:!1,shuttle:!0,group:"adjust"})}}if(t.removed&&this.parentCol&&this.parentRow){const t=this.parentCol.subs,e=this.parentRow.height,o=t.reduce((t,e)=>t+e.height,0),n=t[t.length-1],i=n.height+(e-o);i&&this.updateRowHeight({rowId:n.id,row:n,height:i,bubble:!1,shuttle:!0,group:"adjust"})}},handleColWidthChange(t){if("acc-layout"==t.type)return;const e=this.parentCol?this.parentCol.style.width:this.formSize.width,o=t.cols.reduce((t,e)=>t+e.style.width,0);let n=e/o;isNaN(n)&&(n=1),this.$store.commit({type:"updateRowColWidth",rowId:t.id,row:t,ratio:n,shuttle:!0,group:"adjust"})},onLayoutDragStart(){this.layoutDragStart()},onLayoutDragEnd(){this.layoutDragEnd()},onControlDragStart(){this.controlDragStart()},onControlDragEnd(t){this.controlDragEnd()},onDragChoose(){},findRow(t){const e=this.dataMap[t];return e?e.row:null}}),beforeDestroy(){this.$el.removeEventListener("mousedown",this.onMouseDown)}},F=M,R=(o("0015"),Object(b["a"])(F,n,i,!1,null,null,null));e["default"]=R.exports},ec83:function(t,e,o){"use strict";o("c28b")},ef38:function(t,e,o){"use strict";o("aea2")},f1a3:function(t,e,o){"use strict";o("b0c7")},f4d4:function(t,e,o){"use strict";o("250c")},f5bd:function(t,e,o){"use strict";o("ce0a")},ff06:function(t,e,o){}});