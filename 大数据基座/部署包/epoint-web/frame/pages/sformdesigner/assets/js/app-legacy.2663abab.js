(function(t){function e(e){for(var o,i,l=e[0],s=e[1],c=e[2],u=0,d=[];u<l.length;u++)i=l[u],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&d.push(r[i][0]),r[i]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(t[o]=s[o]);f&&f(e);while(d.length)d.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],o=!0,i=1;i<n.length;i++){var l=n[i];0!==r[l]&&(o=!1)}o&&(a.splice(e--,1),t=s(s.s=n[0]))}return t}var o={},i={app:0},r={app:0},a=[];function l(t){return s.p+"assets/js/"+({}[t]||t)+"-legacy."+{"chunk-16a1e32a":"8860cac2"}[t]+".js"}function s(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(t){var e=[],n={"chunk-16a1e32a":1};i[t]?e.push(i[t]):0!==i[t]&&n[t]&&e.push(i[t]=new Promise((function(e,n){for(var o="assets/css/"+({}[t]||t)+"."+{"chunk-16a1e32a":"9bfcac0d"}[t]+".css",r=s.p+o,a=document.getElementsByTagName("link"),l=0;l<a.length;l++){var c=a[l],u=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(u===o||u===r))return e()}var d=document.getElementsByTagName("style");for(l=0;l<d.length;l++){c=d[l],u=c.getAttribute("data-href");if(u===o||u===r)return e()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=e,f.onerror=function(e){var o=e&&e.target&&e.target.src||r,a=new Error("Loading CSS chunk "+t+" failed.\n("+o+")");a.code="CSS_CHUNK_LOAD_FAILED",a.request=o,delete i[t],f.parentNode.removeChild(f),n(a)},f.href=r;var p=document.getElementsByTagName("head")[0];p.appendChild(f)})).then((function(){i[t]=0})));var o=r[t];if(0!==o)if(o)e.push(o[2]);else{var a=new Promise((function(e,n){o=r[t]=[e,n]}));e.push(o[2]=a);var c,u=document.createElement("script");u.charset="utf-8",u.timeout=120,s.nc&&u.setAttribute("nonce",s.nc),u.src=l(t);var d=new Error;c=function(e){u.onerror=u.onload=null,clearTimeout(f);var n=r[t];if(0!==n){if(n){var o=e&&("load"===e.type?"missing":e.type),i=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+o+": "+i+")",d.name="ChunkLoadError",d.type=o,d.request=i,n[1](d)}r[t]=void 0}};var f=setTimeout((function(){c({type:"timeout",target:u})}),12e4);u.onerror=u.onload=c,document.head.appendChild(u)}return Promise.all(e)},s.m=t,s.c=o,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(n,o,function(e){return t[e]}.bind(null,o));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=e,c=c.slice();for(var d=0;d<c.length;d++)e(c[d]);var f=u;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0015":function(t,e,n){"use strict";n("8e39")},"026d":function(t,e,n){"use strict";n("dd1c")},"034f":function(t,e,n){"use strict";n("64a9")},"13f1":function(t,e,n){"use strict";n("7e28")},"165c":function(t,e,n){"use strict";n("46c9")},"1f0e":function(t,e,n){"use strict";n("4e92")},"20fd":function(t,e,n){"use strict";n("d5bd")},"250c":function(t,e,n){},"25cd":function(t,e,n){"use strict";n("9836")},"279b":function(t,e,n){},"2e74":function(t,e,n){"use strict";n("89c5")},"2fe4":function(t,e,n){},3176:function(t,e,n){"use strict";n("592a")},"31ec":function(t,e,n){},3552:function(t,e,n){},4260:function(t,e,n){"use strict";n.d(e,"l",(function(){return i})),n.d(e,"g",(function(){return a})),n.d(e,"k",(function(){return l})),n.d(e,"d",(function(){return c})),n.d(e,"i",(function(){return u["b"]})),n.d(e,"h",(function(){return d})),n.d(e,"a",(function(){return g})),n.d(e,"c",(function(){return p["b"]})),n.d(e,"b",(function(){return p["a"]})),n.d(e,"j",(function(){return p["d"]})),n.d(e,"f",(function(){return h})),n.d(e,"e",(function(){return m}));n("ac6a"),n("f3e2"),n("2caf"),n("6b54"),n("87b3");function o(){var t=+new Date,e=1e9*(1e4*Math.random()>>>0),n=(e+t).toString(32);return o._store[n]?o():(o._store[n]=!0,n)}o._store={},o.adapt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t.id},n=o._store;Array.isArray(t)&&t.forEach((function(t){var o=e(t);n[o]?console.warn("id duplicated",t.id):n[o]=o}))};var i=o,r=n("53ca");n("28a5");function a(t,e){var n=e.split(".");if(1===n.length)return t[e];var o,i=0,a=t,l=n.length;while(1){if(i==l-1)return a[n[i]];if(o=a[n[i]],!o||"object"!=Object(r["a"])(o))return console.error("无法获取嵌套属性 at "+n[i],t,e),null;a=o,i++}}function l(t,e,n){var o=e.split(".");if(1===o.length)return t[e]=n;var i,a=0,l=t,s=o.length-1;do{i=l[o[a]],i&&"object"==Object(r["a"])(i)?l=i:console.error("无法设置嵌套属性 at "+o[a],t,e),a++}while(a<s);return l.hasOwnProperty(o[a])||console.warn("设置原来没有的属性："+o[a]+" at ",l),l[o[a]]=n}function s(t){return JSON.parse(JSON.stringify(t))}var c=s,u=n("adb5");function d(t){var e=document.createElement("div");return e.appendChild(document.createTextNode(t)),e.innerHTML}function f(t){var e=document.createElement("div");return e.innerHTML=t,e.innerText}var p=n("9827");function h(t){return window.encodeURIComponent(window.btoa(window.encodeURIComponent(t)))}function m(t){return window.decodeURIComponent(window.atob(window.decodeURIComponent(t)))}function g(t,e,n){var o=t-e,i=n-t;return o>=0&&i>=0?t:Math.abs(o)>=Math.abs(i)?n:e}u["a"],u["b"],p["b"],p["a"]},4277:function(t,e,n){},"46c9":function(t,e,n){},"472d":function(t,e,n){},"4e92":function(t,e,n){},"529d":function(t,e,n){},5389:function(t,e,n){},5443:function(t,e,n){"use strict";n("2fe4")},"56d7":function(t,e,n){"use strict";n.r(e);n("1c01");var o=n("53ca"),i=(n("f4f9"),n("450d"),n("c2cc")),r=n.n(i),a=(n("7a0f"),n("0f6c")),l=n.n(a),s=(n("bd49"),n("18ff")),c=n.n(s),u=(n("960d"),n("defb")),d=n.n(u),f=(n("cb70"),n("b370")),p=n.n(f),h=(n("cbb5"),n("8bbc")),m=n.n(h),g=(n("826b"),n("c263")),v=n.n(g),b=(n("a7cc"),n("df33")),y=n.n(b),C=(n("0c67"),n("299c")),w=n.n(C),x=(n("eca7"),n("3787")),O=n.n(x),D=(n("ae26"),n("845f")),_=n.n(D),k=(n("1951"),n("eedf")),S=n.n(k),j=(n("e960"),n("b35b")),T=n.n(j),I=(n("016f"),n("486c")),P=n.n(I),A=(n("1f1a"),n("4e4b")),E=n.n(A),L=(n("9d4c"),n("e450")),$=n.n(L),M=(n("fe07"),n("6ac5")),F=n.n(M),R=(n("b5d8"),n("f494")),N=n.n(R),V=(n("d4df"),n("7fc1")),B=n.n(V),z=(n("560b"),n("dcdc")),H=n.n(z),G=(n("7f7f"),n("10cb"),n("f3ad")),q=n.n(G),U=(n("9e1f"),n("6ed5")),W=n.n(U),J=(n("0fb7"),n("f529")),Y=n.n(J),X=(n("6611"),n("e772")),K=n.n(X),Q=(n("425f"),n("4105")),Z=n.n(Q),tt=(n("cadf"),n("551c"),n("f751"),n("097d"),n("a026")),et=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{style:"height:"+t.height+"px",attrs:{id:"app"}},[n("Main")],1)},nt=[],ot=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"design-container"},[n("Header",{ref:"header",attrs:{"in-preview":t.showPreview,formTitle:t.formTitle},on:{"save-click":function(e){return t.saveToServer()},"drop-item-click":t.handleCommand}}),t.showPreview?n("Preview",{attrs:{tableGuid:t.tableGuid,designId:t.designId,type:t.viewType}}):t._e(),t.showPreview?t._e():n("div",{staticClass:"design-body",class:{narrow:t.narrowMode,"view-pc":"pc"===t.viewType,"view-mobile":"mobile"===t.viewType}},[n("div",{staticClass:"design-leftbar"},[n("Tabs",{attrs:{value:t.leftActiveTab},on:{input:t.activeLeftTab}},[n("TabPanel",{attrs:{label:"布局",name:"layout",disabled:"mobile"===t.viewType}},[n("PanelLayout")],1),n("TabPanel",{attrs:{label:"控件",name:"control",disabled:"mobile"===t.viewType}},[n("PanelControl")],1),n("TabPanel",{attrs:{label:"数据域",name:"data"}},[n("PanelData")],1)],1)],1),n("div",{staticClass:"design-view-container",class:{"view-real":!t.viewDesign,"view-design":t.viewDesign}},[t.dataLoaded?n("Design",{directives:[{name:"show",rawName:"v-show",value:"pc"===t.viewType,expression:"viewType === 'pc'"}],attrs:{data:t.design,size:t.formSize}}):t._e(),t.dataLoaded&&"mobile"===t.viewType?n("MobileDesign"):t._e()],1),n("div",{staticClass:"design-rightbar",class:{pickup:t.narrowMode&&t.rightbarHidden}},[t.narrowMode&&"pc"===t.viewType?n("el-button",{staticClass:"design-rightbar-toggle",attrs:{icon:"el-icon-d-arrow-right",plain:""},on:{click:function(e){t.rightbarHidden=!t.rightbarHidden}}}):t._e(),n("Tabs",{attrs:{"default-active":"form",value:t.rightActiveTab},on:{input:t.activeRightTab}},[n("TabPanel",{attrs:{label:"表单设置",name:"form",disabled:"mobile"===t.viewType}},[t.dataLoaded?n("ConfigForm"):t._e()],1),n("TabPanel",{attrs:{label:"组件设置",name:"control"}},[t.selectedControl?n("ConfigControl",{attrs:{control:t.selectedControl}}):t._e(),t.selectedRowId?n("ConfigRow",{attrs:{"row-id":t.selectedRowId}}):t._e(),t.selectedControl||t.selectedRowId?t._e():n("div",[t._v("请选择控件或行")])],1),n("TabPanel",{attrs:{label:t.cellPanelName,name:"cell",disabled:"mobile"===t.viewType}},[t.selectedColId?n("ConfigCell",{attrs:{"selected-col":t.selectedCol}}):n("div",[t._v("请选择单元格")])],1)],1)],1)]),t.needRender?n("LayoutGender",{ref:"builder",attrs:{list:t.design,"global-style":t.globalStyle}}):t._e(),n("NewFiledDialog"),t._e()],1)},it=[],rt=(n("58b2"),n("8e6e"),n("456d"),n("a481"),n("4f37"),n("6d67"),n("0cd8"),n("d92a"),n("d25f"),n("2909")),at=(n("f3e2"),n("2caf"),n("ac6a"),n("5df3"),n("ade3")),lt=(n("386d"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tabs-view"},[n("div",{staticClass:"tabs-head"},t._l(t.panels,(function(e,o){return n("div",{key:e.name,staticClass:"tab-head",class:t.getTabHeadCls(e),on:{click:function(e){return t.activeTab(o)}}},[t._v(t._s(e.label))])})),0),n("div",{staticClass:"tabs-body-wrap"},[n("div",{staticClass:"tabs-body",style:{width:t.width,marginLeft:t.marginLeft}},[t._t("default")],2)])])}),st=[],ct={methods:{getPercent:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,n=Math.pow(10,e);return(Math.floor(100*t*n)/n).toFixed(2)+"%"}}},ut=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tab-body",style:{width:t.width},attrs:{"data-name":t.name}},[t._t("default")],2)},dt=[];function ft(t,e,n){this.$children.forEach((function(o){var i=o.$options.name;i===t?o.$emit.apply(o,[e].concat(n)):ft.apply(o,[t,e].concat([n]))}))}var pt={methods:{dispatch:function(t,e,n){var o=this.$parent||this.$root,i=o.$options.name;while(o&&(!i||i!==t))o=o.$parent,o&&(i=o.$options.name);o&&o.$emit.apply(o,[e].concat(n))},broadcast:function(t,e,n){ft.call(this,t,e,n)}}},ht={name:"tab-panel",inject:["tabCount","activeIndex"],mixins:[ct,pt],props:{label:{type:String,required:!0},name:{type:String,required:!0},disabled:{type:Boolean,default:!1}},computed:{width:function(){return this.getPercent(1/this.tabCount)}},methods:{propChange:function(){this.dispatch("Tabs","tab-panel-props-change")}},watch:{label:function(){this.propChange()},name:function(){this.propChange()},disabled:function(){this.propChange()}}},mt=ht,gt=n("2877"),vt=Object(gt["a"])(mt,ut,dt,!1,null,null,null),bt=vt.exports,yt={name:"Tabs",mixins:[ct],props:{defaultActive:{type:String},activeClass:{type:String,default:"active"},value:{type:String}},components:{TabPanel:bt},provide:function(){return{tabCount:this.tabCount,activeIndex:this.activeIndex}},mounted:function(){this.$on("tab-panel-props-change",this.tabPanelChange)},beforeDestroy:function(){this.$off("tab-panel-props-change")},data:function(){return{active:this.value||this.defaultActive,tabCount:0,panels:this.getPanels()}},computed:{activeIndex:function(){if(this.panels.length)for(var t=0;t<this.panels.length;t++)if(this.panels[t].name==this.active)return t;return 0},width:function(){return this.getPercent(this.tabCount)},marginLeft:function(){return"-"+this.getPercent(this.activeIndex)}},watch:{panels:{immediate:!0,handler:function(){this.tabCount=this.panels.length}},value:function(t){t&&(this.active=t)},active:function(t){this.$emit("input",t)}},methods:{getTabHeadCls:function(t){var e;return e={},Object(at["a"])(e,this.activeClass,this.active==t.name),Object(at["a"])(e,"disabled",t.disabled),e},activeTab:function(t){var e=this.panels[t];e.disabled||(this.active=this.panels[t].name)},tabPanelChange:function(){this.panels=this.getPanels()},getPanels:function(){var t=this.$slots.default.filter((function(t){return t.tag&&t.componentOptions&&"tab-panel"===t.componentOptions.Ctor.options.name})),e=t.map((function(t){return t.componentOptions.propsData}));return e}}},Ct=yt,wt=(n("6f10"),Object(gt["a"])(Ct,lt,st,!1,null,null,null)),xt=wt.exports,Ot=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("draggable",{staticClass:"layout-drag-area left-panel layout",attrs:{list:t.layoutList,group:{name:"layout",pull:"clone",put:!1},swapThreshold:"0.3",sort:!1,clone:t.createLayout,move:t.checkMove},on:{change:t.log,start:t.onDragStart,end:t.onDragEnd}},t._l(t.layoutList,(function(e,o){return n("div",{key:e.id||o,staticClass:"template-item layout-item",class:e.type},[n("span",{staticClass:"template-item-icon layout",class:e.icon}),n("span",{staticClass:"template-item-name"},[t._v(t._s(e.name))])])})),0)},Dt=[],_t=n("2f62"),kt=n("4260"),St=n("db49");function jt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Tt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?jt(Object(n),!0).forEach((function(e){Object(at["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):jt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var It={name:"panel-layout",data:function(){return{layoutList:[{name:"一行2列",icon:"col-2",cols:[1,1],type:"row-layout"},{name:"一行4列",icon:"col-4",cols:[1,1,1,1],type:"row-layout"},{name:"一行6列",icon:"col-6",cols:[1,1,1,1,1,1],type:"row-layout"},{name:"1：5",icon:"col-2",cols:[1,5],type:"row-layout"},{name:"1：2：1：2",icon:"col-4",cols:[1,2,1,2],type:"row-layout"},{name:"多行多列",icon:"col-multi",cols:[],type:"row-layout"},{name:"手风琴布局",icon:"col-multi",cols:[1,1,1],type:"acc-layout"}]}},mixins:[pt],computed:Tt(Tt({},Object(_t["e"])(["formSize"])),{},{rowHeight:function(){var t=this.$store.state.globalStyle;return t&&t.cellHeight?t.cellHeight:St["b"]},initialBorder:function(){return this.$store.state.globalStyle.border}}),mounted:function(){this.dispatch("accordion","updated")},methods:Tt(Tt({},Object(_t["d"])(["layoutDragStart","layoutDragEnd"])),{},{createLayout:function(t){return"row-layout"==t.type?this.createRowLayout(t):"acc-layout"==t.type?this.createAccLayout(t):void 0},createAccLayout:function(t){var e=this.createRowLayout(t);return e.props={showNav:!1},e.cols.forEach((function(t,e){t.type="acc-item",t.style.width="100%",t.props={title:"手风琴项目-"+(e+1),opened:!0}})),e},createRowLayout:function(t){var e=Object(kt["l"])(),n=kt["j"].getIndex(t.name),o={id:e,name:"",autoIndex:n,namePrefix:t.name,cols:this.createCols(t.cols,e),type:t.type||"row-layout",height:this.rowHeight};return 0==t.cols.length&&(o.asMulti=!0,o.cols=this.createCols([1],e)),o},createCols:function(t,e){var n=this,o=t.reduce((function(t,e){return t+e}),0),i=this.formSize.width;return t.map((function(t){var r=kt["b"].getIndex(e);return{id:"col-".concat(e,"-").concat(r),name:"col-".concat(r),type:"col-item",style:{verticalAlign:"middle",textAlign:"center",width:i*t/o,border:Object(kt["d"])(n.initialBorder)},subs:[],controls:[]}}))},checkMove:function(t){if(this.$el==t.to||this.$el.compareDocumentPosition(t.to)&Node.DOCUMENT_POSITION_CONTAINED_BY)return!1;var e=t.draggedContext.element;return!(1==e.cols&&!t.to.classList.contains("level-0")&&!t.to.parentElement.classList.contains("acc-item"))&&(!("acc-layout"==e.type&&!t.to.classList.contains("level-0"))&&void 0)},onDragStart:function(){this.layoutDragStart()},onDragEnd:function(){this.layoutDragEnd()},log:function(){var t;(t=console).log.apply(t,arguments)}})},Pt=It,At=Object(gt["a"])(Pt,Ot,Dt,!1,null,null,null),Et=At.exports,Lt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"left-panel"},[t.baseControls.length?n("Accordion",{attrs:{title:"基础控件"}},[n("draggable",{staticClass:"control-drag-area",attrs:{list:t.baseControls,group:{name:"control",pull:"clone",put:!1},swapThreshold:"0.3",sort:!1,clone:t.createControl,emptyInsertThreshold:20,move:t.checkMove},on:{change:t.log}},t._l(t.baseControls,(function(e){return n("div",{key:e.type,staticClass:"template-item control-tpl-item",attrs:{"data-control-type":e.type,title:e.name}},[n("span",{staticClass:"template-item-icon control",class:e.icon}),n("span",{staticClass:"template-item-name"},[t._v(t._s(e.name))])])})),0)],1):t._e(),t.extControls.length?n("Accordion",{attrs:{title:"扩展控件"}},[n("draggable",{staticClass:"control-drag-area",attrs:{list:t.extControls,group:{name:"control",pull:"clone",put:!1},swapThreshold:"0.3",sortable:!1,clone:t.createControl,move:t.checkMove},on:{change:t.log}},t._l(t.extControls,(function(e){return n("div",{key:e.type,staticClass:"template-item control-tpl-item",attrs:{"data-control-type":e.type,title:e.name}},[n("span",{staticClass:"template-item-icon control",class:e.icon}),n("span",{staticClass:"template-item-name"},[t._v(t._s(e.name))])])})),0)],1):t._e(),t.commonControls.length?n("Accordion",{attrs:{title:"通用字段"}},[t._l(t.commonControlsTree,(function(e){return[n("h3",{key:"header-"+e.id,staticClass:"common-control-catalog"},[t._v(t._s(e.name))]),n("draggable",{key:"body-"+e.id,staticClass:"control-drag-area",attrs:{list:e.children,group:{name:"control",pull:"clone",put:!1},swapThreshold:"0.3",sortable:!1,clone:t.createdCommonControl,move:t.checkMove},on:{change:t.log}},t._l(e.children,(function(o){return n("div",{key:e.id+o.name+o.type,staticClass:"template-item control-tpl-item",attrs:{"data-control-type":o.type,title:o.name}},[n("span",{staticClass:"template-item-icon control",class:o.icon}),n("span",{staticClass:"template-item-name"},[t._v(t._s(o.name))])])})),0)]}))],2):t._e()],1)},$t=[],Mt=(n("57e7"),{methods:{createControl:function(t){var e=t.type,n=t.icon,o=t.name,i=window.FORM_DESIGN_CONFIG.controls[e];if(!i)throw new Error("控件的 ".concat(e," 配置信息不存在，无法创建"));var r=Object(kt["d"])(i);delete r.configItems;var a=kt["c"].getIndex(e),l=Object(kt["l"])();return r.id=e+"-"+l,r.namePrefix=o,r.autoIndex=a,r.name="",r.icon=n,r.width||(r.width="100%"),-1!=["title","label","output"].indexOf(e)&&this.copyGlobalStyleToControl(r),r},copyGlobalStyleToControl:function(t){var e=this.$store.state.globalStyle,n=e.fontSize,o=e.fontFamily,i=e.fontColor,r=e.fontBolder,a=e.fontItalic,l=e.fontUnderline;e.textAlign,e.verticalAlign;"label"==t.type&&(t.fontSize=n),t.fontFamily=o,t.fontColor=i,t.fontBolder=r,t.fontItalic=a,t.fontUnderline=l}}}),Ft=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"accordion"},[n("div",{staticClass:"accordion-header"},[n("span",{staticClass:"accordion-title"},[t._v(t._s(t.title))]),n("span",{staticClass:"accordion-toggle el-icon-arrow-down",class:{collaspe:t.collaspe},on:{click:function(e){t.collaspe=!t.collaspe}}})]),n("transition",{on:{"before-enter":t.beforeEnter,enter:t.enter,"after-enter":t.afterEnter,"before-leave":t.beforeLeave,leave:t.leave,"after-leave":t.afterLeave}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!t.collaspe,expression:"!collaspe"}],ref:"body",staticClass:"accordion-body",class:{collaspe:t.collaspe}},[t._t("default")],2)])],1)},Rt=[],Nt={name:"accordion",props:{title:{type:String,required:!0}},data:function(){return{collaspe:!1,inGroup:!1}},mounted:function(){"accordion-group"==this.$parent.$options.name&&(this.inGroup=!0)},methods:{beforeEnter:function(t){t.classList.add("collapse-transition"),t.dataset||(t.dataset={}),t.dataset.oldPaddingTop=t.style.paddingTop,t.dataset.oldPaddingBottom=t.style.paddingBottom,t.style.height="0",t.style.paddingTop=0,t.style.paddingBottom=0,t.style.opacity=0},enter:function(t){t.dataset.oldOverflow=t.style.overflow,0!==t.scrollHeight?(t.style.height=t.scrollHeight+"px",t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom):(t.style.height="",t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom),t.style.opacity=1,t.style.overflow="hidden"},afterEnter:function(t){t.classList.remove("collapse-transition"),t.style.height="",t.style.overflow=t.dataset.oldOverflow,t.style.opacity=""},beforeLeave:function(t){t.dataset||(t.dataset={}),t.dataset.oldPaddingTop=t.style.paddingTop,t.dataset.oldPaddingBottom=t.style.paddingBottom,t.dataset.oldOverflow=t.style.overflow,t.style.height=t.scrollHeight+"px",t.style.overflow="hidden",t.style.opacity=1},leave:function(t){0!==t.scrollHeight&&t.classList.add("collapse-transition"),t.style.height=0,t.style.paddingTop=0,t.style.paddingBottom=0,t.style.opacity=0},afterLeave:function(t){t.style.height="",t.style.overflow=t.dataset.oldOverflow,t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom,t.style.opacity=""},setCollaspe:function(t){this.collaspe=void 0!==t?!!t:!this.collaspe}},watch:{collaspe:function(t){this.inGroup&&this.$parent.updateStatus(t,this),this.$emit("change",t)}}},Vt=Nt,Bt=(n("5443"),Object(gt["a"])(Vt,Ft,Rt,!1,null,null,null)),zt=Bt.exports,Ht=window.FORM_DESIGN_CONFIG.controlList,Gt={name:"panel-control",components:{Accordion:zt},data:function(){return{baseControls:Object(kt["d"])(Ht)}},computed:{extControls:function(){return this.$store.state.extControls},commonControls:function(){return this.$store.state.commonControls},commonControlsTree:function(){var t=this.commonControls,e={};return t.forEach((function(t){var n=t.businessType,o=t.businessName;n&&o&&(e[n]||(e[n]={id:n,name:o,children:[]}),e[n].children.push(t))})),Object.keys(e).map((function(t){return e[t]}))}},mixins:[pt,Mt],mounted:function(){this.update()},methods:{update:function(){this.dispatch("accordion","updated")},createdCommonControl:function(t){var e=this.createControl(t),n=Object(kt["d"])(t.props),o={};return Object.keys(e).forEach((function(t){o[t.toLowerCase()]=t})),Object.keys(n).forEach((function(t){var i=t.toLowerCase(),r=o[i];r?e[r]=n[t]:e[t]=n[t]})),void 0!==t.fieldName&&(e.fieldName=t.fieldName),void 0!==t.universalId&&(e.universalId=t.universalId),t.name&&!e.name&&(e.name=t.name),e},checkMove:function(t){if(this.$el==t.to||this.$el.compareDocumentPosition(t.to)&Node.DOCUMENT_POSITION_CONTAINED_BY)return!1;var e=t.draggedContext.element;return!("hiddenfield"===e.type^t.to.classList.contains("design-hidden-area"))},log:function(){var t;(t=console).log.apply(t,arguments)}},watch:{extControls:function(){this.update()},baseControls:function(){this.update()},commonControls:function(){this.update()}}},qt=Gt,Ut=Object(gt["a"])(qt,Lt,$t,!1,null,null,null),Wt=Ut.exports,Jt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"left-panel"},[t._l(t.tables,(function(e){return n("Accordion",{key:e.id,attrs:{title:e.name+"中的字段"}},[n("draggable",{staticClass:"control-drag-area mis-field-list",attrs:{list:e.fields,group:{name:"control",pull:"clone",put:!1},swapThreshold:"0.3",sort:!1,clone:t.createFieldControl,emptyInsertThreshold:20,filter:".disabled",move:t.checkMove},on:{filter:t.onFilter}},t._l(e.fields,(function(o){return n("div",{key:e.id+o.field,staticClass:"template-item data-tpl-item",class:{disabled:t.selectedFieldMap["#"+(e.sqltablename||"")+";#"+(o.fieldname||"")]},attrs:{"data-control-type":o.fielddisplaytype}},[n("div",{staticClass:"template-item-inner"},[n("span",{staticClass:"template-item-icon control",class:t.getControlIcon({type:o.fielddisplaytype})}),n("span",{staticClass:"template-item-name"},[t._v(t._s(o.name))]),n("span",{staticClass:"template-item-type"},[t._v("["+t._s(t.controlCNameMap[o.fielddisplaytype]||"文本框")+"]")])])])})),0)],1)})),n("Accordion",{attrs:{title:"已使用的字段"}},[n("draggable",{staticClass:"data-drag-area",attrs:{list:t.dataList,group:{name:"data",pull:"clone",put:!1},swapThreshold:"0.3",sort:!1,clone:t.createArea,emptyInsertThreshold:20,move:t.checkMove,filter:".disabled"},on:{change:t.log,filter:t.onFilter}},t._l(t.dataList,(function(e){return n("div",{key:e.id,staticClass:"template-item data-tpl-item",class:{disabled:t.usedMap[e.id]},attrs:{"data-control-type":e.type}},[n("span",{staticClass:"template-item-icon control",class:e.icon}),n("span",{staticClass:"template-item-name"},[t._v(t._s(t._f("getName")(e)))]),n("span",{staticClass:"template-item-type"},[t._v("["+t._s(t.controlCNameMap[e.type]||e.type)+"]")])])})),0)],1)],2)},Yt=[];function Xt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Kt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Xt(Object(n),!0).forEach((function(e){Object(at["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Qt={title:"",label:"",textbox:"textbox",textarea:"textarea",spinner:"spinner",radiobuttonlist:"radio",checkboxlist:"check",combobox:"drop",buttonedit:"drop",datepicker:"date",daterangepicker:"dates",monthpicker:"month",macro:"macro",organizationselect:"person",treeselect:"tree",webuploader:"upload",subtable:"subtable",ewebeditor:"ewebeditor",output:"output",hiddenfield:"textbox"},Zt=window.FORM_DESIGN_CONFIG.controlList,te={name:"panel-data",data:function(){return{}},mixins:[Mt],components:{Accordion:zt},computed:Kt(Kt(Kt({},Object(_t["c"])(["allControls","selectedFieldMap"])),Object(_t["e"])(["hiddenControls","mobileDesignData"])),{},{dataList:function(){var t=this.allControls,e=[];return t.forEach((function(t){"label"!=t.type&&"title"!=t.type&&e.push(Object(kt["d"])(t))})),e},controlCNameMap:function(){var t={};return Zt.forEach((function(e){t[e.type]=e.name})),this.$store.state.extControls.forEach((function(e){t[e.type]=e.name})),t},usedMap:function(){var t={};return this.mobileDesignData.forEach((function(e){var n=e.control;n&&(t[n.id]=!0)})),t},tables:function(){var t=Object(kt["d"])(this.$store.state.fieldList);return t.forEach((function(t,e){t.fields.forEach((function(e){e.actualId="#".concat(t.sqltablename||"",";#").concat(e.fieldname||"")}))})),t}}),filters:{getName:function(t){return t.name||t.namePrefix}},methods:{createArea:function(t){var e={labelText:t.name||"".concat(t.namePrefix||"控件","_").concat(t.autoIndex||1)};return{label:e,visible:!0,control:Object(kt["d"])(t)}},log:function(){var t;(t=console).log.apply(t,["cahnge"].concat(Array.prototype.slice.call(arguments)))},checkMove:function(t){if(this.$el==t.to||this.$el.compareDocumentPosition(t.to)&Node.DOCUMENT_POSITION_CONTAINED_BY)return!1;var e=t.draggedContext.element;return!("hiddenfield"===e.type^t.to.classList.contains("design-hidden-area"))},onFilter:function(t){if(t.target.classList.contains("disabled"))return!1},getControlIcon:function(t){return Qt[t.type]||""},createFieldControl:function(t){var e=t.fielddisplaytype||"textbox",n={type:e,name:this.controlCNameMap[e],icon:this.getControlIcon({type:e})},o=this.createControl(n);return void 0!==o.bind&&(o.bind=t.actualId),void 0!==o.required&&(o.required=t.required),t.datasource&&void 0!==o.codeItem&&(o.codeItem=t.datasource),t.multiSelect&&void 0!==o.multiSelect&&(o.multiSelect=t.multiSelect),t.mode&&void 0!==o.mode&&(o.mode=t.mode),o.name=o.name=t.name,o}}},ee=te,ne=(n("ef38"),Object(gt["a"])(ee,Jt,Yt,!1,null,null,null)),oe=ne.exports,ie=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"designArea",staticClass:"design-area",staticStyle:{position:"relative"},style:{width:t.size.width+20+"px"},attrs:{id:"design-area","data-width":t.size.width,"data-height":t.size.height},on:{click:t.handleFormClick}},[n("RowLayout",{attrs:{list:t.data}}),n("HelperLine",{directives:[{name:"show",rawName:"v-show",value:t.showVLine,expression:"showVLine"}],attrs:{type:"v"}}),n("HelperLine",{directives:[{name:"show",rawName:"v-show",value:t.showHLine,expression:"showHLine"}],attrs:{type:"h"}}),n("draggable",{staticClass:"design-hidden-area",attrs:{group:"control",move:t.checkControlMove},model:{value:t.hiddenControls,callback:function(e){t.hiddenControls=e},expression:"hiddenControls"}},t._l(t.hiddenControls,(function(e,o){return n("Control",{key:e.id,class:{selected:e.id==t.selectedControlId},attrs:{"control-data":e},nativeOn:{click:function(n){return n.stopPropagation(),t.onControlClick(e,o,t.hiddenControls)}}})})),1),n("div",{domProps:{innerHTML:t._s(t.colBorderStyle)}}),n("v-contextmenu",{ref:"ctxMenu"},[n("v-contextmenu-item",{on:{click:function(e){return t.ctxMneuItemHandle("insertRowUp")}}},[t._v("向上插入1行")]),n("v-contextmenu-item",{on:{click:function(e){return t.ctxMneuItemHandle("insertRowDown")}}},[t._v("向下插入1行")]),n("v-contextmenu-item",{attrs:{divider:""}}),n("v-contextmenu-item",{attrs:{disabled:"row-layout"!=t.ctxMenuData.type},on:{click:function(e){return t.ctxMneuItemHandle("insertColLeft")}}},[t._v("向左插入1列")]),n("v-contextmenu-item",{attrs:{disabled:"row-layout"!=t.ctxMenuData.type},on:{click:function(e){return t.ctxMneuItemHandle("insertColRight")}}},[t._v("向右插入1列")]),n("v-contextmenu-item",{attrs:{divider:""}}),n("v-contextmenu-item",{attrs:{disabled:!t.ctxMenuData.isControl},on:{click:function(e){return t.ctxMneuItemHandle("deleteControl")}}},[t._v("删除控件")]),n("v-contextmenu-item",{attrs:{disabled:!t.ctxMenuData.colDeletable||t.ctxMenuData.isControl},on:{click:function(e){return t.ctxMneuItemHandle("removeCol")}}},[t._v(t._s("acc-layout"==t.ctxMenuData.type?"删除此手风琴项":"删除此列"))]),n("v-contextmenu-item",{attrs:{disabled:t.ctxMenuData.isControl},on:{click:function(e){return t.ctxMneuItemHandle("removeRow")}}},[t._v(t._s("acc-layout"==t.ctxMenuData.type?"删除此手风琴":"删除此行"))]),t.ctxMenuData.isCol?n("v-contextmenu-item",{attrs:{divider:""}}):t._e(),t.ctxMenuData.isCol?n("v-contextmenu-item",{attrs:{disabled:t.ctxMenuData.isControl||t.ctxMenuData.hasControl},on:{click:function(e){return t.handleQuickSplit()}}},[t._v("快速拆分")]):t._e()],1),n("el-dialog",{staticClass:"multi-row-dialog",attrs:{"append-to-body":"",title:"请输入行列",visible:t.dialogVisible,width:"460px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("el-form",{attrs:{model:t.rowData,size:"mini",inline:"","inline-message":""}},[n("el-form-item",{attrs:{label:"行数目"}},[n("el-input-number",{attrs:{min:1,max:20,controls:!1,autocomplete:"off"},model:{value:t.rowData.rowCount,callback:function(e){t.$set(t.rowData,"rowCount",e)},expression:"rowData.rowCount"}})],1),n("el-form-item",{attrs:{label:"列数目"}},[n("el-input-number",{attrs:{min:1,max:20,controls:!1},model:{value:t.rowData.colCount,callback:function(e){t.$set(t.rowData,"colCount",e)},expression:"rowData.colCount"}})],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.handleDialogClose("cancel")}}},[t._v("取 消")]),n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.handleDialogClose("ok")}}},[t._v("确 定")])],1)],1)],1)},re=[],ae=n("eafa"),le=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"helper-line",class:{"line-v":"v"===t.type,"line-h":"h"===t.type},style:t.styleText})},se=[],ce={props:{type:{type:String,default:"v"}},computed:{left:function(){return this.$store.state.helper.left},top:function(){return this.$store.state.helper.top},styleText:function(){return"v"==this.type?"left: ".concat(this.left,"px;"):"h"==this.type?"top: ".concat(this.top,"px;"):""}}},ue=ce,de=(n("d56b"),Object(gt["a"])(ue,le,se,!1,null,null,null)),fe=de.exports,pe=n("a3de");function he(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function me(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?he(Object(n),!0).forEach((function(e){Object(at["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):he(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ge={name:"design",components:{RowLayout:ae["default"],HelperLine:fe,Control:pe["a"]},provide:function(){var t=this;return{getDesignContainer:function(){return t.$refs.designArea},showCtxMenu:this.showCtxMenu,hideCtxMenu:this.hideCtxMenu,showMutliRowConfirm:this.showMutliRowConfirm}},props:{data:{type:Array},size:{type:Object}},data:function(){return{ctxMneuItemHandle:function(){},ctxMenuData:{isControl:!1,colDeletable:!0,type:"row-layout",hasControl:!1,isCol:!1},rowData:{rowCount:1,colCount:1},dialogVisible:!1,dialogOkCallback:function(){}}},computed:me(me({},Object(_t["e"])({showVLine:function(t){return t.helper.showVLine},showHLine:function(t){return t.helper.showHLine}})),{},{selectedControlId:function(){return this.$store.state.selectedControlId},hiddenControls:{get:function(){return this.$store.state.hiddenControls},set:function(t){this.$store.commit("setHiddenControls",t)}},colBorderStyle:function(){return"<style>"+this.$store.getters.colStyleText+"</style>"}}),methods:me(me({},Object(_t["b"])(["setSelectedControl","setSelectedLayout","activeRightTab"])),{},{onControlClick:function(t,e,n){this.setSelectedControl({id:t.id}),this.activeRightTab("control")},checkControlMove:function(t){if(!t.to.classList.contains("design-hidden-area"))return!1},handleFormClick:function(t){var e=t.target;e.closest(".row")||this.activeRightTab("form")},showMutliRowConfirm:function(t){this.dialogVisible=!0,this.dialogOkCallback=t},adjustCtxPos:function(t,e){var n=this;this.$nextTick((function(){var o={top:e,left:t},i=n.$refs.ctxMenu.$el.clientWidth,r=n.$refs.ctxMenu.$el.clientHeight;r+e>=window.innerHeight&&(o.top-=r),i+t>=window.innerWidth&&(o.left-=i),n.$refs.ctxMenu.$el.style.top="".concat(o.top,"px"),n.$refs.ctxMenu.$el.style.left="".concat(o.left,"px")}))},showCtxMenu:function(t,e,n){this.ctxMenuData.isControl=!!e.control,this.ctxMenuData.colDeletable=e.colDeletable,this.ctxMenuData.type=e.row.type||"row-layout",this.ctxMenuData.hasControl=e.hasControl,this.ctxMenuData.isCol=!this.ctxMenuData.isControl&&"row-layout"==this.ctxMenuData.type,this.ctxMneuItemHandle=n;var o=t.pageX,i=t.pageY;this.$refs.ctxMenu.show({top:i,left:o}),this.adjustCtxPos(o,i)},hideCtxMenu:function(){this.$refs.ctxMenu.hide()},handleDialogClose:function(t){this.dialogVisible=!1;var e=this.rowData,n=e.rowCount,o=e.colCount;"ok"==t&&this.dialogOkCallback(n,o),this.rowData.rowCount=1,this.rowData.colCount=1},handleQuickSplit:function(){var t=this;this.rowData.rowCount=2,this.rowData.colCount=2,this.showMutliRowConfirm((function(){t.rowData;var e=t.rowData,n=e.rowCount,o=e.colCount;n&&o&&(1!==n||1===o?t.ctxMneuItemHandle("insertMultiRowCol",{rowCount:n,colCount:o}):t.ctxMneuItemHandle("insertMultiCol",{colCount:o}))}))}})},ve=ge,be=(n("026d"),n("f1a3"),Object(gt["a"])(ve,ie,re,!1,null,null,null)),ye=be.exports,Ce=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mobile-designer-area"},[n("div",{staticClass:"right-fixed-area"},[n("el-tooltip",{attrs:{placement:"top",enterable:!1,"open-delay":300,content:"一键同步"}},[n("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:t.onSyncCLick}})],1)],1),n("Device",{attrs:{type:"iphone-8",color:"silver"}},[n("draggable",{staticClass:"mobile-form-container",attrs:{group:"data",list:t.list,direction:"vertical",filter:".hide"},on:{add:t.onDataAdd,sort:t.onMobileControlSort,filter:t.onFilter}},t._l(t.list,(function(e,o){return n("div",{key:"item-"+o,staticClass:"mobile-form-item",class:t.getCls(e,o),attrs:{"data-index":o}},[n("label",{staticClass:"mobile-form-label"},[e.label?n("span",[t._v(t._s(t._f("removeLineFeed")(e.label.labelText)))]):t._e()]),n("span",{staticClass:"mobile-form-control"},[e.control?n("MobileControl",{attrs:{"control-data":e.control}}):t._e()],1),n("div",{staticClass:"mobile-form-helper row-helper"},[n("el-tooltip",{attrs:{placement:"top",enterable:!1,"open-delay":300,content:"切换显示"}},[n("span",{staticClass:"row-helper-btn view el-icon-view",on:{click:function(n){return t.onVisibleChange(e,o)}}})]),n("el-tooltip",{attrs:{placement:"top",enterable:!1,"open-delay":300,content:"选择"}},[n("span",{staticClass:"row-helper-btn selected el-icon-top-left",on:{click:function(n){return n.stopPropagation(),t.onItemClick(e,o)}}})])],1)])})),0)],1)],1)},we=[],xe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(t.getControlComponent(t.controlData.type),{tag:"component",attrs:{"control-data":t.controlData}})},Oe=[],De=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mui-card"},[n("div",{staticClass:"mui-input-group ep-mui-radiobuttonlist"},t._l(t.dataList,(function(e){return n("div",{key:e.id,staticClass:"mui-input-row mui-radio"},[n("label",[t._v(t._s(e.text))]),n("input",{attrs:{type:"radio",name:t.controlData.id},domProps:{value:e.id}}),n("span",{staticClass:"el-radio__inner"})])})),0)])},_e=[],ke=n("ab9e"),Se={props:["controlData"],mixins:[ke["a"]],data:function(){return{currValue:this.controlData.value||"",defaultDataList:[1,2,3].map((function(t){return{id:t,text:"选项-"+t}})),originData:[]}},created:function(){this.getDataList()}},je=Se,Te=(n("6da2"),Object(gt["a"])(je,De,_e,!1,null,null,null)),Ie=Te.exports,Pe=["controlData"],Ae={title:{props:Pe,template:'<span class="mobile-form-title">{{controlData.textContent || ""}}</span>'},textbox:{props:Pe,template:'<input type="text" :placeholder="controlData.emptyText || controlData.type" />'},textarea:{props:Pe,template:'<textarea :placeholder="controlData.emptyText || controlData.type" ></textarea>'},radiobuttonlist:Ie,checkboxlist:Ie,webuploader:{props:Pe,template:'<div class="uploader-wrap"><span class="uploader-btn"></span></div>'}},Ee={props:Pe,template:'<input type="text" :placeholder="controlData.emptyText || controlData.type" />'},Le={name:"mobile-control",props:Pe,methods:{getControlComponent:function(t){return t in Ae?Ae[t]:Ee}}},$e=Le,Me=(n("1f0e"),Object(gt["a"])($e,xe,Oe,!1,null,null,null)),Fe=Me.exports,Re=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"device",class:t.className},[n("div",{staticClass:"device-frame"},[n("div",{staticClass:"device-content"},[t._t("default")],2)]),n("div",{staticClass:"device-stripe"}),n("div",{staticClass:"device-header"}),n("div",{staticClass:"device-sensors"}),n("div",{staticClass:"device-btns"}),n("div",{staticClass:"device-power"})])},Ne=[],Ve=(n("7d5a"),{name:"device",props:{type:{type:String,default:"iphone-8"},color:{type:String,default:"silver"}},computed:{className:function(){return"device-".concat(this.type," device-").concat(this.color)}}}),Be=Ve,ze=Object(gt["a"])(Be,Re,Ne,!1,null,null,null),He=ze.exports;function Ge(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function qe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ge(Object(n),!0).forEach((function(e){Object(at["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ge(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ue=Object.prototype.hasOwnProperty,We={name:"mobile-design",components:{MobileControl:Fe,Device:He},data:function(){return{list:[],activeIndex:-1}},computed:qe({},Object(_t["e"])(["mobileDesignData"])),filters:{removeLineFeed:function(t){return t&&t+""===t?t.replace(/\\n/g,"").replace(/ /g,"&nbsp;"):""}},methods:{getCls:function(t,e){var n;return n={hide:!t.visible},Object(at["a"])(n,t.control&&t.control.type,!0),Object(at["a"])(n,"active",this.activeIndex===e),Object(at["a"])(n,"only-control",t.control&&!t.label),Object(at["a"])(n,"only-label",t.label&&!t.control),n},dealData:function(t){return t.map((function(t){return Ue.call(t,"visible")||(t.visible=!0),t}))},pc2mobile:function(){var t=this;return this.loading=!0,this.$parent.getData({withBuild:!1}).then((function(e){return t.$httpPost(window.formDesignerActions.pc2mobileUrl,e)})).then((function(e){t.list=t.dealData(e.mobileDesignData),t.restorePcSelected()})).finally((function(){t.loading=!1}))},onSyncCLick:function(){var t=this;this.$msgbox({title:"提示",message:"是否按照当前PC表单配置，同步生成移动端表单？（该操作将覆盖现有移动表单配置）",confirmButtonText:"同步并覆盖",showCancelButton:!0,cancelText:"取消",iconClass:"el-icon-question",callback:function(e){"confirm"==e&&t.pc2mobile()}})},initSync:function(){var t=this;this.$msgbox({title:"初始化",message:"可按照pc表单配置，快速完成移动端表单初始化",confirmButtonText:"一键初始化",showCancelButton:!0,cancelText:"取消",iconClass:"el-icon-question",callback:function(e){"confirm"==e&&t.pc2mobile()}})},onVisibleChange:function(t,e){t.visible=!t.visible},onItemClick:function(t,e){this.activeIndex=e,t.control&&t.control.id?this.$store.commit({type:"setSelectedControl",id:t.control.id}):this.$store.commit({type:"clearSelectedControl"})},onDataAdd:function(t){window.FORM_DESIGNER_ANALYSIS.mobileDesignAdd=!0},onMobileControlSort:function(){window.FORM_DESIGNER_ANALYSIS.mobileDesignMoved=!0},onFilter:function(t){if(t.target.classList.contains("hide"))return!1},restorePcSelected:function(){var t=this.$store.state.selectedControlId;if(t){for(var e=this.list.length-1;e>=0;e--){var n=this.list[e];if(n.control&&n.control.id==t)return void(this.activeIndex=e)}this.activeIndex=-1}else this.activeIndex=-1}},mounted:function(){window.FORM_DESIGNER_ANALYSIS.mobileDesignEntered=!0,this.mobileDesignData.length?(this.list=this.mobileDesignData,this.restorePcSelected()):this.initSync(),this.$store.commit("activeLeftTab","data"),this.$store.commit("activeRightTab","control")},watch:{list:{deep:!0,handler:function(t){this.$store.commit({type:"replaceMobileDesign",mobileDesignData:t})}}}},Je=We,Ye=(n("e4ac"),n("f4d4"),n("b2ce"),Object(gt["a"])(Je,Ce,we,!1,null,"b6c62ce2",null)),Xe=Ye.exports,Ke=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(t.componentName,{tag:"component",staticClass:"config-cell",attrs:{selectedCol:t.selectedCol}})},Qe=[],Ze=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("\n      手风琴项配置\n      "),n("el-tooltip",{attrs:{"open-delay":50,content:"复制ID"}},[n("span",{staticClass:"el-icon-copy-document acc-copy-id",on:{click:t.copyId}})])],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("手风琴标题")]),n("div",{staticClass:"form-control"},[n("div",{staticClass:"form-control-item"},[n("el-input",{on:{blur:t.submitTitle},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1)])]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("默认展开")]),n("div",{staticClass:"form-control"},[n("div",{staticClass:"form-control-item"},[n("el-switch",{model:{value:t.opened,callback:function(e){t.opened=e},expression:"opened"}})],1)])])])])},tn=[],en={name:"config-acc-item",props:["selectedCol"],data:function(){var t=this.selectedCol.props;return{title:t.title,opened:t.opened}},methods:{submitTitle:function(){var t=this.title;if(!t||""==t.trim())return this.$message({title:"系统提醒",message:"名称不能为空",type:"error",showClose:!0});var e="acc-item-name";this.$store.commit("setColProps",{value:t,prop:"props.title",group:e,col:this.selectedCol}),t&&this.$store.commit("setColProps",{value:t,prop:"name",group:e,col:this.selectedCol})},submitOpend:function(t){this.$store.commit("setColProps",{value:t,prop:"props.opened",col:this.selectedCol})},copyId:function(){if(this.selectedCol){var t=this.selectedCol.id,e=document.createElement("input");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("COPY"),this.$message({message:"手风琴ID已复制到剪贴版",type:"success"}),e.parentNode.removeChild(e)}}},watch:{opened:function(t){this.submitOpend(t)},"selectedCol.props":function(){var t=this.selectedCol.props;this.title=t.title,this.opened=t.opened}}},nn=en,on=(n("76fd"),Object(gt["a"])(nn,Ze,tn,!1,null,"70c5360e",null)),rn=on.exports,an=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.selectedCol?n("div",[n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("\n      对齐\n    ")]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("对齐")]),n("AlignButton",{attrs:{type:"horizontal"},model:{value:t.textAlign,callback:function(e){t.textAlign=e},expression:"textAlign"}}),n("AlignButton",{attrs:{type:"vertical"},model:{value:t.verticalAlign,callback:function(e){t.verticalAlign=e},expression:"verticalAlign"}})],1)]),n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("\n      边框\n      "),n("el-tooltip",{attrs:{content:"normal"==t.currentView?"切换到详细模式":"切换到简易模式"}},[n("span",{staticClass:"border-config-toggle el-icon-d-arrow-right",on:{click:t.toggleView}})])],1),"normal"==t.currentView?n("div",[n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线宽")]),n("BorderWidthSelect",{attrs:{"border-color":t.borderColor,"border-style":t.borderStyle},model:{value:t.borderWidth,callback:function(e){t.borderWidth=e},expression:"borderWidth"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线型")]),n("BorderStyleSelect",{attrs:{"border-width":t.borderWidth,"border-color":t.borderColor,disabled:!t.borderWidth},on:{change:t.onBorderStyleChange},model:{value:t.borderStyle,callback:function(e){t.borderStyle=e},expression:"borderStyle"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("颜色")]),n("ColorPicker",{model:{value:t.borderColor,callback:function(e){t.borderColor=e},expression:"borderColor"}})],1)]):t._e(),"advance"==t.currentView?n("div",[n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("边框——上")]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线宽")]),n("BorderWidthSelect",{attrs:{"border-color":t.border.top.color},on:{change:function(e){return t.onBorderChange("top","width",e)}},model:{value:t.border.top.width,callback:function(e){t.$set(t.border.top,"width",e)},expression:"border.top.width"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线性")]),n("BorderStyleSelect",{attrs:{"border-color":t.border.top.color,disabled:!t.border.top.width},on:{change:function(e){return t.onBorderChange("top","style",e)}},model:{value:t.border.top.style,callback:function(e){t.$set(t.border.top,"style",e)},expression:"border.top.style"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("颜色")]),n("ColorPicker",{attrs:{disabled:!t.border.top.width},on:{change:function(e){return t.onBorderChange("top","color",e)}},model:{value:t.border.top.color,callback:function(e){t.$set(t.border.top,"color",e)},expression:"border.top.color"}})],1)]),n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("边框——右")]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线宽")]),n("BorderWidthSelect",{attrs:{"border-color":t.border.right.color},on:{change:function(e){return t.onBorderChange("right","width",e)}},model:{value:t.border.right.width,callback:function(e){t.$set(t.border.right,"width",e)},expression:"border.right.width"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线性")]),n("BorderStyleSelect",{attrs:{"border-color":t.border.right.color,disabled:!t.border.right.width},on:{change:function(e){return t.onBorderChange("right","style",e)}},model:{value:t.border.right.style,callback:function(e){t.$set(t.border.right,"style",e)},expression:"border.right.style"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("颜色")]),n("ColorPicker",{attrs:{disabled:!t.border.right.width},on:{change:function(e){return t.onBorderChange("right","color",e)}},model:{value:t.border.right.color,callback:function(e){t.$set(t.border.right,"color",e)},expression:"border.right.color"}})],1)]),n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("边框——下")]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线宽")]),n("BorderWidthSelect",{attrs:{"border-color":t.border.bottom.color},on:{change:function(e){return t.onBorderChange("bottom","width",e)}},model:{value:t.border.bottom.width,callback:function(e){t.$set(t.border.bottom,"width",e)},expression:"border.bottom.width"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线性")]),n("BorderStyleSelect",{attrs:{"border-color":t.border.bottom.color,disabled:!t.border.bottom.width},on:{change:function(e){return t.onBorderChange("bottom","style",e)}},model:{value:t.border.bottom.style,callback:function(e){t.$set(t.border.bottom,"style",e)},expression:"border.bottom.style"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("颜色")]),n("ColorPicker",{attrs:{disabled:!t.border.bottom.width},on:{change:function(e){return t.onBorderChange("bottom","color",e)}},model:{value:t.border.bottom.color,callback:function(e){t.$set(t.border.bottom,"color",e)},expression:"border.bottom.color"}})],1)]),n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("边框——左")]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线宽")]),n("BorderWidthSelect",{attrs:{"border-color":t.border.left.color},on:{change:function(e){return t.onBorderChange("left","width",e)}},model:{value:t.border.left.width,callback:function(e){t.$set(t.border.left,"width",e)},expression:"border.left.width"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线性")]),n("BorderStyleSelect",{attrs:{"border-color":t.border.left.color,disabled:!t.border.left.width},on:{change:function(e){return t.onBorderChange("left","style",e)}},model:{value:t.border.left.style,callback:function(e){t.$set(t.border.left,"style",e)},expression:"border.left.style"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("颜色")]),n("ColorPicker",{attrs:{disabled:!t.border.left.width},on:{change:function(e){return t.onBorderChange("left","color",e)}},model:{value:t.border.left.color,callback:function(e){t.$set(t.border.left,"color",e)},expression:"border.left.color"}})],1)])]):t._e()])]):t._e()},ln=[],sn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"design-button-group align-group",class:t.type,attrs:{"data-value":t.active}},t._l(t.alignList,(function(e){return n("el-tooltip",{key:e,attrs:{"open-delay":500,content:t.tipsText[e]}},[n("MyButton",{class:{active:t.active==e},attrs:{icon:"align-"+e},nativeOn:{click:function(n){return t.activeBtn(e)}}})],1)})),1)},cn=[],un=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"design-button"},[t.icon?n("span",{staticClass:"design-button-icon",class:t.icon}):t._e(),t._t("default")],2)},dn=[],fn={name:"design-button",props:{icon:{type:String}}},pn=fn,hn=Object(gt["a"])(pn,un,dn,!1,null,null,null),mn=hn.exports,gn={name:"align-button",components:{MyButton:mn},props:{type:{type:String,default:"horizontal",validator:function(t){var e=-1!==["horizontal","vertical"].indexOf(t);return e||console.error("type 应为 'horizontal' 或 'vertical'"),e}},value:{type:String,default:function(){return"horizontal"==this.type?"left":"vertical"==this.type?"middle":void 0}}},computed:{alignList:function(){return"horizontal"==this.type?["left","center","right"]:"vertical"==this.type?["top","middle","bottom"]:void 0}},data:function(){return{active:this.value,tipsText:{left:"左对齐",center:"居中对齐",right:"右对齐",top:"顶端对齐",middle:"垂直居中",bottom:"底端对齐"}}},watch:{value:function(){this.active=this.value},active:function(t){this.$emit("input",t)}},methods:{activeBtn:function(t){this.active=t}}},vn=gn,bn=Object(gt["a"])(vn,sn,cn,!1,null,null,null),yn=bn.exports,Cn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"colorpicker",staticClass:"color-picker",class:{disabled:t.disabled}},[n("span",{staticClass:"color-picker-toggle",on:{click:function(e){return t.togglePicker()}}},[t._t("default",[n("div",{staticClass:"current-color",style:"background-color: "+t.colorValue},[n("span",{staticClass:"current-color-value"},[t._v(t._s(t.colorValue.toLowerCase()))]),n("label",{staticClass:"current-color-label"},[t._v(t._s(t.label))])])])],2),n("div",{directives:[{name:"show",rawName:"v-show",value:t.displayPicker,expression:"displayPicker"}],ref:"panel",staticClass:"color-picker-panel"},[t.displayPicker?n("Chrome",{staticClass:"color-picker-chrome",attrs:{value:t.colors,disableAlpha:t.disableAlpha},on:{input:t.updateFromPicker}}):t._e()],1)])},wn=[],xn=(n("6b54"),n("87b3"),n("28a5"),n("c345")),On={name:"color-picker",components:{Chrome:xn["Chrome"]},props:{value:{type:String,default:""},label:{type:String,default:""},referColor:{type:String,default:""},disabled:{type:Boolean,default:!1}},data:function(){return{disableAlpha:!0,colors:{hex:"#000000"},colorValue:"",displayPicker:!1}},mounted:function(){this.setColor(this.value||"#000000"),this.setStyle()},methods:{setStyle:function(){var t=this.value;if("#"==t[0]){var e=[0,1,2].map((function(e,n){return parseInt(t.substr(2*n+1,2),16)||0})),n="drop-shadow(2px 2px 6px rgba( ".concat(e.join(",")," ,.15)");this.$refs.colorpicker.style.setProperty("--color",t),this.$refs.colorpicker.style.setProperty("--dropShadow",n),this.$refs.colorpicker.style.setProperty("--red",e[0]),this.$refs.colorpicker.style.setProperty("--green",e[1]),this.$refs.colorpicker.style.setProperty("--blue",e[2])}},isValid:function(t){return!this.disableAlpha||/^#[0-9a-f]{6}$/i.test(t)},setColor:function(t){this.updateColors(t),this.colorValue=t},updateColors:function(t){if("#"==t.slice(0,1))this.colors={hex:t.substr(0,7)};else if("rgba"==t.slice(0,4)){var e=t.replace(/^rgba?\(|\s+|\)$/g,"").split(","),n="#"+((1<<24)+(parseInt(e[0])<<16)+(parseInt(e[1])<<8)+parseInt(e[2])).toString(16).slice(1);this.colors={hex:n,a:e[3]}}},showPicker:function(){document.addEventListener("click",this.documentClick,!0),this.displayPicker=!0},hidePicker:function(){document.removeEventListener("click",this.documentClick,!0),this.displayPicker=!1},togglePicker:function(){this.disabled||(this.displayPicker?this.hidePicker():this.showPicker())},updateFromPicker:function(t){this.disableAlpha&&(t.rgba.a=1),this.colors=t,1==t.rgba.a?this.colorValue=t.hex:this.colorValue="rgba("+t.rgba.r+", "+t.rgba.g+", "+t.rgba.b+", "+t.rgba.a+")",this.$emit("input",this.colorValue)},documentClick:function(t){var e=this.$refs.colorpicker,n=this.$refs.panel,o=t.target;e&&(e===o||e.contains(o)||n.contains(o)||this.hidePicker())},adjustPos:function(){var t=this.$el.getBoundingClientRect(),e=t.top+t.height,n=t.left,o=this.$refs.panel,i=o.clientHeight,r=o.clientWidth;e+i>=window.innerHeight&&(e=t.top-i),n+r>=window.innerWidth&&(n-=n+r-window.innerWidth),o.style.top="".concat(e,"px"),o.style.left="".concat(n,"px")},change:function(t){this.$emit("change",t)}},watch:{value:function(t,e){this.setColor(this.value||"#000000"),this.setStyle(),t!=e&&this.$emit("change",t)},colorValue:function(t){t&&(this.updateColors(t),this.setStyle(),this.$emit("input",t))},displayPicker:function(t){var e=this;t?this.$nextTick((function(){document.body.appendChild(e.$refs.panel),e.$refs.panel.style.position="fixed",e.$refs.panel.style.display="block",e.adjustPos()})):(this.$refs.panel.style.display="none",this.$refs.panel.style.top="-99999px",this.$refs.panel.style.left="-99999px")}}},Dn=On,_n=(n("5908"),n("b8b5"),Object(gt["a"])(Dn,Cn,wn,!1,null,null,null)),kn=_n.exports,Sn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"border-style-select",class:{disabled:t.disabled}},[n("el-select",{staticStyle:{width:"100px"},attrs:{disabled:t.disabled,placeholder:"请选择",size:"small"},on:{change:t.change},model:{value:t.borderStyle,callback:function(e){t.borderStyle=e},expression:"borderStyle"}},t._l(t.borderStyleList,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label||e.value,title:e.label||e.value,value:e.value}},[e.value?n("span",{staticClass:"border-style-option",style:"border-top-color:"+t.borderColor+";border-top-width:"+(t.borderWidth||3)+"px;border-top-style:"+e.value+";"}):t._e()])})),1),n("span",{staticClass:"border-style-select-curr",style:t.selectedStyle})],1)},jn=[],Tn={name:"border-style-select",props:["value","borderColor","disabled"],data:function(){return{borderWidth:4,borderStyle:this.value,borderStyleList:["solid","dashed","dotted","double"].map((function(t){return{value:t}}))}},watch:{value:function(t){t!=this.borderStyle&&(this.borderStyle=t)},borderStyle:function(t){this.$emit("input",t)}},methods:{change:function(t){this.$emit("change",t)}},computed:{selectedStyle:function(){return"border-top-style:".concat(this.borderStyle,";border-top-color:").concat(this.borderColor,";border-top-width:").concat(this.borderWidth||3,"px;")}}},In=Tn,Pn=Object(gt["a"])(In,Sn,jn,!1,null,null,null),An=Pn.exports,En=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"border-width-select",class:{disabled:t.disabled,none:0==t.borderWidth,normal:0!=t.borderWidth}},[n("el-select",{staticStyle:{width:"100px"},attrs:{disabled:t.disabled,placeholder:"请选择",size:"small"},on:{change:t.change},model:{value:t.borderWidth,callback:function(e){t.borderWidth=e},expression:"borderWidth"}},t._l(t.borderWidthList,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label||e.value,value:e.value}},[e.value?n("span",{staticClass:"border-width-select-option",style:t.selectedStyle(e.value),attrs:{title:e.label||e.value}}):t._e(),e.value?t._e():n("span",{staticClass:"border-width-select-option-none",style:"color:"+t.borderColor,attrs:{title:e.label}},[t._v(t._s(e.label))])])})),1),n("span",{staticClass:"border-width-select-curr",style:t.selectedStyle()})],1)},Ln=[],$n={name:"border-width-select",props:["value","borderColor","disabled"],data:function(){return{borderStyle:"solid",borderWidth:this.value,borderWidthList:[{label:"none",value:0},{value:1},{value:2},{value:3},{value:4},{value:5}]}},watch:{value:function(t){t!=this.borderWidth&&(this.borderWidth=t)},borderWidth:function(t){this.$emit("input",t)}},methods:{selectedStyle:function(t){return void 0===t&&(t=this.borderWidth),"border-top-style:".concat(this.borderStyle,";border-top-color:").concat(this.borderColor,";border-top-width:").concat(t,"px")},change:function(t){this.$emit("change",t)}}},Mn=$n,Fn=Object(gt["a"])(Mn,En,Ln,!1,null,null,null),Rn=Fn.exports;function Nn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Vn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Nn(Object(n),!0).forEach((function(e){Object(at["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Nn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Bn={name:"config-col",components:{AlignButton:yn,ColorPicker:kn,BorderStyleSelect:An,BorderWidthSelect:Rn},props:["selectedCol"],computed:{},data:function(){return this.getShowData()},methods:Vn(Vn(Vn({},Object(_t["d"])(["setColBorder","setColStyle"])),Object(_t["b"])(["setColAllBorder","setColBorderDetail"])),{},{getShowData:function(){if(!this.selectedCol)return{};var t=Object(kt["d"])(this.selectedCol.style.border),e=t.bottom.width,n=t.bottom.style,o=t.bottom.color;return{textAlign:this.selectedCol.style.textAlign||"left",verticalAlign:this.selectedCol.style.verticalAlign||"middle",border:t,borderWidth:e,borderStyle:n,borderColor:o,currentView:"normal"}},toggleView:function(){this.currentView="normal"==this.currentView?"advance":"normal"},onBorderChange:function(t,e,n){this.setColBorderDetail({dir:t,prop:e,value:n,selectedCol:this.selectedCol,group:"adv-border"}),"style"==e&&"double"==n&&this.border[t].width<4&&this.showBorderStyleMessage()},onBorderStyleChange:function(t){"double"==t&&this.borderWidth<4&&this.showBorderStyleMessage()},showBorderStyleMessage:function(){this.$message({type:"info",message:"双线边框效果仅可在边框宽度大于3px时呈现"})}}),watch:{selectedCol:function(t,e){if(this.selectedCol){var n=Object(kt["d"])(this.selectedCol.style.border),o=n.bottom.width,i=n.bottom.style,r=n.bottom.color;e?(this.border=n,this.verticalAlign=this.selectedCol.style.verticalAlign,this.textAlign=this.selectedCol.style.textAlign,this.borderWidth=o,this.borderStyle=i,this.borderColor=r):(this.$set(this,"border",n),this.$set(this,"verticalAlign",this.selectedCol.style.verticalAlign),this.$set(this,"textAlign",this.selectedCol.style.textAlign),this.$set(this,"borderWidth",o),this.$set(this,"borderStyle",i),this.$set(this,"borderColor",r))}},borderWidth:function(t){this.setColAllBorder({prop:"width",value:t})},borderStyle:function(t){this.setColAllBorder({prop:"style",value:t})},borderColor:function(t){this.setColAllBorder({prop:"color",value:t})},textAlign:function(t){var e;t!=this.selectedCol.style.textAlign&&((e=console).log.apply(e,["设置对齐"].concat(Array.prototype.slice.call(arguments))),this.setColStyle({prop:"textAlign",value:t,selectedCol:this.selectedCol,shuttle:!0}))},verticalAlign:function(t){var e;t!=this.selectedCol.style.verticalAlign&&((e=console).log.apply(e,["设置对齐"].concat(Array.prototype.slice.call(arguments))),this.setColStyle({prop:"verticalAlign",value:t,selectedCol:this.selectedCol,shuttle:!0}))}}},zn=Bn,Hn=Object(gt["a"])(zn,an,ln,!1,null,null,null),Gn=Hn.exports,qn={name:"config-cell",components:{ConfigAccItem:rn,ConfigCol:Gn},props:["selectedCol"],computed:{type:function(){var t=this.selectedCol.type;return t||"col-item"},componentName:function(){return"acc-item"==this.type?rn:"col-item"==this.type?Gn:""}}},Un=qn,Wn=Object(gt["a"])(Un,Ke,Qe,!1,null,null,null),Jn=Wn.exports,Yn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"config-form"},[n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("\n      全局文字\n      "),n("el-tooltip",{attrs:{placement:"right",content:"将影响所有控件"}},[n("span",{staticClass:"design-help"})])],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("字体")]),n("el-select",{staticClass:"font-set-select",attrs:{size:"small"},model:{value:t.fontFamily,callback:function(e){t.fontFamily=e},expression:"fontFamily"}},t._l(t.fontFamilyList,(function(t){return n("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})})),1),n("el-input-number",{staticClass:"font-set-input",attrs:{size:"small",controls:!1,min:12,max:100},model:{value:t.fontSize,callback:function(e){t.fontSize=e},expression:"fontSize"}}),n("span",{staticClass:"form-control-suffix"},[t._v("px")])],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("样式")]),n("FontColor",{staticStyle:{"margin-right":"10px"},model:{value:t.fontColor,callback:function(e){t.fontColor=e},expression:"fontColor"}}),n("div",{staticClass:"design-button-group font-group"},[n("el-tooltip",{attrs:{"open-delay":500,content:"加粗"}},[n("MyButton",{class:{active:t.fontBolder},attrs:{icon:"font-bold"},nativeOn:{click:function(e){t.fontBolder=!t.fontBolder}}})],1),n("el-tooltip",{attrs:{"open-delay":500,content:"倾斜"}},[n("MyButton",{class:{active:t.fontItalic},attrs:{icon:"font-italic"},nativeOn:{click:function(e){t.fontItalic=!t.fontItalic}}})],1),n("el-tooltip",{attrs:{"open-delay":500,content:"下划线"}},[n("MyButton",{class:{active:t.fontUnderline},attrs:{icon:"font-underline"},nativeOn:{click:function(e){t.fontUnderline=!t.fontUnderline}}})],1)],1)],1)]),n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("\n      全局单元格\n      "),n("el-tooltip",{attrs:{placement:"right",content:"将影响所有单元格"}},[n("span",{staticClass:"design-help"})])],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("对齐")]),n("AlignButton",{attrs:{type:"horizontal"},model:{value:t.textAlign,callback:function(e){t.textAlign=e},expression:"textAlign"}}),n("AlignButton",{attrs:{type:"vertical"},model:{value:t.verticalAlign,callback:function(e){t.verticalAlign=e},expression:"verticalAlign"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("高度")]),n("el-input-number",{staticClass:"height-set-input",attrs:{size:"small",controls:!1,min:t.MIN_ROW_HEIGHT,max:2e3},on:{change:t.setHeight},model:{value:t.height,callback:function(e){t.height=e},expression:"height"}}),n("span",{staticClass:"form-control-suffix"},[t._v("px")])],1)]),n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("\n      全局边框\n      "),n("el-tooltip",{attrs:{placement:"right",content:"将影响所有单元格"}},[n("span",{staticClass:"design-help"})])],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线宽")]),n("BorderWidthSelect",{attrs:{"border-color":t.borderColor,"border-style":t.borderStyle},model:{value:t.borderWidth,callback:function(e){t.borderWidth=e},expression:"borderWidth"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线性")]),n("BorderStyleSelect",{attrs:{"border-width":t.borderWidth,"border-color":t.borderColor,disabled:!t.borderWidth},on:{change:t.onBorderStyleChange},model:{value:t.borderStyle,callback:function(e){t.borderStyle=e},expression:"borderStyle"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("颜色")]),n("ColorPicker",{attrs:{disabled:!t.borderWidth},model:{value:t.borderColor,callback:function(e){t.borderColor=e},expression:"borderColor"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("外边框")]),n("AllBorderType",{staticClass:"form-control",attrs:{"border-type":t.allBorderType},on:{active:t.handleBorderTypeChange}})],1)]),n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("控件配置")]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("label自动冒号")]),n("el-switch",{attrs:{"border-color":t.borderColor,"border-style":t.borderStyle},model:{value:t.autoColons,callback:function(e){t.autoColons=e},expression:"autoColons"}})],1)]),n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("预设风格")]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("风格选择")]),n("el-select",{staticStyle:{width:"120px","margin-right":"10px",display:"inline-block"},on:{change:t.onSkinChange},model:{value:t.currentSkin,callback:function(e){t.currentSkin=e},expression:"currentSkin"}},t._l(t.skins,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})),1),n("el-button",{attrs:{type:"primary",disabled:!t.isNewSkin},on:{click:t.createNewSkin}},[t._v("存为新风格")])],1)])])},Xn=[],Kn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ColorPicker",{model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}},[n("span",{staticClass:"font-color-button design-button"},[n("span",{staticClass:"font-color-holder design-button-icon"}),n("span",{staticClass:"font-current-color",style:"background:"+t.currentValue})])])},Qn=[],Zn={name:"control-font-color",props:["value"],components:{ColorPicker:kn},data:function(){return{currentValue:this.value||"#000"}},watch:{value:function(t){this.currentValue=t},currentValue:function(t){this.$emit("input",t)}}},to=Zn,eo=Object(gt["a"])(to,Kn,Qn,!1,null,null,null),no=eo.exports,oo=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"form-control-item  form-all-border"},t._l(t.list1,(function(e){return n("el-tooltip",{key:e,attrs:{"open-delay":500,placement:"top",content:t.tipsText[e]}},[n("MyButton",{class:{active:e==t.currentType},attrs:{icon:"all-border-"+e},nativeOn:{click:function(n){return t.handleChange(e)}}})],1)})),1),n("div",{staticClass:"form-control-item form-all-border"},t._l(t.list2,(function(e){return n("el-tooltip",{key:e,attrs:{"open-delay":500,placement:"top",content:t.tipsText[e]}},[n("MyButton",{class:{active:e==t.currentType},attrs:{icon:"all-border-"+e},nativeOn:{click:function(n){return t.handleChange(e)}}})],1)})),1)])},io=[],ro={name:"form-all-border-config",components:{MyButton:mn},props:{borderType:{type:String,default:"all"}},data:function(){return{currentType:this.borderType,list1:["all","inner","hline","vline","outer"],list2:["left","top","right","bottom","none"],tipsText:{all:"全部框线",inner:"仅内框线",hline:"仅水平线",vline:"仅垂直线",outer:"仅外边框",left:"仅左框线",top:"仅上框线",right:"仅右框线",bottom:"仅底框线",none:"无框线"}}},methods:{handleChange:function(t){this.currentType=t,this.$emit("active",t)}},watch:{borderType:function(t){this.currentType=t}}},ao=ro,lo=Object(gt["a"])(ao,oo,io,!1,null,null,null),so=lo.exports;function co(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function uo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?co(Object(n),!0).forEach((function(e){Object(at["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):co(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var fo=Object(kt["d"])(window.FORM_DESIGN_CONFIG.preset.fontFamilyList),po={name:"config-form",components:{AlignButton:yn,FontColor:no,BorderStyleSelect:An,BorderWidthSelect:Rn,MyButton:mn,ColorPicker:kn,AllBorderType:so},computed:uo(uo({},Object(_t["e"])(["globalStyle","skin"])),{},{fontFamilyList:function(){return fo}}),mounted:function(){this.getSkinList()},data:function(){var t=this.globalStyle||this.$store.state.globalStyle,e=t.border;return{MIN_ROW_HEIGHT:St["b"],currentSkin:this.skin||"",skins:[],isNewSkin:!1,height:t.cellHeight||St["b"],borderWidth:e.top.width||1,borderStyle:e.top.style||"solid",borderColor:e.top.color||"#dddddd",fontSize:t.fontSize,fontFamily:t.fontFamily,fontColor:t.fontColor,fontBolder:t.fontBolder,fontItalic:t.fontItalic,fontUnderline:t.fontUnderline,textAlign:t.textAlign,verticalAlign:t.verticalAlign,autoColons:t.autoColons,allBorderType:t.allBorderType||"all",heightPerset:{selected:"compact",list:[{label:"紧凑",value:"compact"},{label:"2倍",value:40},{label:"50",value:50},{label:"自定义",value:30}]}}},methods:uo(uo({},Object(_t["b"])({setBorder:"setGlobalBorder",setStyle:"setGlobalStyle"})),{},{getSkinList:function(){var t=this;return this.$httpPost(window.formDesignerActions.getSkinListUrl).then((function(e){Array.isArray(e.skinList)?t.skins=e.skinList:t.skins=[]}))},onBorderStyleChange:function(t){"double"==t&&this.borderWidth<4&&this.$message({type:"info",message:"双线边框效果仅可在边框宽度大于3px时呈现"})},onSkinChange:function(t){var e=this,n=this.skins.filter((function(e){return e.id==t}))[0];if(n&&n.data){var o=Object(kt["d"])(n.data);this.$store.dispatch({type:"applySkin",skinData:o,skin:this.currentSkin}),this.$nextTick((function(){e.isNewSkin=!1}))}},createNewSkin:function(){var t=this;this.$prompt("请输入新风格名称","创建新风格",{confirmButtonText:"确定",cancelButtonText:"取消",inputValidator:function(t){return t&&t.trim()?!!/^[\d\w-_\u4E00-\u9FA5]+$/.test(t)||"风格名称格式不正确":"风格名称不能为空"}}).then((function(e){var n=e.value;t.saveNewSkin(n)}))},saveNewSkin:function(t){var e=this,n=Object(kt["d"])(this.globalStyle);return delete n.cellHeight,this.$httpPost(window.formDesignerActions.addSkinUrl,{skinName:t,data:n}).then((function(o){e.currentSkin=o.id,e.skins.push({id:e.currentSkin,name:t,data:n}),e.$nextTick((function(){e.isNewSkin=!1})),e.$message({type:"success",message:"保存成功"})})).catch((function(t){console.error(t),e.$message({type:"error",message:"保存失败"})}))},getData:function(){var t=this.globalStyle||this.$store.state.globalStyle,e=t.border;return{height:t.cellHeight||St["b"],borderWidth:e.top.width||1,borderStyle:e.top.style||"solid",borderColor:e.top.color||"#dddddd",fontSize:t.fontSize,fontFamily:t.fontFamily,fontColor:t.fontColor,fontBolder:t.fontBolder,fontItalic:t.fontItalic,fontUnderline:t.fontUnderline,textAlign:t.textAlign,verticalAlign:t.verticalAlign,autoColons:t.autoColons}},handleChange:function(t,e){t!==this.globalStyle[e]&&this.setStyle({prop:e,value:t})},setHeight:function(t){this.$store.dispatch("setAllRowHeight",{height:t})},handleBorderTypeChange:function(t){this.isNewSkin=!0,this.borderWidth,this.$store.dispatch("setAllBorderType",{type:t,borderWidth:this.borderWidth})}}),watch:{globalStyle:function(t){var e=t.border;this.height=t.cellHeight||St["b"],this.borderWidth=e.top.width||1,this.borderStyle=e.top.style||"solid",this.borderColor=e.top.color||"#dddddd",this.fontSize=t.fontSize,this.fontFamily=t.fontFamily,this.fontColor=t.fontColor,this.fontBolder=t.fontBolder,this.fontItalic=t.fontItalic,this.fontUnderline=t.fontUnderline,this.textAlign=t.textAlign,this.verticalAlign=t.verticalAlign,this.autoColons=t.autoColons,this.allBorderType!=t.allBorderType&&(this.allBorderType=t.allBorderType,this.handleBorderTypeChange(this.allBorderType))},borderWidth:function(t){this.isNewSkin=!0,this.setBorder({prop:"width",value:t})},borderStyle:function(t){this.isNewSkin=!0,this.setBorder({prop:"style",value:t})},borderColor:function(t){this.isNewSkin=!0,this.setBorder({prop:"color",value:t})},autoColons:function(t){this.isNewSkin=!0,this.handleChange(t,"autoColons")},fontSize:function(t){this.isNewSkin=!0,this.handleChange(t,"fontSize")},fontFamily:function(t){this.isNewSkin=!0,this.handleChange(t,"fontFamily")},fontColor:function(t){this.isNewSkin=!0,this.handleChange(t,"fontColor")},fontBolder:function(t){this.isNewSkin=!0,this.handleChange(t,"fontBolder")},fontItalic:function(t){this.isNewSkin=!0,this.handleChange(t,"fontItalic")},fontUnderline:function(t){this.isNewSkin=!0,this.handleChange(t,"fontUnderline")},textAlign:function(t){this.isNewSkin=!0,this.handleChange(t,"textAlign")},verticalAlign:function(t){this.isNewSkin=!0,this.handleChange(t,"verticalAlign")},skin:{immediate:!0,handler:function(t){t!==this.currentSkin&&(this.isNewSkin=!1,this.currentSkin=t)}}}},ho=po,mo=Object(gt["a"])(ho,Yn,Xn,!1,null,null,null),go=mo.exports,vo=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.control?n("div",{staticClass:"config-control"},[n("NameConfig",{attrs:{"component-data":t.control,type:t.controlType},on:{change:t.onNameChange,remove:t.removeControl}}),t.supportEvent?n("div",{staticClass:"config-control-tabs"},[n("span",{staticClass:"config-control-tab",class:{active:"attribute"==t.currentView},on:{click:function(e){t.currentView="attribute"}}},[t._v("属性")]),n("span",{staticClass:"config-control-tab",class:{active:"event"==t.currentView},on:{click:function(e){t.currentView="event"}}},[t._v("事件("+t._s(t.eventCount)+")")])]):t._e(),n("div",{staticClass:"config-control-tabcontent",class:{"with-event":t.supportEvent}},["attribute"==t.currentView?n("div",{staticClass:"attribute-block"},t._l(t.controlConfig,(function(e,o){return n("div",{key:o,staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v(t._s(e.category))]),t._l(e.items,(function(e){return n("div",{key:e.label||e.extends+"",class:{"form-item":!e.extends,"form-extend":!!e.extends}},[t._l(t.getExtends(e.extends),(function(e){return n(t.getControlComponent(e),{key:t.control.id+"-"+e,tag:"component",attrs:{"control-data":t.control},on:{change:t.handleExtendChange}})})),e.extends?t._e():n("label",{staticClass:"form-label"},[t._v(t._s(e.label))]),e.extends?t._e():n("div",{staticClass:"form-control"},t._l(e.controls,(function(e){return n(t.getControlComponent(e.type),{key:t.control.id+"-"+e.associatedProp,tag:"component",staticClass:"form-control-item",class:e.type,attrs:{config:e,value:t.getControlValue(t.control,e)},on:{change:t.change}})})),1)],2)}))],2)})),0):t._e(),"event"==t.currentView?n("div",{staticClass:"event-block"},[n("EventComponent",{attrs:{"control-data":t.control}})],1):t._e()])],1):t._e()},bo=[],yo=(n("759f"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"component-name-config config-block"},[n("h3",{staticClass:"component-type config-category"},[t._v("\n    "+t._s(t.type)+"\n    "),n("span",{staticClass:"remove-component",on:{click:t.onComponentRemove}},[t._v("删除")])]),n("div",{staticClass:"component-name-block"},[n("div",{directives:[{name:"show",rawName:"v-show",value:!t.showEditor,expression:"!showEditor"}],staticClass:"component-name",attrs:{title:t.name},on:{click:function(e){t.editorValue=t.name,t.showEditor=!0}}},[t._v(t._s(t.name))]),t.showEditor?n("div",[n("div",{staticClass:"el-input el-input--mini",staticStyle:{width:"50%","margin-right":"6px"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.editorValue,expression:"editorValue"}],staticClass:"el-input__inner",attrs:{size:"mini"},domProps:{value:t.editorValue},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submitName(e)},input:function(e){e.target.composing||(t.editorValue=e.target.value)}}})]),n("el-button",{attrs:{icon:"el-icon-check",size:"mini",circle:""},on:{click:t.submitName}})],1):t._e()])])}),Co=[],wo={name:"name-config",props:["componentData","type"],computed:{},data:function(){return{name:this.componentData.name||this.getComponentName(),showEditor:!1,editorValue:""}},methods:{getComponentName:function(){var t=this.componentData,e=t.namePrefix,n=t.autoIndex;return e&&n?"".concat(e).concat(n):this.type},onComponentRemove:function(){this.$emit("remove")},change:function(t){this.$emit("change",t)},submitName:function(){var t=this.editorValue.trim();return t?/^[^\d][\d\w\u4E00-\u9FA5]+$/.test(t)?(this.componentData.name!=t&&(this.name=t,this.change(t)),void(this.showEditor=!1)):this.$message({message:"组件名称不合法，只接受非数字开头的汉字、字母、数字组合",type:"error",showClose:!0}):this.$message({message:"必须输入组件件名称",type:"error",showClose:!0})}},watch:{"componentData.id":function(){this.showEditor=!1,this.name=this.componentData.name||this.getComponentName()}}},xo=wo,Oo=(n("d5c7"),Object(gt["a"])(xo,yo,Co,!1,null,null,null)),Do=Oo.exports,_o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-checkbox",{attrs:{value:t.value},on:{change:t.change}},[t._v(t._s(t.config.text))])},ko=[],So={name:"control-checkbox",props:{value:{type:Boolean,require:!0},config:{type:Object,require:!0}},methods:{change:function(t){this.$emit("change",t,this.config)}}},jo=So,To=Object(gt["a"])(jo,_o,ko,!1,null,null,null),Io=To.exports,Po=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-checkbox-group",{class:"direction-"+t.direction,on:{change:t.change},model:{value:t.valueList,callback:function(e){t.valueList=e},expression:"valueList"}},t._l(t.optionList,(function(e){return n("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])})),1)},Ao=[],Eo=n("da81"),Lo=n.n(Eo),$o={methods:{getOriginData:function(t,e){var n,o=this;if(!t)throw new Error("url is required!");e&&(n=Lo()({},e)),this.loading=!0,this.$httpPost(t,n).then((function(t){var e=[];if(!Array.isArray(t))throw new Error("远程数据必须为数组");return t.forEach((function(t){void 0!==t.id&&void 0!==t.text?e.push(t):console.warn("id or text is not a valid type! ".concat(JSON.stringify(t)))})),o.loading=!1,o.originOptionList=e,e})).catch((function(t){o.loading=!1,console.error(t)}))}}},Mo=window.FORM_DESIGN_CONFIG.preset,Fo={name:"control-checkboxlist",mixins:[$o],props:{value:{type:String,require:!0},config:{type:Object,require:!0},styleText:{type:String,default:"width:200px"}},data:function(){return{valueList:this.getValueList(),loading:!1,originOptionList:[]}},created:function(){!this.config.data&&this.config.url&&this.getOriginData(this.config.url)},computed:{direction:function(){return this.config.direction||"horizontal"},optionList:function(){return this.config.data?this.staticOptionList:this.originOptionList},staticOptionList:function(){var t=this.config.data;if(!t)return[];if(Array.isArray(t))return t;var e=t+""===t;if(e){if(t in Mo)return Mo[t];var n=t.replace(/^epointsform\./,"");if(n&&Array.isArray(this.$store.state[n]))return Object(kt["d"])(this.$store.state[n])}return[]}},methods:{getValueList:function(){return this.value?this.value.split(","):[]},change:function(t){this.$emit("change",t.join(","),this.config)}}},Ro=Fo,No=Object(gt["a"])(Ro,Po,Ao,!1,null,null,null),Vo=No.exports,Bo=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-select",{style:t.styleText,attrs:{value:t.value,size:"small",filterable:"",clearable:""},on:{change:t.change}},t._l(t.optionList,(function(t){return n("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})})),1)},zo=[],Ho=window.FORM_DESIGN_CONFIG.preset,Go={name:"control-combobox",mixins:[$o],props:{value:{type:String,require:!0},config:{type:Object,require:!0},styleText:{type:String,default:""}},data:function(){return{loading:!1,originOptionList:[]}},created:function(){!this.config.data&&this.config.url&&this.getOriginData(this.config.url)},computed:{optionList:function(){return this.config.data?this.staticOptionList:this.originOptionList},staticOptionList:function(){var t=this.config.data;if(!t)return[];if(Array.isArray(t))return t;var e=t+""===t;if(e){if(t in Ho)return Ho[t];var n=t.replace(/^epointsform\./,"");if(n&&Array.isArray(this.$store.state[n]))return Object(kt["d"])(this.$store.state[n])}return[]}},methods:{change:function(t){this.$emit("change",t,this.config)}}},qo=Go,Uo=Object(gt["a"])(qo,Bo,zo,!1,null,null,null),Wo=Uo.exports,Jo=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{},[n("el-select",{staticStyle:{display:"block"},attrs:{size:"small"},on:{change:t.typeChange},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},t._l(t.typeList,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1),t.type==t.TYPE_MAP.date?n("el-date-picker",{staticStyle:{"margin-top":"8px"},attrs:{"popper-class":"default-date-popper",type:"datetime",placeholder:"请选择一个日期",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",editable:!1,size:"small"},on:{change:t.dateChange},model:{value:t.selectDate,callback:function(e){t.selectDate=e},expression:"selectDate"}}):t._e()],1)},Yo=[];function Xo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Ko(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Xo(Object(n),!0).forEach((function(e){Object(at["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xo(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Qo="[currDate]",Zo=/^\d{4}-\d{2}-\d{2}/,ti={empty:"empty",currDate:"currDate",date:"date"},ei={name:"control-default-date",props:["config","value"],data:function(){return Ko(Ko({},this.getDataFromValue(this.value)),{},{TYPE_MAP:ti,typeList:[{id:ti.empty,text:"留空"},{id:ti.currDate,text:"填报日期"},{id:ti.date,text:"指定日期"}]})},methods:{getDataFromValue:function(t){return t?/^\[.+\]$/.test(t)?{selectDate:"",type:ti.currDate}:{selectDate:this.getValidDate(t),type:ti.date}:{selectDate:"",type:ti.empty}},getValidDate:function(t){return Zo.test(t)?t:""},typeChange:function(t){return"empty"==t?this.change(""):"currDate"==t?this.change(Qo):"date"==t&&this.selectDate?this.change(this.selectDate):void 0},dateChange:function(){"date"==this.type&&this.change(this.selectDate)},change:function(t){this.$emit("change",t,this.config)}},watch:{value:function(t){var e=this.getDataFromValue(t);e.type!=this.type&&(this.type=e.type),e.selectDate!=this.selectDate&&(this.selectDate=e.selectDate)}}},ni=ei,oi=(n("d482"),Object(gt["a"])(ni,Jo,Yo,!1,null,null,null)),ii=oi.exports,ri=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-select",{attrs:{size:"small"},on:{change:t.configTypeChange},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},t._l(t.typeList,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1),t.type==t.typeMap.select?n("div",{staticStyle:{"margin-top":"8px"}},[n("el-input",{attrs:{placeholder:"请选择",value:t.selectedTypes.join(","),size:"small",readonly:""}},[n("el-button",{attrs:{slot:"append",icon:"el-icon-more"},nativeOn:{click:function(e){return t.showDialog(e)}},slot:"append"})],1)],1):t._e(),t.type==t.typeMap.input?n("div",{staticStyle:{"margin-top":"8px"}},[n("el-input",{attrs:{placeholder:"请输入文件扩展名",size:"small"},on:{change:t.userInputChange},model:{value:t.userInputType,callback:function(e){t.userInputType=e},expression:"userInputType"}}),n("el-tooltip",{attrs:{placement:"top",content:"扩展名不带点，多个逗号分隔"}},[n("span",{staticClass:"design-help"})])],1):t._e(),n("el-dialog",{attrs:{visible:t.dialogVisible,title:"类型选择","append-to-body":""},on:{"update:visible":function(e){t.dialogVisible=e}}},[t.type==t.typeMap.select?n("div",{staticClass:"tree-like"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.dialogSelectedTypes.length,expression:"dialogSelectedTypes.length"}],staticStyle:{"margin-bottom":"10px"}},t._l(t.dialogSelectedTypes,(function(e){return n("el-tag",{key:e,staticStyle:{"margin-right":"4px"},attrs:{size:"mini",closable:""},on:{close:function(n){return t.hanldeRemoveTag(e)}}},[t._v(t._s(e))])})),1),t._l(t.dialogTypeTree,(function(e){return n("div",{key:e.id,staticStyle:{"margin-bottom":"10px"}},[n("div",{staticClass:"file-type-category"},[n("el-checkbox",{attrs:{indeterminate:e.halfChecked,label:e.text},on:{change:function(n){return t.cateCheckedChange(n,e)}},model:{value:e.allChecked,callback:function(n){t.$set(e,"allChecked",n)},expression:"cate.allChecked"}})],1),n("el-checkbox-group",{staticClass:"file-type-group",on:{change:function(n){return t.itemCheckedChange(n,e)}},model:{value:e.checkedArr,callback:function(n){t.$set(e,"checkedArr",n)},expression:"cate.checkedArr"}},t._l(e.items,(function(t){return n("el-checkbox",{key:t.id,staticClass:"file-type-item",attrs:{label:t.id}})})),1)],1)}))],2):t._e(),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:t.submitSelect}},[t._v("确 定")])],1)])],1)},ai=[];n("ac4d"),n("8a81"),n("1c4c");function li(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=si(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,r=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw r}}}}function si(t,e){if(t){if("string"===typeof t)return ci(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ci(t,e):void 0}}function ci(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var ui="[default]",di={default:"default",empty:"empty",select:"select",input:"input"},fi={name:"control-file-type-picker",props:["config","value"],computed:{selectedTypes:function(){if(this.type!=this.typeMap.select)return[];var t=[];return this.typeTree.forEach((function(e){e.checkedArr&&e.checkedArr.length&&t.push.apply(t,Object(rt["a"])(e.checkedArr))})),t},dialogSelectedTypes:function(){if(this.type!=this.typeMap.select)return[];var t=[];return this.dialogTypeTree.forEach((function(e){e.checkedArr&&e.checkedArr.length&&t.push.apply(t,Object(rt["a"])(e.checkedArr))})),t}},data:function(){return{typeMap:di,dialogVisible:!1,userInputType:"",type:"",typeList:[{id:"default",text:"系统默认"},{id:"empty",text:"不限制"},{id:"select",text:"选择类型"},{id:"input",text:"手动输入"}],typeTree:this.genderTypeTree(this.value),dialogTypeTree:[]}},created:function(){this.type=this.getTypeFromValue(this.value),this.syncConfigValue()},methods:{syncConfigValue:function(){this.type==di.default||this.type==di.empty?this.userInputType="":this.type==di.select?(this.userInputType="",this.typeTree=this.genderTypeTree(this.value)):this.userInputType=this.value},getFileTypeMap:function(){var t={};return this.typeTree.forEach((function(e){e.valueArr.forEach((function(e){t[e]=!0}))})),t},getTypeFromValue:function(t){if(t==ui)return di.default;if(""==t)return di.empty;var e,n=t.split(","),o=this.getFileTypeMap(),i=li(n);try{for(i.s();!(e=i.n()).done;){var r=e.value;if(!o[r])return di.input}}catch(a){i.e(a)}finally{i.f()}return di.select},genderTypeTree:function(t){var e=this,n=[],o=Object(kt["d"])(window.FORM_DESIGN_CONFIG.preset["epointsform.fileTypes"]),i=(t||"").split(",");return o.forEach((function(t){t.valueArr=t.items,t.items=e.genderItems(t.valueArr);var o=[];t.valueArr.forEach((function(t){-1!==i.indexOf(t)&&o.push(t)})),t.checkedArr=o,0===t.checkedArr.length?t.allChecked=t.halfChecked=!1:t.checkedArr.length!==t.valueArr.length?(t.allChecked=!1,t.halfChecked=!0):(t.allChecked=!0,t.halfChecked=!1),n.push(t)})),n},genderItems:function(t){return t.map((function(t){return{id:t,text:t}}))},cateCheckedChange:function(t,e){var n;t?(e.allChecked=!0,e.halfChecked=!1,(n=e.checkedArr).splice.apply(n,[0,e.checkedArr.length].concat(Object(rt["a"])(e.valueArr)))):(e.allChecked=!1,e.halfChecked=!1,e.checkedArr.splice(0,e.checkedArr.length))},itemCheckedChange:function(t,e){var n;(n=console).log.apply(n,arguments),t.length==e.items.length?(e.allChecked=!0,e.halfChecked=!1):t.length?(e.allChecked=!1,e.halfChecked=!0):(e.allChecked=!1,e.halfChecked=!1)},hanldeRemoveTag:function(t){var e,n,o=li(this.dialogTypeTree);try{for(o.s();!(n=o.n()).done;){var i=n.value;if(e=i.checkedArr.indexOf(t),-1!==e){i.allChecked=!1,i.checkedArr.splice(e,1),i.halfChecked=0!==i.checkedArr.length&&i.checkedArr.length!=i.valueArr.length;break}}}catch(r){o.e(r)}finally{o.f()}},configTypeChange:function(t){return t==di.default?this.change(ui):t==di.empty?this.change(""):t==di.input?this.userInputType&&this.change(this.userInputType):t==di.select?this.change(this.selectedTypes.join(",")):void 0},userInputChange:function(t){if(this.type==di.input)return this.change(this.userInputType)},change:function(t){this.$emit("change",t,this.config)},showDialog:function(){this.dialogTypeTree=Object(kt["d"])(this.typeTree),this.dialogVisible=!0},submitSelect:function(){this.dialogVisible=!1,this.change(this.dialogSelectedTypes.join(","))}},watch:{selectedTypes:function(t){},value:function(){this.type=this.getTypeFromValue(this.value),this.type==di.select&&(this.typeTree=this.genderTypeTree(this.value))}}},pi=fi,hi=(n("2e74"),Object(gt["a"])(pi,ri,ai,!1,null,null,null)),mi=hi.exports,gi=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"control-form-bind"},[n("div",{staticClass:"form-control-item"},[n("el-select",{style:t.styleText,attrs:{value:t.value,size:"small",clearable:"",placeholder:"请选择关联字段",filterable:""},on:{change:t.change}},t._l(t.tables,(function(e,o){return n("el-option-group",{key:e.sqltablename||o,attrs:{label:e.name}},t._l(e.fields,(function(i,r){return n("el-option",{key:i.actualId||o+"_"+r,attrs:{disabled:t.selectedFieldMap[i.actualId],value:i.actualId,label:i.name+"("+e.name+")"}})})),1)})),1),n("el-tooltip",{attrs:{"open-delay":500,content:"新增字段"}},[n("el-button",{staticStyle:{"margin-left":"10px",display:"none"},attrs:{icon:"el-icon-plus",size:"small"},on:{click:t.handleAddField}})],1)],1)])},vi=[],bi=n("3835");function yi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Ci(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?yi(Object(n),!0).forEach((function(e){Object(at["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yi(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var wi={name:"control-form-data-combobox",props:{value:{type:String,require:!0},config:{type:Object,require:!0},styleText:{type:String,default:""}},computed:Ci(Ci(Ci({controlType:function(){var t=this.$store.state.selectedControlId;if(t){var e=this.$store.getters.controlDataMap[t];if(e&&e.control)return e.control.type}return null}},Object(_t["e"])(["fieldList"])),Object(_t["c"])(["selectedFieldMap"])),{},{tables:function(){var t=this,e=this.controlType,n=Object(kt["d"])(this.fieldList),o=Object(kt["d"])(this.$store.state.newFieldList),i=!this.value||/#/.test(this.value),r=[];if(n.forEach((function(n,a){0==a&&o.length&&(n.fields=o.concat(n.fields)),n.fields.forEach((function(o){o.actualId=t.joinId(n,o,i),e&&o.fielddisplaytype==e&&r.push(Object(kt["d"])(o))}))})),r.length){var a={name:"相关字段",id:"adapts",fields:r};n.unshift(a)}return n}}),methods:{joinId:function(t,e,n){return n?"#".concat(t.sqltablename||"",";#").concat(e.fieldname||""):t.id+";"+e.field},change:function(t){var e=t;t&&!/#/.test(t)&&(e=this.getNewBindValue(t)),this.$emit("change",e,this.config)},getNewBindValue:function(t){var e=t.split(";"),n=Object(bi["a"])(e,2),o=n[0],i=n[1];if(!o||!i)return t;for(var r,a,l=this.$store.state.fieldList,s=0;s<l.length;s++)if(l[s].id==o){r=l[s];for(var c=0;c<r.fields.length;c++)if(i==r.fields[c].field){a=r.fields[c];break}break}return r&&a?this.joinId(r,a,!0):t},doBindAfterCreate:function(t){var e=this.fieldList[0];if(e){var n=this.joinId(e,t,!0);n&&this.change(n)}},old2new:function(){if(this.value&&/#/.test(this.value)){var t=this.value.split(";"),e=Object(bi["a"])(t,2),n=e[0],o=e[1];if(!n||!o)return;var i=n.split("#"),r=o.split("#");if(i[1]&&r[1]){var a="#".concat(i[1],";#").concat(r[1]);this.value!==a&&(this.value,this.change(a))}}},handleAddField:function(){var t=this;this.$bus.$emit("createBindField",(function(e){t.doBindAfterCreate(e)}))}},mounted:function(){this.old2new()}},xi=wi,Oi=Object(gt["a"])(xi,gi,vi,!1,null,null,null),Di=Oi.exports,_i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-tooltip",{attrs:{"popper-class":"control-help-popper",placement:t.placement,content:t.currentValue}},[n("div",{attrs:{slot:"content"},domProps:{innerHTML:t._s(t.currentValue)},slot:"content"}),n("span",{staticClass:"design-help"})])},ki=[],Si={name:"control-help",props:{config:{type:Object,default:function(){return{}},required:!0}},data:function(){return{placement:this.config.placement||"right",currentValue:this.getContent()}},watch:{"config.content":function(){this.currentValue=this.getContent()}},methods:{getContent:function(){var t=this.config.content;return t?(Array.isArray(t)&&(t=t.join("<br>")),t.replace(/<script/,""),t=t.replace(/ /g,"&nbsp;"),t):""}}},ji=Si,Ti=Object(gt["a"])(ji,_i,ki,!1,null,null,null),Ii=Ti.exports,Pi=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-date-picker",{attrs:{type:"month",placeholder:"请选择月份",format:"yyyy-MM","value-format":"yyyy-MM",editable:!1,size:"small"},on:{change:t.change},model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}})},Ai=[],Ei={name:"control-monthpicker",props:{value:{type:String,default:""},config:{type:Object,require:!0},styleText:{type:String,default:"width:200px"}},data:function(){return{currentValue:this.value||""}},watch:{value:function(t){this.currentValue=t}},methods:{change:function(t){this.$emit("change",t,this.config)}}},Li=Ei,$i=Object(gt["a"])(Li,Pi,Ai,!1,null,null,null),Mi=$i.exports,Fi=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{suffix:t.config.suffix}},[n("el-input-number",{staticStyle:{"text-align":"left"},style:t.styleText,attrs:{placeholder:t.config.placeholder||"请输入"+(t.config.label||""),size:"small","controls-position":"right",controls:!1},on:{change:t.change},model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}}),t.config.suffix?n("span",{staticClass:"form-control-suffix"},[t._v(t._s(t.config.suffix))]):t._e()],1)},Ri=[],Ni=(n("c5f6"),{name:"control-number-textbox",props:{value:{type:[Number,String],default:function(){return""}},config:{type:Object,require:!0},styleText:{type:String,default:""}},data:function(){return{currentValue:parseInt(this.value,10)||0}},watch:{value:function(t){this.currentValue=parseInt(t,10)||0}},methods:{change:function(t){this.$emit("change",t,this.config)}}}),Vi=Ni,Bi=Object(gt["a"])(Vi,Fi,Ri,!1,null,null,null),zi=Bi.exports,Hi=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-radio-group",{class:"direction-"+t.direction,on:{change:t.change},model:{value:t.currValue,callback:function(e){t.currValue=e},expression:"currValue"}},t._l(t.optionList,(function(e){return n("el-radio",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])})),1)},Gi=[],qi=window.FORM_DESIGN_CONFIG.preset,Ui={name:"control-radio-list",mixins:[$o],props:{value:{type:String,require:!0},config:{type:Object,require:!0}},data:function(){return{currValue:this.value,loading:!1,originOptionList:[]}},created:function(){!this.config.data&&this.config.url&&this.getOriginData(this.config.url)},watch:{value:function(){this.currValue=this.value}},computed:{direction:function(){return this.config.direction||"horizontal"},optionList:function(){return this.config.data?this.staticOptionList:this.originOptionList},staticOptionList:function(){var t=this.config.data;if(!t)return[];if(Array.isArray(t))return t;var e=t+""===t;return e&&t in qi?qi[t]:[]}},methods:{change:function(t){this.$emit("change",t,this.config)}}},Wi=Ui,Ji=Object(gt["a"])(Wi,Hi,Gi,!1,null,null,null),Yi=Ji.exports,Xi=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-switch",{on:{change:t.change},model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}})},Ki=[],Qi={name:"control-switch",props:{value:{type:Boolean,default:!1},config:{type:Object,require:!0},styleText:{type:String,default:"width:200px"}},data:function(){return{currentValue:this.value||!1}},watch:{value:function(t){this.currentValue=t}},methods:{change:function(t){this.$emit("change",t,this.config)}}},Zi=Qi,tr=Object(gt["a"])(Zi,Xi,Ki,!1,null,null,null),er=tr.exports,nr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{suffix:t.config.suffix}},[n("el-input",{ref:"input",style:t.styleText,attrs:{placeholder:t.config.placeholder||"请输入"+(t.config.label||""),size:"small"},on:{change:t.change},model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}}),t.config.suffix?n("span",{staticClass:"form-control-suffix"},[t._v(t._s(t.config.suffix))]):t._e()],1)},or=[],ir={name:"control-textbox",props:{value:{type:String,default:""},config:{type:Object,require:!0},styleText:{type:String,default:""}},data:function(){return{currentValue:this.value||""}},watch:{value:function(t){this.currentValue=t}},methods:{focus:function(){this.$refs.input.select()},change:function(t){this.$emit("change",t,this.config)}}},rr=ir,ar=Object(gt["a"])(rr,nr,or,!1,null,null,null),lr=ar.exports,sr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-control-item width-set",style:t.styleText},[n("el-select",{staticClass:"width-set-select",attrs:{size:"small"},on:{change:t.typeChange},model:{value:t.currType,callback:function(e){t.currType=e},expression:"currType"}},[n("el-option",{attrs:{label:"百分比",value:"percent"}}),n("el-option",{attrs:{label:"像素",value:"number"}})],1),n("el-input-number",{staticClass:"width-set-input",attrs:{min:t.min,max:t.max,size:"small",controls:!1},on:{change:t.change},model:{value:t.currValue,callback:function(e){t.currValue=e},expression:"currValue"}}),n("span",{staticClass:"form-unit form-control-suffix"},[t._v(t._s("percent"==this.currType?"%":"px"))])],1)},cr=[];function ur(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function dr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ur(Object(n),!0).forEach((function(e){Object(at["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ur(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var fr={name:"control-width-set",props:{value:{type:[String,Number],require:!0},config:{type:Object,require:!0},styleText:{type:String,default:""}},data:function(){var t=this.getAdaptedData(this.value);return dr({min:1},t)},watch:{value:function(){var t=this.getAdaptedData(this.value);this.currType=t.currType,this.currValue=t.currValue,this.max=t.max}},methods:{getAdaptedData:function(t){var e=t+""===t,n=parseInt(t,10)||100;return{currType:e?"percent":"number",currValue:e?Math.min(100,n):n,max:e?100:1/0}},typeChange:function(){this.change(this.currValue)},change:function(t){var e="percent"==this.currType?t+"%":t;this.$emit("change",e,this.config)}}},pr=fr,hr=Object(gt["a"])(pr,sr,cr,!1,null,null,null),mr=hr.exports,gr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"preset-align"},[n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("对齐")]),n("AlignButton",{attrs:{type:"horizontal"},model:{value:t.textAlign,callback:function(e){t.textAlign=e},expression:"textAlign"}})],1)])},vr=[],br={name:"extend-font-align",components:{AlignButton:yn},props:["controlData"],data:function(){return{textAlign:this.controlData.textAlign}},watch:{"controlData.textAlign":function(t){this.textAlign=t},textAlign:function(t){t!=this.controlData.textAlign&&this.$emit("change",t,"textAlign")}}},yr=br,Cr=Object(gt["a"])(yr,gr,vr,!1,null,null,null),wr=Cr.exports,xr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.controlData.popup?n("div",{staticClass:"extend-buttonedit-field"},[n("div",{staticClass:"form-item"},[n("div",{staticClass:"form-label"},[t._v("值字段")]),n("div",{staticClass:"form-control"},[n("el-select",{attrs:{size:"small"},model:{value:t.idField,callback:function(e){t.idField=e},expression:"idField"}},t._l(t.list,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1)]),n("div",{staticClass:"form-item"},[n("div",{staticClass:"form-label"},[t._v("显示字段")]),n("div",{staticClass:"form-control"},[n("el-select",{attrs:{size:"small"},model:{value:t.textField,callback:function(e){t.textField=e},expression:"textField"}},t._l(t.list,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1)])]):t._e()},Or=[],Dr={};function _r(t,e,n){var o=t+n;return Dr[o]||(Dr[o]=Object(kt["i"])(t,e).catch((function(t){Dr[o]=null,delete Dr[o],console.error(t)}))),Dr[o]}var kr=_r;function Sr(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=jr(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,r=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw r}}}}function jr(t,e){if(t){if("string"===typeof t)return Tr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Tr(t,e):void 0}}function Tr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var Ir={name:"extend-buttonedit-field",props:["controlData"],data:function(){return{list:[],idField:this.controlData.idField||"",textField:this.controlData.textField||""}},mounted:function(){this.controlData.popup&&this.getList(this.controlData.popup)},methods:{getList:function(t){var e=this;kr(window.formDesignerActions.getListStructUrl,{listGuid:t},"buttoneditStruct-"+t).then((function(t){if(!Array.isArray(t.ListStruct))throw new TypeError("列表必须为数组");e.list=t.ListStruct,e.checkIn(e.idField,"id",e.list)||(e.idField=""),e.checkIn(e.textField,"id",e.list)||(e.textField="")})).catch((function(t){e.list=[],e.idField=e.textField="",e.console.error(t)}))},checkIn:function(t,e,n){var o,i=Sr(n);try{for(i.s();!(o=i.n()).done;){var r=o.value;if(r[e]==t)return!0}}catch(a){i.e(a)}finally{i.f()}return!1},change:function(t,e){this.$emit("change",t,e)}},watch:{"controlData.popup":function(t){t?this.getList(t):(this.list=[],this.idField=this.textField="")},idField:function(t){t!=this.controlData.idField&&this.change(t,"idField")},textField:function(t){t!=this.controlData.textField&&this.change(t,"textField")}}},Pr=Ir,Ar=Object(gt["a"])(Pr,xr,Or,!1,null,null,null),Er=Ar.exports,Lr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"preset-data-action",class:{disabled:t.hasAutoCodeItem}},[t.hasAutoCodeItem?n("div",{staticClass:"tips"},[n("i",{staticClass:"el-icon-info",staticStyle:{color:"#409EFF"}}),t._v(" 选中的关联字段已经有对应数据源了")]):t._e(),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("配置方式")]),n("div",{staticClass:"form-control"},[n("el-radio-group",{attrs:{disabled:t.hasAutoCodeItem},model:{value:t.sourceType,callback:function(e){t.sourceType=e},expression:"sourceType"}},t._l(t.sourceList,(function(e){return n("el-radio",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])})),1)],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:"static"==t.sourceType,expression:"sourceType == 'static'"}],staticClass:"form-item"},[n("el-form",{ref:"dataActionForm",attrs:{model:t.customData,inline:!0,disabled:t.hasAutoCodeItem}},t._l(t.customData,(function(e,o){return n("div",{key:o,staticClass:"data-source-item"},[n("el-form-item",{staticClass:"data-source-input value",attrs:{prop:o+".id",rules:t.rules.id}},[n("el-input",{attrs:{placeholder:"值",size:"mini"},model:{value:e.id,callback:function(n){t.$set(e,"id",n)},expression:"item.id"}})],1),n("el-form-item",{staticClass:"data-source-input text",attrs:{prop:o+".text",rules:t.rules.text}},[n("el-input",{attrs:{placeholder:"显示名称",size:"mini"},model:{value:e.text,callback:function(n){t.$set(e,"text",n)},expression:"item.text"}})],1),n("el-button",{staticClass:"data-source-item-btn del",attrs:{type:"danger",plain:"",size:"mini",icon:"el-icon-delete"},on:{click:function(e){return t.deleteItem(o)}}}),n("el-button",{staticClass:"data-source-item-btn up",attrs:{size:"mini",icon:"el-icon-caret-top",disabled:"0"==o},on:{click:function(e){return t.moveUp(o)}}}),n("el-button",{staticClass:"data-source-item-btn down",attrs:{size:"mini",icon:"el-icon-caret-bottom",disabled:o==t.customData.length-1},on:{click:function(e){return t.moveDown(o)}}})],1)})),0),n("el-button",{attrs:{icon:"el-icon-plus",size:"mini"},on:{click:t.addItem}},[t._v("添加选项")]),n("el-button",{attrs:{disabled:!t.customData.length,icon:"el-icon-save",size:"mini"},on:{click:t.applyItem}},[t._v("应用")])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:"action"==t.sourceType,expression:"sourceType == 'action'"}],staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("远程数据源")]),n("div",{staticClass:"form-control"},[n("el-select",{attrs:{placeholder:"请选择远程数据源",disabled:t.hasAutoCodeItem,size:"small",filterable:""},on:{change:t.onActionChange},model:{value:t.selectedAction,callback:function(e){t.selectedAction=e},expression:"selectedAction"}},t._l(t.actionList,(function(t){return n("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})})),1)],1)])])},$r=[];function Mr(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Fr(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,r=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw r}}}}function Fr(t,e){if(t){if("string"===typeof t)return Rr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Rr(t,e):void 0}}function Rr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var Nr={name:"extend-data-action",props:["controlData"],components:{},data:function(){var t=this.controlData,e=t.data,n=t.codeItem,o=Array.isArray(e);return{sourceType:o?"static":"action",sourceList:[{id:"static",text:"自定义"},{id:"action",text:"远程"}],customData:o?Object(kt["d"])(e):[],selectedAction:n||"",rules:{id:[{validator:this.validateId,trigger:"blur"}],text:[{required:!0,message:"必须输入显示名称",trigger:"blur"}]}}},computed:{hasAutoCodeItem:function(){return!1},actionList:function(){return Object(kt["d"])(this.$store.state.codeList)}},methods:{validateId:function(t,e,n){if(!e)return n(new Error("必填"));var o=this.customData[t.field.split(".")[0]];return this.checkDuplicated(e,o)?n(new Error("值必须唯一")):n()},checkDuplicated:function(t,e){var n,o=Mr(this.customData);try{for(o.s();!(n=o.n()).done;){var i=n.value;if(i!==e&&t==i.id)return!0}}catch(r){o.e(r)}finally{o.f()}return!1},addItem:function(){var t=this;if(this.customData.length)return this.$refs.dataActionForm.validate((function(e){e?t.customData.push({id:"",text:""}):t.$message({message:"请先处理当前内容",customClass:"data-action-error-box",type:"error"})}));this.customData.push({id:"",text:""})},deleteItem:function(t){this.customData.splice(t,1)},applyItem:function(){var t=this;this.$refs.dataActionForm.validate((function(e,n){var o;o=e?Object(kt["d"])(t.customData):Object(kt["d"])(t.customData.filter((function(t,e){return!(e+".id"in n)&&!(e+".text"in n)}))),Array.isArray(o)&&t.useStaticData(o)}))},moveUp:function(t){if(0!==t){var e=this.customData.splice(t,1)[0];this.customData.splice(t-1,0,e)}},moveDown:function(t){if(t!==this.customData.length-1){var e=this.customData.splice(t,1)[0];this.customData.splice(t+1,0,e)}},onActionChange:function(t){this.useAction(t)},useStaticData:function(t){var e;this.controlData.codeItem&&(e="dataaction"+ +new Date,this.$emit("change","","codeItem",e)),this.$emit("change",t,"data",e)},useAction:function(t){var e;this.controlData.data&&(e="dataaction"+ +new Date,this.$emit("change","","data",e)),this.$emit("change",t,"codeItem",e)}},watch:{sourceType:function(t){"action"==t?this.useAction(this.selectedAction):this.applyItem()},controlData:{deep:!0,handler:function(){var t=this.controlData,e=t.data,n=t.codeItem;Array.isArray(e)?(this.customData=Object(kt["d"])(e),this.sourceType="static"):this.sourceType="action",n&&(this.selectedAction=n)}}}},Vr=Nr,Br=(n("25cd"),Object(gt["a"])(Vr,Lr,$r,!1,null,null,null)),zr=Br.exports,Hr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"extend-daterange-config"},[n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("日期范围")]),n("div",{staticClass:"form-control"},[n("el-select",{attrs:{size:"small"},on:{change:t.onRangeTypeChange},model:{value:t.rangeType,callback:function(e){t.rangeType=e},expression:"rangeType"}},t._l(t.rangeTypeList,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1)]),"range"==t.rangeType?n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("开始")]),n("div",{staticClass:"form-control"},[n("el-select",{staticClass:"form-control-item",attrs:{size:"small"},on:{change:function(e){return t.selectedChange(e,"start")}},model:{value:t.selectedValue1,callback:function(e){t.selectedValue1=e},expression:"selectedValue1"}},[n("el-option",{attrs:{value:"static",label:"选择固定日期"}}),t._l(t.controlList,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],2),t.selectedValue1==t.typeMap.static?n("el-date-picker",{staticClass:"form-control-item",attrs:{"picker-options":t.startPickerOptions,"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择开始日期",size:"small"},on:{change:function(e){return t.onDateChange("start")}},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}}):t._e()],1)]):t._e(),"range"==t.rangeType?n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("结束")]),n("div",{staticClass:"form-control"},[n("el-select",{staticClass:"form-control-item",attrs:{size:"small"},on:{change:function(e){return t.selectedChange(e,"end")}},model:{value:t.selectedValue2,callback:function(e){t.selectedValue2=e},expression:"selectedValue2"}},[n("el-option",{attrs:{value:"static",label:"选择固定日期"}}),t._l(t.controlList,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],2),t.selectedValue2==t.typeMap.static?n("el-date-picker",{staticClass:"form-control-item",attrs:{"picker-options":t.endPickerOptions,"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择结束日期",size:"small"},on:{change:function(e){return t.onDateChange("end")}},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}}):t._e()],1)]):t._e()])},Gr=[];function qr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Ur(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?qr(Object(n),!0).forEach((function(e){Object(at["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Wr=/^\d{4}-\d{2}-\d{2}$/,Jr=/^\{.+\}$/,Yr={name:"extend-daterange-config",props:["controlData"],components:{},computed:{startType:function(){return this.getLimitType(this.controlData.minDate)},endType:function(){return this.getLimitType(this.controlData.maxDate)},controlList:function(){var t=this,e=/datepicker/i,n=this.$store.state.hiddenControls,o=this.$store.getters.allControls,i=[];return o.forEach((function(n){e.test(n.type)&&n.id!=t.controlData.id&&i.push({type:n.type,id:n.id,name:n.name||n.namePrefix+"_"+n.autoIndex})})),n.forEach((function(t){i.push({type:t.type,id:t.id,name:t.name||t.namePrefix+"_"+t.autoIndex})})),i}},data:function(){var t=this;return Ur(Ur({rangeType:this.getRangeType(this.controlData.minDate,this.controlData.maxDate),rangeTypeList:[{id:"empty",text:"留空"},{id:"range",text:"指定范围"}]},this.getDateFromControl(this.controlData)),{},{typeMap:{static:"static",control:"control"},startPickerOptions:{disabledDate:function(e){return!!t.endDate&&e.getTime()>new Date(t.endDate).getTime()}},endPickerOptions:{disabledDate:function(e){return!!t.startDate&&e.getTime()<new Date(t.startDate).getTime()}}})},methods:{getDateFromControl:function(t){var e="",n="",o="",i="";return t.minDate&&(Jr.test(t.minDate)?e=t.minDate.substring(1,t.minDate.length-1):Wr.test(t.minDate)?(e="static",o=t.minDate):console.error("日期不合法： "+t.minDate)),t.maxDate&&(Jr.test(t.maxDate)?n=t.maxDate.substring(1,t.maxDate.length-1):Wr.test(t.maxDate)?(n="static",i=t.maxDate):console.error("日期不合法： "+t.maxDate)),{selectedValue1:e,selectedValue2:n,startDate:o,endDate:i}},getRangeType:function(t,e){return!t&&!e||""==t&&""==e?"empty":"range"},getLimitType:function(t){return t&&""!=t?Wr.test(t)?this.typeMap.static:this.typeMap.control:this.typeMap.static},onRangeTypeChange:function(t){"empty"==t?this.clearRange():(this.startDate&&this.onDateChange("start"),this.endDate&&this.onDateChange("end"))},clearRange:function(){""!=this.controlData.minDate&&this.$emit("change","","minDate"),""!=this.controlData.maxDate&&this.$emit("change","","maxDate")},selectedChange:function(t,e){if(t!=this.typeMap.static)t&&this.$emit("change","{".concat(t,"}"),"start"==e?"minDate":"maxDate");else{var n="start"==e?this.startDate:this.endDate;n&&this.$emit("change",n,"start"==e?"minDate":"maxDate")}},onDateChange:function(t){"range"==this.rangeType&&("start"==t&&this.startType==this.typeMap.static&&this.$emit("change",this.startDate,"minDate"),"end"==t&&this.endType==this.typeMap.static&&this.$emit("change",this.endDate,"maxDate"))}}},Xr=Yr,Kr=Object(gt["a"])(Xr,Hr,Gr,!1,null,null,null),Qr=Kr.exports,Zr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"preset-font"},[n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("字体")]),n("el-select",{staticClass:"font-set-select",attrs:{size:"small"},model:{value:t.fontFamily,callback:function(e){t.fontFamily=e},expression:"fontFamily"}},t._l(t.fontFamilyList,(function(t){return n("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})})),1),n("el-input-number",{staticClass:"font-set-input",attrs:{size:"small",controls:!1,min:12,max:100},model:{value:t.fontSize,callback:function(e){t.fontSize=e},expression:"fontSize"}}),n("span",{staticClass:"form-control-suffix"},[t._v("px")])],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("样式")]),n("FontColor",{staticStyle:{"margin-right":"10px"},model:{value:t.fontColor,callback:function(e){t.fontColor=e},expression:"fontColor"}}),n("div",{staticClass:"design-button-group font-group"},[n("el-tooltip",{attrs:{"open-delay":500,content:"加粗"}},[n("MyButton",{class:{active:t.fontBolder},attrs:{icon:"font-bold"},nativeOn:{click:function(e){t.fontBolder=!t.fontBolder}}})],1),n("el-tooltip",{attrs:{"open-delay":500,content:"倾斜"}},[n("MyButton",{class:{active:t.fontItalic},attrs:{icon:"font-italic"},nativeOn:{click:function(e){t.fontItalic=!t.fontItalic}}})],1),n("el-tooltip",{attrs:{"open-delay":500,content:"下划线"}},[n("MyButton",{class:{active:t.fontUnderline},attrs:{icon:"font-underline"},nativeOn:{click:function(e){t.fontUnderline=!t.fontUnderline}}})],1)],1)],1)])},ta=[],ea=window.FORM_DESIGN_CONFIG.preset.fontFamilyList,na={name:"extend-font-config",props:["controlData"],components:{FontColor:no,MyButton:mn},data:function(){return{fontFamilyList:JSON.parse(JSON.stringify(ea)),fontFamily:this.controlData.fontFamily,fontSize:this.controlData.fontSize,fontColor:this.controlData.fontColor,fontBolder:this.controlData.fontBolder,fontItalic:this.controlData.fontItalic,fontUnderline:this.controlData.fontUnderline}},methods:{handleChange:function(t,e){this.controlData[e]!=t&&this.$emit("change",t,e)}},watch:{controlData:{deep:!0,handler:function(){var t=this.controlData,e=t.fontFamily,n=t.fontSize,o=t.fontColor,i=t.fontBolder,r=t.fontItalic,a=t.fontUnderline;this.fontFamily=e,this.fontSize=n,this.fontColor=o,this.fontBolder=i,this.fontItalic=r,this.fontUnderline=a}},fontFamily:function(t){this.handleChange(t,"fontFamily")},fontSize:function(t){this.handleChange(t,"fontSize")},fontColor:function(t){this.handleChange(t,"fontColor")},fontBolder:function(t){this.handleChange(t,"fontBolder")},fontItalic:function(t){this.handleChange(t,"fontItalic")},fontUnderline:function(t){this.handleChange(t,"fontUnderline")}}},oa=na,ia=Object(gt["a"])(oa,Zr,ta,!1,null,null,null),ra=ia.exports,aa=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"frozen-column"},[n("div",{staticClass:"form-item"},[n("div",{staticClass:"form-control "},[n("el-checkbox",{on:{change:t.onSwitch},model:{value:t.isFrozen,callback:function(e){t.isFrozen=e},expression:"isFrozen"}},[t._v("冻结列")])],1)]),t.isFrozen?n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("冻结列索引")]),n("div",{staticClass:"form-control "},[n("el-input-number",{attrs:{min:0,max:t.columnLength-2,size:"mini",controls:!1},on:{change:t.change},model:{value:t.frozenIndex,callback:function(e){t.frozenIndex=e},expression:"frozenIndex"}})],1)]):t._e()])},la=[],sa={name:"extend-frozen-column",props:["controlData"],computed:{columnLength:function(){var t=this.controlData.specialColumns.split(",").length,e=this.controlData.columns.length||4;return t+e}},data:function(){var t=parseInt(this.controlData.frozenColumnIndex,10);return{isFrozen:-1!==t,frozenIndex:t}},methods:{change:function(t){this.controlData.frozenIndex!=t&&this.$emit("change",t,"frozenColumnIndex")},onSwitch:function(t){var e=this;t?this.$nextTick((function(){e.change(e.frozenIndex)})):this.$emit("change",-1,"frozenColumnIndex")}},watch:{"controlData.frozenColumnIndex":function(t){var e=parseInt(t,10);this.frozenIndex=e,this.isFrozen=-1!==e}}},ca=sa,ua=Object(gt["a"])(ca,aa,la,!1,null,null,null),da=ua.exports,fa=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"multi-form"},[n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("默认值")]),n("div",{staticClass:"form-control"},[n("virtual-select",{attrs:{clearable:"",multiple:t.multiSelect,placeholder:t.list.length?"请选择默认值":"请先选择数据源",items:t.list,buffer:34,"item-size":34,filterable:"","filter-key":"text"},on:{change:t.onValueChange},scopedSlots:t._u([{key:"default",fn:function(t){var e=t.item;return[n("el-option",{key:e.id,attrs:{slot:"default",label:e.text,value:e.id},slot:"default"})]}}]),model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}})],1)])])},pa=[],ha=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:t.handleClose,expression:"handleClose"}],staticClass:"el-select",class:[t.selectSize?"el-select--"+t.selectSize:""],on:{click:function(e){return e.stopPropagation(),t.toggleMenu(e)}}},[t.multiple?n("div",{ref:"tags",staticClass:"el-select__tags",style:{"max-width":t.inputWidth-32+"px",width:"100%"}},[t.collapseTags&&t.selected.length?n("span",[n("el-tag",{attrs:{closable:!t.selectDisabled,size:t.collapseTagSize,hit:t.selected[0].hitState,type:"info","disable-transitions":""},on:{close:function(e){return t.deleteTag(e,t.selected[0])}}},[n("span",{staticClass:"el-select__tags-text"},[t._v(t._s(t.selected[0].currentLabel))])]),t.selected.length>1?n("el-tag",{attrs:{closable:!1,size:t.collapseTagSize,type:"info","disable-transitions":""}},[n("span",{staticClass:"el-select__tags-text"},[t._v("+ "+t._s(t.selected.length-1))])]):t._e()],1):t._e(),t.collapseTags?t._e():n("transition-group",{on:{"after-leave":t.resetInputHeight}},t._l(t.selected,(function(e){return n("el-tag",{key:t.getValueKey(e),attrs:{closable:!t.selectDisabled,size:t.collapseTagSize,hit:e.hitState,type:"info","disable-transitions":""},on:{close:function(n){return t.deleteTag(n,e)}}},[n("span",{staticClass:"el-select__tags-text"},[t._v(t._s(e.currentLabel))])])})),1),t.filterable?n("input",{directives:[{name:"model",rawName:"v-model",value:t.query,expression:"query"}],ref:"input",staticClass:"el-select__input",class:[t.selectSize?"is-"+t.selectSize:""],style:{"flex-grow":"1",width:t.inputLength/(t.inputWidth-32)+"%","max-width":t.inputWidth-42+"px"},attrs:{type:"text",disabled:t.selectDisabled,autocomplete:t.autoComplete||t.autocomplete},domProps:{value:t.query},on:{focus:t.handleFocus,blur:function(e){t.softFocus=!1},keyup:t.managePlaceholder,keydown:[t.resetInputState,function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:(e.preventDefault(),t.navigateOptions("next"))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:(e.preventDefault(),t.navigateOptions("prev"))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.selectOption(e))},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"]))return null;e.stopPropagation(),e.preventDefault(),t.visible=!1},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete","Del"])?null:t.deletePrevTag(e)},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"tab",9,e.key,"Tab"))return null;t.visible=!1}],compositionstart:t.handleComposition,compositionupdate:t.handleComposition,compositionend:t.handleComposition,input:[function(e){e.target.composing||(t.query=e.target.value)},t.debouncedQueryChange]}}):t._e()],1):t._e(),n("el-input",{ref:"reference",class:{"is-focus":t.visible},attrs:{id:t.id,type:"text",name:t.name,placeholder:t.currentPlaceholder,autocomplete:t.autoComplete||t.autocomplete,size:t.selectSize,disabled:t.selectDisabled,readonly:t.readonly,"validate-event":!1,tabindex:t.multiple&&t.filterable?"-1":null},on:{focus:t.handleFocus,blur:t.handleBlur},nativeOn:{keyup:function(e){return t.debouncedOnInputChange(e)},keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:(e.stopPropagation(),e.preventDefault(),t.navigateOptions("next"))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:(e.stopPropagation(),e.preventDefault(),t.navigateOptions("prev"))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.selectOption(e))},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"]))return null;e.stopPropagation(),e.preventDefault(),t.visible=!1},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"tab",9,e.key,"Tab"))return null;e.stopPropagation(),e.preventDefault(),t.visible=!1}],paste:function(e){return t.debouncedOnInputChange(e)},mouseenter:function(e){t.inputHovering=!0},mouseleave:function(e){t.inputHovering=!1}},model:{value:t.selectedLabel,callback:function(e){t.selectedLabel=e},expression:"selectedLabel"}},[t.$slots.prefix?n("template",{slot:"prefix"},[t._t("prefix")],2):t._e(),n("template",{slot:"suffix"},[n("i",{directives:[{name:"show",rawName:"v-show",value:!t.showClose,expression:"!showClose"}],class:["el-select__caret","el-input__icon","el-icon-"+t.iconClass]}),t.showClose?n("i",{staticClass:"el-select__caret el-input__icon el-icon-circle-close",on:{click:t.handleClearClick}}):t._e()])],2),n("transition",{attrs:{name:"el-zoom-in-top"},on:{"before-enter":t.handleMenuEnter,"after-leave":t.doDestroy}},[n("el-select-menu",{directives:[{name:"show",rawName:"v-show",value:t.visible&&!1!==t.emptyText,expression:"visible && emptyText !== false"}],ref:"popper",attrs:{"append-to-body":t.popperAppendToBody}},[n("div",{staticClass:"el-select-dropdown__wrap el-scrollbar__wrap",staticStyle:{overflow:"hidden",position:"relative"}},[n("recycle-scroller",{ref:"virtualScroller",staticClass:"scroller",style:t.scrollerStyle,attrs:{items:t.data,buffer:t.buffer,"key-field":t.keyField,"item-size":t.itemSize},scopedSlots:t._u([{key:"before",fn:function(){return[t._t("before")]},proxy:!0},{key:"default",fn:function(e){var n=e.item,o=e.index,i=e.active;return[t._t("default",null,{item:n,index:o,active:i})]}},{key:"after",fn:function(){return[t._t("after")]},proxy:!0}],null,!0)}),t.emptyText&&(!t.allowCreate||t.loading||t.allowCreate&&0===t._items.length)?[t.$slots.empty?t._t("empty"):n("p",{staticClass:"el-select-dropdown__empty"},[t._v("\n              "+t._s(t.emptyText)+"\n            ")])]:t._e()],2)])],1)],1)},ma=[],ga=n("e508");n("a899");function va(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ba(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?va(Object(n),!0).forEach((function(e){Object(at["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):va(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ya={name:"VirtualSelect",components:ba(ba({},E.a.components),{},{RecycleScroller:ga["a"]}),directives:ba({},E.a.directives),mixins:[E.a],props:ba(ba(ba({},E.a.props),ga["a"].props),{},{filterKey:String}),data:function(){var t=E.a.data.bind(this),e=t();return ba(ba({},e),{},{data:Object(rt["a"])(this.items)})},computed:ba(ba({},E.a.computed),{},{scrollerStyle:function(){var t=Math.min(this.data.length,5),e=this.itemSize*t;return"height: ".concat(e,"px")}}),watch:{items:function(t){this.data=Object(rt["a"])(t)},visible:function(t){t&&(this.data=Object(rt["a"])(this.items))}},created:function(){var t=E.a.created.bind(this);t()},mounted:function(){var t=E.a.mounted.bind(this);t()},methods:ba(ba({},E.a.methods),{},{handleQueryChange:function(t){var e=this;this.previousQuery===t||this.isOnComposition||(null!==this.previousQuery||"function"!==typeof this.filterMethod&&"function"!==typeof this.remoteMethod?(this.previousQuery=t,this.$nextTick((function(){e.visible&&e.broadcast("ElSelectDropdown","updatePopper")})),this.hoverIndex=-1,this.multiple&&this.filterable&&this.$nextTick((function(){var t=15*e.$refs.input.value.length+20;e.inputLength=e.collapseTags?Math.min(50,t):t,e.managePlaceholder(),e.resetInputHeight()})),this.remote&&"function"===typeof this.remoteMethod?(this.hoverIndex=-1,this.remoteMethod(t)):"function"===typeof this.filterMethod?(this.filterMethod(t),this.broadcast("ElOptionGroup","queryChange")):this.filterKey&&(this.query,this.data=t?this.items.filter((function(n){var o=e.filterKey;return n.hasOwnProperty(o)&&n[o].indexOf(t)>-1})):Object(rt["a"])(this.items),this.filteredOptionsCount=this.optionsCount,this.broadcast("ElOption","queryChange",t),this.broadcast("ElOptionGroup","queryChange")),this.defaultFirstOption&&(this.filterable||this.remote)&&this.filteredOptionsCount&&this.checkDefaultFirstOption()):this.previousQuery=t)},scrollToOption:function(t){var e=Array.isArray(t)?t[0]:t;if(e&&e.$vnode){var n=e.$vnode.key;this.$refs.virtualScroller.scrollToItem(n)}}})},Ca=ya,wa=(n("e06a"),Object(gt["a"])(Ca,ha,ma,!1,null,null,null)),xa=wa.exports;var Oa={components:{VirtualSelect:xa},name:"extend-list-default-value",props:["controlData"],mounted:function(){this.getValue(),this.getList()},data:function(){return{loading:!1,list:[],currentValue:[]}},computed:{multiSelect:function(){var t=this.controlData.type;return"radiobuttonlist"!=t&&("checkboxlist"==t||"combobox"==t&&!!this.controlData.multiSelect)}},methods:{getList:function(){var t=this.controlData,e=t.data,n=t.codeItem;if(e&&Array.isArray(e))return this.list=Object(kt["d"])(e),void this.checkValueInList();this.getData(n)},getData:function(t){var e=this;this.loading=!0,this.list=[],t?kr(window.formDesignerActions.getControlDataListUrl,{controlData:this.controlData},t).then((function(t){if(!t||!Array.isArray(t))throw new Error("代码列表获取失败");e.loading=!1,e.list=t,e.checkValueInList()})).catch((function(t){console.error("请求失败",t),e.loading=!1,e.list=[]})):this.$emit("change","","defaultValue")},getValue:function(){var t=this.controlData.defaultValue,e=this.multiSelect?[]:"";this.currentValue=t?this.multiSelect?t.split(","):t:e},checkValueInList:function(){var t=this.currentValue,e=this.list;if(t&&(!this.multiSelect||t.length)){var n=!0;n=!!Array.isArray(e)&&(this.multiSelect?t.every((function(t){return e.some((function(e){return e.id==t}))})):e.some((function(e){return e.id==t}))),n||this.$emit("change","","defaultValue")}},onValueChange:function(t){var e=t&&t.toString?t.toString():t||"";this.$emit("change",e,"defaultValue")}},watch:{"controlData.codeItem":function(){this.getList()},"controlData.data":function(){this.getList()},"controlData.defaultValue":function(){this.getValue()}}},Da=Oa,_a=Object(gt["a"])(Da,fa,pa,!1,null,null,null),ka=_a.exports,Sa=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"multi-form"},[n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("所属手风琴")]),n("div",{staticClass:"form-control"},[n("el-select",{staticClass:"form-control-item",on:{change:t.onAccChange},model:{value:t.multiFormAccId,callback:function(e){t.multiFormAccId=e},expression:"multiFormAccId"}},t._l(t.accList,(function(e){return n("el-option",{key:e.id,attrs:{value:e.id,label:e.text}},[t._v(t._s(e.text))])})),1)],1)]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("所属栏目")]),n("div",{staticClass:"form-control"},[n("el-select",{staticClass:"form-control-item",on:{change:t.onSubCateChange},model:{value:t.multiFormColumnId,callback:function(e){t.multiFormColumnId=e},expression:"multiFormColumnId"}},t._l(t.subList,(function(e){return n("el-option",{key:e.id,attrs:{value:e.id,label:e.text}},[t._v(t._s(e.text))])})),1)],1)]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("排序值")]),n("div",{staticClass:"form-control"},[n("el-input-number",{staticClass:"form-control-item",attrs:{controls:!1},on:{change:t.onIndexChange},model:{value:t.multiFormIndex,callback:function(e){t.multiFormIndex=e},expression:"multiFormIndex"}})],1)])])},ja=[];function Ta(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Ia={name:"extend-multi-form",props:["controlData"],mounted:function(){this.getAccList(),this.addMultiFormProps(),this.multiFormColumnId&&this.multiFormAccId&&this.getSubCateList(this.multiFormAccId)},data:function(){var t=this.controlData;return{accList:[],subList:[],multiFormAccId:Ta(t,"multiFormAccId")?t.multiFormAccId:"",multiFormColumnId:Ta(t,"multiFormColumnId")?t.multiFormColumnId:"",multiFormIndex:Ta(t,"multiFormIndex")?t.multiFormIndex:0}},methods:{addMultiFormProps:function(){Ta(this.controlData,"multiFormAccId")&&Ta(this.controlData,"multiFormColumnId")&&Ta(this.controlData,"multiFormIndex")||this.$store.commit({type:"addMultiFormProps",controlData:this.controlData})},getAccList:function(){var t=this;return kr(window.formDesignerActions.getMultiFormAccListUrl,{},"").then((function(e){var n=e.dataValue;Array.isArray(n)?(t.accList=n,t.multiFormAccId&&!t.checkValueInList(t.multiFormAccId,n)&&(t.multiFormAccId="",t.change("multiFormAccId",""))):t.accList=[]}))},getSubCateList:function(t){var e=this;return kr(window.formDesignerActions.getMultiFormSubCateListUrl,{codeId:t},"subid-"+t).then((function(t){var n=t.itemDataValue;Array.isArray(n)?(e.subList=n,e.multiFormColumnId&&!e.checkValueInList(e.multiFormColumnId,n)&&(e.multiFormColumnId="",e.change("","multiFormColumnId"))):(e.subList=[],e.change("","multiFormColumnId"))}))},change:function(t,e){e&&void 0!==t&&this.$emit("change",t,e)},checkValueInList:function(t,e){return e.some((function(e){return e.id==t}))},onAccChange:function(t){this.change(t,"multiFormAccId"),this.subList=[],this.getSubCateList(t)},onSubCateChange:function(t){this.change(t,"multiFormColumnId")},onIndexChange:function(t){this.change(t,"multiFormIndex")}},watch:{controlData:{deep:!0,handler:function(){this.addMultiFormProps(),this.multiFormAccId!=this.controlData.multiFormAccId&&(this.multiFormAccId=this.controlData.multiFormAccId),this.multiFormColumnId!=this.controlData.multiFormColumnId&&(this.multiFormColumnId=this.controlData.multiFormColumnId),this.multiFormIndex!=this.controlData.multiFormIndex&&(this.multiFormIndex=this.controlData.multiFormIndex),this.multiFormColumnId&&this.multiFormAccId&&this.getSubCateList(this.multiFormAccId)}}}},Pa=Ia,Aa=Object(gt["a"])(Pa,Sa,ja,!1,null,null,null),Ea=Aa.exports,La=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"extend-range-validate"},[n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v(t._s(t.validateTextMap[t.validateType]))]),n("div",{staticClass:"form-control"},[n("el-switch",{on:{change:t.change},model:{value:t.showRangeValidate,callback:function(e){t.showRangeValidate=e},expression:"showRangeValidate"}})],1)]),t.showRangeValidate?n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("值")]),n("div",{staticClass:"form-control"},[n("el-select",{staticClass:"range-validate-operation",attrs:{size:"small"},on:{change:t.change},model:{value:t.operation1,callback:function(e){t.operation1=e},expression:"operation1"}},t._l(t.operationList,(function(t){return n("el-option",{key:t,attrs:{value:t,label:t}})})),1),n("el-select",{staticClass:"range-validate-value",attrs:{size:"small"},on:{change:t.change},model:{value:t.selectedValue1,callback:function(e){t.selectedValue1=e},expression:"selectedValue1"}},[n("el-option",{attrs:{value:"static",label:"输入固定值"}}),t._l(t.controlList,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],2),"static"==t.selectedValue1?n("el-input",{staticClass:"range-validate-input",attrs:{placeholder:"请输入",size:"small"},on:{change:t.change},model:{value:t.operationValue1,callback:function(e){t.operationValue1=e},expression:"operationValue1"}}):t._e(),n("span",{directives:[{name:"show",rawName:"v-show",value:!t.showExt,expression:"!showExt"}],staticClass:"ext-btn el-icon-plus",on:{click:t.showCondition2}})],1)]):t._e(),t.showRangeValidate?n("div",{directives:[{name:"show",rawName:"v-show",value:t.showExt,expression:"showExt"}],staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("且")]),n("div",{staticClass:"form-control"},[n("el-select",{staticClass:"range-validate-operation",attrs:{size:"small"},on:{change:t.change},model:{value:t.operation2,callback:function(e){t.operation2=e},expression:"operation2"}},t._l(t.operationList,(function(t){return n("el-option",{key:t,attrs:{value:t,label:t}})})),1),n("el-select",{staticClass:"range-validate-value",attrs:{size:"small"},on:{change:t.change},model:{value:t.selectedValue2,callback:function(e){t.selectedValue2=e},expression:"selectedValue2"}},[n("el-option",{attrs:{value:"static",label:"输入固定值"}}),t._l(t.controlList,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],2),"static"==t.selectedValue2?n("el-input",{staticClass:"range-validate-input",attrs:{placeholder:"请输入",size:"small"},on:{change:t.change},model:{value:t.operationValue2,callback:function(e){t.operationValue2=e},expression:"operationValue2"}}):t._e(),n("span",{staticClass:"ext-btn el-icon-delete",on:{click:t.hideCondition2}})],1)]):t._e()])},$a=[];n("55dd");function Ma(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Fa(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ma(Object(n),!0).forEach((function(e){Object(at["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ma(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ra={name:"extend-range-validate",props:["controlData"],data:function(){return Fa({validateTextMap:{string:"文本值比较",number:"数值比较"}},this.getCompentValueFromControl(this.controlData))},computed:{controlList:function(){var t=this,e=/textbox|textarea|radiobuttonlist|combobox|macro|treeselect/i,n=this.$store.state.hiddenControls,o=this.$store.getters.allControls,i=[];return o.forEach((function(n){e.test(n.type)&&n.id!=t.controlData.id&&i.push({type:n.type,id:n.id,name:n.name||n.namePrefix+"_"+n.autoIndex})})),n.forEach((function(t){i.push({type:t.type,id:t.id,name:t.name||t.namePrefix+"_"+t.autoIndex})})),i.sort((function(t,e){return t.type==e.type?0:"textbox"==e.type&&"textbox"!=t.type||"hiddenfield"==e.type&&"hiddenfield"!=t.type?1:-1})),i},inputType:function(){var t=this.controlData.vtype;return"int"==t||"float"==t?"number":"string"},operationList:function(){return"number"==this.inputType?["<","<=","==",">",">="]:["=="]},condition1Done:function(){return!(!this.operation1||!this.selectedValue1)&&!("static"==this.selectedValue1&&!this.operationValue1)},condition2Done:function(){return!(!this.operation2||!this.selectedValue2)&&!("static"==this.selectedValue2&&!this.operationValue2)}},methods:{getCompentValueFromControl:function(t){var e=!1,n=!1,o="",i="",r="",a="",l="",s="",c="",u=(t||this.controlData).vtype,d=(t||this.controlData).rangeValidator,f=d&&d.conditions;if(o="int"==u||"float"==u?"number":"string",f&&f.length){if(e=!0,f[0]){i=window.decodeURIComponent(f[0].operation);var p=this.getOperationInfo(f[0].value);a=p.type,s=p.value}else i="string"==o?"==":"<=",s=a="";if(f[1]){r=window.decodeURIComponent(f[1].operation);var h=this.getOperationInfo(f[1].value);l=h.type,c=h.value,n=!0}else r="string"==o?"==":">=",c=l="",n=!1}return{showRangeValidate:e,showExt:n,validateType:o,operation1:i,operation2:r,selectedValue1:a,selectedValue2:l,operationValue1:s,operationValue2:c}},getOperationInfo:function(t){if(/^\{.+\}$/.test(t)){var e=t.substring(1,t.length-1);return{type:e,value:""}}return{type:"static",value:t}},showCondition2:function(){if(!this.condition1Done)return this.$message({type:"error",message:"请先填好当前条件"});this.showExt=!0,this.change()},hideCondition2:function(){this.showExt=!1,this.operation2="string"==this.validateType?"==":">=",this.operationValue2=this.selectedValue2="",this.change()},getSubmitValue:function(){var t={type:this.validateType,conditions:[]};return this.condition1Done&&t.conditions.push({operation:window.encodeURIComponent(this.operation1),value:"static"==this.selectedValue1?this.operationValue1:"{".concat(this.selectedValue1,"}")}),this.showExt&&this.condition2Done&&t.conditions.push({operation:window.encodeURIComponent(this.operation2),value:"static"==this.selectedValue2?this.operationValue2:"{".concat(this.selectedValue2,"}")}),t},change:function(){var t=this.getSubmitValue();this.showRangeValidate&&t&&t.conditions&&t.conditions.length||(t=null),this.$emit("change",t,"rangeValidator")}},watch:{"controlData.vtype":function(){var t=this.getCompentValueFromControl(this.controlData),e=t.showRangeValidate,n=t.showExt,o=t.validateType,i=t.operation1,r=t.operation2,a=t.selectedValue1,l=t.selectedValue2,s=t.operationValue1,c=t.operationValue2;this.showRangeValidate=e,this.showExt=n,this.validateType=o,this.operation1=i,this.operation2=r,this.selectedValue1=a,this.selectedValue2=l,this.operationValue1=s,this.operationValue2=c}}},Na=Ra,Va=Object(gt["a"])(Na,La,$a,!1,null,null,null),Ba=Va.exports,za=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.showFormSelect?n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("编辑页地址")]),n("div",{staticClass:"form-control"},[n("el-select",{staticClass:"form-control-item",attrs:{size:"mini"},on:{change:t.change},model:{value:t.selectedFormId,callback:function(e){t.selectedFormId=e},expression:"selectedFormId"}},t._l(t.formList,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1)]):t._e()},Ha=[],Ga={name:"extend-sub-table-edit-form",props:["controlData"],computed:{showFormSelect:function(){return"dialog"==this.controlData.editType},tableId:function(){return this.controlData.sourceTable}},data:function(){return{selectedFormId:this.controlData.editFormGuid||"",formList:[]}},mounted:function(){this.getForms()},methods:{getForms:function(){var t=this;if(!this.tableId)return this.formList=[];kr(window.formDesignerActions.getSubTableInfoUrl,{tableId:this.tableId},"subTableData-"+this.tableId).then((function(e){var n=e.SubTableForm;if(!Array.isArray(n))throw new Error("获取编辑表单失败");t.formList=n.map((function(t){return{id:t.formGuid,text:t.formName}}))})).catch((function(t){console.error(t)}))},change:function(t){this.$emit("change",t,"editFormGuid")}},watch:{tableId:function(){this.showFormSelect&&this.getForms()},"controlData.editFormGuid":function(t){this.selectedFormId=t}}},qa=Ga,Ua=Object(gt["a"])(qa,za,Ha,!1,null,null,null),Wa=Ua.exports,Ja=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"extend-sub-table-fields"},[n("div",{staticClass:"form-item"},[n("el-button",{attrs:{disabled:!t.tableId,size:"mini"},on:{click:function(e){t.showDialog=!0}}},[t._v("点击配置")])],1),n("el-dialog",{staticClass:"column-config-dialog",attrs:{"append-to-body":"",title:"表格字段配置",visible:t.showDialog,"before-close":t.handleClose,width:t.showEditor?"80%":"50%"},on:{"update:visible":function(e){t.showDialog=e}}},[t.showDialog?n("div",[n("div",{staticClass:"column-config-header"},[n("div",{staticClass:"span display"},[t._v("显示")]),n("div",{staticClass:"span move"},[t._v("排序")]),n("div",{staticClass:"span name"},[t._v("名称")]),t.showEditor?n("div",{staticClass:"span editor"},[t._v("编辑类型")]):t._e(),t.showEditor?n("div",{staticClass:"span required"},[t._v("必填")]):t._e(),n("div",{staticClass:"span align"},[t._v("对齐方式")]),n("div",{staticClass:"span width"},[t._v("列宽(px)")]),t.showEditor?n("div",{staticClass:"span vtype"},[t._v("格式校验")]):t._e()]),n("div",{staticClass:"column-config-list"},[n("draggable",{attrs:{list:t.columns,handle:".move",direction:"vertical"},on:{start:function(e){t.drag=!0},end:function(e){t.drag=!1},change:t.change}},t._l(t.columns,(function(e){return n("column-config",{key:e.field,attrs:{field:e,showEditor:t.showEditor},on:{change:t.change}})})),1)],1)]):t._e(),n("span",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.save}},[t._v("确 定")]),n("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.beforeClose()}}},[t._v("取 消")])],1)])],1)},Ya=[],Xa=n("b76a"),Ka=n.n(Xa),Qa=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"column-config-item"},[n("div",{staticClass:"span display"},[n("el-checkbox",{on:{change:function(e){return t.change("display",t.field.display)}},model:{value:t.field.display,callback:function(e){t.$set(t.field,"display",e)},expression:"field.display"}})],1),t._m(0),n("div",{staticClass:"span name"},[n("el-input",{attrs:{size:"mini"},on:{change:function(e){return t.change("name",t.field.name)}},model:{value:t.field.name,callback:function(e){t.$set(t.field,"name",e)},expression:"field.name"}})],1),t.showEditor?n("div",{staticClass:"span editor"},[n("el-select",{attrs:{size:"mini"},on:{change:function(e){return t.change("controlType",t.field.controlType)}},model:{value:t.field.controlType,callback:function(e){t.$set(t.field,"controlType",e)},expression:"field.controlType"}},t._l(t.controlTypes,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1):t._e(),t.showEditor?n("div",{staticClass:"span required"},[n("el-checkbox",{on:{change:function(e){return t.change("required",t.field.required)}},model:{value:t.field.required,callback:function(e){t.$set(t.field,"required",e)},expression:"field.required"}})],1):t._e(),n("div",{staticClass:"span align"},[n("AlignButton",{attrs:{type:"horizontal"},on:{change:function(e){return t.change("align",t.field.align)}},model:{value:t.field.align,callback:function(e){t.$set(t.field,"align",e)},expression:"field.align"}})],1),n("div",{staticClass:"span width"},[n("el-input-number",{attrs:{size:"mini",controls:!1},on:{change:function(e){return t.change("width",t.field.width)}},model:{value:t.field.width,callback:function(e){t.$set(t.field,"width",e)},expression:"field.width"}})],1),t.showEditor?n("div",{staticClass:"span vtype"},[n("el-select",{attrs:{size:"mini",disabled:"textbox"!=t.field.controlType},on:{change:function(e){return t.change("vtype",t.field.vtype)}},model:{value:t.field.vtype,callback:function(e){t.$set(t.field,"vtype",e)},expression:"field.vtype"}},t._l(t.vtypeList,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1):t._e()])},Za=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"span move"},[n("span",{staticClass:"sort-handle el-icon-rank",staticStyle:{cursor:"move"}})])}],tl={name:"column-config",components:{AlignButton:yn},props:["field","showEditor"],computed:{},data:function(){return{vtypeList:Object(kt["d"])(window.FORM_DESIGN_CONFIG.preset["epointsform.validateTypes"]),controlTypes:Object(kt["d"])(window.FORM_DESIGN_CONFIG.preset["epointsform.columnEditors"])}},methods:{change:function(t,e){this.$emit("change",t,e)}}},el=tl,nl=Object(gt["a"])(el,Qa,Za,!1,null,null,null),ol=nl.exports,il={width:100,align:"center",required:!1,controlType:"",vtype:""},rl={name:"extend-sub-table-fields",components:{ColumnConfig:ol,draggable:Ka.a},props:["controlData"],computed:{tableId:function(){return this.controlData.sourceTable},fieldMap:function(){var t={};return this.fieldList.forEach((function(e){t[e.field]=e})),t},showEditor:function(){return"dialog"!=this.controlData.editType}},mounted:function(){this.getFields()},data:function(){return{fieldList:[],columns:[],showDialog:!1,loading:!1,drag:!1,dataChanged:!1}},methods:{getConfigColumns:function(){var t=this;if(this.fieldList.length){var e=this.controlData.columns||[];if(e.length){var n=[],o={};e.forEach((function(e){t.fieldMap[e.field]&&(o[e.field]=!0,n.push(Lo()({},il,e)))})),this.fieldList.forEach((function(t){o[t.field]||n.push(Lo()({},il,t))})),this.columns=n}else this.columns=this.fieldList.map((function(t){var e=Lo()({},il,t);return e.display=!0,e}))}else this.columns=[]},getRealColumns:function(){if(!this.columns.length)return[];var t=Object(kt["d"])(this.columns).filter((function(t){return t.display}));return t.forEach((function(t){t.controlType&&"textbox"!=t.controlType&&(t.vtype="")})),t},change:function(){this.dataChanged=!0},beforeClose:function(t){var e=this;this.dataChanged?this.$confirm("确认不保存直接关闭？").then((function(){t?t():e.showDialog=!1})).catch((function(t){console.error(t)})):this.showDialog=!1},handleClose:function(t){this.beforeClose(t)},getFields:function(){var t=this;if(!this.tableId)return this.fieldList=[];this.loading=!0,kr(window.formDesignerActions.getSubTableInfoUrl,{tableId:this.tableId},"subTableData-"+this.tableId).then((function(e){var n=e.SubTableStruct;if(!Array.isArray(n))throw new Error("获取子表字段失败");n.forEach((function(t){t.required=1==parseInt(t.required,10)})),t.fieldList=n})).catch((function(e){console.error(e),t.loading=!1}))},save:function(){var t=this.getRealColumns();this.$emit("change",t,"columns"),this.showDialog=!1}},watch:{tableId:function(){this.getFields()},fieldList:function(){this.getConfigColumns()},showDialog:function(t){t||(this.dataChanged=!1)}}},al=rl,ll=(n("f5bd"),Object(gt["a"])(al,Ja,Ya,!1,null,null,null)),sl=ll.exports,cl=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"extend-sub-table-source"},[n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("数据来源")]),n("div",{staticClass:"form-control"},[n("el-select",{attrs:{value:t.value,size:"small",filterable:"",clearable:""},on:{change:t.change}},t._l(t.optionList,(function(t){return n("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})})),1)],1)])])},ul=[],dl={name:"extend-sub-table-source",props:["controlData"],data:function(){return{value:""}},mounted:function(){this.controlData.sourceTable?this.value=this.controlData.sourceTable:this.value=""},computed:{optionList:function(){var t="sourceTables";return this.$store.state[t]}},methods:{change:function(t){var e=this.getTargetItemPid(t);this.$emit("change",t,"sourceTable"),e&&this.$emit("change",e,"sourceTablePid")},getTargetItemPid:function(t){for(var e="",n=this.optionList.length-1;n>=0;n--)if(this.optionList[n]&&this.optionList[n].id==t){e=this.optionList[n].parentId;break}return e}},watch:{"controlData.sourceTable":function(t){this.value=t}}},fl=dl,pl=Object(gt["a"])(fl,cl,ul,!1,null,null,null),hl=pl.exports,ml=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tooltip-config"},[n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("位置")]),n("div",{staticClass:"form-control"},[n("div",{staticClass:"design-button-group tooltip-group",attrs:{"data-value":t.type}},t._l(t.typeList,(function(e){return n("el-tooltip",{key:e,attrs:{"open-delay":500,content:t.tipsText[e]}},[n("MyButton",{class:{active:t.type==e},attrs:{icon:"tooltip-type-"+e},nativeOn:{click:function(n){return t.activeBtn(e)}}})],1)})),1)])]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("内容")]),n("div",{staticClass:"form-control"},[n("el-input",{staticClass:"form-control-item",attrs:{type:"textarea",rows:"3",placeholder:"请输入提示内容",allowresize:"false"},on:{change:t.onContentChange},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1)])])},gl=[];function vl(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var bl={name:"extend-tooltip-config",props:["controlData"],components:{MyButton:mn},mounted:function(){this.addTooltipConfig()},data:function(){var t=this.controlData.tooltipConfig;return{type:t?t.type:"tooltip",content:t?t.content:"",tipsText:{tooltip:"tooltip 提示",right:"右侧提示",bottom:"底部提示"},typeList:["tooltip","bottom"]}},methods:{activeBtn:function(t){this.type=t,this.change(t,"tooltipConfig.type")},onContentChange:function(t){this.change(t,"tooltipConfig.content")},addTooltipConfig:function(){vl(this.controlData,"tooltipConfig")||this.$store.commit({type:"addTooltipConfig",controlData:this.controlData})},change:function(t,e){e&&void 0!==t&&this.$emit("change",t,e)}},watch:{controlData:{deep:!0,immediate:!0,handler:function(){this.addTooltipConfig();var t=this.controlData.tooltipConfig;t.type!==this.type&&(this.type=t.type),t.content!==this.content&&(this.content=t.content)}}}},yl=bl,Cl=(n("13f1"),Object(gt["a"])(yl,ml,gl,!1,null,null,null)),wl=Cl.exports,xl={checkbox:Io,checkboxlist:Vo,combobox:Wo,defaultdate:ii,filetypepicker:mi,fontcolor:no,formdatacombobox:Di,help:Ii,monthpicker:Mi,numbertextbox:zi,radiobuttonlist:Yi,switch:er,textbox:lr,widthconfig:mr,"extend-alignconfig":wr,"extend-buttoneditfield":Er,"extend-dataaction":zr,"extend-daterangeconfig":Qr,"extend-fontconfig":ra,"extend-frozencolumn":da,"extend-listdefaultvalue":ka,"extend-multiform":Ea,"extend-rangevalidate":Ba,"extend-subtableeditform":Wa,"extend-subtablefields":sl,"extend-subtablesource":hl,"extend-tooltipconfig":wl},Ol={name:"default-control-component",inheritAttrs:!1,props:["config","value","controlData"],template:'<div>{{controlData ? "配置功能" : config.type}} 开发中...</div>'},Dl=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{},[n("el-dropdown",{staticClass:"add-event-drop",attrs:{size:"small",trigger:"click",placement:"bottom-start"},on:{command:t.addEvent}},[n("div",{staticClass:"add-event-drop-trigger"},[n("span",{staticClass:"el-icon-plus add-event-icon"}),t._v("添加事件\n    ")]),n("el-dropdown-menu",{staticClass:"add-event-dropmenu",attrs:{slot:"dropdown"},slot:"dropdown"},[t._l(t.eventTypeList,(function(e){return n("el-dropdown-item",{key:"1-"+e.type,attrs:{command:{type:e.type,initRun:!1}}},[t._v(t._s(e.name))])})),n("li",{staticClass:"el-dropdown-menu__item",staticStyle:{"pointer-events":"none",color:"#999","margin-top":"10px"}},[t._v("初始化事件")]),t._l(t.eventTypeList,(function(e){return n("el-dropdown-item",{key:"2-"+e.type,attrs:{command:{type:e.type,initRun:!0}}},[t._v(t._s(e.name))])}))],2)],1),t.eventList.length?n("div",{},t._l(t.controlData.events,(function(e,o){return n("div",{key:o},t._l(e,(function(e,i){return n("EventCard",{key:e.type+"-"+i,attrs:{"event-data":e,"target-name-map":t.targetNameMap},on:{"edit-event":function(e){return t.editEvent(o,i)},"remove-event":function(e){return t.removeEvent(o,i)},"remove-action":function(e){var n=arguments.length,r=Array(n);while(n--)r[n]=arguments[n];return t.removeEventAction.apply(void 0,[o,i].concat(r))}}})})),1)})),0):t._e(),n("el-dialog",{staticClass:"event-config-dialog",attrs:{width:"800px",visible:t.dialogVisible,title:"add"==t.configData.editType?"新增事件":"修改事件","close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":t.cancel,"append-to-body":""}},[t.dialogVisible?n("EventConfig",{attrs:{"control-data":t.controlData,"target-name-map":t.targetNameMap,"edit-type":t.configData.editType,"default-event-type":t.configData.eventType,"event-description":t.configData.evData,"event-type-list":t.eventTypeList},on:{save:t.saveEvent,cancel:t.cancel}}):t._e()],1)],1)},_l=[],kl=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"event-config"},[n("div",{staticClass:"event-config-header"},[n("el-select",{staticClass:"event-config-typeselect",attrs:{size:"small",disabled:!t.eventTypeChangeable||!t.eventTypeList.length||1==t.eventTypeList.length},on:{change:t.onEventTypeChanged},model:{value:t.eventType,callback:function(e){t.eventType=e},expression:"eventType"}},t._l(t.eventTypeList,(function(t){return n("el-option",{key:t.type,attrs:{value:t.type,label:t.name}})})),1),n("div",{directives:[{name:"show",rawName:"v-show",value:t.showCondition,expression:"showCondition"}],staticClass:"event-config-condition"},[t._v("\n      当满足 This\n      "),n("el-select",{staticClass:"event-operation",attrs:{size:"small"},model:{value:t.condition.operation,callback:function(e){t.$set(t.condition,"operation",e)},expression:"condition.operation"}},t._l(t.operationList,(function(e){return n("el-option",{key:e,attrs:{value:e,label:t.operationNames[e]}})})),1),n("virtual-select",{attrs:{clearable:"",size:"small",items:t.controlDataList,buffer:34,"item-size":34,filterable:"","filter-key":"text"},scopedSlots:t._u([{key:"default",fn:function(t){var e=t.item;return[n("el-option",{key:e.id,attrs:{slot:"default",label:e.text,value:e.id},slot:"default"})]}}]),model:{value:t.condition.target,callback:function(e){t.$set(t.condition,"target",e)},expression:"condition.target"}})],1)],1),n("div",{staticClass:"event-config-body"},[n("div",{staticClass:"event-config-lane choice"},[n("h3",{staticClass:"event-config-title"},[t._v("选择动作")]),t.eventConfigMap[t.eventType]?n("div",{staticClass:"event-config-list choice"},t._l(t.eventConfigMap[t.eventType].actionList,(function(e){return n("div",{key:e.type,staticClass:"choice-action-item",class:{disabled:t.selectedActions[e.type]},on:{click:function(n){return t.addAction(e.type)}}},[t._v(t._s(e.name))])})),0):t._e()]),n("div",{staticClass:"event-config-lane action-config"},[n("h3",{staticClass:"event-config-title"},[t._v("组织动作")]),t.actions.length?n("div",{staticClass:"event-config-list"},t._l(t.actions,(function(e,o){return n("div",{key:e.type,staticClass:"action-item"},[n("h4",{staticClass:"action-header",class:{active:e.type==t.currentAction,collaspe:e.collaspe},on:{click:function(n){t.currentAction=e.type}}},[n("span",{staticClass:"el-icon-arrow-down action-toggle",on:{click:function(t){t.stopPropagation(),e.targets.length&&(e.collaspe=!e.collaspe)}}}),n("span",{staticClass:"action-name"},[t._v(t._s(e.name))]),n("span",{staticClass:"action-remove el-icon-close",on:{click:function(n){return n.stopPropagation(),t.removeAction(o,e.type==t.currentAction)}}})]),e.targets.length?n("div",{staticClass:"action-targets",style:"height:"+30*e.targets.length+"px"},t._l(e.targets,(function(e){return n("div",{key:e.id},[t._v("\n              "+t._s(t.targetNameMap[e.id])+"\n              "),e.setValueField?n("span",[t._v(t._s(t.fieldNameMap[e.setValueField]))]):t._e()])})),0):n("span",[t._v("请在右侧为动作选择目标")])])})),0):n("span",[t._v("请先从左侧添加动作")])]),n("div",{staticClass:"event-config-lane targets"},[n("h3",{staticClass:"event-config-title"},[t._v("\n        对象目标 "+t._s(t.currentActionName)+"\n        "),"assignment"==t.currentAction?n("div",[n("div",{staticClass:"event-config-target-table"},[n("label",[t._v("赋值来源数据表：")]),n("el-select",{staticStyle:{float:"right","margin-right":"10px"},attrs:{size:"mini",filterable:""},on:{change:t.onTargetTableChange},model:{value:t.targetTable,callback:function(e){t.targetTable=e},expression:"targetTable"}},t._l(t.dataTables,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1),"assignment"==t.currentAction?n("div",{staticClass:"event-config-target-tablefield"},[n("label",[t._v("数据查询字段：")]),n("el-select",{staticStyle:{float:"right","margin-right":"10px"},attrs:{size:"mini",filterable:""},model:{value:t.targetTableField,callback:function(e){t.targetTableField=e},expression:"targetTableField"}},t._l(t.fieldList,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1):t._e()]):t._e()]),t.currentAction?n("TargetDisplay",{staticClass:"event-config-list",class:{table:"assignment"==t.currentAction,tablefield:"assignment"==t.currentAction},attrs:{type:t.treeDisplayType,"default-targets":t.currentActionTargets,"action-type":t.currentAction,"field-list":t.fieldList,"field-name-map":t.fieldNameMap,"except-id":t.controlData.id},on:{"ckecked-change":t.handleTargetChange}}):n("span",[t._v("请先选择动作")])],1)]),n("div",{staticClass:"event-config-footer"},[n("el-checkbox",{model:{value:t.runAtInit,callback:function(e){t.runAtInit=e},expression:"runAtInit"}},[t._v("初始化执行")]),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.save}},[t._v("保存")]),n("el-button",{attrs:{size:"mini"},on:{click:t.cancel}},[t._v("取消")])],1)])},Sl=[],jl={valuechanged:{name:"值变更",originType:"valuechanged",actions:["assignment"]},"valuechanged:compare":{name:"值变更(关系比较)",originType:"valuechanged",actions:["show","hide","assignment","clear"]},"valuechanged:getcodelist":{name:"值变更(获取代码项)",originType:"valuechanged",actions:["setData"]}},Tl={show:{name:"显示"},hide:{name:"隐藏"},assignment:{name:"赋值"},clear:{name:"清空"},setData:{name:"数据源设置"}},Il=(Object.keys(Tl).map((function(t){return Tl[t].type=t,Tl})),Object.keys(jl).map((function(t){return jl[t].type=t,jl[t].actionList=jl[t].actions.map((function(t){return Tl[t]})),jl[t]}))),Pl={"<=":"小于等于","<":"小于","!=":"不等于","==":"等于",">":"大于",">=":"大于等于"};function Al(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function El(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Al(Object(n),!0).forEach((function(e){Object(at["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Al(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ll(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=$l(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,r=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw r}}}}function $l(t,e){if(t){if("string"===typeof t)return Ml(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ml(t,e):void 0}}function Ml(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var Fl={name:"event-config",components:{TargetDisplay:function(){return n.e("chunk-16a1e32a").then(n.bind(null,"22f8"))},VirtualSelect:xa},props:{editType:{type:String,required:!0,validator:function(t){return/^(?:add|edit)$/.test(t)}},defaultEventType:{type:String,required:!0},eventTypeList:{type:Array,default:function(){return Il}},controlData:{type:Object},eventDescription:[Object,null],targetNameMap:{type:Object}},computed:{eventTypeChangeable:function(){return"add"==this.editType},dataTables:function(){return this.$store.state.dataTables},selectedActions:function(){var t={};return this.actions.forEach((function(e){t[e.type]=!0})),t},showCondition:function(){return"valuechanged:compare"==this.eventType},treeDisplayType:function(){return/^(?:show|hide|clear)$/.test(this.currentAction)?"all":"assignment"==this.currentAction?"controls":"setData"==this.currentAction?"combobox":""},currentActionName:function(){var t=this.actionInfo[this.currentAction];return t?"(".concat(t.name,")"):""},currentActionTargets:function(){var t,e=Ll(this.actions);try{for(e.s();!(t=e.n()).done;){var n=t.value;if(n.type==this.currentAction)return n.targets||[]}}catch(o){e.e(o)}finally{e.f()}return[]},fieldNameMap:function(){var t={};return this.fieldList.forEach((function(e){t[e.id]=e.text})),t}},data:function(){return{actionInfo:Tl,eventType:this.defaultEventType,eventConfigMap:jl,condition:{operation:"==",target:""},operationList:["==","!="],operationNames:Pl,actions:[],currentAction:"",runAtInit:!1,targetTable:"",targetTableField:"",fieldList:[],controlDataList:[]}},created:function(){this.getFieldList(),this.getControlDataList(),this.setEditEventData()},mounted:function(){"add"==this.editType&&1==this.eventConfigMap[this.eventType].actionList.length&&this.addAction(this.eventConfigMap[this.eventType].actionList[0].type)},methods:{setEditEventData:function(){var t=this,e=Object(kt["d"])(this.eventDescription),n=e.type,o=e.runAtInit,i=e.conditions,r=e.actions;n&&(this.eventType=n),i&&i.length&&(this.condition.operation=i[0].operation,this.condition.target=i[0].target),Array.isArray(r)?(this.actions=r.map((function(e){return"assignment"==e.type&&(t.targetTable=e.sourceTableId,t.targetTableField=e.sourceTableField||""),El(El({},e),{},{name:Tl[e.type].name,collaspe:!1})})),this.currentAction=this.actions[0].type):(this.actions.length&&(this.actions=[]),this.currentAction=""),this.runAtInit=o},getFieldList:function(){var t=this;if(!this.targetTable)return this.fieldList=[];_r(window.formDesignerActions.getTableFieldsUrl,{tableId:this.targetTable},"targerTable-"+this.targetTable).then((function(e){var n=e.TableStruct;Array.isArray(n)?t.fieldList=n:t.fieldList=[]})).catch((function(t){console.error(t)}))},getControlDataList:function(){var t=this;if(this.controlDataList=[],this.showCondition)return this.controlData.data?this.controlDataList=Object(kt["d"])(this.controlData.data):this.$httpPost(window.formDesignerActions.getControlDataListUrl,{controlData:this.controlData}).then((function(e){if(!Array.isArray(e))throw new Error("获取控件数据出错!");t.controlDataList=e})).catch((function(t){console.error(t)}))},addAction:function(t){this.selectedActions[t]||(this.actions.push(this.createAction(t)),this.currentAction=t)},createAction:function(t){var e=Tl[t].name,n={type:t,name:e,targets:[],collaspe:!1};return n},removeAction:function(t,e){this.actions.splice(t,1),e&&(this.currentAction="")},handleTargetChange:function(t){var e=this,n=this.actions.filter((function(t){return t.type==e.currentAction}))[0];n?n.targets=t:console.error("目标动作不存在")},onEventTypeChanged:function(){this.actions=[],this.currentAction=""},validate:function(){var t=this;return new Promise((function(e,n){var o=[];!t.showCondition||t.condition.operation&&t.condition.target||o.push({type:"condition",message:"事件条件未填写完整"}),t.actions.length?t.actions.forEach((function(e){e.targets&&e.targets.length||o.push({type:"action",target:e,message:"【".concat(e.name,"】动作未配置任何操作目标！")}),"assignment"==e.type&&(t.targetTable||o.push({type:"targetTable",message:"赋值必须选择数据来源表"}),t.targetTableField||o.push({type:"targetTableField",message:"必须选择查询字段"}),e.targets.forEach((function(t){t.setValueField||o.push({type:"target",message:"【".concat(e.name,"】动作下的 ").concat(t.nodeName," 控件未配置赋值字段！！")})})))})):o.push({type:"action",message:"还未配置任何事件动作！"}),o.length?n(o):e()}))},save:function(){var t=this;return this.validate().then((function(){t._doSave()})).catch((function(e){var n;Array.isArray(e)?(console.error(e),n=1==e.length?e[0].message:"事件配置信息不完整，请检查",t.$message({message:n,type:"error",customClass:"event-config-error",showClose:!0})):console.error(e)}))},_doSave:function(){var t=this,e={type:this.eventType,originType:jl[this.eventType].originType,runAtInit:this.runAtInit};this.showCondition&&(e.conditions=[Object(kt["d"])(this.condition)]),e.actions=this.actions.map((function(e){var n={type:e.type,targets:e.targets.map((function(t){var e={type:t.nodeType||t.type,id:t.id};return t.setValueField&&(e.setValueField=t.setValueField),e}))};return"assignment"==e.type&&(n.sourceTableId=t.targetTable,n.sourceTableField=t.targetTableField),n})),JSON.stringify(e,0,2),this.$emit("save",this.eventType,e)},cancel:function(){this.$emit("cancel")},clearBindValueField:function(){var t=this.actions.filter((function(t){return"assignment"==t.type}))[0];t.sourceTableField="",t&&t.targets&&t.targets.forEach((function(t){t.setValueField=""}))},onTargetTableChange:function(){this.clearBindValueField()}},watch:{targetTable:function(){this.fieldList=[],this.getFieldList()},showCondition:function(t){t&&this.getControlDataList()}}},Rl=Fl,Nl=(n("165c"),Object(gt["a"])(Rl,kl,Sl,!1,null,null,null)),Vl=Nl.exports,Bl=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"event-card"},[n("div",{staticClass:"event-card-header"},[n("span",{staticClass:"el-icon-arrow-down event-card-toggle"}),n("span",{staticClass:"event-name"},[t._v(t._s(t.eventInfo[t.eventData.type].name))]),n("span",{staticClass:"event-card-config"},[n("span",{staticClass:"el-icon-setting event-card-setting",on:{click:t.editEvent}}),n("span",{staticClass:"el-icon-delete event-card-delete",on:{click:t.removeEvent}})])]),t.eventData.conditions&&t.eventData.conditions.length?n("div",{staticClass:"event-card-condition"},[t._v("当满足 This "+t._s(t.operationNames[t.eventData.conditions[0].operation])+" "+t._s(t.eventData.conditions[0].target)+" 时")]):t._e(),n("div",{staticClass:"event-card-actions"},t._l(t.eventData.actions,(function(e,o){return n("div",{key:e.type,staticClass:"event-card-action"},[n("span",{staticClass:"event-card-action-remove el-icon-close",on:{click:function(n){return t.removeAction(e.type,o,1==t.eventData.actions.length)}}}),n("div",{staticClass:"event-card-action-name"},[t._v(t._s(t.actionInfo[e.type].name))]),n("div",{staticClass:"event-card-action-targets"},t._l(e.targets,(function(e){return n("div",{key:e.id,staticClass:"event-card-action-target"},[t._v("\n          "+t._s(t.targetNameMap[e.id])+" "),e.setValueField?n("span",{staticStyle:{"margin-left":"10px"}},[t._v("[ "+t._s(e.setValueField)+" ]")]):t._e()])})),0)])})),0),t.eventData.runAtInit?n("div",{staticClass:"event-card-init"},[n("span",{staticClass:"el-icon-s-flag"}),t._v(" 初始化时执行")]):t._e()])},zl=[],Hl={name:"event-card",components:{},props:{eventData:{type:Object},targetNameMap:{type:Object}},data:function(){return{eventInfo:jl,actionInfo:Tl,operationNames:Pl}},methods:{removeAction:function(t,e,n){var o=this;this.$confirm(n?"此事件下仅有此一个动作，将删除事件，是否继续？":"确认移除此此事件动作？").then((function(){o.$emit("remove-action",t,e)})).catch((function(){}))},editEvent:function(){this.$emit("edit-event")},removeEvent:function(){var t=this;this.$confirm("确认移除此事件？").then((function(){t.$emit("remove-event")})).catch((function(){}))}}},Gl=Hl,ql=(n("b020"),Object(gt["a"])(Gl,Bl,zl,!1,null,null,null)),Ul=ql.exports;function Wl(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Jl(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Wl(Object(n),!0).forEach((function(e){Object(at["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Wl(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Yl={add:"add",edit:"edit"},Xl={name:"event",components:{EventConfig:Vl,EventCard:Ul},props:["controlData"],computed:{eventTypeList:function(){var t=this.controlData.type,e=window.FORM_DESIGN_CONFIG.controls[t].supportEvents;return Il.filter((function(t){return-1!=e.indexOf(t.type)}))},eventList:function(){var t=this.controlData.events;if(t){var e=[];return Object.keys(t).forEach((function(n){e.push.apply(e,Object(rt["a"])(t[n]))})),e}return[]},targetNameMap:function(){var t=this.$store.getters.controlNameMap,e=this.$store.getters.allRows,n={};return e.forEach((function(t){n[t.id]=t.name||"".concat(t.namePrefix,"_").concat(t.autoIndex)})),Jl(Jl({},t),n)}},data:function(){return{dialogVisible:!1,configData:{editType:Yl.add,eventType:"",evData:null,editingIndex:-1,editingType:""}}},methods:Jl(Jl({},Object(_t["b"])(["setControlProp"])),{},{addEvent:function(t){var e=t.type,n=t.initRun;this.configData.eventType=e,this.configData.editType=Yl.add,this.configData.evData={runAtInit:n},this.dialogVisible=!0},editEvent:function(t,e){this.configData.eventType=t,this.configData.editType=Yl.edit,this.configData.evData=this.controlData.events[t][e],this.configData.editingIndex=e,this.configData.editingType=t,this.dialogVisible=!0},saveEvent:function(t,e){var n=this.controlData.events?Object(kt["d"])(this.controlData.events):{};if(this.configData.editType==Yl.add)n[t]?n[t].push(e):n[t]=[e];else{var o=this.configData,i=o.editingType,r=o.editingIndex;i&&-1!=r?n[i][r]=e:console.error("修改事件发生错误！")}this.setControlProp({prop:"events",value:n,control:this.controlData}),this.dialogVisible=!1},saveEditEvent:function(){},cancel:function(){this.dialogVisible=!1},removeEvent:function(t,e){var n=this,o=this.controlData.events;JSON.stringify(o[t][e],0,2);var i=Object(kt["d"])(o);1==i[t].length?delete i[t]:i[t].splice(e,1),JSON.stringify(i,0,2);var r="remove-event";if("valuechanged:getcodelist"==t){var a=this.controlData.id,l=this.$store.getters.allControls.filter((function(t){return t.codeSyncPid==a}));l.length&&l.forEach((function(t){n.setControlProp({group:r,prop:"codeSyncPid",value:"",control:t})}))}this.setControlProp({group:r,prop:"events",value:i,control:this.controlData})},removeEventAction:function(t,e,n,o){if(void 0===o)return console.error("无法删除，错误的动作索引："+o);var i=this.controlData.events;JSON.stringify(i[t][e].actions[o],0,2);var r=Object(kt["d"])(i),a=r[t][e];a.actions&&a.actions.length?(a.actions.splice(o,1),a.actions.length||(a=null,1==r[t].length?delete r[t]:r[t].splice(e,1)),JSON.stringify(r,0,2),this.setControlProp({prop:"events",value:r,control:this.controlData})):console.error("无法删除")}})},Kl=Xl,Ql=(n("ec83"),Object(gt["a"])(Kl,Dl,_l,!1,null,null,null)),Zl=Ql.exports;function ts(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function es(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ts(Object(n),!0).forEach((function(e){Object(at["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ts(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ns={name:"config-control",components:{NameConfig:Do,EventComponent:Zl},props:["control"],computed:es(es({},Object(_t["c"])(["controlType2nameMap"])),{},{controlType:function(){var t=this.control.type;return this.controlType2nameMap[t]},controlConfig:function(){var t=this.control.type,e=window.FORM_DESIGN_CONFIG.controls[t];return e?Object(kt["d"])(e.configItems):(console.error("".concat(t," 类型控件的配置不存在，请检查！！！")),[])},supportEvent:function(){var t=this.control.type,e=window.FORM_DESIGN_CONFIG.controls[t].supportEvents;return e&&e.length},eventCount:function(){if(!this.supportEvent)return 0;var t=this.control.events;return t?Object.keys(t).map((function(e){return t[e].length})).reduce((function(t,e){return t+e}),0):0}}),created:function(){if(this.$bus.$on("controlClick",this.labelTextAutoFocus),document.addEventListener("keyup",this.deleteShortcutKey),this.control){var t=this.control&&this.control.customValidate;t&&t.regExp&&(t.regSource=t.regExp,delete t.regExp)}},beforeDestroy:function(){this.$bus.$off("controlClick"),document.removeEventListener("keyup",this.deleteShortcutKey)},data:function(){return{currentView:"attribute"}},methods:{deleteShortcutKey:function(t){t.target&&-1!==["TEXTAREA","INPUT"].indexOf(t.target.nodeName)||46===t.which&&this.$store.state.selectedControlId&&this.removeControl()},removeControl:function(){this.$store.dispatch("deleteControl")},onNameChange:function(t){this.$store.dispatch("setControlProp",{value:t,prop:"name",control:this.control})},labelTextAutoFocus:function(){var t=this;this.$nextTick((function(){if("title"==t.control.type||"label"==t.control.type)try{t.$children.some((function(t){if(t.focus)return t.focus(),!0}))}catch(e){console.error(e)}}))},getControlValue:function(t,e){return/\./.test(e.associatedProp)?Object(kt["g"])(t,e.associatedProp):t[e.associatedProp]},change:function(t,e,n){this.$store.dispatch("setControlProp",{value:t,prop:e.associatedProp,control:this.control,group:n})},getExtends:function(t){return t?t+""===t?[("extend-"+t).toLowerCase()]:t.map((function(t){return("extend-"+t).toLowerCase()})):[]},handleExtendChange:function(t,e,n){this.$store.dispatch("setControlProp",{value:t,prop:e,control:this.control,group:n})},getControlComponent:function(t){var e=t.toLowerCase();return e in xl?xl[e]:Ol}},watch:{"control.id":function(){this.currentView="attribute"}}},os=ns,is=Object(gt["a"])(os,vo,bo,!1,null,null,null),rs=is.exports,as=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.rowId?n("div",{staticClass:"config-row"},[n("NameConfig",{attrs:{"component-data":t.row,type:t.rowType},on:{change:t.onNameChange,remove:t.removeRow}}),"row-layout"==t.type?n("div",{staticClass:"config-control-tabcontent"},[t._m(0)]):t._e(),"acc-layout"==t.type?n("ConfigAcc",{staticClass:"config-control-tabcontent",attrs:{"layout-data":t.row}}):t._e()],1):t._e()},ls=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"}),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("行")]),n("div",{staticClass:"form-control"})])])}],ss=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h3",{staticClass:"config-category"},[t._v("手风琴配置")]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("显示导航")]),n("div",{staticClass:"form-control"},[n("div",{staticClass:"form-control-item"},[n("el-switch",{model:{value:t.showNav,callback:function(e){t.showNav=e},expression:"showNav"}})],1)])]),n("h3",{staticClass:"config-category"},[t._v("手风琴项配置")]),n("div",{staticClass:"form-item"},t._l(t.items,(function(e,o){return n("div",{key:e.id,staticClass:"form-control-item acc",on:{click:function(n){return t.handleItemClick(e)}}},[n("span",{staticStyle:{"margin-right":"4px"}},[t._v(t._s(t._f("getOrder")(o)))]),n("span",[t._v(t._s(e.props.title))])])})),0),n("div",{staticClass:"form-item"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.editing,expression:"editing"}],staticClass:"form-control-item"},[n("el-input",{ref:"nameInput",staticStyle:{width:"160px","margin-right":"8px"},attrs:{placeholder:"请输入手风琴项标题"},model:{value:t.itemName,callback:function(e){t.itemName=e},expression:"itemName"}}),n("el-tooltip",{attrs:{"open-delay":500,content:"新增"}},[n("el-button",{staticClass:"el-icon-check",attrs:{disabled:!t.itemNameValidated},on:{click:t.addItem}})],1)],1),n("el-tooltip",{attrs:{"open-delay":500,content:"添加手风琴项"}},[n("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.editing,expression:"!editing"}],staticClass:"el-icon-plus",on:{click:t.handleAdd}})],1)],1)])},cs=[];function us(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ds(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?us(Object(n),!0).forEach((function(e){Object(at["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):us(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var fs={name:"config-acc",props:["layoutData"],data:function(){var t=this.layoutData;return{showNav:t.props.showNav,itemName:"",editing:!1}},computed:{items:function(){return this.layoutData.cols},itemNameValidated:function(){return this.itemName&&this.itemName.trim()}},filters:{getOrder:function(t){var e=t+1;return e>=10?e:"0"+e}},methods:ds(ds({},Object(_t["b"])(["activeRightTab","setSelectedCol"])),{},{submit:function(t,e){this.$store.commit({type:"setRowProps",prop:t,value:e,row:this.layoutData})},handleItemClick:function(t){var e=t.id;this.setSelectedCol({id:e}),this.activeRightTab("cell")},handleAdd:function(){var t=this;this.editing=!0,this.$nextTick((function(){t.$refs["nameInput"].focus()}))},addItem:function(){var t=this.itemName,e=this.layoutData.id,n=this.layoutData.cols.length,o={id:"col-".concat(e,"-").concat(n+1),name:t,type:"acc-item",props:{title:t,opened:!0},style:{verticalAlign:"middle",textAlign:"center",width:"100%",border:Object(kt["d"])(this.$store.state.globalStyle.border)},subs:[],controls:[]};this.$store.commit({type:"addAccItem",item:o,parentRow:this.layoutData,shuttle:!0}),this.editing=!1,this.itemName=""}}),watch:{showNav:function(t){this.submit("props.showNav",t)}}},ps=fs,hs=(n("bc87"),Object(gt["a"])(ps,ss,cs,!1,null,null,null)),ms=hs.exports;function gs(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=vs(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,r=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw r}}}}function vs(t,e){if(t){if("string"===typeof t)return bs(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bs(t,e):void 0}}function bs(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var ys={name:"config-row",props:["rowId"],components:{NameConfig:Do,ConfigAcc:ms},computed:{row:function(){var t=this.rowId;return this.$store.getters.rowDataMap[t].row},rowType:function(){return this.row.namePrefix||this.row.name},type:function(){var t=this.row.type;return t||"row-layout"}},mounted:function(){document.addEventListener("keyup",this.deleteShortcurKey)},beforeDestroy:function(){document.removeEventListener("keyup",this.deleteShortcurKey)},methods:{deleteShortcurKey:function(t){46===t.which&&this.rowId&&this.removeRow()},onNameChange:function(t){this.$store.dispatch("setLayoutProp",{value:t,prop:"name"})},removeRow:function(){var t=this,e=this.isEmptyRow(this.row);return e?this.doRemoveRow():this.$confirm("此操作将移除此行，以及此行内的所有内容，是否确认？"," 删除提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.doRemoveRow()})).catch((function(){}))},doRemoveRow:function(){var t=this.$store.getters.selectedLayoutData,e=t.index,n=t.layout,o=this.$store.getters.selectedRowParentCol;-1!=e&&n?this.$store.dispatch("deleteRow",{parentCol:o,row:n,index:e}):console.error("出现错误 无法删除")},isEmptyRow:function(t){var e,n=gs(t.cols);try{for(n.s();!(e=n.n()).done;){var o=e.value;if(o.subs.length||o.controls.length)return!1}}catch(i){n.e(i)}finally{n.f()}return!0}}},Cs=ys,ws=Object(gt["a"])(Cs,as,ls,!1,null,null,null),xs=ws.exports,Os=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"preview-wrap"},[n("iframe",{ref:"preview",attrs:{src:t.iframeUrl,height:"100%",width:"100%",frameborder:"0"}})])},Ds=[],_s=/.html/.test(location.pathname),ks={name:"preview",props:["designId","tableGuid","type"],computed:{iframeUrl:function(){var t="./preview/preview"+(_s?".html":"");return"".concat(t,"?tableGuid=").concat(this.tableGuid,"&designId=").concat(this.designId,"&viewType=").concat(this.type||"")}},mounted:function(){var t=this,e=this.$refs["preview"];this.$parent.autoSave(!0),this.$parent.getData().then((function(n){t.retry((function(){return"function"==typeof e.contentWindow.getPreviewHtml}),(function(){e.contentWindow.getPreviewHtml,e.contentWindow.getPreviewHtml(n)}))}))},methods:{retry:function(t,e){var n=this,o=0,i=function(){var i=t();if(i)e();else{if(!(o++<500))throw new Error("预览加载超时");setTimeout((function(){n.retry(t,e)}),20)}};i()}}},Ss=ks,js=(n("6758"),Object(gt["a"])(Ss,Os,Ds,!1,null,"5ae0da59",null)),Ts=js.exports,Is=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{width:"720px","append-to-body":"",title:"创建新字段",visible:t.dialogVisible,"show-close":!1}},[n("el-form",{ref:"form",attrs:{model:t.fieldProps,"label-width":"100px",rules:t.rules}},[n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"字段英文名",prop:"fieldname"}},[n("el-input",{model:{value:t.fieldProps.fieldname,callback:function(e){t.$set(t.fieldProps,"fieldname",e)},expression:"fieldProps.fieldname"}})],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"字段中文名",prop:"name"}},[n("el-input",{model:{value:t.fieldProps.name,callback:function(e){t.$set(t.fieldProps,"name",e)},expression:"fieldProps.name"}})],1)],1)],1),n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"字段类型",prop:"dbtype"}},[n("el-select",{staticStyle:{width:"100%"},on:{change:t.onDBTypeChange},model:{value:t.fieldProps.dbtype,callback:function(e){t.$set(t.fieldProps,"dbtype",e)},expression:"fieldProps.dbtype"}},t._l(t.DBDataTypes,(function(e){return n("el-option",{key:e.id,attrs:{value:e.id,label:e.text}},[t._v(t._s(e.text))])})),1)],1)],1),t.showLength?n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"字段长度"}},[n("el-input-number",{staticStyle:{width:"100%"},attrs:{controls:!1},model:{value:t.fieldProps.length,callback:function(e){t.$set(t.fieldProps,"length",e)},expression:"fieldProps.length"}})],1)],1):t._e()],1),t.showPrecision?n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"字段精度"}},[n("el-input-number",{staticStyle:{width:"100%"},attrs:{controls:!1},model:{value:t.fieldProps.precision,callback:function(e){t.$set(t.fieldProps,"precision",e)},expression:"fieldProps.precision"}})],1)],1)],1):t._e(),n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"显示类型",prop:"fielddisplaytype"}},[n("el-select",{staticStyle:{width:"100%"},model:{value:t.fieldProps.fielddisplaytype,callback:function(e){t.$set(t.fieldProps,"fielddisplaytype",e)},expression:"fieldProps.fielddisplaytype"}},t._l(t.displayTypeList,(function(e){return n("el-option",{key:e.id,attrs:{value:e.id,label:e.text}},[t._v(t._s(e.text))])})),1)],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"代码项"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{clearable:""},model:{value:t.fieldProps.datasource,callback:function(e){t.$set(t.fieldProps,"datasource",e)},expression:"fieldProps.datasource"}},t._l(t.codeList,(function(e){return n("el-option",{key:e.text,attrs:{value:e.id,label:e.text}},[t._v(t._s(e.text))])})),1)],1)],1)],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary",loading:t.inSave},on:{click:function(e){return t.create()}}},[t._v("创建")]),n("el-button",{attrs:{type:"primary",loading:t.inSave},on:{click:function(e){return t.create(!0)}}},[t._v("创建并绑定")])],1)],1)},Ps=[];function As(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Es(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?As(Object(n),!0).forEach((function(e){Object(at["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):As(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ls={computed:Es(Es({},Object(_t["e"])(["DBDataTypes","codeList","newFieldList","fieldList"])),{},{allFiledList:function(){var t=this.fieldList.length?this.fieldList[0].fields:[];return[].concat(Object(rt["a"])(t),Object(rt["a"])(this.newFieldList))},showPrecision:function(){return"Numeric"==this.fieldProps.dbtype},showLength:function(){return"nvarchar"==this.fieldProps.dbtype||"Numeric"==this.fieldProps.dbtype},displayTypeList:function(){var t=window.FORM_DESIGN_CONFIG.controlList,e=this.$store.state.extControls,n=[];return t.forEach((function(t){n.push({id:t.type,text:t.name})})),e.forEach((function(t){n.push({id:t.type,text:t.name})})),n}}),data:function(){var t=this;return{fieldProps:{fieldname:"",name:"",dbtype:"",length:18,precision:2,fielddisplaytype:"",datasource:"",fieldtype:""},displayTypeLoading:!1,dialogVisible:!1,inSave:!1,rules:{fieldname:[{required:!0,message:"字段英文名必填",trigger:"blur"},{validator:function(e,n,o){if(!/^[a-zA-Z][\da-zA-Z_]*$/.test(n))return o(new Error("仅能是字母开头加数字、字母、下划线的组合"));var i=t.allFiledList.some((function(t){return t.fieldname==n}));return i?o(new Error("字段英文名必须唯一")):o()},trigger:"blur"}],name:[{required:!0,message:"字段中文名必填",trigger:"blur"}],dbtype:[{required:!0,message:"字段类型必填",trigger:"blur"}],fielddisplaytype:[{required:!0,message:"显示类型必填",trigger:"blur"}]},autoBindFn:function(){}}},mounted:function(){this.init()},methods:{init:function(){var t=this;this.$bus.$on("createBindField",(function(e){t.dialogVisible=!0,t.autoBindFn=e,t.autoFillDisplayType()}))},setInitData:function(){this.fieldProps={fieldname:"",name:"",dbtype:"",length:18,precision:2,fielddisplaytype:"",datasource:"",fieldtype:""}},autoFillDisplayType:function(){var t=this.$store.getters.selectedControl.control;this.fieldProps.fielddisplaytype=t?t.type:""},create:function(t){var e=this;this.inSave=!0,this.$refs.form.validate((function(n){n?(e.save(t),e.$message({message:"新增成功，字段将在保存表单时进行创建",type:"success"}),e.setInitData(),e.inSave=!1,e.dialogVisible=!1):(e.$message({message:"字段信息不完整，请检查",type:"error"}),e.inSave=!1)}))},save:function(t){var e=Object(kt["d"])(this.fieldProps);this.showLength||delete e.length,this.showPrecision||delete e.precision,this.$store.commit({type:"addToNewFieldList",fieldProps:e}),t&&this.autoBindFn(e)},onDBTypeChange:function(){var t=this.fieldProps.dbtype;"Numeric"==t?(this.fieldProps.fieldtype="1",this.fieldProps.length=18):"Integer"==t?this.fieldProps.fieldtype="2":(this.fieldProps.fieldtype="0","nvarchar"==t&&(this.fieldProps.length=50))},adaptDisplayType:function(){if(this.fieldProps.fielddisplaytype){var t=this.fieldProps.fielddisplaytype,e=this.displayTypeList.some((function(e){return e.id==t}));e||(this.fieldProps.fielddisplaytype="")}}}},$s=Ls,Ms=Object(gt["a"])($s,Is,Ps,!1,null,null,null),Fs=Ms.exports,Rs=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.list.length?n("div",{staticClass:"row-container"},[t._l(t.list,(function(e,o){return n("RowGender",{key:e.id,attrs:{level:t.level,row:e,index:o,"parent-col":t.parentCol,"is-last-row":o==t.list.length-1,"prev-row":0==o?null:t.list[o-1]}})})),0===t.level?n("div",{staticClass:"hidden-area",staticStyle:{display:"none"}},t._l(t.hiddenControls,(function(t){return n("ControlGender",{key:t.id,attrs:{"control-data":t}})})),1):t._e()],2):t._e()},Ns=[],Vs=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"row",class:t.className,style:t.style,attrs:{"row-id":t.row.id,"data-name":t.row.name,"data-level":t.level}},t._l(t.row.cols,(function(e,o){return n("ColGender",{key:e.id,attrs:{"is-last-row":t.isLastRow,index:o,col:e,row:t.row,level:t.level,"row-index":t.index}})})),1)},Bs=[],zs=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"col",class:t.getColCls(t.col,t.index,t.row.cols.length),style:t.colStyle,attrs:{id:t.col.id,role:"acc-item"==t.col.type?"accordion":"",opened:t.col.props&&t.col.props.opened?"true":"false"}},["acc-item"==t.type?n("div",{attrs:{role:"head",title:t.col.props.title}}):t._e(),"acc-item"==t.type?n("div",{attrs:{role:"body"}},[n("LayoutGender",{attrs:{list:t.col.subs,level:t.levelNext,parentCol:t.col,parentRow:t.row}}),t._l(t.col.controls,(function(t){return n("ControlGender",{key:t.id,attrs:{"control-data":t}})}))],2):t._e(),"acc-item"!=t.type?n("LayoutGender",{attrs:{list:t.col.subs,level:t.levelNext,parentCol:t.col,parentRow:t.row}}):t._e(),t._l(t.col.controls,(function(e){return"acc-item"!=t.type?n("ControlGender",{key:e.id,attrs:{"control-data":e}}):t._e()}))],2)},Hs=[],Gs=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{attrs:{"need-remove":"true"}},[n(t.getControl(t.controlData.type),{tag:"component",attrs:{id:t.controlData.id,"control-data":t.controlData,asControl:!0}}),t.showTips?n("span",{staticClass:"control-tips",class:{"tips-tooltip":t.isToolTip,"action-icon":t.isToolTip,"tips-bottom":!t.isToolTip},attrs:{"data-tooltip":t.isToolTip?t.tipsContent:""}},[t._v(t._s(t.isToolTip?"":t.tipsContent))]):t._e()],1)},qs=[],Us=n("d718"),Ws=n("9e0a"),Js={label:Us["a"],title:Ws["a"]},Ys={inheritAttrs:!1,props:["id"],template:'<span class="design-control-holder" :id="id"></span>'},Xs={props:["control-data"],computed:{showTips:function(){var t=this.controlData.tooltipConfig;return t&&t.content},isToolTip:function(){var t=this.controlData.tooltipConfig;return t&&"tooltip"==t.type},tipsContent:function(){var t=this.controlData.tooltipConfig;return t&&t.content?t.content:""}},methods:{getControl:function(t){return t in Js?Js[t]:Ys}}},Ks=Xs,Qs=Object(gt["a"])(Ks,Gs,qs,!1,null,null,null),Zs=Qs.exports;function tc(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ec(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?tc(Object(n),!0).forEach((function(e){Object(at["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tc(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var nc={name:"ColLayout",components:{ControlGender:Zs},data:function(){return{}},props:{row:{type:Object,required:!0},rowIndex:{type:Number,required:!0},col:{type:Object,required:!0},index:{type:Number,required:!0},level:{type:Number,required:!0},isLastRow:{type:Boolean,required:!0}},computed:ec(ec({},Object(_t["e"])(["globalStyle"])),{},{type:function(){var t=this.col;return t&&t.type?t.type:"col-item"},levelNext:function(){return this.level+1},colStyle:function(){var t=this.col.style.width,e=t+""===t?t:"".concat(t,"px");return{width:e}}}),methods:{getColCls:function(t,e,n){var o,i=this.globalStyle,r=t.subs.length,a=t.style,l=(o={isSub:!r,hasSub:r},Object(at["a"])(o,"text-"+(a.textAlign||i.textAlign),!0),Object(at["a"])(o,"vertical-"+(a.verticalAlign||i.verticalAlign),!0),o);return l[this.type]=!0,"col-item"==this.type&&(l.first=0===e,l.mid=e&&e!==n-1,l.last=e===n-1),l}}},oc=nc,ic=Object(gt["a"])(oc,zs,Hs,!1,null,null,null),rc=ic.exports,ac={name:"row-gender",components:{ColGender:rc},props:{row:{type:Object},index:{type:Number},level:{type:Number},parentCol:{type:Object,default:null},isLastRow:{type:Boolean},prevRow:{type:Object,default:null}},computed:{type:function(){var t=this.row;return t&&t.type?t.type:"row-layout"},style:function(){var t=this.row.height,e=t+""===t?t:t+"px",n={};return"acc-layout"==this.type&&(n.marginTop="16px",n.marginBottom="16px"),"row-layout"==this.type&&(n["min-height"]=e),n},className:function(){var t,e=this.type,n=(t={},Object(at["a"])(t,e,!0),Object(at["a"])(t,"isTop",0==this.level),t);return"acc-layout"==e?(n["fui-accordions"]=!0,n):(0===this.index||this.prevRow&&this.prevRow.type&&"row-layout"!=this.prevRow.type?n.first=!0:n.mid=!0,n)}}},lc=ac,sc=Object(gt["a"])(lc,Vs,Bs,!1,null,null,null),cc=sc.exports,uc={name:"LayoutGender",components:{RowGender:cc,ControlGender:Zs},props:{list:{type:Array,default:function(){return[]}},level:{type:Number,default:0},parentCol:{type:Object,default:null},parentRow:{type:Object,default:null}},computed:{hiddenControls:function(){return this.$store.state.hiddenControls}},methods:{getHtmlContent:function(){var t=this;return new Promise((function(e,n){t.$nextTick((function(){var n=t.$el.innerHTML;if(!n)return e("");n=n.replace(/<!---->/g,""),n=n.replace(/<section need-remove="true">(.*?)<\/section>/g,"$1"),e(n)}))}))}}},dc=uc,fc=Object(gt["a"])(dc,Rs,Ns,!1,null,null,null),pc=fc.exports,hc=n("4be7"),mc=n("9827"),gc=n("84a2"),vc=n.n(gc),bc=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"design-head"},[n("span",{staticClass:"design-tittle"},[t._v(t._s(t.formTitle))]),n("Shuttle",{directives:[{name:"show",rawName:"v-show",value:!t.showPreview,expression:"!showPreview"}],ref:"shuttle",staticClass:"header-btn-group"}),n("span",{directives:[{name:"show",rawName:"v-show",value:!t.showPreview,expression:"!showPreview"}],staticClass:"header-btn-group"},[n("span",{staticClass:"header-btn js-btn",attrs:{type:"text",size:"mini",title:"打开js编辑"},on:{click:function(e){return t.openEditor("js")}}}),n("span",{staticClass:"header-btn css-btn",attrs:{type:"text",size:"mini",title:"打开css编辑"},on:{click:function(e){return t.openEditor("css")}}}),n("span",{staticClass:"header-btn view-design-btn",class:{active:!0===t.viewDesign},attrs:{title:t.viewDesign?"切换为真实模式":"切换为设计模式",size:"mini",type:"text"},on:{click:t.toggleViewDesign}})]),n("span",{directives:[{name:"show",rawName:"v-show",value:!t.showPreview,expression:"!showPreview"}],staticClass:"header-btn-group"},[n("span",{staticClass:"header-btn pc",class:{active:"pc"==t.viewType},attrs:{title:"查看pc端设计"},on:{click:function(e){return t.updateViewType("pc")}}}),n("span",{staticClass:"header-btn mobile",class:{active:"mobile"==t.viewType},attrs:{title:"查看移动端设计"},on:{click:function(e){return t.updateViewType("mobile")}}})]),n("div",{staticClass:"design-head-right",staticStyle:{float:"right"}},[n("el-button",{staticClass:"preview-btn",attrs:{size:"mini"},on:{click:function(e){return t.setShowPreview(!t.showPreview)}}},[t._v(t._s(t.showPreview?"退出预览":"预览"))]),n("el-dropdown",{staticStyle:{"margin-left":"10px"},attrs:{"split-button":"",type:"primary",trigger:"click",size:"mini"},on:{click:t.onSaveClick,command:t.onDropDownItemClick}},[t._v("\n      保存\n      "),n("el-dropdown-menu",{staticClass:"save-menu",attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"saveToTpl"}},[t._v("另存为模板")]),n("el-dropdown-item",{attrs:{command:"saveToNewVersion"}},[t._v("生成新版本")]),n("el-dropdown-item",{attrs:{command:"saveToCopy"}},[t._v("生成副本")])],1)],1)],1),n("el-dialog",{attrs:{"append-to-body":"",title:t.editorDialog.title,visible:t.editorDialog.show,width:"90","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!0,fullscreen:"","custom-class":"code-editor-dialog","before-close":t.closeEditorDialog},on:{"update:visible":function(e){return t.$set(t.editorDialog,"show",e)},opened:t.onEditorDialogOpened}},[t.editorDialog.display?n("Editor",{attrs:{code:t.editorDialog.code,language:t.editorDialog.lang},on:{save:t.saveEditorCode,cancel:t.closeEditorDialog}}):t._e()],1)],1)},yc=[],Cc=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"form-shuttle-btns"},[n("el-tooltip",{attrs:{"open-delay":200,content:t.canUndo?"撤销":"无可撤销的操作"}},[n("span",{staticClass:"header-btn form-icon-undo",class:{disabled:!t.canUndo},on:{click:t.undo}})]),n("el-tooltip",{attrs:{"open-delay":200,content:t.canRedo?"还原":"无可还原的操作"}},[n("span",{staticClass:"header-btn form-icon-redo",class:{disabled:!t.canRedo},on:{click:t.redo}})])],1)},wc=[],xc=null,Oc=function(t){var e={};return t.forEach((function(t){e[t]=!0})),e}(["activeRightTab","updateLineTop","updateLineLeft","showHLine","hideHLine","showVLine","hideVLine","layoutDragStart","layoutDragEnd","controlDragStart","controlDragEnd","toggleViewDesign","updateViewType","setJsCode","setCssCode","addToNewFieldList"]),Dc=function(t){var e={};return t.forEach((function(t){e[t]=!0})),e}(["updateRowHeight","updateColWidth"]),_c={name:"shuttle",data:function(){return{history:[],future:[]}},mounted:function(){document.addEventListener("keyup",this.initShortcutKey)},beforeDestroy:function(){document.removeEventListener("keyup",this.initShortcutKey)},computed:{canUndo:function(){return this.history.length},canRedo:function(){return this.future.length}},methods:{init:function(){window.shuttleManager=this,this.subscribeStore()},subscribeStore:function(){var t=this;xc=JSON.stringify(this.$store.state);var e=function(e,n){var o=e.type;e.payload&&e.payload.shuttle&&t.storeState(o,xc,e.payload.group),xc=JSON.stringify(n)},n=vc()(e,300,{leading:!0,trailing:!1});this.$store.subscribe((function(t,o){var i=t.type;Oc[i]||(Dc[i]?n(t,o):e(t,o))}))},addHistory:function(t){if(t.group){for(var e=-1,n=0,o=this.history.length;n<o;n++){if(this.history[n].group!=t.group)break;e=n}-1===e&&this.history.unshift(t)}else this.history.unshift(t);this.history.length>10&&(this.history.length=10)},addFuture:function(t){this.future.unshift(t),this.future.length>10&&(this.future.length=10)},storeState:function(t,e,n){var o={name:t,state:e,group:n};this.addHistory(o),this.future=[]},undo:function(){if(this.canUndo){var t={name:"undo",state:JSON.stringify(this.$store.state)};this.addFuture(t);var e=this.history.shift();this.shuttle(e.state),xc=JSON.stringify(this.$store.state)}},redo:function(){if(this.canRedo){var t={name:"undo",state:JSON.stringify(this.$store.state)};this.addHistory(t);var e=this.future.shift();this.shuttle(e.state),xc=JSON.stringify(this.$store.state)}},shuttle:function(t){var e=JSON.parse(t);e.helper.showVLine=!1,e.helper.showHLine=!1,e.helper.inControlDragging=!1,e.helper.inLayoutDragging=!1,e.leftActiveTab=this.$store.state.leftActiveTab,e.rightActiveTab=this.$store.state.rightActiveTab,this.$store.replaceState(e)},initShortcutKey:function(t){t.ctrlKey&&90==t.which?this.undo():t.ctrlKey&&89==t.which&&this.redo()}}},kc=_c,Sc=(n("aeeb"),Object(gt["a"])(kc,Cc,wc,!1,null,null,null)),jc=Sc.exports,Tc=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"editor-wrap"},[n("div",{staticClass:"editor-toolbar"},[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.handleDialogClose("save")}}},[t._v("保存")]),n("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.handleDialogClose("cancel")}}},[t._v("取 消")]),n("el-tooltip",{attrs:{"open-delay":200,content:"格式化"}},[n("el-button",{attrs:{size:"mini",icon:"el-icon-s-grid"},on:{click:t.format}})],1),n("el-tooltip",{attrs:{"open-delay":200,content:"搜索替换"}},[n("el-button",{attrs:{size:"mini",icon:"el-icon-search"},on:{click:t.search}})],1)],1),n("div",{staticClass:"editor-main"},[n("div",{ref:"editorEl",staticClass:"editor-el",class:{"with-right":"javascript"==t.language}}),"javascript"==t.language?n("div",{staticClass:"editor-right"},[n("div",{staticClass:"editor-right-search"},[n("el-input",{attrs:{placeholder:"输入关键词进行过滤"},model:{value:t.searchInputValue,callback:function(e){t.searchInputValue=e},expression:"searchInputValue"}},[n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),n("div",{staticClass:"scroll-wrap"},[n("Accordion",{attrs:{title:"控件"}},[t.filteredControlList.length?n("ul",{staticClass:"control-list"},t._l(t.filteredControlList,(function(e){return n("li",{key:e.id,on:{click:function(n){return t.addControl(e.id,e.type)}}},[t._v(t._s(e.name))])})),0):n("div",{staticClass:"control-list empty"},[t._v("无匹配控件")])]),n("Accordion",{attrs:{title:"常用值"}},[n("ul",{staticClass:"control-list"},t._l(t.valueList,(function(e){return n("li",{key:e.id,on:{click:function(n){return t.addValue(e.id)}}},[t._v(t._s(e.text))])})),0)])],1)]):t._e()])])},Ic=[],Pc=(n("3b2b"),"./monaco-editor/vs");function Ac(){if(window.__MONACO_PROMISE__)return window.__MONACO_PROMISE__;var t="\n    require.config({\n      paths: {\n        'vs': '".concat(Pc,"'\n      }\n    });\n    require.config({\n      'vs/nls' : {\n        availableLanguages: {\n          '*': 'zh-cn'\n        }\n      }\n    });\n    require(['vs/editor/editor.main'], function () {\n      window.__monaco_editor__ = monaco;\n    });\n  "),e=new Promise((function(t,e){var n=document.createElement("script");n.id="monaco-editor-loader",n.src=Pc+"/loader.js",n.onload=function(){n.onload=null,t("loader")},n.onerror=function(){n.onerror=null,e("monaco-editor资源加载失败")},document.body.appendChild(n)})).then((function(){return new Promise((function(e,n){var o=document.createElement("script");o.text=t,o.onerror=function(){o.onerror=null,n("monaco-editor资源加载失败")},document.body.appendChild(o),e("editor")}))})).then((function(){return new Promise((function(t,e){var n,o=0;function i(){window.__monaco_editor__?(clearTimeout(n),t(window.__monaco_editor__)):o++<1e3?setTimeout(i,30):e("monaco-editor资源加载失败")}i()}))}));return window.__MONACO_PROMISE__=e}function Ec(t,e,n){var o;return e=e||17,function(){var i=arguments,r=n||this;clearTimeout(o),o=setTimeout((function(){t.apply(r,i)}),e)}}var Lc={name:"Editor",components:{Accordion:zt},props:{language:{type:String,default:"javascript",validator:function(t){return-1!==["javascript","css"].indexOf(t)}},code:{type:String,default:["function x() {",'    console.log("Hello world!");',"}",""].join("\n")}},data:function(){var t={defaultCode:{javascript:["epoint.onAfterInit = function (customData) {","    // 这个方法将在 页面initPage之后被调用\n    ","};","function myScriptFn() {","\t/* todo something */\n\t","}",""].join("\n"),css:"/* 在下面加入您的 css  */ \n"},editor:null,searchInputValue:""};return t.codeText=this.code||t.defaultCode[this.language],t},computed:{valueList:function(){return Object(kt["d"])(window.FORM_DESIGN_CONFIG.preset["epointsform.specificValues"])},controlList:function(){var t=this.$store.state.hiddenControls,e=this.$store.getters.allControls,n=[];return t.forEach((function(t){n.push({id:t.id,type:t.type,name:t.name||t.namePrefix+t.autoIndex})})),e.forEach((function(t){n.push({id:t.id,type:t.type,name:t.name||t.namePrefix+t.autoIndex})})),n},filteredControlList:function(){var t=this.controlList,e=this.searchInputValue;if(!e)return t;var n=new RegExp(e,"i");return t.filter((function(t){return n.test(t.name)}))}},mounted:function(){var t=this;"javascript"!=this.language?this.initEditor(this.codeText):this.loadTypes().then((function(){t.initEditor(t.codeText)}))},beforeDestroy:function(){window.removeEventListener("resize",this.adaptLayout),this.editor&&this.editor.dispose()},methods:{handleDialogClose:function(t){this.$emit(t,this.editor.getValue())},_adaptLayout:function(){this.editor&&this.editor.layout()},search:function(){this.editor._actions["actions.find"].run()},format:function(){this.editor._actions["editor.action.formatDocument"].run()},addControl:function(t,e){var n="label"==e||"title"==e?"$('#".concat(t,"')."):"mini.get('".concat(t,"').");this.insertText(n),this.editor._actions["editor.action.triggerSuggest"].run()},addValue:function(t){this.insertText(t)},insertText:function(t){var e=this.editor.getPosition();this.editor.executeEdits("",[{range:{startLineNumber:e.lineNumber,startColumn:e.column,endLineNumber:e.lineNumber,endColumn:e.column},text:t}]);var n=this.editor.getSelection();n.selectionStartColumn=n.startColumn=n.endColumn,n.selectionStartLineNumber=n.startLineNumber=n.endLineNumber,this.editor.setSelection(n),this.editor.focus()},initEditor:function(t){var e=this;this.adaptLayout=Ec(this._adaptLayout,200),window.addEventListener("resize",this.adaptLayout),Ac().then((function(n){window.__meditor=e.editor=n.editor.create(e.$refs.editorEl,{value:t||"",language:e.language,lineHeight:26,autoIndent:!0,formatOnPaste:!0,lineNumbers:"on",minimap:!0,tabCompletion:"on",quickSuggestions:{comments:!0},snippetSuggestions:"top",accessibilitySupport:"on",suggest:{}}),e.editor.focus()}))},loadTypes:function(){var t=this,e={"content-type":"text/plain; charset=UTF-8"};return Ac().then((function(n){return t.$httpGet("./types/mini-snippets.json",!0,e).then((function(t){var e=JSON.parse(t);e.forEach((function(t){t.kind=n.languages.CompletionItemKind.Function,t.detail=t.documentation})),n.languages.registerCompletionItemProvider("javascript",{provideCompletionItems:function(){return{suggestions:e}}})})).then((function(){t.$httpGet("./types/jquery.d.ts",!0,e).then((function(t){n.languages.typescript.javascriptDefaults.addExtraLib(t,"jquery.d.ts")})),t.$httpGet("./types/miniui.d.ts",!0,e).then((function(t){n.languages.typescript.javascriptDefaults.addExtraLib(t,"miniui.d.ts")})),t.$httpGet("./types/epoint.d.ts",!0,e).then((function(t){n.languages.typescript.javascriptDefaults.addExtraLib(t,"epoint.d.ts")}))}))}))}}},$c=Lc,Mc=(n("58d3"),Object(gt["a"])($c,Tc,Ic,!1,null,null,null)),Fc=Mc.exports;function Rc(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Nc(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Rc(Object(n),!0).forEach((function(e){Object(at["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Rc(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Vc={name:"Header",props:{formTitle:{type:String},inPreview:{type:Boolean}},components:{Shuttle:jc,Editor:Fc},data:function(){return{editorDialog:{title:"",show:!1,code:"",display:!1,lang:""}}},computed:Nc(Nc({},Object(_t["e"])(["jsCode","cssCode"])),Object(_t["e"])({viewType:function(t){return t.helper.viewType},viewDesign:function(t){return t.helper.viewDesign},showPreview:function(t){return t.helper.showPreview}})),methods:Nc(Nc({},Object(_t["d"])(["setJsCode","setCssCode","updateViewType","toggleViewDesign"])),{},{setShowPreview:function(t){this.$store.commit({type:"setShowPreview",showPreview:t})},openEditor:function(t){var e,n,o;"js"==t?(e=this.jsCode,n="js编辑",o="javascript"):(e=this.cssCode,n="css编辑",o="css"),this.editorDialog.title=n,this.editorDialog.code=e,this.editorDialog.lang=o,this.editorDialog.show=!0},onEditorDialogOpened:function(){this.editorDialog.display=!0},saveEditorCode:function(t){"javascript"==this.editorDialog.lang?this.setJsCode(t):"css"==this.editorDialog.lang&&this.setCssCode(t),this._closeEditorDialog()},_closeEditorDialog:function(){this.editorDialog.display=this.editorDialog.show=!1},closeEditorDialog:function(){var t=this;this.$confirm("不需要保存此次的代码修改吗？","保存提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t._closeEditorDialog()})).catch((function(t){console.error(t)}))},onSaveClick:function(){var t=this,e=this.$store.state.design&&this.$store.state.design.length;e?this.$emit("save-click"):this.$confirm("无设计数据，继续保存将提交空数据，是否继续？","保存提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$emit("save-click")})).catch((function(t){t&&console.error(t)}))},onDropDownItemClick:function(t){this.$emit("drop-item-click",t)}})},Bc=Vc,zc=(n("c0a5"),n("20fd"),Object(gt["a"])(Bc,bc,yc,!1,null,null,null)),Hc=zc.exports,Gc=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{title:"生成新版本",visible:!0,"custom-class":"new-version-dialog",width:"420px",top:"calc(50vh - 100px)","show-close":!1}},[n("p",{staticStyle:{margin:"0"}},[t._v("在一个新版本中编辑表单，原版本将被保留")]),n("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules}},[n("el-form-item",{attrs:{label:"选择模板结构",prop:"tplId"}},[n("el-select",{attrs:{size:"mini",filterable:""},model:{value:t.form.tplId,callback:function(e){t.$set(t.form,"tplId",e)},expression:"form.tplId"}},t._l(t.list,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})})),1)],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:t.cancel}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v("确 定")])],1)],1)},qc=[],Uc={props:["visible"],data:function(){return{form:{tplId:""},list:[],rules:{tplId:[{required:!0,message:"必须选择模板",trigger:"blur"}]}}},mounted:function(){this.getData()},methods:{getData:function(){var t=this;this.$httpPost(window.formDesignerActions.getSFormTplUrl).then((function(e){var n=e.list;Array.isArray(n)&&(t.list=n)}))},confirm:function(){var t=this;this.$refs.form.validate((function(e){e&&t.save(t.form.tplId).then((function(){t.cancel()}))}))},cancel:function(){document.body.removeChild(this.$el),this.$destroy()}}},Wc=Uc,Jc=(n("caff"),Object(gt["a"])(Wc,Gc,qc,!1,null,null,null)),Yc=Jc.exports;function Xc(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Kc(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Xc(Object(n),!0).forEach((function(e){Object(at["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xc(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Qc=tt["default"].extend(Yc),Zc=new URLSearchParams(location.search),tu=Zc.get("designId")||"",eu=Zc.get("tableGuid")||"",nu={name:"app-main",components:{Header:Hc,Preview:Ts,Tabs:xt,TabPanel:bt,PanelLayout:Et,PanelData:oe,Design:ye,MobileDesign:Xe,ConfigCell:Jn,ConfigForm:go,PanelControl:Wt,ConfigControl:rs,ConfigRow:xs,LayoutGender:pc,NewFiledDialog:Fs},data:function(){return{autoSaveTimer:null,autoSaveInterval:6e4,needAutoSave:!1,dataLoaded:!1,formTitle:"表单设计器",needRender:!1,showLocalBtns:/useMock/i.test(location.search),enableRightBarCover:!0,narrowMode:!1,rightbarHidden:!1,designId:tu,tableGuid:eu}},computed:Kc(Kc(Kc(Kc({},Object(_t["e"])(["leftActiveTab","rightActiveTab","formSize","selectedColId","hiddenControls","selectedRowId","jsCode","cssCode","newFieldList","mobileDesignData"])),Object(_t["e"])({viewDesign:function(t){return t.helper.viewDesign},viewType:function(t){return t.helper.viewType},showPreview:function(t){return t.helper.showPreview}})),Object(_t["c"])(["codeListMap","selectedCol"])),{},{selectedControl:function(){var t=this.$store.state.selectedControlId;if(t){var e=this.$store.getters.controlDataMap[t];if(e&&e.control)return e.control}return null},cellPanelName:function(){return this.selectedColId&&this.selectedCol&&"acc-item"==this.selectedCol.type?"手风琴项":"单元格"},globalStyle:{get:function(){return this.$store.state.globalStyle},set:function(t){this.$store.commit("updateGlobalStyle",{style:t})}},design:{get:function(){return this.$store.state.design},set:function(t){this.$store.commit("updateDesign",t)}}}),mounted:function(){var t=this,e=this;window.FORM_DESIGNER.save=function(t){return e.saveToServer(t)},this.enableRightBarCover&&(this.calcWidth(),window.addEventListener("resize",this.calcWidth)),hc["Promise"].all([this.$httpPost(window.formDesignerActions.getUrl,{designId:tu,tableGuid:eu}),this.$httpPost(window.formDesignerActions.getCodeItemUrl,{designId:tu,tableGuid:eu})]).then((function(e){var n=e[0],o=e[1].codeMain,i=n.extControls,r=n.fieldList,a=n.designData,l=n.macroTypes,s=n.sourceTables,c=n.dataTables,u=n.dataType,d=n.commonFields;if(Array.isArray(d)&&t.setCommonControls(d),r&&r.length&&(r.forEach((function(t){t.fields.forEach((function(t){t.required=1==parseInt(t.required,10),t.fieldtype=parseInt(t.fieldtype,10)}))})),t.setFieldList(r)),n.name&&(t.formTitle=n.name,document.title=t.formTitle),o&&o.length&&t.setCodeList(o),l&&l.length&&t.setMacroTypes(l),i&&i.length&&t.setExtControls(i),s&&s.length&&t.setSourceTables(s),c&&c.length&&t.setDataTables(c),n.jsCode&&t.setJsCode(Object(kt["e"])(n.jsCode)),n.cssCode&&t.setCssCode(Object(kt["e"])(n.cssCode)),u&&t.setDBDataTypes(u),a){a.globalStyle&&(t.globalStyle=a.globalStyle),a.design&&(t.design=a.design),a.mobileDesignData&&t.$store.commit({type:"replaceMobileDesign",mobileDesignData:a.mobileDesignData}),a.hiddenControls&&t.$store.commit("setHiddenControls",a.hiddenControls),a.skin&&t.$store.commit("setSkin",{skinName:a.skin}),mc["c"].control.adapt(t.$store.getters.allControls),mc["c"].control.adapt(t.$store.state.hiddenControls),mc["c"].col.adapt(t.design),kt["l"].adapt(t.$store.getters.allRows,(function(t){return t.id})),t.$store.commit({type:"controlCompatible",controls:t.$store.getters.allControls}),t.dataLoaded=!0;var f=parseInt(n.autoSaveTime,10);f&&(t.autoSaveInterval=f),t.$nextTick((function(){t.$refs.header.$refs.shuttle.init()})),t.subscribeStore(),t.doAutoSave()}})).catch((function(t){console.error(t)})),this.$httpPost(window.formDesignerActions.getListInfoUrl,{designId:tu,tableGuid:eu}).then((function(e){var n=e.SformListInfo;Array.isArray(n)&&t.$store.commit("setButtonEditPopupList",n)})).catch((function(t){console.error(t)}))},methods:Kc(Kc(Kc({},Object(_t["d"])(["activeLeftTab","setFieldList","setCodeList","setMacroTypes","setExtControls","setSourceTables","setDataTables","setJsCode","setCssCode","setDBDataTypes","setCommonControls"])),Object(_t["b"])(["activeRightTab"])),{},{calcWidth:vc()((function(){this.narrowMode=window.innerWidth<1610}),20,{leading:!0,trailing:!0}),clear:function(){this.design=[]},preview:function(){var t=this;return this.getData().then((function(e){var n=e.build,o='\n      <!DOCTYPE html>\n      <html lang="en">\n      <head>\n          <meta charset="UTF-8">\n          <meta name="viewport" content="width=device-width, initial-scale=1.0">\n          <meta http-equiv="X-UA-Compatible" content="ie=edge">\n          <title>Document</title>\n          <style>html,body{margin:0;padding:0;}.container{margin:0 auto;}</style>\n          <style>.row{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap}.col{position:relative;-webkit-box-sizing:border-box;box-sizing:border-box;box-sizing:border-box;min-height:30px;padding:6px;line-height:30px;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0}.col.hasSub{padding:0}.col>*{position:relative;z-index:1}.col:after{position:absolute;z-index:0;top:0;right:0;bottom:0;left:0;display:block;-webkit-box-sizing:border-box;box-sizing:border-box;content:"";background:transparent}.col.hasSub:after{border-top-width:0 !important;border-right-width:0 !important;border-bottom-width:0 !important;border-left-width:0 !important}.col.mid:after{border-left-width:0 !important}.col.mid>.row>.col.first:after,.col.mid>.row-container>.row>.col.first:after,.col.last>.row>.col.first:after,.col.last>.row-container>.row>.col.first:after{border-left-width:0 !important}.col.mid ~ .col.last:after,.col.first ~ .col.last:after{border-left-width:0 !important}.row.mid>.col:after{border-top-width:0 !important}.row.mid>.col>.row>.col:after,.row.mid>.col>.dropArea>.row>.col:after{border-top-width:0 !important}.col{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}.col.text-left{text-align:left}.col.text-center{text-align:center}.col.text-right{text-align:right}.col.vertical-top{vertical-align:top}.col.vertical-middle{vertical-align:middle}.col.vertical-bottom{vertical-align:bottom}.col.text-left{-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start}.col.text-center{-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.col.text-right{-webkit-box-align:end;-webkit-align-items:flex-end;-ms-flex-align:end;align-items:flex-end}.col.vertical-top{-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start}.col.vertical-middle{-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center}.col.vertical-bottom{-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end}.design-form-title,.design-form-label{position:relative;display:block;-webkit-box-sizing:border-box;box-sizing:border-box;width:100%}.design-form-label{padding-right:8px}.design-form-label.required:after{position:absolute;top:50%;right:-2px;display:block;width:8px;height:16px;margin-top:-8px;font-size:16px;line-height:16px;content:"*";color:red}.mini-textbox-readOnly .mini-textbox-border,.mini-textbox-readOnly .mini-textbox-input,.mini-buttonedit-readOnly .mini-buttonedit-border,.mini-buttonedit-readOnly .mini-buttonedit-input,.mini-readonly .mini-textboxlist-border{cursor:default;border:0;background:none}.mini-buttonedit-readOnly .mini-buttonedit-button,.mini-readonly .mini-textboxlist-close{display:none}.mini-readonly .mini-textboxlist-item{padding-right:8px}.row.acc-layout{display:block;padding-left:0;padding-right:0}.col.acc-item{display:block}.col.acc-item>.fui-acc-bd{padding-left:0;padding-right:0}.col.acc-item:after{border:none !important}</style>\n          <style>'.concat(n.style,'</style>\n      </head>\n      <body>\n          <div class="container" style="width:').concat(t.formSize.width,'px;">').concat(n.html,"</div>\n      </body>\n      </html>\n      "),i=new Blob([o],{type:"text/html"}),r=document.createElement("a");r.download="测试表单设计器生成布局",r.href=URL.createObjectURL(i),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.html=o}))},getMobileData:function(){var t=Object(kt["d"])(this.mobileDesignData),e=this.$store.getters.controlDataMap;return t.forEach((function(t){if(t.control){var n=t.control.id;e[n]&&(t.control=e[n].control)}})),this.$store.commit({type:"replaceMobileDesign",mobileDesignData:t}),t},getData:function(){var t,e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{htmlEncode:!0,withBuild:!0},o="";return n.withBuild?(t=this.getHtml(),o=this.getStyle()):t=hc["Promise"].resolve(""),t.then((function(t,i){if(i)return console.error(i);var r=e.getDesignData(),a=r.hiddenControls,l=Object(kt["d"])(e.$store.getters.allControls);l.push.apply(l,Object(rt["a"])(a));var s={designData:r,build:{html:t,style:o},controls:l,jsCode:Object(kt["f"])(e.jsCode),cssCode:Object(kt["f"])(e.cssCode),newFieldList:Object(kt["d"])(e.newFieldList),designId:tu,tableGuid:eu};return n.withBuild&&0!=n.htmlEncode&&s.build.html&&(s.build.html=Object(kt["h"])(s.build.html)),s}))},getDesignData:function(){this.$store.dispatch("dealSubmitControl");var t=Object(kt["d"])(this.hiddenControls);return{globalStyle:Object(kt["d"])(this.globalStyle),hiddenControls:t,design:Object(kt["d"])(this.design),skin:this.$store.state.skin,mobileDesignData:this.getMobileData()}},autoCreateField:function(){var t=this,e=[].concat(Object(rt["a"])(this.$store.getters.allControls),Object(rt["a"])(this.$store.state.hiddenControls));if(!e||!e.length)return hc["Promise"].resolve();var n=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o=e.filter((function(t){return n(t,"bind")&&""==t.bind}));if(!o.length)return hc["Promise"].resolve();var i=Object(kt["d"])(o);return i.forEach((function(t){t.name||(t.name=t.namePrefix+(t.autoIndex||""))})),this.$httpPost(window.formDesignerActions.autoCreateFieldUrl,{designId:tu,tableGuid:eu,controls:i}).then((function(e){var n=e.fieldList;if(!Array.isArray(n)||!n.length)return console.error("未获取到自动创建的字段数据"),hc["Promise"].reject(new Error("自动创建字段时失败"));var i=n.reduce((function(t,e){return t[e.controlId]?t[e.controlId]=[t[e.controlId],e]:t[e.controlId]=e,t}),{});t.$store.dispatch({type:"bindFieldToControl",fieldMaps:i,controls:o,newFieldList:n.map((function(t){var e=Object(kt["d"])(t);return delete e.controlId,e}))})}))},mergeAndRestAnalyData:function(t){return Lo()(t,{analysis:Kc({},window.FORM_DESIGNER_ANALYSIS)}),window.FORM_DESIGNER_ANALYSIS.reset(),t},saveToServer:function(t){var e=this;return this.autoCreateField().then((function(){return e.getData()})).then((function(t){if(window.FORM_DESIGNER&&window.FORM_DESIGNER.validateBeforeSave&&"function"==typeof window.FORM_DESIGNER.validate){var n=window.FORM_DESIGNER.validate(t);if(!1===n)return hc["Promise"].reject(new Error("校验失败"));if(n&&n.then)return n.then((function(){return e.$httpPost(window.formDesignerActions.saveUrl,e.mergeAndRestAnalyData(t))}))}return e.$httpPost(window.formDesignerActions.saveUrl,e.mergeAndRestAnalyData(t))})).then((function(n){var o=n;if(1!=parseInt(o.msg,10))throw new Error(o.msg||o);!t&&e.$msgbox({title:"系统提醒",message:"保存成功",type:"success",showClose:!0,callback:function(){location.reload()}})})).catch((function(t){e.$msgbox({title:"系统提醒",message:"保存失败 "+(t&&t.message||""),type:"error",showClose:!0})}))},promptAndSave:function(t,e){return this.$msgbox(Lo()({closeOnClickModal:!1,showInput:!0,confirmButtonText:"确定",cancelButtonText:"取消",showCancelButton:!0,showConfirmButton:!0,beforeClose:function(t,n,o){if("confirm"===t){n.$type="prompt";var i=n.validate();if(!i)return;n.confirmButtonLoading=!0,e(n.inputValue).then((function(){o()})).finally((function(){n.confirmButtonLoading=!1}))}else o()}},t))},handleCommand:function(t){var e=this;return"saveToTpl"==t?this.promptAndSave({message:"请输入模板名称",title:"创建模板",inputValue:"".concat(this.formTitle,"_模板_1"),inputValidator:function(t){return t&&t.trim()?!!/^[.\d\w-_\u4E00-\u9FA5]+$/.test(t)||"模板名称格式不正确":"模板名称不能为空"}},(function(t){return e.saveAsTpl(t)})):("saveToNewVersion"===t&&this.confirmNewVersion(),"saveToCopy"===t?this.promptAndSave({confirmButtonText:"生成",message:"请输入表单名称",title:"生成副本",inputValue:"".concat(this.formTitle,"_副本_1"),inputValidator:function(t){return t&&t.trim()?!!/^[.\d\w-_\u4E00-\u9FA5]+$/.test(t)||"表单名称格式不正确":"表单名称不能为空"}},(function(t){return e.saveAsCopy(t)})):void 0)},saveAsTpl:function(t){var e=this;return this.getData().then((function(n){return n.name=t,e.$httpPost(window.formDesignerActions.saveAsTplUrl,n)})).then((function(t){return e.$message({type:"success",message:"模板保存成功"}),hc["Promise"].resolve()})).catch((function(t){return console.error(t),e.$message({type:"error",message:"模板保存失败",showClose:!0,duration:3e3}),hc["Promise"].reject()}))},confirmNewVersion:function(){var t=this,e=new Qc({el:document.createElement("div")});e.save=function(e){return t.saveAsNewVersion(e)},document.body.appendChild(e.$el)},saveAsNewVersion:function(t){var e=this;return this.getData({withBuild:!1}).then((function(n){return n.tplId=t,e.$httpPost(window.formDesignerActions.saveAsNewVersionUrl,n)})).then((function(t){e.$confirm("新版本创建成功，是否进入新表单进行设计","提示",{confirmButtonText:"开始设计",cancelButtonText:"留在当前页"}).then((function(){var e=t.tableGuid,n=t.designId,o="".concat(location.pathname,"?tableGuid=").concat(e||"","&designId=").concat(n||"");location.replace(o)}))})).catch((function(t){return console.error(t),e.$message({type:"error",message:"新版本创建失败",showClose:!0,duration:3e3,offset:window.innerHeight/4*3>>0}),hc["Promise"].reject()}))},saveAsCopy:function(t){var e=this;return this.getData({withBuild:!1}).then((function(n){return n.name=t,e.$httpPost(window.formDesignerActions.saveAsCopyUrl,n)})).then((function(t){return e.$message({type:"success",message:"表单副本保存成功"}),setTimeout((function(){e.$confirm("新表单创建成功，是否进入新表单进行设计","提示",{confirmButtonText:"开始设计",cancelButtonText:"留在当前页"}).then((function(){var e=t.tableGuid,n=t.designId,o="".concat(location.pathname,"?tableGuid=").concat(e||"","&designId=").concat(n||"");location.replace(o)}))}),100),hc["Promise"].resolve()})).catch((function(t){return console.error(t),e.$message({type:"error",message:"表单副本保存失败",showClose:!0,duration:3e3,offset:window.innerHeight/4*3>>0}),hc["Promise"].reject()}))},replaceDesign:function(t){t.globalStyle&&(this.globalStyle=t.globalStyle),this.design=t.design||[],this.$store.commit("setHiddenControls",t.hiddenControls||[]),this.$store.commit("setSkin",{skinName:t.skin}),mc["c"].control.adapt(this.$store.getters.allControls),mc["c"].control.adapt(this.$store.state.hiddenControls),mc["c"].col.adapt(this.design),kt["l"].adapt(this.$store.getters.allRows,(function(t){return t.id}))},subscribeStore:function(){var t=this;this.$store.subscribe((function(){t.needAutoSave=!0})),this.subscribeStore=function(){}},autoSave:function(t){var e=this;if(!this.needAutoSave)return hc["Promise"].resolve();var n={designData:this.getDesignData(),newFieldList:Object(kt["d"])(this.newFieldList)};return this.$httpPost(window.formDesignerActions.autoSaveUrl,Lo()({designId:tu,tableGuid:eu},n)).then((function(n){var o=n;if(1!=parseInt(o.msg,10))throw new Error(o.msg||o);!t&&e.$message({title:"系统提醒",message:"自动保存成功",type:"success",showClose:!0}),e.$store.commit("submitNewFieldList"),e.needAutoSave=!1})).catch((function(t){e.$message({title:"系统提醒",message:"自动保存失败 "+t.message,type:"error",showClose:!0})}))},doAutoSave:function(){var t=this;clearTimeout(this.autoSaveTimer),this.autoSaveTimer=setTimeout((function(){t.autoSave().finally((function(){t.doAutoSave()}))}),this.autoSaveInterval||6e4)},getStyle:function(){return this.$store.getters.colStyleText},getHtml:function(){var t=this;return this.needRender=!0,new hc["Promise"]((function(e,n){var o=setTimeout((function(){n({msg:"渲染超时！！！"})}),3e3);t.$nextTick((function(){t.$refs.builder.getHtmlContent().then((function(n){e(n),clearTimeout(o),t.needRender=!1}))}))})).catch((function(e){t.needRender=!1,console.error(e)}))}}),beforeDestroy:function(){this.enableRightBarCover&&window.removeEventListener("resize",this.calcWidth),clearTimeout(this.autoSaveTimer)},watch:{design:{deep:!1,handler:function(t){JSON.stringify(t)!=JSON.stringify(this.design)&&this.$store.commit("updateDesign",t)}}}},ou=nu,iu=(n("bec5"),n("3176"),Object(gt["a"])(ou,ot,it,!1,null,null,null)),ru=iu.exports,au={name:"app",components:{Main:ru},data:function(){return{height:window.innerHeight}},mounted:function(){window.addEventListener("resize",this.handelResize),this.handleIE()},methods:{handelResize:function(){var t=this;clearTimeout(this._resizeTimer),this._resizeTimer=setTimeout((function(){t.height=window.innerHeight}),200)},handleIE:function(){(document.all&&document.compatMode||"-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style)&&(document.body.className?document.body.className+=" ie":document.body.className=" ie",this.$message({message:"为了有更好的体验，请使用最新版Chrome浏览器。",type:"error",showClose:!0,duration:1e4}))}},beforeDestroy:function(){window.removeEventListener("resize",this.handelResize)}},lu=au,su=(n("034f"),Object(gt["a"])(lu,et,nt,!1,null,null,null)),cu=su.exports,uu=n("9aba"),du=n.n(uu);function fu(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=pu(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,r=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw r}}}}function pu(t,e){if(t){if("string"===typeof t)return hu(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hu(t,e):void 0}}function hu(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var mu={getters:{rowDataMap:function(t){var e={};function n(t,o){e[t.id]&&console.warn("行id出现重复！！！",e[t.id],t),e[t.id]={row:t,index:o},t.cols&&t.cols.forEach((function(t){t.subs&&t.subs.forEach(n)}))}return t.design.forEach(n),e},allRows:function(t,e){var n=e.rowDataMap,o=[];for(var i in n)n.hasOwnProperty(i)&&o.push(n[i].row);return o},subRowPathMap:function(t,e){var n={};function o(t){n[t.id]||(n[t.id]=[]),t.cols&&t.cols.forEach((function(e){e.subs&&(e.subs.forEach((function(e){n[e.id]=[t].concat(n[t.id])})),e.subs.forEach(o))}))}for(var i in t.design.forEach(o),n)!n.hasOwnProperty(i)||n[i]&&n[i].length||delete n[i];return n},selectedRowParentCol:function(t,e){var n=t.selectedRowId;if(!n)return null;var o=e.subRowPathMap[n];if(o&&o.length){var i,r=fu(o[0].cols);try{for(r.s();!(i=r.n()).done;){var a=i.value;if(a.subs&&a.subs.length){var l,s=fu(a.subs);try{for(s.s();!(l=s.n()).done;){var c=l.value;if(c.id==n)return a}}catch(u){s.e(u)}finally{s.f()}}}}catch(u){r.e(u)}finally{r.f()}}return null},selectedLayoutData:function(t,e){var n=t.selectedRowId;if(!n)return{layout:null,index:-1};var o=e.rowDataMap[n];return{layout:o.row,index:o.index}}},mutations:{updateSelectedLayout:function(t,e){var n=e.id;t.selectedRowId=n},setRowProps:function(t,e){void 0===e.shuttle&&(e.shuttle=!0);var n=e.prop,o=e.value,i=e.row;Object(kt["k"])(i,n,o)},removeRow:function(t,e){var n=e.parentCol,o=e.index;n?n.subs?n.subs.splice(o,1):console.error("删除时找不到上级！！！"):t.design.splice(o,1)},updateRowHeight:function(t,e){var n=e.row,o=e.height,i=o-n.height;function r(t,e){t.cols&&t.cols.forEach((function(t){var n=t.subs;if(n&&n.length){var o=n[n.length-1],i=n.reduce((function(t,e){return t+e.height}),0),a=e-i;if(a>0)o.height+=a;else{var l=o.height+a;o.height=l<St["b"]?St["b"]:l}r(o,o.height)}}))}function a(t,e){if(t&&t.length){var n=t[0];n.height+=e,void 0!=n.type&&"row-layout"!=n.type||r(n,n.height),a(t.slice(1),e)}}n.height=o,r(n,o),!1!==e.bubble&&a(e.parentRowPath,i)},replaceToMulti:function(t,e){var n=e.row,o=e.rowIndex,i=e.rowCount,r=e.colCount,a=e.parentCol,l=a&&a.subs?a.subs:t.design,s=900;a&&a.style.width&&"number"==typeof a.style.width&&(s=a.style.width);var c=u(n,i,r,s);function u(t,e,o,i){var r=Object(kt["d"])(t),a=n.cols[0];r.cols=[],r.asMulti=!1,delete r.asMulti,a.style.width=i/o;var l=Object(rt["a"])(new Array(e)).map((function(){var t=Object(kt["l"])(),e=Object(kt["d"])(r);return e.id=t,e.autoIndex=kt["j"].getIndex(e.namePrefix||e.name),e.cols=Object(rt["a"])(new Array(o)).map((function(){var e=kt["b"].getIndex(t),n=Object(kt["d"])(a);return n.id="col-".concat(t,"-").concat(e),n.name="col-".concat(e),n})),e}));return l}l.splice.apply(l,[o,1].concat(Object(rt["a"])(c)))},copyRow:function(t,e){var n=e.aimIndex,o=e.newRow,i=e.parentCol?e.parentCol.subs:t.design;i.splice(n,0,o)},updateLayoutProp:function(t,e){var n=e.prop,o=e.value,i=e.layout;i?i[n]=o:console.error("组件件不存在")},updateAllRowHeight:function(t,e){var n=e.rows,o=e.height;function i(t){t.cols.forEach((function(t){t.subs.forEach((function(t){var e,n=fu(t.cols);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(i.subs&&i.subs.length)return!1}}catch(r){n.e(r)}finally{n.f()}t.height=o}))}))}Array.isArray(n)&&n.forEach((function(t){t.height=o,"acc-layout"==t.type&&i(t)}))}},actions:{setAllRowHeight:function(t,e){var n=e.height,o=t.state.design.filter((function(t){if("acc-layout"==t.type)return!0;var e,n=fu(t.cols);try{for(n.s();!(e=n.n()).done;){var o=e.value;if(o.subs&&o.subs.length)return!1}}catch(i){n.e(i)}finally{n.f()}return!0})),i="allRowHeight"+ +new Date;t.commit("updateGlobalStyleProp",{prop:"cellHeight",value:n,shuttle:!0,group:i}),o.length&&t.commit("updateAllRowHeight",{rows:o,height:n,shuttle:!0,group:i})},setSelectedLayout:function(t,e){t.commit("updateSelectedLayout",e),t.commit({type:"setSelectedCol",selectedColId:""}),t.commit("clearSelectedControl")},setLayoutProp:function(t,e){var n=e.layout,o=e.prop,i=e.value;n||(n=t.getters.selectedLayoutData.layout),t.commit("updateLayoutProp",{layout:n,prop:o,value:i})},deleteRow:function(t,e){void 0===e.shuttle&&(e.shuttle=!0),void 0===e.group&&(e.group="deleteRow-"+ +new Date),e.row==t.getters.selectedLayoutData.layout&&t.commit("updateSelectedLayout",{id:""});var n=e.row.height;t.commit("removeRow",e);var o=e.parentCol;if(o){var i=o.subs;if(!i.length)return;var r=i[i.length-1],a=r.height+n;t.commit("updateRowHeight",{row:r,height:a,bubble:!1})}}}};n("6c7b"),n("4917");function gu(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=vu(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,r=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw r}}}}function vu(t,e){if(t){if("string"===typeof t)return bu(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bu(t,e):void 0}}function bu(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var yu={getters:{allCol:function(t,e){var n,o=[],i=e.rowDataMap;for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n=i[r].row,n.cols.forEach((function(t){o.push(t)})));return o},colStyleText:function(t,e){var n=e.allCol,o=[];return n.forEach((function(t){var e=t.style.border,n=["#".concat(t.id,":after{"),"border-top: ".concat(e.top.width,"px ").concat(e.top.style," ").concat(e.top.color,";"),"border-right: ".concat(e.right.width,"px ").concat(e.right.style," ").concat(e.right.color,";"),"border-bottom: ".concat(e.bottom.width,"px ").concat(e.bottom.style," ").concat(e.bottom.color,";"),"border-left: ".concat(e.left.width,"px ").concat(e.left.style," ").concat(e.left.color,";}")].join("");o.push(n)})),o.join("")},selectedCol:function(t,e){var n=t.selectedColId;if(!n)return null;var o=n.replace(/^col-([\w-]+)-\d{1,2}$/,"$1"),i=e.rowDataMap[o];if(!i){var r,a=gu(e.allCol);try{for(a.s();!(r=a.n()).done;){var l=r.value;if(l.id===n)return l}}catch(d){a.e(d)}finally{a.f()}return null}var s,c=gu(i.row.cols);try{for(c.s();!(s=c.n()).done;){var u=s.value;if(u.id==n)return u}}catch(d){c.e(d)}finally{c.f()}return null}},mutations:{setSelectedCol:function(t,e){t.selectedColId=e.id},setColProps:function(t,e){void 0===e.shuttle&&(e.shuttle=!0);var n=e.prop,o=e.value,i=e.col;Object(kt["k"])(i,n,o)},addAccItem:function(t,e){var n=e.item,o=e.parentRow;o.cols.push(n)},removeCol:function(t,e){var n=e.col,o=e.parentRow,i=e.colIndex;if(o.cols&&1!=o.cols.length){var r=o.cols[i-1];if(r)r.style.width+=n.style.width;else{var a=o.cols[i+1];a&&(a.style.width+=n.style.width)}o.cols.splice(i,1)}},splitCol:function(t,e){var n,o=e.col,i=e.colIndex,r=e.count,a=e.parentRow,l=e.direction,s=void 0===l?"right":l;if(!a)return e.shuttle=!1,void console.error("未指定所在行！！");var c=o.style.width,u=c/r>>0;o.style.width=c-u*(r-1);var d=[],f=r-1,p=0;while(p++<f){var h=Object(kt["d"])(o);g(a,h),h.style.width=u,h.style.border=Object(kt["d"])(o.style.border),h.controls=[],d.push(h)}var m="left"==s?i:i+1;function g(t,e){var n=t.id,o=kt["b"].getIndex(n);e.id="col-".concat(n,"-").concat(o),e.name="col-".concat(o)}(n=a.cols).splice.apply(n,[m,0].concat(d))},intertRowsInCol:function(t,e){var n=e.rowDataArr,o=e.col;o.subs=n},replaceSingleColToRows:function(t,e){var n,o,i=e.rowIndex,r=e.rowDataArr,a=e.parentRowPath;o=a&&a[0]?a[0]:t.design,(n=o).splice.apply(n,[i,1].concat(Object(rt["a"])(r)))},updateColAllBorder:function(t,e){var n=e.directions,o=e.prop,i=e.value;n.forEach((function(t){t&&(t[o]=i)}))},setColBorder:function(t,e){var n=e.border,o=e.selectedCol;JSON.stringify(e),o.style.border=Object(kt["d"])(n)},setColStyle:function(t,e){JSON.stringify(e);var n=e.prop,o=e.value,i=e.selectedCol;i.style[n]=o},setAllColBorderWidth:function(t,e){var n=e.cols,o=e.borderWidth;Cu(n,o)},setAllColBorder_inner:function(t,e){var n=e.cols,o=e.borderWidth;Cu(n,o),wu(t.design[0],0),xu(t.design[t.design.length-1],0),Ou(t.design,0),Du(t.design,0)},setAllColBorder_hline:function(t,e){var n=e.cols,o=e.borderWidth;n.forEach((function(t){t.style.border.left.width=0,t.style.border.right.width=0,t.style.border.top.width=o,t.style.border.bottom.width=o}))},setAllColBorder_vline:function(t,e){var n=e.cols,o=e.borderWidth;n.forEach((function(t){t.style.border.left.width=o,t.style.border.right.width=o,t.style.border.top.width=0,t.style.border.bottom.width=0}))},setAllColBorder_outer:function(t,e){var n=e.cols,o=e.borderWidth;Cu(n,0),wu(t.design[0],o),xu(t.design[t.design.length-1],o),Ou(t.design,o),Du(t.design,o)},setAllColBorder_left:function(t,e){var n=e.cols,o=e.borderWidth;Cu(n,0),Ou(t.design,o)},setAllColBorder_top:function(t,e){var n=e.cols,o=e.borderWidth;Cu(n,0),wu(t.design[0],o)},setAllColBorder_right:function(t,e){var n=e.cols,o=e.borderWidth;Cu(n,0),Du(t.design,o)},setAllColBorder_bottom:function(t,e){var n=e.cols,o=e.borderWidth;Cu(n,0);var i=t.design.length;if(i){var r=t.design[i-1];xu(r,o)}},updateColWidth:function(t,e){var n=e.col,o=e.width,i=e.nextCol,r=o-n.style.width;function a(t,e,n){t.subs.forEach((function(t){var o=t.cols;if(o&&o.length){var i=o["right"==n?0:o.length-1];i.style.width+=e,a(i,e,n)}}))}i&&i.style&&(i.style.width-=r,i.subs&&a(i,-r,"right")),n.style.width=o,n.subs&&a(n,r,"left")},updateRowColWidth:function(t,e){var n=e.row,o=e.ratio;function i(t){t.cols.forEach((function(t){t.style.width*=o,t.subs&&t.subs.length&&t.subs.forEach(i)}))}i(n)},updateColBorder:function(t,e){var n=e.prop,o=e.value,i=e.targetBorderConfig;i&&(i[n]=o)}},actions:{setSelectedCol:function(t,e){t.commit("setSelectedCol",e),t.commit("updateSelectedLayout",{id:"",shuttle:!1}),t.commit("clearSelectedControl")},removeCol:function(t,e){var n=e.col;n.id==t.state.selectedColId&&t.commit("setSelectedCol",{id:"",shuttle:!1}),t.commit("removeCol",e)},setColAllBorder:function(t,e){var n,o,i=e.prop,r=e.value,a=t.getters.selectedCol,l=a.style.border.right,s=a.style.border.bottom,c=t.state.selectedColId.match(/col-(\w+)-\d/);if(!c)return console.error("单元格不存在！！！");var u=c[1];if(!u)return console.error("无法匹配目标行");var d=t.getters.rowDataMap[u].row,f=t.getters.rowDataMap[u].index,p=d.cols.indexOf(a);if(-1===p)return console.error("单元格不存在！！！");if(n=0===p?a.style.border.left:d.cols[p-1].style.border.right,0==f)o=a.style.border.top;else{var h,m=t.getters.subRowPathMap[u];h=m&&m.length?m[0].cols[f-1]:t.state.design[f-1],o=h.cols[p]?h.cols[p].style.border.bottom:null}t.commit("updateColAllBorder",{directions:[o,l,s,n],prop:i,value:r,shuttle:!0})},setColBorderDetail:function(t,e){var n=e.dir,o=e.prop,i=e.value,r=e.selectedCol;if(r&&(t.commit("updateColBorder",{prop:o,value:i,targetBorderConfig:r.style.border[n],group:e.group}),"right"!=n&&"bottom"!=n)){var a,l,s=r,c=t.state.selectedColId.match(/col-(\w+)-\d/);if(!c)return console.error("单元格不存在！！！");var u=c[1];if(!u)return console.error("无法匹配目标行");var d=t.getters.rowDataMap[u].row,f=t.getters.rowDataMap[u].index,p=d.cols.indexOf(s);if(-1===p)return console.error("单元格不存在！！！");if("left"==n)return a=0===p?s.style.border.left:d.cols[p-1].style.border.right,void(a&&t.commit("updateColBorder",{prop:o,value:i,targetBorderConfig:a,group:e.group}));if("top"!=n);else{if(0==f)l=s.style.border.top;else{var h,m,g=t.getters.subRowPathMap[u];g&&g.length?(g[0].cols.forEach((function(t){h||t.subs&&t.subs[f]===d&&(h=t)})),m=h?h.subs[f-1]:null):m=t.state.design[f-1],l=m&&m.cols[p]?m.cols[p].style.border.bottom:null}l&&t.commit("updateColBorder",{prop:o,value:i,targetBorderConfig:l,group:e.group})}}},insertMultiRowCol:function(t,e){var n=e.col,o=e.parentRow,i=e.parentRowIndex,r=e.rowCount,a=e.colCount,l=new Array(r).fill(1).map((function(){return _u(a,n.style.width,t.state.globalStyle)})),s="insertMultiRowCol"+ +new Date,c=o.height,u=t.state.globalStyle.cellHeight*r;u>c?t.commit({type:"updateRowHeight",row:o,height:u,group:s}):l[r-1].height+=c-u,1!==o.cols.length?t.commit({type:"intertRowsInCol",group:s,col:n,rowDataArr:l}):t.commit({type:"replaceSingleColToRows",group:s,parentRowPath:t.getters.subRowPathMap[o.id],row:o,rowIndex:i,rowDataArr:l})}}};function Cu(t,e){t.forEach((function(t){t.style.border.top.width=e,t.style.border.right.width=e,t.style.border.bottom.width=e,t.style.border.left.width=e}))}function wu(t,e){t&&t.cols.forEach((function(t){t.style.border.top.width=e;var n=t.subs[0];wu(n)}))}function xu(t,e){t&&t.cols.forEach((function(t){t.style.border.bottom.width=e;var n=t.subs.length;n&&xu(t.subs[n-1],e)}))}function Ou(t,e){Array.isArray(t)&&t.length&&t.forEach((function(t){var n=t.cols[0];n&&(n.style.border.left.width=e,Ou(n.subs,e))}))}function Du(t,e){Array.isArray(t)&&t.length&&t.forEach((function(t){var n=t.cols[t.cols.length-1];n&&(n.style.border.right.width=e,Du(n.subs,e))}))}function _u(t,e,n){var o,i=Object(kt["l"])(),r={id:i,type:"row-layout",name:"行",autoIndex:kt["j"].getIndex("row"),namePrefix:"行",height:n.cellHeight,cols:[]},a=e/t,l=0;while(l++<t)o=kt["b"].getIndex(i),r.cols.push({id:"col-".concat(i,"-").concat(o),name:"col-".concat(o),type:"col-item",style:{verticalAlign:n.verticalAlign,textAlign:n.textAlign,width:a,border:Object(kt["d"])(n.border)},subs:[],controls:[]});return r}n("f400");function ku(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Su(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,r=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw r}}}}function Su(t,e){if(t){if("string"===typeof t)return ju(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ju(t,e):void 0}}function ju(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var Tu={getters:{controlType2nameMap:function(t){var e=window.FORM_DESIGN_CONFIG.controlList,n=t.extControls,o={};return e.concat(n).forEach((function(t){o[t.type]=t.name})),o},fieldMap:function(t){var e={},n=t.newFieldList;function o(t,n){e[(t.id||"")+";"+(n.field||"")]=n;var o="#".concat(t.sqltablename||"",";#").concat(n.fieldname||"");e[o]=n}return t.fieldList.forEach((function(t,e){0==e&&n.forEach((function(e){o(t,e)})),t.fields.forEach((function(e){o(t,e)}))})),e},codeListMap:function(t){var e=t.codeList,n={};return e.forEach((function(t){n[t.id]=t})),n},selectedFieldMap:function(t,e){var n=e.allControls;if(!n.length)return{};var o={};return n.forEach((function(t){t.bind&&(o[t.bind]=!0)})),o},allControls:function(t,e){var n=e.allCol;if(!n||!n.length)return[];var o=[];return n.forEach((function(t){t.controls&&t.controls.length&&o.push.apply(o,Object(rt["a"])(t.controls))})),o},controlNameMap:function(t,e){var n=t.hiddenControls,o=e.allControls,i={};return n.forEach((function(t){i[t.id]=t.name||"".concat(t.namePrefix).concat(t.autoIndex)})),o.forEach((function(t){i[t.id]=t.name||"".concat(t.namePrefix).concat(t.autoIndex)})),i},controlDataMap:function(t,e){var n=t.hiddenControls,o=e.allCol,i={};return n.forEach((function(t,e){i[t.id]={control:t,index:e}})),o.forEach((function(t){t.controls&&t.controls.length&&t.controls.forEach((function(t,e){i[t.id]={control:t,index:e}}))})),i},selectedControl:function(t,e){var n=t.selectedControlId,o=e.controlDataMap;if(!n)return{control:null,index:-1};var i=o[n];return i&&i.control?i:{control:null,index:-1}},selectedControlParentCol:function(t,e){var n,o=t.selectedControlId,i=t.hiddenControls,r=e.allCol,a=ku(r);try{for(a.s();!(n=a.n()).done;){var l=n.value;if(l.controls){var s,c=ku(l.controls);try{for(c.s();!(s=c.n()).done;){var u=s.value;if(u.id==o)return l}}catch(h){c.e(h)}finally{c.f()}}}}catch(h){a.e(h)}finally{a.f()}var d,f=ku(i);try{for(f.s();!(d=f.n()).done;){var p=d.value;if(p.id==o)return{controls:i}}}catch(h){f.e(h)}finally{f.f()}return null},selectedControlParentColInfo:function(t,e){var n=e.selectedControlParentCol,o=e.rowDataMap,i={row:null,index:-1};if(!n)return i;var r=n.id,a=r.replace(/^col-(\w+)-\d{1,2}$/,"$1"),l=o[a];return l?{row:l.row,index:l.row.cols.indexOf(n)}:i}},mutations:{setHiddenControls:function(t,e){t.hiddenControls=e},setSourceTables:function(t,e){t.sourceTables=e},setDataTables:function(t,e){t.dataTables=e},setFieldList:function(t,e){t.fieldList=e},setCodeList:function(t,e){t.codeList=e},setMacroTypes:function(t,e){t.macroTypes=e},setExtControls:function(t,e){t.extControls=e},setCommonControls:function(t,e){t.commonControls=e},setButtonEditPopupList:function(t,e){t.buttonEditPopupList=e},removeControl:function(t,e){var n=e.selectedControl,o=e.selectedControlParentCol,i=e.selectedControlIndex;if(!n||!o||-1===i)return console.error("删除控件出错！！！");o.controls.splice(i,1)},removeHiddenControl:function(t,e){var n=e.index;t.hiddenControls.splice(n,1)},addControl:function(t,e){var n=e.parentCol,o=e.control;n.controls.push(o)},setSelectedControl:function(t,e){t.selectedControlId=e.id},clearSelectedControl:function(t){t.selectedControlId=""},updateControlProp:function(t,e){JSON.stringify(e);var n=e.control;n?/\./.test(e.prop)?(e.prop,Object(kt["g"])(n,e.prop),Object(kt["k"])(n,e.prop,e.value),Object(kt["g"])(n,e.prop)):n[e.prop]=e.value:console.error("无选中控件")},addMultiFormProps:function(t,e){var n=e.controlData;n&&(n.multiFormAccId="",n.multiFormColumnId="",n.multiFormIndex=0)},addTooltipConfig:function(t,e){var n=e.controlData;n&&(n.tooltipConfig={type:"tooltip",content:""})},updateControlStyle:function(t,e){var n=e.controls,o=e.skinData;if(n){var i=Array.isArray(n)?n:[n],r=["fontSize","fontFamily","fontColor","fontBolder","fontItalic","fontUnderline","textAlign","verticalAlign"];i.forEach((function(t){r.forEach((function(e){o[e]&&(t[e]=o[e])}))}))}}},actions:{deleteControl:function(t,e){if(e){var n=e.selectedControl,o=e.selectedControlParentCol,i=e.selectedControlIndex;t.commit("removeControl",{selectedControl:n,selectedControlParentCol:o,selectedControlIndex:i,shuttle:!0})}else{var r=t.getters.selectedControl,a=r.control,l=r.index;if(!a||-1===l)return console.error("出现错误，无法删除！");if("hiddenfield"===a.type)return t.commit("clearSelectedControl"),void t.commit("removeHiddenControl",{index:l,shuttle:!0});var s=t.getters.selectedControlParentCol;if(!s)return console.error("出现错误，无法删除！");t.commit("clearSelectedControl"),t.commit("removeControl",{selectedControl:a,selectedControlParentCol:s,selectedControlIndex:l,shuttle:!0})}},setSelectedControl:function(t,e){t.commit("setSelectedControl",e),t.commit("setSelectedCol",{id:""}),t.commit("updateSelectedLayout",{id:""})},autoAddLabel:function(t,e){var n=e.parentCol,o=Fu(e.controlData.name||"",t.state.globalStyle,e.controlData);t.commit("addControl",{parentCol:n,control:o})},bindFieldToControl:function(t,e){var n=e.fieldMaps,o=e.controls,i=e.newFieldList;t.commit({type:"submitNewFieldList",newFieldList:i});var r=t.state.fieldList[0].sqltablename;function a(t){return"#".concat(r,";#").concat(t.fieldname||"")}var l="bindFieldToControl";o.forEach((function(e){var o,i,r=n[e.id];if(Array.isArray(r)?(o=r[0],i=r[1]):o=r,o&&o.fieldname){e.id!=t.state.selectedControlId&&t.commit({type:"setSelectedControl",id:e.id});var s=a(o);t.dispatch({type:"setControlProp",prop:"bind",value:s,group:l,control:e}),i&&t.dispatch({type:"setControlProp",prop:"bind2",value:a(i),group:l,control:e})}}))},setControlProp:function(t,e){var n=e.prop,o=e.value,i=e.control,r=e.group||"updateCtrProp-"+ +new Date;if(t.commit({control:i,type:"updateControlProp",prop:n,value:o,shuttle:!0,group:r}),"bind"==n){var a=t.getters.fieldMap[o];if(a&&a.datasource&&(t.commit({control:i,type:"updateControlProp",prop:"data",value:"",shuttle:!1}),t.commit({control:i,type:"updateControlProp",prop:"codeItem",value:a.datasource,shuttle:!1})),i&&o&&void 0!==!i.emptyText)try{t.commit({control:i,type:"updateControlProp",prop:"emptyText",value:"请输入"+t.getters.fieldMap[o].name,shuttle:!1})}catch(l){console.error("自动设置 emptyText",l)}if(i.id!=t.state.selectedControlId)return;Mu(t,i),Eu(t,t.getters.fieldMap[i.bind].name),Au(t,o,i),Pu(t,o,i)}i.id==t.state.selectedControlId&&("uniqueValidate"==n&&!0===o&&(t.commit({control:i,type:"updateControlProp",prop:"required",value:!0,shuttle:!0,group:r}),Lu(t,!0)),"required"==n&&Lu(t,o),"sourceTable"==n&&Iu(t,i),"name"!=n||!o||"label"==i.type&&"title"==i.type||Eu(t,o,!1))},dealSubmitControl:function(t){Ru(t)}}};function Iu(t,e){e&&"subtable"==e.type&&t.commit({control:e,type:"updateControlProp",prop:"columns",value:[],shuttle:!1})}function Pu(t,e,n){var o=t.getters.fieldMap[e];if(o.fieldtype){var i;switch(o.fieldtype){case 1:i="float";break;case 2:i="int";break;default:break}i&&t.commit({control:n,type:"updateControlProp",prop:"vtype",value:i,shuttle:!1})}}function Au(t,e,n){var o=t.getters.fieldMap[e];o.required&&n&&"required"in n&&(t.commit({control:n,type:"updateControlProp",prop:"required",value:!0,shuttle:!1}),Lu(t,!0))}function Eu(t,e,n){var o=$u(t);o&&(n||"控件label"==o.labelText)&&t.commit("updateControlProp",{control:o,prop:"labelText",value:e,shuttle:!1})}function Lu(t,e){var n=$u(t);n&&t.commit("updateControlProp",{control:n,prop:"showStar",value:e,shuttle:!1})}function $u(t){var e=t.getters.selectedControlParentColInfo,n=e.row,o=e.index;if(n&&-1!==o){var i=n.cols[o-1];if(i&&i.controls.length){var r,a=ku(i.controls);try{for(a.s();!(r=a.n()).done;){var l=r.value;if("label"==l.type)return l}}catch(s){a.e(s)}finally{a.f()}return null}}}function Mu(t,e){var n=t.getters.selectedControlParentColInfo,o=n.row,i=n.index;if(e&&o){var r=o.cols[i-1];if(r&&!r.controls.length&&!r.subs.length){var a=Fu(t.getters.fieldMap[e.bind].name,t.state.globalStyle);t.commit("addControl",{parentCol:r,control:a,shuttle:!1})}}}function Fu(t,e,n){var o=Object(kt["d"])(window.FORM_DESIGN_CONFIG.controls.label),i=kt["c"].getIndex("label");o.id="label-"+Object(kt["l"])(),o.namePrefix="label",o.autoIndex=i,o.name="",o.width="100%",t&&(o.labelText=t),n&&void 0!==n.required&&(o.showStar=n.required),delete o.configItems;var r=e.fontSize,a=e.fontFamily,l=e.fontColor,s=e.fontBolder,c=e.fontItalic,u=e.fontUnderline;return o.fontSize=r,o.fontFamily=a,o.fontColor=l,o.fontBolder=s,o.fontItalic=c,o.fontUnderline=u,o}function Ru(t){var e=t.getters.allControls,n=e.filter((function(t){return"combobox"==t.type}));if(n.length){var o=new Map,i=new Map;n.forEach((function(t){o.set(t.id,t),t.events&&t.events["valuechanged:getcodelist"]&&t.events["valuechanged:getcodelist"].length&&i.set(t.id,t)})),Nu(i,o,t,{})}}function Nu(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=!1,r=!1;t.forEach((function(t){if(t.codeItem){var a=t.events["valuechanged:getcodelist"].reduce((function(t,e){var n=e.actions.filter((function(t){return"setData"==t.type}))[0];return n&&t.push.apply(t,Object(rt["a"])(n.targets)),t}),[]);a.forEach((function(r){var a=r.id;o[a]||(n.commit({control:e.get(a),type:"updateControlProp",prop:"codeItem",value:t.codeItem,shuttle:!1}),n.commit({control:e.get(a),type:"updateControlProp",prop:"codeSyncPid",value:t.id,shuttle:!1}),o[a]=!0,i=!0)}))}else r=!0})),r&&i&&Nu(t,e,n,o)}var Vu={getters:{inControlDragging:function(t){return t.helper.inControlDragging},inLayoutDragging:function(t){return t.helper.inLayoutDragging}},mutations:{updateLineTop:function(t,e){t.helper.top=e},updateLineLeft:function(t,e){t.helper.left=e},showHLine:function(t){t.helper.showHLine=!0},hideHLine:function(t){t.helper.showHLine=!1},showVLine:function(t){t.helper.showVLine=!0},hideVLine:function(t){t.helper.showVLine=!1},layoutDragStart:function(t){t.helper.inLayoutDragging=!0},layoutDragEnd:function(t){t.helper.inLayoutDragging=!1},controlDragStart:function(t){t.helper.inControlDragging=!0},controlDragEnd:function(t){t.helper.inControlDragging=!1},updateViewType:function(t,e){/^(pc|mobile)$/.test(e)?t.helper.viewType=e:console.error("unsupport viewType")},toggleViewDesign:function(t){t.helper.viewDesign=!t.helper.viewDesign},setShowPreview:function(t,e){t.helper.showPreview=e.showPreview}},actions:{}};function Bu(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function zu(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Bu(Object(n),!0).forEach((function(e){Object(at["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Bu(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}tt["default"].use(_t["a"]);var Hu=new _t["a"].Store({strict:!1,state:{formSize:{width:900,height:0},design:[],mobileDesignData:[],hiddenControls:[],skin:"",globalStyle:{autoColons:!0,fontSize:13,fontFamily:"Microsoft Yahei",fontColor:"#333333",fontBolder:!1,fontItalic:!1,fontUnderline:!1,textAlign:"left",verticalAlign:"middle",cellHeight:48,border:{top:{width:1,style:"solid",color:"#ddd"},right:{width:1,style:"solid",color:"#ddd"},bottom:{width:1,style:"solid",color:"#ddd"},left:{width:1,style:"solid",color:"#ddd"}},allBorderType:"all"},helper:{showVLine:!1,showHLine:!1,left:0,top:0,inControlDragging:!1,inLayoutDragging:!1,viewDesign:!1,viewType:"pc",showPreview:!1},jsCode:"",cssCode:"",fieldList:[],codeList:[],macroTypes:[],sourceTables:[],dataTables:[],DBDataTypes:[],newFieldList:[],buttonEditPopupList:[],extControls:[],commonControls:[],leftActiveTab:"layout",rightActiveTab:"form",selectedControlId:"",selectedColId:"",selectedRowId:""},getters:zu(zu(zu(zu(zu({},mu.getters),yu.getters),Tu.getters),Vu.getters),{},{globalStyleText:function(t){var e=t.globalStyle,n=e.fontSize,o=e.fontFamily,i=e.fontColor,r=e.fontBolder,a=e.fontItalic,l=e.fontUnderline,s=e.textAlign,c=e.verticalAlign;return"\n        font-size: ".concat(n,"px;\n        font-family: ").concat(o,";\n        color: ").concat(i,";\n        font-weight: ").concat(r?"bold":"normal",";\n        font-style: ").concat(a?"italic":"normal",";\n        text-decoration: ").concat(l?"underline":"none",";\n        text-align: ").concat(s,";\n        vertical-align: ").concat(c,";\n      ")}}),mutations:zu(zu(zu(zu(zu({},mu.mutations),yu.mutations),Tu.mutations),Vu.mutations),{},{setSkin:function(t,e){var n=e.skinName;t.skin=n},setJsCode:function(t,e){t.jsCode=e},setCssCode:function(t,e){t.cssCode=e},setDBDataTypes:function(t,e){Array.isArray(e)?t.DBDataTypes=e:console.error("设置创建新字段时可选的数据库类型时出错",e)},addToNewFieldList:function(t,e){t.newFieldList.push(e.fieldProps)},submitNewFieldList:function(t,e){var n=e&&e.newFieldList?e.newFieldList:t.newFieldList,o=t.fieldList[0]&&t.fieldList[0].fields;n.length&&Array.isArray(o)&&(o.push.apply(o,Object(rt["a"])(n)),t.newFieldList.length&&(t.newFieldList=[]))},updateGlobalStyleProp:function(t,e){JSON.stringify(e),t.globalStyle[e.prop]=e.value},updateGlobalBorder:function(t,e){JSON.stringify(e),t.globalStyle.border.top[e.prop]=e.value,t.globalStyle.border.right[e.prop]=e.value,t.globalStyle.border.bottom[e.prop]=e.value,t.globalStyle.border.left[e.prop]=e.value},updateGlobalStyle:function(t,e){var n=e.style;t.globalStyle=Lo()({},t.globalStyle,n)},applyGlobalStyle:function(t,e){var n=e.cols,o=e.prop,i=e.value;n.forEach((function(t){t.style[o]=i,t.controls&&t.controls.length&&-1!==["fontSize","fontFamily","fontColor","fontBolder","fontItalic","fontUnderline"].indexOf(o)&&t.controls.filter((function(t){return"label"==t.type||"title"==t.type})).forEach((function(t){t[o]=i}))}))},applyGlobalBorder:function(t,e){var n=e.cols,o=e.prop,i=e.value;n.forEach((function(t){t.style.border.top[o]=i,t.style.border.right[o]=i,t.style.border.bottom[o]=i,t.style.border.left[o]=i}))},activeLeftTab:function(t,e){t.leftActiveTab=e},activeRightTab:function(t,e){t.rightActiveTab=e},updateDesign:function(t,e){t.design=e,t.design},tryMergeAcc:function(t,e){var n=e.row,o=e.rowIndex;if(n&&void 0!==o&&1!=t.design.length){var i,r,a=t.design[o-1],l=t.design[o+1],s=a&&"acc-layout"==a.type,c=l&&"acc-layout"==l.type;if(s)return i=Object(kt["d"])(a),r=i.id,n.cols.forEach((function(t){i.cols.push(u(t,r))})),void t.design.splice(o-1,2,i);if(c)return i=Object(kt["d"])(n),r=i.id,l.cols.forEach((function(t){i.cols.push(u(t,r))})),void t.design.splice(o,2,i)}function u(t,e){var n=kt["b"].getIndex(e),o=Object(kt["d"])(t);return o.id="col-".concat(e,"-").concat(n),o}},replaceMobileDesign:function(t,e){t.mobileDesignData=e.mobileDesignData},controlCompatible:function(t,e){var n=e.controls;Array.isArray(n)&&n.forEach((function(t){var e=t.customValidate;e&&void 0!==e.regExp&&(e.regSource=e.regExp,delete e.regExp)}))}}),actions:zu(zu(zu(zu(zu({},mu.actions),yu.actions),Tu.actions),Vu.actions),{},{activeRightTab:function(t,e){var n=t.state,o=t.commit;n.rightActiveTab!=e&&o("activeRightTab",e)},setGlobalStyle:function(t,e){t.commit("updateGlobalStyleProp",e),t.commit("applyGlobalStyle",zu(zu({cols:t.getters.allCol},e),{},{shuttle:!0}))},setGlobalBorder:function(t,e){t.commit("updateGlobalBorder",e),t.commit("applyGlobalBorder",zu(zu({cols:t.getters.allCol},e),{},{shuttle:!0}))},setAllBorderType:function(t,e){var n=e.type,o=e.borderWidth,i="bordertype-"+ +new Date;t.commit("updateGlobalStyleProp",{prop:"allBorderType",value:n,group:i,shuttle:!0}),Gu(t,n,o,i)},applySkin:function(t,e){var n=e.skin,o=e.skinData;t.commit({type:"setSkin",skinName:n,group:"skin",shuttle:!0}),t.commit({type:"updateGlobalStyle",style:o,group:"skin",shuttle:!0});var i=t.getters.allControls.filter((function(t){return-1!=["title","label","output"].indexOf(t.type)}));i.length&&t.commit({type:"updateControlStyle",controls:i,group:"skin",skinData:o,shuttle:!0})}})});function Gu(t,e,n,o){var i=t.getters.allCol;return"all"==e?t.commit("setAllColBorderWidth",{cols:i,group:o,borderWidth:n}):"none"==e?t.commit("setAllColBorderWidth",{cols:i,group:o,borderWidth:0}):void t.commit("setAllColBorder_"+e,{cols:i,group:o,borderWidth:n})}var qu=n("adb5"),Uu=n("2fdd");n("8e1f"),n("64d2");window.jsoncParse=Uu["a"],Z.a.props.model=[Object,Array];var Wu=tt["default"].extend({extends:K.a,mounted:function(){this.$el&&!this.$el.title&&this.label&&this.label.length>10&&this.$el.setAttribute("title",this.label)}});tt["default"].prototype.$ELEMENT={size:"small"},tt["default"].prototype.$bus=new tt["default"],tt["default"].prototype.$httpGet=qu["a"],tt["default"].prototype.$httpPost=qu["b"],tt["default"].prototype.$message=Y.a,tt["default"].prototype.$confirm=W.a.confirm,tt["default"].prototype.$prompt=W.a.prompt,tt["default"].prototype.$msgbox=W.a,tt["default"].config.productionTip=!1,tt["default"].component("draggable",Ka.a),tt["default"].component(q.a.name,q.a),tt["default"].component(H.a.name,H.a),tt["default"].component(B.a.name,B.a),tt["default"].component(N.a.name,N.a),tt["default"].component(F.a.name,F.a),tt["default"].component($.a.name,$.a),tt["default"].component(E.a.name,E.a),tt["default"].component(K.a.name,Wu),tt["default"].component(P.a.name,P.a),tt["default"].component(T.a.name,T.a),tt["default"].component(S.a.name,S.a),tt["default"].component(_.a.name,_.a),tt["default"].component(Z.a.name,Z.a),tt["default"].component(O.a.name,O.a),tt["default"].component(w.a.name,w.a),tt["default"].component(Y.a.name,Y.a),tt["default"].component(y.a.name,y.a),tt["default"].component(v.a.name,v.a),tt["default"].component(m.a.name,m.a),tt["default"].component(p.a.name,p.a),tt["default"].component(d.a.name,d.a),tt["default"].component(c.a.name,c.a),tt["default"].component(l.a.name,l.a),tt["default"].component(r.a.name,r.a),tt["default"].component("LayoutGender",pc),tt["default"].use(du.a),"object"!=Object(o["a"])(window.FORM_DESIGNER)&&(window.FORM_DESIGNER={}),window.FORM_DESIGNER.app=new tt["default"]({store:Hu,render:function(t){return t(cu)}}).$mount("#app"),window.FORM_DESIGNER_ANALYSIS={mobileDesignEntered:!1,mobileDesignMoved:!1,mobileDesignAdd:!1},Object.defineProperty(window.FORM_DESIGNER_ANALYSIS,"reset",{enumerable:!1,value:function(){this.mobileDesignEntered=!1,this.mobileDesignMoved=!1,this.mobileDesignAdd=!1}})},"58d3":function(t,e,n){"use strict";n("d87d")},5908:function(t,e,n){"use strict";n("31ec")},"592a":function(t,e,n){},"5bdd":function(t,e,n){},"64a9":function(t,e,n){},6758:function(t,e,n){"use strict";n("5389")},"6da2":function(t,e,n){"use strict";n("ff06")},"6f10":function(t,e,n){"use strict";n("739e")},"739e":function(t,e,n){},"76fd":function(t,e,n){"use strict";n("472d")},"7b52":function(t,e,n){"use strict";n("a481");e["a"]={methods:{lineFeed:function(t){return t&&t+""===t?t.replace(/\\n/g,"<br>").replace(/ /g,"&nbsp;"):""}}}},"7d5a":function(t,e,n){},"7e28":function(t,e,n){},"81ec":function(t,e,n){},"89c5":function(t,e,n){},"8e1f":function(t,e,n){},"8e39":function(t,e,n){},"8feb":function(t,e,n){},9827:function(t,e,n){"use strict";n.d(e,"d",(function(){return h})),n.d(e,"b",(function(){return m})),n.d(e,"a",(function(){return g}));n("2397"),n("7f7f"),n("ac6a"),n("f3e2"),n("2caf");var o=n("262e"),i=n("99de"),r=n("7e84"),a=n("d4ec"),l=n("bee2");function s(t){var e=c();return function(){var n,o=Object(r["a"])(t);if(e){var a=Object(r["a"])(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return Object(i["a"])(this,n)}}function c(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}var u=function(){function t(){Object(a["a"])(this,t),this.store={}}return Object(l["a"])(t,[{key:"_get",value:function(t){if(!t)throw new Error("type is required!");return this.store[t]?++this.store[t]:this.store[t]=1}},{key:"adaptProp",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.store[t]?this.store[t]+=e:this.store[t]=e}}]),t}(),d=function(t){Object(o["a"])(n,t);var e=s(n);function n(){return Object(a["a"])(this,n),e.call(this)}return Object(l["a"])(n,[{key:"getIndex",value:function(t){return this._get("control-"+t)}},{key:"adapt",value:function(t){var e=this;if(Array.isArray(t)){var n={};for(var o in t.forEach((function(t){var o=t.type,i=t.autoIndex||e.getIndex(o);n[o]?n[o]=Math.max(i,n[o]):n[o]=i})),n)this.adaptProp("control-"+o,n[o])}}}]),n}(u),f=function(t){Object(o["a"])(n,t);var e=s(n);function n(){return Object(a["a"])(this,n),e.call(this)}return Object(l["a"])(n,[{key:"getIndex",value:function(t){return this._get("col-"+t)}},{key:"adapt",value:function(t){var e=this;Array.isArray(t)&&t.forEach((function(t){t.cols.forEach((function(n){e.adaptProp("col-"+t.id),n.subs&&n.subs.length&&e.adapt(n.subs)}))}))}}]),n}(u),p=function(t){Object(o["a"])(n,t);var e=s(n);function n(){return Object(a["a"])(this,n),e.call(this)}return Object(l["a"])(n,[{key:"getIndex",value:function(t){return this._get("row-"+t)}},{key:"adapt",value:function(t){var e=this;if(Array.isArray(t)){var n={};for(var o in t.forEach((function(t){var o=t.namePrefix||t.name||"行",i=t.autoIndex||e.getIndex(o);n[o]?n[o]=Math.max(i,n[o]):n[o]=i})),n)this.adaptProp("control-"+o,n[o])}}}]),n}(u),h=new p,m=new d,g=new f;window.rowAutoIndex=h,window.controlAutoIndex=m,window.colAutoIndex=g,e["c"]={row:h,control:m,col:g}},9836:function(t,e,n){},"9cb4":function(t,e,n){},"9e0a":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("h1",{staticClass:"title",class:t.asControl?"design-form-title ":"design-control-holder",style:t.styleText,attrs:{title:t.controlData.textContent||""},domProps:{innerHTML:t._s(t.contentHtml)}})},i=[],r=(n("7f7f"),n("7b52")),a={name:"placeholder-title",props:{controlData:{type:Object,default:function(){return{}}},asControl:{type:Boolean,default:!1}},mixins:[r["a"]],computed:{styleText:function(){var t=this.controlData,e=t.fontSize,n=t.fontFamily,o=t.fontColor,i=t.fontBolder,r=t.fontItalic,a=t.fontUnderline,l=t.textAlign,s=t.verticalAlign,c=[];return c.push("font-size:".concat(e,"px")),c.push("font-family:".concat(n)),c.push("color:".concat(o)),c.push("font-weight:".concat(i?"bold":"normal")),c.push("font-style:".concat(r?"italic":"normal")),c.push("text-decoration:".concat(a?"underline":"none")),c.push("text-align:".concat(l)),c.push("vertical-align:".concat(s)),c.join(";")},contentHtml:function(){var t=this.controlData.textContent||this.controlData.name;return this.lineFeed(t)}},data:function(){return{}}},l=a,s=n("2877"),c=Object(s["a"])(l,o,i,!1,null,null,null);e["a"]=c.exports},a3de:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"design-control",class:t.extCls,style:"width:"+t.controlWidth,attrs:{"data-id":t.controlData.id}},[t._t("default"),n(t.getControlComponent(t.controlData.type),{tag:"component",attrs:{"control-data":t.controlData}}),n("span",{directives:[{name:"show",rawName:"v-show",value:t.controlData.icon,expression:"controlData.icon"}],staticClass:"design-control-icon",class:t.controlIconMap[t.controlData.type]}),n("span",{staticClass:"design-control-remove",on:{click:function(e){return e.stopPropagation(),t.removeControl(e)}}}),n("ToolTip",{attrs:{"control-data":t.controlData}})],2)},i=[],r=(n("ac6a"),n("f3e2"),n("d718")),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("input",{staticClass:"design-control-holder textbox",attrs:{type:"text",placeholder:t.controlData.emptyText||t.name,readonly:""},domProps:{value:t.controlData.value}})},l=[],s=(n("7f7f"),{name:"placeholder-textbox",props:["controlData"],computed:{name:function(){var t=this.controlData,e=t.name,n=t.namePrefix,o=t.autoIndex;return e||(n&&o?"".concat(n,"_").concat(o):"")}}}),c=s,u=n("2877"),d=Object(u["a"])(c,a,l,!1,null,null,null),f=d.exports,p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"design-control-holder ewebeditor",style:{height:(t.controlData.height||260)+"px"}},[t._v(t._s(t.controlData.emptyText||t.name))])},h=[],m={name:"placeholder-ewebeditor",props:["controlData"],computed:{name:function(){var t=this.controlData,e=t.name,n=t.namePrefix,o=t.autoIndex;return e||(n&&o?"".concat(n,"_").concat(o):"")}}},g=m,v=Object(u["a"])(g,p,h,!1,null,null,null),b=v.exports,y=n("9e0a"),C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("textarea",{staticClass:"design-control-holder textbox",staticStyle:{resize:"none"},style:"height:"+(t.controlData.height||26)+"px",attrs:{type:"text",placeholder:t.controlData.emptyText||t.controlData.name,readonly:""},domProps:{value:t.controlData.value}})},w=[],x={name:"placeholder-textarea",props:["controlData"]},O=x,D=Object(u["a"])(O,C,w,!1,null,null,null),_=D.exports,k=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"design-control-holder checkboxlist",class:"vertical"==t.controlData.repeatDirection?"vertical":"horizontal"},[n("el-checkbox-group",{model:{value:t.valueList,callback:function(e){t.valueList=e},expression:"valueList"}},t._l(t.dataList,(function(e){return n("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])})),1)],1)},S=[],j=(n("28a5"),n("6d67"),n("ab9e")),T={name:"placeholder-checkboxlist",props:["controlData"],mixins:[j["a"]],data:function(){return{valueList:this.getValueList(),defaultDataList:[1,2,3].map((function(t){return{id:t,text:"选项-"+t}})),originData:[]}},methods:{getValueList:function(){var t=this.controlData.value||this.controlData.defaultValue;return t&&t.split(",")||[]}},created:function(){this.getDataList()},watch:{"controlData.value":function(){this.valueList=this.getValueList()},"controlData.defaultValue":function(){this.valueList=this.getValueList()}}},I=T,P=Object(u["a"])(I,k,S,!1,null,null,null),A=P.exports,E=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"design-control-holder radiobuttonlist",class:"vertical"==t.controlData.repeatDirection?"vertical":"horizontal"},[n("el-radio-group",{model:{value:t.currValue,callback:function(e){t.currValue=e},expression:"currValue"}},t._l(t.dataList,(function(e){return n("el-radio",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])})),1)],1)},L=[],$={name:"placeholder-radio-button-list",props:["controlData"],mixins:[j["a"]],data:function(){return{currValue:this.controlData.value||this.controlData.defaultValue||"",defaultDataList:[1,2,3].map((function(t){return{id:t,text:"选项-"+t}})),originData:[]}},created:function(){this.getDataList()},watch:{"controlData.value":function(){this.valueList=this.controlData.value||this.controlData.defaultValue||""},"controlData.defaultValue":function(){this.valueList=this.controlData.value||this.controlData.defaultValue||""}}},M=$,F=Object(u["a"])(M,E,L,!1,null,null,null),R=F.exports,N=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("table",{staticClass:"design-control-holder sub-table"},[n("colgroup",[n("col",{attrs:{for:"checkcolumn",width:"50px"}}),n("col",{attrs:{for:"indexcolumn",width:"50px"}}),t._l(t.columns,(function(t){return n("col",{key:t.field,attrs:{for:"normal",width:t.width+"px"}})})),n("col",{attrs:{for:"actioncolumn",width:"100px"}})],2),n("thead",[n("tr",[t.checkcolumn?n("th",{staticClass:"text-center",class:{frozen:t.checkcolumnFrozen},attrs:{"data-column-type":"checkcolumn"}},[n("span",{staticClass:"checkcolumn-icon"})]):t._e(),t.indexcolumn?n("th",{staticClass:"text-center",class:{frozen:1==t.frozenIndex},attrs:{"data-column-type":"indexcolumn"}},[t._v("序")]):t._e(),t._l(t.columns,(function(e,o){var i;return n("th",{key:e.field,class:(i={},i["text-"+e.align]=!0,i.frozen=t.frozenIndex==o+t.prevColumnCount,i),attrs:{"data-column-type":"normal"}},[t._v(t._s(e.name))])})),t.actioncolumn?n("th",{staticClass:"text-center",attrs:{"data-column-type":"actioncolumn"}},[t._v("操作")]):t._e()],2)]),n("tbody",[n("tr",[t.checkcolumn?n("td",{staticClass:"text-center",class:{frozen:t.checkcolumnFrozen}},[n("span",{staticClass:"checkcolumn-icon"})]):t._e(),t.indexcolumn?n("td",{staticClass:"text-center",class:{frozen:1==t.frozenIndex}},[t._v("1")]):t._e(),t._l(t.columns,(function(e,o){var i;return n("td",{key:e.field,class:(i={},i["text-"+e.align]=!0,i.frozen=t.frozenIndex==o+t.prevColumnCount,i)},[t._v("...")])})),t.actioncolumn?n("td",{staticClass:"text-center"},[t._m(0)]):t._e()],2),n("tr",[t.checkcolumn?n("td",{staticClass:"text-center",class:{frozen:t.checkcolumnFrozen}},[n("span",{staticClass:"checkcolumn-icon"})]):t._e(),t.indexcolumn?n("td",{staticClass:"text-center",class:{frozen:1==t.frozenIndex}},[t._v("2")]):t._e(),t._l(t.columns,(function(e,o){var i;return n("td",{key:e.field,class:(i={},i["text-"+e.align]=!0,i.frozen=t.frozenIndex==o+t.prevColumnCount,i)},[t._v("...")])})),t.actioncolumn?n("td",{staticClass:"text-center"},[t._m(1)]):t._e()],2)])])},V=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",[n("i",{staticClass:"action-btn el-icon-plus"}),n("i",{staticClass:"action-btn el-icon-edit"}),n("i",{staticClass:"action-btn el-icon-delete"})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",[n("i",{staticClass:"action-btn el-icon-plus"}),n("i",{staticClass:"action-btn el-icon-edit"}),n("i",{staticClass:"action-btn el-icon-delete"})])}],B=(n("57e7"),{name:"placeholder-sub-table",props:["controlData"],computed:{specificColumns:function(){return this.controlData?this.controlData.specialColumns.split(","):[]},checkcolumn:function(){return-1!==this.specificColumns.indexOf("checkcolumn")},checkcolumnFrozen:function(){return!(!this.checkcolumn||0!=this.frozenIndex)},indexcolumn:function(){return-1!==this.specificColumns.indexOf("indexcolumn")},indexcolumnForzen:function(){return this.checkcolumn?1==this.frozenIndex:0==this.frozenIndex},actioncolumn:function(){return-1!==this.specificColumns.indexOf("actioncolumn")},frozenIndex:function(){return this.controlData.frozenColumnIndex},prevColumnCount:function(){return this.checkcolumn&&this.indexcolumn?2:this.checkcolumn||this.indexcolumn?1:(this.checkcolumn||this.indexcolumn,0)},columns:function(){return this.controlData.columns.length?this.controlData.columns:[{field:"name",name:"姓名",width:100,align:"center",required:!0,vtype:"number"}]}},data:function(){return{}},methods:{}}),z=B,H=Object(u["a"])(z,N,V,!1,null,null,null),G=H.exports,q=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"output",class:{"design-form-output":t.asControl,"design-control-holder":!t.asControl},style:t.styleText},[t._v(t._s(t.controlData.name||t.controlData.namePrefix+"_"+t.controlData.autoIndex))])},U=[],W={name:"placeholder-output",props:{controlData:{type:Object,default:function(){return{}}},asControl:{type:Boolean,default:!1}},computed:{controlWidth:function(){var t=this.controlData.width;return t?t+""===t?t:"".concat(t,"px"):""},styleText:function(){var t=this.controlData,e=t.fontSize,n=t.fontFamily,o=t.fontColor,i=t.fontBolder,r=t.fontItalic,a=t.fontUnderline,l=t.textAlign,s=(t.width,[]);return s.push("display:inline-block"),s.push("-webkit-box-sizing:border-box;box-sizing:border-box;"),s.push("font-size:".concat(e,"px")),s.push("font-family:".concat(n)),s.push("color:".concat(o)),s.push("font-weight:".concat(i?"bold":"normal")),s.push("font-style:".concat(r?"italic":"normal")),s.push("text-decoration:".concat(a?"underline":"none")),s.push("text-align:".concat(l)),this.controlWidth&&s.push("width:".concat(this.controlWidth)),s.join(";")}},data:function(){return{}}},J=W,Y=Object(u["a"])(J,q,U,!1,null,null,null),X=Y.exports,K=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.show?n("span",{class:t.cls,attrs:{"data-tooltip":t.tooltip,title:t.tooltip}},[t._v(t._s("tooltip"!==t.config.type?t.config.content:""))]):t._e()},Q=[],Z={name:"control-tooltip",props:["controlData"],computed:{cls:function(){var t="control-tooltip";return this.config&&this.config.type&&(t+=" tips-"+this.config.type,"tooltip"==this.config.type&&(t+=" el-icon-question")),t},show:function(){return!!(this.config&&this.config.type&&this.config.content)},tooltip:function(){return this.config&&"tooltip"===this.config.type?this.config.content:""}},data:function(){return{config:this.controlData.tooltipConfig}},methods:{doUpdate:function(){this.config=this.controlData.tooltipConfig}},watch:{controlData:{deep:!0,handler:function(t){this.doUpdate()}}}},tt=Z,et=(n("a58f"),Object(u["a"])(tt,K,Q,!1,null,null,null)),nt=et.exports,ot={label:r["a"],textbox:f,ewebeditor:b,title:y["a"],textarea:_,checkboxlist:A,radiobuttonlist:R,subtable:G,output:X},it={props:["controlData"],template:'<span class="design-control-holder" :class="controlData.type">{{controlData.name || (controlData.namePrefix + "_" + controlData.autoIndex)}}</span>'},rt={name:"control",props:{controlData:{type:Object,required:!0}},components:{PlaceholderLabel:r["a"],PlaceholderTextbox:f,PlaceholderTitle:y["a"],PlaceholderTextArea:_,PlaceholderCheckboxList:A,PlaceholderRadioButtonList:R,ToolTip:nt},data:function(){return{}},computed:{controlIconMap:function(){var t={};return window.FORM_DESIGN_CONFIG.controlList.concat(this.$store.state.extControls).forEach((function(e){t[e.type]=e.icon})),t},controlWidth:function(){var t=this.controlData.width;return t?t+""===t?t:"".concat(t,"px"):""},extCls:function(){var t,e=this.controlData.tooltipConfig;return t=e&&e.content?"with-tooltip tooltip-".concat(e.type):"","".concat(t," ").concat(this.controlData.type)}},methods:{removeControl:function(){this.$store.dispatch("deleteControl")},getControlComponent:function(t){return t in ot?ot[t]:it}}},at=rt,lt=Object(u["a"])(at,o,i,!1,null,null,null);e["a"]=lt.exports},a58f:function(t,e,n){"use strict";n("ab45")},ab45:function(t,e,n){},ab9e:function(t,e,n){"use strict";n("2caf");e["a"]={computed:{dataList:function(){var t=this.controlData;return Array.isArray(t.data)?t.data:this.originData&&this.originData.length?this.originData:this.defaultDataList}},methods:{getDataList:function(){var t=this,e=this.controlData;if(Array.isArray(e.data)||!e.codeItem)return this.originData=[];this.$httpPost(window.formDesignerActions.getControlDataListUrl,{controlData:this.controlData}).then((function(e){if(!Array.isArray(e))throw new Error("获取控件数据出错!");t.originData=e})).catch((function(e){t.originData=[],console.error(e)}))}},watch:{"controlData.codeItem":function(t){t&&this.getDataList()}}}},adb5:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return l}));var o=n("53ca");n("456d"),n("ac6a"),n("f3e2"),n("6b54"),n("87b3"),n("386d");function i(t){return t.custom&&(t=t.custom,"string"==typeof t&&(t=JSON.parse(t))),t}function r(t){var e=new URLSearchParams(location.search),n=e.toString();return n?t+(/\?/.test(t)?"&":"?")+n:t}function a(t,e,n){return new Promise((function(o,a){var l=new XMLHttpRequest;l.onreadystatechange=function(){if(l.readyState===XMLHttpRequest.DONE)if(200===l.status)try{o(e?l.responseText:i(JSON.parse(l.responseText)))}catch(t){console.error(t),o(l.responseText)}else a("There was a problem with the request.")},l.open("GET",r(t)),n&&Object.keys(n).forEach((function(t){l.setRequestHeader(t,n[t])})),l.send()}))}function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return new Promise((function(a,l){var s=new XMLHttpRequest;s.onreadystatechange=function(){if(s.readyState===XMLHttpRequest.DONE)if(200===s.status)try{a(i(JSON.parse(s.responseText)))}catch(t){console.error(t),a(s.responseText)}else l({state:s.status})},s.open("POST",r(t)),s.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8"),n&&Object.keys(n).forEach((function(t){s.setRequestHeader(t,n[t])}));var c=new URLSearchParams;for(var u in e)c.append(u,"object"==Object(o["a"])(e[u])?JSON.stringify(e[u]):e[u]);s.send(c)}))}},ae24:function(t,e,n){},aea2:function(t,e,n){},aeeb:function(t,e,n){"use strict";n("529d")},af23:function(t,e,n){},b020:function(t,e,n){"use strict";n("81ec")},b0c7:function(t,e,n){},b2ce:function(t,e,n){"use strict";n("cd52")},b8b5:function(t,e,n){"use strict";n("ae24")},bc50:function(t,e,n){},bc87:function(t,e,n){"use strict";n("279b")},bec5:function(t,e,n){"use strict";n("5bdd")},c0a5:function(t,e,n){"use strict";n("bc50")},c28b:function(t,e,n){},caff:function(t,e,n){"use strict";n("3552")},cd52:function(t,e,n){},ce0a:function(t,e,n){},d3d4:function(t,e,n){},d482:function(t,e,n){"use strict";n("af23")},d56b:function(t,e,n){"use strict";n("d3d4")},d5bd:function(t,e,n){},d5c7:function(t,e,n){"use strict";n("9cb4")},d718:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",{staticClass:"label",class:{"design-form-label":t.asControl,"design-control-holder":!t.asControl,colons:t.autoColons,required:t.controlData.showStar},style:t.styleText,attrs:{title:t.controlData.labelText||""},domProps:{innerHTML:t._s(t.contentHtml)}})},i=[],r=(n("7f7f"),n("7b52")),a={name:"placeholder-label",props:{controlData:{type:Object,default:function(){return{}}},asControl:{type:Boolean,default:!1}},mixins:[r["a"]],computed:{contentHtml:function(){var t=this.controlData.labelText||this.controlData.name,e=this.controlData.hideColon;return this.lineFeed(t)+(this.autoColons&&!e?"：":"")},autoColons:function(){return this.$store.state.globalStyle.autoColons},styleText:function(){var t=this.controlData,e=t.fontSize,n=t.fontFamily,o=t.fontColor,i=t.fontBolder,r=t.fontItalic,a=t.fontUnderline,l=t.textAlign,s=t.verticalAlign,c=[];return c.push("font-size:".concat(e,"px")),c.push("font-family:".concat(n)),c.push("color:".concat(o)),c.push("font-weight:".concat(i?"bold":"normal")),c.push("font-style:".concat(r?"italic":"normal")),c.push("text-decoration:".concat(a?"underline":"none")),c.push("text-align:".concat(l||"")),c.push("vertical-align:".concat(s||"")),c.join(";")}},data:function(){return{}}},l=a,s=n("2877"),c=Object(s["a"])(l,o,i,!1,null,null,null);e["a"]=c.exports},d87d:function(t,e,n){},db49:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return i}));var o=48,i=30},dd1c:function(t,e,n){},e06a:function(t,e,n){"use strict";n("8feb")},e4ac:function(t,e,n){"use strict";n("4277")},eafa:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("draggable",{staticClass:"dropArea layout",class:"level-"+t.level,attrs:{group:"layout",swapThreshold:.3,delay:0,list:t.list,move:t.checkLayoutMove,filter:".col-helper-line",preventOnFilter:!1,disabled:!1},on:{change:t.onLayoutChange,start:t.onLayoutDragStart,end:t.onLayoutDragEnd,choose:t.onDragChoose}},t._l(t.list,(function(e,o){return n("Row",{key:e.id,attrs:{level:t.level,row:e,index:o,"parent-col":t.parentCol,"is-last-row":o==t.list.length-1,"prev-row":0==o?null:t.list[o-1]}})})),1)},i=[],r=(n("1c01"),n("58b2"),n("8e6e"),n("f3e2"),n("d25f"),n("ac6a"),n("456d"),n("0cd8"),n("7f7f"),n("ade3")),a=(n("c5f6"),n("2f62")),l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"row",class:t.className,style:t.style,attrs:{"row-id":t.row.id,"data-name":t.row.name,"data-level":t.level}},[t._l(t.row.cols,(function(e,o){return n("ColLayout",{key:e.id,attrs:{"is-last-row":t.isLastRow,index:o,col:e,row:t.row,level:t.level,"row-index":t.index},on:{"on-context-menu":function(n){return t.onContextmenu(n,{row:t.row,rowIndex:t.index,parentCol:t.parentCol,col:e,colIndex:o,colDeletable:!!t.row.cols.length})}}})})),n("div",{staticClass:"row-helper"},[n("el-tooltip",{attrs:{placement:"top",enterable:!1,"open-delay":300,content:"移除行"}},[n("span",{staticClass:"row-helper-btn remove el-icon-delete",on:{click:function(e){return e.stopPropagation(),t.handleRowRemove(t.row,t.index)}}})]),n("el-tooltip",{attrs:{placement:"top",enterable:!1,"open-delay":300,content:"复制行"}},[n("span",{staticClass:"row-helper-btn copy el-icon-copy-document",on:{click:function(e){return t.handleRowCopy(t.row,t.index,t.parentCol)}}})]),n("el-tooltip",{attrs:{placement:"top",enterable:!1,"open-delay":300,content:"选择"}},[n("span",{staticClass:"row-helper-btn selected el-icon-top-left",on:{click:function(e){return e.stopPropagation(),t.handleRowSelect(t.row.id)}}})])],1)],2)},s=[],c=(n("2caf"),n("ac4d"),n("8a81"),n("5df3"),n("1c4c"),n("6b54"),n("87b3"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"col",class:t.getColCls(t.col,t.index,t.row.cols.length),style:t.colStyle,attrs:{id:t.col.id,name:t.col.name},on:{click:function(e){return e.stopPropagation(),t.handleColClick(t.index,t.col,e)},contextmenu:function(e){return e.stopPropagation(),e.preventDefault(),t.onContextMenu(e)}}},["acc-item"==t.type?n("h2",{staticClass:"acc-item-header",class:{closed:!t.col.props.opened}},[n("span",{staticClass:"acc-item-index"},[t._v(t._s(t.getAccItemIndex(t.index)))]),n("span",{staticClass:"acc-item-title"},[t._v(t._s(t.col.props.title))]),n("span",{staticClass:"acc-item-toggle",on:{click:t.toggleAccItem}})]):t._e(),t.showNested?n("RowLayout",{directives:[{name:"show",rawName:"v-show",value:"acc-item"==t.type||t.col.subs&&t.col.subs.length||t.inLayoutDragging,expression:"type == 'acc-item' || (col.subs && col.subs.length) || inLayoutDragging"}],attrs:{list:t.col.subs,level:t.levelNext,parentCol:t.col,parentRow:t.row}}):t._e(),t.showControlContainer?n("draggable",{staticClass:"dropArea controls",class:{active:t.col.controls.length||t.inControlDragging},attrs:{group:"control",list:t.col.controls,draggable:".design-control",swapThreshold:1,invertedSwapThreshold:1,invertSwap:!1,direction:"vertical",move:t.checkControlMove},on:{start:t.onControlDragStart,end:t.onControlDragEnd,add:function(e){return t.onControlAdd(e,{col:t.col,colIndex:t.index,row:t.row})}}},t._l(t.col.controls,(function(e){return n("Control",{key:e.id,class:{selected:e.id==t.selectedControlId},attrs:{"control-data":e},nativeOn:{click:function(n){return n.stopPropagation(),t.onControlClick(e.id)}}})})),1):t._e(),t.showXResizer?n("div",{staticClass:"col-helper-line line-v",attrs:{"data-row-index":t.rowIndex,"data-col-index":t.index,"data-level":t.level}}):t._e(),t.showYResizer?n("div",{staticClass:"col-helper-line line-h",attrs:{"data-row-index":t.rowIndex,"data-col-index":t.index}}):t._e()],1)}),u=[],d=n("a3de"),f={methods:{closestComponent:function(t,e){var n=e||this,o=n.$parent||n.$root;if(t+""===t){var i=o.$options.name;while(o&&(!i||i!==t))o=o.$parent,o&&(i=o.$options.name)}else while(o&&!t(o))o=o.$parent;return o}}};function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m={name:"ColLayout",components:{RowLayout:function(){return Promise.resolve().then(n.bind(null,"eafa"))},Control:d["a"]},data:function(){return{}},inject:{hideCtxMenu:"hideCtxMenu"},mixins:[f],props:{row:{type:Object,required:!0},rowIndex:{type:Number,required:!0},col:{type:Object,required:!0},index:{type:Number,required:!0},level:{type:Number,required:!0},isLastRow:{type:Boolean,required:!0}},computed:h(h(h({},Object(a["e"])(["globalStyle","selectedColId","selectedControlId"])),Object(a["c"])(["inControlDragging","inLayoutDragging"])),{},{showNested:function(){return"col-item"!==this.type||!this.col.controls.length&&1!=this.row.cols.length},type:function(){var t=this.col;return t&&t.type?t.type:"col-item"},showControlContainer:function(){return"col-item"==this.type&&(!this.col.subs||!this.col.subs.length)},levelNext:function(){return this.level+1},colStyle:function(){var t=this.col.style.width,e=t+""===t?t:"".concat(t,"px");return{width:e}},showXResizer:function(){return"acc-item"!=this.type&&this.index!==this.row.cols.length-1},showYResizer:function(){if("acc-item"==this.type)return!1;if(1==this.level&&"col-item"==this.type){var t=this.closestComponent("ColLayout",this.$parent);if(t&&"acc-item"==t.type)return!0}return 0===this.level||!this.isLastRow}}),methods:h(h({},Object(a["b"])(["setSelectedControl","activeRightTab","setSelectedCol"])),{},{getColCls:function(t,e,n){var o,i=this.globalStyle,a=t.subs.length,l=t.style,s=(o={selected:this.selectedColId==t.id,isSub:!a,hasSub:a},Object(r["a"])(o,"text-"+(l.textAlign||i.textAlign),!0),Object(r["a"])(o,"vertical-"+(l.verticalAlign||i.verticalAlign),!0),o);return s[this.type]=!0,"col-item"==this.type&&(s.first=0===e,s.mid=e&&e!==n-1,s.last=e===n-1),s},handleColClick:function(t,e,n){this.hideCtxMenu();var o=n.target;if(!o.classList.contains("col-helper-line")){var i=o.closest(".col");if(i){var r=e.id==this.selectedColId;r?this.setSelectedCol({id:""}):(this.setSelectedCol({id:e.id}),this.activeRightTab("cell"))}}},onControlDragStart:function(){this.controlDragStart()},onControlDragEnd:function(t){this.controlDragEnd()},onControlAdd:function(t,e){var n=e.col.controls&&e.col.controls[t.newIndex];if(n&&n.id&&this.onControlClick(n.id),t.from.classList.contains("control-drag-area")){var o=t.item.dataset.controlType;if("title"==o||"label"==o||"subtable"==o)return;var i=e.row,r=e.colIndex,a=i.cols[r-1];if(!a)return;var l=!a.controls.length&&!a.subs.length;l&&this.$store.dispatch("autoAddLabel",{parentCol:a,controlData:n})}},checkControlMove:function(t){if(t.to.classList.contains("design-hidden-area"))return!1},onControlClick:function(t){var e=this;this.setSelectedControl({id:t}),this.activeRightTab("control"),setTimeout((function(){e.$bus.$emit("cntrolClick")}),100)},onContextMenu:function(t){var e;(e=console).log.apply(e,arguments),this.$emit("on-context-menu",t)},getAccItemIndex:function(t){var e=t+1;return e<10?"0"+e:e},toggleAccItem:function(t){t.stopPropagation();var e=t.target.closest(".acc-item-header");e&&e.classList.toggle("closed")}})},g=m,v=n("2877"),b=Object(v["a"])(g,c,u,!1,null,null,null),y=b.exports,C=n("4260"),w=n("42a0"),x=n.n(w),O={methods:{onContextmenu:function(t,e){var n=t.target;(1==e.row.cols.length||2===e.row.cols.length&&e.parentCol&&1===e.parentCol.subs.length)&&(e.colDeletable=!1),e.col&&e.col.controls&&e.col.controls.length&&(e.hasControl=!0);var o=n.closest(".design-control");if(o){for(var i,r,a,l=o.dataset.id,s=0,c=e.col.controls.length;s<c;s++)if(a=e.col.controls[s],a.id==l){i=s,r=a;break}r&&(e.control=r,e.controlIndex=i)}this.$data._ctxMenuData=e,this.showCtxMenu(t,e,this.handleContextMenu)},handleContextMenu:function(t,e){var n=this.$data._ctxMenuData;switch(t){case"deleteControl":this.deleteControl({selectedControl:n.control,selectedControlParentCol:n.col,selectedControlIndex:n.controlIndex});break;case"removeCol":this.removeCol({col:n.col,parentRow:n.row,colIndex:n.colIndex});break;case"removeRow":this.handleRowRemove(n.row,n.rowIndex);break;case"insertRowUp":this.copyRow({aimIndex:n.rowIndex,parentCol:n.parentCol,newRow:this.getRowCopyData(n.row,!0),shuttle:!0});break;case"insertRowDown":this.copyRow({aimIndex:n.rowIndex+1,parentCol:n.parentCol,newRow:this.getRowCopyData(n.row,!0),shuttle:!0});break;case"insertColLeft":this.splitCol({col:n.col,colIndex:n.colIndex,count:2,parentRow:n.row,direction:"left",shuttle:!0});break;case"insertColRight":this.splitCol({col:n.col,colIndex:n.colIndex,count:2,parentRow:n.row,direction:"right",shuttle:!0});break;case"insertMultiCol":this.splitCol({col:n.col,colIndex:n.colIndex,count:e.colCount||2,parentRow:n.row,direction:"right",shuttle:!0});break;case"insertMultiRowCol":this.$store.dispatch("insertMultiRowCol",{col:n.col,parentCol:n.parentCol,parentRow:n.row,parentRowIndex:n.rowIndex,rowCount:e.rowCount,colCount:e.colCount,shuttle:!0});break;default:break}}}};function D(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=_(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,r=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw r}}}}function _(t,e){if(t){if("string"===typeof t)return k(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(t,e):void 0}}function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function S(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function j(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?S(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var T={name:"Row",components:{ColLayout:y},inject:{showCtxMenu:"showCtxMenu"},props:{row:{type:Object},index:{type:Number},level:{type:Number},parentCol:{type:Object,default:null},isLastRow:{type:Boolean},prevRow:{type:Object,default:null}},computed:j(j({},Object(a["e"])(["selectedRowId"])),{},{type:function(){var t=this.row;return t&&t.type?t.type:"row-layout"},style:function(){var t=this.row.height,e=t+""===t?t:t+"px",n={};return"acc-layout"==this.type&&(n.marginTop="16px",n.marginBottom="16px"),"row-layout"==this.type&&(n["min-height"]=e),n},className:function(){var t,e=this.type,n=(t={},Object(r["a"])(t,e,!0),Object(r["a"])(t,"isTop",0==this.level),Object(r["a"])(t,"selected",this.selectedRowId==this.row.id),t);return"acc-layout"==e||(0===this.index||this.prevRow&&this.prevRow.type&&"row-layout"!=this.prevRow.type?n.first=!0:n.mid=!0),n}}),mixins:[O],data:function(){return{_ctxMenuData:null}},methods:j(j(j({},Object(a["d"])(["copyRow","splitCol"])),Object(a["b"])(["setSelectedLayout","deleteRow","activeRightTab","deleteControl"])),{},{handleRowSelect:function(t){this.setSelectedLayout({id:t}),this.activeRightTab("control")},handleRowCopy:function(t,e,n){var o=this.getRowCopyData(t);this.copyRow({aimIndex:e+1,parentCol:n,newRow:o,shuttle:!0})},getRowCopyData:function(t,e){var n=Object(C["d"])(t);return o(n),n;function o(t){var n=Object(C["l"])(),r=t.namePrefix||t.name;t.id=n,t.autoIndex=C["j"].getIndex(r),t.name&&(t.name="".concat(t.name,"_").concat(t.autoIndex)),t.cols.forEach((function(t){t.id="col-".concat(n,"-").concat(C["b"].getIndex(n)),t.subs&&t.subs.forEach(o),e?t.controls=[]:t.controls.forEach(i)}))}function i(t){var e=t.type,n=window.FORM_DESIGN_CONFIG.controls[e];if(!n)throw new Error("控件的 ".concat(e," 配置信息不存在，无法创建"));var o=Object(C["d"])(n);delete o.configItems,delete o.name,delete o.width,delete o.id,delete o.type,"label"!=e&&"title"!=e&&x()(t,o);var i=C["c"].getIndex(e);t.id=e+"-"+i,t.autoIndex=i,t.name&&(t.name="".concat(t.name,"_").concat(i))}},handleRowRemove:function(t,e){var n=this;if(this.isEmptyRow(t))return this.doRowRemove(t,e);this.$confirm("此操作将移除此行，以及此行内的所有内容，是否确认？"," 删除提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n.doRowRemove(t,e)})).catch((function(){}))},doRowRemove:function(t,e){this.deleteRow({parentCol:this.parentCol,row:t,index:e})},isEmptyRow:function(t){var e,n=D(t.cols);try{for(n.s();!(e=n.n()).done;){var o=e.value;if(o.subs.length||o.controls.length)return!1}}catch(i){n.e(i)}finally{n.f()}return!0},removeCol:function(t){var e=this,n=t.col,o=t.parentRow,i=t.colIndex;if(this.isEmptyCol(n))return this.doColRemove(n,o,i);this.$confirm("删除后此单元格内的所有内容将一并删除，是否继续？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.doColRemove(n,o,i)})).catch((function(t){t&&console.error(t)}))},doColRemove:function(t,e,n){this.$store.dispatch("removeCol",{col:t,parentRow:e,colIndex:n,shuttle:!0})},isEmptyCol:function(t){return!(t.subs.length||t.controls.length)}})},I=T,P=Object(v["a"])(I,l,s,!1,null,null,null),A=P.exports,E=n("84a2"),L=n.n(E),$=(n("f400"),n("4f7f"),n("2909")),M=(n("6d67"),n("db49")),F={methods:{onMouseDown:function(t){var e=t.target;if(!e.classList.contains("col-helper-line"))return!0;window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp);var n=this.rowEl=e.closest(".row"),o=this.colEl=e.closest(".col");this.rowId=n&&n.getAttribute("row-id"),this.rowData=this.findRow(this.rowId),this.startHeight=this.rowData.height||M["b"];var i=this.getDesignContainer(),r=i.getBoundingClientRect();this.mouseOffset=this.getMouseOffset(t),this.stagElementsOffset(t,r);var a=parseInt(e.dataset.colIndex,10);this.colData=this.rowData.cols[a],this.nextColData=this.rowData.cols[a+1],this.colData.width+""===this.colData.width?this.startWidth=o.getBoundingClientRect().width:this.startWidth=this.colData.style.width,this.rowId,this.inMoving=!0,e.classList.contains("line-v")?(this.getXLimit(t,r),this.resizeMode="v",this.startOffsetX=this.getXOffset(t),this.updateLineLeft(this.startOffsetX),this.showVLine()):e.classList.contains("line-h")&&(this.getYLimit(t,r),this.resizeMode="h",this.startOffsetY=this.getYOffset(t),this.updateLineTop(this.startOffsetY),this.showHLine())},onMouseMove:function(t){if("h"==this.resizeMode){var e=this.getYOffset(t);e=Object(C["a"])(e,this.moveRange.y[0],this.moveRange.y[1]),this.updateLineTop(e);var n=e-this.startOffsetY,o=this.startHeight+n;o<M["b"]&&(o=M["b"]),this.updateRowHeight({rowId:this.rowId,height:o,row:this.rowData,parentRowPath:this.pathMap[this.rowId],shuttle:!0})}else if("v"==this.resizeMode){var i=this.getXOffset(t);i=Object(C["a"])(i,this.moveRange.x[0],this.moveRange.x[1]);var r=this.getSnapOffset(i);r&&(i=r),this.updateLineLeft(i);var a=i-this.startOffsetX,l=this.startWidth+a;l<10&&(l=10),this.updateColWidth({col:this.colData,width:l,nextCol:this.nextColData,shuttle:!0})}},getXLimit:function(t,e){var n,o;function i(t,e){if(!t.subs||!t.subs.length)return t.style.width;var n=t.subs.map((function(t){return i(t.cols["first"==e?0:t.cols.length-1])}));return Math.min.apply(Math,Object($["a"])(n))}this.colData?(n=i(this.colData,"last"),n=n<M["a"]?0:n-M["a"]):n=0,this.nextColData?(o=i(this.nextColData,"first"),o=o<M["a"]?0:o-M["a"]):o=0,n=t.pageX-e.left-this.mouseOffset.x-n,o=t.pageX-e.left-this.mouseOffset.x+o,this.moveRange.x=[n,o]},getYLimit:function(t,e){var n,o,i=r(this.rowData)||M["b"];return n=i-M["b"],n<0&&(n=0),n=t.pageY-e.top-this.mouseOffset.y-n,o=1/0,this.moveRange.y=[n,o],[n,o];function r(t){var e=!1,n=[];return t.cols.forEach((function(t){t.subs&&t.subs.length&&(e=!0,n.push(r(t.subs[t.subs.length-1])))})),t.height,e?Math.min.apply(Math,n):t.height}},getLimitedOffset:function(){},getYOffset:function(t){var e=this.getDesignContainer(),n=e.getBoundingClientRect(),o=t.pageY-n.top-this.mouseOffset.y;return o},getXOffset:function(t){var e=this.getDesignContainer(),n=e.getBoundingClientRect(),o=t.pageX-n.left-this.mouseOffset.x;return o},getMouseOffset:function(t){var e=t.target,n=e.getBoundingClientRect();return{x:t.pageX-n.left-n.width/2,y:t.pageY-n.top-n.height/2}},stagElementsOffset:function(t,e){var n=this.getDesignContainer(),o=t.target.closest("col"),i=[].slice.call(n.querySelectorAll(".col.isSub")),r=[];i.forEach((function(t){if(!t.classList.contains("last")&&t!=o){var n=t.getBoundingClientRect(),i=n.left+n.width-e.left;r.push(i)}})),this.otherColOffSets=Array.from(new Set(r)),this.otherColOffSets},getSnapOffset:function(t){var e=new Map;return this.otherColOffSets.forEach((function(n){var o=Math.abs(t-n);o<=10&&e.set(o,n)})),!!e.size&&e.get(Math.min.apply(Math,Object($["a"])(e.keys())))},onMouseUp:function(){this.hideHLine(),this.hideVLine(),this.resetMoveData(),this.removeEventListener()},resetMoveData:function(){this.inMoving=!1,this.rowEl=null,this.colEl=null,this.rowId="",this.rowData=null,this.colData=null,this.nextColData=null,this.startOffsetX=0,this.startOffsetY=0,this.mouseOffset.x=0,this.mouseOffset.y=0,this.moveRange.x=[0,0],this.moveRange.y=[0,0],this.otherColOffSets=[],this.startHeight=0,this.startWidth=0,this.resizeMode=!1},removeEventListener:function(){window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp)}}};function R(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function N(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?R(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var V={name:"row-layout",inject:{getDesignContainer:{default:function(){return document.getElementById("design-area")}},showCtxMenu:"showCtxMenu",showMutliRowConfirm:"showMutliRowConfirm"},mixins:[F],props:{list:{type:Array,default:function(){return[]}},level:{type:Number,default:0},parentCol:{type:Object,default:null},parentRow:{type:Object,default:null}},data:function(){return{inMoving:!1,rowEl:null,colEl:null,rowId:"",rowData:null,colData:null,nextColData:null,startOffsetX:0,startOffsetY:0,mouseOffset:{x:0,y:0},moveRange:{x:[0,0],y:[0,0]},otherColOffSets:[],startHeight:0,startWidth:0,resizeMode:!1}},mounted:function(){0===this.level&&this.$el.addEventListener("mousedown",this.onMouseDown)},components:{Row:A},computed:N(N({},Object(a["e"])(["formSize"])),{},{levelNext:function(){return this.level+1},dataMap:function(){return this.$store.getters.rowDataMap},pathMap:function(){return this.$store.getters.subRowPathMap}}),methods:N(N(N({},Object(a["d"])(["updateLineTop","updateLineLeft","showHLine","hideHLine","showVLine","hideVLine","updateRowHeight","updateColWidth","layoutDragStart","layoutDragEnd","controlDragStart","controlDragEnd"])),Object(a["b"])(["setSelectedControl","setSelectedCol","setSelectedLayout","deleteRow","deleteControl","activeRightTab"])),{},{throttle:L()((function(t,e){t.name,t(e)}),20,{leading:!0,trailing:!1}),checkLayoutMove:function(t){var e=t.draggedContext.element;return!(1==e.cols.length&&!t.to.classList.contains("level-0")&&!t.to.parentElement.classList.contains("acc-item"))&&(!("acc-layout"==e.type&&!t.to.classList.contains("level-0"))&&void 0)},checkControlMove:function(t){if(t.to.classList.contains("design-hidden-area"))return!1},onLayoutChange:function(t){var e=this;if(t.added){var n=t.added.element,o=this.parentCol;if(this.parentCol,n.asMulti)return this.showMutliRowConfirm((function(i,r){if(o&&"acc-item"!=o.type&&1==i&&1==r)return e.$store.dispatch({type:"deleteRow",parentCol:e.parentCol,row:n,index:t.added.newIndex,shuttle:!1}),e.$message({type:"error",message:"单行单列不能被嵌套在单元格中"});e.$store.commit("replaceToMulti",{row:n,rowIndex:t.added.newIndex,rowCount:i,colCount:r,parentCol:o,shuttle:!0})}));if("acc-layout"==n.type)return this.$store.commit({type:"tryMergeAcc",row:n,rowIndex:t.added.newIndex});if(this.handleColWidthChange(n),this.parentCol&&"acc-item"!=this.parentCol.type){var i=this.pathMap[n.id],r=i[0],a=r.height,l=this.parentCol.subs.reduce((function(t,e){return t+e.height}),0),s=a-l;s<=0?this.updateRowHeight({rowId:r.id,row:r,height:l,bubble:!0,rowPath:this.pathMap[r.id],shuttle:!0,group:"adjust"}):this.updateRowHeight({rowId:n.id,height:n.height+s,row:n,bubble:!1,shuttle:!0,group:"adjust"})}}if(t.removed&&this.parentCol&&this.parentRow){var c=this.parentCol.subs,u=this.parentRow.height,d=c.reduce((function(t,e){return t+e.height}),0),f=c[c.length-1],p=f.height+(u-d);p&&this.updateRowHeight({rowId:f.id,row:f,height:p,bubble:!1,shuttle:!0,group:"adjust"})}},handleColWidthChange:function(t){if("acc-layout"!=t.type){var e=this.parentCol?this.parentCol.style.width:this.formSize.width,n=t.cols.reduce((function(t,e){return t+e.style.width}),0),o=e/n;isNaN(o)&&(o=1),this.$store.commit({type:"updateRowColWidth",rowId:t.id,row:t,ratio:o,shuttle:!0,group:"adjust"})}},onLayoutDragStart:function(){this.layoutDragStart()},onLayoutDragEnd:function(){this.layoutDragEnd()},onControlDragStart:function(){this.controlDragStart()},onControlDragEnd:function(t){this.controlDragEnd()},onDragChoose:function(){},findRow:function(t){var e=this.dataMap[t];return e?e.row:null}}),beforeDestroy:function(){this.$el.removeEventListener("mousedown",this.onMouseDown)}},B=V,z=(n("0015"),Object(v["a"])(B,o,i,!1,null,null,null));e["default"]=z.exports},ec83:function(t,e,n){"use strict";n("c28b")},ef38:function(t,e,n){"use strict";n("aea2")},f1a3:function(t,e,n){"use strict";n("b0c7")},f4d4:function(t,e,n){"use strict";n("250c")},f5bd:function(t,e,n){"use strict";n("ce0a")},ff06:function(t,e,n){}});