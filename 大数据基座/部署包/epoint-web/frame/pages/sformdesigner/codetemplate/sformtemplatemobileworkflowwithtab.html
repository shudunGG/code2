<!DOCTYPE html>
<html>

<head>
<title>@title</title>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport"
	content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
<script>
	document.write("<script src='../../../../../frame/fmui/js/cssboot.js?"
			+ Math.random() + "'></scr" + "ipt>");
</script>
<script>
	SrcBoot
			.output([ '../../../../../frame/fmui/showcase/comdto/css/common.new.css' ]);
</script>
<style>
.mui-input-row label {
	margin-top: 3px;
}
</style>
<body class="ejs-f9-content">
	<div class="page-loading"></div>
	<!-- 内容区域 -->

	<div class="mui-content">
		<div id="slider" class="mui-slider">
			<div id="sliderSegmentedControl"
				class="mui-slider-indicator mui-segmented-control mui-segmented-control-inverted">
				<a class="mui-control-item mui-active" href="#item1mobile"> 表单 </a>
				<a class="mui-control-item" href="#item2mobile"> 步骤 </a> <a
					class="mui-control-item" href="#item3mobile"> 附件 </a>
			</div>
			<div id="sliderProgressBar"
				class="mui-slider-progress-bar mui-col-xs-4"></div>
			<div class="mui-slider-group">
				<div id="item1mobile"
					class="mui-slider-item mui-control-content mui-active hidden">
					<div id="scroll1" class="mui-scroll-wrapper">
						<div class="mui-scroll">
							<ul class="mui-table-view editor-list">@contentContainer @inputh
							</ul>
							<!-- HandleControls -->
							<div class="ep-mui-handlecontrols" id="handlecontrols"
								action="handleCtrl"
								workflowPageUrl="../../../../../frame/fmui/showcase/comdto/workflow"></div>
						</div>
					</div>
				</div>
				<div id="item2mobile"
					class="mui-slider-item mui-control-content hidden">
					<div id="scroll2" class="mui-scroll-wrapper">
						<div class="mui-scroll">
							<div id="workflowhistory" class="ep-mui-workflowhistory"
								action="workflowhistoryaction.historyCtrl"></div>
						</div>
					</div>
				</div>
				<div id="item3mobile"
					class="mui-slider-item mui-control-content hidden">
					<div id="scroll3" class="mui-scroll-wrapper">
						<div class="mui-scroll">
							<div class="mui-scroll">
								<div id="workflowattach" class="ep-mui-workflowattach"
									onitemclick="itemClick" action="attachCtrl"></div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- HandleControls -->
		<div class="ep-mui-handlecontrols" id="handlecontrols"
			action="handleCtrl"
			workflowPageUrl="../../../../../frame/fmui/showcase/comdto/workflow"></div>
	</div>

	<script type="text/template" id="tpl-subtable">
    <div class="mui-table-view">
      <div class="mui-table-view-cell">名字：{{displayName}}</div>
    </div>
  </script>

	<script type="text/template" id="tpl-fileitem">
    <li data-downloadurl="{{downloadUrl}}" data-filetype="{{filetype}}" data-attachfilename="{{attachFileName}}" data-attachguid="{{attachGuid}}" data-type="body">
      {{attachFileName}} - 上传成功
      <a href="javascript:void(0);" data-role="preview" class="r">查看</a>
    </li>
  </script>

	<script>
		document.write("<script src='../../../../../frame/fmui/js/jsboot.js?"
				+ Math.random() + "'></scr" + "ipt>");
	</script>

	<script>
		SrcBoot
				.output([
						'../../../../../frame/fmui/showcase/comdto/js/handlecontrols.js',
						'../../../../../frame/fmui/showcase/comdto/js/workflowattach.js',
						'../../../../../frame/fmui/showcase/comdto/js/workflowhistory.js' ]);
	</script>

	<script>
		Util.loadJs(initPage);

		function initPage() {
			var scrollHeight = window.screen.height - 40;
			ejs.navigator.setTitle(document.title);
			epointm
					.initPage(
							"sformdesigncommonaction?tableId=@tableId&versionguid=@versionguid&tableguid=@tableguid&hiddenname=@hidden",
							null, null, null, {
								method : "GET"
							});

			mui('.mui-scroll-wrapper').scroll({
				indicators : true, //是否显示滚动条
				scrollY : true
			});

			$.each(mui('.mui-control-content'), function(i, e) {
				e.style.height = scrollHeight + 'px';
				e.classList.remove('hidden');
			});
		}

		/**
		 * 没有图片的话设置默认图片
		 */
		window.setDefaultImg = function() {
			this.src = '../../../../../frame/fmui/showcase/comdto/images/toux.PNG';
		}

		/**
		 * 点击下载按钮
		 */
		window.itemClick = function(e, materialguid, materialname) {
			// TODO: 附件下载地址应该是固定的，但是现在不知道固定地址是多少。。
			var downloadUrl = epm.getRootPath() + materialguid;

			ejs.io.downloadFile({
				url : downloadUrl,
				fileName : materialname,
				success : function(result) {
				},
				error : function(error) {
				}
			});
		};

		function submit() {
			epointm.execute("submit", "mui-content", saveCallback);
		}

		function saveCallback(data) {
			Util.ejs.alert(data.msg);
		}

		function refresh() {
			epointm.refresh();
		}
	</script>
</body>

</html>