<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>下拉菜单选择控件</title>
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/control.css">
</head>

<body>
    <div class="control-form">
        <input type="hidden" id="DataField"/>
        <input type="hidden" id="DefaultValue"/>
        <input type="hidden" id="IsExtra"/>
        <input type="hidden" id="DataCtrl"/>
        <input type="hidden" id="fieldCreateFlag"/>
        
 		<ul class="form-field">
   			<li class="form-title">控件名称</li>
   			<li>
   			    <input type="text" id="DataFieldCn" class="form-control"></input>
   			</li>
 		</ul>
 		<ul id="fieldEn" style="display:none" class="form-field">
   			<li class="form-title">控件英文名称</li>
   			<li>
   			    <input type="text" id="DataFieldEn" class="form-control"></input>
   			</li>
 		</ul>
 		<ul class="form-field">
            <li class="form-title">自定义下拉子项值</li>
            <li>
                <input type="text" id="addItem" class="form-control"/> 
                <input type="button" style="font-size: 12px;" id="addRecord" width="100px" onclick="addRecord()" value="新增子项"/>
				<input type="button" style="font-size: 12px;" id="delRecord" width="100px" onclick="delRecord()" value="删除子项"/>
            </li>
            <li>
                <select id="items" multiple="multiple" style="margin-top: 5px;width: 100%; height: 100%"></select>
            </li>
        </ul>
        <!--ul class="form-field">
            <li class="form-title">宽度（px）</li>
            <li>
                <input type="text" id="Width" class="form-control">
            </li>
        </ul-->
        <ul class="form-field">
            <li class="form-title">下拉框高度（px）</li>
            <li>
                <input type="text" id="DivHeight" class="form-control">
            </li>
        </ul>
        <!--ul class="form-field">
            <li>
                <label for="EnableSearch" class="chk-control">
                    <input type="checkbox" id="EnableSearch">
                    <span>是否允许搜索</span>
                </label>
            </li>
        </ul>
        <ul class="form-field">
            <li>
                <label for="Conceal" class="chk-control">
                    <input type="checkbox" id="Conceal">
                    <span>是否隐藏</span>
                </label>
            </li>
        </ul-->
        <ul class="form-field">
   			<li class="form-title">控件提示信息</li>
   			<li>
   			    <input type="text" id="Message" class="form-control"></input>
   			</li>
 		</ul>
        <div id="validatepropertylst" class="form-field" style="float:left;width:100%">
        </div>
        <ul class="form-field">
   			<li class="form-title">分类选择</li>
   			<li>
 				<select id="CodeId" class="form-control"></select>
   			</li>
 		</ul>
 		<ul class="form-field">
   			<li class="form-title">栏目选择</li>
   			<li>
 				<select id="ItemId" class="form-control"></select>
   			</li>
 		</ul>
 		<ul class="form-field">
   			<li class="form-title">栏目顺序编号</li>
   			<li>
   			    <input type="text" id="ColumnOrderNum" class="form-control"></input>
   			</li>
 		</ul>
    </div>

    <script type="text/x-template" id="ctrl-templ">
        <input type="text" class="dropdowntextbox"
            title="{{title}}"
            value="{{title}}"
            id="{{id}}" 
            data-ctrl={{datactrl}}
            {{#divHeight}}
            divheight="{{divHeight}}"
            {{/divHeight}}
            {{#width}}
            width="100%"
            {{/width}}
            datafield="{{dataField}}"
            datafieldcn="{{dataFieldCn}}"
            style="{{style}}"
            dataoptions="{{dataoptions}}"
            defaultvalue="{{defaultvalue}}"
            isextra="{{isextra}}"
            message="{{message}}"
            validate="{{validate}}"
            CodeId="{{codeId}}"
            ItemId="{{itemId}}"
            ColumnOrderNum="{{columnOrderNum}}"/>
    </script>

    <script type="text/x-template" id="style-templ">
        {{#width}}width:100%;{{/width}}
    </script>
     <script type="text/javascript">
         var tableId = parent.tableId;
         var propertyUrl = '../formlistmanage/propertyinfoaction.action?cmd=pageLoad';
         var codeItemsUrl = '../formlistmanage/propertyinfoaction.action?cmd=getCodeItems';
         
         var itemsString = "";

         function addRecord() {
 			var addItem = document.getElementById("addItem").value;
 			if(addItem){
 				var m=0;
 				if(itemsString != null && itemsString != ""){
 					for(var n=0;itemsString.split(";").length>0 && n<itemsString.split(";").length; n++){
 	 					if(itemsString.split(";")[n] == addItem){
 	 						return;
 	 					}else{
 	 						m++;
 	 					}
 	 				}
 	 				if(m == itemsString.split(";").length){
 	 					var selObj = $("#items");
 	 	 				selObj.append("<option value='"+addItem+"'>" + addItem + "</option>");
 	 	 				itemsString += addItem +";";
 	 				}else{
	 					return;
 	 				}
 				}else{
 					var selObj = $("#items");
	 	 			selObj.append("<option value='"+addItem+"'>" + addItem + "</option>");
	 	 			itemsString += addItem +";";
 				}
 			}
 			document.getElementById("addItem").value="";
 		 }

 		 function delRecord() {
 			//删除选中下拉值，清空下拉值输入框
 			var selOpt = $("#items option:selected");
 			selOpt.remove();
 			document.getElementById("addItem").value="";
 			
 			//删除子项后重置下拉值
 			var opts =  $("#items option");
 			var delAfterStr = "";
 			for(var n=0; opts!=null && opts.length>0 && n<opts.length; n++){
 				delAfterStr += opts[n].innerHTML+";";
 			}
 			itemsString = delAfterStr;
 		 }
    </script>
    <script type="text/javascript" src="../js/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="../js/mustache.js"></script>
    <script type="text/javascript" src="../js/controls/control.js"></script>
    <script type="text/javascript" src="../js/controls/DropDownTextBox.js"></script>
</body>

</html>