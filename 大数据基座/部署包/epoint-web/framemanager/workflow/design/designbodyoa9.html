<!DOCTYPE html>
<html>

<head>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<link href="../css/workflowdesign.css" rel="stylesheet" />
<title>流程活动配置</title>
<script src="../../../frame/fui/js/cssboot.js"></script>
<style>
	.batch-panel {
		height: auto !important;
		padding: 0px;
		bottom: 0; 
	}
	.batch-panel .mini-panel-border {
		height: 100%;
	}
	.batch-panel .mini-panel-viewport {
		height: calc(100% - 42px);
	}
	.batch-panel .mini-panel-body {
		box-sizing: border-box;
	}
	.mini-buttonedit-buttons, .mini-buttonedit-height .mini-buttonedit-buttons {background: #fff;}
	
</style>	
</head>

<body>
	<!-- 必须有，加载时的loading效果 -->
	<div class="page-loading"></div>
	<!-- 内容区域 -->
	<div class="fui-content">
		<div id="ie5menu" class="ContextMenu">
			<ul>
				<li class="ContextMenuLi" id="addManualTemplete"><img
					src="../image/ManuralTemplete.jpg" /><span>新建人工活动模版</span></li>
				<li class="ContextMenuLi" id="addManual"><img
					src="../image/ManualNewVml.jpg" /><span>新建人工活动</span></li>
				<li class="ContextMenuLi" id="addSubProcess"><img
					src="../image/SubProcessNewVml.jpg" /><span>新建子流程</span></li>
				<li class="ContextMenuLi" id="addRouter"><img
					src="../image/RouterNewVml.jpg" /><span>新建路由活动</span></li>
				<li class="ContextMenuLi" id="addExternal"><img
					src="../image/External.jpg" /><span>新建外部活动</span></li>
				<li class="ContextMenuLi" id="OpenActivitySort"><img
					src="../image/UnFixButton_Down.jpg" /><span>表格式查看</span></li>
			</ul>
		</div>


		<div id="ie5menu1" class="ContextMenu" style="width: 120px;">
			<ul>
				<li id="OpenEdit"><img src="../image/contextmenu/add_step.gif" /><span>设置属性</span>
				</li>
				<li id="Del"><img src="../image/contextmenu/del_obj.gif" /><span>删
						除</span></li>
				<!--             <li> -->
				<!--                 <img src="#{request.contextPath}/frame/epointworkflow/image/contextmenu/exit1.gif" width="24" /><span>取消</span> -->
				<!--             </li> -->
			</ul>
		</div>
		<div id="WorkFlowWrapperBg"
			style="background-image: url(../image/bg.png); overflow: auto; width: 100%; height: 100%; position: relative;">
			<div id="WorkFlowWrapper"></div>
			<div id="batch-panel" class="mini-panel batch-panel" buttons="close"
				title="流程批处理"
				style="position: fixed; top: 41px; right: 0; width: 550px; height: 100%; display: none;">
				<div class="config-content" style="height: 90%; overflow: auto;height: calc(100% - 50px)">
					<div class="fui-block" id="workflow_batch_base"
						style="display: none;">
						<div class="fui-block-hd">基本信息</div>
						<div class="fui-block-bd">
							<div class="fui-form">
								<div role="form">
									<div role="row" id="workflow_batch_base_attach"
										class="workflow-control" style="display: none">
										<div role="control" label="附件操作权限">
											<input class="mini-checkbox" text=" 允许修改"
												bind="dataBean.allowEdit" /> <input class="mini-checkbox"
												text=" 允许删除" bind="dataBean.allowDelete" />
										</div>
									</div>
									<div role="row" class="workflow-control"
										id="workflow_batch_base_handleurl" style="display: none">
										<div role="control" label="流程处理页面">
											<input class="mini-buttonedit" emptyText="" id="handleurl"
												onbuttonclick="setPage" selectOnFocus="true"
												bind="dataBean.handleUrl" />
										</div>
									</div>
									<div role="row" id="workflow_batch_base_sms"
										class="workflow-control" style="display: none">
										<div role="control" label="短信通知内容">
											<input id="smsContent" class="mini-textarea"
												bind="dataBean.smsContent" style="width: 90%" /> <a
												class="action-icon icon-mail" onclick="setSMS();"
												style="width: 10%"></a>
										</div>
									</div>
									<div role="row" id="workflow_batch_base_pass"
										class="workflow-control" style="display: none">
										<div role="control" label="通过率">
											<input vtype="range:0,100" class="mini-textbox" width="50%"
												bind="dataBean.passRate" /> 单位：%
										</div>
									</div>
									<div role="row" id="workflow_batch_base_lock"
										class="workflow-control" style="display: none">
										<div role="control" label="多人处理是否锁定">
											<div action="getYesNoList" class="mini-radiobuttonlist" textField="text" onvaluechanged="selectChange(this.value)"
												bind="dataBean.isLockWhenMulti" valueField="id"></div>
										</div>
									</div>
									<div role="row" id="lockTime" style="display: none"
										class="workflow-control">
										<div role="control" label="锁定时间">
											<input style="width: 120px;" value="1" vtype="int;min:1"
												bind="dataBean.lockTime" class="mini-textbox" />分钟(输入大于等于1的正整数),如果此项值维护了默认走多人手写签批锁定控制；不维护默认原来的锁定逻辑
										</div>
									</div>
									<div role="row" id="workflow_batch_base_multiTransactorMode"
										class="workflow-control" style="display: none">
										<div role="control" label="多人处理方式">
											<div action="activitymanualbaseinfoaction.getHandleTypeList"  class="mini-radiobuttonlist" textField="text" repeatItems="3"
												bind="dataBean.multiTransactorMode" valueField="id" repeatDirection="vertical"></div>
										</div>
									</div>
									<div role="row" id="workflow_batch_base_singleInstance"
										class="workflow-control" style="display: none">
										<div role="control" label="共用同一活动实例">
											<div class="mini-checkbox"  bind="dataBean.singleInstance" ></div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="fui-block" id="workflow_batch_operation"
						style="display: none;">
						<div class="fui-block-hd">操作按钮</div>
						<div class="fui-block-bd">
							<div class="fui-form">
								<div role="form">
									<div role="row"
										id="workflow_batch_operation_operationcommonpageurl"
										class="workflow-control" style="display: none;">
										<div role="control" label="是否显示操作处理页面">
											<input class="mini-checkbox" text="显示"
												onvaluechanged="operationChanged(this.value)"
												bind="dataBean.showOperationPage" />
										</div>
									</div>

									<div role="row" id="trOperationCommonPageUrl"
										class="workflow-control" style="display: none;">
										<div role="control" label="操作处理页面">
											<input id="urlPage" class="mini-textbox" emptyText=""
												selectOnFocus="true" bind="dataBean.operationCommonPageUrl" />
										</div>
									</div>
									<div role="row" id="trOperationMobilePageUrl"
										class="workflow-control" style="display: none;">
										<div role="control" label="移动端操作处理页面">
											<input id="urlMobilePage" class="mini-textbox"
												bind="dataBean.mobileOperationCommonPageUrl" />
										</div>
									</div>
									<div role="row"
										id="workflow_batch_operation_showopiniontemplete"
										class="workflow-control" style="display: none;">
										<div role="control" label="是否显示意见模板">
											<input class="mini-checkbox" text=" 显示"
												bind="dataBean.showOpinionTemplete" />
										</div>
									</div>
									<div role="row"
										id="workflow_batch_operation_checkmaterialsubmit"
										class="workflow-control" style="display: none;">
										<div role="control" label="检查必须材料">
											<input class="mini-checkbox" text=" 检查"
												bind="dataBean.isCheckMaterial" />
										</div>
									</div>
									<div role="row" id="workflow_batch_operation_shownextactivity"
										class="workflow-control" style="display: none;">
										<div role="control" label="是否显示后继活动">
											<input class="mini-checkbox" text=" 显示"
												bind="dataBean.showNextActivity" />
										</div>
									</div>
									<div role="row" id="workflow_batch_operation_opionneeded"
										class="workflow-control" style="display: none;">
										<div role="control" label="必须输入意见">
											<div class="mini-radiobuttonlist" repeatItems="2" value="10"
												textField="text" valueField="id"
												bind="dataBean.isRequireOpinion"
												data="[{text:'是',id:'10'},{text:'否',id:'20'}]"></div>
										</div>
									</div>
									<div role="row" id="workflow_batch_operation_occasion"
										class="workflow-control" style="display: none;">
										<div role="control" label="显示场合">
											<div checked="true" id="chkIs_ShowWhenNormal"
												bind="dataBean.showWhenNorma" class="mini-checkbox">正常办理时</div>
											<div id="chkIs_ShowWhenRollBack" checked="true"
												bind="dataBean.showWhenRollBack" class="mini-checkbox">退回时</div>
										</div>
									</div>
								</div>
							</div>

						</div>
					</div>
					<div class="fui-block" id="workflow_batch_mobile"
						style="display: none;">
						<div class="fui-block-hd">移动端配置</div>
						<div class="fui-block-bd">
							<div class="fui-form">
								<div role="form">
									<div role="row" id="workflow_batch_mobile_mobilemethod"
										class="workflow-control" style="display: none;">
										<div role="control" label="移动端处理方式">
											<div class="mini-radiobuttonlist" repeatItems="2"
												textField="text" valueField="id"
												bind="dataBean.mobileHandleType"
												data="[{text:'none',id:'none'},{text:'view',id:'view'},{text:'app',id:'app'},{text:'html5',id:'html5'},{text:'自定义',id:'自定义'}]"></div>
										</div>
									</div>
									<div role="row" id="workflow_batch_mobile_mobilepageurl"
										class="workflow-control" style="display: none;">
										<div role="control" label="移动端流程处理页">
											<input id="mobileHandleURL" bind="dataBean.mobileHandleURL"
												class="mini-buttonedit" onbuttonclick="setMobilePage"
												selectOnFocus="true" />
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="fui-block" id="workflow_batch_material"
						style="display: none;">
						<div class="fui-block-hd">材料</div>
						<div class="fui-block-bd">
							<div class="fui-form">
								<div role="form">
									<div role="row" id="workflow_batch_material_material"
										class="workflow-control" style="display: none;">
										<div role="control" label="选择材料">
											<div action="getMaterial" class="mini-combobox"  bind="dataBean.material"
												showNullItem="false" emptyText="请选择材料..." showClose="true" id="material"
												oncloseclick="onCloseMaterialClick" textField="" valueField=""
												multiSelect="true" width="200" />
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="fui-toolbar-bottom left">
					<a class="mini-button" state="primary" iconCls="icon-addcircle" onclick="openBatchSetting">调整配置</a>
					<input id="activityList" class="mini-combobox" showNullItem="false"
						emptyText="请选择处理范围..." showClose="true" action="getActivityList"
						oncloseclick="onCloseClick" textField="" valueField=""
						multiSelect="true" width="200"/> <a class="mini-button"
						iconCls="icon-refresh" state="primary" ghost="true"
						style="margin-left: 30px;" onclick="saveBatch">开始批处理</a>
				</div>
			</div>
		</div>
		<div id="toolBar2">
			<div class="toolbar-menu clickable" id="save"
				style="padding-right: 0px; font-size: 15px; width: 15px; height: 15px;">
				<img title="保存" src="../image/save.png" />
			</div>
			<div class="toolbar-menu clickable" id="image"
				style="padding-right: 0px; font-size: 15px; width: 15px; height: 15px;">
				<img title=" 图片" src="../image/picture.png" />
			</div>
			<div class="toolbar-menu" id="Div1"
				style="padding-right: 0px; padding-left: 0px; font-size: 15px; width: 2px; height: 15px;">
				<img title="" src="../image/dividingline.png" />
			</div>
			<div class="toolbar-menu clickable" id="alignLeft"
				style="padding-right: 0px; font-size: 15px; width: 15px; height: 15px;">
				<img title="左部对齐" src="../image/justifyleft.png" />
			</div>
			<div class="toolbar-menu clickable" id="alignTop"
				style="padding-right: 0px; font-size: 15px; width: 15px; height: 15px;">
				<img title="上部对齐" src="../image/justifytop.png" />
			</div>
			<div class="toolbar-menu clickable" id="alignGrid"
				style="padding-right: 0px; font-size: 15px; width: 15px; height: 15px;">
				<img title=" 网格对齐" src="../image/justifygrid.png" />
			</div>
			<div class="toolbar-menu" id="Div2"
				style="padding-right: 0px; padding-left: 0px; font-size: 15px; width: 2px; height: 15px;">
				<img title="" src="../image/dividingline.png" />
			</div>
			<div class="toolbar-menu clickable" id="transform"
				style="padding-right: 0px; font-size: 15px; width: 15px; height: 15px;">
				<img title=" Y方向" src="../image/Y.png" />
			</div>
			<div class="toolbar-menu clickable" id="Typesetting"
				style="padding-left: 0px; font-size: 15px; width: 15px; height: 15px;">
				<img title=" 排版" src="../image/typeset.png" />
			</div>
			<div class="toolbar-menu clickable" id="MoveRight"
				style="padding-left: 0px; font-size: 15px; width: 15px; height: 15px;">
				<img title=" 右移" src="../image/moveright.png" />
			</div>
			<div class="toolbar-menu clickable" id="MoveDown"
				style="padding-left: 0px; font-size: 15px; width: 15px; height: 15px;">
				<img title=" 下移" src="../image/movedown.png" />
			</div>
			<div class="toolbar-menu" id="Div3"
				style="padding-right: 0px; padding-left: 0px; font-size: 15px; width: 2px; height: 15px;">
				<img title="" src="../image/dividingline.png" />
			</div>
			<div class="toolbar-menu clickable" id="materail"
				style="padding-right: 0px; font-size: 15px; width: 15px; height: 15px;">
				<img title="流程材料" src="../image/materail.png" />
			</div>
			<div class="toolbar-menu clickable" id="context"
				style="padding-right: 0px; font-size: 15px; width: 15px; height: 15px;">
				<img title="相关数据" src="../image/context.png" />
			</div>
			<div class="toolbar-menu clickable" id="method"
				style="padding-right: 0px; font-size: 15px; width: 15px; height: 15px;">
				<img title="方法管理" src="../image/method.png" />
			</div>

			<div class="toolbar-menu clickable" id="sort"
				style="padding-right: 0px; font-size: 15px; width: 15px; height: 15px;">
				<img title="活动排序" src="../image/order.png" />
			</div>
			<div class="toolbar-menu clickable" id="batch"
				style="padding-right: 0px; font-size: 15px; width: 15px; height: 15px;">
				<img title="流程批处理" src="../image/batch.png" />
			</div>
			<!-- 			<div class="toolbar-menu clickable" id="print" -->
			<!-- 				style="padding-right: 0px; font-size: 15px; width: 15px; height: 15px;"> -->
			<!-- 				<img title=" 打印" src="../image/print.png" /> -->
			<!-- 			</div> -->
		</div>
		<div id="toolBar">
			<div class="toolbar-menu selectable" id="pointer">
				<img title="指针" src="../image/Cusor.jpg" width="30" height="30" />
			</div>
			<div class="toolbar-menu state" id="ManualTemplete"
				type="ManualTemplete">
				<img title="人工活动配置模版" src="../image/ManuralTemplete.jpg" width="30"
					height="30" />
			</div>
			<div class="toolbar-menu state" type="Manual">
				<img title="人工活动" src="../image/RghdNew.jpg" width="30" height="30" />
			</div>
			<!--<div class="toolbar-menu state" type="JoinSign">
				<img title="会签活动" src="../image/JoinSign.jpg"
					width="30" height="30" />
			</div>
			<div class="toolbar-menu state" type="PassSign">
				<img title="传签活动" src="../image/PassSign.jpg"
					width="30" height="30" />
			</div>-->
			<div class="toolbar-menu state" type="SubProcess">
				<img title="子流程活动" src="../image/ZlchdNew.jpg" width="30"
					height="30" />
			</div>

			<!--<div class="toolbar-menu state" type="Suspension">
				<img title="悬挂待批" src="../image/Suspension.jpg"
					width="30" height="30" />
			</div>-->

			<!--         <div class="toolbar-menu state" type="out"> -->
			<!--             <img title="外部流程活动" src="../image/extend.png" width="30" height="30" /> -->
			<!--         </div> -->
			<!--         <div class="toolbar-menu state" type="inside"> -->
			<!--             <img title="自定义流程活动" src="../image/diyactivity.png" width="30" height="30" /> -->
			<!--         </div> -->

			<div class="toolbar-menu state" type="Router">
				<img title="路由活动" src="../image/LyhdNew.jpg" width="30" height="30" />
			</div>
			<div class="toolbar-menu state" type="Browser">
				<img title="浏览活动" src="../image/BrowserNewVml.jpg" width="30"
					height="30" />
			</div>
			<div class="toolbar-menu state" type="External">
				<img title="外部活动" src="../image/External.jpg" width="30" height="30" />
			</div>
			<div class="toolbar-menu selectable" id="path">
				<img title="活动变迁" src="../image/Draw.jpg" width="30" height="30" />
			</div>
			<div id="DvelopmentTarget"></div>
		</div>
	</div>


	<script src="../../../rest/resource/jsboot"></script>
	<script>
		SrcBoot.output([ 'framemanager/workflow/js/raphael-min.js',
				'framemanager/workflow/js/graffle.js',
				'framemanager/workflow/js/workflowdesign_new.js',
				'framemanager/workflow/js/jquery.contextmenu.r2.js',
				'framemanager/workflow/js/flowshow.js' ]);
	</script>
	<script>
		//<![CDATA[
		//初始化请求
		epoint.initPage('designbodyoa9action', '', initCallBack);
		var ProcessVersionGuid = Util._getUrlParams(
				Util.getSafeLocation().href, 'processVersionGuid');
		var MainPVActivityGuid = Util._getUrlParams(
				Util.getSafeLocation().href, 'mainPVActivityGuid');
		var TempleteACTGuid = "";
		var param;
		// 初始化操作的回调
		function initCallBack(data) {
			 if (data.activityListValue) {
				mini.get('activityList').setValue(data.activityListValue)
			} 
			
			if (data.tempactivitys && data.tempactivitynames) {
				var tempacts = data.tempactivitys.split(";");
				var tempactnames = data.tempactivitynames.split(";");
				
				//获取div  
		        var parentDiv = document.getElementById("DvelopmentTarget");
				//获取DvelopmentTarget下的div元素
				var childs = parentDiv.getElementsByTagName('div');
				var tempactsId;
				for (var i = 0; i < childs.length; i++) {
					tempactsId += childs[i].id + ";";
				}

				for (var n = 0; n < tempacts.length; n++) {
					//获取div  
					var div = document.getElementById("DvelopmentTarget");

					//换行  
					var div2 = document.createElement("div");
					div2.setAttribute('class', 'toolbar-menu state ui-draggable ui-draggable-handle');
					div2
							.setAttribute('type', 'ManualByTemplete_'
									+ tempacts[n]);
					div2.setAttribute('id', 'template_' + tempacts[n]);
					// 如果已经存在相同的id，则不去拼接活动模板
					if (tempactsId != null
							&& tempactsId.indexOf('template_' + tempacts[n]) > -1) {
						continue;
					}
					div.appendChild(div2);

					//换行  
					var img = document.createElement("img");
					img.setAttribute('title', tempactnames[n]);
					img.setAttribute('src', '../image/CommonTemplete.jpg');
					img.setAttribute('width', '30');
					img.setAttribute('height', '30');
					div2.appendChild(img);
				}
			}

			// 处理批量配置的显隐
			if (data.batchOperations) {
				// 首先把所有的都隐藏掉
				$.each($('.fui-block'), function(i, opt) {
					$.each($(opt).find('.workflow-control'), function(j, ctr) {
						$(ctr).hide();
					});
					$(opt).hide();
				});
				if (data.batchOperations.length > 0) {
					$.each(data.batchOperations, function(i, opt) {
						// 如果有值的话，要把对应的配置项显示出来
						if (opt.value && opt.value != '') {
							$("#" + opt.key).show();
							$.each(opt.value.split(','), function(i, value) {
								$("#" + opt.key + "_" + value).show();
							});
						}
					});
				}
			}
		}

		function callBack(data) {
			//epoint.execute('designbodyoa9action.readXmlJson', 'fui-form',callBack);
		}

		function deleteNode(a, b) {
			epoint.execute('designbodyoa9action.deleteNode', '', [ a, b ],
					delback);
		}

		function delback(data) {
			if (data) {
				AfterDel(data.msg, data.mes);
			}
		}

		function workcheckIsCanAddHDBQ(a, b, c) {
			epoint.execute('designbodyoa9action.checkIsCanAddHDBQ', '', [ a, b,
					c ]);
		}

		function ReadXML2() {
			epoint.execute('designbodyoa9action.readXmlJson', '', '', TypeSet);
		}

		function workSaveXml(a) {
			epoint.execute('designbodyoa9action.saveXml', '', [ epoint
					.encodeUtf(a) ], function(b) {
				epoint.alert('保存成功！', '', null, 'success');
			});
		}

		function dialogvalueset(par) {
			param = par;
		}

		//通用的ajax方法返回结果处理
		function AjaxOperationHd(args) {
			var value = args.msg;
			if (value == "DrawLine") {
				afterDrawLine();
				location.reload(false);
			} else {
				epoint.alert(value, '', null, 'info');
			}
		}

		$(document).ready(function() {
			$("#WorkFlowWrapperBg").css({
				width : $('.fui-content').width() - 44,
				height : $('.fui-content').height() - 41,
				marginLeft : 44,
				marginTop : 41
			});
			epoint.execute('designbodyoa9action.readXmlJson', '', ReadXMLHd);
			$('body').bind('contextmenu', function() {
				return false;
			});
			$(document).click(function(e) {
				if (e.which != 3) {
					$("#ie5menu").hide();
					$("#ie5menu1").hide();
				}
			});
			$(".ContextMenu").find("li").hover(function() {
				$(this).css("background-color", "#B6BDD2");
			}, function() {
				$(this).css("background-color", "");
			});
		});

		//多人处理锁定切换，填写锁定时间控件显隐控制
		function selectChange(value) {
			if (value == "true") {
				$("#lockTime").show();
			} else {
				$("#lockTime").hide();
			}
		}

		//设置短信
		function setSMS() {
			var sms = "您收到了一项标题为“[#=工作项名称#]”的待办事宜，请及时办理。";
			mini.get('smsContent').setValue(sms);
		}

		function onCloseClick() {
			mini.get('activityList').setValue('');
			mini.get('activityList').setText('');
		}
		
		function onCloseMaterialClick(){
			mini.get('material').setValue('');
			mini.get('material').setText('');
		}

		function saveBatch() {
			var activities = mini.get('activityList').getValue();
			if (activities == '') {
				epoint.alert("未选择处理活动范围!","", "", "warning");
			} else {
				mini.confirm("批处理会覆盖所选活动的已有配置，执行后无法撤回，请谨慎操作！", "提示", function(
						action) {
					if (action == "ok") {
						// 找到需要提交的控件id
						var scope = new Array();
						$.each($('.fui-block'), function(i, opt) {
							if (!($(opt).is(":hidden"))) {
								$.each($(opt).find('.workflow-control'),
										function(j, ctr) {
											console.log(ctr)
											if (!($(ctr).is(":hidden"))) {
												scope.push(ctr.id);
											}
										});
							}
						});

						epoint.execute('saveBatch', scope, activities, function(data) {
							if (data.msg) {
								epoint.alert(data.msg);
							}
						}, false);
					}
				});
			}
		}

		//调整页面
		function openBatchSetting() {
			epoint.openDialog('调整配置',
					"framemanager/workflow/design/batchsetting?processVersionGuid="
							+ ProcessVersionGuid, function(param) {
						if (param != 'close') {
							epoint.alert("保存成功", null, null, 'success');
							epoint.refresh();
						}
					}, {
						'width' : 500,
						'height' : 800
					});
		}

		//显示操作页面
		function operationChanged(value) {
			if (value == "true") {
				$("#trOperationMobilePageUrl").show();
				$("#trOperationCommonPageUrl").show();

			} else {
				$("#trOperationMobilePageUrl").hide();
				$("#trOperationCommonPageUrl").hide();
			}
		}

		//选择流程处理页面
		function setPage(e) {
			epoint
					.openDialog(
							'选择流程处理页面',
							'framemanager/workflow/design/designhelper?mode=activityPage&type=showWorkItem',
							setParValueOperJS, {
								'width' : 800,
								'height' : 400
							});
		}

		function setParValueOperJS(rtnValue) {
			if (rtnValue && rtnValue != 'close') {
				var s = rtnValue.split(";")[0];
				mini.get("handleurl").setText(s);
				mini.get("handleurl").setValue(s);
			}
		}

		//移动流程处理页面
		function setMobilePage() {
			epoint
					.openDialog(
							'选择流程处理页面',
							'framemanager/workflow/design/designhelper?mode=activityPage&type=showMobilePage',
							setParValueOperJSMobile, {
								'width' : 800,
								'height' : 400
							});

		}

		function setParValueOperJSMobile(rtnValue) {
			if (rtnValue && rtnValue != 'close') {
				var s = rtnValue.split(";")[0];
				mini.get("mobileHandleURL").setValue(s);
				mini.get("mobileHandleURL").setText(s);
			}
		}

		//]]>
	</script>

</body>

</html>