<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<title>新增操作按钮</title>
<script src="../../../frame/fui/js/cssboot.js"></script>
<style type="text/css">
p {
	margin-left: 16px;
	margin-right: 16px;
}
</style>
</head>

<body>
	<!-- 必须有，加载时的loading效果 -->
	<div class="page-loading"></div>

	<!-- toolbar区域 -->
	<div class="fui-toolbar">
		<a class="mini-button" state="primary" id="addNew"
			onclick="saveAndNew">确定新增</a> <a class="mini-button"
			onclick="epoint.closeDialog">取消添加</a>
		<!--帮助按钮 -->
		<a role="helper" class="mr10" showtype="tooltip">使用过程中需注意的信息</a>
	</div>

	<!-- 帮助信息区域 默认隐藏-->
	<div class="fui-notice hidden">
		<p>备注：内容会作为按钮的Title，也就是光标放在按钮上浮现的文字</p>
	</div>

	<!-- 内容区域 -->
	<div class="fui-content">
		<div id="fui-form" class="fui-form">
			<div role="row">
				<div role="control" label="操作名称" starred="true">
					<input id="operateName" class="mini-textbox"
						bind="workflowActivityOperation.operationName" required="true"
						requiredErrorText="操作名称不能为空!" />
				</div>
			</div>
			<div role="row">
				<div role="control" label="操作类型" starred="true">
					<input id="opType" bind="workflowActivityOperation.operationType"
						data="[{text:'签收',id:'8'},
							{text:'转缓办',id:'7'},
							{text:'通过',id:'10'},
							{text:'阅读',id:'18'},
							{text:'转交',id:'20'},
							{text:'送阅读',id:'25'},
							{text:'回退',id:'30'},
							{text:'退回到开始',id:'2'},
							{text:'结束当前工作项',id:'40'},
							{text:'终止流程实例',id:'45'},
							{text:'收回',id:'50'},
							{text:'保存',id:'60'},
							{text:'特殊操作',id:'70'},
							{text:'自定义（For待办工作项）',id:'0'},
							{text:'自定义（For已办工作项）',id:'1'},
							{text:'空白占位符',id:'999'},
							{text:'自定义（For流程设计）',id:'80'}]"
						textField="text" valueField="id" class="mini-combobox"
						onvaluechanged="selectConditionChange(this.value)" required="true"
						requiredErrorText="操作类型不能为空!" />
				</div>
			</div>
			<div role="row" id="buildingJsActivity"
				class="buildingJsActivity hidden">
				<div role="control" label="按钮触发前">
					<input class="mini-textbox"
						bind="workflowActivityOperation.operationDispName" />
				</div>
				<div role="control" label="按钮触发后">
					<input class="mini-textbox"
						bind="workflowActivityOperation.operationPageUrl" />
				</div>
			</div>
			<!-- 回退目标活动范围-->
			<div role="row" class="trBackTargetActivity hidden"
				id="trBackTargetActivity">
				<div role="control" label="回退目标活动范围">
					<input id="chkBackTargetActivity" bind="backTargetActivity"
						action="getBackTargetActivityList" textField="text"
						valueField="id" class="mini-checkboxlist" style="width: 100%" />
				</div>
				<div role="control" label="目标活动处理人">
					<div bind="rdoBackScope" class="mini-radiobuttonlist"
						repeatItems="2" value="10" textField="text" valueField="id"
						data="[{text:'仅提交人',id:'1'},
							{text:'所有处理人',id:'2'}]">
					</div>
				</div>
			</div>
			<!-- 送阅读目标活动范围 -->
			<div role="row" class="trSendToSignTargetActivity hidden"
				id="trSendToSignTargetActivity">
				<div role="control" label="送阅读目标活动范围">
					<input id="chkSendToSignTargetActivity"
						bind="sendToSignTargetActivity"
						action="getSendToSignTargetActivityList" textField="text"
						valueField="id" class="mini-checkboxlist" style="width: 100%" />
				</div>
			</div>
			<!-- 退回到开始目标活动范围 -->
			<div role="row" class="trBackToStartTargetActivity hidden"
				id="trBackToStartTargetActivity">
				<div role="control" label="目标活动范围">
					<input id="chkBackToMain" bind="backToMain" class="mini-checkbox"
						style="width: 2%" />子流程是否退回至主流程
				</div>
			</div>
			<div role="row" class="trMultiTransctorMode hidden"
				id="trMultiTransctorMode">
				<div role="control" label=" 多人处理方式">
					<div id="multiTransactorMode"
						bind="workflowActivityOperation.multiTransctorMode"
						action="getHandleTypeList" class="mini-radiobuttonlist"
						repeatItems="2" repeatLayout="table" repeatDirection="vertical"
						textField="text" valueField="id"></div>
				</div>
			</div>
			<div role="row" class="trCustomScript hidden" id="trCustomScript">
				<div role="control" label="点击按钮后执行的Js脚本">
					<input id="jstext" bind="operationPageUrl" class="mini-buttonedit"
						emptyText="" onbuttonclick="setParValue" selectOnFocus="true" />
				</div>
			</div>
			<div role="row" class="trIs_ShowOperationPage hidden"
				id="trIs_ShowOperationPage">
				<div role="control" label="是否显示操作处理页面">
					<div bind="workflowActivityOperation.is_ShowOperationPage"
						onvaluechanged="operationChanged" id="is_ShowOperationPage"
						checked="true" class="mini-checkbox">显示</div>
				</div>
			</div>
			<div role="row" class="trOperationCommonPageUrl hidden"
				id="trOperationCommonPageUrl">
				<div role="control" label="操作处理页面">
					<input id="urlPage" class="mini-buttonedit"
						bind="workflowActivityOperation.operationCommonPageUrl"
						emptyText="" onbuttonclick="setPage" selectOnFocus="true" />
				</div>
			</div>
			<div role="row" class="trOperationMobilePageUrl hidden"
				id="trOperationMobilePageUrl">
				<div role="control" label="移动端操作处理页面">
					<input id="urlMobilePage" class="mini-textbox"
						bind="workflowActivityOperation.mobileOperationCommonPageUrl" />
				</div>
			</div>
			<div role="row" class="trIs_ShowOpinionTemplete hidden"
				id="trIs_ShowOpinionTemplete">
				<div role="control" label="是否显示意见模板">
					<div bind="workflowActivityOperation.is_ShowOpinionTemplete"
						checked="true" class="mini-checkbox">显示</div>
				</div>
			</div>
			<div role="row" class="trIs_ShowNextActivity hidden"
				id="trIs_ShowNextActivity">
				<div role="control" label="是否显示后继活动">
					<div bind="workflowActivityOperation.is_ShowNextActivity"
						checked="true" class="mini-checkbox">显示</div>
				</div>
			</div>
			<div role="row" class="trIs_CheckMaterialSubmit hidden"
				id="trIs_CheckMaterialSubmit">
				<div role="control" label="检查必需材料">
					<div bind="isCheckMaterial" checked="true" class="mini-checkbox">检查</div>
				</div>
			</div>
			<div role="row" id="trDefaultOpion">
				<div role="control" label="默认处理意见">
					<input class="mini-textarea"
						bind="workflowActivityOperation.defaultOpinion" />
				</div>
			</div>
			<div role="row" id="trOpionNeeded">
				<div role="control" label="必须输入意见">
					<div bind="workflowActivityOperation.isRequireOpinion"
						class="mini-radiobuttonlist" repeatItems="2" value="10"
						textField="text" valueField="id"
						data="[{text:'是',id:'10'},
							{text:'否',id:'20'}]"></div>
				</div>
			</div>
			<div role="row" class="trMethodBeforeOperate hidden"
				id="trMethodBeforeOperate">
				<div role="control" label="操作前调用的方法">
					<input id="mgbefore" class="mini-buttonedit" emptyText=""
						onbuttonclick="selMethodBeforeOperate" selectOnFocus="true" />
					<!-- 隐藏域 -->
					<input id="mgBeforeHide" class="mini-hidden"
						bind="workflowActivityOperation.methodGuidBeforeOperate" />
				</div>
			</div>
			<div role="row" class="trMethodAfterOperate hidden"
				id="trMethodAfterOperate">
				<div role="control" label="操作后调用的方法">
					<input id="mgAfter" class="mini-buttonedit" emptyText=""
						onbuttonclick="selMethodAfterOperate" selectOnFocus="true" />
					<!-- 隐藏域 -->
					<input id="mgAfterHide" class="mini-hidden"
						bind="workflowActivityOperation.methodGuidAfterOperate" />
				</div>
			</div>
			<div role="row" style="display: none">
				<div role="control" label="完成后父页面重定向地址">
					<input class="mini-textbox" id="openerPageUrlAfterOperate"
						bind="workflowActivityOperation.openerPageUrlAfterOperate" />
				</div>
			</div>
			<div role="row" class="trShiftTransactor hidden"
				id="trShiftTransactor">
				<div role="control" label="转交处理人设置">
					<div class="btn-group mr10">
						<a class="mini-button" id="shiftTransactor"
							onclick="openShiftTransactor" iconCls="icon-gear">设置处理人</a>
					</div>
				</div>
			</div>
			<div role="row" class="trIs_ShowOpinion hidden" id="trIs_ShowOpinion">
				<div role="control" label="收回是否保留办理意见">
					<div bind="workflowActivityOperation.inputInfo" checked="true"
						class="mini-checkbox">保留</div>
				</div>
			</div>
			<div role="row" class="trSpanWidth hidden" id="trSpanWidth">
				<div role="control" label="空白宽度">
					<input class="mini-textbox"
						bind="workflowActivityOperation.spanWidth" style="width: 80px" />
				</div>
			</div>
			<div role="row">
				<div role="control" label="排序">
					<input id="orderNumber" class="mini-textbox"
						bind="workflowActivityOperation.orderNumber"
						vtype="int;range:0,99999999" required="true"
						requiredErrorText="排序码不能为空!" />
				</div>
			</div>
			<div role="row" id="trNode" height="60">
				<div role="control" label="备注">
					<input class="mini-textarea" bind="workflowActivityOperation.note" />
				</div>
			</div>
			<div role="row" id="occasion">
				<div role="control" label="显示场合">
					<div bind="chkIs_ShowWhenNormal" checked="true"
						class="mini-checkbox">正常办理时</div>
					<div bind="chkIs_ShowWhenRollBack" checked="true"
						class="mini-checkbox">退回时</div>
				</div>
			</div>
			<div role="row">
				<div role="control" label="用来控制显示的方法">
					<input id="txtMethodName" class="mini-buttonedit" emptyText=""
						bind="txtMethodName" onbuttonclick="selEventMethod"
						selectOnFocus="true" />
				</div>
			</div>
			<div role="row" style="display: none">
				<div role="control">
					<input id="hidMethodGuid" class="mini-textbox"
						bind="workflowActivityOperation.controlVisiableMethodGuid" />
				</div>
			</div>
		</div>
	</div>

	<input bind="processVersionGuid" id="processVersionGuid"
		class="mini-hidden" />
	<input id="hidOperationGuid" class="mini-hidden"
		bind="workflowActivityOperation.operationGuid" />

	<script src="../../../rest/resource/jsboot"></script>
	<script>
		//<![CDATA[ 
		// 初始化页面
		epoint.initPage('activitymanualoperationaddaction', '', function(data) {
			var type = mini.get('opType').getValue();
			selectConditionChange(type);
			operationPageCheck();
		});
		function saveAndNew() {
			if ((mini.get("txtMethodName").getValue() == "")
					|| (mini.get("txtMethodName").getValue() == null)) {
				mini.get("hidMethodGuid").setValue("");
			}
			if (epoint.validate()) {
				var e = mini.get('opType').getValue();
				var scope = getScope(e);
				epoint.execute('addOperation', scope, closeCallback);
			}
		}

		// 关闭操作的回调
		function closeCallback(data) {
			if (data.msg) {
				epoint.closeDialog(data.msg);
			}
		}

		function showConditions() {
			//按钮触发前/按钮触发后
			$('.buildingJsActivity').addClass('hidden');
			//回退目标活动范围
			$('.trBackTargetActivity').addClass('hidden');
			//送阅读目标活动范围
			$('.trSendToSignTargetActivity').addClass('hidden');
			//退回到开始目标活动范围
			$('.trBackToStartTargetActivity').addClass('hidden');
			//多人处理方式
			$('.trMultiTransctorMode').addClass('hidden');
			//点击按钮后执行的Js脚本
			$('.trCustomScript').addClass('hidden');
			//是否显示操作处理页面
			$('.trIs_ShowOperationPage').addClass('hidden');
			//操作处理页面
			$('.trOperationCommonPageUrl').addClass('hidden');
			//移动端操作处理页面
			$('.trOperationMobilePageUrl').addClass('hidden');
			//是否显示后继活动
			$('.trIs_ShowNextActivity').addClass('hidden');
			//是否显示意见模板
			$('.trIs_ShowOpinionTemplete').addClass('hidden');
			//检查必需材料
			$('.trIs_CheckMaterialSubmit').addClass('hidden');
			//操作前调用的方法
			$('.trMethodBeforeOperate').addClass('hidden');
			//操作后调用的方法
			$('.trMethodAfterOperate').addClass('hidden');
			//空白宽度
			$('.trSpanWidth').addClass('hidden');
			//收回是否保留办理意见
			$('.trIs_ShowOpinion').addClass('hidden');
			//转交处理人设置
			$('.trShiftTransactor').addClass('hidden');
		}

		function selectConditionChange(aa) {
			showConditions();
			var b = "templateform:" + aa;
			if (b.valueOf() == "templateform:10") {
				$('.buildingJsActivity').removeClass('hidden');
				$('.trIs_ShowOperationPage').removeClass('hidden');
				$('.trOperationCommonPageUrl').removeClass('hidden');
				$('.trOperationMobilePageUrl').removeClass('hidden');
				$('.trIs_ShowNextActivity').removeClass('hidden');
				$('.trIs_ShowOpinionTemplete').removeClass('hidden');
				$('.trIs_CheckMaterialSubmit').removeClass('hidden');
			} else if (b.valueOf() == "templateform:2") {
				$('.buildingJsActivity').removeClass('hidden');
				$('.trBackToStartTargetActivity').removeClass('hidden');
				$('.trIs_ShowOperationPage').removeClass('hidden');
				$('.trOperationCommonPageUrl').removeClass('hidden');
				$('.trOperationMobilePageUrl').removeClass('hidden');
				$('.trIs_ShowOpinionTemplete').removeClass('hidden');
			} else if (b.valueOf() == "templateform:20"
					|| b.valueOf() == "templateform:70") {
				$('.buildingJsActivity').removeClass('hidden');
				$('.trIs_ShowOperationPage').removeClass('hidden');
				$('.trOperationCommonPageUrl').removeClass('hidden');
				$('.trOperationMobilePageUrl').removeClass('hidden');
				$('.trIs_CheckMaterialSubmit').removeClass('hidden');
				if (b.valueOf() == "templateform:70") {
					$('.trIs_ShowOpinionTemplete').removeClass('hidden');
				}
				if (b.valueOf() == "templateform:20") {
					$('.trShiftTransactor').removeClass('hidden');
				}
			} else if (b.valueOf() == "templateform:25") {
				$('.buildingJsActivity').removeClass('hidden');
				$('.trSendToSignTargetActivity').removeClass('hidden');
				$('.trIs_ShowOperationPage').removeClass('hidden');
				$('.trOperationCommonPageUrl').removeClass('hidden');
				$('.trOperationMobilePageUrl').removeClass('hidden');
				$('.trIs_ShowOpinionTemplete').removeClass('hidden');
				$('.trIs_ShowNextActivity').removeClass('hidden');
			} else if (b.valueOf() == "templateform:40"
					|| b.valueOf() == "templateform:45") {
				$('.buildingJsActivity').removeClass('hidden');
				$('.trIs_ShowOperationPage').removeClass('hidden');
				$('.trOperationCommonPageUrl').removeClass('hidden');
				$('.trOperationMobilePageUrl').removeClass('hidden');
				$('.trIs_ShowOpinionTemplete').removeClass('hidden');
			} else if (b.valueOf() == "templateform:30") {
				$('.buildingJsActivity').removeClass('hidden');
				$('.trBackTargetActivity').removeClass('hidden');
				$('.trMultiTransctorMode').removeClass('hidden');
				$('.trIs_ShowOperationPage').removeClass('hidden');
				$('.trOperationCommonPageUrl').removeClass('hidden');
				$('.trOperationMobilePageUrl').removeClass('hidden');
				$('.trIs_ShowOpinionTemplete').removeClass('hidden');
			} else if (b.valueOf() == "templateform:50") {
				$('.buildingJsActivity').removeClass('hidden');
				$('.trIs_ShowOperationPage').removeClass('hidden');
				$('.trOperationCommonPageUrl').removeClass('hidden');
				$('.trOperationMobilePageUrl').removeClass('hidden');
				$('.trIs_ShowOpinion').removeClass('hidden');
			} else if (b.valueOf() == "templateform:0"
					|| b.valueOf() == "templateform:80") {
				$('.trCustomScript').removeClass('hidden');
				$('.trIs_ShowOperationPage').removeClass('hidden');
				$('.trOperationCommonPageUrl').removeClass('hidden');
				$('.trOperationMobilePageUrl').removeClass('hidden');
				$('.trIs_ShowOpinionTemplete').removeClass('hidden');
				$('.trIs_CheckMaterialSubmit').removeClass('hidden');
				//如果自定义（For流程），默认带出Js事件
				if (b.valueOf() == "templateform:80") {
					var s = 'epoint.openDialog("设计", Util.getRightUrl("frame/pages/epointworkflow/client/drawDemo/drawDemo?processVersionInstanceGuid=[#=ProcessVersionInstance_ProcessVersionInstanceGuid#]"),function(e){ShowTdOperate(true);epoint.refresh("handlecontrols"); }, {width : 1700,height : 1500,allowResize : true});';
					mini.get("jstext").setValue(s);
					//mini.get("jstext").setText(s);
				}
			} else if (b.valueOf() == "templateform:1") {
				$('.trCustomScript').removeClass('hidden');
				$('.trIs_ShowOpinionTemplete').removeClass('hidden');

			} else if (b.valueOf() == "templateform:999") {
				$('.buildingJsActivity').removeClass('hidden');
				$('.trIs_ShowOpinionTemplete').removeClass('hidden');
				$('.trSpanWidth').removeClass('hidden');
			} else if (b.valueOf() == "templateform:8"
					|| b.valueOf() == "templateform:18"
					|| b.valueOf() == "templateform:60") {
				$('.buildingJsActivity').removeClass('hidden');
				$('.trIs_ShowOperationPage').removeClass('hidden');
				$('.trOperationCommonPageUrl').removeClass('hidden');
				$('.trOperationMobilePageUrl').removeClass('hidden');
				$('.trMethodBeforeOperate').removeClass('hidden');
				$('.trMethodAfterOperate').removeClass('hidden');
			} else {
				$('.buildingJsActivity').removeClass('hidden');
				$('.trIs_ShowOpinionTemplete').removeClass('hidden');
			}
			operationPageCheck();
		}

		function setParValue() {
			var processVersionGuid = mini.get("processVersionGuid").getValue();
			epoint.openDialog('选择点击按钮后执行的Js脚本',
					"framemanager/workflow/design/designhelper?mode=context&processVersionGuid="
							+ processVersionGuid, setParValueOperJS, {
						'width' : 680,
						'height' : 900
					});
		}

		function setParValueOperJS(rtnValue) {
			if (rtnValue && rtnValue != 'close') {
				var s = rtnValue.split(";")[1];
				var text = rtnValue.split(";")[0]
				mini.get("jstext").setValue(s);
				mini.get("jstext").setText(text);
			}
		}

		function setPage() {
			var opeType = mini.get("opType").getValue();
			var designHelperType;
			if (opeType == "10") {
				designHelperType = "commonHandle";
			} else if (opeType == "20" || opeType == "70") {
				designHelperType = "commonHandleShift";
			} else if (opeType == "30") {
				designHelperType = "commonHandleBack";
			} else if (opeType == "25") {
				designHelperType = "commonHandleSendToSign";
			} else if (opeType == "40" || opeType == "18") {
				designHelperType = "commonHandleTerminate";
			} else if (opeType == "45") {
				designHelperType = "commonHandleTerminatePVI";
			} else {
				epoint.showTips("这类操作类型不可选！",  {state : 'warning'});
				return false;
			}
			epoint.openDialog('选择操作处理页面',
					"framemanager/workflow/design/designhelper?mode=activityPage&type="
							+ designHelperType, setPageOperJS, {
						'width' : 780,
						'height' : 300
					});
		}

		function setPageOperJS(data) {
			if (data && data != "close") {
				mini.get("urlPage").setValue(data);
				mini.get("urlPage").setText(data);
			}
		}

		function selMethodBeforeOperate() {
			var processVersionGuid = mini.get("processVersionGuid").getValue();
			epoint.openDialog("选择方法",
					"framemanager/workflow/design/designhelper?mode=function&processVersionGuid="
							+ processVersionGuid, selMethodBeforeOperateOperJS);
		}

		function selMethodBeforeOperateOperJS(data) {
			if (data && data != 'close') {
				var s = data.split(";");
				mini.get("mgBeforeHide").setValue(s[1]);
				mini.get("mgbefore").setValue(s[0]);
				mini.get("mgbefore").setText(s[0]);
			}
		}

		function selMethodAfterOperate() {
			var processVersionGuid = mini.get("processVersionGuid").getValue();
			epoint.openDialog("选择方法",
					"framemanager/workflow/design/designhelper?mode=function&processVersionGuid="
							+ processVersionGuid, selMethodAfterOperateOperJS);
		}

		function selMethodAfterOperateOperJS(data) {
			if (data && data != 'close') {
				var s = data.split(";");
				mini.get("mgAfterHide").setValue(s[1]);
				mini.get("mgAfter").setValue(s[0]);
				mini.get("mgAfter").setText(s[0]);
			}
		}

		function selEventMethod() {
			var processVersionGuid = mini.get("processVersionGuid").getValue();
			epoint.openDialog("选择方法",
					"framemanager/workflow/design/designhelper?mode=function&processVersionGuid="
							+ processVersionGuid + "&mainPVActivityGuid=",
					selEventMethodOperJS);
		}

		function selEventMethodOperJS(data) {
			if (data && data != 'close') {
				var rtnArray = data.split(";");
				mini.get("txtMethodName").setValue(rtnArray[0]);
				mini.get("txtMethodName").setText(rtnArray[0]);
				mini.get("hidMethodGuid").setValue(rtnArray[1]);
			}
		}

		//表单提交的范围
		function getScope(e) {
			var scope = new Array();
			// 默认要提交的域
			scope.push('operateName', 'opType', 'trDefaultOpion',
					'trOpionNeeded', 'orderNumber', 'trNode', 'txtMethodName',
					'hidMethodGuid', 'occasion', 'openerPageUrlAfterOperate',
					'processVersionGuid', 'hidOperationGuid');
			var b = "templateform:" + e;
			// 通过或者
			if (b.valueOf() == "templateform:10") {
				scope.push('buildingJsActivity', 'trIs_ShowOperationPage',
						'trOperationCommonPageUrl', 'trOperationMobilePageUrl',
						'trIs_ShowNextActivity', 'trIs_ShowOpinionTemplete',
						'trIs_CheckMaterialSubmit');
			}
			//退回到开始
			else if (b.valueOf() == "templateform:2") {
				scope.push('buildingJsActivity', 'trBackToStartTargetActivity',
						'trIs_ShowOperationPage', 'trOperationCommonPageUrl',
						'trOperationMobilePageUrl', 'trIs_ShowOpinionTemplete');
			}
			//转交或者特殊操作
			else if (b.valueOf() == "templateform:20"
					|| b.valueOf() == "templateform:70") {
				scope.push('buildingJsActivity', 'trIs_ShowOperationPage',
						'trOperationCommonPageUrl', 'trOperationMobilePageUrl',
						'trIs_CheckMaterialSubmit');
				if (b.valueOf() == "templateform:70") {
					scope.push('trIs_ShowOpinionTemplete');
				}
			}
			//送阅读
			else if (b.valueOf() == "templateform:25") {
				scope.push('buildingJsActivity', 'trSendToSignTargetActivity',
						'trIs_ShowOperationPage', 'trOperationCommonPageUrl',
						'trOperationMobilePageUrl', 'trIs_ShowOpinionTemplete');
			}
			//终止工作项或者终止流程实例
			else if (b.valueOf() == "templateform:40"
					|| b.valueOf() == "templateform:45") {
				scope.push('buildingJsActivity', 'trIs_ShowOperationPage',
						'trOperationCommonPageUrl', 'trOperationMobilePageUrl',
						'trIs_ShowOpinionTemplete');
			}
			//回退
			else if (b.valueOf() == "templateform:30") {
				scope.push('buildingJsActivity', 'trBackTargetActivity',
						'trMultiTransctorMode', 'trIs_ShowOperationPage',
						'trOperationCommonPageUrl', 'trOperationMobilePageUrl',
						'trIs_ShowOpinionTemplete');
			}
			//收回
			else if (b.valueOf() == "templateform:50") {
				scope.push('buildingJsActivity', 'trIs_ShowOperationPage',
						'trOperationCommonPageUrl', 'trOperationMobilePageUrl',
						'trIs_ShowOpinion');
			}
			//For待办工作项 或者For流程设计
			else if (b.valueOf() == "templateform:0"
					|| b.valueOf() == "templateform:80") {
				scope.push('trCustomScript', 'trIs_ShowOperationPage',
						'trOperationCommonPageUrl', 'trOperationMobilePageUrl',
						'trIs_ShowOpinionTemplete', 'trIs_CheckMaterialSubmit');

			}
			//For已办工作项
			else if (b.valueOf() == "templateform:1") {
				scope.push('trCustomScript', 'trIs_ShowOpinionTemplete');

			}
			//空白占位符
			else if (b.valueOf() == "templateform:999") {
				scope.push('buildingJsActivity', 'trIs_ShowOpinionTemplete',
						'trSpanWidth');
			}
			//签收/阅读/保存
			else if (b.valueOf() == "templateform:8"
					|| b.valueOf() == "templateform:18"
					|| b.valueOf() == "templateform:60") {
				scope.push('buildingJsActivity', 'trIs_ShowOperationPage',
						'trOperationCommonPageUrl', 'trOperationMobilePageUrl',
						'trMethodBeforeOperate', 'trMethodAfterOperate');
			}
			//转缓办
			else {
				scope.push('buildingJsActivity', 'trIs_ShowOpinionTemplete');
			}
			return scope;
		}

		//转交处理人
		function openShiftTransactor() {
			var processVersionGuid = mini.get("processVersionGuid").getValue();
			var operationGuid = mini.get("hidOperationGuid").getValue();
			epoint.openDialog("处理人设置",
					"framemanager/workflow/design/activitytransactor?operationGuid="
							+ operationGuid + "&processVersionGuid="
							+ processVersionGuid);
		}

		function operationChanged() {
			var obj = this.getChecked();
			if (obj == true) {
				$('.trOperationCommonPageUrl').removeClass('hidden');
				$('.trOperationMobilePageUrl').removeClass('hidden');
			} else {
				$('.trOperationCommonPageUrl').addClass('hidden');
				$('.trOperationMobilePageUrl').addClass('hidden');
			}
		}

		function operationPageCheck() {
			var obj = mini.get('is_ShowOperationPage').getValue();
			if (obj == 'true') {
				$('.trOperationCommonPageUrl').removeClass('hidden');
				$('.trOperationMobilePageUrl').removeClass('hidden');
			} else {
				$('.trOperationCommonPageUrl').addClass('hidden');
				$('.trOperationMobilePageUrl').addClass('hidden');
			}
		}

		//]]>
	</script>
</body>
</html>