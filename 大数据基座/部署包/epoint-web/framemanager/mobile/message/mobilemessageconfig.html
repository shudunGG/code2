<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<title>移动消息推送配置</title>
<!-- 请修改相对路径 -->
<script src="../../../frame/fui/js/cssboot.js"></script>
<style>
.form-label {
	text-align: left;
	padding-left: 10px;
}

[class^='mini-'].narrow, [class*='mini-'].narrow {
	width: 350px;
	margin-right: 10px
}

[class^='mini-'].upload, [class*='mini-'].upload {
	width: 100px;
	margin-right: 10px
}

.form-row.bottom-space {
	margin-bottom: 20px
}
</style>
</head>
<body>
	<!-- 必须有，加载时的loading效果 -->
	<div class="page-loading"></div>
	<!-- toolbar区域 -->
	<div class="fui-toolbar">
		<div class="btn-group mr10">
			<a class="mini-button" id="add" iconCls="icon-save" onclick="save">保存</a>
		</div>
		<a role="helper" class="mr10">注意事项</a>
	</div>
	<div class="fui-notice hidden">
		<span style="color: red">使用移动端顶部通知推送必须在服务端能够telnet成功的地址有以下: </br>华为推送相关:&nbsp;&nbsp;https://login.cloud.huawei.com/
			&nbsp;&nbsp; https://api.push.hicloud.com/
			&nbsp;&nbsp;信鸽推送相关:&nbsp;&nbsp;http://openapi.xg.qq.com/ </br>IOS推送相关:&nbsp;&nbsp;gateway.push.apple.com
			2195</br>如果地址不通需要联系网络管理人员开通
		</span>
	</div>
	<!-- 内容区域 -->
	<div class="fui-content">
		<div class="fui-block">
			<div class="fui-block-hd">关联应用</div>
			<div class="fui-block-bd">
				<div class="fui-form">
					<div role="form">
						<div role="row">
							<div role="control" label="选择移动应用">
								<input class="mini-combobox narrow" action="getSelectAppModel"
									bind="appguid" id="appguid" onvaluechanged="refreshIOSCer()" /><span
									class="text-assist">SOA模式下选择app对应接口工程在应用管理中注册的应用,配置后app会收到消息订阅中已订阅的应用发出的通知</span>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="fui-block">
			<div class="fui-block-hd">IOS</div>
			<div class="fui-block-bd">
				<div class="fui-form">
					<div role="form">
						<div role="row">
							<div role="control" label="证书">
								<input class="mini-combobox narrow" action="getSelectCerModel"
									bind="ios_cerguid" id="ios_cerguid" /><a
									class="mini-button upload" plain="true"
									iconCls="icon-addcircle" onclick="certfication()">证书管理</a><span
									class="text-assist">证书请联系IOS开发负责人获取</span>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="fui-block">
			<div class="fui-block-hd">Android</div>
			<div class="fui-block-bd">
				<div class="fui-form">
					<div role="form">
						<div role="row">
							<div role="control">
								<span class="text-assist">注:收费版信鸽注册请至&nbsp; <a
									href="javascript:void(0);" onclick="openXG()" width="auto">新版信鸽官网</a>&nbsp;
									注册登陆后,完成添加应用,将Access_ID和Secrey_Key配置在下方,xg_apppkgname和xg_scheme咨询移动端开发获取
								</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="信鸽 Secrey Key">
								<input id="xg_secretkey" bind="xg_secretkey"
									class="mini-textbox narrow" />
							</div>
						</div>
						<div role="row">
							<div role="control" label="信鸽 Access ID">
								<input id="xg_accessid" bind="xg_accessid"
									class="mini-textbox narrow" />
							</div>
						</div>
						<div role="row">
							<div role="control" label="信鸽 xg_apppkgname">
								<input id="xg_apppkgname" bind="xg_apppkgname"
									class="mini-textbox narrow" />
							</div>
						</div>
						<div role="row">
							<div role="control" label="信鸽 xg_scheme">
								<input id="xg_scheme" bind="xg_scheme"
									class="mini-textbox narrow" />
							</div>
						</div>
						<div role="row">
							<div role="control" label="信鸽 响铃">
								<input class="mini-checkbox" width="auto" truevalue="1"
									falsevalue="0" text="启用" id="xg_ring" bind="xg_ring"
									class="mini-textbox" />
							</div>
						</div>
						<div role="row" class="bottom-space">
							<div role="control" label="信鸽 震动">
								<input class="mini-checkbox" width="auto" truevalue="1"
									falsevalue="0" text="启用" id="xg_vibrate" bind="xg_vibrate"
									class="mini-textbox" />
							</div>
						</div>
						<div role="row">
							<div role="control">
								<span class="text-assist">注:华为注册请至&nbsp; <a
									href="javascript:void(0);" onclick="openHW()" width="auto">华为开发者联盟</a>
									<br>登陆开发者联盟后进入PUSH控制台添加app成功后填写下列参数
								</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="华为  BadgeClass">
								<input id="hw_badgeclass" bind="hw_badgeclass"
									class="mini-textbox narrow" /><span class="text-assist">角标处理实现,联系安卓开发获取</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="华为  App ID">
								<input id="hw_appid" bind="hw_appid" class="mini-textbox narrow" /><span
									class="text-assist">华为推送平台中注册完app后生成的appid</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="华为  App Secret">
								<input id="hw_appsecret" bind="hw_appsecret"
									class="mini-textbox narrow" /><span class="text-assist">华为推送平台中注册完app后生成的appsecret</span>
							</div>
						</div>

						<div role="row">
							<div role="control" label="华为 hw_scheme">
								<input id="hw_scheme" bind="hw_scheme"
									class="mini-textbox narrow" /><span class="text-assist">app
									scheme，咨询移动端开发获取</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="华为  App 包名">
								<input id="hw_apppkgname" bind="hw_apppkgname"
									class="mini-textbox narrow" /><span class="text-assist">app包名，咨询移动端开发获取</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="华为 消息是否震动">
								<input class="mini-checkbox" width="auto" truevalue="1"
									falsevalue="0" text="启用" id="hw_vibrate" bind="hw_vibrate"
									class="mini-textbox" />
							</div>
						</div>
						<div role="row">
							<div role="control" label="华为 消息是否有呼吸灯">
								<input class="mini-checkbox" width="auto" truevalue="1"
									falsevalue="0" text="启用" id="hw_light" bind="hw_light"
									class="mini-textbox" />
							</div>
						</div>
						<div role="row">
							<div role="control">
								<span class="text-assist">注:小米开放平台地址&nbsp; <a
									href="javascript:void(0);" onclick="openXM()" width="auto">小米开放平台</a>
									<br>注册app成功后填写下列参数
								</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="小米  应用ID">
								<input id="xm_appid" bind="xm_appid" class="mini-textbox narrow" /><span
									class="text-assist">小米应用ID，联系安卓开发获取</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="小米  appkey">
								<input id="xm_appkey" bind="xm_appkey"
									class="mini-textbox narrow" /><span class="text-assist">小米开放平台注册完应用后生成的appkey</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="小米  appsecret">
								<input id="xm_appsecret" bind="xm_appsecret"
									class="mini-textbox narrow" /><span class="text-assist">小米开放平台注册完应用后生成的appsecret</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="小米  scheme">
								<input id="xm_scheme" bind="xm_scheme"
									class="mini-textbox narrow" /><span class="text-assist">小米点击事件的scheme</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="小米  包名">
								<input id="xm_package" bind="xm_package"
									class="mini-textbox narrow" /><span class="text-assist">小米包名</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="小米 提示方式">
								<input id="xm_notify_type" bind="xm_notify_type" repeatItems="5"
									repeatLayout="table" repeatDirection="vertical"
									data="[{text:'默认提示音',id:'1'},{text:'默认震动',id:'2'},{text:'默认led灯光',id:'4'},{text:'所有',id:'-1'}]"
									textField="text" valueField="id" class="mini-checkboxlist" />
							</div>
						</div>
						<div role="row">
							<div role="control">
								<span class="text-assist">注:魅族开放平台地址&nbsp; <a
									href="javascript:void(0);" onclick="openMZ()" width="auto">魅族开放平台</a>
									<br>注册app成功后填写下列参数
								</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="魅族 appId">
								<input id="mz_appid" bind="mz_appid" class="mini-textbox narrow" /><span
									class="text-assist">魅族应用ID</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="魅族 appkey">
								<input id="mz_appkey" bind="mz_appkey"
									class="mini-textbox narrow" /><span class="text-assist">魅族应用appkey</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="魅族 appsecret">
								<input id="mz_appsecret" bind="mz_appsecret"
									class="mini-textbox narrow" /><span class="text-assist">魅族应用appsecret</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="魅族 scheme">
								<input id="mz_scheme" bind="mz_scheme"
									class="mini-textbox narrow" /><span class="text-assist">魅族scheme，咨询移动端获取</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="魅族 包名">
								<input id="mz_pageclass" bind="mz_pageclass"
									class="mini-textbox narrow" /><span class="text-assist">魅族包名，咨询移动端获取</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="魅族推送是否震动">
								<input id="mz_vibrate" bind="mz_vibrate" repeatItems="5"
									repeatLayout="table" repeatDirection="vertical"
									data="[{text:'不震动',id:'0'},{text:'震动',id:'1'}]"
									textField="text" valueField="id" class="mini-checkboxlist" /><span
									class="text-assist">魅族推送是否震动</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="魅族推送是否闪光">
								<input id="mz_lights" bind="mz_lights" repeatItems="5"
									repeatLayout="table" repeatDirection="vertical"
									data="[{text:'不闪光',id:'0'},{text:'闪光',id:'1'}]"
									textField="text" valueField="id" class="mini-checkboxlist" /><span
									class="text-assist">魅族推送是否闪光</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="魅族推送是否有提示音">
								<input id="mz_sound" bind="mz_sound" repeatItems="5"
									repeatLayout="table" repeatDirection="vertical"
									data="[{text:'无音',id:'0'},{text:'提示音',id:'1'}]"
									textField="text" valueField="id" class="mini-checkboxlist" /><span
									class="text-assist">魅族推送是否有提示音</span>
							</div>
						</div>
						<div role="row">
							<div role="control">
								<span class="text-assist">注:oppo开放平台地址&nbsp; <a
									href="javascript:void(0);" onclick="openOPPO()" width="auto">oppo开放平台</a>
									<br>注册app成功后填写下列参数
								</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="oppo 包名">
								<input id="oppo_package" bind="oppo_package"
									class="mini-textbox narrow" /><span class="text-assist">oppo应用包名</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="oppo scheme">
								<input id="oppo_scheme" bind="oppo_scheme"
									class="mini-textbox narrow" /><span class="text-assist">oppo应用scheme</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="oppo appId">
								<input id="oppo_appid" bind="oppo_appid"
									class="mini-textbox narrow" /><span class="text-assist">oppo应用ID</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="oppo appkey">
								<input id="oppo_appkey" bind="oppo_appkey"
									class="mini-textbox narrow" /><span class="text-assist">oppo应用appkey</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="oppo appsecret">
								<input id="oppo_appsecret" bind="oppo_appsecret"
									class="mini-textbox narrow" /><span class="text-assist">oppo应用appsecret</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="oppo mastersecret">
								<input id="oppo_mastersecret" bind="oppo_mastersecret"
									class="mini-textbox narrow" /><span class="text-assist">oppo应用mastersecret</span>
							</div>
						</div>
						<div role="row">
							<div role="control">
								<span class="text-assist">注:vivo开放平台地址&nbsp; <a
									href="javascript:void(0);" onclick="openVIVO()" width="auto">vivo开放平台</a>
									<br>注册app成功后填写下列参数
								</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="vivo appId">
								<input id="vivo_appid" bind="vivo_appid"
									class="mini-textbox narrow" /><span class="text-assist">vivo应用ID</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="vivo appkey">
								<input id="vivo_appkey" bind="vivo_appkey"
									class="mini-textbox narrow" /><span class="text-assist">vivo应用appkey</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="vivo appsecret">
								<input id="vivo_appsecret" bind="vivo_appsecret"
									class="mini-textbox narrow" /><span class="text-assist">vivo应用appSecret</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="vivo scheme">
								<input id="vivo_scheme" bind="vivo_scheme"
									class="mini-textbox narrow" /><span class="text-assist">vivo应用scheme</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="vivo package">
								<input id="vivo_package" bind="vivo_package"
									class="mini-textbox narrow" /><span class="text-assist">vivo应用package</span>
							</div>
						</div>
						<div role="row">
							<div role="control" label="vivo 提示方式">
								<input id="vivo_notifyType" bind="vivo_notifyType"
									repeatItems="5" repeatLayout="table" repeatDirection="vertical"
									data="[{text:'无',id:'1'},{text:'响铃',id:'2'},{text:'振动',id:'3'},{text:'响铃和振动',id:'4'}]"
									textField="text" valueField="id" class="mini-checkboxlist" />
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- 请修改相对路径 -->
	<script src="../../../rest/resource/jsboot"></script>
	<script>
		//<![CDATA[
		// 初始化页面
		epoint.initPage('mobilemessageconfigaction', '', function() {
			if (!mini.get('appguid').getValue()) {
				mini.get('appguid').setText('本地模式');
			}
		});

		var attr = Util.getUrlParams('channelguid');

		var channelguid = attr == undefined ? '' : attr;

		function save() {
			if (epoint.validate()) {
				epoint.execute('save', '', null, function(e) {
					if (e.success) {
						epoint.alertAndClose(e.msg, '', null, null, 'success');
					} else {
						if (e.msg) {
							epoint.alert(e.msg, '', null, 'error');
						}
					}
				});
			}
		}

		function certfication() {
			epoint.openDialog('IOS证书管理',
					"framemanager/messages/channel/messagesioscertification?appguid="
							+ mini.get("appguid").getValue(), function() {
						refreshIOSCer();
					}, {
						'width' : 1000,
						'height' : 700
					});
		}

		function refreshIOSCer() {
			mini.get('ios_cerguid').setText('');
			mini.get('ios_cerguid').setValue('');
			epoint.refresh([ 'ios_cerguid', 'appguid' ]);
		}

		function openXG() {
			window.open("https://console.cloud.tencent.com");
		}

		function openHW() {
			window
					.open("https://developer.huawei.com/consumer/cn/console#/serviceCards/AppService");
		}

		function openXM() {
			window.open("https://dev.mi.com/console/appservice/push.html");
		}

		function openMZ() {
			window.open("http://open.flyme.cn/openNew/control.html");
		}

		function openOPPO() {
			window
					.open("https://open.oppomobile.com/newservice/capability?pagename=push");
		}

		function openVIVO() {
			window.open("https://dev.vivo.com.cn/openAbility/pushNews");
		}

		//]]>
	</script>
</body>
</html>