<!DOCTYPE html>
<html>

	<head>
		<title>Classification definition</title>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />

		<script src="../../../frame/fui/js/cssboot.js"></script>
	</head>

	<body>
		<div class="page-loading"></div>

		<!-- toolbar area -->
		<div class="fui-toolbar">
			<div class="btn-group mr10">
				<a class="mini-button" iconCls="icon-addcircle"
				onclick="addCodeItemLev()">new classification</a><a class="mini-button"
				iconCls="icon-save" onclick="saveAll()">save the grading</a><a
				class="mini-button" iconCls="icon-minuscircle"
				onclick="if(mini.get('datagrid').getSelecteds().length==0){epoint.alert('Please choose to delete records!', '', null, 'warning');} else {epoint.confirm('Sure you want to delete?','',deleteSelected);}">delete selected</a>
			</div>

			<!--Help button -->
			<a role="helper" class="mr10">precautions</a>

		</div>

		<!-- Help information area Hidden by default-->
		<div class="fui-notice hidden">
			<div>
				<div style="margin: 0px auto; text-align: left; width: 750px">
					<p>
						Description: this defines the definition of each level of a multilevel code, including code length per level。For example, an administrative division code3205002,
					</p>
					<p>
						32Said provinces;05Said prefecture level;002Counties and cities; You need to define three levels, classification number1For the length of the2; Classification number2For the length of the2; Classification number3For the length of the3。
					</p>
					<p>
						Note: grading number must be from1And must be continuous, not missing。
					</p>
				</div>
			</div>
		</div>

		<!-- The form layout -->
		<div class="fui-condition" opened="true">
		<div class="fui-form" id="fui-form">
			<div role="form">
				<!-- 2column -->
				<div role="row">
					<div role="control" label="classification no" starred="true">
						<input bind="codeItemLev.nowLev" vtype="int;maxLength:9" class="mini-textbox"
						required="true" requiredErrorText="Classification numberCan't be empty" />

					</div>
					<div role="control" label="correspondinglength" starred="true">
						<input bind="codeItemLev.nowBit" class="mini-textbox"
						required="true" vtype="int;maxLength:9" requiredErrorText="The corresponding code lengthCan't be empty" />
					</div>
				</div>
				<div role="row">
					<div role="control" label="whether optional" starred="true">
						<input id="sfkx" autoLoad="false" bind="codeItemLev.yesInp"
						action="getSelectable" textField="text" valueField="id"
						class="mini-combobox" value="1" />
					</div>
					<div role="control" label="returns full path" starred="true">
						<input id="fhqljwb" autoLoad="false" bind="codeItemLev.isFullPath"
						action="getFullPath" textField="text" valueField="id"
						class="mini-combobox" value="1" />
					</div>
				</div>
			</div>

		</div>
		</div>
		<div class="fui-content">
			<div id="datagrid" class="mini-datagrid" sortOrder="desc"
			idField="sysid" multiSelect="true" style="width: 100%; height: 100%;"
			allowResize="true" action="getDataGridData" showPager="false"
			allowCellEdit="true" allowCellSelect="true" allowCellValid="true"
			editNextOnEnterKey="true" editNextRowCell="true">
				<div property="columns">
					<div type="checkcolumn" width="10"></div>

					<div type="indexcolumn" headerAlign="center" width="20">
						order
					</div>

					<div field="nowlev" width="50" headerAlign="center"
					vType="maxLength:9;required" align="right">
						classification number
						<input property="editor" class="mini-textbox" minWidth="50" inputStyle="text-align:right"/>
					</div>
					<div field="nowbit" width="50" headerAlign="center"
					vType="maxLength:9;required" align="right">
						at length coding
						<input property="editor" class="mini-textbox" minWidth="50"
						inputStyle="text-align:right" />
					</div>
					<div field="yesinp" width="50" headerAlign="center"
					renderer="onInpRenderer" type="comboboxcolumn" autoShowPopup="true">
						whether optional
						<input autoLoad="false" data="selectItems.selectable"
						property="editor" class="mini-combobox" minWidth="50" />
					</div>
					<div field="isfullpath" width="50" headerAlign="center"
					renderer="onFullPathRenderer" type="comboboxcolumn"
					autoShowPopup="true">
						returns full path of text
						<input autoLoad="false" data="selectItems.isFullPath"
						property="editor" class="mini-combobox" minWidth="50" />
					</div>
				</div>
			</div>
		</div>

		
 
 	<script type="text/javascript">var miniLocal='en_US.js';</script>
 	<script src="../../../rest/resource/jsboot"></script>

		<!-- Configuration Variables -->
		<script>
			//<![CDATA[
			//Initialize the page
			epoint.initPage("codeitemlevlistaction",'',initCallBack);
			
			function initCallBack(e){
				adjustContentHeight();//hiddenconditionCome out To recount a height
			}

			var selectItems = {
				'selectable' : [{
					id : 0,
					text : 'Do not choose'
				}, {
					id : 1,
					text : 'optional'
				}],
				'isFullPath' : [{
					id : 0,
					text : 'no'
				}, {
					id : 1,
					text : 'is'
				}]
			};

			function onInpRenderer(e) {
				for (var i = 0, l = selectItems.selectable.length; i < l; i++) {
					var sel = selectItems.selectable[i];
					if (sel.id == e.value) {
						return sel.text;
					}
				}
				return "";
			}

			function onFullPathRenderer(e) {
				for (var i = 0, l = selectItems.isFullPath.length; i < l; i++) {
					var sel = selectItems.isFullPath[i];
					if (sel.id == e.value) {
						return sel.text;
					}
				}
				return "";
			}

			// The new item code
			function addCodeItemLev() {
				if (epoint.validate()) {
					epoint.execute('addCodeItemLev', '', msgCallBack);
				}
			}

			// save
			function saveAll() {
				var grid = mini.get("datagrid");
				if (grid.isValid() == false) {
					var error = grid.getCellErrors()[0];
					grid.beginEditCell(error.record, error.column);
					return;
				}
				epoint.execute('saveAll', 'datagrid', msgCallBack);
			}

			// delete
			function deleteSelected() {
				epoint.execute('deleteSelected', 'datagrid', msgCallBack);
			}

			// Back off to remind
			function msgCallBack(data) {
				var msg =data.msg;
				if (msg) {
					if (data.success) {
						epoint.alert(msg, '', searchData(),'info');
					} else {
						epoint.alert(msg, '', '', 'warning');
					}
				}
			}

			// Search for tables
			function searchData() {
				epoint.refresh(['datagrid', 'fui-form'],'',true);
			}

			//]]>
		</script>

	</body>

</html>
