<!DOCTYPE html>
<html>
<head>
<title>过程版本修改</title>
<meta charset="UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge" />
<link rel="stylesheet" href="../css/workflowicons.css?releaseNo=#{version.version}" />
<script src="../../../../frame/fui/js/cssboot.js"></script>
</head>

<body>
	<div class="page-loading"></div>

	<!-- toolbar区域 -->
	<div class="fui-toolbar">
		<div class="btn-group mr10">
			<a class="mini-button" iconCls="icon-addcircle" id="addbtn" onclick="saveProcessVersion()">保存修改</a> 
			<a class="mini-button" iconCls="icon-removecircle" id="cancelbtn" onclick="epoint.closeDialog()">取消修改</a>
		</div>
		<a role="helper" class="mr10">使用过程中需注意的信息</a>
	</div>

	<!-- 帮助信息区域 默认隐藏-->
	<div class="fui-notice hidden">
		<p>
			<font style="color: blue;">监听类的配置为类全路径，该类必须实现<em>com.epoint.workflow.engine.event.EventObserver</em>接口，
			</font>
		</p>
		<p>
			<font style="color: blue;">用于监听整个流程的流转，当你实现它后，原则上将不需要配置任何其他事件。</font>
		</p>
	</div>

	<div class="fui-content">
		<div class="fui-form">
			<div role="form">
				<!-- 2列 -->
				<div role="row">
					<div role="control" label="版本" starred="true">
						<input class="mini-textbox" required="true"
							bind="workflowProcessVersion.version" emptyText="版本不能为空"
							style="width: 100%;" />
					</div>
				</div>
				<div role="row">
					<div role="control" label="监听类" id="type">
						<input class="mini-textbox" bind="workflowProcessVersion.tag" />
					</div>
					<div role="control" label="作者" id="showFormUrl">
						<input class="mini-textbox" bind="workflowProcessVersion.author" />
					</div>
				</div>
				<div role="row">
					<div role="control" label="表单">
						<input class="mini-textbox" bind="formUrl" readonly="true" />
						<!-- <p onclick="selMisTable();"><font style="color: blue;"><em>同步MIS表</em></font></p>-->
					</div>
				</div>
				<div role="row">
					<div role="control" label="备注">
						<input class="mini-textarea" bind="workflowProcessVersion.note"
							style="width: 100%; height: 80px" />
					</div>
				</div>
			</div>
		</div>
	</div>

	<input class="mini-hidden" id="processVersionGuid" bind="workflowProcessVersion.processVersionGuid" />

	<script src="../../../../rest/resource/jsboot"></script>

	<!-- 配置变量 -->
	<script>
		//<![CDATA[
		//初始化页面
		epoint.initPage("processversionsformeditaction");

		function saveProcessVersion() {
			if (epoint.validate()) {
				epoint.execute('saveProcessVersion', '', editComplete);
			}
		}

		function editComplete(data) {
			if (data) {
				var msg = data.sameName;
				if(msg != null && msg.indexOf('成功')>-1){
					epoint.alertAndClose(msg, '', null, null, 'success');
				}else{
					epoint.alert(msg, '', '', 'warning');
				}
			}
		}

		function selMisTable() {
			var processVersionGuid = mini.get("processVersionGuid").getValue();
			epoint.openDialog("同步mis表",
					"framemanager/sform/workflow/manage/mistableupdate?processVersionGuid="+ processVersionGuid,
					'', {
				           'width' : 1000,
				           'height' : 500
			            });
		}

		function processNext(flow) {
			if (flow.next().getData().url.indexOf('processVersionGuid=') == -1) {
				flow.next().setUrl(
						flow.next().getData().url + "?processVersionGuid="
								+ processVersionGuid);
			}
		}
		//]]>
	</script>
</body>
</html>