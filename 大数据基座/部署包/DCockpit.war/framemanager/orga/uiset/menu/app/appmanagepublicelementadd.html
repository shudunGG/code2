<!DOCTYPE html>
<html>

	<head>
		<title>元件添加</title>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />

		<script src="../../../../../frame/fui/js/cssboot.js"></script>
	</head>
	<body>
		<div class="page-loading"></div>
		<!-- toolbar区域 -->
		<div class="fui-toolbar">
			<div class="btn-group mr10">
				<a class="mini-button" id="addClose" onclick="saveAndClose" iconCls="icon-save">
				保存并关闭
				</a>
				<a class="mini-button" onclick="epoint.closeDialog" iconCls="icon-removecircle">
				关闭
				</a>
			</div>
			<!--帮助按钮 -->
			<a role="helper" class="mr10">注意事项</a>
		</div>
		<!-- 帮助信息区域 默认隐藏-->
		<div class="fui-notice hidden">
			<p>
				元件的<em>宽度</em><em>高度</em>属性如果都配置为0，那么该元件就是一个全屏元件，全屏元件所在屏幕不要配置其他任何东西
			</p>
			<p>
				<em>无边框</em>勾选后，元件是没有四周的边框的，也没有顶部的标题栏，当你鼠标移到标题栏位置，才会显示出相关内容
			</p>
			<p>
				<em>是否允许关闭</em>勾选后，元件右上角会有卸载的图标，如果元件不能卸载，可以不勾选该项
			</p>
			<p>
				<em>关联应用</em>配置后，点击元件顶部的标题栏，会打开关联的应用页面
			</p>
			<p>
				<em>内容页地址：</em>即元件内嵌的iframe页面的地址
			</p>
			<p>
				<em>高级设置页面地址：</em>该地址配置后，元件的右上角会有一个齿轮的按钮图标，点击后会打开配置的地址，关闭之后，会刷新元件页面
			</p>
		</div>

		<!-- 内容区域 -->
		<div class="fui-content">
			<!-- 表单区域 -->
			<div id="fui-form" class="fui-form">
				<div role="form">
					 <div role="row">
						<div role="control" label="元件名称" starred="true">
							<input bind="dataBean.portaletname" class="mini-textbox"
							required="true" requiredErrorText="元件名称不能为空" vtype="maxLength:50" />
						</div>
						<div role="control" label="排序">
							<input bind="dataBean.ordernum" class="mini-textbox" vtype="int;range:0,99999999" value="0"/>
						</div>
					</div>
					<div role="row">
						<div role="control" label="所属分类">
							<input name="yingYongList" bind="dataBean.categoryguid"
							action="getYingYongList" allowInput="false" autoLoad="false"
							class="mini-combobox" emptyText="请选择..." />
						</div>
						<div role="control" label="关联应用">
							<input id="appRelation" bind="linkapp" class="mini-buttonedit" allowInput="false"
							emptyText="" onbuttonclick="selectApp" selectOnFocus="true" />
							隐藏域，用于绑定appguid
							<input bind="dataBean.linkapp" id="appguid"
							class="mini-hidden" />
						</div>
					</div>
					<div role="row">
						<div role="control" label="顶部位置">
							<input bind="dataBean.position_top" class="mini-textbox" maxLength="8" vtype="int" />
						</div>
						<div role="control" label="左边位置">
							<input bind="dataBean.position_left" class="mini-textbox" maxLength="8" vtype="int" />
						</div>
					</div>
					<div role="row">
						<div role="control" label="宽度">
							<input bind="dataBean.width" class="mini-textbox" maxLength="8" vtype="int" />
						</div>
						<div role="control" label="高度">
							<input bind="dataBean.heigth" class="mini-textbox" maxLength="8" vtype="int" />
						</div>
					</div>
					<div role="row">
						<div role="control" label="是否允许关闭">
							<div name="allowclosebutton" bind="allowclosebutton"
							class="mini-checkbox"></div>
						</div>
						<div role="control" label="是否启用">
							<div name="isdisable" bind="isdisable" class="mini-checkbox"></div>
						</div>
						<div role="control" label="无边框">
							<div name="isinit" bind="isinit" class="mini-checkbox"></div>
						</div>
					</div>
					<div role="row">
						<div role="control" label="内容页地址">
							<input bind="dataBean.url" class="mini-textbox" />
						</div>
					</div> 
					<div role="row">
						<div role="control" label="高级设置页面地址">
							<input bind="dataBean.userconfigurl" class="mini-textbox" />
						</div>
					</div>
					<div role="row">
						<div role="control" label="应用仓库图标">
							<input id="bigRefresh" bind="dataBean.storeicon"
							class="mini-buttonedit" emptyText="" onbuttonclick="openicon" allowInput="false"
							selectOnFocus="true" />
						</div>
					</div>

				</div>
			</div>
		</div>

		<script src="../../../../../rest/resource/jsboot"></script>

		<!-- 配置变量 -->
		<script>
			//<![CDATA[
			//初始化页面
			epoint.initPage("appmanagepublicelementaddaction");

			// 新增操作的回调
			function newCallback(data) {
				if (data.msg) {
					epoint.alert(data.msg, '', null, 'info');
					if (data.success) {
						// 清空表单
						epoint.clear('fui-form');
					}
				}
			}

			function onCloseClick(e) {
				var obj = e.sender;
				obj.setText("");
				obj.setValue("");
			}

			// 关闭操作的回调
			function closeCallback(data) {
				if (data.msg) {
					if (data.success) {
						epoint.alertAndClose(data.msg, '', null, null, 'success');
					} else {
						epoint.alert(data.msg, '', null, 'error');
					}
				}
			}

			//保存并关闭
			function saveAndClose() {
				if (epoint.validate()) {
					epoint.execute('add', 'fui-form', closeCallback);
				}
			}

			//打开大图片
			function openicon(e) {
				epoint.openDialog('选择图标', 'framemanager/orga/uiset/menu/module/selectoa8icon?type=big', function(param) {
					if (param && param != 'close') {
						mini.get("bigRefresh").setText(param);
						mini.get("bigRefresh").setValue(param);
					}
				}, {
					width : 1000,
					height : 400
				});
			}

			//选择应用
			function selectApp(e) {
				epoint.openDialog('选择应用', 'framemanager/orga/uiset/menu/app/selectapp?type=1', function(param) {
					s = param.split(";");
					if (param != 'close' && s[1] != 'f9root') {
						mini.get("appRelation").setText(s[0]);
						mini.get("appguid").setValue(s[1]);
					}
				}, {
					width : 300,
					height : 500
				});
			}

			//]]>
		</script>
	</body>
</html>