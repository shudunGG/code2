<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title></title>
    <script src="../../../js/cssboot.js"></script>
</head>

<body>
    <div class="loading" id="loading">
        <div id="loading-text" class="loading-text"></div>
    </div>
    <script>
        var tipTexts = [
            '用日志，记录您的工作点滴',
            'E讯协同，乐在沟通',
            '把零报告变成一种工作态度',
            '在邮件里，您也可以@他人',
            '新点协同办公，您身边的工作伙伴',
            '劳逸结合，健康办公',
            '久坐易伤身，起来活动下吧',
            '业精于勤，而荒于嬉',
            '快乐工作，快乐生活',
            '质量领跑，标准护航',
            '我们的努力多一点，用户的障碍少一点'
        ]
        document.getElementById('loading-text').innerHTML = tipTexts[Math.floor(Math.random() * 11)];
    </script>
    <div class="header clearfix" id="header">
        <div class="header-left clearfix">
            <div class="top-portal-container l clearfix" id="top-portal-container">
                <span class="top-portal-btn"></span>
                <div class="top-portal-wrap">
                    <div class="top-portal">
                        <h2 class="top-portal-header">门户</h2>
                        <div class="top-portal-content" id="top-portal-content"></div>
                    </div>
                </div>
            </div>
            <span id="menu-btn" class="header-menu-btn"></span>
            <div class="header-search l" id="header-search-container">
                <div class="header-search-wrap" id="header-search"></div>
                <span class="header-search-btn"></span>
            </div>
        </div>
        <div class="header-center">
            <img src="./images/logo.png" id="sys-logo-img" class="logo">
        </div>
        <div class="header-right">
            <!-- actions -->
            <div class="header-action-btns l clearfix" id="header-action-btns">

                <span id="msg-icon" class="header-action-btn remind " data-ref="msgRemind">
                    <i class="remind-num hidden header-action-btn-tip"></i>

                    <!-- <div class="new-remind-wrap hidden" id="new-remind-wrap">
                        <span class="icon"></span>
                        <span class="text">您有新的消息提醒</span>
                        <span class="close"></span>
                    </div> -->
                </span>
                <span id="emsg-icon" class="header-action-btn chart " data-ref="msgEMsg">
                    <i class="emsg-num hidden header-action-btn-tip"></i>
                </span>
                <span class="header-action-btn theme" id="theme-skin-switch"></span>
                <span id="help-icon" class="header-action-btn help" onclick="window.open(Util.getRightUrl('frame/helpcenter/commonquestion/index'))"></span>
            </div>
            <!-- user -->
            <div class="user-info" id="user-info">
                <div class="user-info-summary">
                    <img src="./images/header/user.png" alt="" class="user-portrait">
                </div>
                <div class="user-action-panel">
                    <div class="user-action-panel-inner">
                        <div class="user-info-detail" id="user-info-detail">
                            <img src="./images/header/user.png" alt="" class="user-portrait">
                            <span class="user-name"></span>
                            <span class="user-dept"></span>
                        </div>
                        <ul class="user-action-list">
                            <li class="user-action-item person-info" data-id="person-info-setting" id="person-info-setting"
                                data-name="个人信息维护" title="个人信息维护" data-url="/pages/frame/sysconf/personalset/personalinfo/personalinfo.proto.html">个人信息维护</li>
                            <li class="user-action-item role-change hidden" data-id="user-role-change" data-name="兼职切换"
                                title="兼职切换">兼职切换</li>
                            <!-- 此处扩展时添加 li 即可 -->
                            <!-- <li class="user-action-item css样式类需定义图标" title="显示的名字"  url="要打开的链接地址" data-opentype="打开方式 tabsnav/dialog/blank之一" data-id="一个标识，请勿重复，可以不配置自动生成生成" script="如果打开一个链接不能满足需求，可以在此配置一段js脚本，将在点击时执行，配置url后此项无效" >显示的名字</li> -->
                            <!-- 扩展demo -->
                            <li class="user-action-item extlink1" title="扩展链接1" url="https://www.baidu.com/"
                                data-opentype="tabsnav" data-id="person-extitem1">扩展链接1</li>
                            <li class="user-action-item extlink2" title="扩展2" script="epoint.openDialog('个性化打开', 'abc', function (e){alert(e);})">扩展链接2</li>
                            <li class="user-action-item logout" title="注销登录">注销登录</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="top-menu-panel" id="top-menu-panel">
            <div class="top-menu-panel-inner">
                <div class="quick-menu menu-block">
                    <h2 class="menu-title">常用菜单
                        <div class="quick-menu-btns"><span class="quick-menu-btn">配置</span></div>
                    </h2>
                    <ul class="quick-menu-list clearfix" id="quick-menu-list"></ul>
                </div>
                <div class="top-menu menu-block">
                    <h2 class="menu-title">应用菜单
                        <div class="top-menu-btns" id="top-menu-btns">
                            <span class="top-menu-sort-btn start hidden">应用排序</span>
                            <span class="top-menu-sort-btn save hidden">保存</span>
                            <span class="top-menu-sort-btn cancel hidden">取消</span>
                        </div>
                    </h2>
                    <ul class="top-menu-list clearfix" id="top-menu-list"></ul>
                </div>
            </div>
        </div>
    </div>


    <div class="main no-trans left-none" id="main">
        <!-- 左侧菜单 -->
        <div class="left-menu-container" id="left-menu">
        </div>
        <!-- 主体ifr -->
        <div class="main-content">
            <div class="main-content-wrap" id="main-ifr-wrap"></div>
            <div class="main-content-cover-wrap" id="cover-wrap"></div>
        </div>
    </div>
    <!-- 右侧滑动弹窗 -->
    <div id="msg-panel" class="msg-panel hidden">
        <!-- 消息 -->
        <div id="msgRemind" class="msg-panel-detail ">
            <h2 class="msg-panel-head">消 &nbsp; 息
                <i class="msg-panel-hide"></i>
            </h2>
            <div class="msg-panel-content">
            </div>
        </div>
        <!-- E讯 -->
        <div id="msgEMsg" class="msg-panel-detail">
            <h2 class="msg-panel-head tab">
                <span class="panel-hd-tab active">E讯提醒</span>
                <span class="panel-hd-tab hidden" data-ref="online-user">在线人员(<span class="online-user-num">0</span>)</span>
                <i class="msg-panel-hide"></i>
            </h2>
            <div class="msg-panel-content">
                <ul class="emsg-recent-list empty"></ul>
                <iframe id="online-user" class="emsg-online-user hidden" width="100%" height="100%" frameborder="0"></iframe>
            </div>
        </div>
    </div>
    <div class="footer clearfix" id="footer"></div>

    <!-- 声音提示 js动态添加IE加载iframe 非IE使用audio -->
    <div id="msg-sound"></div>
    <script src="../../../js/jsboot.js"></script>
    <script>
        var getDataUrl = 'https://fe.epoint.com.cn/mock/26/themedataaction';
        var getPagesUrl = getDataUrl + '/getAllPage';
        var savePageUrl = getDataUrl + '/setAsDefault';
        var topMenuSaveUrl = getDataUrl + '/saveMenuSort';
        // 搜索相关的配置
        var _searchCfg = {
            // 用户模块搜索
            userModuleSearchUrl: 'https://fe.epoint.com.cn/mock/26/themedataaction/userModuleSearch',

            // 实时搜索到的用户的点击处理函数 参数为人员guid name
            userClick: function (userGuid, userName) {
                epoint.openDialog('人员详情', Util.getRightUrl('https://www.baidu.com/s?wd=' + '姓名:' + userName +
                    ' guid:' + userGuid), function () {}, {
                    width: 800,
                    height: 380
                });
            },
            // 全文检索分类
            fullSearchCateUrl: getDataUrl + '/getSearchCate',
        };

        var UserSettings = {
            logout: function () {
                // 已经默认做了是否退出的提醒，确定后才会调用此函数
                window.location.href = Util
                    .getRightUrl('rest/logout?isCommondto=true');
            },
            // 兼职切换处理函数
            changeRole: function (userGuid) {
                // 未做提醒 逻辑需要自己实现
                // 参数为后端返回的userGuid
                var url = "frame/pages/login/switchparttime?userguid=" + userGuid;
                epoint.openDialog("账号选择", url, function (result) {
                    if (result == 'success') {
                        window.location.reload();
                    }
                }, {
                    'width': 850,
                    'height': 350
                });
            }
        };
        // 消息提醒tip配置
        var RemindTipsCfg = {
            timeout: 60 * 1000, // 自动关闭时间 单位毫秒 0 不自动关闭
            show: true // 是否启用
        };
        var onlineUserIframe = document.getElementById('online-user');
        // 在线人员选项卡配置
        var OnlineUserSettings = {
            // 是否显示
            show: true,
            // 对应页面地址
            url: '../../../../frame/orga/user/onlineuser',
            // 每次显示E讯面板时都会触发该方法
            onRefreshData: function (callback) {
                // 调用在线人员页面中的刷新数据方法
                // 同时tab上的在线人数需要更新，但考虑到获取数据是异步操作，所以需要在refreshData方法中获取到在线人数后调用callback方法
                try {
                    onlineUserIframe.contentWindow.refreshData(callback);
                } catch (e) {
                    console.error(e);
                }

            }
        };
        var EmsgConfig = {
            // baseUrl: epoint.dealRestfulUrl('exundataaction/eXun'),
            baseUrl: 'https://fe.epoint.com.cn/mock/26/themedataaction/exundataaction/eXun',
            treeUrl: epoint.dealRestfulUrl("exundataaction/getTree"),
            websocketUrl: "../../../../../websocket/eXun",
            historyUrl: "frame/pages/basic/communication/exun/exunmsg",
            groupImg: "../../emsg/images/emsg-group-bg.png",
            userImg: "../../emsg/images/emsg-user-error.jpg",
            // 发送邮件的地址，如果配置了将显示E讯窗口上方显示发送邮件 经在URL后自动拼接收件人guid，多个以“;”分隔
            // 约定 如果有多人，参数名为ToUserGuidList 一个人则参数名为ToUserGuid
            sendEmailUrl: '',
            showErrorMsg: true
        };


        // 消息中心配置
        var MsgCenterConfig = {
            "typeListUrl": getDataUrl + '/getTypeListUrl', // 类型接口
            "msglistUrl": getDataUrl + '/getMsglistUrl', // 右侧列表接口
            "markToReadUrl": getDataUrl + '/markToReadUrl', // 标记为已读接口，多个用逗号隔开
            "deleteUrl": getDataUrl + '/deleteUrl', // 删除接口, 类型为all表示删除所有，不然直接传id，多个逗号隔开
            "msgTipsUrl": getDataUrl + '/getMsgTipsUrl' // 消息提醒接口，返回各个类别的数据和总数
        }

        //消息中心高级设置
        var MsgCenterSetting = {
            getMessageSettingUrl: getDataUrl + '/getMessageSetting', // 获取参数数据
            saveMessageSettingUrl: getDataUrl + '/saveMessageSettingUrl' //保存 
        };
    </script>
    <script>
        // 前端原型使用远程数据模拟时 ie8/9不支持响应头中直接 Access-Control-Allow-Origin 来启用跨域支持
        if (Util.browsers.isIE8 || Util.browsers.isIE9) {
            jQuery.support.cors = true;
        }
        //  前端原型直接开始系统参数中的允许排序

        window.EpFrameSysParams = window.EpFrameSysParams || {};
        window.EpFrameSysParams.enableCustomSort = true;
    </script>
    <script>
        SrcBoot.output([
            'frame/fui/js/widgets/classifysearch/classifysearch.js',
            'frame/fui/js/widgets/tabsnav/tabsnav.js',
            'frame/fui/js/widgets/msgcenter/msgcenter.js',
            './aide.js'
        ]);
    </script>
    <script>
        var guidanceConfig = {
            // 欢迎窗口显示的系统名字
            sysName: '新点网络协同办公平台',
            // 更新步数的请求地址
            updateStepUrl: epoint.dealRestfulUrl('themedataaction/updateStepUrl'),
            // 获取初始化时显示的步数的请求地址
            getCurrentStepUrl: epoint.dealRestfulUrl('themedataaction/getCurrentStepUrl'),
            // 步骤配置
            steps: [{
                target: 'top-portal-container',
                title: '知识门户整合',
                content: '这里汇聚了公司最新的技术研究成果和行业发展动向，带你办公、学习两不误',
                imgSrc: 'images/guidance/portal.png',
                position: {
                    img: {
                        left: 0,
                        top: 'bottom'
                    },
                    tips: 'right'
                }
            }, {
                target: 'menu-btn',
                title: '新菜单更懂你',
                content: '功能太多、太难找？新版菜单会智能分析你的使用习惯， 为你私人定制，常用菜单一目了然',
                imgSrc: 'images/guidance/menu.png',
                position: {
                    img: {
                        top: 'bottom',
                        left: 0,
                        right: 0,
                        fillBgImg: 'images/guidance/menu-bg.png'
                    },
                    tips: 'bottom'
                }
            }, {
                target: 'msg-icon',
                title: '消息全方位',
                content: '消息中心全面升级！支持消息分类查询，历史消息随时看， 还可以设置多种渠道的推送',
                imgSrc: 'images/guidance/msgcenter.png',
                position: {
                    img: {
                        top: 70,
                        right: 20,
                        width: 780
                    },
                    tips: 'left'
                }
            }, {
                target: 'emsg-icon',
                title: 'E讯，乐在沟通',
                content: '全新打造的在线沟通工具，自由搭建多人讨论组，快去看看是否已经有人@你了',
                imgSrc: 'images/guidance/emsg.png',
                position: {
                    img: {
                        top: 'bottom',
                        right: 0,
                        bottom: 0,
                        fillBgImg: 'images/guidance/emsg-bg.png'
                    },
                    tips: 'left'
                }
            }, {
                target: 'theme-skin-switch',
                title: '主题随心换',
                content: '多种主题皮肤自由搭配，打造你的专属办公界面',
                imgSrc: 'images/guidance/theme.png',
                position: {
                    img: {
                        left: 0,
                        right: 0,
                        bottom: 0,
                        fillBgImg: 'images/guidance/theme-bg.png'
                    },
                    tips: 'top'
                }
            }, {
                target: 'help-icon',
                title: '新增帮助中心',
                content: '在这里，可以找到常用的办公工具，和最新的平台公告，如 果你有新的问题或建议也可在这发布',
                position: {
                    tips: 'bottom'
                }
            }]
        };
    </script>
    <script src="../../../js/widgets/guidance/guidance.js"></script>
    <script>
        setTimeout(function () {
            $('#loading').fadeOut(500);
        }, 1500);
    </script>
</body>

</html>