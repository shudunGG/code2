<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>IMAC主题-主界面</title>
    <link rel="stylesheet" href="../../../js/widgets/epcontextmenu/epcontextmenu.css">
    <link rel="stylesheet" href="
    ../../../js/widgets/classifysearch/classifysearch.css">
    <script src="../../../js/cssboot.js"></script>
    <script>
        SrcBoot.output([
            'frame/fui/js/widgets/epdialog/epdialog.css'
        ]);
    </script>
</head>

<body>
    <!-- <div class="page-loading"></div> -->
    <!-- 主题背景 -->
    <img src="" alt="" class="imac-skin-bg" id="imac-skin-bg" />
    <!-- <div class="imac-skin-bg" id="imac-skin-bg"></div> -->
    <!--顶部 -->
    <div class="imac-top-bar clearfix" id="imac-top-bar">
        <!-- 系统logo -->
        <img src="images/epoint-logo.png" alt="" class="sys-logo l">

        <!-- 分屏页码 -->
        <div class="imac-page-list clearfix" id="imac-page-list">
            <!--
            <a href="javascript:void(0);" data-page="1" class="page-item active l mr10">
                <span>1</span>
            </a>
            -->
        </div>
        <div class="top-right r">
            <!-- 全文搜索 -->
            <div id="header-search-container" class="l clearfix"></div>
            <!-- 用户信息 -->
            <div id="top-user" class="top-user r mr20">
                <img src="./images/top/user-img.png" alt="" class="user-img l" />
                <span class="user-name"> </span>
                <span class="user-ou"> </span>
            </div>
        </div>
    </div>
    <!-- 分屏 -->
    <div class="imac-screens-container" id="imac-screens-container">
        <div class="screen-list clearfix">
            <!-- <div class="imac-screen l"></div> -->
        </div>
    </div>
    <!-- 底部任务栏 -->
    <div class="imac-taskbar" id="imac-taskbar">
        <!--<div class="scroll-wrap l hidden">
            <a href="javascript:void(0);" class="scroll-l"></a>
        </div>-->
        <div class="tasks-wrap l">
            <div class="task-list clearfix">
                <!--
                <a href="javascript:void(0);" class="task-item l clearfix" title="信息投稿">
                    <img src="images/imac/app/app1-taskbar.png" alt="" class="l task-icon">
                    <p class="task-name l">信息投稿</p>
                </a>
                -->
            </div>
        </div>
        <!--<div class="scroll-wrap l hidden">
            <a href="javascript:void(0);" class="scroll-r"></a>
        </div>-->
    </div>
    <!-- 任务下拉面板 -->
    <div class="task-drop hidden" id="task-drop">
        <ul class="drop-list">

        </ul>
        <span class="drop-btn"><i class="drop-btn-icon"></i></span>
    </div>
    <!-- 侧边工具栏  -->
    <div class="imac-right-bar" id="imac-right-bar">
        <!-- <div class="right-search-btn"></div> -->
        <div class="right-board-btn" id="portal-btn"></div>
        <!-- 快速应用列表 -->
        <div class="quick-apps">
            <div class="list-wrap"></div>
            <span class="quick-cfg-btn hidden"></span>
            <div class="r-empty-tpis-bg hidden">
                <img src="" class="r-empty-tips" id="r-empty-tips" alt="">
            </div>
        </div>
        <!-- 快捷按钮 -->
        <div class="quick-btns">
            <a href="javascript:void(0);" class="q-btn emsg" title="E讯提醒"><span class="msg-num hidden"></span></a>
            <a href="javascript:void(0);" class="q-btn message" title="消息提醒"><span class="msg-num hidden"></span></a>
            <a href="javascript:void(0);" class="q-btn skin default-app-btn" data-id="sys-bg" title="背景设置"></a>
            <a href="javascript:void(0);" class="q-btn settings default-app-btn" data-id="sys-settings" title="系统设置"></a>
            <a href="javascript:void(0);" class="q-btn theme" id="theme-switch" title="主题切换"></a>
            <a href="javascript:void(0);" class="q-btn logout" title="注销登录"></a>
        </div>
    </div>
    <!-- E讯 -->
    <div id="msgEMsg" class="msg-panel">
        <h2 class="msg-panel-head">
            <span class="panel-hd-tab active">E讯提醒</span>
            <span class="panel-hd-tab hidden" data-ref="online-user">
                在线人员( <span class="online-user-num">0</span>)
            </span>
            <i class="msg-panel-hide"></i>
        </h2>
        <div class="msg-panel-content">
            <ul class="emsg-recent-list empty"></ul>
            <iframe id="online-user" class="emsg-online-user hidden" width="100%" height="100%" frameborder="0"></iframe>
        </div>
    </div>
    <!-- 搜索面板 -->
    <div class="search-box hidden" id="search-board">
        <div class="search-panel">
            <div class="panel-hd">
                <i class="close-btn" title="关闭"></i>
                <input type="text" class="a-search-input" placeholder="请输入应用名称搜索">
            </div>
            <div class="panel-bd" id="panel-tab-view">
                <div class="tabview-hd" data-role="head">
                    <ul class="clearfix">
                        <li class="tab-item l" data-role="tab" data-target="all-apps">所有应用</li>
                        <li class="tab-item l" data-role="tab" data-target="search-history">搜索记录</li>
                    </ul>
                </div>
                <div class="tabview-bd" data-role="body">
                    <div data-role="tab-content" data-id="all-apps" class="tab-panel clearfix" id="all-apps">

                        <div class="no-result hidden">没有搜索到与“<span id="search-key"></span>”相关的结果</div>
                    </div>
                    <div data-role="tab-content" data-id="search-history" class="tab-panel clearfix" id="search-history">

                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 我的看板 -->
    <div class="portal-container" id="portal-wrap">
        <div class="portal">
            <h2 class="portal-header">门户</h2>
            <div class="portal-content" id="portal-content"></div>
        </div>
    </div>
    <div class="board-panel hidden" id="board-panel">
        <i class="board-close"></i>
    </div>

    <!-- 声音提示 js动态添加IE加载iframe 非IE使用audio -->
    <div id="msg-sound"></div>
    <script src="../../../js/jsboot.js"></script>
    <script>
        SrcBoot.output([
            'frame/fui/js/widgets/epdialog/epdialog.js',
            'frame/fui/js/widgets/epcontextmenu/epcontextmenu.js'
        ]);
    </script>
    <!-- 配置变量 -->
    <script>
        // 右侧使用快捷应用 true为快捷应用 false 为最近使用
        // var rightUseQuickApps = true;
        // 通用数据接口地址
        var dataBaseUrl = 'themedataaction';
        // 获取用户信息
        var ImacDataActionUrl = {
            userInfoUrl: epoint.dealRestfulUrl(dataBaseUrl + '/getUserInfo'),
            // 获取界面信息
            pageInfoUrl: epoint.dealRestfulUrl(dataBaseUrl + '/getPageInfo'),
            // 请求屏幕上的应用信息
            screenAppsUrl: epoint.dealRestfulUrl(dataBaseUrl + '/getImacApps'),
            // screenAppsUrl = './test/screen.json',
            // 当前屏幕内位置移动
            updateAppPosUrl: epoint.dealRestfulUrl(dataBaseUrl + '/updateAppPos'),
            // updateAppPosUrl = './test/installApp.json',
            // 移动到其他屏幕
            appToScreenUrl: epoint.dealRestfulUrl(dataBaseUrl + '/moveToScreen'),
            // appToScreenUrl = './test/installApp.json',
            // 获取消息提醒数
            msgCountUrl: epoint.dealRestfulUrl(dataBaseUrl + '/getMsgCount'),

            // 获取背景图片的url
            getBgUrl: './test/bg.json',
            // uninstallAppUrl = epoint.dealRestfulUrl(dataBaseUrl + '/uninstallApp');

            getPagesUrl: epoint.dealRestfulUrl(dataBaseUrl + '/getAllPage'),
            savePageUrl: epoint.dealRestfulUrl(dataBaseUrl + '/setAsDefault'),

            // 常用应用的请求地址
            getQuickAppsUrl: epoint.dealRestfulUrl(dataBaseUrl + '/getQuickApp'),
            // 常用应用配置地址
            commonAppCfgUrl: 'frame/fui/pages/quickappsetting/quickappsetting'
        };
        // 消息中心配置
        var MsgCenterConfig = {
            "typeListUrl": epoint.dealRestfulUrl(dataBaseUrl +
                '/getTypeListUrl'), // 类型接口
            "msglistUrl": epoint.dealRestfulUrl(dataBaseUrl + '/getMsglistUrl'), // 右侧列表接口
            "markToReadUrl": epoint.dealRestfulUrl(dataBaseUrl +
                '/markToReadUrl'), // 标记为已读接口，多个用逗号隔开
            "deleteUrl": epoint.dealRestfulUrl(dataBaseUrl + '/deleteUrl'), // 删除接口, 类型为all表示删除所有，不然直接传id，多个逗号隔开
            "msgTipsUrl": epoint.dealRestfulUrl(dataBaseUrl + '/getMsgTipsUrl')
            // 消息提醒接口，返回各个类别的数据和总数
        };

        //消息中心高级设置
        var MsgCenterSetting = {
            getMessageSettingUrl: epoint
                .dealRestfulUrl('mypagesettingaction/getMessageSetting'), // 获取参数数据
            saveMessageSettingUrl: epoint
                .dealRestfulUrl('mypagesettingaction/saveMessageSetting')
            //保存 
        };

        // 搜索相关的配置
        var _searchCfg = {
            // 用户模块搜索
            userModuleSearchUrl: 'fullsearchaction/getFrameInformation',

            // 实时搜索到的用户的点击处理函数 参数为人员guid name
            userClick: function (userGuid, userName) {
                // epoint.openDialog('人员详情', Util.getRightUrl('https://www.baidu.com/s?wd=' + userGuid), function () {}, {
                //     width: 800,
                //     height: 600
                // });
                epoint.openDialog('人员详情', Util.getRightUrl(
                        'frame/pages/basic/communication/businesscard/innerdetail.html?uid=' + userGuid),
                    function () {}, {
                        width: 800,
                        height: 380
                    });
            },
            // 全文检索分类
            fullSearchCateUrl: epoint.dealRestfulUrl('fullsearchaction/getftsSystem')
        };

        // 应用消息轮训的设置
        var APP_MSG_CONFIG = {
            // 每个应用之前的消息数目请求时间间隔 ms
            space: 50,
            // 一轮完成到下一轮的时间间隔 ms
            interval: 1000 * 60
        };

        // 右下角快捷应用配置
        var quickApps = [
            //     {
            //     // 信息提醒
            //     name: '消息提醒',
            //     icon: './images/app/24.png',
            //     id: 'sys-msg-reminder',
            //     url: 'frame/pages/themes/imacframe/messagereminder'
            // }, 
            {
                name: '背景设置',
                icon: './images/right/skin.png',
                id: 'sys-bg',
                url: './test/bgsetting/bgsetting.proto.html'
            }, {
                // 系统设置
                name: '个人设置',
                icon: './images/app/13.png',
                id: 'sys-settings',
                url: './topNavBottomIframe.php'
            }
        ];

        // 默认显示的分屏页，从1开始
        var DEFAULT_ACTIVE_PAGE = 1;

        // 右侧工具栏停靠应用的最多数目 
        var MAX_DOCK_APP_NUM = 10;

        // [x, y] dialog打开时 宽高相对于视窗大小的比列
        var DIALOG_SIZE_RATIO = [0.6, 0.6];

        // // 全文搜索的url
        // document.getElementById('full-search-form').action =
        //     'http://fdoc.epoint.com.cn/onlinedoc/KlFront/fullsearch.html';
        // 全文搜索的关键字参数名称 
        // document.getElementById('full-search-input').name = 'wd';
        // 注销登录的操作函数
        var logout = function () {
            epoint.confirm('确认注销登录吗？', '系统提醒', function () {
                window.location.href = Util.getRootPath() + "rest/logout?isCommondto=true";
            });
        };

        //  exun配置
        var EmsgConfig = {
            baseUrl: epoint.dealRestfulUrl('exundataaction/eXun'),
            treeUrl: epoint.dealRestfulUrl("exundataaction/getTree"),
            countUrl: epoint.dealRestfulUrl('exundataaction/getMsgCount'),
            websocketUrl: "../../../../../websocket/eXun",
            historyUrl: "frame/pages/basic/communication/exun/exunmsg",
            groupImg: "../../../js/widgets/emsg/images/emsg-group-bg.png",
            userImg: "../../../js/widgets/emsg/images/emsg-user-error.jpg",
            // 发送邮件的地址，如果配置了将显示E讯窗口上方显示发送邮件 经在URL后自动拼接收件人guid，多个以“;”分隔
            // 约定 如果有多人，参数名为ToUserGuidList 一个人则参数名为ToUserGuid
            sendEmailUrl: '',
            showErrorMsg: true,
            // 是否直接使用回车键发送？
        };

        var onlineUserIframe = document.getElementById('online-user');
        // 在线人员选项卡配置
        var OnlineUserSettings = {
            // 是否显示
            show: false,
            // 对应页面地址
            url: '../../../../../framemanager/orga/orga/user/onlineuser',
            // 每次显示E讯面板时都会触发该方法
            onRefreshData: function (callback) {
                // 调用在线人员页面中的刷新数据方法
                // 同时tab上的在线人数需要更新，但考虑到获取数据是异步操作，所以需要在refreshData方法中获取到在线人数后调用callback方法
                try {
                    onlineUserIframe.contentWindow.refreshData(callback);
                } catch (e) {
                    console.error(e);
                }
            }
        };
    </script>
    <script>
        SrcBoot.output([
            // 数据模拟
            // 'frame/fui/js/libs/mock-min.js',
            // 'frame/fui/pages/themes/imac/test/_testimac.js',
            // end
            'frame/fui/js/widgets/classifysearch/classifysearch.js',
            'frame/fui/js/widgets/msgcenter/msgcenter.js',
            'frame/fui/pages/themes/imac/imac' + (SrcBoot.debug ? '' : '.min') + '.js'
        ]);
    </script>

</body>

</html>