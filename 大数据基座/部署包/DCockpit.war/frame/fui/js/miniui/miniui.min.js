/**
* jQuery MiniUI v3.0
* 
* Web Site : http://www.miniui.com
*
* Commercial License : http://www.miniui.com/license
*
* Copyright(c) 2012 All Rights Reserved. Shanghai PusSoft Co., Ltd (上海普加软件有限公司) [ services@plusoft.com.cn ]. 
* 
*/
mini={components:{},uids:{},ux:{},doc:document,window:window,isReady:!1,createTime:new Date,byClass:function(a,b){"string"==typeof b&&(b=mini.byId(b));return jQuery("."+a,b)[0]},getComponents:function(){var a=[],b;for(b in mini.components){var c=mini.components[b];c.isControl&&a.push(c)}return a},get:function(a){if(!a)return null;if(mini.isControl(a))return a;"string"==typeof a&&"#"==a.charAt(0)&&(a=a.substr(1));if("string"==typeof a)return mini.components[a];var b=mini.uids[a.uid];return b&&b.el==a?b:null},getbyUID:function(a){return mini.uids[a]},findControls:function(a,b){if(!a)return[];b=b||mini;var c=[],d=mini.uids,e;for(e in d){var f=d[e],g=a.call(b,f);if(!0===g||1===g)if(c.push(f),1===g)break}return c},getChildControls:function(a){var b=a.el?a.el:a;return mini.findControls(function(c){return c.el&&a!=c?mini.isAncestor(b,c.el)&&c.within?!0:!1:!1})},emptyFn:function(){},createNameControls:function(a,b){if(a&&a.el){b||(b="_");for(var c=a.el,d=mini.findControls(function(a){return a.el&&a.name?mini.isAncestor(c,a.el)?!0:!1:!1}),e=0,f=d.length;e<f;e++){var g=d[e],k=b+g.name;!0===b&&(k=g.name[0].toUpperCase()+g.name.substring(1,g.name.length));a[k]=g}}},getsByName:function(a,b){return mini.getsbyName(a,b)},getsbyName:function(a,b){var c=mini.isControl(b),d=b;b&&c&&(b=b.el);b=(b=mini.byId(b))||document.body;var e=mini.findControls(function(c){return c.el?c.name==a&&mini.isAncestor(b,c.el)?!0:!1:!1},this);c&&0==e.length&&d&&d.getbyName&&(c=d.getbyName(a))&&e.push(c);return e},getbyName:function(a,b){return mini.getsbyName(a,b)[0]},getByName:function(a,b){return mini.getbyName(a,b)},getParams:function(a){a||(a=location.href);a=a.split("?")[1];var b={};if(a){a=a.split("\x26");for(var c=0,d=a.length;c<d;c++){var e=a[c].split("\x3d");try{b[e[0]]=decodeURIComponent(unescape(e[1]))}catch(f){}}}return b},reg:function(a){this.components[a.id]=a;this.uids[a.uid]=a},unreg:function(a){delete mini.components[a.id];delete mini.uids[a.uid]},classes:{},uiClasses:{},getClass:function(a){return a?this.classes[a.toLowerCase()]:null},getClassByUICls:function(a){return this.uiClasses[a.toLowerCase()]},idPre:"mini-",idIndex:1,newId:function(a){return(a||this.idPre)+this.idIndex++},copyTo:function(a,b){if(a&&b)for(var c in b)a[c]=b[c];return a},copyIf:function(a,b){if(a&&b)for(var c in b)mini.isNull(a[c])&&(a[c]=b[c]);return a},createDelegate:function(a,b){return a?function(){return a.apply(b,arguments)}:function(){}},isControl:function(a){return!(!a||!a.isControl)},isElement:function(a){return a&&a.appendChild},isDate:function(a){return!(!a||!a.getFullYear)},isArray:function(a){return!(!a||!a.unshift)},isNull:function(a){return null===a||void 0===a},isNumber:function(a){return!isNaN(a)&&"number"==typeof a},isEquals:function(a,b){return 0===a||0===b||!mini.isNull(a)&&""!=a||!mini.isNull(b)&&""!=b?a&&b&&a.getFullYear&&b.getFullYear?a.getTime()===b.getTime():"object"==typeof a&&"object"==typeof b?a===b:String(a)===String(b):!0},forEach:function(a,b,c){for(var d=a.clone(),e=0,f=d.length;e<f&&!1!==b.call(c,d[e],e,a);e++);},sort:function(a,b,c){c=0;for(var d=a.length,e;c<d;c++)for(e=c;e<d;e++){var f=a[e];0<b(a[c],f)&&(a.removeAt(e),a.insert(c,f))}},elWarp:document.createElement("div")};"undefined"==typeof mini_debugger&&(mini_debugger=!0);"undefined"==typeof mini_useShims&&(mini_useShims=!1);"undefined"==typeof mini_ajaxAsyncInvoke&&(mini_ajaxAsyncInvoke=!0);mini_regClass=function(a,b){b=b.toLowerCase();mini.classes[b]||(mini.classes[b]=a,a.prototype.type=b);var c=a.prototype.uiCls;mini.isNull(c)||mini.uiClasses[c]||(mini.uiClasses[c]=a)};mini_extend=function(a,b,c){if("function"!=typeof b)return this;var d=a.prototype,e=b.prototype;if(a.superclass!=e){a.superclass=e;a.superclass.constructor=b;for(var f in e)d[f]=e[f];if(c)for(f in c)d[f]=c[f];return a}};mini.copyTo(mini,{extend:mini_extend,regClass:mini_regClass,debug:!1});mini.namespace=function(a){if("string"==typeof a){a=a.split(".");for(var b=window,c=0,d=a.length;c<d;c++){var e=a[c],f=b[e];f||(f=b[e]={});b=f}}};mini._BindCallbacks=[];mini._BindEvents=function(a,b){mini._BindCallbacks.push([a,b]);mini._EventTimer||(mini._EventTimer=setTimeout(function(){mini._FireBindEvents()},50))};mini._FireBindEvents=function(){for(var a=0,b=mini._BindCallbacks.length;a<b;a++){var c=mini._BindCallbacks[a];c[0].call(c[1])}mini._BindCallbacks=[];mini._EventTimer=null};mini._getFunctoin=function(a){if("string"!=typeof a)return null;a=a.split(".");for(var b=null,c=0,d=a.length;c<d;c++){var e=a[c],b=b?b[e]:window[e];if(!b)break}return b};var cacheParts={};function createPathParts(a){var b=cacheParts[a];if(!b){for(var b=a.split("."),c=0,d=b.length;c<d;c++){var e=b[c],f=e.indexOf("[");-1<f&&(b[c]=e.substr(0,f),b.splice(++c,0,parseInt(e.substr(f+1))))}cacheParts[a]=b}return b}function getValueByPath(a,b){if(a&&b){if(b in a)return a[b];for(var c=createPathParts(b),d=0,e=c.length;d<e&&a;d++)a=a[c[d]];return a}}mini._getMap=function(a,b){if(a&&b){var c=b[a];if(void 0!==c)return c;var d=a.indexOf(".");if(-1==d&&-1==a.indexOf("[")||d==a.length-1)return b[a];try{c=getValueByPath(b,a)}catch(e){return}return c}};mini._setMap=function(a,b,c){function d(a,b,c,d){var e=a[b];e||(e=a[b]=[]);for(var f=0;f<=c;f++)e[f]||(e[f]=null===d||void 0===d?{}:d);return a[b][c]}if(c&&"string"==typeof a){for(var e=a.split("."),f=null,g=0,k=e.length;g<=k-1;g++){a=e[g];if(g==k-1){-1==a.indexOf("]")?c[a]=b:(f=a.split("["),a=f[0],f=parseInt(f[1]),d(c,a,f,""),c[a][f]=b);break}-1==a.indexOf("]")?(f=c[a],g<=k-2&&null==f&&(c[a]=f={}),c=f):(f=a.split("["),a=f[0],f=parseInt(f[1]),c=d(c,a,f))}return b}};mini.getAndCreate=function(a){return a?"string"==typeof a?mini.components[a]:"object"==typeof a?mini.isControl(a)?a:mini.isElement(a)?mini.uids[a.uid]:mini.create(a):null:null};mini.create=function(a){if(!a)return null;if(mini.get(a.id)===a)return a;var b=this.getClass(a.type);if(!b)return null;b=new b;b.set(a);return b};mini.Component=function(){this._events={};this._id=this.uid=mini.newId(this._idPre);this.id||(this.id=this.uid);mini.reg(this)};mini.Component.prototype={isControl:!0,id:null,_idPre:"mini-",_idSet:!1,_canFire:!0,set:function(a){if("string"==typeof a)return this;var b=this._allowLayout;this._allowLayout=!1;var c=a.renderTo||a.render;delete a.renderTo;delete a.render;for(var d in a)if(0==d.toLowerCase().indexOf("on")&&!this["_$"+d]){var e=a[d];this.on(d.substring(2,d.length).toLowerCase(),e);delete a[d]}for(d in a){var e=a[d],f=this["set"+d.charAt(0).toUpperCase()+d.substring(1,d.length)];f?f.call(this,e):this[d]=e}c&&this.render&&this.render(c);this._allowLayout=b;this.doLayout&&this.doLayout();return this},fire:function(a,b){if(0!=this._canFire){a=a.toLowerCase();var c=this._events[a];if(c){b||(b={});b&&b!=this&&(b.source=b.sender=this,b.type||(b.type=a));for(var d=0,e=c.length;d<e;d++){var f=c[d];f&&f[0].apply(f[1],[b])}}}},on:function(a,b,c){if("string"==typeof b){var d=mini._getFunctoin(b);d?b=d:(d=mini.newId("__str_"),window[d]=b,b=new Function("e","var s \x3d "+d+";var fn \x3d mini._getFunctoin(s); if(fn) {fn.call(this, e)}else{eval(s);}"))}if("function"!=typeof b||!a)return!1;a=a.toLowerCase();(d=this._events[a])||(d=this._events[a]=[]);c=c||this;this.findListener(a,b,c)||d.push([b,c]);return this},un:function(a,b,c){a=a.toLowerCase();var d=this._events[a];d&&(b?(a=this.findListener(a,b,c||this))&&d.remove(a):delete this._events[a]);return this},findListener:function(a,b,c){a=a.toLowerCase();c=c||this;if(a=this._events[a])for(var d=0,e=a.length;d<e;d++){var f=a[d];if(f[0]===b&&f[1]===c)return f}},setId:function(a){if(!a)throw Error("id not null");if(this._idSet)throw Error("id just set only one");mini.unreg(this);this.id=a;this.el&&(this.el.id=a);this._valueEl&&(this._valueEl.id=a+"$value");this._textEl&&(this._textEl.id=a+"$text");this._idSet=!0;mini.reg(this)},getId:function(){return this.id},destroy:function(){mini.unreg(this);this.fire("destroy");this._events={}}};mini.Control=function(a){mini.Control.superclass.constructor.apply(this,arguments);this._create();this.el.uid=this.uid;this._initEvents();this._clearBorder&&(this.el.style.borderWidth="0");this.addCls(this.uiCls);this.setWidth(this.width);this.setHeight(this.height);this.el.style.display=this.visible?this._displayStyle:"none";a&&mini.applyTo.call(this,a)};mini.extend(mini.Control,mini.Component,{jsName:null,width:"",height:"",visible:!0,readOnly:!1,enabled:!0,tooltip:"",_readOnlyCls:"mini-readonly",_disabledCls:"mini-disabled",_create:function(){this.el=document.createElement("div")},_initEvents:function(){},within:function(a){return mini.isAncestor(this.el,a.target)?!0:!1},name:"",setName:function(a){this.name=a},getName:function(){return this.name},isAutoHeight:function(){var a=this.el.style.height;return"auto"==a||""==a},isAutoWidth:function(){var a=this.el.style.width;return"auto"==a||""==a},isFixedSize:function(){var a=this.width,b=this.height;return parseInt(a)+"px"==a&&parseInt(b)+"px"==b?!0:!1},isRender:function(a){return!!(this.el&&this.el.parentNode&&this.el.parentNode.tagName)},render:function(a,b){"string"===typeof a&&(a="#body"==a?document.body:mini.byId(a));a&&(b||(b="append"),b=b.toLowerCase(),"before"==b?jQuery(a).before(this.el):"prepend"==b?jQuery(a).prepend(this.el):"after"==b?jQuery(a).after(this.el):a.appendChild(this.el),this.el.id=this.id,this.doLayout(),this.fire("render"))},getEl:function(){return this.el},setJsName:function(a){this.jsName=a;window[a]=this},getJsName:function(){return this.jsName},setTooltip:function(a){this.tooltip=a;this.el.title=a;this.tooltipPlacement&&jQuery(this.el).attr("data-placement",this.tooltipPlacement)},getTooltip:function(){return this.tooltip},_sizeChanged:function(){this.doLayout()},setWidth:function(a){parseInt(a)==a&&(a+="px");this.width=a;this.el.style.width=a;this._sizeChanged()},getWidth:function(a){var b=this.el,b=a?jQuery(b).width():jQuery(b).outerWidth();a&&this._borderEl&&(a=mini.getBorders(this._borderEl),b=b-a.left-a.right);return b},setHeight:function(a){parseInt(a)==a&&(a+="px");this.height=a;this.el.style.height=a;this._sizeChanged()},getHeight:function(a){var b=a?jQuery(this.el).height():jQuery(this.el).outerHeight();a&&this._borderEl&&(a=mini.getBorders(this._borderEl),b=b-a.top-a.bottom);return b},getBox:function(){return mini.getBox(this.el)},setBorderStyle:function(a){mini.setStyle(this._borderEl||this.el,a);this.doLayout()},getBorderStyle:function(){return this.borderStyle},_clearBorder:!0,setStyle:function(a){this.style=a;mini.setStyle(this.el,a);this._clearBorder&&(this.el.style.borderWidth="0",this.el.style.padding="0px");this.width=this.el.style.width;this.height=this.el.style.height;this._sizeChanged()},getStyle:function(){return this.style},setCls:function(a){this.addCls(a)},getCls:function(){return this.cls},addCls:function(a){mini.addClass(this.el,a)},removeCls:function(a){mini.removeClass(this.el,a)},_doReadOnly:function(){this.readOnly?this.addCls(this._readOnlyCls):this.removeCls(this._readOnlyCls)},setReadOnly:function(a){this.readOnly=a;this._doReadOnly()},getReadOnly:function(){return this.readOnly},getParent:function(a){for(var b=document,c=this.el.parentNode;c!=b&&null!=c;){var d=mini.get(c);if(d){if(!mini.isControl(d))break;if(!a||d.uiCls==a)return d}c=c.parentNode}return null},isReadOnly:function(){if(this.readOnly||!this.enabled)return!0;var a=this.getParent();return a?a.isReadOnly():!1},setEnabled:function(a){(this.enabled=a)?this.removeCls(this._disabledCls):this.addCls(this._disabledCls);this._doReadOnly()},getEnabled:function(){return this.enabled},enable:function(){this.setEnabled(!0)},disable:function(){this.setEnabled(!1)},_displayStyle:"",setVisible:function(a){this.visible=a;this.el&&(this.el.style.display=a?this._displayStyle:"none",this.doLayout())},getVisible:function(){return this.visible},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},isDisplay:function(a){if(0==mini.WindowVisible||!this.el)return!1;for(var b=document.body,c=this.el;;){if(null==c||!c.style)return!1;if(c&&c.style&&"none"==c.style.display)if(a){if(!0!==a(c))return!1}else return!1;if(c==b)break;c=c.parentNode}return!0},_allowUpdate:!0,beginUpdate:function(){this._allowUpdate=!1},endUpdate:function(){this._allowUpdate=!0;this.doUpdate()},doUpdate:function(){},canLayout:function(){return mini.enableLayout&&0!=this._allowLayout?this.isDisplay():!1},doLayout:function(){},layoutChanged:function(){0!=this.canLayout()&&this.doLayout()},_destroyChildren:function(a){if(this.el)for(var b=mini.getChildControls(this),c=0,d=b.length;c<d;c++){var e=b[c];!0!==e.destroyed&&e.destroy(a)}},destroy:function(a){!0!==this.destroyed&&(mini._destroying||this._destroyChildren(a));if(this.el){var b=this.el;b.onclick=b.ondblclick=b.onmousedown=b.onmouseup=b.onmousemove=b.onmouseover=b.onmouseout=b.onkeydown=b.onkeyup=b.oncontextmenu=null;mini.clearEvent(b);!1!==a&&mini.removeNode(b)}this.el=this._borderEl=this._contentEl=this._valueEl=this._textEl=this._errorIconEl=null;mini.unreg(this);this.destroyed=!0;this.fire("destroy")},focus:function(){try{this.el.focus()}catch(a){}},blur:function(){try{this.el.blur()}catch(a){}},allowAnim:!0,setAllowAnim:function(a){this.allowAnim=a},getAllowAnim:function(){return this.allowAnim},_getMaskWrapEl:function(){return this.el},mask:function(a){"string"==typeof a&&(a={html:a});a=a||{};a.el=this._getMaskWrapEl();a.cls||(a.cls=this._maskCls);mini.mask(a)},unmask:function(){mini.unmask(this._getMaskWrapEl());this.isLoading=!1},_maskCls:"mini-mask-loading",loadingMsg:"Loading...",loading:function(a){this.mask(a||this.loadingMsg)},setLoadingMsg:function(a){this.loadingMsg=a},getLoadingMsg:function(){return this.loadingMsg},_getContextMenu:function(a){var b=a;"string"==typeof a?(b=mini.get(a),b||(mini.parse(a),b=mini.get(a))):mini.isArray(a)?b={type:"menu",items:a}:mini.isControl(a)||(b=mini.create(a));return b},__OnHtmlContextMenu:function(a){var b={popupEl:this.el,htmlEvent:a,cancel:!1};this.contextMenu.fire("BeforeOpen",b);if(1!=b.cancel&&(this.contextMenu.fire("opening",b),1!=b.cancel))return this.contextMenu.showAtPos(a.pageX,a.pageY),this.contextMenu.fire("Open",b),!1},contextMenu:null,setContextMenu:function(a){(a=this._getContextMenu(a))&&this.contextMenu!==a&&(this.contextMenu=a,mini.addClass(a.el,"mini-menu-open"),this.contextMenu.owner=this,mini.on(this.el,"contextmenu",this.__OnHtmlContextMenu,this))},getContextMenu:function(){return this.contextMenu},setDefaultValue:function(a){this.defaultValue=a},getDefaultValue:function(){return this.defaultValue},setValue:function(a){this.value=a},getValue:function(){return this.value},ajaxData:null,ajaxType:"",ajaxOptions:null,setAjaxOptions:function(a){this.ajaxOptions=a},getAjaxOptions:function(){return this.ajaxOptions},setAjaxData:function(a){this.ajaxData=a},getAjaxData:function(){return this.ajaxData},setAjaxType:function(a){this.ajaxType=a},getAjaxType:function(){return this.ajaxType},_afterApply:function(a){},dataField:"",setDataField:function(a){this.dataField=a},getDataField:function(){return this.dataField},tabIndex:0,setTabIndex:function(a){this.tabIndex=(this._textEl||this.el).tabIndex=a},getTabIndex:function(){return this.tabIndex},getAttrs:function(a){var b={},c=a.className;c&&(b.cls=c);a.value&&(b.value=a.value);mini._ParseString(a,b,"id name width height borderStyle value defaultValue tabIndex contextMenu tooltip ondestroy data-options ajaxData ajaxType dataField ajaxOptions data-placement".split(" "));b["data-placement"]&&(this.tooltipPlacement=b["data-placement"]);mini._ParseBool(a,b,["visible","enabled","readOnly"]);a.readOnly&&"false"!=a.readOnly&&(b.readOnly=!0);if(c=a.style.cssText)b.style=c;isIE9&&(c=a.style.background)&&(b.style||(b.style=""),b.style+=";background:"+c);this.style&&(b.style=b.style?this.style+";"+b.style:this.style);this.borderStyle&&(b.borderStyle=b.borderStyle?this.borderStyle+";"+b.borderStyle:this.borderStyle);"string"==typeof b.ajaxOptions&&(b.ajaxOptions=window.eval("("+b.ajaxOptions+")"));if(c=mini._attrs)for(var d=0,e=c.length;d<e;d++){var f=c[d],g=f[0];(f=f[1])||(f="string");"string"==f?mini._ParseString(a,b,[g]):"bool"==f?mini._ParseBool(a,b,[g]):"int"==f&&mini._ParseInt(a,b,[g])}(a=b["data-options"])&&(a=window.eval("("+a+")"))&&mini.copyTo(b,a);return b}});mini._attrs=null;mini.regHtmlAttr=function(a,b){a&&(b||(b="string"),mini._attrs||(mini._attrs=[]),mini._attrs.push([a,b]))};__mini_setControls=function(a,b,c){b=b||this._contentEl;c=c||this;a||(a=[]);mini.isArray(a)||(a=[a]);for(var d=0,e=a.length;d<e;d++){var f=a[d];"string"==typeof f?0==f.indexOf("#")&&(f=mini.byId(f)):mini.isElement(f)||(f=mini.getAndCreate(f),f=f.el);f&&mini.append(b,f)}mini.parse(b);c.doLayout();return c};mini.Container=function(){mini.Container.superclass.constructor.apply(this,arguments);this._contentEl||(this._contentEl=this.el)};mini.extend(mini.Container,mini.Control,{setControls:__mini_setControls,getContentEl:function(){return this._contentEl},getBodyEl:function(){return this._contentEl},within:function(a){if(mini.isAncestor(this.el,a.target))return!0;for(var b=mini.getChildControls(this),c=0,d=b.length;c<d;c++)if(b[c].within(a))return!0;return!1}});mini.ValidatorBase=function(){mini.ValidatorBase.superclass.constructor.apply(this,arguments)};mini.extend(mini.ValidatorBase,mini.Control,{required:!1,requiredErrorText:"This field is required.",_requiredCls:"mini-required",errorText:"",_errorCls:"mini-error",_invalidCls:"mini-invalid",errorMode:"icon",validateOnChanged:!0,validateOnLeave:!0,_IsValid:!0,forceValidate:!1,setForceValidate:function(a){this.forceValidate=a},getForceValidate:function(){return this.forceValidate},keyNavEnabled:!0,setKeyNavEnabled:function(a){this.keyNavEnabled=a},getKeyNavEnabled:function(){return this.keyNavEnabled},indentSpace:!1,_indentCls:"mini-indent",setIndentSpace:function(a){a?this.addCls(this._indentCls):this.removeCls(this._indentCls);this.indentSpace=a},getIndentSpace:function(){return this.indentSpace},isEditable:function(){return!this.readOnly&&this.allowInput&&this.enabled?!0:!1},_tryValidate:function(){this._tryValidateTimer&&clearTimeout(this._tryValidateTimer);var a=this;this._tryValidateTimer=setTimeout(function(){a.validate()},30)},validate:function(){var a={value:this.getValue(),errorText:"",isValid:!0};this.required&&(mini.isNull(a.value)||""===String(a.value).trim())&&(a.isValid=!1,a.errorText=this.requiredErrorText);this.fire("validation",a);this.errorText=a.errorText;this.setIsValid(a.isValid);return this.isValid()},isValid:function(){return this._IsValid},setIsValid:function(a){this._IsValid=a;this.doUpdateValid()},getIsValid:function(){return this._IsValid},setValidateOnChanged:function(a){this.validateOnChanged=a},getValidateOnChanged:function(a){return this.validateOnChanged},setValidateOnLeave:function(a){this.validateOnLeave=a},getValidateOnLeave:function(a){return this.validateOnLeave},setErrorMode:function(a){a||(a="none");this.errorMode=a.toLowerCase();0==this._IsValid&&this.doUpdateValid()},getErrorMode:function(){return this.errorMode},setErrorText:function(a){this.errorText=a;0==this._IsValid&&this.doUpdateValid()},getErrorText:function(){return this.errorText},setRequired:function(a){(this.required=a)?this.addCls(this._requiredCls):this.removeCls(this._requiredCls)},getRequired:function(){return this.required},setRequiredErrorText:function(a){this.requiredErrorText=a},getRequiredErrorText:function(){return this.requiredErrorText},errorIconEl:null,getErrorIconEl:function(){return this._errorIconEl},_RemoveErrorIcon:function(){},doUpdateValid:function(){this.__doUpdateValid()},errorTooltipPlacement:"right",__doUpdateValid:function(){if(this.el){this.removeCls(this._errorCls);this.removeCls(this._invalidCls);"border"==this.errorMode&&(this.el.title="");if(0==this._IsValid)switch(this.errorMode){case "icon":this.addCls(this._errorCls);var a=this.getErrorIconEl();a&&(a.title=this.errorText,jQuery(a).attr("data-placement",this.errorTooltipPlacement));break;case "border":this.addCls(this._invalidCls),this.el.title=this.errorText;default:this._RemoveErrorIcon()}else this._RemoveErrorIcon();this.doLayout()}},doValueChanged:function(){this._OnValueChanged()},_OnValueChanged:function(){this.validateOnChanged&&this._tryValidate();this.fire("valuechanged",{value:this.getValue(),oldValue:this._oldValue});this._oldValue=this.getValue()},onValueChanged:function(a,b){this.on("valuechanged",a,b)},onValidation:function(a,b){this.on("validation",a,b)},getAttrs:function(a){var b=mini.ValidatorBase.superclass.getAttrs.call(this,a);mini._ParseString(a,b,"onvaluechanged onvalidation label labelStyle requiredErrorText errorMode errorTooltipPlacement".split(" "));mini._ParseBool(a,b,"validateOnChanged validateOnLeave labelField indentSpace keyNavEnabled forceValidate".split(" "));var c=a.getAttribute("required");c||(c=a.required);c||(a=a.attributes.required)&&(c="null"==a.value?null:"true");c&&(b.required="false"!=c?!0:!1);return b},_labelLayout:function(){var a=this._borderEl;if(a)if(this._labelLayouted=!0,this.labelField){var b=this._labelEl.offsetWidth;a.style.marginLeft=b+"px";this._doLabelLayout=0===b}else a.style.marginLeft=0},_labelFieldCls:"mini-labelfield",labelField:!1,label:"",labelStyle:"",setLabelField:function(a){this.labelField!=a&&(this.labelField=a,this._borderEl&&(this._labelEl||(this._labelEl=mini.append(this.el,'\x3clabel class\x3d"mini-labelfield-label"\x3e\x3c/label\x3e'),this._labelEl.innerHTML=this.label,mini.setStyle(this._labelEl,this.labelStyle)),this._labelEl.style.display=a?"block":"none",a?mini.addClass(this.el,this._labelFieldCls):mini.removeClass(this.el,this._labelFieldCls),this._labelLayout()))},getLabelField:function(){this.labelField},setLabel:function(a){this.label!=a&&(this.label=a,this._labelEl&&(this._labelEl.innerHTML=a),this._labelLayout())},getLabel:function(){this.label},setLabelStyle:function(a){this.labelStyle!=a&&(this.labelStyle=a,this._labelEl&&mini.setStyle(this._labelEl,a),this._labelLayout())},getLabelStyle:function(){this.labelStyle}});mini.ListControl=function(a){this.data=[];this._selecteds=[];mini.ListControl.superclass.constructor.call(this,null);this.doUpdate();a&&mini.applyTo.call(this,a)};mini.ListControl.ajaxType="get";mini.extend(mini.ListControl,mini.ValidatorBase,{defaultValue:"",value:"",valueField:"id",textField:"text",dataField:"",delimiter:",",setDelimiter:function(a){this.delimiter=a},getDelimiter:function(){return this.delimiter},data:null,url:"",valueInCheckOrder:!0,setValueInCheckOrder:function(a){this.valueInCheckOrder=a},getValueInCheckOrder:function(){return this.valueInCheckOrder},_itemCls:"mini-list-item",_itemHoverCls:"mini-list-item-hover",_itemSelectedCls:"mini-list-item-selected",doLayout:function(){this._doLabelLayout&&this._labelLayout()},set:function(a){if("string"==typeof a)return this;var b=a.value;delete a.value;var c=a.url;delete a.url;var d=a.data;delete a.data;mini.ListControl.superclass.set.call(this,a);mini.isNull(d)||this.setData(d);mini.isNull(c)||this.setUrl(c);mini.isNull(b)||this.setValue(b);return this},uiCls:"mini-list",_create:function(){},_initEvents:function(){mini._BindEvents(function(){mini_onOne(this.el,"click",this.__OnClick,this);mini_onOne(this.el,"dblclick",this.__OnDblClick,this);mini_onOne(this.el,"mousedown",this.__OnMouseDown,this);mini_onOne(this.el,"mouseup",this.__OnMouseUp,this);mini_onOne(this.el,"mousemove",this.__OnMouseMove,this);mini_onOne(this.el,"mouseover",this.__OnMouseOver,this);mini_onOne(this.el,"mouseout",this.__OnMouseOut,this);mini_onOne(this.el,"keydown",this.__OnKeyDown,this);mini_onOne(this.el,"keyup",this.__OnKeyUp,this);mini_onOne(this.el,"contextmenu",this.__OnContextMenu,this)},this)},destroy:function(a){mini.ListControl.superclass.destroy.call(this,a)},name:"",setName:function(a){this.name=a;this._valueEl&&mini.setAttr(this._valueEl,"name",this.name)},getItemByEvent:function(a){if(a=mini.findParent(a.target,this._itemCls))return a=parseInt(mini.getAttr(a,"index")),this.data[a]},addItemCls:function(a,b){var c=this.getItemEl(a);c&&mini.addClass(c,b)},removeItemCls:function(a,b){var c=this.getItemEl(a);c&&mini.removeClass(c,b)},getItemEl:function(a){a=this.getItem(a);a=this.data.indexOf(a);a=this._createItemId(a);return document.getElementById(a)},_focusItem:function(a,b){if(a=this.getItem(a)){var c=this.getItemEl(a);b&&c&&this.scrollIntoView(a);this._focusedItem!=a&&(this._blurItem(),this._focusedItem=a);c&&mini.addClass(c,this._itemHoverCls)}},_blurItem:function(){if(this._focusedItem){var a=this.getItemEl(this._focusedItem);a&&mini.removeClass(a,this._itemHoverCls);this._focusedItem=null}},getFocusedItem:function(){var a=this._focusedItem;return-1==this.indexOf(a)?null:a},getFocusedIndex:function(){return this.data.indexOf(this._focusedItem)},_scrollViewEl:null,scrollIntoView:function(a){try{var b=this.getItemEl(a);mini.scrollIntoView(b,this._scrollViewEl||this.el,!1)}catch(c){}},getItem:function(a){return"object"==typeof a?a:"number"==typeof a?this.data[a]:this.findItems(a)[0]},getCount:function(){return this.data.length},indexOf:function(a){return this.data.indexOf(a)},getAt:function(a){return this.data[a]},updateItem:function(a,b){if(a=this.getItem(a))mini.copyTo(a,b),this.doUpdate()},load:function(a){"string"==typeof a?this.setUrl(a):this.setData(a)},loadData:function(a){this.setData(a)},setData:function(a){"string"==typeof a&&(a=window.eval(a));mini.isArray(a)||(a=[]);this.data=a;this.doUpdate();""!=this.value&&(this.deselectAll(),a=this.findItems(this.value),this.selects(a))},getData:function(){return this.data.clone()},setUrl:function(a){this.url=a;this._doLoad({})},getUrl:function(){return this.url},ajaxData:null,_doLoad:function(a){try{var b=window.eval(this.url);void 0!=b&&(this.url=b)}catch(g){}var b=this.url,c=mini.ListControl.ajaxType;!b||-1==b.indexOf(".txt")&&-1==b.indexOf(".json")||(c="get");var d=mini._evalAjaxData(this.ajaxData,this);mini.copyTo(a,d);var e={url:this.url,async:!1,type:this.ajaxType?this.ajaxType:c,data:a,params:a,cache:!1,cancel:!1};jQuery.extend(!0,e,this.ajaxOptions);this.fire("beforeload",e);e.data!=e.params&&e.params!=a&&(e.data=e.params);if(1!=e.cancel){var f=me=this,b=e.url;mini.copyTo(e,{success:function(a,c,d){delete e.params;c={text:a,result:null,sender:me,options:e,xhr:d};d=null;try{mini_doload(c),(d=c.result)||(d=mini.decode(a))}catch(n){1==mini_debugger&&alert(b+"\njson is error.")}mini.isArray(d)&&(d={data:d});f.dataField&&(d.data=mini._getMap(f.dataField,d));d.data||(d.data=[]);a={data:d.data,cancel:!1,result:d};f.fire("preload",a);1!=a.cancel&&(f.setData(a.data),delete a.cancel,f.fire("load",a),setTimeout(function(){f.doLayout()},100))},error:function(a,c,d){a={xhr:a,text:a.responseText,textStatus:c,errorMsg:a.responseText,errorCode:a.status};1==mini_debugger&&alert(b+"\n"+a.errorCode+"\n"+a.errorMsg);f.fire("loaderror",a)}});this._ajaxer=mini.ajax(e)}},setValue:function(a){mini.isNull(a)&&(a="");this.deselectAll();this.value=a;this._valueEl&&(this._valueEl.value=a);a=this.findItems(this.value);this.selects(a);this.setSelected(a[0])},getValue:function(){return this.value},getFormValue:function(){return this.value},setValueField:function(a){this.valueField=a},getValueField:function(){return this.valueField},setTextField:function(a){this.textField=a},getTextField:function(){return this.textField},getItemValue:function(a){return String(mini._getMap(this.valueField,a))},getItemText:function(a){a=mini._getMap(this.textField,a);return mini.isNull(a)?"":String(a)},getValueAndText:function(a){mini.isNull(a)&&(a=[]);mini.isArray(a)||(a=this.findItems(a));if(this.valueInCheckOrder){var b=this.getData();mini.sort(a,function(a,c){var d=b.indexOf(a),e=b.indexOf(c);return d>e?1:d<e?-1:0})}for(var c=[],d=[],e=0,f=a.length;e<f;e++){var g=a[e];g&&(c.push(this.getItemValue(g)),d.push(this.getItemText(g)))}return[c.join(this.delimiter),d.join(this.delimiter)]},findItems:function(a){if(mini.isNull(a)||""===a)return[];if("function"==typeof a){for(var b=[],c=this.data,d=0,e=c.length;d<e;d++){var f=c[d];!0===a(f,d)&&b.push(f)}return b}a=String(a).split(this.delimiter);c=this.data;b={};d=0;for(e=c.length;d<e;d++){var f=c[d],g=mini._getMap(this.valueField,f);b[g]=f}c=[];d=0;for(e=a.length;d<e;d++)g=a[d],(f=b[g])&&c.push(f);return c},removeAll:function(){var a=this.getData();this.removeItems(a)},addItems:function(a,b){mini.isArray(a)&&(mini.isNull(b)&&(b=this.data.length),this.data.insertRange(b,a),this.doUpdate())},addItem:function(a,b){a&&-1==this.data.indexOf(a)&&(mini.isNull(b)&&(b=this.data.length),this.data.insert(b,a),this.doUpdate())},removeItems:function(a){mini.isArray(a)&&(this.data.removeRange(a),this._checkSelecteds(),this.doUpdate())},removeItem:function(a){a=this.data.indexOf(a);-1!=a&&(this.data.removeAt(a),this._checkSelecteds(),this.doUpdate())},moveItem:function(a,b){a&&mini.isNumber(b)&&(0>b&&(b=0),b>this.data.length&&(b=this.data.length),this.data.remove(a),this.data.insert(b,a),this.doUpdate())},_isSelectedAll:function(){for(var a=this.getData(),b=0,c=a.length;b<c;b++){var d=a[b];if(!1!==d.enabled&&!this.isSelected(d))return!1}return!0},_selected:null,_selecteds:[],multiSelect:!1,_checkSelecteds:function(){for(var a=this._selecteds.length-1;0<=a;a--)-1==this.data.indexOf(this._selecteds[a])&&this._selecteds.removeAt(a);this._selected&&-1==this.data.indexOf(this._selected)&&(this._selected=null);this.value=this.getValueAndText(this._selecteds)[0];this._valueEl&&(this._valueEl.value=this.value)},setMultiSelect:function(a){this.multiSelect=a},getMultiSelect:function(){return this.multiSelect},isSelected:function(a){return a?-1!=this._selecteds.indexOf(a):!1},getSelecteds:function(){var a=this._selecteds.clone(),b=this;this.valueInCheckOrder&&mini.sort(a,function(a,d){var c=b.indexOf(a),f=b.indexOf(d);return c>f?1:c<f?-1:0});return a},setSelected:function(a){a&&(this._selected=a,this.select(a))},getSelected:function(){return this._selected},select:function(a){(a=this.getItem(a))&&!this.isSelected(a)&&(this._selected=a,this.selects([a]))},deselect:function(a){(a=this.getItem(a))&&this.isSelected(a)&&this.deselects([a])},selectAll:function(){var a=this.data.clone();this.selects(a)},deselectAll:function(){this.deselects(this._selecteds)},clearSelect:function(){this.deselectAll()},selects:function(a){if(a&&0!=a.length){a=a.clone();0==this.multiSelect&&1<a.length&&(a.length=1);for(var b=0,c=a.length;b<c;b++){var d=a[b];this.isSelected(d)||this._selecteds.push(d)}this._doSelects()}},deselects:function(a){if(a&&0!=a.length){a=a.clone();for(var b=a.length-1;0<=b;b--){var c=a[b];this.isSelected(c)&&this._selecteds.remove(c)}this._doSelects()}},_doSelects:function(){this.value=this.getValueAndText(this._selecteds)[0];this._valueEl&&(this._valueEl.value=this.value);for(var a=0,b=this.data.length;a<b;a++){var c=this.data[a],d=this.isSelected(c);d?this.addItemCls(c,this._itemSelectedCls):this.removeItemCls(c,this._itemSelectedCls);c=this.data.indexOf(c);c=this._createCheckId(c);if(c=mini.byId(c,this.el))c.checked=!!d}},_OnSelectionChanged:function(a,b){this.value=this.getValueAndText(this._selecteds)[0];this._valueEl&&(this._valueEl.value=this.value);var c={selecteds:this.getSelecteds(),selected:this.getSelected(),value:this.getValue()};this.fire("SelectionChanged",c)},_createCheckId:function(a){return this.uid+"$ck$"+a},_createItemId:function(a){return this.uid+"$"+a},__OnClick:function(a){this._clickTime&&100>new Date-this._clickTime||(this._clickTime=new Date,this._fireEvent(a,"Click"))},__OnDblClick:function(a){this._fireEvent(a,"Dblclick")},__OnMouseDown:function(a){this._fireEvent(a,"MouseDown")},__OnMouseUp:function(a){this._fireEvent(a,"MouseUp")},__OnMouseMove:function(a){this._fireEvent(a,"MouseMove")},__OnMouseOver:function(a){this._fireEvent(a,"MouseOver")},__OnMouseOut:function(a){this._fireEvent(a,"MouseOut")},__OnKeyDown:function(a){this._fireEvent(a,"KeyDown")},__OnKeyUp:function(a){this._fireEvent(a,"KeyUp")},__OnContextMenu:function(a){this._fireEvent(a,"ContextMenu")},_fireEvent:function(a,b){if(this.enabled){var c=this.getItemByEvent(a);if(c){var d=this["_OnItem"+b];d?d.call(this,c,a):this.fire("item"+b,{item:c,htmlEvent:a})}}},allowDeselect:!1,setAllowDeselect:function(a){this.allowDeselect=a},getAllowDeselect:function(){return this.allowDeselect},_OnItemClick:function(a,b){if(this.isReadOnly()||0==this.enabled||!1===a.enabled)b.preventDefault();else{var c=this.getValue(),d={item:a,htmlEvent:b,cancel:!1};this.fire("beforeselect",d);b={item:a,htmlEvent:b,cancel:!1};this.fire("beforeitemclick",b);b.cancel||(0==d.cancel&&(this._oldValue=c,this.multiSelect?(this.isSelected(a)?(this.deselect(a),this._selected==a&&(this._selected=null)):(this.select(a),this._selected=a),a.__NullItem&&(this.deselectAll(),this._selected=null),this._OnSelectionChanged()):this.isSelected(a)?this.allowDeselect&&0==this.multiSelect&&(this.deselectAll(),this._OnSelectionChanged()):(this.deselectAll(),this.select(a),this._selected=a,this._OnSelectionChanged()),c!=this.getValue()&&this._OnValueChanged()),b={item:a,htmlEvent:b},this.fire("itemclick",b))}},_blurOnOut:!0,_OnItemMouseOut:function(a,b){this.enabled&&(this._blurOnOut&&this._blurItem(),b={item:a,htmlEvent:b},this.fire("itemmouseout",b))},_OnItemMouseMove:function(a,b){this.enabled&&!1!==a.enabled&&(this._focusItem(a),b={item:a,htmlEvent:b},this.fire("itemmousemove",b))},onItemClick:function(a,b){this.on("itemclick",a,b)},onItemMouseDown:function(a,b){this.on("itemmousedown",a,b)},onBeforeLoad:function(a,b){this.on("beforeload",a,b)},onLoad:function(a,b){this.on("load",a,b)},onLoadError:function(a,b){this.on("loaderror",a,b)},onPreLoad:function(a,b){this.on("preload",a,b)},getText:function(){var a=this.getSelecteds();if(0==a.length)return"";for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c],f=this.getTextField();b.push(e[f])}return b.join(",")},getAttrs:function(a){var b=mini.ListControl.superclass.getAttrs.call(this,a);mini._ParseString(a,b,"url data value textField valueField onitemclick onitemmousemove onselectionchanged onitemdblclick onbeforeload onload onloaderror ondataload onbeforeselect delimiter".split(" "));mini._ParseBool(a,b,["multiSelect","valueInCheckOrder","allowDeselect"]);var c=b.valueField||this.valueField,d=b.textField||this.textField;if("select"==a.nodeName.toLowerCase()){for(var e=[],f=0,g=a.length;f<g;f++){var k=a.options[f],l={};l[d]=k.text;l[c]=k.value;e.push(l)}0<e.length&&(b.data=e)}return b}});mini._Layouts={};mini.layout=function(a,b){function c(a){if(a){var d=mini.get(a);if(d)d.doLayout&&!mini._Layouts[d.uid]&&(mini._Layouts[d.uid]=d,!1===b&&0!=d.isFixedSize()||d.doLayout(!1),delete mini._Layouts[d.uid]);else if(a=a.childNodes)for(var d=0,f=a.length;d<f;d++){var g=a[d];try{g.toString()}catch(k){continue}c(g)}}}mini.enableLayout&&document.body&&(a||(a=document.body),c(a),a==document.body&&mini.layoutIFrames())};mini.applyTo=function(a){a=mini.byId(a);if(!a)return this;if(mini.get(a))throw Error("not applyTo a mini control");var b=this.getAttrs(a);delete b._applyTo;mini.isNull(b.defaultValue)&&!mini.isNull(b.value)&&(b.defaultValue=b.value);mini.isNull(b.defaultText)&&!mini.isNull(b.text)&&(b.defaultText=b.text);var c=a.parentNode;c&&this.el!=a&&c.replaceChild(this.el,a);window._mini_set&&_mini_set(b,this);this.set(b);this._afterApply(a);return this};mini._doParse=function(a){if(a){var b=a.nodeName.toLowerCase();if(b&&null==jQuery(a).attr("noparser")){var c=String(a.className);if(c&&!mini.get(a))for(var d=c.split(" "),c=0,e=d.length;c<e;c++){var f=d[c],g=mini.getClassByUICls(f);if(g){mini.removeClass(a,f);c=new g;mini.applyTo.call(c,a);a=c.el;break}}if(!("select"==b||mini.hasClass(a,"mini-menu")||mini.hasClass(a,"mini-datagrid")||mini.hasClass(a,"mini-treegrid")||mini.hasClass(a,"mini-tree")||mini.hasClass(a,"mini-button")||mini.hasClass(a,"mini-textbox")||mini.hasClass(a,"mini-buttonedit")))for(b=mini.getChildNodes(a,!0),c=0,e=b.length;c<e;c++)d=b[c],1==d.nodeType&&d.parentNode==a&&mini._doParse(d)}}};mini._Removes=[];mini._firstParse=!0;mini.parse=function(a,b){mini.parsed=!0;if(mini._firstParse){mini._firstParse=!1;for(var c=document.getElementsByTagName("iframe"),d=[],e=0,f=c.length;e<f;e++){var g=c[e];d.push(g)}e=0;for(f=d.length;e<f;e++)if(g=d[e],c=jQuery(g).attr("src"))g.loaded=!1,g._onload=g.onload,g._src=c,g.onload=function(){},g.src="";setTimeout(function(){for(var a=0,b=d.length;a<b;a++){var c=d[a];c._src&&""==jQuery(c).attr("src")&&(c.loaded=!0,c.onload=c._onload,c.src=c._src,c._src=c._onload=null)}},20);setTimeout(function(){for(var a=0,b=d.length;a<b;a++){var c=d[a],e=jQuery(c).attr("data-src");e&&(c.src=e)}},30)}"string"==typeof a&&(a=mini.byId(a),a||(a=document.body));a&&!mini.isElement(a)&&(a=a.el);a||(a=document.body);e=mini.WindowVisible;isIE&&(mini.WindowVisible=!1);mini._doParse(a);mini.WindowVisible=e;!1!==b&&mini.layout(a)};mini._ParseString=function(a,b,c){for(var d=0,e=c.length;d<e;d++){var f=c[d],g=mini.getAttr(a,f);g&&(b[f]=g)}};mini._ParseBool=function(a,b,c){for(var d=0,e=c.length;d<e;d++){var f=c[d],g=mini.getAttr(a,f);g&&(b[f]="true"==g?!0:!1)}};mini._ParseInt=function(a,b,c){for(var d=0,e=c.length;d<e;d++){var f=c[d],g=parseInt(mini.getAttr(a,f));isNaN(g)||(b[f]=g)}};mini._ParseColumns=function(a){var b=[];a=mini.getChildNodes(a);for(var c=0,d=a.length;c<d;c++){var e=a[c],f={},g=null,k=null,l=mini.getChildNodes(e);if(l)for(var n=0,p=l.length;n<p;n++){var q=l[n],r=mini.getAttr(q,"property");if(r&&(r=r.toLowerCase(),"columns"==r&&(f.columns=mini._ParseColumns(q),q.parentNode&&q.parentNode.removeChild(q)),"editor"==r||"filter"==r)){for(var t=q.className.split(" "),u=0,B=t.length;u<B;u++){var y=mini.getClassByUICls(t[u]);if(y){t=new y;"filter"==r?(k=t.getAttrs(q),k.type=t.type):(g=t.getAttrs(q),g.type=t.type);break}}q.parentNode&&q.parentNode.removeChild(q)}}f.header=e.innerHTML;mini._ParseString(e,f,"name header field editor filter renderer width type renderer headerAlign align headerCls cellCls headerStyle cellStyle displayField dateFormat listFormat mapFormat numberFormat trueValue falseValue dataType vtype currencyUnit summaryType summaryRenderer groupSummaryType groupSummaryRenderer defaultValue defaultText decimalPlaces data-options sortField sortType".split(" "));mini._ParseBool(e,f,"allowCellWrap visible readOnly allowSort allowResize allowMove allowDrag autoShowPopup unique autoEscape enabled hideable showCellTip valueFromSelect navUpdown".split(" "));mini._ParseInt(e,f,["minWidth"]);g&&(f.editor=g);k&&(f.filter=k);if("string"==typeof f.editor)try{f.editor=window.eval("("+f.editor+")")}catch(D){}f.dataType&&(f.dataType=f.dataType.toLowerCase());"true"===f.defaultValue&&(f.defaultValue=!0);"false"===f.defaultValue&&(f.defaultValue=!1);b.push(f);(e=f["data-options"])&&(e=window.eval("("+e+")"))&&mini.copyTo(f,e)}return b};mini._Columns={};mini._getColumn=function(a){return(a=mini._Columns[a.toLowerCase()])?a():{}};mini.IndexColumn=function(a){return mini.copyTo({ignoreCollapseIndex:!1,width:30,cellCls:"",align:"center",draggable:!1,allowDrag:!0,hideable:!0,init:function(a){a.on("addrow",this.__OnIndexChanged,this);a.on("removerow",this.__OnIndexChanged,this);a.on("moverow",this.__OnIndexChanged,this);a.isTree&&(a.on("addnode",this.__OnIndexChanged,this),a.on("removenode",this.__OnIndexChanged,this),a.on("movenode",this.__OnIndexChanged,this),a.on("loadnode",this.__OnIndexChanged,this),this._gridUID=a.uid,this._rowIdField="_id")},getNumberId:function(a){return this._gridUID+"$number$"+a[this._rowIdField]},createNumber:function(a,c){return mini.isNull(a.pageIndex)?c+1:a.pageIndex*a.pageSize+c+1},renderer:function(a){var b=a.sender;this.draggable&&(a.cellStyle||(a.cellStyle=""),a.cellStyle+=";cursor:move;");var d='\x3cdiv id\x3d"'+this.getNumberId(a.record)+'"\x3e';a=a.rowIndex;d=mini.isNull(b.getPageIndex)?d+(a+1):d+(b.getPageIndex()*b.getPageSize()+a+1);return d+"\x3c/div\x3e"},__updateRowNumbers:function(a){for(var b=a.getDataView(),d=0,e=b.length;d<e;d++){var f=this.getNumberId(b[d]);if(f=document.getElementById(f))f.innerHTML=this.createNumber(a,d)}},__OnIndexChanged:function(a){var b=a.sender,d=this;d._toIndex||(d._toIndex=setTimeout(function(){d._toIndex=null;d.__updateRowNumbers(b)},10))}},a)};mini._Columns.indexcolumn=mini.IndexColumn;mini.CheckColumn=function(a){return mini.copyTo({width:30,cellCls:"mini-checkcolumn",headerCls:"mini-checkcolumn",hideable:!0,_multiRowSelect:!0,header:function(a){a='\x3cspan class\x3d"mini-grid-checkbox mini-icon '+(a._checkedAll?"mini-grid-checkbox-checked":"")+'" id\x3d"'+(this.uid+"checkall")+'"\x3e\x3c/span\x3e';0==this.multiSelect&&(a="");return a},getCheckId:function(a,c){return this._gridUID+"$checkcolumn$"+a[this._rowIdField]+"$"+c._id},init:function(a){a.on("_selectchange",this.__OnSelectionChanged,this);a.on("HeaderCellClick",this.__OnHeaderCellClick,this);var b=this;a.on("removerow",function(){a.data&&0==a.data.length&&b._doCheckState(a)});b=this;a.on("load",function(){b._doCheckState(a)},this)},renderer:function(a){var b=this.getCheckId(a.record,a.column);a.sender.isSelected&&a.sender.isSelected(a.record);return'\x3cspan class\x3d"mini-grid-'+(a.sender.getMultiSelect()?"checkbox":"radio")+' mini-icon" id\x3d"'+b+'"\x3e\x3c/span\x3e'},__OnHeaderCellClick:function(a){var b=a.sender;if(a.column==this){var d=document.getElementById(b.uid+"checkall");d&&(this._checkedAll=a=!mini.hasClass(d,"mini-grid-checkbox-checked"),b.getMultiSelect()?a?(a=b.getDataView(),b.selects(a),mini.addClass(d,"mini-grid-checkbox-checked"),setTimeout(function(){mini.addClass(d,"mini-grid-checkbox-checked")},30)):(a=b.getDataView(),b.deselects(a),mini.removeClass(d,"mini-grid-checkbox-checked")):(b.deselectAll(),a&&(b.select(0),mini.addClass(d,"mini-grid-checkbox-checked"))),b.fire("checkall"))}},__OnSelectionChanged:function(a){var b=a.sender;a=b.toArray();var d=this,e=b.isVirtualScroll(),f=b._viewRegion,e=e&&f?f.start:-1,f=f?f.end:-1;if(-1!=e)for(b.getVisibleRows();e<f;e++);e=0;for(f=a.length;e<f;e++);this._timer||(this._timer=setTimeout(function(){d._doCheckState(b);d._timer=null},10))},_doCheckState:function(a){var b=document.getElementById(a.uid+"checkall");if(b){var d=a.getSelecteds();a=a.isTree?a.getList().length:a.getData().length;d.length==a&&0!=a?jQuery(b).addClass("mini-grid-checkbox-checked"):jQuery(b).removeClass("mini-grid-checkbox-checked")}}},a)};mini._Columns.checkcolumn=mini.CheckColumn;mini.ExpandColumn=function(a){return mini.copyTo({width:30,headerAlign:"center",align:"center",draggable:!1,cellStyle:"padding:0",cellCls:"mini-grid-expandCell",hideable:!0,renderer:function(a){return'\x3ca class\x3d"mini-grid-ecIcon mini-icon" href\x3d"javascript:#" onclick\x3d"return false"\x3e\x3c/a\x3e'},init:function(a){a.on("cellclick",this.__OnCellClick,this)},__OnCellClick:function(a){var b=a.sender;if(a.column==this&&b.isShowRowDetail&&mini.findParent(a.htmlEvent.target,"mini-grid-ecIcon")){var d=b.isShowRowDetail(a.record);d?(a.cancel=!1,b.fire("beforehiderowdetail",a)):(a.cancel=!1,b.fire("beforeshowrowdetail",a));!0!==a.cancel&&(b.autoHideRowDetail&&b.hideAllRowDetail(),d?b.hideRowDetail(a.record):b.showRowDetail(a.record))}}},a)};mini._Columns.expandcolumn=mini.ExpandColumn;mini.CheckBoxColumn=function(a){return mini.copyTo({_type:"checkboxcolumn",editMode:"inline",header:"",headerAlign:"center",trueValue:!0,falseValue:!1,readOnly:!1,getCheckId:function(a,c){return this._gridUID+"$checkbox$"+a[this._rowIdField]+"$"+c._id},getCheckBoxEl:function(a,c){return document.getElementById(this.getCheckId(a,c))},isChecked:function(a,c){var b=this.getCheckBoxEl(a,c);return jQuery(b).hasClass("mini-grid-checkbox-checked")},renderer:function(a){var b=this.getCheckId(a.record,a.column);a=mini._getMap(a.field,a.record)==this.trueValue?!0:!1;return'\x3cspan  id\x3d"'+b+'" class\x3d"mini-grid-checkbox mini-icon '+(a?"mini-grid-checkbox-checked":"")+'"\x3e\x3c/span\x3e'},init:function(a){function b(b){if(!a.isReadOnly()&&!this.readOnly&&(b.value=mini._getMap(b.field,b.record),a.fire("cellbeginedit",b),!0!==b.cancel)){var c=mini._getMap(b.column.field,b.record)==this.trueValue?this.falseValue:this.trueValue;a._OnCellCommitEdit&&(a._OnCellCommitEdit(b.record,b.column,c),a._OnCellEndEdit(b.record,b.column))}}this.grid=a;a.on("cellclick",function(c){if(c.column==this){var d=this.getCheckId(c.record,c.column),e=c.htmlEvent.target;e.id==d&&(a.allowCellEdit?(c.cancel=!1,b.call(this,c)):this.readOnly||(c.value=mini._getMap(c.column.field,c.record),a.fire("cellbeginedit",c),1!=c.cancel&&a.isEditingRow&&a.isEditingRow(c.record)&&setTimeout(function(){jQuery(e).toggleClass("mini-grid-checkbox-checked")},1)))}},this);mini.on(this.grid.el,"keydown",function(c){if(32==c.keyCode&&a.allowCellEdit){var d=a.getCurrentCell();d&&d[1]==this&&(d={record:d[0],column:d[1]},d.field=d.column.field,b.call(this,d),c.preventDefault())}},this);var d=parseInt(this.trueValue),e=parseInt(this.falseValue);isNaN(d)||(this.trueValue=d);isNaN(e)||(this.falseValue=e);"true"==this.trueValue&&(this.trueValue=!0);"false"==this.falseValue&&(this.falseValue=!1)}},a)};mini._Columns.checkboxcolumn=mini.CheckBoxColumn;mini.RadioButtonColumn=function(a){return mini.copyTo({_type:"radiobuttoncolumn",editMode:"inline",header:"",headerAlign:"center",trueValue:!0,falseValue:!1,readOnly:!1,getCheckId:function(a,c){return this._gridUID+"$radio$"+a[this._rowIdField]+"$"+c._id},getCheckBoxEl:function(a,c){return document.getElementById(this.getCheckId(a,c))},renderer:function(a){var b=this.getCheckId(a.record,a.column);a=mini._getMap(a.field,a.record)==this.trueValue?!0:!1;return'\x3cspan id\x3d"'+b+'" class\x3d"mini-grid-radio '+(a?"mini-grid-radio-checked":"")+'"\x3e\x3c/span\x3e'},init:function(a){function b(b){if(!a.isReadOnly()&&!this.readOnly&&(b.value=mini._getMap(b.field,b.record),a.fire("cellbeginedit",b),!0!==b.cancel)){var c=mini._getMap(b.column.field,b.record);if(c!=this.trueValue){for(var d=c==this.trueValue?this.falseValue:this.trueValue,e=a.getData(),f=0,p=e.length;f<p;f++){var q=e[f];q!=b.record&&(c=mini._getMap(b.column.field,q),c!=this.falseValue&&a.updateRow(q,b.column.field,this.falseValue))}a._OnCellCommitEdit&&(a._OnCellCommitEdit(b.record,b.column,d),a._OnCellEndEdit(b.record,b.column))}}}this.grid=a;a.on("cellclick",function(c){if(c.column==this){var d=this.getCheckId(c.record,c.column),e=c.htmlEvent.target;if(e.id==d)if(a.allowCellEdit)c.cancel=!1,b.call(this,c);else if(a.isEditingRow&&a.isEditingRow(c.record)){var f=this;setTimeout(function(){e.checked=!0;for(var b=a.getData(),d=0,g=b.length;d<g;d++){var k=b[d];if(k!=c.record){var l=c.column.field,u=mini._getMap(l,k);u!=f.falseValue&&k!=c.record&&(a._dataSource?(mini._setMap(c.column.field,f.falseValue,k),a._dataSource._setModified(k,l,u)):(u={},mini._setMap(l,f.falseValue,u),a._doUpdateRow(k,u)))}}},1)}}},this);mini.on(this.grid.el,"keydown",function(c){if(32==c.keyCode&&a.allowCellEdit){var d=a.getCurrentCell();d&&d[1]==this&&(d={record:d[0],column:d[1]},d.field=d.column.field,b.call(this,d),c.preventDefault())}},this);var d=parseInt(this.trueValue),e=parseInt(this.falseValue);isNaN(d)||(this.trueValue=d);isNaN(e)||(this.falseValue=e)}},a)};mini._Columns.radiobuttoncolumn=mini.RadioButtonColumn;function listColumnRenderer(a){var b=a.column,c=mini.isNull(a.value)?"":String(a.value),d=c.split(","),e,f="text",g={};e=b.editor;var k=b.__editor;if(e){k||"combobox"!=e.type&&"treeselect"!=e.type||(mini.isControl(e)?k=e:(e=mini.clone(e),k=mini.create(e)),a.column.__editor=k);e=k.getValueField();var f=k.getTextField(),l=k.getData(),g=b._valueMaps;if(!g||l!==b._data){var n=k.getList?k.getList():l,g={},k=0;for(a=n.length;k<a;k++){var p=n[k];g[p[e]]=p}b._valueMaps=g;b._data=l}}e=[];k=0;for(a=d.length;k<a;k++)if(p=g[d[k]]){l=p[f];if(null===l||void 0===l)l="";e.push(l)}return 0==e.length&&!1===b.valueFromSelect?c:e.join(",")}mini.ComboBoxColumn=function(a){return mini.copyTo({renderer:listColumnRenderer},a)};mini._Columns.comboboxcolumn=mini.ComboBoxColumn;mini.TreeSelectColumn=function(a){return mini.copyTo({renderer:listColumnRenderer},a)};mini._Columns.treeselectcolumn=mini.TreeSelectColumn;mini._Resizer=function(a){this.owner=a;mini.on(this.owner.el,"mousedown",this.__OnMouseDown,this)};mini._Resizer.prototype={__OnMouseDown:function(a){mini.hasClass(a.target,"mini-resizer-trigger")&&this.owner.allowResize&&this._getResizeDrag().start(a)},_getResizeDrag:function(){this._resizeDragger||(this._resizeDragger=new mini.Drag({capture:!0,onStart:mini.createDelegate(this._OnDragStart,this),onMove:mini.createDelegate(this._OnDragMove,this),onStop:mini.createDelegate(this._OnDragStop,this)}));return this._resizeDragger},_OnDragStart:function(a){this.mask=mini.append(document.body,'\x3cdiv class\x3d"mini-resizer-mask mini-fixed"\x3e\x3c/div\x3e');this.proxy=mini.append(document.body,'\x3cdiv class\x3d"mini-resizer-proxy"\x3e\x3c/div\x3e');this.proxy.style.cursor="se-resize";a=this.owner.el;a.offsetWidth;this.elBox=mini.getBox(a);mini.setBox(this.proxy,this.elBox)},_OnDragMove:function(a){var b=this.owner,c=this.elBox.width+(a.now[0]-a.init[0]);a=this.elBox.height+(a.now[1]-a.init[1]);c<b.minWidth&&(c=b.minWidth);a<b.minHeight&&(a=b.minHeight);c>b.maxWidth&&(c=b.maxWidth);a>b.maxHeight&&(a=b.maxHeight);mini.setSize(this.proxy,c,a)},_OnDragStop:function(a,b){if(this.proxy){var c=mini.getBox(this.proxy);jQuery(this.mask).remove();jQuery(this.proxy).remove();this.elBox=this.proxy=null;b&&(this.owner.setWidth(c.width),this.owner.setHeight(c.height),this.owner.fire("resize"))}}};mini._topWindow=null;mini._getTopWindow=function(a){function b(a){try{a.___try=1,1==a.___try&&c.push(a)}catch(e){}a.parent&&a.parent!=a&&b(a.parent)}if(mini._topWindow)return mini._topWindow;var c=[];b(window);mini._topWindow=c[c.length-1];return mini._topWindow};var __ps=mini.getParams();if(__ps._winid)try{window.Owner=mini._getTopWindow()[__ps._winid]}catch(a){}mini._WindowID="w"+Math.floor(1E4*Math.random());mini._getTopWindow()[mini._WindowID]=window;mini.iframeParams={};mini.createIFrame=function(a,b,c,d,e){function f(){0==n||p||setTimeout(function(){b&&b(l,q);q=!1},1)}a||(a="");e=a.split("#");a=e[0];var g="";!0!==c&&(g="_t\x3d"+Math.floor(1E6*Math.random()),a=-1==a.indexOf("?")?a+("?"+g):a+("\x26"+g));a&&-1==a.indexOf("_winid")&&(g="_winid\x3d"+mini._WindowID,a=-1==a.indexOf("?")?a+("?"+g):a+("\x26"+g));if(mini.iframeParams)for(var k in mini.iframeParams)a+="\x26"+k+"\x3d"+mini.iframeParams[k];e[1]&&(a=a+"#"+e[1]);k=(c=-1!=a.indexOf(".mht"))?a:"";k='\x3ciframe name\x3d"'+mini.newId("mini-iframe-")+'" src\x3d"'+("post"==d?"":k)+'" style\x3d"width:100%;height:100%;"  frameborder\x3d"0"\x3e\x3c/iframe\x3e';e=document.createElement("div");var l=mini.append(e,k),n=!1;c?n=!0:setTimeout(function(){l&&("post"!=d&&(l.src=a),n=!0)},5);l.attachEvent?l.attachEvent("onload",f):l.onload=f;var p=!1,q=!0;l._ondestroy=function(){p=!0;l.src="";if(mini.isIE)try{l.contentWindow.document.write(""),l.contentWindow.document.close()}catch(t){}l=l._ondestroy=null};var r;"post"==d&&(r=jQuery("\x3cform /\x3e").attr({method:"post",action:a,enctype:"multipart/form-data",target:l.name}).hide().appendTo("body"),setTimeout(function(){r.submit()},10));return l};mini._doOpen=function(a){"string"==typeof a&&(a={url:a});a=mini.copyTo({width:700,height:400,allowResize:!0,allowModal:!0,closeAction:"destroy",title:"",titleIcon:"",iconCls:"",iconStyle:"",bodyStyle:"padding: 0",url:"",showCloseButton:!0,showFooter:!1},a);a.closeAction="destroy";var b=a.onload;delete a.onload;var c=a.ondestroy;delete a.ondestroy;var d=a.url;delete a.url;var e=mini.getViewportBox();if(a.width&&-1!=String(a.width).indexOf("%")){var f=parseInt(a.width);a.width=parseInt(f/100*e.width)}a.height&&-1!=String(a.height).indexOf("%")&&(f=parseInt(a.height),a.height=parseInt(f/100*e.height));e=new mini.Window;e.set(a);e.load(d,b,c);e.show();mini.isIE&&setTimeout(function(){fixIEFocus()},100);return e};function fixIEFocus(){var a=mini.getViewportBox(),b=document.createElement("input");b.style.cssText="position:absolute;left:"+a.left+"px;top:"+a.top+"px;";document.body.appendChild(b);b.focus();b.parentNode.removeChild(b)}mini.getTopWindow=function(){function a(c){try{c.mini&&b.push(c),c.parent&&c.parent!=c&&a(c.parent)}catch(d){}}var b=[];a(window);return b[b.length-1]};mini.open=function(a){function b(a){try{a.mini&&f.push(a),a.parent&&a.parent!=a&&b(a.parent)}catch(k){}}if(a){var c=a.url;c||(c="");var d=c.split("#");if((c=d[0])&&-1==c.indexOf("_winid")){var e="_winid\x3d"+mini._WindowID,c=-1==c.indexOf("?")?c+("?"+e):c+("\x26"+e);d[1]&&(c=c+"#"+d[1])}a.url=c;a.Owner=window;var f=[];b(window);c=f[f.length-1];a.targetWindow&&(c=a.targetWindow);return c.mini._doOpen(a)}};mini.openTop=mini.open;mini._getResult=function(a,b,c,d,e,f){var g=null;d=mini.getText(a,b,function(a,b){g=b;c&&c&&c(a,b)},d,e);b={text:d,result:null,sender:{type:""},options:{url:a,data:b,type:e},xhr:g};e=null;try{mini_doload(b),(e=b.result)||(e=mini.decode(d))}catch(k){1==mini_debugger&&alert(a+"\njson is error")}!mini.isArray(e)&&f&&(e=mini._getMap(f,e));mini.isArray(e)&&(e={data:e});return e?e.data:null};mini.getData=function(a,b,c,d,e){a=mini.getText(a,b,c,d,e);return mini.decode(a)};mini.getText=function(a,b,c,d,e){var f=null;mini.ajax({url:a,data:b,async:!1,type:e?e:"get",cache:!1,dataType:"text",success:function(a,b,d){f=a;c&&c(a,d)},error:d});return f};window.mini_RootPath||(mini_RootPath="/");mini_CreateJSPath=function(a){for(var b=document.getElementsByTagName("script"),c="",d=0,e=b.length;d<e;d++){var f=b[d].src;if(-1!=f.indexOf(a)){a=f.split(a);c=a[0];break}}a=location.href;a=a.split("#")[0];a=a.split("?")[0];a=a.split("/");--a.length;a=a.join("/");-1==c.indexOf("http:")&&-1==c.indexOf("file:")&&(c=a+"/"+c);return c};window.mini_JSPath||(mini_JSPath=mini_CreateJSPath("miniui.js"));mini.update=function(a,b){"string"==typeof a&&(a={url:a});b&&(a.el=b);var c=mini.loadText(a.url);mini.innerHTML(a.el,c);mini.parse(a.el)};mini.createSingle=function(a){"string"==typeof a&&(a=mini.getClass(a));if("function"==typeof a){var b=a.single;b||(b=a.single=new a);return b}};mini.createTopSingle=function(a){if("function"==typeof a){var b=a.prototype.type;return top&&top!=window&&top.mini&&top.mini.getClass(b)?top.mini.createSingle(b):mini.createSingle(a)}};mini.sortTypes={string:function(a){return String(a).toUpperCase()},date:function(a){return a?mini.isDate(a)?a.getTime():mini.parseDate(String(a)):0},"float":function(a){a=parseFloat(String(a).replace(/,/g,""));return isNaN(a)?0:a},"int":function(a){a=parseInt(String(a).replace(/,/g,""),10);return isNaN(a)?0:a},currency:function(a){a=parseFloat(String(a).replace(/,/g,""));return isNaN(a)?0:a}};mini._ValidateVType=function(a,b,c,d){for(var e=a.split(";"),f=0,g=e.length;f<g;f++){a=e[f].trim();var k=a.split(":"),l=k[0];a=(a=a.substr(l.length+1,1E3))?a.split(","):[];if((l=mini.VTypes[l])&&!0!==l(b,a)){c.isValid=!1;b=k[0]+"ErrorText";c.errorText=d[b]||mini.VTypes[b]||"";c.errorText=String.format(c.errorText,a[0],a[1],a[2],a[3],a[4]);break}}};mini._getErrorText=function(a,b){return a&&a[b]?a[b]:mini.VTypes[b]};mini.VTypes={minDateErrorText:"Date can not be less than {0}",maxDateErrorText:"Date can not be greater than {0}",uniqueErrorText:"This field is unique.",requiredErrorText:"This field is required.",emailErrorText:"Please enter a valid email address.",urlErrorText:"Please enter a valid URL.",floatErrorText:"Please enter a valid number.",intErrorText:"Please enter only digits",dateErrorText:"Please enter a valid date. Date format is {0}",maxLengthErrorText:"Please enter no more than {0} characters.",minLengthErrorText:"Please enter at least {0} characters.",maxErrorText:"Please enter a value less than or equal to {0}.",minErrorText:"Please enter a value greater than or equal to {0}.",rangeLengthErrorText:"Please enter a value between {0} and {1} characters long.",rangeCharErrorText:"Please enter a value between {0} and {1} characters long.",rangeErrorText:"Please enter a value between {0} and {1}.",required:function(a,b){return mini.isNull(a)||""===a?!1:!0},email:function(a,b){return mini.isNull(a)||""===a?!0:-1!=a.search(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/)?!0:!1},url:function(a,b){if(mini.isNull(a)||""===a)return!0;var c;c=a.toLowerCase().split("?")[0];c=/^((https|http|ftp|rtsp|mms)?:\/\/)?(([0-9]{1,3}.){3}[0-9]{1,3}|([0-9a-z_!~*'()-]+.)*([0-9a-z][0-9a-z-]{0,61})?[0-9a-z].[a-z]{2,6})(:[0-9]{1,5})?((\/?)|(\/[0-9a-z_!~*'().;?:@&=+$,%#-]+)+\/?)$/.test(c)?!0:!1;return c},"int":function(a,b){if(mini.isNull(a)||""===a)return!0;var c=a;0>c&&(c=-c);c=String(c);return 0<c.length&&!/[^0-9]/.test(c)},"float":function(a,b){if(mini.isNull(a)||""===a)return!0;var c;c=String(a);-1!=c.indexOf("-")&&0!=c.indexOf("-")?c=!1:(c=c.replace("-",""),c=2<c.split(".").length?!1:0<c.length&&!/[^0-9.]/.test(c)&&"."!=c.charAt(c.length-1));return c},date:function(a,b){if(mini.isNull(a)||""===a)return!0;if(!a)return!1;var c,d=b[0];if(d){if((c=mini.parseDate(a,d))&&c.getFullYear&&mini.formatDate(c,d)==a)return!0}else if((c=mini.parseDate(a,"yyyy-MM-dd"))||(c=mini.parseDate(a,"yyyy/MM/dd")),c||(c=mini.parseDate(a,"MM/dd/yyyy")),c&&c.getFullYear)return!0;return!1},maxLength:function(a,b){if(mini.isNull(a)||""===a)return!0;var c=parseInt(b);return!a||isNaN(c)?!0:a.length<=c?!0:!1},minLength:function(a,b){if(mini.isNull(a)||""===a)return!0;var c=parseInt(b);return isNaN(c)?!0:a.length>=c?!0:!1},rangeLength:function(a,b){if(mini.isNull(a)||""===a)return!0;if(!a)return!1;var c=parseFloat(b[0]),d=parseFloat(b[1]);return isNaN(c)||isNaN(d)||c<=a.length&&a.length<=d?!0:!1},rangeChar:function(a,b){if(mini.isNull(a)||""===a)return!0;var c=parseFloat(b[0]),d=parseFloat(b[1]);if(isNaN(c)||isNaN(d))return!0;for(var e=0,f=String(a).split(""),g=0,k=f.length;g<k;g++){var l;l=RegExp("^[\u4e00-\u9fa5]+$").test(f[g])?!0:!1;e=l?e+2:e+1}return c<=e&&e<=d?!0:!1},range:function(a,b){if(0==mini.VTypes["float"](a,b))return!1;if(mini.isNull(a)||""===a)return!0;a=parseFloat(a);if(isNaN(a))return!1;var c=parseFloat(b[0]),d=parseFloat(b[1]);return isNaN(c)||isNaN(d)||c<=a&&a<=d?!0:!1},min:function(a,b){if(0==mini.VTypes["float"](a,b))return!1;if(mini.isNull(a)||""===a)return!0;a=parseFloat(a);if(isNaN(a))return!1;var c=parseFloat(b[0]);return isNaN(c)||c<=a?!0:!1},max:function(a,b){if(0==mini.VTypes["float"](a,b))return!1;if(mini.isNull(a)||""===a)return!0;a=parseFloat(a);if(isNaN(a))return!1;var c=parseFloat(b[0]);return isNaN(c)||a<=c?!0:!1}};mini.summaryTypes={count:function(a){a||(a=[]);return a.length},max:function(a,b){a||(a=[]);for(var c=null,d=0,e=a.length;d<e;d++){var f=parseFloat(mini._getMap(b,a[d]));null!==f&&void 0!==f&&!isNaN(f)&&(null==c||c<f)&&(c=f)}return c},min:function(a,b){a||(a=[]);for(var c=null,d=0,e=a.length;d<e;d++){var f=parseFloat(mini._getMap(b,a[d]));null!==f&&void 0!==f&&!isNaN(f)&&(null==c||c>f)&&(c=f)}return c},avg:function(a,b){a||(a=[]);if(0==a.length)return 0;for(var c=0,d=0,e=a.length;d<e;d++){var f=parseFloat(mini._getMap(b,a[d]));null===f||void 0===f||isNaN(f)||(c+=f)}return c/a.length},sum:function(a,b){a||(a=[]);for(var c=0,d=0,e=a.length;d<e;d++){var f=parseFloat(mini._getMap(b,a[d]));null===f||void 0===f||isNaN(f)||(c+=f)}return c}};mini.formatCurrency=function(a,b){null!==a&&void 0!==a||!1;a=String(a).replace(/\$|\,/g,"");isNaN(a)&&(a="0");sign=a==(a=Math.abs(a));a=Math.floor(100*a+.50000000001);cents=a%100;a=Math.floor(a/100).toString();10>cents&&(cents="0"+cents);for(var c=0;c<Math.floor((a.length-(1+c))/3);c++)a=a.substring(0,a.length-(4*c+3))+","+a.substring(a.length-(4*c+3));return(b||"")+((sign?"":"-")+a+"."+cents)};mini.getByUid=mini.getbyUID;mini.emptyFn=function(){};mini.Drag=function(a){mini.copyTo(this,a)};mini.Drag.prototype={onStart:mini.emptyFn,onMove:mini.emptyFn,onStop:mini.emptyFn,capture:!1,fps:20,event:null,delay:80,start:function(a){a.preventDefault();a&&(this.event=a);this.now=this.init=[this.event.pageX,this.event.pageY];var b=document;mini.on(b,"mousemove",this.move,this);mini.on(b,"mouseup",this.stop,this);mini.on(b,"contextmenu",this.contextmenu,this);if(this.context)mini.on(this.context,"contextmenu",this.contextmenu,this);this.trigger=a.target;mini.selectable(this.trigger,!1);mini.selectable(b.body,!1);this.capture&&(isIE?this.trigger.setCapture(!0):document.captureEvents&&document.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP|Event.MOUSEDOWN));this.started=!1;this.startTime=new Date},contextmenu:function(a){this.context&&mini.un(this.context,"contextmenu",this.contextmenu,this);mini.un(document,"contextmenu",this.contextmenu,this);a.preventDefault();a.stopPropagation()},move:function(a){if(!(this.delay&&new Date-this.startTime<this.delay)){var b=this;this.timer||(this.timer=setTimeout(function(){b.started||(b.started=!0,b.onStart(b));b.now=[a.pageX,a.pageY];b.event=a;b.onMove(b);b.timer=null},5))}},stop:function(a){this.now=[a.pageX,a.pageY];this.event=a;this.timer&&(clearTimeout(this.timer),this.timer=null);var b=document;mini.selectable(this.trigger,!0);mini.selectable(b.body,!0);isIE&&(this.trigger.setCapture(!1),this.trigger.releaseCapture());var c=mini.MouseButton.Right!=a.button;0==c&&a.preventDefault();mini.un(b,"mousemove",this.move,this);mini.un(b,"mouseup",this.stop,this);var d=this;setTimeout(function(){mini.un(document,"contextmenu",d.contextmenu,d);d.context&&mini.un(d.context,"contextmenu",d.contextmenu,d)},1);if(this.started)this.onStop(this,c)}};mini.JSON=new function(){var a=[],b=null,c=!!{}.hasOwnProperty,d=function(a,b){var c=f[b];if(c)return c;c=b.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)},e=function(f,n){if(null===f)a[a.length]="null";else{var l=typeof f;if("undefined"==l)a[a.length]="null";else if(f.push){a[a.length]="[";var q,r,t=f.length,u;for(r=0;r<t;r+=1)u=f[r],l=typeof u,"undefined"!=l&&"function"!=l&&"unknown"!=l&&(q&&(a[a.length]=","),e(u),q=!0);a[a.length]="]"}else if(f.getFullYear)b?(a[a.length]='"',a[a.length]="function"==typeof b?b(f,n):mini.formatDate(f,b)):(a[a.length]='"',a[a.length]=f.getFullYear(),a[a.length]="-",l=f.getMonth()+1,a[a.length]=10>l?"0"+l:l,a[a.length]="-",l=f.getDate(),a[a.length]=10>l?"0"+l:l,a[a.length]="T",l=f.getHours(),a[a.length]=10>l?"0"+l:l,a[a.length]=":",l=f.getMinutes(),a[a.length]=10>l?"0"+l:l,a[a.length]=":",l=f.getSeconds(),a[a.length]=10>l?"0"+l:l),a[a.length]='"';else if("string"==l)g.test(f)?(a[a.length]='"',a[a.length]=f.replace(k,d),a[a.length]='"'):a[a.length]='"'+f+'"';else if("number"==l)a[a.length]=f;else if("boolean"==l)a[a.length]=String(f);else{a[a.length]="{";for(r in f)if(!c||Object.prototype.hasOwnProperty.call(f,r))u=f[r],l=typeof u,"undefined"!=l&&"function"!=l&&"unknown"!=l&&(q&&(a[a.length]=","),e(r),a[a.length]=":",e(u,r),q=!0);a[a.length]="}"}}},f={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},g=/["\\\x00-\x1f]/,k=/([\x00-\x1f\\"])/g;this.encode=function(){return function(c,d){a=[];b=d;e(c);b=null;return a.join("")}}();this.decode=function(){var a=/^(\d{4})-(\d{2})-(\d{2})[T ](\d{2}):(\d{2}):(\d{2}(?:\.*\d*)?)Z*$/,b=RegExp("^/+Date\\((-?[0-9]+).*\\)/+$","g"),c=/[\"\'](\d{4})-(\d{1,2})-(\d{1,2})[T ](\d{1,2}):(\d{1,2}):(\d{1,2})(\.*\d*)[\"\']/g;return function(d,e){function f(a){!1!==e&&(a=a.replace(__js_dateRegEx,"$1new Date($2)"),a=a.replace(c,"new Date($1,$2-1,$3,$4,$5,$6)"),a=a.replace(__js_dateRegEx2,"new Date($1)"));return window.eval("("+a+")")}if(""===d||null===d||void 0===d)return d;"object"==typeof d&&(d=this.encode(d));var g=null;if(window.JSON&&window.JSON.parse){var k=function(c,d){if("string"===typeof d&&!1!==e){a.lastIndex=0;var f=a.exec(d);if(f)return d=new Date(f[1],f[2]-1,f[3],f[4],f[5],f[6]);b.lastIndex=0;(f=b.exec(d))&&(d=new Date(parseInt(f[1])))}return d};try{var l=d.replace(__js_dateRegEx,'$1"/Date($2)/"'),g=window.JSON.parse(l,k)}catch(D){g=f(d)}}else g=f(d);return g}}()};__js_dateRegEx=RegExp('(^|[^\\\\])\\"\\\\/Date\\((-?[0-9]+)(?:[a-zA-Z]|(?:\\+|-)[0-9]{4})?\\)\\\\/\\"',"g");__js_dateRegEx2=RegExp("[\"']/Date\\(([0-9]+)\\)/[\"']","g");mini.encode=mini.JSON.encode;mini.decode=mini.JSON.decode;mini.clone=function(a,b){function c(a){for(var b=0,d=a.length;b<d;b++){var e=a[b];delete e._state;delete e._id;delete e._pid;delete e._uid;for(var l in e){var n=e[l];n instanceof Array&&c(n)}}}if(null===a||void 0===a)return a;var d=mini.encode(a),d=mini.decode(d);!1!==b&&c(d instanceof Array?d:[d]);return d};var DAY_MS=864E5,HOUR_MS=36E5,MINUTE_MS=6E4;mini.copyTo(mini,{clearTime:function(a){return a?new Date(a.getFullYear(),a.getMonth(),a.getDate()):null},maxTime:function(a){return a?new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59):null},cloneDate:function(a){return a?new Date(a.getTime()):null},addDate:function(a,b,c){c||(c="D");a=new Date(a.getTime());switch(c.toUpperCase()){case "Y":a.setFullYear(a.getFullYear()+b);break;case "MO":a.setMonth(a.getMonth()+b);break;case "D":a.setDate(a.getDate()+b);break;case "H":a.setHours(a.getHours()+b);break;case "M":a.setMinutes(a.getMinutes()+b);break;case "S":a.setSeconds(a.getSeconds()+b);break;case "MS":a.setMilliseconds(a.getMilliseconds()+b)}return a},getWeek:function(a,b,c){var d=Math.floor((14-b)/12);a=a+4800-d;b=c+Math.floor((153*(b+12*d-3)+2)/5)+365*a+Math.floor(a/4)-Math.floor(a/100)+Math.floor(a/400)-32045;b=(b+31741-b%7)%146097%36524%1461;c=Math.floor(b/1460);return NumberOfWeek=Math.floor(((b-c)%365+c)/7)+1},getWeekStartDate:function(a,b){b||(b=0);if(6<b||0>b)throw Error("out of weekday");var c=a.getDay(),d=b-c;c<b&&(d-=7);return new Date(a.getFullYear(),a.getMonth(),a.getDate()+d)},getShortWeek:function(a){return this.dateInfo.daysShort[a]},getLongWeek:function(a){return this.dateInfo.daysLong[a]},getShortMonth:function(a){return this.dateInfo.monthsShort[a]},getLongMonth:function(a){return this.dateInfo.monthsLong[a]},dateInfo:{monthsLong:"January Febraury March April May June July August September October November December".split(" "),monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),daysLong:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),daysShort:"Su Mo Tu We Th Fr Sa".split(" "),quarterLong:["Q1","Q2","Q3","Q4"],quarterShort:["Q1","Q2","Q3","Q4"],halfYearLong:["first half","second half"],patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",f:"dddd, MMMM dd, yyyy H:mm tt",F:"dddd, MMMM dd, yyyy H:mm:ss tt",g:"M/d/yyyy H:mm tt",G:"M/d/yyyy H:mm:ss tt",m:"MMMM dd",o:"yyyy-MM-ddTHH:mm:ss.fff",s:"yyyy-MM-ddTHH:mm:ss",t:"H:mm tt",T:"H:mm:ss tt",U:"dddd, MMMM dd, yyyy HH:mm:ss tt",y:"MMM, yyyy"},tt:{AM:"AM",PM:"PM"},ten:{Early:"Early",Mid:"Mid",Late:"Late"},today:"Today",clockType:24}});Date.prototype.getHalfYear=function(){return this.getMonth?6>this.getMonth()?0:1:null};Date.prototype.getQuarter=function(){if(!this.getMonth)return null;var a=this.getMonth();return 3>a?0:6>a?1:9>a?2:3};mini.formatDate=function(a,b,c){if(!a||!a.getFullYear||isNaN(a))return"";var d=a.toString();c=mini.dateInfo;c||(c=mini.dateInfo);if("undefined"!==typeof c){var d="undefined"!==typeof c.patterns[b]?c.patterns[b]:b,e=a.getFullYear(),f=a.getMonth(),g=a.getDate();if("yyyy-MM-dd"==b)return f=10>f+1?"0"+(f+1):f+1,g=10>g?"0"+g:g,e+"-"+f+"-"+g;if("MM/dd/yyyy"==b)return f=10>f+1?"0"+(f+1):f+1,g=10>g?"0"+g:g,f+"/"+g+"/"+e;d=d.replace(/yyyy/g,e);d=d.replace(/yy/g,(e+"").substring(2));b=a.getHalfYear();d=d.replace(/hy/g,c.halfYearLong[b]);b=a.getQuarter();d=d.replace(/Q/g,c.quarterLong[b]);d=d.replace(/q/g,c.quarterShort[b]);d=d.replace(/MMMM/g,c.monthsLong[f].escapeDateTimeTokens());d=d.replace(/MMM/g,c.monthsShort[f].escapeDateTimeTokens());d=d.replace(/MM/g,10>f+1?"0"+(f+1):f+1);d=d.replace(/(\\)?M/g,function(a,b){return b?a:f+1});b=a.getDay();var d=d.replace(/dddd/g,c.daysLong[b].escapeDateTimeTokens()),d=d.replace(/ddd/g,c.daysShort[b].escapeDateTimeTokens()),d=d.replace(/dd/g,10>g?"0"+g:g),d=d.replace(/(\\)?d/g,function(a,b){return b?a:g}),k=a.getHours(),l=12<k?k-12:k;12==c.clockType&&12<k&&(k-=12);var d=d.replace(/HH/g,10>k?"0"+k:k),d=d.replace(/(\\)?H/g,function(a,b){return b?a:k}),d=d.replace(/hh/g,10>l?"0"+l:l),d=d.replace(/(\\)?h/g,function(a,b){return b?a:l}),n=a.getMinutes(),d=d.replace(/mm/g,10>n?"0"+n:n),d=d.replace(/(\\)?m/g,function(a,b){return b?a:n}),p=a.getSeconds(),d=d.replace(/ss/g,10>p?"0"+p:p),d=d.replace(/(\\)?s/g,function(a,b){return b?a:p}),d=d.replace(/fff/g,a.getMilliseconds()),d=d.replace(/tt/g,12<a.getHours()||0==a.getHours()?c.tt.PM:c.tt.AM);a=a.getDate();b="";b=10>=a?c.ten.Early:20>=a?c.ten.Mid:c.ten.Late;d=d.replace(/ten/g,b)}return d.replace(/\\/g,"")};String.prototype.escapeDateTimeTokens=function(){return this.replace(/([dMyHmsft])/g,"\\$1")};mini.fixDate=function(a,b){if(+a)for(;a.getDate()!=b.getDate();)a.setTime(+a+(a<b?1:-1)*HOUR_MS)};mini.parseDate=function(a,b){try{var c=window.eval(a);if(c&&c.getFullYear)return c}catch(d){}if("object"==typeof a)return isNaN(a)?null:a;if("number"==typeof a)return c=new Date(1E3*a),c.getTime()!=a?null:isNaN(c)?null:c;if("string"==typeof a){if(m=a.match(/^([0-9]{4})([0-9]{2})([0-9]{0,2})$/))return c=new Date(parseInt(m[1],10),parseInt(m[2],10)-1),m[3]&&c.setDate(m[3]),c;if(m=a.match(/^([0-9]{4}).([0-9]*)$/))return c=new Date(m[1],m[2]-1);if(a.match(/^\d+(\.\d+)?$/))return c=new Date(1E3*parseFloat(a)),c.getTime()!=a?null:c;void 0===b&&(b=!0);c=mini.parseISO8601(a,b)||(a?new Date(a):null);return isNaN(c)?null:c}return null};mini.parseISO8601=function(a,b){var c=a.match(/^([0-9]{4})([-\/]([0-9]{1,2})([-\/]([0-9]{1,2})([T ]([0-9]{1,2}):([0-9]{1,2})(:([0-9]{1,2})(\.([0-9]+))?)?(Z|(([-+])([0-9]{2})(:?([0-9]{2}))?))?)?)?)?$/);if(!c){if(c=a.match(/^([0-9]{4})[-\/]([0-9]{2})[-\/]([0-9]{2})[T ]([0-9]{1,2})/)){var d=new Date(c[1],c[2]-1,c[3],c[4]);return d}return(c=a.match(/^([0-9]{4}).([0-9]*)$/))?d=new Date(c[1],c[2]-1):(c=a.match(/^([0-9]{4}).([0-9]*).([0-9]*)/))?d=new Date(c[1],c[2]-1,c[3]):(c=a.match(/^([0-9]{2})-([0-9]{2})-([0-9]{4})$/))?d=new Date(c[3],c[1]-1,c[2]):null}d=new Date(c[1],0,1);if(b||!c[14]){var e=new Date(c[1],0,1,9,0);c[3]&&(d.setMonth(c[3]-1),e.setMonth(c[3]-1));c[5]&&(d.setDate(c[5]),e.setDate(c[5]));mini.fixDate(d,e);c[7]&&d.setHours(c[7]);c[8]&&d.setMinutes(c[8]);c[10]&&d.setSeconds(c[10]);c[12]&&d.setMilliseconds(1E3*Number("0."+c[12]));mini.fixDate(d,e)}else d.setUTCFullYear(c[1],c[3]?c[3]-1:0,c[5]||1),d.setUTCHours(c[7]||0,c[8]||0,c[10]||0,c[12]?1E3*Number("0."+c[12]):0),e=60*Number(c[16])+(c[18]?Number(c[18]):0),e*="-"==c[15]?1:-1,d=new Date(+d+6E4*e);return d};mini.parseTime=function(a,b){if(!a)return null;var c=parseInt(a);if(c==a&&b){var d=new Date(0),e=b.charAt(0);"H"==e?d.setHours(c):"m"==e?d.setMinutes(c):"s"==e&&d.setSeconds(c);isNaN(d)&&(d=null);return d}var d=mini.parseDate(a);if(!d){var f=a.split(":"),c=parseInt(parseFloat(f[0])),e=parseInt(parseFloat(f[1])),f=parseInt(parseFloat(f[2]));isNaN(c)||isNaN(e)||isNaN(f)||(d=new Date(0),d.setHours(c),d.setMinutes(e),d.setSeconds(f));isNaN(c)||"H"!=b&&"HH"!=b?isNaN(c)||isNaN(e)||"H:mm"!=b&&"HH:mm"!=b?isNaN(c)||isNaN(e)||"mm:ss"!=b||(d=new Date(0),d.setMinutes(c),d.setSeconds(e)):(d=new Date(0),d.setHours(c),d.setMinutes(e)):(d=new Date(0),d.setHours(c))}return d};mini.dateInfo={monthsLong:"\u4e00\u6708 \u4e8c\u6708 \u4e09\u6708 \u56db\u6708 \u4e94\u6708 \u516d\u6708 \u4e03\u6708 \u516b\u6708 \u4e5d\u6708 \u5341\u6708 \u5341\u4e00\u6708 \u5341\u4e8c\u6708".split(" "),monthsShort:"1\u6708 2\u6708 3\u6708 4\u6708 5\u6708 6\u6708 7\u6708 8\u6708 9\u6708 10\u6708 11\u6708 12\u6708".split(" "),daysLong:"\u661f\u671f\u65e5 \u661f\u671f\u4e00 \u661f\u671f\u4e8c \u661f\u671f\u4e09 \u661f\u671f\u56db \u661f\u671f\u4e94 \u661f\u671f\u516d".split(" "),daysShort:"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split(""),quarterLong:["\u4e00\u5b63\u5ea6","\u4e8c\u5b63\u5ea6","\u4e09\u5b63\u5ea6","\u56db\u5b63\u5ea6"],quarterShort:["Q1","Q2","Q2","Q4"],halfYearLong:["\u4e0a\u534a\u5e74","\u4e0b\u534a\u5e74"],patterns:{d:"yyyy-M-d",D:"yyyy\u5e74M\u6708d\u65e5",f:"yyyy\u5e74M\u6708d\u65e5 H:mm",F:"yyyy\u5e74M\u6708d\u65e5 H:mm:ss",g:"yyyy-M-d H:mm",G:"yyyy-M-d H:mm:ss",m:"MMMd\u65e5",o:"yyyy-MM-ddTHH:mm:ss.fff",s:"yyyy-MM-ddTHH:mm:ss",t:"H:mm",T:"H:mm:ss",U:"yyyy\u5e74M\u6708d\u65e5 HH:mm:ss",y:"yyyy\u5e74MM\u6708"},tt:{AM:"\u4e0a\u5348",PM:"\u4e0b\u5348"},ten:{Early:"\u4e0a\u65ec",Mid:"\u4e2d\u65ec",Late:"\u4e0b\u65ec"},today:"\u4eca\u5929",clockType:24};(function(a){function b(a){return a&&a.name?a:g.cultures[a]||g.cultures.current}function c(a,b,c){a+="";b=("number"==typeof b?b:2)-a.length;return 0<b?(b=d(b,"0"),c?a+b:b+a):a}function d(a,b){for(var c="";a;)--a,c+=b;return c}function e(a){return-1!=a.indexOf("0")||-1!=a.indexOf("#")}function f(a){if(!a)return null;var b,c=a.indexOf("0");b=a.indexOf("#");if(-1==c||-1!=b&&b<c)c=b;b=a.lastIndexOf("0");var d=a.lastIndexOf("#");if(-1==b||-1!=d&&d>b)b=d;b=[c,b];c=b[0];b=b[1];return-1<c?{begin:c,end:b,format:a.substring(c,b+1)}:null}var g=a.mini;g||(g=a.mini={});var k=g.cultures={};g.cultures.en={name:"en",numberFormat:{number:{pattern:["n","-n"],decimals:2,decimalsSeparator:".",groupSeparator:",",groupSize:[3]},percent:{pattern:["n %","-n %"],decimals:2,decimalsSeparator:".",groupSeparator:",",groupSize:[3],symbol:"%"},currency:{pattern:["$n","($n)"],decimals:2,decimalsSeparator:".",groupSeparator:",",groupSize:[3],symbol:"$"}}};g.getCulture=b;g.culture=function(a){if(void 0!==a)g.cultures.current=g.cultures[a];else return k.current};g.culture("en");var l=/^(n|c|p)(\d*)$/i,n=/^(e)(\d*)$/i,p=/[^0#]/g,q=/[eE][\-+]?[0-9]+/;g.parseInt=function(a,b,c){(a=g.parseFloat(a,b,c))&&(a|=0);return a};g.parseFloat=function(a,b,c){function e(a,b,c){var d=f(b);if(d){var e=b.substr(0,d.begin);b=b.substr(d.end+1);0==a.indexOf(e)&&-1<a.indexOf(b)&&(a=a.replace(e,"").replace(b,""),t=c)}return a}if(!a&&0!==a)return null;if("number"===typeof a)return a;if(c&&c.split(";")[2]==a)return 0;if(q.test(a))return a=parseFloat(a),isNaN(a)&&(a=null),a;a=a.toString();b=g.getCulture(b);b=b.numberFormat;var k=b.number,l=b.percent,n=b.currency;b=-1!=a.indexOf(l.symbol);var k=-1!=a.indexOf(n.symbol)?n:b?l:k,p=k.pattern[1],r=k.decimals,u=k.decimalsSeparator,k=k.groupSeparator,t=-1<a.indexOf("-");c?(c=c.split(";"),c[1]?(c=c[1],a=e(a,c,!0)):(c=c[0],l=a,a=e(l,c,!1),l==a&&(a=e(l,"-"+c,!0)))):0==t&&(c=p.replace("n","#,#"+(0<r?"."+d(r,"0"):"")).replace("$",n.symbol).replace("%",l.symbol),a=e(a,c,!0));a=a.split(k).join("").replace(u,".");a=a.match(/([0-9,.]+)/g);if(null==a)return null;a=a[0];a=parseFloat(a);isNaN(a)?a=null:t&&(a*=-1);a&&b&&(a/=100);return a};g.formatNumber=function(a,g,k){if("number"!=typeof a)return"";if(!g)return String(a);var q=g.split(";");g=q[0];0>a&&2<=q.length&&(g=q[1]);0==a&&3<=q.length&&(g=q[2]);k=b(k);var r=k.numberFormat.number,u=k.numberFormat.percent,t=k.numberFormat.currency,x=a,C=k.numberFormat.number,A=l.exec(g);if(null!=A){q=A[1];A=A[2];"p"==q?C=k.numberFormat.percent:"c"==q&&(C=k.numberFormat.currency);var G=A?parseInt(A):C.decimals,x=C.pattern[0>x?1:0],x=x.replace("n","#,#"+(0<G?"."+d(G,"0"):""));g=g.replace(q+A,x).replace("$",k.numberFormat.currency.symbol).replace("%",k.numberFormat.percent.symbol)}else e(g)&&0>x&&!q[1]&&(g="-"+g);x=-1!=g.indexOf(t.symbol);k=-1!=g.indexOf(u.symbol);g.indexOf(".");u=e(g);t=x?t:k?t:r;a=k?100*a:a;if(r=n.exec(g))return g=parseInt(r[2]),isNaN(g)?a.toExponential():a.toExponential(g);if(!u)return g;r=f(g);if(null!=r){x=r.format;u=Math.abs(a);a=-1!=x.indexOf(",");k=x.split(".");x=(k[0]||"").replace(p,"");A=(k[1]||"").replace(p,"");k="";C=t.decimalsSeparator;t=t.groupSeparator;q=x.indexOf("0");x=-1==q?"0":x.substr(q)||"0";q=A.length;A=A.substr(0,A.lastIndexOf("0")+1).length;with(Math)u=round(u*pow(10,q))/pow(10,q);u=String(u).split(".");value0=u[0];value1=u[1]||"";if(value0){value0=c(value0,x.length);if(a)for(a=0;a<Math.floor((value0.length-(1+a))/3);a++)value0=value0.substring(0,value0.length-(4*a+3))+t+value0.substring(value0.length-(4*a+3));k+=value0}0<q&&(k=k+C+c(value1.substr(0,q),A,!0));a=k;a=g.substr(0,r.begin)+a+g.substr(r.end+1)}else a=g;return a}})(this);var inBrowser="undefined"!==typeof window,UA=inBrowser&&window.navigator.userAgent.toLowerCase(),isIE=UA&&/msie|trident/.test(UA),isIE9=UA&&0<UA.indexOf("msie 9.0"),isEdge=UA&&0<UA.indexOf("edge/"),isAndroid=UA&&0<UA.indexOf("android"),isIOS=UA&&/iphone|ipad|ipod|ios/.test(UA),isMobile=isAndroid||isIOS;mini.isAndroid=isAndroid;mini.isIOS=isIOS;mini.isMobile=isMobile;mini.Keyboard={Left:37,Top:38,Right:39,Bottom:40,PageUp:33,PageDown:34,End:35,Home:36,Enter:13,ESC:27,Space:32,Tab:9,Del:46,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123};var ua=navigator.userAgent.toLowerCase(),check=function(a){return a.test(ua)},DOC=document,isStrict="CSS1Compat"==document.compatMode,version=function(a,b){var c;return a&&(c=b.exec(ua))?parseFloat(c[1]):0},docMode=document.documentMode,isOpera=check(/opera/),isOpera10_5=isOpera&&check(/version\/10\.5/),isChrome=check(/\bchrome\b/),isWebKit=check(/webkit/),isSafari=!isChrome&&check(/safari/),isSafari2=isSafari&&check(/applewebkit\/4/),isSafari3=isSafari&&check(/version\/3/),isSafari4=isSafari&&check(/version\/4/),isSafari5_0=isSafari&&check(/version\/5\.0/),isSafari5=isSafari&&check(/version\/5/),isIE7=(isIE=!isOpera&&check(/msie/))&&(check(/msie 7/)&&8!=docMode&&9!=docMode&&10!=docMode||7==docMode),isIE8=isIE&&(check(/msie 8/)&&7!=docMode&&9!=docMode&&10!=docMode||8==docMode),isIE9=isIE&&(check(/msie 9/)&&7!=docMode&&8!=docMode&&10!=docMode||9==docMode),isIE10=isIE&&(check(/msie 10/)&&7!=docMode&&8!=docMode&&9!=docMode||10==docMode),isIE6=isIE&&!isIE7&&!isIE8&&!isIE9&&!isIE10,isIE11=-1<ua.indexOf("trident")&&-1<ua.indexOf("rv"),isIE=isIE||isIE11,isFirefox=0<navigator.userAgent.indexOf("Firefox"),isGecko=!isWebKit&&check(/gecko/),isGecko3=isGecko&&check(/rv:1\.9/),isGecko4=isGecko&&check(/rv:2\.0/),isGecko5=isGecko&&check(/rv:5\./),isGecko10=isGecko&&check(/rv:10\./),isFF3_0=isGecko3&&check(/rv:1\.9\.0/),isFF3_5=isGecko3&&check(/rv:1\.9\.1/),isFF3_6=isGecko3&&check(/rv:1\.9\.2/),isWindows=check(/windows|win32/),isMac=check(/macintosh|mac os x/),isAir=check(/adobeair/),isLinux=check(/linux/),scrollbarSize=null,chromeVersion=version(!0,/\bchrome\/(\d+\.\d+)/),firefoxVersion=version(!0,/\bfirefox\/(\d+\.\d+)/),ieVersion=version(isIE,/msie (\d+\.\d+)/),IE_V=isIE?parseInt(ieVersion):-1,operaVersion=version(isOpera,/version\/(\d+\.\d+)/),safariVersion=version(isSafari,/version\/(\d+\.\d+)/),webKitVersion=version(isWebKit,/webkit\/(\d+\.\d+)/),isSecure=/^https/i.test(window.location.protocol),isBorderBox=isIE&&!isStrict;if(isIE6)try{DOC.execCommand("BackgroundImageCache",!1,!0)}catch(a){}mini.boxModel=!isBorderBox;mini.isIE=isIE;mini.isIE6=isIE6;mini.isIE7=isIE7;mini.isIE8=isIE8;mini.isIE9=isIE9;mini.isIE10=isIE10;mini.isIE11=isIE11;mini.IE_V=isIE11?11:IE_V;mini.isFirefox=isFirefox;mini.isOpera=isOpera;mini.isSafari=isSafari;mini.isChrome=isChrome;isIE&&jQuery(document.documentElement).addClass("ie ie"+mini.IE_V);jQuery&&(jQuery.boxModel=mini.boxModel);mini.noBorderBox=!1;0==jQuery.boxModel&&isIE&&0==isIE9&&(mini.noBorderBox=!0);mini.MouseButton={Left:0,Middle:1,Right:2};!isIE||isIE9||isIE10||(mini.MouseButton={Left:1,Middle:4,Right:2});mini.append=function(a,b){a=mini.byId(a);if(b&&a){if("string"==typeof b)if("#"==b.charAt(0)){b=mini.byId(b);if(!b)return;a.appendChild(b)}else{if(0==b.indexOf("\x3ctr"))return jQuery(a).append(b)[0].lastChild;var c=document.createElement("div");c.innerHTML=b;for(b=c.firstChild;c.firstChild;)a.appendChild(c.firstChild)}else a.appendChild(b);return b}};mini.prepend=function(a,b){if("string"==typeof b)if("#"==b.charAt(0))b=mini.byId(b);else{var c=document.createElement("div");c.innerHTML=b;b=c.firstChild}return jQuery(a).prepend(b)[0].firstChild};mini.after=function(a,b){if("string"==typeof b)if("#"==b.charAt(0))b=mini.byId(b);else{var c=document.createElement("div");c.innerHTML=b;b=c.firstChild}if(b&&a)return a.nextSibling?a.parentNode.insertBefore(b,a.nextSibling):a.parentNode.appendChild(b),b};mini.before=function(a,b){if("string"==typeof b)if("#"==b.charAt(0))b=mini.byId(b);else{var c=document.createElement("div");c.innerHTML=b;b=c.firstChild}if(b&&a)return a.parentNode.insertBefore(b,a),b};mini.__wrap=document.createElement("div");mini.createElements=function(a){mini.removeChilds(mini.__wrap);var b=0==a.indexOf("\x3ctr");b&&(a="\x3ctable\x3e"+a+"\x3c/table\x3e");mini.__wrap.innerHTML=a;return b?mini.__wrap.firstChild.rows:mini.__wrap.childNodes};mini_byId=function(a,b){if("string"==typeof a){"#"==a.charAt(0)&&(a=a.substr(1));var c=document.getElementById(a);if(c)return c;if(b&&!mini.isAncestor(document.body,b)){for(var d=b.getElementsByTagName("*"),e=0,f=d.length;e<f;e++)if(c=d[e],c.id==a)return c;c=null}return c}return a};mini_hasClass=function(a,b){if(a=mini.byId(a))return a.className?-1!=String(a.className).split(" ").indexOf(b):!1};mini_addClass=function(a,b){b&&0==mini.hasClass(a,b)&&jQuery(a).addClass(b)};mini_removeClass=function(a,b){b&&jQuery(a).removeClass(b)};var _ceil=function(a){return Math.ceil(parseFloat(a))};mini_getMargins=function(a){a=mini.byId(a);a=jQuery(a);return{top:_ceil(a.css("margin-top"),10)||0,left:_ceil(a.css("margin-left"),10)||0,bottom:_ceil(a.css("margin-bottom"),10)||0,right:_ceil(a.css("margin-right"),10)||0}};mini_getBorders=function(a){a=mini.byId(a);a=jQuery(a);return{top:_ceil(a.css("border-top-width"),10)||0,left:_ceil(a.css("border-left-width"),10)||0,bottom:_ceil(a.css("border-bottom-width"),10)||0,right:_ceil(a.css("border-right-width"),10)||0}};mini_getPaddings=function(a){a=mini.byId(a);a=jQuery(a);return{top:_ceil(a.css("padding-top"),10)||0,left:_ceil(a.css("padding-left"),10)||0,bottom:_ceil(a.css("padding-bottom"),10)||0,right:_ceil(a.css("padding-right"),10)||0}};mini_setWidth=function(a,b){a=mini.byId(a);b=parseInt(b);if(!isNaN(b)&&a){if(jQuery.boxModel){var c=mini.getPaddings(a),d=mini.getBorders(a);b=b-c.left-c.right-d.left-d.right}0>b&&(b=0);a.style.width=b+"px"}};mini_setHeight=function(a,b){a=mini.byId(a);b=parseInt(b);if(!isNaN(b)&&a){if(jQuery.boxModel){var c=mini.getPaddings(a),d=mini.getBorders(a);b=b-c.top-c.bottom-d.top-d.bottom}0>b&&(b=0);a.style.height=b+"px"}};mini_getWidth=function(a,b){a=mini.byId(a);return"none"==a.style.display||"text/javascript"==a.type?0:b?jQuery(a).width():jQuery(a).outerWidth()};mini_getHeight=function(a,b){a=mini.byId(a);return"none"==a.style.display||"text/javascript"==a.type?0:b?jQuery(a).height():jQuery(a).outerHeight()};mini_setBox=function(a,b,c,d,e){void 0===c&&(c=b.y,d=b.width,e=b.height,b=b.x);mini.setXY(a,b,c);mini.setWidth(a,d);mini.setHeight(a,e)};mini_getBox=function(a){var b=mini.getXY(a);a={x:b[0],y:b[1],width:mini.getWidth(a),height:mini.getHeight(a)};a.left=a.x;a.top=a.y;a.right=a.x+a.width;a.bottom=a.y+a.height;return a};mini_setStyle=function(a,b){if((a=mini.byId(a))&&"string"==typeof b)for(var c=jQuery(a),d=b.toLowerCase().split(";"),e=0,f=d.length;e<f;e++){var g=d[e].split(":");if(1<g.length)if(2<g.length){var k=g[0].trim();g.removeAt(0);g=g.join(":").trim();c.css(k,g)}else c.css(g[0].trim(),g[1].trim())}};mini_getStyle=function(){var a=document.defaultView;return new Function("el","style",["style.indexOf('-')\x3e-1 \x26\x26 (style\x3dstyle.replace(/-(\\w)/g,function(m,a){return a.toUpperCase()}));style\x3d\x3d'float' \x26\x26 (style\x3d'",a?"cssFloat":"styleFloat","');return el.style[style] || ",a?"window.getComputedStyle(el, null)[style]":"el.currentStyle[style]"," || null;"].join(""))}();mini_isAncestor=function(a,b){var c=!1;a=mini.byId(a);b=mini.byId(b);if(a===b)return!0;if(a&&b)if(a.contains)try{return a.contains(b)}catch(d){return!1}else{if(a.compareDocumentPosition)return!!(a.compareDocumentPosition(b)&16);for(;b=b.parentNode;)c=b==a||c}return c};mini_findParent=function(a,b,c){a=mini.byId(a);var d=document.body,e=0,f;c=c||50;"number"!=typeof c&&(f=mini.byId(c),c=10);for(;a&&1==a.nodeType&&e<c&&a!=d&&a!=f;){if(mini.hasClass(a,b))return a;e++;a=a.parentNode}return null};mini.copyTo(mini,{byId:mini_byId,hasClass:mini_hasClass,addClass:mini_addClass,removeClass:mini_removeClass,getMargins:mini_getMargins,getBorders:mini_getBorders,getPaddings:mini_getPaddings,setWidth:mini_setWidth,setHeight:mini_setHeight,getWidth:mini_getWidth,getHeight:mini_getHeight,setBox:mini_setBox,getBox:mini_getBox,setStyle:mini_setStyle,getStyle:mini_getStyle,repaint:function(a){a||(a=document.body);mini.addClass(a,"mini-repaint");setTimeout(function(){mini.removeClass(a,"mini-repaint")},1)},getSize:function(a,b){return{width:mini.getWidth(a,b),height:mini.getHeight(a,b)}},setSize:function(a,b,c){mini.setWidth(a,b);mini.setHeight(a,c)},setX:function(a,b){b=parseInt(b);var c=jQuery(a).offset(),d=parseInt(c.top);void 0===d&&(d=c[1]);mini.setXY(a,b,d)},setY:function(a,b){b=parseInt(b);var c=jQuery(a).offset(),d=parseInt(c.left);void 0===d&&(d=c[0]);mini.setXY(a,d,b)},setXY:function(a,b,c){b={left:parseInt(b),top:parseInt(c)};jQuery(a).offset(b);jQuery.fn.jquery&&-1!=jQuery.fn.jquery.indexOf("1.4")&&jQuery(a).offset(b)},getXY:function(a){a=jQuery(a).offset();return[parseInt(a.left),parseInt(a.top)]},getViewportBox:function(){var a=jQuery(window).width(),b=jQuery(window).height(),c=jQuery(document).scrollLeft(),d=jQuery(document.body).scrollTop();0==d&&document.documentElement&&(d=document.documentElement.scrollTop);return{x:c,y:d,top:d,left:c,width:a,height:b,right:c+a,bottom:d+b}},showAt:function(a){a=jQuery.extend({el:null,x:"center",y:"center",offset:[0,0],fixed:!1,zindex:mini.getMaxZIndex(),timeout:0,timeoutHandler:null,constrain:!1,animation:!1},a);var b=jQuery(a.el)[0],c=a.x,d=a.y,e=a.offset[0],f=a.offset[1],g=a.zindex,k=a.fixed;b&&(a.timeout&&setTimeout(function(){a.timeoutHandler&&a.timeoutHandler()},a.timeout),mini.setStyle(b,";position:absolute;display:block;left:auto;top:auto;right:auto;bottom:auto;margin:0;z-index:"+g+";"),g="",a&&mini.isNumber(c)&&mini.isNumber(d)?(a.fixed&&!mini.isIE6&&(g+=";position:fixed;"),mini.setStyle(b,g),a.constrain&&(f=jQuery(window).width(),k=jQuery(window).height(),e=mini.getSize(b),c+e.width>f&&(c=f-e.width),0>c&&(c=0),d+e.height>k&&(d=k-e.height),0>d&&(d=0)),mini.setXY(b,c,d)):("left"==c?g+="left:"+e+"px;":"right"==c?g+="right:"+e+"px;":(e=mini.getSize(b),g+="left:50%;margin-left:"+.5*-e.width+"px;"),"top"==d?g+="top:"+f+"px;":"bottom"==d?g+="bottom:"+f+"px;":(e=mini.getSize(b),g+="top:50%;margin-top:"+.5*-e.height+"px;"),k&&!mini.isIE6&&(g+="position:fixed"),mini.setStyle(b,g)))},getChildNodes:function(a,b){if(a=mini.byId(a)){for(var c=a.childNodes,d=[],e=0,f=c.length;e<f;e++){var g=c[e];1!=g.nodeType&&!0!==b||d.push(g)}return d}},removeNode:isIE?function(){var a;return function(b){b&&"BODY"!=b.tagName&&(a=a||document.createElement("div"),a.appendChild(b),a.innerHTML="")}}():function(a){a&&a.parentNode&&"BODY"!=a.tagName&&a.parentNode.removeChild(a)},removeChilds:function(a,b){if(a=mini.byId(a))for(var c=mini.getChildNodes(a,!0),d=0,e=c.length;d<e;d++){var f=c[d];b&&f==b||a.removeChild(c[d])}},isAncestor:mini_isAncestor,findParent:mini_findParent,findChild:function(a,b){a=mini.byId(a);for(var c=a.getElementsByTagName("*"),d=0,e=c.length;d<e;d++)if(a=c[d],mini.hasClass(a,b))return a},isAncestor:function(a,b){var c=!1;a=mini.byId(a);b=mini.byId(b);if(a===b)return!0;if(a&&b)if(a.contains)try{return a.contains(b)}catch(d){return!1}else{if(a.compareDocumentPosition)return!!(a.compareDocumentPosition(b)&16);for(;b=b.parentNode;)c=b==a||c}return c},getOffsetsTo:function(a,b){var c=this.getXY(a),d=this.getXY(b);return[c[0]-d[0],c[1]-d[1]]},scrollIntoView:function(a,b,c,d){b=mini.byId(b)||document.body;var e=this.getOffsetsTo(a,b),f=e[0]+b.scrollLeft,e=e[1]+b.scrollTop,g=e+a.offsetHeight,k=f+a.offsetWidth,l=b.clientHeight,n=parseInt(b.scrollTop,10),p=parseInt(b.scrollLeft,10),q=p+b.clientWidth;!1!==d&&(a.offsetHeight>l||e<n?b.scrollTop=e:g>n+l&&(b.scrollTop=g-l),b.scrollTop=b.scrollTop);!1!==c&&(a.offsetWidth>b.clientWidth||f<p?b.scrollLeft=f:k>q&&(b.scrollLeft=k-b.clientWidth),b.scrollLeft=b.scrollLeft);return this},getScrollOffset:function(){if(!mini._scrollOffset){var a=document.createElement("div");a.style.cssText="width:100px;background:#eee;height:50px;overflow:scroll;padding:1px;position:absolute;left:-1000px;top:0;box-sizing:content-box;-moz-box-sizing: content-box;";document.body.appendChild(a);mini._scrollOffset=a.offsetWidth-a.clientWidth;a.parentNode.removeChild(a)}return mini._scrollOffset},setOpacity:function(a,b){jQuery(a).css({opacity:b})},selectable:function(a,b){a=mini.byId(a);b?(jQuery(a).removeClass("mini-unselectable"),isIE?a.unselectable="off":(a.style.MozUserSelect="",a.style.KhtmlUserSelect="",a.style.UserSelect="")):(jQuery(a).addClass("mini-unselectable"),isIE?a.unselectable="on":(a.style.MozUserSelect="none",a.style.UserSelect="none",a.style.KhtmlUserSelect="none"))},selectRange:function(a,b,c){if(a.createTextRange){var d=a.createTextRange();d.moveStart("character",b);d.moveEnd("character",c-a.value.length);d.select()}else a.setSelectionRange&&a.setSelectionRange(b,c);try{a.focus()}catch(e){}},getSelectRange:function(a){if(a=mini.byId(a)){try{a.focus()}catch(d){}var b;if(a.createTextRange&&document.selection){var c=document.selection.createRange().duplicate();c.moveEnd("character",a.value.length);b=""===c.text?a.value.length:a.value.lastIndexOf(c.text);c=document.selection.createRange().duplicate();c.moveStart("character",-a.value.length);a=c.text.length}else b=a.selectionStart,a=a.selectionEnd;return[b,a]}}});(function(){var a={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},b=document.createElement("div");b.setAttribute("class","t");var c="t"===b.className;mini.setAttr=function(b,e,f){b.setAttribute(c?e:a[e]||e,f)};mini.getAttr=function(b,e){if("height"==e)return jQuery(b).attr("height");if("value"==e&&(isIE6||isIE7)){var d=b.attributes[e];return d?d.value:null}if(!b.getAttribute)return null;d=b.getAttribute(c?e:a[e]||e);if("function"==typeof d||"maxLength"==e){var g=b.attributes[e];g&&(d=g.value)}!d&&"onload"==e&&(g=b.getAttributeNode?b.getAttributeNode(e):null)&&(d=g.nodeValue);return d}})();mini_preventDefault=function(){window.event&&(window.event.returnValue=!1)};mini_stopPropogation=function(){window.event&&(window.event.cancelBubble=!0)};mini_onOne=function(a,b,c,d){a&&(b="on"+b.toLowerCase(),a[b]=function(a){a=a||window.event;a.target||(a.target=a.srcElement);a.preventDefault||(a.preventDefault=mini_preventDefault);a.stopPropogation||(a.stopPropogation=mini_stopPropogation);if(!1===c.call(d,a))return!1})};mini_on=function(a,b,c,d){a=mini.byId(a);d=d||a;if(!(a&&b&&c&&d)||mini.findListener(a,b,c,d))return!1;var e=mini.createDelegate(c,d);mini.listeners.push([a,b,c,d,e]);mini.isFirefox&&"mousewheel"==b&&(b="DOMMouseScroll");jQuery(a).bind(b,e)};mini_un=function(a,b,c,d){a=mini.byId(a);d=d||a;if(!(a&&b&&c&&d))return!1;c=mini.findListener(a,b,c,d);if(!c)return!1;mini._destroying||mini.listeners.remove(c);mini.isFirefox&&"mousewheel"==b&&(b="DOMMouseScroll");jQuery(a).unbind(b,c[4])};mini.copyTo(mini,{listeners:[],on:mini_on,un:mini_un,_getListeners:function(){return mini.listeners},findListener:function(a,b,c,d){a=mini.byId(a);d=d||a;if(!(a&&b&&c&&d))return!1;for(var e=mini._getListeners(),f=e.length-1;0<=f;f--){var g=e[f];try{if(g[0]==a&&g[1]==b&&g[2]==c&&g[3]==d)return g}catch(k){}}},clearEvent:function(a,b){a=mini.byId(a);if(!a)return!1;if(mini._destroying)jQuery(a).unbind();else{for(var c=mini._getListeners(),d=c.length-1;0<=d;d--){var e=c[d];e[0]==a&&(b&&b!=e[1]||mini.un(a,e[1],e[2],e[3]))}a.onmouseover=a.onmousedown=null}}});mini.__windowResizes=[];mini.onWindowResize=function(a,b){mini.__windowResizes.push([a,b])};mini.on(window,"resize",function(a){for(var b=mini.__windowResizes,c=0,d=b.length;c<d;c++){var e=b[c];e[0].call(e[1],a)}});mini.htmlEncode=function(a){if("string"!==typeof a)return a;if(0==a.length)return"";a=a.replace(/&/g,"\x26amp;");a=a.replace(/</g,"\x26lt;");a=a.replace(/>/g,"\x26gt;");a=a.replace(/ /g,"\x26nbsp;");a=a.replace(/\'/g,"\x26#39;");return a=a.replace(/\"/g,"\x26quot;")};mini.htmlDecode=function(a){if("string"!==typeof a)return a;if(0==a.length)return"";a=a.replace(/&gt;/g,"\x26");a=a.replace(/&lt;/g,"\x3c");a=a.replace(/&gt;/g,"\x3e");a=a.replace(/&nbsp;/g," ");a=a.replace(/&#39;/g,"'");return a=a.replace(/&quot;/g,'"')};mini.copyTo(Array.prototype,{add:Array.prototype.enqueue=function(a){this[this.length]=a;return this},getRange:function(a,b){for(var c=[],d=a;d<=b;d++){var e=this[d];e&&(c[c.length]=e)}return c},addRange:function(a){for(var b=0,c=a.length;b<c;b++)this[this.length]=a[b];return this},clear:function(){this.length=0;return this},clone:function(){return 1===this.length?[this[0]]:Array.apply(null,this)},contains:function(a){return 0<=this.indexOf(a)},indexOf:function(a,b){for(var c=this.length,d=0>b?Math.max(0,c+b):b||0;d<c;d++)if(this[d]===a)return d;return-1},dequeue:function(){return this.shift()},insert:function(a,b){this.splice(a,0,b);return this},insertRange:function(a,b){for(var c=b.length-1;0<=c;c--)this.splice(a,0,b[c]);return this},remove:function(a){a=this.indexOf(a);0<=a&&this.splice(a,1);return 0<=a},removeAt:function(a){var b=this[a];this.splice(a,1);return b},removeRange:function(a){a=a.clone();for(var b=0,c=a.length;b<c;b++)this.remove(a[b])}});mini.isShowBackdrop=!(mini.isIE&&8>=mini.IE_V);mini._MaskID=1;mini._MaskObjects={};mini.mask=function(a){var b=mini.byId(a);mini.isElement(b)?a={el:b}:"string"==typeof a&&(a={html:a});a=mini.copyTo({html:"",cls:"",style:"",backStyle:""},a);a.el=mini.byId(a.el);a.el||(a.el=document.body);b=a.el;mini.unmask(a.el);b._maskid=mini._MaskID++;mini._MaskObjects[b._maskid]=a;var c=mini.append(b,'\x3cdiv class\x3d"mini-mask"\x3e\x3cdiv class\x3d"mini-mask-background" style\x3d"'+a.backStyle+'"\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-mask-msg '+a.cls+'" style\x3d"'+a.style+'"\x3e'+a.html+"\x3c/div\x3e\x3c/div\x3e");b==document.body&&mini.addClass(c,"mini-fixed");a.maskEl=c;mini.isNull(a.opacity)||mini.setOpacity(c.firstChild,a.opacity);var d=c.lastChild;d.style.display="none";setTimeout(function(){d.style.display="block";var a=mini.getSize(d);d.style.marginLeft=-a.width/2+"px";d.style.marginTop=-a.height/2+"px";d.style.zIndex=mini.getMaxZIndex()},0)};mini.unmask=function(a){a=mini.byId(a);a||(a=document.body);var b=mini._MaskObjects[a._maskid];b&&(delete mini._MaskObjects[a._maskid],a=b.maskEl,b.maskEl=null,a&&a.parentNode&&a.parentNode.removeChild(a))};mini.showMaskLoading=function(a){a=$.extend({el:document.body,cls:"mini-mask-loading",html:mini.Control.prototype.loadingMsg||"Loading..."},a);return mini.mask(a)};mini.Cookie={get:function(a){for(var b=document.cookie.split("; "),c=null,d=0;d<b.length;d++){var e=b[d].split("\x3d");a==e[0]&&(c=e)}return c?(a=c[1],void 0===a?a:unescape(a)):null},set:function(a,b,c,d){var e=new Date;null!=c&&(e=new Date(e.getTime()+864E5*c));document.cookie=a+"\x3d"+escape(b)+(null==c?"":"; expires\x3d"+e.toGMTString())+";path\x3d/"+(d?"; domain\x3d"+d:"")},del:function(a,b){this.set(a,null,-100,b)}};mini.copyTo(mini,{treeToArray:function(a,b,c,d,e){b||(b="children");for(var f=[],g=0,k=a.length;g<k;g++){var l=a[g];f[f.length]=l;d&&(l[d]=e);var n=l[b];n&&0<n.length&&(l=this.treeToArray(n,b,c,d,l[c]),f.addRange(l))}return f},arrayToTree:function(a,b,c,d){b||(b="children");c=c||"_id";d=d||"_pid";for(var e=[],f={},g=0,k=a.length;g<k;g++){var l=a[g];if(l){var n=mini._getMap(c,l);null!==n&&void 0!==n&&(f[n]=l);delete l[b]}}g=0;for(k=a.length;g<k;g++)l=a[g],c=mini._getMap(d,l),(c=f[c])?(c[b]||(c[b]=[]),c[b].push(l)):e.push(l);return e}});mini.treeToList=mini.treeToArray;mini.listToTree=mini.arrayToTree;function UUID(){for(var a=[],b="0123456789ABCDEF".split(""),c=0;36>c;c++)a[c]=Math.floor(16*Math.random());a[14]=4;a[19]=a[19]&3|8;for(c=0;36>c;c++)a[c]=b[a[c]];a[8]=a[13]=a[18]=a[23]="-";return a.join("")}String.format=function(a){var b=Array.prototype.slice.call(arguments,1);return(a||"").replace(/\{(\d+)\}/g,function(a,d){return b[d]})};String.prototype.trim=function(){var a=/^\s+|\s+$/g;return function(){return this.replace(a,"")}}();mini.copyTo(mini,{measureText:function(a,b,c){this.measureEl||(this.measureEl=mini.append(document.body,"\x3cdiv\x3e\x3c/div\x3e"));this.measureEl.style.cssText="position:absolute;left:-1000px;top:-1000px;visibility:hidden;";if("string"==typeof a)this.measureEl.className=a;else{this.measureEl.className="";a=jQuery(a);for(var d=jQuery(this.measureEl),e="font-size font-style font-weight font-family line-height text-transform letter-spacing".split(" "),f=0,g=e.length;f<g;f++){var k=e[f];d.css(k,a.css(k))}}c&&mini.setStyle(this.measureEl,c);this.measureEl.innerHTML=b;return mini.getSize(this.measureEl)}});"undefined"==typeof mini_layoutOnParse&&(mini_layoutOnParse=!0);mini.enableLayout=!0;mini.autoParse=!0;jQuery(function(){mini.updateDevice();mini.autoParse&&setTimeout(function(){var a=document.documentElement;(isIE6||isIE7)&&("hidden"==mini.getStyle(document.body,"overflow")||a&&"hidden"==mini.getStyle(a,"overflow"))&&(jQuery(document.body).css("overflow","visible"),a&&jQuery(a).css("overflow","visible"));mini.__LastWindowWidth=document.documentElement.clientWidth;mini.__LastWindowHeight=document.documentElement.clientHeight;mini.isReady=!0;mini.parse(null,mini_layoutOnParse);mini._FireBindEvents()},1)});mini_onload=function(a){mini.on(window,"resize",mini_onresize)};mini.on(window,"load",mini_onload);mini.__LastWindowWidth=document.documentElement.clientWidth;mini.__LastWindowHeight=document.documentElement.clientHeight;mini.doWindowResizeTimer=null;mini.allowLayout=!0;mini_onresize=function(a){mini.updateDevice();mini.doWindowResizeTimer&&clearTimeout(mini.doWindowResizeTimer);mini.WindowVisible=mini.isWindowDisplay();if(0!=mini.WindowVisible&&0!=mini.allowLayout)if("undefined"!=typeof Ext)mini.doWindowResizeTimer=setTimeout(function(){var a=document.documentElement.clientWidth,c=document.documentElement.clientHeight;if(mini.__LastWindowWidth!=a||mini.__LastWindowHeight!=c)mini.__LastWindowWidth=a,mini.__LastWindowHeight=c,mini.layout(null,!1);mini.doWindowResizeTimer=null},300);else{a=100;try{parent&&parent!=window&&parent.mini&&(a=0)}catch(b){}mini.doWindowResizeTimer=setTimeout(function(){var a=document.documentElement.clientWidth,c=document.documentElement.clientHeight;if(mini.__LastWindowWidth!=a||mini.__LastWindowHeight!=c)mini.__LastWindowWidth=a,mini.__LastWindowHeight=c,mini.layout(null,!1);mini.doWindowResizeTimer=null},a)}};mini.isDisplay=function(a,b){for(var c=b||document.body;;){if(null==a||!a.style||a&&a.style&&"none"==a.style.display)return!1;if(a==c)break;a=a.parentNode}return!0};mini.isWindowDisplay=function(){try{var a=window.parent;if(a!=window){for(var b=a.document.getElementsByTagName("iframe"),c=a.document.getElementsByTagName("frame"),d=[],e=0,f=b.length;e<f;e++)d.push(b[e]);e=0;for(f=c.length;e<f;e++)d.push(c[e]);b=null;e=0;for(f=d.length;e<f;e++){var g=d[e];if(g.contentWindow==window){b=g;break}}return b?mini.isDisplay(b,a.document.body):!1}return!0}catch(k){return!0}};mini.WindowVisible=mini.isWindowDisplay();mini.layoutIFrames=function(a){if(document.body){a||(a=document.body);var b=a.getElementsByTagName("iframe");setTimeout(function(){for(var c=0,d=b.length;c<d;c++){var e=b[c];try{mini.isDisplay(e)&&mini.isAncestor(a,e)&&(e.contentWindow.mini&&(0==e.contentWindow.mini.WindowVisible?(e.contentWindow.mini.WindowVisible=e.contentWindow.mini.isWindowDisplay(),e.contentWindow.mini.layout()):e.contentWindow.mini.layout(null,!1)),e.contentWindow.mini.layoutIFrames())}catch(f){}}},30)}};jQuery.ajaxSetup({cache:!1});isIE&&setInterval(function(){},2E4);mini_unload=function(a){try{var b=mini._getTopWindow();b[mini._WindowID]="";delete b[mini._WindowID]}catch(f){}var c=document.body.getElementsByTagName("iframe");if(0<c.length){var d=[];a=0;for(b=c.length;a<b;a++)d.push(c[a]);a=0;for(b=d.length;a<b;a++)try{var e=d[a];e._ondestroy=null;e.onload=function(){};jQuery(e).unbind("load");e.src="";if(mini.isIE)try{e.contentWindow.document.write(""),e.contentWindow.document.close()}catch(f){}e.parentNode&&e.parentNode.removeChild(e)}catch(f){}}mini._destroying=!0;e=mini.getComponents().clone();a=0;for(b=e.length;a<b;a++)c=e[a],!0!==c.destroyed&&c.destroy(!1);e.length=0;e=null;mini.clearEvent(window);mini.clearEvent(document);mini.un(window,"unload",mini_unload);mini.un(window,"load",mini_onload);mini.un(window,"resize",mini_onresize);mini.components={};mini.classes={};mini.uiClasses={};mini.uids={};mini.listeners.length=0;mini._topWindow=null;window.mini=null;window.Owner=null;window.CloseOwnerWindow=null};mini.on(window,"unload",mini_unload);function __BindIFrames(){}mini.zIndex=1E3;mini.zindex=mini.getMaxZIndex=function(){return mini.zIndex++};function js_isTouchDevice(){try{return document.createEvent("TouchEvent"),!0}catch(a){return!1}}function js_touchScroll(a){if(js_isTouchDevice()){a="string"==typeof a?document.getElementById(a):a;var b=0;a.addEventListener("touchstart",function(a){b=this.scrollTop+a.touches[0].pageY;a.preventDefault()},!1);a.addEventListener("touchmove",function(a){this.scrollTop=b-a.touches[0].pageY;a.preventDefault()},!1)}}mini._placeholder=function(a){function b(){var b=a._placeholder_label;if(b){var c=a.getAttribute("placeholder");c||(c=a.placeholder);a.value?b.style.display="none":(b.innerHTML=c,b.style.display="")}}if((a=mini.byId(a))&&isIE&&!isIE10&&!isIE11)if(a._placeholder)b();else{a._placeholder=!0;var c=document.createElement("label");c.className="mini-placeholder-label";a.parentNode.appendChild(c);a._placeholder_label=c;c.onmousedown=function(){try{a.focus()}catch(d){}};a.onpropertychange=function(a){a=a||window.event;"value"==a.propertyName&&b()};b();mini.on(a,"focus",function(b){a.readOnly||(c.style.display="none")});mini.on(a,"blur",function(a){b()})}};mini.ajax=function(a){a.dataType||(a.dataType="text");return window.jQuery.ajax(a)};mini._evalAjaxData=function(a,b){var c=a;"string"==typeof a&&(c=window.eval("("+a+")"),"function"==typeof c&&(c=c.call(b)));return c};var hasOn=!!jQuery.fn.on;jQuery.fn.on||(jQuery.fn.on=function(a,b,c,d){return this.delegate(b,a,c,d)});mini._lastDevice;mini.updateDevice=function(){var a="mini-xs",b=jQuery(window).width(),c="xs";768<b&&(a+=" mini-sm",c="sm");992<b&&(a+=" mini-md",c="md");1200<b&&(a+=" mini-lg",c="lg");a+=" mini-"+c+"-active";mini._lastDevice!=c&&(jQuery(document.documentElement).removeClass("mini-xs mini-sm mini-md mini-lg mini-xs-active mini-sm-active mini-md-active mini-lg-active ").addClass(a),mini._lastDevice!=c&&jQuery(window).triggerHandler("devicechange",c),mini._lastDevice=c)};mini.getClipboard=function(a){var b="";window.clipboardData?b=window.clipboardData.getData("Text"):a&&(b=a.clipboardData.getData("text/plain"));return b};mini.setClipboard=function(a){window.clipboardData?window.clipboardData.setData("Text",a):(a=jQuery('\x3ctextarea style\x3d"position:absolute;left:0;top:-1000px;width:100px;z-index:1000;"\x3e\x3c/textarea\x3e').appendTo("body").val(a)[0],a.select(),a.focus(),document.execCommand("copy"))};mini.getActiveElement=function(){try{return document.activeElement}catch(a){}};mini.getScrollOffset=function(){if(!mini._scrollOffset){var a=document.createElement("div");a.style.cssText="z-index:1000;width:100px;background:#eee;height:50px;overflow:auto;position:absolute;left:100px;top:100px;";a.innerHTML='\x3cdiv style\x3d"width:50px;height:200px;"\x3e\x3c/div\x3e';document.body.appendChild(a);mini._scrollOffset=a.offsetWidth-a.clientWidth;a.parentNode.removeChild(a)}return mini._scrollOffset};"undefined"==typeof window.rootpath&&(rootpath="/");mini.loadJS=function(a,b){if(a)return"function"==typeof b?mini.loadJS._async(a,b):mini.loadJS._sync(a)};mini.loadJS._js={};mini.loadJS._async=function(a,b){function c(){for(var a=0;a<d.callbacks.length;a++){var b=d.callbacks[a];b&&b()}d.callbacks.length=0}var d=mini.loadJS._js[a];d||(d=mini.loadJS._js[a]={create:!1,loaded:!1,callbacks:[]});if(d.loaded)setTimeout(function(){b()},1);else if(d.callbacks.push(b),!d.create){d.create=!0;var e=document.getElementsByTagName("head")[0],f=document.createElement("script");f.src=a;f.type="text/javascript";setTimeout(function(){document.all?f.onreadystatechange=function(){if("loaded"==f.readyState||"complete"==f.readyState)c(),d.loaded=!0}:f.onload=function(){c();d.loaded=!0};e.appendChild(f)},1);return f}};mini.loadJS._sync=function(a){if(!loadJS._js[a]){loadJS._js[a]={create:!0,loaded:!0,callbacks:[]};var b=document.getElementsByTagName("head")[0],c=document.createElement("script");c.type="text/javascript";c.text=loadText(a);b.appendChild(c);return c}};mini.loadText=function(a){var b="",c=document.all&&"file:"==location.protocol,d=null;c?d=new ActiveXObject("Microsoft.XMLHTTP"):window.XMLHttpRequest?d=new XMLHttpRequest:window.ActiveXObject&&(d=new ActiveXObject("Microsoft.XMLHTTP"));d.onreadystatechange=function(){4==d.readyState&&d.status==(c?0:200)&&(b=d.responseText)};var e="_t\x3d"+(new Date).getTime(),e=-1==a.indexOf("?")?"?"+e:"\x26"+e;d.open("GET",a+e,!1);d.send(null);return b};mini.loadJSON=function(a){a=loadText(a);return window.eval("("+a+")")};mini.loadCSS=function(a,b){if(a&&!loadCSS._css[a]){var c=document.getElementsByTagName("head")[0],d=document.createElement("link");b&&(d.id=b);d.href=a;d.rel="stylesheet";d.type="text/css";c.appendChild(d);return d}};mini.loadCSS._css={};mini.innerHTML=function(a,b){"string"==typeof a&&(a=document.getElementById(a));a&&(a.innerHTML='\x3cdiv style\x3d"display:none"\x3e\x26nbsp;\x3c/div\x3e'+b,mini.__executeScripts(a))};mini.__executeScripts=function(a){for(var b=a.getElementsByTagName("script"),c=0,d=b.length;c<d;c++){var e=b[c],f=e.src;f?mini.loadJS(f):(f=document.createElement("script"),f.type="text/javascript",f.text=e.text,a.appendChild(f))}for(c=b.length-1;0<=c;c--)e=b[c],e.parentNode.removeChild(e)};mini.supportRem=function(){var a=!1,b=document.createElement("span");try{b.style.fontSize="13rem",/rem/.test(b.style.fontSize)&&(a=!0)}catch(c){}return a}();mini.getFontSizeRatio=function(){this._fontSizeRatio||(this._fontSizeRatio=mini.Cookie.get("_font_size_ratio_")||parseInt($("html").css("fontSize"))/window.HtmlBaseFontSize);return this._fontSizeRatio};mini.setFontSizeRatio=function(a){this._fontSizeRatio=a};mini.copyTo(mini,{overwrite:function(a,b){var c;if("function"==typeof a)c=a.prototype;else if("object"==typeof a)c=a;else return this;for(var d in b)c[d]=b[d];return a}});if(void 0===window._rootPath)var _rootPath=function(){var a=location.pathname;0===a.indexOf("/")&&(a=a.substring(1));return"/"+a.split("/")[0]}();mini.loadJS._sync=function(a){if(!mini.loadJS._js[a]){mini.loadJS._js[a]={create:!0,loaded:!0,callbacks:[]};var b=document.getElementsByTagName("head")[0],c=document.createElement("script");c.type="text/javascript";c.text=mini.loadText(a);b.appendChild(c);return c}};mini.loadCSS=function(a,b){if(a&&!mini.loadCSS._css[a]){var c=document.getElementsByTagName("head")[0],d=document.createElement("link");b&&(d.id=b);d.href=a;d.rel="stylesheet";d.type="text/css";c.appendChild(d);return mini.loadCSS._css[a]=d}};mini.isDisplay=function(a,b,c){"function"===typeof b&&(c=b,b=void 0);for(b=b||document.body;;){if(null==a||!a.style)return!1;if(a&&("none"==jQuery(a).css("display")||mini.isFirefox&&"IFRAME"==a.nodeName&&0===a.getBoundingClientRect().width&&0===a.getBoundingClientRect().height&&0===a.getBoundingClientRect().x&&0===a.getBoundingClientRect().y))if(c){if(!0!==c(a))return!1}else return!1;if(a==b)break;a=a.parentNode}return!0};mini.loadCSS._css={};mini.externalSrc=_rootPath+"/lib/";mini_useShims=!0;mini_debugger=!1;mini.showPageWarning=function(a){var b=$("#mini-pageWarning");b.length||(b=$("\x3cdiv\x3e\x3c/div\x3e",{id:"mini-pageWarning",style:"position:fixed;top:30%;left:50%;margin-left:-280px;width:560px;height:40px;color:#dd2727;background:#f2dede;text-align:center;border-radius:3px;line-height:40px;font-size:13px;"}).html(a.html).append($('\x3cspan title\x3d "\u5173\u95ed" style\x3d "position: absolute;top:0;right:10px;font-size:18px;line-height:40px;cursor:pointer" onclick\x3d \'$("#mini-pageWarning").remove();\'\x3e\u00d7\x3c/span\x3e')).css("z-index",a.zIndex||9999).appendTo("body"),setTimeout(function(){b.remove();b=null},a.timeout||15E3))};var _oGetAttrs=mini.Control.prototype.getAttrs;mini.overwrite(mini.Control,{getAttrs:function(a){var b=_oGetAttrs.call(this,a);this.getExtraAttrs&&(a=this.getExtraAttrs.call(this,a),mini.copyTo(b,a));return b}});mini.overwrite(mini.Container,{getAttrs:function(a){return mini.Container.superclass.getAttrs.call(this,a)}});mini.getValidErrorToolTip=function(){mini._errorToolTip||(mini._errorToolTip=new mini.ToolTip,mini._errorToolTip.set({selector:".mini-error[data-tooltip]",placement:"topright",trigger:"focus",theme:"error",defaultTheme:"error"}),$(document).on("mousewheel",function(){mini._errorToolTip.close()}));return mini._errorToolTip};mini.overwrite(mini.ValidatorBase,{__doUpdateValid:function(){if(this.el){this.removeCls(this._errorCls);this.removeCls(this._invalidCls);"border"==this.errorMode&&(this.el.title="");if(0==this._IsValid)switch(mini.getValidErrorToolTip(),jQuery(this.el).attr("data-tooltip",this.errorText),this.errorMode){case "icon":this.addCls(this._errorCls);var a=this.getErrorIconEl();a&&(a.title=this.errorText,jQuery(a).attr("data-placement",this.errorTooltipPlacement));break;case "border":this.addCls(this._invalidCls),this.el.title=this.errorText;default:this._RemoveErrorIcon()}else this._RemoveErrorIcon(),jQuery(this.el).attr("data-tooltip","");this.doLayout()}}});mini.CheckColumn=function(a){return mini.copyTo({width:30,cellCls:"mini-checkcolumn",headerCls:"mini-checkcolumn",hideable:!0,_multiRowSelect:!0,header:function(a){a='\x3cspan class\x3d"mini-grid-checkbox mini-icon '+(a._checkedAll?"mini-grid-checkbox-checked":"")+'" id\x3d"'+(this.uid+"checkall")+'"\x3e\x3c/span\x3e';0==this.multiSelect&&(a="");return a},getCheckId:function(a,c){return this._gridUID+"$checkcolumn$"+a[this._rowIdField]+"$"+c._id},init:function(a){a.on("_selectchange",this.__OnSelectionChanged,this);a.on("HeaderCellClick",this.__OnHeaderCellClick,this);var b=this;a.on("removerow",function(){a.data&&0==a.data.length&&b._doCheckState(a)});b=this;a.on("load",function(){b._doCheckState(a)},this)},renderer:function(a){var b=this.getCheckId(a.record,a.column);a.sender.isSelected&&a.sender.isSelected(a.record);return'\x3cspan class\x3d"mini-grid-'+(a.sender.getMultiSelect()?"checkbox":"radio")+' mini-icon" id\x3d"'+b+'"\x3e\x3c/span\x3e'},__OnHeaderCellClick:function(a){var b=a.sender;if(a.column==this){var d=document.getElementById(b.uid+"checkall");d&&(this._checkedAll=a=!mini.hasClass(d,"mini-grid-checkbox-checked"),b.getMultiSelect()?a?(a=b.getDataView(),b.selects(a),mini.addClass(d,"mini-grid-checkbox-checked"),setTimeout(function(){mini.addClass(d,"mini-grid-checkbox-checked")},30)):(a=b.getDataView(),b.deselects(a),mini.removeClass(d,"mini-grid-checkbox-checked")):(b.deselectAll(),a&&(b.select(0),mini.addClass(d,"mini-grid-checkbox-checked"))),b.fire("checkall"))}},__OnSelectionChanged:function(a){var b=a.sender;a=b.toArray();var d=this,e=b.isVirtualScroll(),f=b._viewRegion,e=e&&f?f.start:-1,f=f?f.end:-1;if(-1!=e)for(b.getVisibleRows();e<f;e++);e=0;for(f=a.length;e<f;e++);this._timer||(this._timer=setTimeout(function(){d._doCheckState(b);d._timer=null},10))},_doCheckState:function(a){var b=document.getElementById(a.uid+"checkall");if(b){var d=a.getSelecteds();a=a.isTree?a.getList().length:a.getData().length;d.length==a&&0!=a?(jQuery(b).addClass("mini-grid-checkbox-checked"),this._checkedAll=!0):(jQuery(b).removeClass("mini-grid-checkbox-checked"),this._checkedAll=!1)}}},a)};mini._Columns.checkcolumn=mini.CheckColumn;mini.ExpandColumn=function(a){return mini.copyTo({width:30,headerAlign:"center",align:"center",draggable:!1,cellStyle:"padding:0",cellCls:"mini-grid-expandCell",hideable:!0,renderer:function(a){return'\x3ci class\x3d"mini-grid-ecIcon mini-icon" \x3e\x3c/i\x3e'},init:function(a){a.on("cellclick",this.__OnCellClick,this)},__OnCellClick:function(a){var b=a.sender;if(a.column==this&&b.isShowRowDetail&&mini.findParent(a.htmlEvent.target,"mini-grid-ecIcon")){var d=b.isShowRowDetail(a.record);d?(a.cancel=!1,b.fire("beforehiderowdetail",a)):(a.cancel=!1,b.fire("beforeshowrowdetail",a));!0!==a.cancel&&(b.autoHideRowDetail&&b.hideAllRowDetail(),d?b.hideRowDetail(a.record):b.showRowDetail(a.record))}}},a)};mini._Columns.expandcolumn=mini.ExpandColumn;mini.htmlDecode=function(a){if("string"!==typeof a)return a;if(0==a.length)return"";a=a.replace(/&amp;/g,"\x26");a=a.replace(/&lt;/g,"\x3c");a=a.replace(/&gt;/g,"\x3e");a=a.replace(/&nbsp;/g," ");a=a.replace(/&#39;/g,"'");return a=a.replace(/&quot;/g,'"')};mini.createIFrame=function(a,b,c,d,e){function f(){0==n||p||setTimeout(function(){b&&b(l,q);q=!1},1)}a||(a="");e=a.split("#");a=e[0];var g="";!0!==c&&(g="_t\x3d"+Math.floor(1E6*Math.random()),a=-1==a.indexOf("?")?a+("?"+g):a+("\x26"+g));a&&-1==a.indexOf("_winid")&&(g="_winid\x3d"+mini._WindowID,a=-1==a.indexOf("?")?a+("?"+g):a+("\x26"+g));if(mini.iframeParams)for(var k in mini.iframeParams)a+="\x26"+k+"\x3d"+mini.iframeParams[k];e[1]&&(a=a+"#"+e[1]);k=(c=-1!=a.indexOf(".mht"))?a:"";k='\x3ciframe name\x3d"'+mini.newId("mini-iframe-")+'" src\x3d"'+("post"==d?"":k)+'" style\x3d"width:100%;height:100%;" allowfullscreen\x3d"true" frameborder\x3d"0"\x3e\x3c/iframe\x3e';e=document.createElement("div");var l=mini.append(e,k),n=!1;c?n=!0:setTimeout(function(){l&&("post"!=d&&(l.src=a),n=!0)},5);l.attachEvent?l.attachEvent("onload",f):l.onload=f;var p=!1,q=!0;l._ondestroy=function(){p=!0;l.src="";if(mini.isIE)try{l.contentWindow.document.write(""),l.contentWindow.document.close()}catch(t){}l=l._ondestroy=null};var r;"post"==d&&(r=jQuery("\x3cform /\x3e").attr({method:"post",action:a,enctype:"multipart/form-data",target:l.name}).hide().appendTo("body"),setTimeout(function(){r.submit()},10));return l};mini.getScrollBarWidth=function(){var a=document.createElement("div"),b=document.createElement("p");a.style.display=b.style.display="block";b.style.height="100px";a.style.padding=0;a.style.border="none";a.style.overflow="auto";a.style.height="10px";a.appendChild(b);document.body.appendChild(a);b=a.offsetWidth-a.clientWidth;a.parentNode.removeChild(a);return b};(function(){var a;if(Object.defineProperty&&!mini.isIE8)Object.defineProperty(mini,"_scrollBarWidth",{get:function(){a||(a=mini.getScrollBarWidth());return a}});else jQuery(window).on("load",function(){mini._scrollBarWidth=mini.getScrollBarWidth()})})();(function(){function a(a,b){a&&b&&jQuery.map(b,function(b,c){a.setAttribute(c,b)})}mini.reservedAttrsReg=[/title/,/data-*/];var b=mini.applyTo;mini.applyTo=function(d){d=mini.byId(d);var e;if((e=d)&&e.hasAttributes&&e.hasAttributes()){e=e.attributes;for(var f,g={},k=!1,l=0,n=e.length;l<n;l++)f=e[l].name,c(f)&&(k=!0,g[f]=e[l].value);e=k?g:null}else e=void 0;f=b.apply(this,arguments);a(this.el,e);return f};var c=function(){return Array.prototype.some?function(a){return mini.reservedAttrsReg&&mini.reservedAttrsReg.some(function(b){return b.test(a)})}:function(a){if(!mini.reservedAttrsReg||!mini.reservedAttrsReg.length)return!1;for(var b=0,c=mini.reservedAttrsReg.length;b<c;b++)if(mini.reservedAttrsReg[b].test(a))return!0;return!1}}()})();mini.Hidden=function(){mini.Hidden.superclass.constructor.apply(this,arguments)};mini.extend(mini.Hidden,mini.Control,{_clearBorder:!1,formField:!0,value:"",uiCls:"mini-hidden",_create:function(){this.el=document.createElement("input");this.el.type="hidden";this.el.className="mini-hidden"},setName:function(a){this.name=a;this.el.name=a},setValue:function(a){if(null===a||void 0===a)a="";this.value=a;if(mini.isDate(a)){var b=a.getFullYear(),c=a.getMonth()+1;a=a.getDate();this.el.value=b+"-"+(10>c?"0"+c:c)+"-"+(10>a?"0"+a:a)}else this.el.value=a},getValue:function(){return this.value},getFormValue:function(){return this.el.value}});mini.regClass(mini.Hidden,"hidden");mini.Popup=function(){mini.Popup.superclass.constructor.apply(this,arguments);this.setVisible(!1);this.setAllowDrag(this.allowDrag);this.setAllowResize(this.allowResize)};mini.extend(mini.Popup,mini.Container,{_clearBorder:!1,uiCls:"mini-popup",_create:function(){this.el=document.createElement("div");this.el.className="mini-popup";this._contentEl=this.el},_initEvents:function(){mini._BindEvents(function(){mini_onOne(this.el,"mouseover",this.__OnMouseOver,this)},this)},doLayout:function(){if(this.canLayout()){mini.Popup.superclass.doLayout.call(this);this._doShadow();var a=this.el.childNodes;if(a)for(var b=0,c=a.length;b<c;b++)mini.layout(a[b])}},destroy:function(a){this.el&&(this.el.onmouseover=null);mini._destroying||(mini.un(document,"mousedown",this.__OnBodyMouseDown,this),mini.un(window,"resize",this.__OnWindowResize,this));!1!==a&&(this._modalEl&&jQuery(this._modalEl).remove(),this.shadowEl&&jQuery(this.shadowEl).remove(),this._shimEl&&jQuery(this._shimEl).remove());this._shimEl=this.shadowEl=this._modalEl=null;mini.Popup.superclass.destroy.call(this,a)},setWidth:function(a){parseInt(a)==a&&(a+="px");this.width=a;-1!=a.indexOf("px")?mini.setWidth(this.el,a):this.el.style.width=a;this._sizeChanged()},setHeight:function(a){parseInt(a)==a&&(a+="px");this.height=a;-1!=a.indexOf("px")?mini.setHeight(this.el,a):this.el.style.height=a;this._sizeChanged()},setBody:function(a){if(a){mini.isArray(a)||(a=[a]);for(var b=0,c=a.length;b<c;b++)mini.append(this._contentEl,a[b])}},getAttrs:function(a){var b=mini.Popup.superclass.getAttrs.call(this,a);mini._ParseString(a,b,"popupEl popupCls showAction hideAction xAlign yAlign modalStyle onbeforeopen open onbeforeclose onclose".split(" "));mini._ParseBool(a,b,["showModal","showShadow","allowDrag","allowResize"]);mini._ParseInt(a,b,"showDelay hideDelay xOffset yOffset minWidth minHeight maxWidth maxHeight".split(" "));a=mini.getChildNodes(a,!0);b.body=a;return b}});mini.regClass(mini.Popup,"popup");mini.Popup_prototype={isPopup:!1,popupEl:null,popupCls:"",showAction:"mouseover",hideAction:"outerclick",showDelay:300,hideDelay:500,xAlign:"left",yAlign:"below",xOffset:0,yOffset:0,minWidth:50,minHeight:25,maxWidth:2E3,maxHeight:2E3,showModal:!1,showShadow:!0,modalStyle:"opacity:0.2",_dragCls:"mini-popup-drag",_resizeCls:"mini-popup-resize",allowDrag:!1,allowResize:!1,_unbindPopupEl:function(){this.popupEl&&(mini.un(this.popupEl,"click",this.__OnLeftClick,this),mini.un(this.popupEl,"contextmenu",this.__OnRightClick,this),mini.un(this.popupEl,"mouseover",this.__OnMouseOver,this))},_bindPopupEl:function(){this.popupEl&&(mini.on(this.popupEl,"click",this.__OnLeftClick,this),mini.on(this.popupEl,"contextmenu",this.__OnRightClick,this),mini.on(this.popupEl,"mouseover",this.__OnMouseOver,this))},doShow:function(a){var b={popupEl:this.popupEl,htmlEvent:a,cancel:!1};this.fire("BeforeOpen",b);1!=b.cancel&&(this.fire("opening",b),1!=b.cancel&&(this.popupEl?(b={},a&&(b.xy=[a.pageX,a.pageY]),this.showAtEl(this.popupEl,b)):this.show()))},doHide:function(a){a={popupEl:this.popupEl,htmlEvent:a,cancel:!1};this.fire("BeforeClose",a);1!=a.cancel&&this.close()},show:function(a,b){this.showAtPos(a,b)},showAtPos:function(a,b){this.render(document.body);a||0===a||(a="center");b||0===b||(b="middle");this.el.style.position="absolute";this.el.style.left="-2000px";this.el.style.top="-2000px";this.el.style.display="";this._measureSize();var c=mini.getViewportBox(),d=mini.getBox(this.el);"left"==a&&(a=0);"center"==a&&(a=c.width/2-d.width/2);"right"==a&&(a=c.width-d.width);"top"==b&&(b=0);"middle"==b&&(b=c.y+c.height/2-d.height/2);"bottom"==b&&(b=c.height-d.height);a+d.width>c.right&&(a=c.right-d.width);b+d.height>c.bottom&&(b=c.bottom-d.height-2);this._Show(a,b)},_doModal:function(){jQuery(this._modalEl).remove();if(this.showModal&&0!=this.visible){var a=document.documentElement,b=parseInt(Math.max(document.body.scrollWidth,a?a.scrollWidth:0)),c=parseInt(Math.max(document.body.scrollHeight,a?a.scrollHeight:0)),d=mini.getViewportBox(),a=d.height;a<c&&(a=c);c=d.width;c<b&&(c=b);this._modalEl=mini.append(document.body,'\x3cdiv class\x3d"mini-modal"\x3e\x3c/div\x3e');this._modalEl.style.height=a+"px";this._modalEl.style.width=c+"px";this._modalEl.style.zIndex=mini.getStyle(this.el,"zIndex")-1;mini.setStyle(this._modalEl,this.modalStyle)}},_doShim:function(){function a(){this._shimEl.style.display="";var a=mini.getBox(this.el),b=this._shimEl.style;b.width=a.width+"px";b.height=a.height+"px";b.left=a.x+"px";b.top=a.y+"px";a=mini.getStyle(this.el,"zIndex");isNaN(a)||(this._shimEl.style.zIndex=a-3)}if(mini_useShims){this._shimEl||(this._shimEl=mini.append(document.body,"\x3ciframe frameborder\x3d'0' style\x3d'position: absolute; z-index: -1; width: 0; height: 0; top: 0;left:0;scrolling:no;'\x3e\x3c/iframe\x3e"));this._shimEl.style.display="none";this._doShimTimer&&(clearTimeout(this._doShimTimer),this._doShimTimer=null);var b=this;this._doShimTimer=setTimeout(function(){b._doShimTimer=null;a.call(b)},20)}},_doShadow:function(){this.shadowEl||(this.shadowEl=mini.append(document.body,'\x3cdiv class\x3d"mini-shadow"\x3e\x3c/div\x3e'));this.shadowEl.style.display=this.showShadow?"":"none";this.shadowEl.style.display="none"},_measureSize:function(){this.el.style.display="";var a=mini.getBox(this.el);a.width>this.maxWidth&&(mini.setWidth(this.el,this.maxWidth),a=mini.getBox(this.el));a.height>this.maxHeight&&(mini.setHeight(this.el,this.maxHeight),a=mini.getBox(this.el));a.width<this.minWidth&&(mini.setWidth(this.el,this.minWidth),a=mini.getBox(this.el));a.height<this.minHeight&&(mini.setHeight(this.el,this.minHeight),mini.getBox(this.el))},_getWindowOffset:function(a){return[0,0]},showAtEl:function(a,b){if(a=mini.byId(a)){this.isRender()&&this.el.parentNode==document.body||this.render(document.body);var c={atEl:a,popupEl:this.el,xAlign:this.xAlign,yAlign:this.yAlign,xOffset:this.xOffset,yOffset:this.yOffset,popupCls:this.popupCls};mini.copyTo(c,b);mini.addClass(a,c.popupCls);a.popupCls=c.popupCls;this._popupEl=a;this.el.style.position="absolute";this.el.style.left="-2000px";this.el.style.top="-2000px";this.el.style.display="";this.doLayout();this._measureSize();var d=mini.getViewportBox(),e=mini.getBox(this.el),f=mini.getBox(a),g=c.xy,k=d.width/2-e.width/2,l=0;g&&(k=g[0],l=g[1]);switch(c.xAlign){case "outleft":k=f.x-e.width;break;case "left":k=f.x;break;case "center":k=f.x+f.width/2-e.width/2;break;case "right":k=f.right-e.width;break;case "outright":k=f.right}switch(c.yAlign){case "above":l=f.y-e.height;break;case "top":l=f.y;break;case "middle":l=f.y+f.height/2-e.height/2;break;case "bottom":l=f.bottom-e.height;break;case "below":l=f.bottom}k=parseInt(k);l=parseInt(l);g=this._getWindowOffset(b);if(c.outYAlign||c.outXAlign){if("above"==c.outYAlign&&l+e.height>d.bottom){var n=f.y-d.y,p=d.bottom-f.bottom;n>p&&(l=f.y-e.height)}"below"==c.outYAlign&&l+e.height>d.bottom&&(n=f.y-d.y,p=d.bottom-f.bottom,n>p&&(l=f.y-e.height));"outleft"==c.outXAlign&&k+e.width>d.right&&f.x-d.x>d.right-f.right&&(k=f.x-e.width);"right"==c.outXAlign&&k+e.width>d.right&&(k=f.right-e.width);c.alwaysView&&(0>l&&(l=0),l+e.height>d.bottom&&(l=d.bottom-e.height),0>k&&(k=0),k+e.width>d.right&&(k=d.right-e.width));this._Show(k+g[0],l+g[1])}else this.showAtPos(k+c.xOffset+g[0],l+c.yOffset+g[1])}},_Show:function(a,b){this.el.style.display="";this.el.style.zIndex=mini.getMaxZIndex();mini.setX(this.el,a);mini.setY(this.el,b);this.setVisible(!0);if("mouseout"==this.hideAction)mini.on(document,"mousemove",this.__OnBodyMouseMove,this);this._doShadow();this._doModal();this._doShim();mini.layoutIFrames(this.el);this.isPopup=!0;mini.on(document,"mousedown",this.__OnBodyMouseDown,this);mini.on(window,"resize",this.__OnWindowResize,this);this.fire("Open")},open:function(){this.show()},close:function(){this.hide()},hide:function(){this.el&&(this.popupEl&&mini.removeClass(this.popupEl,this.popupEl.popupCls),this._popupEl&&mini.removeClass(this._popupEl,this._popupEl.popupCls),this._popupEl=null,jQuery(this._modalEl).remove(),this.shadowEl&&(this.shadowEl.style.display="none"),this._shimEl&&(this._shimEl.style.display="none"),mini.un(document,"mousemove",this.__OnBodyMouseMove,this),mini.un(document,"mousedown",this.__OnBodyMouseDown,this),mini.un(window,"resize",this.__OnWindowResize,this),this.setVisible(!1),this.isPopup=!1,this.fire("Close"))},setPopupEl:function(a){if(a=mini.byId(a))this._unbindPopupEl(),this.popupEl=a,this._bindPopupEl()},setPopupCls:function(a){this.popupCls=a},setShowAction:function(a){this.showAction=a},setHideAction:function(a){this.hideAction=a},setShowDelay:function(a){this.showDelay=a},setHideDelay:function(a){this.hideDelay=a},setXAlign:function(a){this.xAlign=a},setYAlign:function(a){this.yAlign=a},setxOffset:function(a){a=parseInt(a);isNaN(a)&&(a=0);this.xOffset=a},setyOffset:function(a){a=parseInt(a);isNaN(a)&&(a=0);this.yOffset=a},setShowModal:function(a){this.showModal=a},setShowShadow:function(a){this.showShadow=a},setMinWidth:function(a){isNaN(a)||(this.minWidth=a)},setMinHeight:function(a){isNaN(a)||(this.minHeight=a)},setMaxWidth:function(a){isNaN(a)||(this.maxWidth=a)},setMaxHeight:function(a){isNaN(a)||(this.maxHeight=a)},setAllowDrag:function(a){this.allowDrag=a;mini.removeClass(this.el,this._dragCls);a&&mini.addClass(this.el,this._dragCls)},setAllowResize:function(a){this.allowResize=a;mini.removeClass(this.el,this._resizeCls);a&&mini.addClass(this.el,this._resizeCls)},__OnLeftClick:function(a){if(!this._inAniming&&"leftclick"==this.showAction){var b=jQuery(this.popupEl).attr("allowPopup");"false"!=String(b)&&this.doShow(a)}},__OnRightClick:function(a){if(!this._inAniming&&"rightclick"==this.showAction){var b=jQuery(this.popupEl).attr("allowPopup");"false"!=String(b)&&(a.preventDefault(),this.doShow(a))}},__OnMouseOver:function(a){if(!this._inAniming&&"mouseover"==this.showAction){var b=jQuery(this.popupEl).attr("allowPopup");if("false"!=String(b)&&(clearTimeout(this._hideTimer),this._hideTimer=null,!this.isPopup)){var c=this;this._showTimer=setTimeout(function(){c.doShow(a)},this.showDelay)}}},__OnBodyMouseMove:function(a){"mouseout"==this.hideAction&&this._tryHide(a)},__OnBodyMouseDown:function(a){"outerclick"==this.hideAction&&this.isPopup&&(jQuery(a.target).closest(".mini-popup")[0]||this.within(a)||this.popupEl&&mini.isAncestor(this.popupEl,a.target)||this.doHide(a))},_tryHide:function(a){if(!(mini.isAncestor(this.el,a.target)||this.popupEl&&mini.isAncestor(this.popupEl,a.target)||(clearTimeout(this._showTimer),this._showTimer=null,this._hideTimer))){var b=this;this._hideTimer=setTimeout(function(){b.doHide(a)},this.hideDelay)}},__OnWindowResize:function(a){this.isDisplay()&&!mini.isIE6&&this._doModal()},within:function(a){if(mini.isAncestor(this.el,a.target))return!0;for(var b=mini.getChildControls(this),c=0,d=b.length;c<d;c++)if(b[c].within(a))return!0;return!1}};mini.copyTo(mini.Popup.prototype,mini.Popup_prototype);(function(){if(hasOn){var a=mini.getTopWindow();if(a){var b=function(b){(b=a.jQuery)&&b(a.document).trigger("topmousedown",[document])},c=function(a,b){b!=document&&jQuery(document).trigger("mousedown")};jQuery(a.document).on("topmousedown",c);jQuery(document).on("mousedown",b);jQuery(window).on("unload",function(){jQuery(a.document).off("topmousedown",c);jQuery(document).off("mousedown",b)})}}})();mini.Button=function(){mini.Button.superclass.constructor.apply(this,arguments)};mini.extend(mini.Button,mini.Control,{text:"",iconCls:"",iconStyle:"",plain:!1,checkOnClick:!1,checked:!1,groupName:"",img:"",_plainCls:"mini-button-plain",_hoverCls:"mini-button-hover",_pressedCls:"mini-button-pressed",_checkedCls:"mini-button-checked",_disabledCls:"mini-button-disabled",allowCls:"",_clearBorder:!1,set:function(a){if("string"==typeof a)return this;this._allowUpdate=a.text||a.iconStyle||a.iconCls||a.iconPosition;mini.Button.superclass.set.call(this,a);!1===this._allowUpdate&&(this._allowUpdate=!0,this.doUpdate());return this},uiCls:"mini-button",_create:function(){this.el=document.createElement("a");this.el.className="mini-button mini-state-default mini-corner-all";this.el.hideFocus=!0;this.el.href="javascript:void(0)";this.doUpdate()},_initEvents:function(){mini._BindEvents(function(){mini_onOne(this.el,"mousedown",this.__OnMouseDown,this);mini_onOne(this.el,"click",this.__OnClick,this)},this)},destroy:function(a){this.el&&(this.el.onclick=null,this.el.onmousedown=null);this.menu&&(this.menu.owner=null);this.menu=null;mini.Button.superclass.destroy.call(this,a)},doUpdate:function(){if(!1!==this._allowUpdate){var a="",b=this.text,c=this.iconStyle||this.iconCls||this.img;c&&b?a=" mini-button-icon-text ":c&&""===b?(a=" mini-button-icon-only ",b="\x26nbsp;"):""==b&&(b="\x26nbsp;");var d=this.iconStyle||"";!d&&this.img&&(d="background-image:url("+this.img+")");var e="";c&&(e='\x3cspan class\x3d"mini-button-icon mini-icon mini-iconfont '+this.iconCls+'" style\x3d"'+d+'"\x3e\x3c/span\x3e');a='\x3cspan class\x3d"mini-button-inner '+a+'"\x3e'+e+('\x3cspan class\x3d"mini-button-text"\x3e'+b+"\x3c/span\x3e")+"\x3c/span\x3e";this.allowCls&&(a=a+'\x3cspan class\x3d"mini-button-allow mini-icon '+this.allowCls+'"\x3e\x3c/span\x3e');this.el.innerHTML=a}},href:"",setHref:function(a){this.href=a;this.el.href=a;var b=this.el;setTimeout(function(){b.onclick=null},100)},getHref:function(){return this.href},target:"",setTarget:function(a){this.target=a;this.el.target=a},getTarget:function(){return this.target},setText:function(a){this.text!=a&&(this.text=a,this.doUpdate())},getText:function(){return this.text},setIconCls:function(a){this.iconCls=a;this.doUpdate()},getIconCls:function(){return this.iconCls},setIconStyle:function(a){this.iconStyle=a;this.doUpdate()},getIconStyle:function(){return this.iconStyle},setImg:function(a){this.img=a;this.doUpdate()},getImg:function(){return this.img},setIconPosition:function(a){this.iconPosition="left";this.doUpdate()},getIconPosition:function(){return this.iconPosition},setPlain:function(a){(this.plain=a)?this.addCls(this._plainCls):this.removeCls(this._plainCls)},getPlain:function(){return this.plain},setGroupName:function(a){this.groupName=a},getGroupName:function(){return this.groupName},setCheckOnClick:function(a){this.checkOnClick=a},getCheckOnClick:function(){return this.checkOnClick},setChecked:function(a){var b=this.checked!=a;(this.checked=a)?this.addCls(this._checkedCls):this.removeCls(this._checkedCls);b&&this.fire("CheckedChanged")},getChecked:function(){return this.checked},doClick:function(){this.__OnClick(null)},__OnClick:function(a){!this.href&&a&&a.preventDefault();if(!this.readOnly&&0!=this.enabled){this.focus();if(this.checkOnClick)if(this.groupName){var b=this.groupName,c=mini.findControls(function(a){if("button"==a.type&&a.groupName==b)return!0});if(0<c.length){for(var d=0,e=c.length;d<e;d++){var f=c[d];f!=this&&f.setChecked(!1)}this.setChecked(!0)}else this.setChecked(!this.checked)}else this.setChecked(!this.checked);this.fire("click",{htmlEvent:a})}},__OnMouseDown:function(a){this.isReadOnly()||(this.addCls(this._pressedCls),mini.on(document,"mouseup",this.__OnDocMouseUp,this))},__OnDocMouseUp:function(a){this.removeCls(this._pressedCls);mini.un(document,"mouseup",this.__OnDocMouseUp,this)},onClick:function(a,b){this.on("click",a,b)},getAttrs:function(a){var b=mini.Button.superclass.getAttrs.call(this,a);b.text=a.innerHTML;mini._ParseString(a,b,"text href iconCls iconStyle iconPosition groupName menu onclick oncheckedchanged target img".split(" "));mini._ParseBool(a,b,["plain","checkOnClick","checked"]);return b}});mini.regClass(mini.Button,"button");mini.MenuButton=function(){mini.MenuButton.superclass.constructor.apply(this,arguments)};mini.extend(mini.MenuButton,mini.Button,{uiCls:"mini-menubutton",allowCls:"mini-button-menu",setMenu:function(a){mini.isArray(a)&&(a={type:"menu",items:a});if("string"==typeof a){if(!mini.byId(a))return;mini.parse(a);a=mini.get(a)}if(this.menu!==a){this.menu=mini.getAndCreate(a);this.menu.setPopupEl(this.el);this.menu.setPopupCls("mini-button-popup");this.menu.setShowAction("leftclick");this.menu.setHideAction("outerclick");this.menu.setXAlign("left");this.menu.setYAlign("below");this.menu.hide();this.menu.owner=this;this.menu.addCls("mini-menu-open");var b=this;this.menu.on("BeforeOpen",function(a){b.split&&!jQuery(a.htmlEvent.target).closest(".mini-button-split")[0]&&(a.cancel=!0)})}},setEnabled:function(a){(this.enabled=a)?this.removeCls(this._disabledCls):this.addCls(this._disabledCls);jQuery(this.el).attr("allowPopup",!!a)}});mini.regClass(mini.MenuButton,"menubutton");mini.SplitButton=function(){mini.SplitButton.superclass.constructor.apply(this,arguments)};mini.extend(mini.SplitButton,mini.MenuButton,{split:!0,uiCls:"mini-splitbutton",allowCls:"mini-button-split",__OnClick:function(a){this.split&&jQuery(a.target).closest(".mini-button-split")[0]||mini.SplitButton.superclass.__OnClick.call(this,a)}});mini.regClass(mini.SplitButton,"splitbutton");mini.CheckBox=function(){mini.CheckBox.superclass.constructor.apply(this,arguments)};mini.extend(mini.CheckBox,mini.Control,{formField:!0,_clearText:!1,text:"",checked:!1,defaultValue:!1,trueValue:!0,falseValue:!1,checkedCls:"mini-checkbox-checked",set:function(a){if("string"==typeof a)return this;mini.isNull(a.trueValue)||(this.setTrueValue(a.trueValue),delete a.trueValue);mini.isNull(a.falseValue)||(this.setFalseValue(a.falseValue),delete a.falseValue);mini.CheckBox.superclass.set.call(this,a);return this},uiCls:"mini-checkbox",_create:function(){var a=this.uid+"$check";this.el=document.createElement("span");this.el.className="mini-checkbox";this.el.innerHTML='\x3cinput id\x3d"'+a+'" name\x3d"'+this.id+'" type\x3d"checkbox" class\x3d"mini-checkbox-check"\x3e\x3cspan class\x3d"mini-checkbox-icon mini-icon" tabIndex\x3d"0"\x3e\x3c/span\x3e\x3clabel for\x3d"'+a+'" onclick\x3d"return false;"\x3e'+this.text+"\x3c/label\x3e";this._checkEl=this.el.firstChild;this._labelEl=this.el.lastChild},destroy:function(a){this._checkEl&&(this._checkEl.onmouseup=null,this._checkEl=this._checkEl.onclick=null);mini.CheckBox.superclass.destroy.call(this,a)},_initEvents:function(){mini._BindEvents(function(){mini.on(this.el,"click",this.__onClick,this);mini.on(this.el,"keyup",function(a){32==a.keyCode&&jQuery(a.target).click()});this._checkEl.onmouseup=function(){return!1};var a=this;this._checkEl.onclick=function(){if(a.isReadOnly())return!1};this._checkEl.checked=this.checked},this)},setName:function(a){this.name=a;mini.setAttr(this._checkEl,"name",this.name)},setText:function(a){this.text!==a&&(this.text=a,this._labelEl.innerHTML=a)},getText:function(){return this.text},setChecked:function(a){a=!0===a?!0:String(a)==String(this.trueValue)?!0:"true"==a?!0:"True"==a?!0:"1"===String(a)?!0:"Y"==a?!0:!1;this.checked!==a&&(this.checked=!!a,this._checkEl.checked=this.checked,this.value=this.getValue());a=jQuery(this.el);this.checked?a.addClass(this.checkedCls):a.removeClass(this.checkedCls)},getChecked:function(){return this.checked},setValue:function(a){this.checked!==a&&(this.setChecked(a),this.value=this.getValue())},getValue:function(){return String(1==this.checked?this.trueValue:this.falseValue)},getFormValue:function(){return this.getValue()},setTrueValue:function(a){this.trueValue=this._checkEl.value=a},getTrueValue:function(){return this.trueValue},setFalseValue:function(a){this.falseValue=a},getFalseValue:function(){return this.falseValue},__onClick:function(a){this.isReadOnly()||(this.setChecked(!this.checked),this.fire("checkedchanged",{checked:this.checked}),this.fire("valuechanged",{value:this.getValue()}),this.fire("click",a,this))},getAttrs:function(a){var b=mini.CheckBox.superclass.getAttrs.call(this,a),c=jQuery(a);b.text=a.innerHTML;mini._ParseString(a,b,["text","oncheckedchanged","onclick","onvaluechanged"]);mini._ParseBool(a,b,["enabled"]);if(a=mini.getAttr(a,"checked"))b.checked="true"==a||"checked"==a?!0:!1;if(a=c.attr("trueValue"))b.trueValue=a,a=parseInt(a),isNaN(a)||(b.trueValue=a);if(c=c.attr("falseValue"))b.falseValue=c,c=parseInt(c),isNaN(c)||(b.falseValue=c);return b}});mini.regClass(mini.CheckBox,"checkbox");jQuery(function(){setTimeout(function(){for(var a=mini.getComponents(),b=0,c=a.length;b<c;b++){var d=a[b];if(d instanceof mini.TextBox){var e=d.getTextEl().value;d.value!==e&&(d.value=e)}}},300)});mini.TextBox=function(){mini.TextBox.superclass.constructor.apply(this,arguments)};mini.extend(mini.TextBox,mini.ValidatorBase,{name:"",formField:!0,selectOnFocus:!1,allowInput:!0,minWidth:10,minHeight:15,maxLength:5E3,emptyText:"",text:"",value:"",defaultValue:"",height:21,_emptyCls:"mini-textbox-empty",_focusCls:"mini-textbox-focus",_disabledCls:"mini-textbox-disabled",uiCls:"mini-textbox",_InputType:"text",_create:function(){var a='\x3cinput  type\x3d"'+this._InputType+'" class\x3d"mini-textbox-input" autocomplete\x3d"off"/\x3e';"textarea"==this._InputType&&(a='\x3ctextarea  class\x3d"mini-textbox-input" autocomplete\x3d"off"/\x3e\x3c/textarea\x3e');a='\x3cspan class\x3d"mini-textbox-border mini-corner-all"\x3e'+a+'\x3c/span\x3e\x3cinput type\x3d"hidden"/\x3e';this.el=document.createElement("span");this.el.className="mini-textbox";this.el.innerHTML=a;this._borderEl=this.el.firstChild;this._textEl=this._borderEl.firstChild;this._valueEl=this._borderEl.lastChild;this._doEmpty()},_initEvents:function(){mini._BindEvents(function(){mini_onOne(this._textEl,"drop",this.__OnDropText,this);mini_onOne(this._textEl,"change",this.__OnInputTextChanged,this);mini_onOne(this._textEl,"focus",this.__OnFocus,this);mini_onOne(this.el,"mousedown",this.__OnMouseDown,this);var a=this.value;this.value=null;this.el&&this.setValue(a)},this);this.on("validation",this.__OnValidation,this)},_inputEventsInited:!1,_initInputEvents:function(){this._inputEventsInited||(this._inputEventsInited=!0,mini.on(this._textEl,"blur",this.__OnBlur,this),mini.on(this._textEl,"keydown",this.__OnInputKeyDown,this),mini.on(this._textEl,"keyup",this.__OnInputKeyUp,this),mini.on(this._textEl,"keypress",this.__OnInputKeyPress,this),mini_onOne(this.el,"click",this.__OnClick,this))},destroy:function(a){this.el&&(this.el.onmousedown=null);if(this._textEl){var b=this._textEl;b._placeholder_label&&(b._placeholder_label.onmousedown=null,b._placeholder_label=null);b.onpropertychange=b.ondrop=b.onchange=b.onfocus=null;mini.clearEvent(b);this._textEl=null}this._valueEl&&(mini.clearEvent(this._valueEl),this._valueEl=null);mini.TextBox.superclass.destroy.call(this,a)},doLayout:function(){this._doLabelLayout&&this._labelLayout()},setHeight:function(a){parseInt(a)==a&&(a+="px");this.height=a;"textarea"==this._InputType&&(this.el.style.height=a,this.doLayout())},setName:function(a){this.name!=a&&(this.name=a,this._valueEl&&mini.setAttr(this._valueEl,"name",this.name))},setValue:function(a){if(null===a||void 0===a)a="";a=String(a);a.length>this.maxLength&&(a=a.substring(0,this.maxLength));this.value=a;this._valueEl.value=this._textEl.value=a;this._doEmpty()},getValue:function(){return this.value},setText:function(a){mini.isNull(a)&&(a="");this._textEl.value=a},getText:function(){return this._textEl.value},getFormValue:function(){var a=this.value;if(null===a||void 0===a)a="";return String(a)},setAllowInput:function(a){this.allowInput!=a&&(this.allowInput=a,this.doUpdate())},getAllowInput:function(){return this.allowInput},_placeholdered:!1,_doEmpty:function(){(this._textEl.placeholder=this.emptyText)&&mini._placeholder(this._textEl)},setEmptyText:function(a){this.emptyText!=a&&(this.emptyText=a,this._doEmpty())},getEmptyText:function(){return this.emptyText},setMaxLength:function(a){this.maxLength=a;mini.setAttr(this._textEl,"maxLength",a);"textarea"==this._InputType&&mini.isIE&&(mini.on(this._textEl,"keyup",this.__OnMaxLengthKeyUp,this),mini.on(this._textEl,"keypress",this.__OnMaxLengthKeyUp,this),mini.on(this._textEl,"paste",this.__OnPaste,this))},__OnPaste:function(a){var b=this;setTimeout(function(){var a=b._textEl.value;a.length>b.maxLength&&(b._textEl.value=a.substring(0,b.maxLength));b.__OnInputTextChanged()},0)},__OnMaxLengthKeyUp:function(a){this._textEl.value.length>=this.maxLength&&(this.__OnPaste(a),a.preventDefault())},getMaxLength:function(){return this.maxLength},setReadOnly:function(a){this.readOnly!=a&&(this.readOnly=a,this.doUpdate())},setEnabled:function(a){this.enabled!=a&&(this.enabled=a,this.doUpdate())},doUpdate:function(){this.enabled?this.removeCls(this._disabledCls):this.addCls(this._disabledCls);this.isReadOnly()||0==this.allowInput?(this._textEl.readOnly=!0,mini.addClass(this.el,"mini-textbox-readOnly")):(this._textEl.readOnly=!1,mini.removeClass(this.el,"mini-textbox-readOnly"));this.required?this.addCls(this._requiredCls):this.removeCls(this._requiredCls);this._textEl.disabled=this.enabled?!1:!0},focus:function(){var a=this;setTimeout(function(){try{if(a._textEl.focus(),mini.isIE){var b=a._textEl.createTextRange();b.collapse(!1);b.select()}}catch(c){}},10)},blur:function(){try{this._textEl.blur()}catch(a){}},selectText:function(){try{this._textEl.select()}catch(a){}},getTextEl:function(){return this._textEl},getInputText:function(){return this._textEl.value},setSelectOnFocus:function(a){this.selectOnFocus=a},getSelectOnFocus:function(a){return this.selectOnFocus},_errorIconEl:null,getErrorIconEl:function(){this._errorIconEl||(this._errorIconEl=mini.append(this.el,'\x3cspan class\x3d"mini-errorIcon"\x3e\x3c/span\x3e'));return this._errorIconEl},_RemoveErrorIcon:function(){this._errorIconEl&&jQuery(this._errorIconEl).remove();this._errorIconEl=null},__OnClick:function(a){this.enabled&&this.fire("click",{htmlEvent:a})},__OnMouseDown:function(a){var b=this;"textarea"!=this._InputType&&(mini.isAncestor(this._textEl,a.target)?setTimeout(function(){try{b._textEl.focus()}catch(c){}},1):setTimeout(function(){b.focus();mini.selectRange(b._textEl,1E4,1E4)},1))},__OnInputTextChanged:function(a,b){var c=this.value;this._oldValue=c;this.setValue(this._textEl.value);c===this.getValue()&&!0!==b||this._OnValueChanged()},__OnDropText:function(a){var b=this;setTimeout(function(){b.__OnInputTextChanged(a)},0)},__OnInputKeyDown:function(a){var b={htmlEvent:a};this.fire("keydown",b);if(8==a.keyCode&&(this.isReadOnly()||0==this.allowInput))return!1;27!=a.keyCode&&13!=a.keyCode&&9!=a.keyCode||"textarea"==this._InputType&&13==a.keyCode||(this.__OnInputTextChanged(null),this._textEl.blur(),this._textEl.focus(),13==a.keyCode&&this.fire("enter",b));27==a.keyCode&&a.preventDefault()},__OnInputKeyUp:function(a){this.fire("keyup",{htmlEvent:a})},__OnInputKeyPress:function(a){this.fire("keypress",{htmlEvent:a})},__OnFocus:function(a){this.doUpdate();if(!this.isReadOnly()){this._focused=!0;this.addCls(this._focusCls);this._initInputEvents();if(this.selectOnFocus){var b=this;setTimeout(function(){b.selectText()},1)}this.fire("focus",{htmlEvent:a})}},__OnBlur:function(a){this._focused=!1;var b=this;setTimeout(function(){0==b._focused&&b.removeCls(b._focusCls)},2);this.fire("blur",{htmlEvent:a});this.validateOnLeave&&this.isEditable()&&this._tryValidate()},inputStyle:"",setInputStyle:function(a){this.inputStyle=a;mini.setStyle(this._textEl,a)},getAttrs:function(a){var b=mini.TextBox.superclass.getAttrs.call(this,a);jQuery(a);mini._ParseString(a,b,"value text emptyText inputStyle onenter onkeydown onkeyup onkeypress onclick maxLengthErrorText minLengthErrorText onfocus onblur vtype emailErrorText urlErrorText floatErrorText intErrorText dateErrorText minErrorText maxErrorText rangeLengthErrorText rangeErrorText rangeCharErrorText".split(" "));mini._ParseBool(a,b,["allowInput","selectOnFocus"]);mini._ParseInt(a,b,["maxLength","minLength","minHeight","minWidth"]);return b},vtype:"",setVtype:function(a){this.vtype=a},getVtype:function(){return this.vtype},__OnValidation:function(a){0!=a.isValid&&mini._ValidateVType(this.vtype,a.value,a,this)},setEmailErrorText:function(a){this.emailErrorText=a},getEmailErrorText:function(){return this.emailErrorText},setUrlErrorText:function(a){this.urlErrorText=a},getUrlErrorText:function(){return this.urlErrorText},setFloatErrorText:function(a){this.floatErrorText=a},getFloatErrorText:function(){return this.floatErrorText},setIntErrorText:function(a){this.intErrorText=a},getIntErrorText:function(){return this.intErrorText},setDateErrorText:function(a){this.dateErrorText=a},getDateErrorText:function(){return this.dateErrorText},setMaxLengthErrorText:function(a){this.maxLengthErrorText=a},getMaxLengthErrorText:function(){return this.maxLengthErrorText},setMinLengthErrorText:function(a){this.minLengthErrorText=a},getMinLengthErrorText:function(){return this.minLengthErrorText},setMaxErrorText:function(a){this.maxErrorText=a},getMaxErrorText:function(){return this.maxErrorText},setMinErrorText:function(a){this.minErrorText=a},getMinErrorText:function(){return this.minErrorText},setRangeLengthErrorText:function(a){this.rangeLengthErrorText=a},getRangeLengthErrorText:function(){return this.rangeLengthErrorText},setRangeCharErrorText:function(a){this.rangeCharErrorText=a},getRangeCharErrorText:function(){return this.rangeCharErrorText},setRangeErrorText:function(a){this.rangeErrorText=a},getRangeErrorText:function(){return this.rangeErrorText}});mini.regClass(mini.TextBox,"textbox");mini.Password=function(){mini.Password.superclass.constructor.apply(this,arguments)};mini.extend(mini.Password,mini.TextBox,{uiCls:"mini-password",_InputType:"password",getValue:function(){return this._textEl.value}});mini.regClass(mini.Password,"password");mini.TextArea=function(){mini.TextArea.superclass.constructor.apply(this,arguments)};mini.extend(mini.TextArea,mini.TextBox,{maxLength:1E7,height:"",minHeight:50,_InputType:"textarea",uiCls:"mini-textarea",doLayout:function(){if(this.canLayout()){mini.TextArea.superclass.doLayout.call(this);var a=mini.getHeight(this.el);mini.isIE6&&mini.setHeight(this._borderEl,a);a-=2;0>a&&(a=0);this._textEl.style.height=a+"px"}}});mini.regClass(mini.TextArea,"textarea");mini.ButtonEdit=function(){mini.ButtonEdit.superclass.constructor.apply(this,arguments);var a=this.isReadOnly();if(a||0==this.allowInput)this._textEl.readOnly=!0;0==this.enabled&&this.addCls(this._disabledCls);a&&this.addCls(this._readOnlyCls);this.required&&this.addCls(this._requiredCls)};mini.extend(mini.ButtonEdit,mini.ValidatorBase,{name:"",formField:!0,selectOnFocus:!1,showButton:!0,buttonToolTip:"",closeToolTip:"",showClose:!1,emptyText:"",defaultValue:"",defaultText:"",value:"",text:"",maxLength:1E3,minLength:0,height:21,inputAsValue:!0,allowInput:!0,_noInputCls:"mini-buttonedit-noInput",_readOnlyCls:"mini-buttonedit-readOnly",_disabledCls:"mini-buttonedit-disabled",_emptyCls:"mini-buttonedit-empty",_focusCls:"mini-buttonedit-focus",_buttonCls:"mini-buttonedit-button",_buttonHoverCls:"mini-buttonedit-button-hover",_buttonPressedCls:"mini-buttonedit-button-pressed",_closeCls:"mini-buttonedit-close",set:function(a){if("string"==typeof a)return this;var b=a.value;delete a.value;var c=a.text;delete a.text;this._allowUpdate=!(0==a.enabled||0==a.allowInput||a.readOnly);mini.ButtonEdit.superclass.set.call(this,a);!1===this._allowUpdate&&(this._allowUpdate=!0,this.doUpdate());mini.isNull(c)||this.setText(c);mini.isNull(b)||this.setValue(b);return this},uiCls:"mini-buttonedit",setButtons:function(a){jQuery(".mini-buttonedit-button:not(.mini-buttonedit-trigger)",this.el).remove();this.buttons=a||[];a="";for(var b=0,c=this.buttons.length;b<c;b++){var d=this.buttons[b];d.name||(d.name="button"+b);a+=this._createButtonHtml(d.name,d.iconCls,d.tooltip)}mini.append(this._buttonsEl,a);this._doInputLayout(!1)},getButtons:function(){return this.buttons||[]},getButtonByName:function(a){for(var b=this.getButtons(),c=0,d=b.length;c<d;c++){var e=b[c];if(e.name&&e.name==a)return e}return null},_createButtonHtml:function(a,b,c){a=a||"";return'\x3cspan title\x3d"'+(c||"")+'" name\x3d"'+a+'" class\x3d"mini-buttonedit-button mini-buttonedit-'+a+'" '+("onmouseover\x3d\"mini.addClass(this, '"+this._buttonHoverCls+"');\" onmouseout\x3d\"mini.removeClass(this, '"+this._buttonHoverCls+"');\"")+'\x3e\x3cspan class\x3d"mini-buttonedit-icon mini-icon mini-iconfont '+(b||"")+'"\x3e\x3c/span\x3e\x3c/span\x3e'},_getButtonsHTML:function(){return'\x3cspan class\x3d"mini-buttonedit-buttons"\x3e\x3cspan class\x3d"mini-buttonedit-close mini-icon" name\x3d"close"\x3e\x3c/span\x3e'+this._getButtonHtml("trigger","",this.buttonToolTip)+"\x3c/span\x3e"},_getButtonHtml:function(a,b,c){return this._createButtonHtml(a,b,c)},_create:function(){this.el=document.createElement("span");this.el.className="mini-buttonedit";var a=this._getButtonsHTML();this.el.innerHTML='\x3cspan class\x3d"mini-buttonedit-border mini-corner-all"\x3e\x3cinput type\x3d"text" class\x3d"mini-buttonedit-input" autocomplete\x3d"off"/\x3e'+a+'\x3c/span\x3e\x3cinput name\x3d"'+this.name+'" type\x3d"hidden"/\x3e';this._borderEl=this.el.firstChild;this._textEl=this._borderEl.firstChild;this._valueEl=this.el.lastChild;this._buttonsEl=this._borderEl.lastChild;this._buttonEl=this._buttonsEl.lastChild;this._closeEl=this._buttonEl.previousSibling;this._doEmpty()},destroy:function(a){this._textEl&&(this._textEl.onchange=this._textEl.onfocus=null,mini.clearEvent(this._textEl),this._textEl=null);this._borderEl=this._buttonsEl=this._buttonEl=this._closeEl=this._valueEl=null;mini.ButtonEdit.superclass.destroy.call(this,a)},_deferSetText:!0,_initEvents:function(){mini._BindEvents(function(){mini_onOne(this.el,"mousedown",this.__OnMouseDown,this);mini_onOne(this._textEl,"focus",this.__OnFocus,this);mini_onOne(this._textEl,"change",this.__OnInputTextChanged,this);var a=this.text;this.text=null;this.el&&this._deferSetText&&this.setText(a);if(mini.isIE)mini.on(this._textEl,"input",this.__input,this)},this)},__input:function(){},_inputEventsInited:!1,_initInputEvents:function(){this._inputEventsInited||(this._inputEventsInited=!0,mini.on(this.el,"click",this.__OnClick,this),mini.on(this._textEl,"blur",this.__OnBlur,this),mini.on(this._textEl,"keydown",this.__OnInputKeyDown,this),mini.on(this._textEl,"keyup",this.__OnInputKeyUp,this),mini.on(this._textEl,"keypress",this.__OnInputKeyPress,this))},_buttonWidth:20,_closeWidth:20,_doInputLayout:function(a){this._buttonEl.style.display=this.showButton?"inline-block":"none";this._buttonEl.title=this.buttonToolTip;this._closeEl&&(this._closeEl.style.display=this.showClose?"inline-block":"none",this._closeEl.title=this.closeToolTip);if(mini.isNull(mini.ButtonEdit._paddingOffset)){var b=mini.getPaddings(this._borderEl);mini.ButtonEdit._paddingOffset=b.left}b=this._buttonsEl.offsetWidth;b+=0<b?0:mini.ButtonEdit._paddingOffset;this._noLayout=2==b?!0:!1;this._borderEl.style.paddingRight=b+"px";!1!==a&&this.doLayout()},doLayout:function(){this._noLayout&&this._doInputLayout(!1);this._doLabelLayout&&this._labelLayout()},setHeight:function(a){parseInt(a)==a&&(a+="px");this.height=a},focus:function(){try{this._textEl.focus();var a=this;setTimeout(function(){a._focused&&a._textEl.focus()},10)}catch(b){}},blur:function(){try{this._textEl.blur()}catch(a){}},selectText:function(){this._textEl.select()},getTextEl:function(){return this._textEl},setName:function(a){this.name=a;this._valueEl&&mini.setAttr(this._valueEl,"name",this.name)},setText:function(a){if(null===a||void 0===a)a="";this.text=a;this._textEl.value=a;this._doEmpty()},getText:function(){return this._textEl.value},setValue:function(a){if(null===a||void 0===a)a="";this.value=a;this._valueEl.value=this.getFormValue()},getValue:function(){return this.value},getFormValue:function(){var a=this.value;if(null===a||void 0===a)a="";return String(a)},_doEmpty:function(){(this._textEl.placeholder=this.emptyText)&&mini._placeholder(this._textEl)},setEmptyText:function(a){this.emptyText!=a&&(this.emptyText=a,this._doEmpty())},getEmptyText:function(){return this.emptyText},setMaxLength:function(a){a=parseInt(a);isNaN(a)||(this.maxLength=a,this._textEl.maxLength=a)},getMaxLength:function(){return this.maxLength},setMinLength:function(a){a=parseInt(a);isNaN(a)||(this.minLength=a)},getMinLength:function(){return this.minLength},setEnabled:function(a){mini.ButtonEdit.superclass.setEnabled.call(this,a)},_doReadOnly:function(){var a=this.isReadOnly();this._textEl.readOnly=a||0==this.allowInput?!0:!1;a?this.addCls(this._readOnlyCls):this.removeCls(this._readOnlyCls);this.allowInput?this.removeCls(this._noInputCls):this.addCls(this._noInputCls);this._textEl.disabled=this.enabled?!1:!0},setAllowInput:function(a){this.allowInput=a;this._doReadOnly()},getAllowInput:function(){return this.allowInput},setInputAsValue:function(a){this.inputAsValue=a},getInputAsValue:function(){return this.inputAsValue},autoClear:!1,setAutoClear:function(a){this.autoClear=a},getAutoClear:function(){return this.autoClear},setButtonToolTip:function(a){this.buttonToolTip=a},getButtonToolTip:function(){return this.buttonToolTip},_errorIconEl:null,getErrorIconEl:function(){this._errorIconEl||(this._errorIconEl=mini.append(this.el,'\x3cspan class\x3d"mini-errorIcon"\x3e\x3c/span\x3e'));return this._errorIconEl},_RemoveErrorIcon:function(){this._errorIconEl&&jQuery(this._errorIconEl).remove();this._errorIconEl=null},__OnClick:function(a){0!=this.enabled&&(this.fire("click",{htmlEvent:a}),!this.isReadOnly()&&mini.isAncestor(this._borderEl,a.target)&&(mini.isAncestor(this._buttonEl,a.target)&&this._OnButtonClick(a),mini.findParent(a.target,this._closeCls)&&(this.autoClear&&(this.value&&0!==this.value||""!==this.text)&&(this._oldValue=this.value,this.setValue(""),this.setText(""),this._OnValueChanged()),this.fire("closeclick",{htmlEvent:a})),this._handlerButtonElClick(a)))},_handlerButtonElClick:function(a){var b=mini.findParent(a.target,"mini-buttonedit-button");b&&b!=this._buttonEl&&b!=this._closeEl&&(b=jQuery(b).attr("name"),b=this.getButtonByName(b),a={sender:this,button:b,htmlEvent:a},b.handler&&b.handler(a))},__OnMouseDown:function(a){if(!this.isReadOnly()&&0!=this.enabled&&mini.isAncestor(this._borderEl,a.target)&&!mini.isAncestor(this._textEl,a.target)){this._clickTarget=a.target;var b=this;setTimeout(function(){b.focus();mini.selectRange(b._textEl,1E3,1E3)},1);if(mini.isAncestor(this._buttonEl,a.target)){var c=mini.findParent(a.target,"mini-buttonedit-up"),d=mini.findParent(a.target,"mini-buttonedit-down");c?(mini.addClass(c,this._buttonPressedCls),this._OnButtonMouseDown(a,"up")):d?(mini.addClass(d,this._buttonPressedCls),this._OnButtonMouseDown(a,"down")):(mini.addClass(this._buttonEl,this._buttonPressedCls),this._OnButtonMouseDown(a))}mini.on(document,"mouseup",this.__OnDocMouseUp,this);(a=mini.findParent(a.target,"mini-buttonedit-button"))&&mini.addClass(a,this._buttonPressedCls)}},__OnDocMouseUp:function(a){this._clickTarget=null;var b=this;setTimeout(function(){for(var a=b._buttonEl.getElementsByTagName("*"),d=0,e=a.length;d<e;d++)mini.removeClass(a[d],b._buttonPressedCls);mini.removeClass(b._buttonEl,b._buttonPressedCls);mini.removeClass(b.el,b._pressedCls);jQuery(".mini-buttonedit-button",b._buttonsEl).removeClass(b._buttonPressedCls)},80);mini.un(document,"mouseup",this.__OnDocMouseUp,this)},__OnFocus:function(a){this.doUpdate();this._initInputEvents();this.isReadOnly()||(this._focused=!0,this.addCls(this._focusCls),this.selectOnFocus&&this.selectText(),this.fire("focus",{htmlEvent:a}))},__doFocusCls:function(){0==this._focused&&this.removeCls(this._focusCls)},__fireBlur:function(a){function b(){0==c._focused&&(c.removeCls(c._focusCls),c.validateOnLeave&&c.isEditable()&&c._tryValidate(),this.fire("blur",{htmlEvent:a}))}var c=this;setTimeout(function(){b.call(c)},2)},__OnBlur:function(a){var b=this;b._focused=!1;setTimeout(function(){b.__fireBlur(a)},10)},__OnInputKeyDown:function(a){var b={htmlEvent:a};this.fire("keydown",b);if(8==a.keyCode&&(this.isReadOnly()||0==this.allowInput))return!1;if(27==a.keyCode||13==a.keyCode||9==a.keyCode)this.__OnInputTextChanged(null),13==a.keyCode&&this.fire("enter",b);27==a.keyCode&&a.preventDefault()},__OnInputTextChanged:function(){var a=this._textEl.value;if(a!=this.text){var b=this.getValue();this._oldValue=b;this.setText(a);this.inputAsValue&&(this.setValue(a),b!==this.getFormValue()&&this._OnValueChanged())}},__OnInputKeyUp:function(a){this.fire("keyup",{htmlEvent:a})},__OnInputKeyPress:function(a){this.fire("keypress",{htmlEvent:a})},_OnButtonClick:function(a){a={htmlEvent:a,cancel:!1};this.fire("beforebuttonclick",a);1!=a.cancel&&this.fire("buttonclick",a)},_OnButtonMouseDown:function(a,b){this.focus();this.addCls(this._focusCls);this.fire("buttonmousedown",{htmlEvent:a,spinType:b})},onButtonClick:function(a,b){this.on("buttonclick",a,b)},onButtonMouseDown:function(a,b){this.on("buttonmousedown",a,b)},onTextChanged:function(a,b){this.on("textchanged",a,b)},textName:"",setTextName:function(a){this.textName=a;this._textEl&&mini.setAttr(this._textEl,"name",this.textName)},getTextName:function(){return this.textName},setSelectOnFocus:function(a){this.selectOnFocus=a},getSelectOnFocus:function(a){return this.selectOnFocus},setShowClose:function(a){this.showClose=a;this._doInputLayout()},getShowClose:function(a){return this.showClose},setShowButton:function(a){this.showButton=a;this._doInputLayout()},getShowButton:function(){return this.showButton},inputStyle:"",setInputStyle:function(a){this.inputStyle=a;mini.setStyle(this._textEl,a)},getAttrs:function(a){var b=mini.ButtonEdit.superclass.getAttrs.call(this,a);jQuery(a);mini._ParseString(a,b,"value text textName emptyText inputStyle defaultText onenter onkeydown onkeyup onkeypress onbuttonclick onbuttonmousedown ontextchanged onfocus onblur oncloseclick onclick buttons buttonToolTip".split(" "));mini._ParseBool(a,b,"allowInput inputAsValue selectOnFocus showClose showButton autoClear".split(" "));mini._ParseInt(a,b,["maxLength","minLength"]);if(a=b.buttons)a=window.eval("("+a+")"),b.buttons=a||null;return b}});mini.regClass(mini.ButtonEdit,"buttonedit");mini.PopupEdit=function(){mini.PopupEdit.superclass.constructor.apply(this,arguments);this._createPopup();this.el.className+=" mini-popupedit"};mini.extend(mini.PopupEdit,mini.ButtonEdit,{uiCls:"mini-popupedit",popup:null,popupCls:"mini-buttonedit-popup",_hoverCls:"mini-buttonedit-hover",_pressedCls:"mini-buttonedit-pressed",_destroyPopup:!0,destroy:function(a){this.isShowPopup()&&this.hidePopup();this.popup&&(this._destroyPopup&&this.popup.destroy(),this.popup=null);this._popupInner&&(this._popupInner=this._popupInner.owner=null);this.el&&(this.el.onmouseover=this.el.onmouseout=null);this._listbox=this.tree=null;mini.PopupEdit.superclass.destroy.call(this,a)},_initEvents:function(){mini.PopupEdit.superclass._initEvents.call(this);mini._BindEvents(function(){mini_onOne(this.el,"mouseover",this.__OnMouseOver,this);mini_onOne(this.el,"mouseout",this.__OnMouseOut,this)},this)},__OnBlur:function(a){this._focused=!1;this._clickTarget&&mini.isAncestor(this.el,this._clickTarget)||this.isShowPopup()||mini.PopupEdit.superclass.__OnBlur.call(this,a)},__OnMouseOver:function(a){this.isReadOnly()||this.allowInput||!mini.findParent(a.target,"mini-buttonedit-border")||(a=mini.findParent(a.target,"mini-buttonedit-button"))&&a!=this._buttonEl||this.addCls(this._hoverCls)},__OnMouseOut:function(a){this.isReadOnly()||this.allowInput||this.removeCls(this._hoverCls)},__OnMouseDown:function(a){this.isReadOnly()||(mini.PopupEdit.superclass.__OnMouseDown.call(this,a),0==this.allowInput&&mini.findParent(a.target,"mini-buttonedit-border")&&(mini.addClass(this.el,this._pressedCls),mini.on(document,"mouseup",this.__OnDocMouseUp,this)))},__OnInputKeyDown:function(a){this.fire("keydown",{htmlEvent:a});if(8==a.keyCode&&(this.isReadOnly()||0==this.allowInput))return!1;9==a.keyCode?this.hidePopup():27==a.keyCode?this.hidePopup():(13==a.keyCode&&this.fire("enter"),this.isShowPopup()&&(13!=a.keyCode&&27!=a.keyCode||a.stopPropagation()))},__OnInputTextChanged:function(a){this.isShowPopup()?this._textChanged=!0:(this._textChanged=!1,mini.PopupEdit.superclass.__OnInputTextChanged.call(this,a))},within:function(a){return mini.isAncestor(this.el,a.target)||this.popup.within(a)?!0:!1},popupWidth:"100%",popupMinWidth:50,popupMaxWidth:2E3,popupHeight:"",popupMinHeight:30,popupMaxHeight:2E3,showPopupOnClick:!1,setPopup:function(a){"string"==typeof a&&(mini.parse(a),a=mini.get(a));if(a=mini.getAndCreate(a))a.setVisible(!1),this._popupInner=a,a.owner=this,a.on("beforebuttonclick",this.__OnPopupButtonClick,this)},getPopup:function(){this.popup||this._createPopup();return this.popup},_createPopup:function(){this.popup=new mini.Popup;this.popup.setShowAction("none");this.popup.setHideAction("outerclick");this.popup.setPopupEl(this.el);this.popup.on("BeforeClose",this.__OnPopupBeforeClose,this);this.popup.on("close",this.__OnPopupClose,this);mini.on(this.popup.el,"keydown",this.__OnPopupKeyDown,this)},__OnPopupClose:function(a){},__OnPopupBeforeClose:function(a){this.within(a.htmlEvent)?a.cancel=!0:this._unDocumentMousewheel()},__OnPopupKeyDown:function(a){},showPopup:function(){var a={cancel:!1};if(!1!==this._firebeforeshowpopup&&(this.fire("beforeshowpopup",a),1==a.cancel))return!1;a=this.getPopup();this._syncShowPopup();a.on("Close",this.__OnPopupHide,this);this._onDocumentMousewheel();this.fire("showpopup")},_unDocumentMousewheel:function(){mini.un(document,"mousewheel",this.__OnDocumentMousewheel,this);this._mousewheelXY=null},_onDocumentMousewheel:function(){this._unDocumentMousewheel();this._mousewheelXY=mini.getXY(this.el);mini.on(document,"mousewheel",this.__OnDocumentMousewheel,this)},__OnDocumentMousewheel:function(a){function b(){if(c.isShowPopup()){var a=c._mousewheelXY,e=mini.getXY(c.el);a[0]!=e[0]||a[1]!=e[1]?c.hidePopup():setTimeout(b,300)}}var c=this;setTimeout(b,300)},_syncShowPopup:function(){var a=this.getPopup();this._popupInner&&this._popupInner.el.parentNode!=this.popup._contentEl&&(this.popup._contentEl.appendChild(this._popupInner.el),this._popupInner.setVisible(!0));var b=mini.getBox(this._borderEl),c=this.popupWidth;"100%"==this.popupWidth&&(c=b.width);a.show(-1E3,-1E3);a.setWidth(c);b=parseInt(this.popupHeight);isNaN(b)?a.setHeight("auto"):a.setHeight(b);a.setMinWidth(this.popupMinWidth);a.setMinHeight(this.popupMinHeight);a.setMaxWidth(this.popupMaxWidth);a.setMaxHeight(this.popupMaxHeight);this._doShowAtEl(this._borderEl,{xAlign:"left",yAlign:"below",outYAlign:"above",outXAlign:"right",popupCls:this.popupCls,alwaysView:this.alwaysView})},_doShowAtEl:function(a,b){this.getPopup().showAtEl(a,b)},__OnPopupHide:function(a){this._textChanged&&(this._textChanged=!1,this.__OnInputTextChanged());this.__doFocusCls();this.fire("hidepopup")},hidePopup:function(){this.isShowPopup()&&(this.getPopup().close(),!1!==this._autoBlur&&this.blur())},isShowPopup:function(){return this.popup&&this.popup.isDisplay()?!0:!1},alwaysView:!1,setAlwaysView:function(a){this.alwaysView=a},getAlwaysView:function(){return this.alwaysView},setPopupWidth:function(a){this.popupWidth=a},setPopupMaxWidth:function(a){this.popupMaxWidth=a},setPopupMinWidth:function(a){this.popupMinWidth=a},getPopupWidth:function(a){return this.popupWidth},getPopupMaxWidth:function(a){return this.popupMaxWidth},getPopupMinWidth:function(a){return this.popupMinWidth},setPopupHeight:function(a){this.popupHeight=a},setPopupMaxHeight:function(a){this.popupMaxHeight=a},setPopupMinHeight:function(a){this.popupMinHeight=a},getPopupHeight:function(a){return this.popupHeight},getPopupMaxHeight:function(a){return this.popupMaxHeight},getPopupMinHeight:function(a){return this.popupMinHeight},setShowPopupOnClick:function(a){this.showPopupOnClick=a},getShowPopupOnClick:function(a){return this.showPopupOnClick},__OnClick:function(a){if(0!=this.enabled&&(this.fire("click",{htmlEvent:a}),!this.isReadOnly()))if(mini.isAncestor(this._buttonEl,a.target)&&this._OnButtonClick(a),mini.findParent(a.target,this._closeCls))this.isShowPopup()&&this.hidePopup(),this.autoClear&&(this.value&&0!==this.value||""!==this.text)&&(this.setValue(""),this.setText(""),this._OnValueChanged()),this.fire("closeclick",{htmlEvent:a});else{if(0==this.allowInput||mini.isAncestor(this._buttonEl,a.target)||this.showPopupOnClick){var b=mini.findParent(a.target,"mini-buttonedit-button");if(!b||b==this._buttonEl)if(this.isShowPopup())this.hidePopup(),this.focus();else{var c=this;setTimeout(function(){c.showPopup()},1)}}this._handlerButtonElClick(a)}},__OnPopupButtonClick:function(a){"close"==a.name&&this.hidePopup();a.cancel=!0},getAttrs:function(a){var b=mini.PopupEdit.superclass.getAttrs.call(this,a);mini._ParseString(a,b,"popupWidth popupHeight popup onshowpopup onhidepopup onbeforeshowpopup".split(" "));mini._ParseInt(a,b,["popupMinWidth","popupMaxWidth","popupMinHeight","popupMaxHeight"]);mini._ParseBool(a,b,["showPopupOnClick","alwaysView"]);return b}});mini.regClass(mini.PopupEdit,"popupedit");mini.ComboBox=function(){this.data=[];this.columns=[];mini.ComboBox.superclass.constructor.apply(this,arguments);this._initInput()};mini.extend(mini.ComboBox,mini.PopupEdit,{_initInput:function(){var a=this;isFirefox&&(this._textEl.oninput=function(){a._tryQuery()})},__input:function(){document.activeElement==this._textEl&&this._tryQuery()},text:"",value:"",valueField:"id",textField:"text",dataField:"",delimiter:",",multiSelect:!1,data:[],url:"",valueInCheckOrder:!0,columns:[],allowInput:!1,valueFromSelect:!1,popupMaxHeight:200,setDelimiter:function(a){this.delimiter=a;this._listbox&&(this._listbox.delimiter=a)},getDelimiter:function(){return this.delimiter},autoFocusItem:!1,setAutoFocusItem:function(a){this.autoFocusItem=a},getAutoFocusItem:function(){return this.autoFocusItem},set:function(a){if("string"==typeof a)return this;var b=a.text;delete a.text;var c=a.value;delete a.value;var d=a.url;delete a.url;var e=a.data;delete a.data;mini.ComboBox.superclass.set.call(this,a);mini.isNull(e)||(this.setData(e),a.data=e);mini.isNull(d)||(this.setUrl(d),a.url=d);mini.isNull(c)||(this.setValue(c),a.value=c);mini.isNull(b)||this.setText(b);return this},uiCls:"mini-combobox",_createPopup:function(){mini.ComboBox.superclass._createPopup.call(this);this.listbox=this._listbox=new mini.ListBox;this._listbox.delimiter=this.delimiter;this._listbox.setBorderStyle("border:0;");this._listbox.setStyle("width:100%;height:auto;");this._listbox.render(this.popup._contentEl);this._listbox.on("beforeitemclick",this.__OnBeforeItemClick,this);this._listbox.on("itemclick",this.__OnItemClick,this);this._listbox.on("drawcell",this.__OnItemDrawCell,this);var a=this;this._listbox.on("beforeload",function(b){a.fire("beforeload",b)},this);this._listbox.on("preload",function(b){a.fire("preload",b)},this);this._listbox.on("load",function(b){a.data=b.data;a.fire("load",b)},this);this._listbox.on("loaderror",function(b){a.fire("loaderror",b)},this)},showPopup:function(){var a={cancel:!1};this.fire("beforeshowpopup",a);this._firebeforeshowpopup=!1;if(1!=a.cancel){this._listbox.setHeight("auto");mini.ComboBox.superclass.showPopup.call(this);a=this.popup.el.style.height;""==a||"auto"==a?this._listbox.setHeight("auto"):this._listbox.setHeight("100%");if(!this.multiSelect){var a=jQuery("table .mini-listbox-checkbox",this._listbox.el),b=a.css("display");a.css("display","table-cell");a.css("display",b)}this._listbox.setValueInCheckOrder(this.valueInCheckOrder);this._listbox.setValue(this.value);this.autoFocusItem&&(""==this.value||mini.isNull(this.value))&&this._listbox._focusItem(0)}},changeOnSelectMethod:!1,isSelected:function(a){return this._listbox.isSelected(a)},_syncValueText:function(){var a=this._listbox.getSelecteds(),a=this._listbox.getValueAndText(a);this.setValue(a[0]);this.setText(a[1])},selectAll:function(){this._listbox.selectAll();this._syncValueText()},deselectAll:function(){this._listbox.deselectAll();this._syncValueText()},deselect:function(a){this._listbox.deselect(a);this._syncValueText()},select:function(a){this._listbox.deselectAll();if(a=this.getItem(a))this._oldValue=this.getValue(),this._listbox.select(a),this.__OnItemClick({item:a},!1),this.changeOnSelectMethod&&this._OnValueChanged()},selects:function(a){a&&(a=this._listbox.getValueAndText(a),this.setValue(a[0]),this._listbox.setValue(this.value))},getItem:function(a){return"object"==typeof a?a:this.data[a]},indexOf:function(a){return this.data.indexOf(a)},getAt:function(a){return this.data[a]},load:function(a){"string"==typeof a?this.setUrl(a):this.setData(a)},_eval:function(a){return window.eval("("+a+")")},setData:function(a){"string"==typeof a&&(a=this._eval(a));mini.isArray(a)||(a=[]);this._listbox.setData(a);this.data=this._listbox.data;this.doDataChange()},getData:function(){return this.data},clearOnLoad:!0,setClearOnLoad:function(a){this.clearOnLoad=a},getClearOnLoad:function(){return this.clearOnLoad},doDataChange:function(){var a=this._listbox.getValueAndText(this.value),b=a[0],a=a[1];""!==b||this.clearOnLoad||(b=this.value,a=this.text,this.value=null);this.text=this._textEl.value=a;this.setValue(b)},setUrl:function(a){this.getPopup();this._listbox.setUrl(a);this.url=this._listbox.url;this.data=this._listbox.data;this.doDataChange()},getUrl:function(){return this.url},setValueField:function(a){this.valueField=a;this._listbox&&this._listbox.setValueField(a)},getValueField:function(){return this.valueField},setTextField:function(a){this._listbox&&this._listbox.setTextField(a);this.textField=a},getTextField:function(){return this.textField},pinyinField:"tag",setPinyinField:function(a){this.pinyinField=a},getPinyinField:function(){return this.pinyinField},setDisplayField:function(a){this.setTextField(a)},setDataField:function(a){this._listbox&&this._listbox.setDataField(a);this.dataField=a},getDataField:function(){return this.dataField},setValueInCheckOrder:function(a){this.valueInCheckOrder=a;this._listbox.valueInCheckOrder=a},getValueInCheckOrder:function(){return this.valueInCheckOrder},setValue:function(a){mini.isNull(a)&&(a="");var b=this._listbox.getValueAndText(a),c=b[0],b=b[1];if(""===b||mini.isNull(b))b=a;this.valueFromSelect&&(""===c||mini.isNull(c))&&(a=b="");this.value=a;this._valueEl.value=this.value;this.text=this._textEl.value=b;this._doEmpty()},setMultiSelect:function(a){this.multiSelect!=a&&(this.multiSelect=a,this._listbox&&(this._listbox.setMultiSelect(a),this._listbox.setShowCheckBox(a)))},getMultiSelect:function(){return this.multiSelect},setColumns:function(a){mini.isArray(a)||(a=[]);this.columns=a;this._listbox.setColumns(a)},getColumns:function(){return this.columns},showNullItem:!1,setShowNullItem:function(a){this.showNullItem!=a&&(this.showNullItem=a,this._listbox.setShowNullItem(a))},getShowNullItem:function(){return this.showNullItem},setNullItemText:function(a){this.nullItemText!=a&&(this.nullItemText=a,this._listbox.setNullItemText(a))},getNullItemText:function(){return this.nullItemText},setValueFromSelect:function(a){this.valueFromSelect=a},getValueFromSelect:function(){return this.valueFromSelect},_OnValueChanged:function(){this.validateOnChanged&&this._tryValidate();var a=this;setTimeout(function(){var b=a.getValue(),c=a.getSelecteds();a.fire("valuechanged",{value:b,selecteds:c,selected:c[0],oldValue:a._oldValue})},50)},getSelecteds:function(){return this._listbox.findItems(this.value)},getSelected:function(){return this.getSelecteds()[0]},__OnItemDrawCell:function(a){this.fire("drawcell",a)},__OnBeforeItemClick:function(a){var b={item:a.item,cancel:!1};this.fire("beforeitemclick",b);b.cancel&&(a.cancel=!0)},__OnItemClick:function(a,b){var c={item:a.item,cancel:!1};if(!1!==b&&(this.fire("beforeitemclick",c),c.cancel))return;var c=this._listbox.getSelecteds(),c=this._listbox.getValueAndText(c),d=this.getValue();this.setValue(c[0]);this.setText(c[1]);this._oldValue=d;if(a&&!1!==b){if(d!=this.getValue()){var e=this;setTimeout(function(){e._OnValueChanged()},1)}this.multiSelect||this.hidePopup();isMobile||this.focus();this.fire("itemclick",{item:a.item})}},__OnInputKeyDown:function(a,b){var c={htmlEvent:a};this.fire("keydown",c);if(8==a.keyCode&&(this.isReadOnly()||0==this.allowInput))return!1;if(9==a.keyCode)this.isShowPopup()&&(this._autoBlur=!1,this.hidePopup(),delete this._autoBlur);else if(!this.isReadOnly())switch(a.keyCode){case 27:a.preventDefault();this.isShowPopup()&&a.stopPropagation();this.hidePopup();this.focus();break;case 13:if(this.isShowPopup()){a.preventDefault();a.stopPropagation();var d=this._listbox.getFocusedIndex();(c=this._listbox.getAt(d))&&!1!==c.enabled&&-1!=d&&(d={item:c,cancel:!1},this.fire("beforeitemclick",d),0==d.cancel&&(this._oldValue=this.getValue(),this.multiSelect||(this._listbox.deselectAll(),this._listbox.select(c)),c=this._listbox.getSelecteds(),c=this._listbox.getValueAndText(c),this.setValue(c[0]),this.setText(c[1]),this._OnValueChanged()));this.hidePopup();this.focus()}else this.fire("enter",c);break;case 37:break;case 38:a.preventDefault();d=this._listbox.getFocusedIndex();-1==d&&(d=0,this.multiSelect||(c=this._listbox.findItems(this.value)[0])&&(d=this._listbox.indexOf(c)));this.isShowPopup()&&!this.multiSelect&&(--d,0>d&&(d=0),this._listbox._focusItem(d,!0));break;case 39:break;case 40:a.preventDefault();d=this._listbox.getFocusedIndex();-1==d&&(d=-1,this.multiSelect||(c=this._listbox.findItems(this.value)[0])&&(d=this._listbox.indexOf(c)));this.isShowPopup()?this.multiSelect||(d+=1,d>this._listbox.getCount()-1&&(d=this._listbox.getCount()-1),this._listbox._focusItem(d,!0)):this.keyNavEnabled&&(this.showPopup(),this.multiSelect||this._listbox._focusItem(d,!0));break;default:0!=this.allowInput&&this._tryQuery(this._textEl.value)}},__OnInputKeyUp:function(a){this.fire("keyup",{htmlEvent:a})},__OnInputKeyPress:function(a){this.fire("keypress",{htmlEvent:a})},_tryQuery:function(a){var b=this;setTimeout(function(){var c=b._textEl.value;c!=a&&b._doQuery(c)},10)},_doQuery:function(a){if(this.autoFilter&&1!=this.multiSelect){var b=[];a=a.toUpperCase();for(var c=0,d=this.data.length;c<d;c++){var e=this.data[c],f=mini._getMap(this.textField,e),g=mini._getMap(this.pinyinField,e),f=f?String(f).toUpperCase():"",g=g?String(g).toUpperCase():"";-1==f.indexOf(a)&&-1==g.indexOf(a)||b.push(e)}this._listbox.setData(b);this._filtered=!0;if(""!==a||this.isShowPopup())this.showPopup(),a=0,this._listbox.getShowNullItem()&&(a=1),this._listbox._focusItem(a,!0)}},__OnPopupHide:function(a){if(this.valueFromSelect||this._textChanged)this._textChanged=!1,this.__OnInputTextChanged();""==this._textEl.value&&this._listbox._blurItem();this._filtered&&(this._filtered=!1,this._listbox.el&&this._listbox.setData(this.data));this.__doFocusCls();this.fire("hidepopup")},findItems:function(a){return this._listbox.findItems(a)},__OnInputTextChanged:function(a){if(this.isShowPopup())this._textChanged=!0;else if(this._textChanged=!1,this._oldValue=this.getValue(),0==this.multiSelect){a=this._textEl.value;for(var b=this.getData(),c=null,d=0,e=b.length;d<e;d++){var f=b[d],g=f[this.valueField];if(f[this.textField]==a&&(mini.isNull(this.value)||""===this.value||this.value==g)){c=f;break}}if(c){this._listbox.setValue(c?c[this.valueField]:"");a=this._listbox.getValue();var b=this._listbox.getValueAndText(a),k=this.getValue();this.setValue(a);this.setText(b[1])}else this.valueFromSelect?(this.setValue(""),this.setText("")):(this.setValue(a),this.setText(a));k!=this.getValue()&&this._OnValueChanged()}},setAjaxData:function(a){this.ajaxData=a;this._listbox.setAjaxData(a)},setAjaxType:function(a){this.ajaxType=a;this._listbox.setAjaxType(a)},setAjaxOptions:function(a){this.ajaxOptions=a;this._listbox.setAjaxOptions(a)},autoFilter:!0,setAutoFilter:function(a){this.autoFilter=a},getAutoFilter:function(){return this.autoFilter},getAttrs:function(a){var b=mini.ComboBox.superclass.getAttrs.call(this,a);mini._ParseString(a,b,"url data textField valueField displayField nullItemText pinyinField delimiter ondrawcell onbeforeload onpreload onload onloaderror onitemclick onbeforeitemclick".split(" "));mini._ParseBool(a,b,"multiSelect showNullItem valueFromSelect valueInCheckOrder clearOnLoad autoFilter autoFocusItem".split(" "));b.displayField&&(b.textField=b.displayField);var c=b.valueField||this.valueField,d=b.textField||this.textField;if("select"==a.nodeName.toLowerCase()){for(var e=[],f=0,g=a.length;f<g;f++){var k=a.options[f],l={};l[d]=k.text;l[c]=k.value;e.push(l)}0<e.length&&(b.data=e)}else for(a=mini.getChildNodes(a),f=0,g=a.length;f<g;f++)if(c=a[f],d=jQuery(c).attr("property"))d=d.toLowerCase(),"columns"==d?b.columns=mini._ParseColumns(c):"data"==d&&(b.data=c.innerHTML);return b}});mini.regClass(mini.ComboBox,"combobox");mini.DatePicker=function(){mini.DatePicker.superclass.constructor.apply(this,arguments);mini.addClass(this.el,"mini-datepicker");this.on("validation",this.__OnValidation,this)};mini.extend(mini.DatePicker,mini.PopupEdit,{valueFormat:"",format:"yyyy-MM-dd",maxDate:null,minDate:null,popupWidth:"",viewDate:new Date,showTime:!1,timeFormat:"H:mm",showYesterdayButton:!1,showTodayButton:!0,showClearButton:!0,showOkButton:!1,valueType:"date",uiCls:"mini-datepicker",_getCalendar:function(){mini.DatePicker._Calendar&&!mini.DatePicker._Calendar.destroyed||(mini.DatePicker._Calendar=new mini.Calendar).setStyle("border:0;");return mini.DatePicker._Calendar},destroy:function(a){this._calendar=null;mini.DatePicker.superclass.destroy.call(this,a)},_createPopup:function(){mini.DatePicker.superclass._createPopup.call(this);this._calendar=this._getCalendar()},__OnPopupClose:function(a){this._calendar&&this._calendar.hideMenu()},_monthPicker:!1,showPopup:function(){var a={cancel:!1};this.fire("beforeshowpopup",a);1!=a.cancel&&(this._calendar=this._getCalendar(),this._calendar.beginUpdate(),this._calendar._allowLayout=!1,this._calendar.el.parentNode!=this.popup._contentEl&&this._calendar.render(this.popup._contentEl),this._calendar.set({monthPicker:this._monthPicker,showTime:this.showTime,timeFormat:this.timeFormat,showClearButton:this.showClearButton,showYesterdayButton:this.showYesterdayButton,showTodayButton:this.showTodayButton,showOkButton:this.showOkButton,showWeekNumber:this.showWeekNumber}),this._calendar.setValue(this.value),this.value?this._calendar.setViewDate(this.value):this._calendar.setViewDate(this.viewDate),this._calendar.hideMenu(),this._calendar._target&&(a=this._calendar._target,this._calendar.un("timechanged",a.__OnTimeChanged,a),this._calendar.un("dateclick",a.__OnDateClick,a),this._calendar.un("drawdate",a.__OnDrawDate,a)),this._calendar.on("timechanged",this.__OnTimeChanged,this),this._calendar.on("dateclick",this.__OnDateClick,this),this._calendar.on("drawdate",this.__OnDrawDate,this),this._calendar.endUpdate(),this._calendar._allowLayout=!0,this._calendar.doLayout(),this._calendar.focus(),this._calendar._target=this,mini.DatePicker.superclass.showPopup.call(this))},hidePopup:function(){mini.DatePicker.superclass.hidePopup.call(this);this._calendar&&(this._calendar.un("timechanged",this.__OnTimeChanged,this),this._calendar.un("dateclick",this.__OnDateClick,this),this._calendar.un("drawdate",this.__OnDrawDate,this),this._calendar.hideMenu())},within:function(a){return mini.isAncestor(this.el,a.target)||this._calendar.within(a)?!0:!1},__OnPopupKeyDown:function(a){13==a.keyCode&&this.__OnDateClick();27==a.keyCode&&(this.hidePopup(),this.focus())},minDateErrorText:"",maxDateErrorText:"",__OnValidation:function(a){if(0!=a.isValid){var b=this.value;if(mini.isDate(b)){var c=mini.parseDate(this.maxDate),d=mini.parseDate(this.minDate),e=this.maxDateErrorText||mini.VTypes.maxDateErrorText,f=this.minDateErrorText||mini.VTypes.minDateErrorText;mini.isDate(c)&&b.getTime()>c.getTime()&&(a.isValid=!1,a.errorText=String.format(e,mini.formatDate(c,this.format)));mini.isDate(d)&&b.getTime()<d.getTime()&&(a.isValid=!1,a.errorText=String.format(f,mini.formatDate(d,this.format)))}}},__OnDrawDate:function(a){var b=a.date,c=mini.parseDate(this.maxDate),d=mini.parseDate(this.minDate);mini.isDate(c)&&b.getTime()>c.getTime()&&(a.allowSelect=!1);mini.isDate(d)&&b.getTime()<d.getTime()&&(a.allowSelect=!1);this.fire("drawdate",a)},__OnDateClick:function(a){if(a&&(!this.showOkButton||"ok"==a.action)){a=this._calendar.getValue();var b=this.getFormValue("U");this.setValue(a);b!==this.getFormValue("U")&&this._OnValueChanged();this.hidePopup();isMobile||this.focus()}},__OnTimeChanged:function(a){this.showOkButton||(a=this._calendar.getValue(),this.setValue(a),this._OnValueChanged())},setFormat:function(a){"string"==typeof a&&this.format!=a&&(this.format=a,this._textEl.value=this._valueEl.value=this.getFormValue())},getFormat:function(){return this.format},setValueFormat:function(a){"string"==typeof a&&this.valueFormat!=a&&(this.valueFormat=a)},getValueFormat:function(){return this.valueFormat},setValue:function(a){"date"==this.valueType?a=mini.parseDate(a):mini.isDate(a)&&(a=mini.formatDate(a,this.format));mini.isNull(a)&&(a="");mini.isDate(a)&&(a=new Date(a.getTime()),mini.isDate(a)&&isNaN(a.getTime())&&(a=""));this.value!=a&&(this.value=a);this.text=this._textEl.value=this._valueEl.value=this.getFormValue()},nullValue:"",setNullValue:function(a){"null"==a&&(a=null);this.nullValue=a},getNullValue:function(){return this.nullValue},getValue:function(){if("date"!=this.valueType)return this.value;if(!mini.isDate(this.value))return this.nullValue;var a=this.value;this.valueFormat&&(a=mini.formatDate(a,this.valueFormat));return a},getFormValue:function(a){if("date"!=this.valueType)return this.value;if(!mini.isDate(this.value))return"";a=a||this.format;return mini.formatDate(this.value,a)},setViewDate:function(a){a=mini.parseDate(a);mini.isDate(a)&&(this.viewDate=a)},getViewDate:function(){return this._calendar.getViewDate()},setShowTime:function(a){this.showTime!=a&&(this.showTime=a)},getShowTime:function(){return this.showTime},setTimeFormat:function(a){this.timeFormat!=a&&(this.timeFormat=a)},getTimeFormat:function(){return this.timeFormat},setShowYesterdayButton:function(a){this.showYesterdayButton=a},getShowYesterdayButton:function(){return this.showYesterdayButton},setShowTodayButton:function(a){this.showTodayButton=a},getShowTodayButton:function(){return this.showTodayButton},setShowClearButton:function(a){this.showClearButton=a},getShowClearButton:function(){return this.showClearButton},setShowOkButton:function(a){this.showOkButton=a},getShowOkButton:function(){return this.showOkButton},setShowWeekNumber:function(a){this.showWeekNumber=a},getShowWeekNumber:function(){return this.showWeekNumber},setMaxDate:function(a){this.maxDate=a},getMaxDate:function(){return this.maxDate},setMinDate:function(a){this.minDate=a},getMinDate:function(){return this.minDate},setMaxDateErrorText:function(a){this.maxDateErrorText=a},getMaxDateErrorText:function(){return this.maxDateErrorText},setMinDateErrorText:function(a){this.minDateErrorText=a},getMinDateErrorText:function(){return this.minDateErrorText},__OnInputTextChanged:function(a){a=this._textEl.value;var b=this.getFormValue("U");if("date"==this.valueType){var c=mini.parseDate(a);!c||isNaN(c)}this.setValue(a);b!==this.getFormValue("U")&&this._OnValueChanged()},__OnInputKeyDown:function(a){var b={htmlEvent:a};this.fire("keydown",b);if(8==a.keyCode&&(this.isReadOnly()||0==this.allowInput))return!1;if(9==a.keyCode)this.isShowPopup()&&this.hidePopup();else if(!this.isReadOnly())switch(a.keyCode){case 27:a.preventDefault();this.isShowPopup()&&a.stopPropagation();this.hidePopup();break;case 9:case 13:if(this.isShowPopup())a.preventDefault(),a.stopPropagation(),this.hidePopup(),this.focus();else{this.__OnInputTextChanged(null);var c=this;setTimeout(function(){c.fire("enter",b)},10)}break;case 38:a.preventDefault();break;case 40:this.keyNavEnabled&&(a.preventDefault(),this.showPopup())}},getAttrs:function(a){var b=mini.DatePicker.superclass.getAttrs.call(this,a);mini._ParseString(a,b,"format viewDate timeFormat ondrawdate minDate maxDate valueType valueFormat nullValue minDateErrorText maxDateErrorText".split(" "));mini._ParseBool(a,b,"showTime showTodayButton showClearButton showOkButton showWeekNumber showYesterdayButton".split(" "));return b}});mini.regClass(mini.DatePicker,"datepicker");mini.MonthPicker=function(){mini.MonthPicker.superclass.constructor.apply(this,arguments)};mini.extend(mini.MonthPicker,mini.DatePicker,{uiCls:"mini-monthpicker",valueFormat:"",format:"yyyy-MM",_monthPicker:!0});mini.regClass(mini.MonthPicker,"monthpicker");mini.Calendar=function(){this.viewDate=new Date;this._selectedDates=[];mini.Calendar.superclass.constructor.apply(this,arguments)};mini.extend(mini.Calendar,mini.Control,{width:220,height:160,monthPicker:!1,_clearBorder:!1,viewDate:null,_selectedDate:"",_selectedDates:[],multiSelect:!1,firstDayOfWeek:0,yesterdayText:"Yesterday",todayText:"Today",clearText:"Clear",okText:"OK",cancelText:"Cancel",daysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),format:"MMM, yyyy",timeFormat:"H:mm",showTime:!1,currentTime:!0,rows:1,columns:1,headerCls:"",bodyCls:"",footerCls:"",_todayCls:"mini-calendar-today",_weekendCls:"mini-calendar-weekend",_otherMonthCls:"mini-calendar-othermonth",_selectedDateCls:"mini-calendar-selected",showHeader:!0,showFooter:!0,showWeekNumber:!1,showDaysHeader:!0,showMonthButtons:!0,showYearButtons:!0,showTodayButton:!0,showClearButton:!0,showOkButton:!1,showYesterdayButton:!1,isWeekend:function(a){a=a.getDay();return 0==a||6==a},getFirstDateOfMonth:function(a){a=new Date(a.getFullYear(),a.getMonth(),1);return mini.getWeekStartDate(a,this.firstDayOfWeek)},getShortWeek:function(a){return this.daysShort[a]},uiCls:"mini-calendar",_create:function(){var a='\x3ctable class\x3d"mini-calendar" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\x3ctr style\x3d"width:100%;"\x3e\x3ctd style\x3d"width:100%;"\x3e\x3c/td\x3e\x3c/tr\x3e'+('\x3ctr \x3e\x3ctd\x3e\x3cdiv class\x3d"mini-calendar-footer"\x3e\x3cspan style\x3d"display:inline-block;"\x3e\x3cinput name\x3d"time" class\x3d"mini-timespinner mini-calendar-timespinner" format\x3d"'+this.timeFormat+'"/\x3e\x3cspan class\x3d"mini-calendar-footerSpace"\x3e\x3c/span\x3e\x3c/span\x3e\x3cspan class\x3d"mini-calendar-tadayButton mini-calendar-button mini-corner-all"\x3e'+this.todayText+'\x3c/span\x3e\x3cspan class\x3d"mini-calendar-footerSpace"\x3e\x3c/span\x3e\x3cspan class\x3d"mini-calendar-clearButton mini-calendar-button mini-corner-all"\x3e'+this.clearText+'\x3c/span\x3e\x3cspan class\x3d"mini-calendar-okButton mini-calendar-button mini-corner-all"\x3e'+this.okText+'\x3c/span\x3e\x3ca href\x3d"#" class\x3d"mini-calendar-focus" style\x3d"position:absolute;left:-10px;top:-10px;width:0px;height:0px;outline:none" hideFocus\x3e\x3c/a\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e')+"\x3c/table\x3e",b=document.createElement("div");b.innerHTML=a;this.el=b.firstChild;this.el.getElementsByTagName("tr");this._innerEl=this.el.getElementsByTagName("td")[0];this._footerEl=mini.byClass("mini-calendar-footer",this.el);this.timeWrapEl=this._footerEl.childNodes[0];this.todayButtonEl=this._footerEl.childNodes[1];this.footerSpaceEl=this._footerEl.childNodes[2];this.closeButtonEl=this._footerEl.childNodes[3];this.okButtonEl=this._footerEl.childNodes[4];this._focusEl=this._footerEl.lastChild;this.yesterdayButtonEl=mini.after(this.todayButtonEl,'\x3cspan class\x3d"mini-calendar-tadayButton yesterday mini-calendar-button mini-corner-all"\x3e'+this.yesterdayText+"\x3c/span\x3e");mini.parse(this._footerEl);this.timeSpinner=mini.getbyName("time",this.el);this.doUpdate()},focus:function(){try{this._focusEl.focus()}catch(a){}},destroy:function(a){this.timeSpinner&&(this.timeSpinner.destroy(),this.timeSpinner=null);this.timeSpinner=this._focusEl=this.okButtonEl=this.yesterdayButtonEl=this._innerEl=this._footerEl=this.timeWrapEl=this.todayButtonEl=this.footerSpaceEl=this.closeButtonEl=null;mini.Calendar.superclass.destroy.call(this,a)},_initEvents:function(){if(this.timeSpinner)this.timeSpinner.on("valuechanged",this.__OnTimeChanged,this);mini._BindEvents(function(){mini.on(this.el,"click",this.__OnClick,this);mini.on(this.el,"mousedown",this.__OnMouseDown,this);mini.on(this.el,"keydown",this.__OnKeyDown,this)},this)},getDateEl:function(a){if(!a)return null;a=this.uid+"$"+mini.clearTime(a).getTime();return document.getElementById(a)},within:function(a){return mini.isAncestor(this.el,a.target)||this.menuEl&&mini.isAncestor(this.menuEl,a.target)?!0:!1},setShowHeader:function(a){this.showHeader=a;this.doUpdate()},getShowHeader:function(){return this.showHeader},setShowFooter:function(a){this.showFooter=a;this.doUpdate()},getShowFooter:function(){return this.showFooter},setShowWeekNumber:function(a){this.showWeekNumber=a;this.doUpdate()},getShowWeekNumber:function(){return this.showWeekNumber},setShowDaysHeader:function(a){this.showDaysHeader=a;this.doUpdate()},getShowDaysHeader:function(){return this.showDaysHeader},setShowMonthButtons:function(a){this.showMonthButtons=a;this.doUpdate()},getShowMonthButtons:function(){return this.showMonthButtons},setShowYearButtons:function(a){this.showYearButtons=a;this.doUpdate()},getShowYearButtons:function(){return this.showYearButtons},setShowTodayButton:function(a){this.showTodayButton=a;this.todayButtonEl.style.display=this.showTodayButton?"":"none";this.doUpdate()},getShowTodayButton:function(){return this.showTodayButton},setShowYesterdayButton:function(a){this.showYesterdayButton=a;this.yesterdayButtonEl.style.display=this.showYesterdayButton?"":"none";this.doUpdate()},getShowYesterdayButton:function(){return this.showYesterdayButton},setShowClearButton:function(a){this.showClearButton=a;this.closeButtonEl.style.display=this.showClearButton?"":"none";this.doUpdate()},getShowClearButton:function(){return this.showClearButton},setShowOkButton:function(a){this.showOkButton=a;this.okButtonEl.style.display=this.showOkButton?"":"none";this.doUpdate()},getShowOkButton:function(){return this.showOkButton},setViewDate:function(a){(a=mini.parseDate(a))||(a=new Date);mini.isDate(a)&&(a=new Date(a.getTime()));this.viewDate=a;this.doUpdate()},getViewDate:function(){return this.viewDate},setSelectedDate:function(a){a=mini.parseDate(a);a=mini.isDate(a)?new Date(a.getTime()):"";var b=this.getDateEl(this._selectedDate);b&&mini.removeClass(b,this._selectedDateCls);if(this._selectedDate=a)this._selectedDate=mini.cloneDate(this._selectedDate);(b=this.getDateEl(this._selectedDate))&&mini.addClass(b,this._selectedDateCls);this.fire("datechanged")},setSelectedDates:function(a){mini.isArray(a)||(a=[]);this._selectedDates=a;this.doUpdate()},getSelectedDate:function(){return this._selectedDate?this._selectedDate:""},setTime:function(a){this.timeSpinner.setValue(a)},getTime:function(){return this.timeSpinner.getFormValue()},setValue:function(a){this.setSelectedDate(a);a||(a=new Date);this.setTime(a)},getValue:function(){var a=this._selectedDate;if(a&&(a=mini.clearTime(a),this.showTime)){var b=this.timeSpinner.getValue();b&&(a.setHours(b.getHours()),a.setMinutes(b.getMinutes()),a.setSeconds(b.getSeconds()))}return a?a:""},getFormValue:function(){var a=this.getValue();return a?mini.formatDate(a,"yyyy-MM-dd HH:mm:ss"):""},isSelectedDate:function(a){return a&&this._selectedDate?mini.clearTime(a).getTime()==mini.clearTime(this._selectedDate).getTime():!1},setMultiSelect:function(a){this.multiSelect=a;this.doUpdate()},getMultiSelect:function(){return this.multiSelect},setRows:function(a){isNaN(a)||(1>a&&(a=1),this.rows=a,this.doUpdate())},getRows:function(){return this.rows},setColumns:function(a){isNaN(a)||(1>a&&(a=1),this.columns=a,this.doUpdate())},getColumns:function(){return this.columns},setShowTime:function(a){this.showTime!=a&&(this.showTime=a,this.timeWrapEl.style.display=this.showTime?"":"none",jQuery(this._footerEl).toggleClass("mini-calendar-hastime",this.showTime),this.doLayout())},getShowTime:function(){return this.showTime},setTimeFormat:function(a){this.timeFormat!=a&&(this.timeSpinner.setFormat(a),this.timeFormat=this.timeSpinner.format)},getTimeFormat:function(){return this.timeFormat},doLayout:function(){if(this.canLayout()){this.timeWrapEl.style.display=this.showTime?"":"none";this.todayButtonEl.style.display=this.showTodayButton?"":"none";this.closeButtonEl.style.display=this.showClearButton?"":"none";this.yesterdayButtonEl.style.display=this.showYesterdayButton?"":"none";this.okButtonEl.style.display=this.showOkButton?"":"none";this.footerSpaceEl.style.display=this.showClearButton&&this.showTodayButton?"":"none";this._footerEl.style.display=this.showFooter?"":"none";var a=this._innerEl.firstChild;this.isAutoHeight()?a.parentNode.style.height="":(a.parentNode.style.height="100px",h=jQuery(this.el).height(),h-=jQuery(this._footerEl).outerHeight(),a.parentNode.style.height=h+"px");mini.layout(this._footerEl);this.monthPicker&&this._tryShowMenu()}},doUpdate:function(){if(this._allowUpdate){for(var a=new Date(this.viewDate.getTime()),b=100/this.rows,c='\x3ctable class\x3d"mini-calendar-views" border\x3d"0" cellpadding\x3d"0" cellspacing\x3d"0"\x3e',d=0,e=this.rows;d<e;d++){for(var c=c+"\x3ctr \x3e",f=0,g=this.columns;f<g;f++)c+='\x3ctd style\x3d"height:'+b+'%"\x3e',c+=this._CreateView(a,d,f),c+="\x3c/td\x3e",a=new Date(a.getFullYear(),a.getMonth()+1,1);c+="\x3c/tr\x3e"}this._innerEl.innerHTML=c+"\x3c/table\x3e";var k=this.el;setTimeout(function(){mini.repaint(k)},100);this.doLayout()}},_CreateView:function(a,b,c){var d=a.getMonth(),e=this.getFirstDateOfMonth(a),f=new Date(e.getTime()),g=mini.clearTime(new Date).getTime();this.value&&mini.clearTime(this.value).getTime();var k=1<this.rows||1<this.columns,l;l='\x3ctable class\x3d"mini-calendar-view" border\x3d"0" cellpadding\x3d"0" cellspacing\x3d"0"\x3e';this.showHeader&&(l+='\x3ctr \x3e\x3ctd colSpan\x3d"10" class\x3d"mini-calendar-header"\x3e\x3cdiv class\x3d"mini-calendar-headerInner"\x3e',0==b&&0==c&&(l+='\x3cdiv class\x3d"mini-calendar-prev mini-icon"\x3e',this.showYearButtons&&(l+='\x3cspan class\x3d"mini-calendar-yearPrev mini-icon"\x3e\x3c/span\x3e'),this.showMonthButtons&&(l+='\x3cspan class\x3d"mini-calendar-monthPrev mini-icon"\x3e\x3c/span\x3e'),l+="\x3c/div\x3e"),0==b&&c==this.columns-1&&(l+='\x3cdiv class\x3d"mini-calendar-next mini-icon"\x3e',this.showMonthButtons&&(l+='\x3cspan class\x3d"mini-calendar-monthNext mini-icon"\x3e\x3c/span\x3e'),this.showYearButtons&&(l+='\x3cspan class\x3d"mini-calendar-yearNext mini-icon"\x3e\x3c/span\x3e'),l+="\x3c/div\x3e"),l+='\x3cspan class\x3d"mini-calendar-title"\x3e'+mini.formatDate(a,this.format),NaN,l+="\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e");if(this.showDaysHeader){l+='\x3ctr class\x3d"mini-calendar-daysheader"\x3e\x3ctd class\x3d"mini-calendar-space"\x3e\x3c/td\x3e';this.showWeekNumber&&(l+='\x3ctd sclass\x3d"mini-calendar-weeknumber"\x3e\x3c/td\x3e');a=this.firstDayOfWeek;for(b=a+7;a<b;a++)c=this.getShortWeek(a),l+='\x3ctd yAlign\x3d"middle"\x3e',l+=c,l+="\x3c/td\x3e",e=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1);l+='\x3ctd class\x3d"mini-calendar-space"\x3e\x3c/td\x3e\x3c/tr\x3e'}e=f;for(f=0;5>=f;f++){l+='\x3ctr class\x3d"mini-calendar-days"\x3e\x3ctd class\x3d"mini-calendar-space"\x3e\x3c/td\x3e';this.showWeekNumber&&(a=mini.getWeek(e.getFullYear(),e.getMonth()+1,e.getDate()),1==String(a).length&&(a="0"+a),l+='\x3ctd class\x3d"mini-calendar-weeknumber" yAlign\x3d"middle"\x3e'+a+"\x3c/td\x3e");a=this.firstDayOfWeek;for(b=a+7;a<b;a++){c=this.isWeekend(e);var n=mini.clearTime(e).getTime(),p=n==g,q=this.isSelectedDate(e);d!=e.getMonth()&&k&&(n=-1);var r=this._OnDrawDate(e);l+='\x3ctd yAlign\x3d"middle" id\x3d"';l+=this.uid+"$"+n;l+='" class\x3d"mini-calendar-date ';c&&(l+=" mini-calendar-weekend ");0==r.allowSelect&&(l+=" mini-calendar-disabled ");d!=e.getMonth()&&k||(q&&(l+=" "+this._selectedDateCls+" "),p&&(l+=" mini-calendar-today "));d!=e.getMonth()&&(l+=" mini-calendar-othermonth ");r.dateCls&&(l+=" "+r.dateCls);l+='" style\x3d"';r.dateStyle&&(l+=r.dateStyle);l+='"\x3e';d!=e.getMonth()&&k||(l+=r.dateHtml);l+="\x3c/td\x3e";e=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1)}l+='\x3ctd class\x3d"mini-calendar-space"\x3e\x3c/td\x3e\x3c/tr\x3e'}return l+'\x3ctr class\x3d"mini-calendar-bottom" colSpan\x3d"10"\x3e\x3ctd \x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e'},_OnDrawDate:function(a){a={date:a,dateCls:"",dateStyle:"",dateHtml:a.getDate(),allowSelect:!0};this.fire("drawdate",a);return a},_OnDateClick:function(a,b){this.fire("dateclick",{date:a,action:b});this._OnValueChanged();this.hideMenu()},menuEl:null,menuYear:null,menuSelectMonth:null,menuSelectYear:null,_tryShowMenu:function(){if(!this.menuEl){var a=this;setTimeout(function(){a.showMenu()},1)}},showMenu:function(){this.hideMenu();this.menuYear=10*parseInt(this.viewDate.getFullYear()/10);this._menuselectMonth=this.viewDate.getMonth();this._menuselectYear=this.viewDate.getFullYear();this.menuEl=mini.append(document.body,'\x3cdiv class\x3d"mini-calendar-menu"\x3e\x3c/div\x3e');this.updateMenu(this.viewDate);var a=this.getBox();"0px"==this.el.style.borderWidth&&(this.menuEl.style.border="0");mini.setBox(this.menuEl,a);mini.on(this.menuEl,"click",this.__OnMenuClick,this);mini.on(this.menuEl,"dblclick",this.__OnMenuDblClick,this);mini.on(document,"mousedown",this.__OnBodyMenuMouseDown,this)},hideMenu:function(){this.menuEl&&(mini.un(this.menuEl,"click",this.__OnMenuClick,this),mini.un(document,"mousedown",this.__OnBodyMenuMouseDown,this),jQuery(this.menuEl).remove(),this.menuEl=null)},updateMenu:function(){if(this.menuEl){for(var a='\x3cdiv class\x3d"mini-calendar-menu-months"\x3e',b=0,c=12;b<c;b++){var d=mini.getShortMonth(b),e="";this._menuselectMonth==b&&(e="mini-calendar-menu-selected");a+='\x3ca id\x3d"'+b+'" class\x3d"mini-calendar-menu-month '+e+'" href\x3d"javascript:void(0);" hideFocus onclick\x3d"return false"\x3e'+d+"\x3c/a\x3e"}a+='\x3cdiv style\x3d"clear:both;"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-calendar-menu-years"\x3e';b=this.menuYear;for(c=this.menuYear+10;b<c;b++)d=b,e="",this._menuselectYear==b&&(e="mini-calendar-menu-selected"),a+='\x3ca id\x3d"'+b+'" class\x3d"mini-calendar-menu-year '+e+'" href\x3d"javascript:void(0);" hideFocus onclick\x3d"return false"\x3e'+d+"\x3c/a\x3e";a=a+'\x3cdiv class\x3d"mini-calendar-menu-prevYear mini-icon"\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-calendar-menu-nextYear mini-icon"\x3e\x3c/div\x3e\x3cdiv style\x3d"clear:both;"\x3e\x3c/div\x3e\x3c/div\x3e'+('\x3cdiv class\x3d"mini-calendar-footer"\x3e\x3cspan class\x3d"mini-calendar-okButton mini-calendar-button mini-corner-all"\x3e'+this.okText+'\x3c/span\x3e\x3cspan class\x3d"mini-calendar-footerSpace"\x3e\x3c/span\x3e\x3cspan class\x3d"mini-calendar-cancelButton mini-calendar-button mini-corner-all"\x3e'+this.cancelText+'\x3c/span\x3e\x3c/div\x3e\x3cdiv style\x3d"clear:both;"\x3e\x3c/div\x3e');this.menuEl.innerHTML=a}},__OnMenuClick:function(a){function b(){setTimeout(function(){c.updateMenu()},30)}var c=this;a=a.target;var d=mini.findParent(a,"mini-calendar-menu-month"),e=mini.findParent(a,"mini-calendar-menu-year");d?(this._menuselectMonth=parseInt(d.id),jQuery(".mini-calendar-menu-month",c.menuEl).removeClass("mini-calendar-menu-selected"),jQuery(a).parent().find("#"+this._menuselectMonth).addClass("mini-calendar-menu-selected")):e?(this._menuselectYear=parseInt(e.id),jQuery(".mini-calendar-menu-year",c.menuEl).removeClass("mini-calendar-menu-selected"),jQuery(a).parent().find("#"+this._menuselectYear).addClass("mini-calendar-menu-selected")):mini.findParent(a,"mini-calendar-menu-prevYear")?(--this.menuYear,this.menuYear=10*parseInt(this.menuYear/10),b()):mini.findParent(a,"mini-calendar-menu-nextYear")?(this.menuYear+=11,this.menuYear=10*parseInt(this.menuYear/10),b()):mini.findParent(a,"mini-calendar-okButton")?this.__getMonthYear():mini.findParent(a,"mini-calendar-cancelButton")&&(this.monthPicker?this._OnDateClick(null,"cancel"):this.hideMenu())},__OnMenuDblClick:function(a){var b=mini.findParent(a.target,"mini-calendar-menu-year"),c=mini.findParent(a.target,"mini-calendar-menu-month");a=mini.findParent(a.target,"mini-calendar-date ");(b||c||a)&&(!this.monthPicker||c||b)&&this.__getMonthYear()},__getMonthYear:function(){var a=new Date(this._menuselectYear,this._menuselectMonth,1);this.monthPicker?(this.setViewDate(a),this.setSelectedDate(a),this._OnDateClick(a)):(this.setViewDate(a),this.hideMenu())},__OnBodyMenuMouseDown:function(a){mini.findParent(a.target,"mini-calendar-menu")||mini.findParent(a.target,"mini-monthpicker")||this.hideMenu()},__OnClick:function(a){var b=this.viewDate;if(0!=this.enabled){var c=a.target,d=mini.findParent(a.target,"mini-calendar-title");mini.findParent(c,"mini-calendar-monthNext")?(b.setDate(1),b.setMonth(b.getMonth()+1),this.setViewDate(b)):mini.findParent(c,"mini-calendar-yearNext")?(b.setDate(1),b.setFullYear(b.getFullYear()+1),this.setViewDate(b)):mini.findParent(c,"mini-calendar-monthPrev")?(b.setMonth(b.getMonth()-1),this.setViewDate(b)):mini.findParent(c,"mini-calendar-yearPrev")?(b.setFullYear(b.getFullYear()-1),this.setViewDate(b)):mini.findParent(c,"mini-calendar-tadayButton")?(b=!!mini.findParent(c,"yesterday"),c=new Date,b&&c.setDate(c.getDate()-1),this.setViewDate(c),this.setSelectedDate(c),this.currentTime&&this.setTime(new Date),this._OnDateClick(c,"today")):mini.findParent(c,"mini-calendar-clearButton")?(this.setSelectedDate(null),this.setTime(null),this._OnDateClick(null,"clear")):mini.findParent(c,"mini-calendar-okButton")?this._OnDateClick(null,"ok"):d&&this.showMenu();(a=mini.findParent(a.target,"mini-calendar-date"))&&!mini.hasClass(a,"mini-calendar-disabled")&&(a=a.id.split("$"),a=parseInt(a[a.length-1]),-1!=a&&this._OnDateClick(new Date(a)))}},__OnMouseDown:function(a){0!=this.enabled&&(a=mini.findParent(a.target,"mini-calendar-date"))&&!mini.hasClass(a,"mini-calendar-disabled")&&(a=a.id.split("$"),a=parseInt(a[a.length-1]),-1!=a&&this.setSelectedDate(new Date(a)))},__OnTimeChanged:function(a){this.fire("timechanged");this._OnValueChanged()},__OnKeyDown:function(a){if(0!=this.enabled){var b=this.getSelectedDate();b||(b=new Date(this.viewDate.getTime()));switch(a.keyCode){case 13:b&&this._OnDateClick(b);return;case 37:b=mini.addDate(b,-1,"D");break;case 38:b=mini.addDate(b,-7,"D");break;case 39:b=mini.addDate(b,1,"D");break;case 40:b=mini.addDate(b,7,"D")}b.getMonth()!=this.viewDate.getMonth()&&(this.setViewDate(mini.cloneDate(b)),this.focus());var c=this.getDateEl(b);c&&mini.hasClass(c,"mini-calendar-disabled")||(this.setSelectedDate(b),37!=a.keyCode&&38!=a.keyCode&&39!=a.keyCode&&40!=a.keyCode||a.preventDefault())}},_OnValueChanged:function(){this.fire("valuechanged")},getAttrs:function(a){var b=mini.Calendar.superclass.getAttrs.call(this,a);mini._ParseString(a,b,"viewDate rows columns ondateclick ondrawdate ondatechanged timeFormat ontimechanged onvaluechanged".split(" "));mini._ParseBool(a,b,"multiSelect showHeader showFooter showWeekNumber showDaysHeader showMonthButtons showYearButtons showTodayButton showClearButton showYesterdayButton showTime showOkButton".split(" "));return b}});mini.regClass(mini.Calendar,"calendar");mini.ListBox=function(){mini.ListBox.superclass.constructor.apply(this,arguments)};mini.extend(mini.ListBox,mini.ListControl,{formField:!0,columns:null,columnWidth:80,showNullItem:!1,nullItemText:"",showEmpty:!1,emptyText:"",showCheckBox:!1,showAllCheckBox:!0,multiSelect:!1,_itemCls:"mini-listbox-item",_itemHoverCls:"mini-listbox-item-hover",_itemSelectedCls:"mini-listbox-item-selected",uiCls:"mini-listbox",_create:function(){this.el=document.createElement("div");this.el.className="mini-listbox";this.el.innerHTML='\x3cdiv class\x3d"mini-listbox-border"\x3e\x3cdiv class\x3d"mini-listbox-header"\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-listbox-view"\x3e\x3c/div\x3e\x3cinput type\x3d"hidden"/\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-errorIcon"\x3e\x3c/div\x3e';this._borderEl=this.el.firstChild;this._headerEl=this._borderEl.firstChild;this._viewEl=this._borderEl.childNodes[1];this._valueEl=this._borderEl.childNodes[2];this._errorIconEl=this.el.lastChild;this._scrollViewEl=this._viewEl;this._viewEl.innerHTML='\x3cdiv class\x3d"mini-grid-rows-content"\x3e\x3c/div\x3e';this._contentEl=this._viewEl.firstChild},_initEvents:function(){mini.ListBox.superclass._initEvents.call(this);mini._BindEvents(function(){mini_onOne(this._viewEl,"scroll",this.__OnScroll,this)},this)},destroy:function(a){this._viewEl&&(this._viewEl.onscroll=null,mini.clearEvent(this._viewEl),this._viewEl=null);this._borderEl=this._headerEl=this._viewEl=this._valueEl=this._errorIconEl=this._scrollViewEl=this._contentEl=null;mini.ListBox.superclass.destroy.call(this,a)},setColumns:function(a){mini.isArray(a)||(a=[]);this.columns=a;a=0;for(var b=this.columns.length;a<b;a++){var c=this.columns[a];if(c.type){mini.isNull(c.header)||"function"===typeof c.header||""==c.header.trim()&&delete c.header;var d=mini._getColumn(c.type);if(d){var e=mini.copyTo({},c);mini.copyTo(c,d);mini.copyTo(c,e)}}d=parseInt(c.width);mini.isNumber(d)&&String(d)==c.width&&(c.width=d+"px");mini.isNull(c.width)&&(c.width=this.columnWidth+"px")}this.doUpdate()},isVisibleColumn:function(a){a=this.getColumn(a);return 0==a.visible?!1:!0},getColumn:function(a){var b=typeof a;if("number"==b)return this.columns[a];if("object"==b)return a;for(var b=0,c=this.columns.length;b<c;b++){var d=this.columns[b];if(d.name==a)return d}return null},hideColumn:function(a){if(a=this.getColumn(a))a.visible=!1,this.doUpdate()},showColumn:function(a){if(a=this.getColumn(a))a.visible=!0,this.doUpdate()},getColumns:function(){return this.columns},doUpdate:function(){if(!1!==this._allowUpdate){var a=this.columns&&0<this.columns.length;a?mini.addClass(this.el,"mini-listbox-showColumns"):mini.removeClass(this.el,"mini-listbox-showColumns");this._headerEl.style.display=a?"":"none";var b=[];if(a){b[b.length]='\x3ctable class\x3d"mini-listbox-headerInner" cellspacing\x3d"0" cellpadding\x3d"0"\x3e\x3ctr\x3e';var c=this.uid+"$ck$all";this.showCheckBox&&(b[b.length]='\x3ctd class\x3d"mini-listbox-checkbox"\x3e\x3cinput type\x3d"checkbox" id\x3d"'+c+'"\x3e\x3c/td\x3e');for(var d=0,e=this.columns.length;d<e;d++){var f=this.columns[d];if(!1!==f.visible){c=f.header;mini.isNull(c)&&(c="\x26nbsp;");var g=f.width;mini.isNumber(g)&&(g+="px");b[b.length]='\x3ctd class\x3d"';f.headerCls&&(b[b.length]=f.headerCls);b[b.length]='" style\x3d"';f.headerStyle&&(b[b.length]=f.headerStyle+";");g&&(b[b.length]="width:"+g+";");f.headerAlign&&(b[b.length]="text-align:"+f.headerAlign+";");b[b.length]='"\x3e';b[b.length]=c;b[b.length]="\x3c/td\x3e"}}b[b.length]="\x3c/tr\x3e\x3c/table\x3e"}this._headerEl.innerHTML=b.join("");b=[];c=this.data;b[b.length]='\x3ctable class\x3d"mini-listbox-items" cellspacing\x3d"0" cellpadding\x3d"0"\x3e';if(this.showEmpty&&0==c.length)b[b.length]='\x3ctr\x3e\x3ctd colspan\x3d"20"\x3e'+this.emptyText+"\x3c/td\x3e\x3c/tr\x3e";else{this._doNullItem();for(var k=0,l=c.length;k<l;k++){var n=c[k],p,q=" ",r,t=" ";b[b.length]='\x3ctr id\x3d"';b[b.length]=this._createItemId(k);b[b.length]='" index\x3d"';b[b.length]=k;b[b.length]='" class\x3d"mini-listbox-item ';!1===n.enabled&&(b[b.length]=" mini-disabled ");p=b.length;b[b.length]=q;b[b.length]='" style\x3d"';r=b.length;b[b.length]=t;b[b.length]='"\x3e';d=this._createCheckId(k);this.getItemValue(n);e="";!1===n.enabled&&(e="disabled");this.showCheckBox&&(b[b.length]=!0===n.__NullItem?'\x3ctd class\x3d"mini-listbox-checkbox"\x3e\x3c/td\x3e':'\x3ctd class\x3d"mini-listbox-checkbox"\x3e\x3cinput '+e+' id\x3d"'+d+'" type\x3d"checkbox" \x3e\x3c/td\x3e');if(a)for(d=0,e=this.columns.length;d<e;d++){if(f=this.columns[d],!1!==f.visible){var u=this._OnDrawCell(n,k,f),g=f.width;"number"==typeof g&&(g+="px");b[b.length]='\x3ctd class\x3d"';u.cellCls&&(b[b.length]=u.cellCls);b[b.length]='" style\x3d"';u.cellStyle&&(b[b.length]=u.cellStyle+";");g&&(b[b.length]="width:"+g+";");f.align&&(b[b.length]="text-align:"+f.align+";");b[b.length]='"\x3e';b[b.length]=u.cellHtml;b[b.length]="\x3c/td\x3e";u.rowCls&&(q=u.rowCls);u.rowStyle&&(t=u.rowStyle)}}else u=this._OnDrawCell(n,k,null),b[b.length]='\x3ctd class\x3d"',u.cellCls&&(b[b.length]=u.cellCls),b[b.length]='" style\x3d"',u.cellStyle&&(b[b.length]=u.cellStyle),b[b.length]='"\x3e',b[b.length]=u.cellHtml,b[b.length]="\x3c/td\x3e",u.rowCls&&(q=u.rowCls),u.rowStyle&&(t=u.rowStyle);b[p]=q;b[r]=t;b[b.length]="\x3c/tr\x3e"}}b[b.length]="\x3c/table\x3e";a=b.join("");this._viewEl.firstChild.innerHTML=a;this._doSelects();this.doLayout()}},doLayout:function(a){this.columns&&0<this.columns.length?mini.addClass(this.el,"mini-listbox-showcolumns"):mini.removeClass(this.el,"mini-listbox-showcolumns");this.showCheckBox?mini.removeClass(this.el,"mini-listbox-hideCheckBox"):mini.addClass(this.el,"mini-listbox-hideCheckBox");if(a=document.getElementById(this.uid+"$ck$all"))a.style.display=this.showAllCheckBox?"":"none";var b=this._viewEl;this.isAutoHeight()&&(b.style.height="auto");var c=this.getHeight(!0),d=mini.getWidth(this._borderEl,!0);a=d;mini.isIE6||(b.style.width=d+"px");d=mini.getHeight(this._headerEl);c-=d;0>c&&(c=0);b.style.height=c+"px";isIE&&(b=this._headerEl.firstChild,c=this._viewEl.firstChild.firstChild,this._viewEl.offsetHeight>=this._viewEl.scrollHeight?(c&&(c.style.width="100%"),b&&(b.style.width="100%")):(d=parseInt(c.parentNode.offsetWidth)+"px",b&&(b.style.width=d)));this._viewEl.offsetHeight<this._viewEl.scrollHeight?(b=jQuery(this._viewEl).width()-jQuery(this._contentEl).width(),d=a-b,0>d&&(d=0),this._headerEl.style.width=d+"px"):this._headerEl.style.width="100%"},setShowCheckBox:function(a){this.showCheckBox=a;this.doUpdate()},getShowCheckBox:function(){return this.showCheckBox},setShowAllCheckBox:function(a){this.showAllCheckBox=a;this.doLayout()},getShowAllCheckBox:function(){return this.showAllCheckBox},setShowNullItem:function(a){this.showNullItem!=a&&(this.showNullItem=a,this._doNullItem(),this.doUpdate())},getShowNullItem:function(){return this.showNullItem},setNullItemText:function(a){this.nullItemText!=a&&(this.nullItemText=a,this._doNullItem(),this.doUpdate())},getNullItemText:function(){return this.nullItemText},_doNullItem:function(){for(var a=0,b=this.data.length;a<b;a++){var c=this.data[a];if(c.__NullItem){this.data.removeAt(a);break}}this.showNullItem&&(c={__NullItem:!0},c[this.textField]="",c[this.valueField]="",this.data.insert(0,c))},_OnDrawCell:function(a,b,c){var d=c?mini._getMap(c.field,a):this.getItemText(a);a={sender:this,index:b,rowIndex:b,record:a,item:a,column:c,field:c?c.field:null,value:d,cellHtml:d,rowCls:null,cellCls:c?c.cellCls||"":"",rowStyle:null,cellStyle:c?c.cellStyle||"":""};this.columns&&0<this.columns.length||0!=b||!this.showNullItem||(a.cellHtml=this.nullItemText);1==a.autoEscape&&(a.cellHtml=mini.htmlEncode(a.cellHtml));c&&(c.dateFormat&&(mini.isDate(a.value)?a.cellHtml=mini.formatDate(d,c.dateFormat):a.cellHtml=d),b=c.renderer)&&(fn="function"==typeof b?b:window[b])&&(a.cellHtml=fn.call(c,a));this.fire("drawcell",a);if(null===a.cellHtml||void 0===a.cellHtml||""===a.cellHtml)a.cellHtml="\x26nbsp;";return a},__OnScroll:function(a){this._headerEl.scrollLeft=this._viewEl.scrollLeft},__OnClick:function(a){var b=this.uid+"$ck$all";if(a.target.id==b){if(b=document.getElementById(b)){var b=b.checked,c=this.getValue();this._oldValue=c;b?this.selectAll():this.deselectAll();this._OnSelectionChanged();c!=this.getValue()&&(this._OnValueChanged(),this.fire("itemclick",{htmlEvent:a}))}}else this._fireEvent(a,"Click")},setValue:function(a){mini.ListBox.superclass.setValue.call(this,a);this._doCheckState()},_doCheckState:function(){var a=jQuery(document.getElementById(this.uid+"$ck$all"));this._isSelectedAll()&&0!=this.getSelecteds().length?a.prop?a.prop("checked",!0):a.attr("checked",!0):a.prop?a.prop("checked",!1):a.attr("checked",!1)},_OnValueChanged:function(a){mini.ListBox.superclass._OnValueChanged.call(this);this._doCheckState()},getAttrs:function(a){var b=mini.ListBox.superclass.getAttrs.call(this,a);mini._ParseString(a,b,["nullItemText","ondrawcell"]);mini._ParseBool(a,b,["showCheckBox","showAllCheckBox","showNullItem"]);if("select"!=a.nodeName.toLowerCase()){a=mini.getChildNodes(a);for(var c=0,d=a.length;c<d;c++){var e=a[c],f=jQuery(e).attr("property");f&&(f=f.toLowerCase(),"columns"==f?b.columns=mini._ParseColumns(e):"data"==f&&(b.data=e.innerHTML))}}return b}});mini.regClass(mini.ListBox,"listbox");mini.CheckBoxList=function(){mini.CheckBoxList.superclass.constructor.apply(this,arguments)};mini.extend(mini.CheckBoxList,mini.ListControl,{formField:!0,_labelFieldCls:"mini-labelfield-checkboxlist",multiSelect:!0,repeatItems:0,repeatLayout:"none",repeatDirection:"horizontal",_itemCls:"mini-checkboxlist-item",_itemHoverCls:"mini-checkboxlist-item-hover",_itemSelectedCls:"mini-checkboxlist-item-selected",_tableCls:"mini-checkboxlist-table",_tdCls:"mini-checkboxlist-td",_checkType:"checkbox",uiCls:"mini-checkboxlist",_create:function(){var a=this.el=document.createElement("div");this.el.className=this.uiCls;this.el.innerHTML='\x3ctable cellpadding\x3d"0" border\x3d"0" cellspacing\x3d"0" style\x3d"display:table;"\x3e\x3ctr\x3e\x3ctd\x3e\x3cdiv class\x3d"mini-list-inner"\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-errorIcon"\x3e\x3c/div\x3e\x3cinput type\x3d"hidden" /\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e';this.cellEl=a.getElementsByTagName("td")[0];this._innerEl=this.cellEl.firstChild;this._valueEl=this.cellEl.lastChild;this._errorIconEl=this.cellEl.childNodes[1];this._borderEl=this.el.firstChild;mini.on(this.el,"keyup",function(a){32==a.keyCode&&$(a.target).click()})},_getRepeatTable:function(){var a=[];if(0<this.repeatItems)if("horizontal"==this.repeatDirection){for(var b=[],c=0,d=this.data.length;c<d;c++){var e=this.data[c];b.length==this.repeatItems&&(a.push(b),b=[]);b.push(e)}a.push(b)}else{b=this.repeatItems>this.data.length?this.data.length:this.repeatItems;c=0;for(d=b;c<d;c++)a.push([]);c=0;for(d=this.data.length;c<d;c++)e=this.data[c],a[c%this.repeatItems].push(e)}else a=[this.data.clone()];return a},doUpdate:function(){for(var a=this.data,b="",c=0,d=a.length;c<d;c++){var e=a[c];e._i=c}if("flow"==this.repeatLayout)for(var f=this._getRepeatTable(),c=0,d=f.length;c<d;c++){for(var g=f[c],k=0,l=g.length;k<l;k++)e=g[k],b+=this._createItemHtml(e,e._i);c!=d-1&&(b+="\x3cbr/\x3e")}else if("table"==this.repeatLayout){f=this._getRepeatTable();b+='\x3ctable class\x3d"'+this._tableCls+'" cellpadding\x3d"0" cellspacing\x3d"1"\x3e';c=0;for(d=f.length;c<d;c++){g=f[c];b+="\x3ctr\x3e";k=0;for(l=g.length;k<l;k++)e=g[k],b+='\x3ctd class\x3d"'+this._tdCls+'"\x3e',b+=this._createItemHtml(e,e._i),b+="\x3c/td\x3e";b+="\x3c/tr\x3e"}b+="\x3c/table\x3e"}else for(c=0,d=a.length;c<d;c++)e=a[c],b+=this._createItemHtml(e,c);this._innerEl.innerHTML=b;c=0;for(d=a.length;c<d;c++)e=a[c],delete e._i},_createItemHtml:function(a,b){var c=this._OnDrawItem(a,b),d=this._createItemId(b),e=this._createCheckId(b),f=this.getItemValue(a),g="",d='\x3cdiv id\x3d"'+d+'" index\x3d"'+b+'" class\x3d"'+this._itemCls+" ";!1===a.enabled&&(d+=" mini-disabled ",g="disabled");d+=c.itemCls+'" style\x3d"'+c.itemStyle+'"\x3e\x3cspan tabIndex\x3d"0" class\x3d"mini-list-icon mini-icon"\x3e\x3c/span\x3e\x3cinput style\x3d"display:none;" onmousedown\x3d"this._checked \x3d this.checked;" onclick\x3d"this.checked \x3d this._checked" '+g+' value\x3d"'+f+'" id\x3d"'+e+'" type\x3d"'+this._checkType+'" /\x3e\x3clabel for\x3d"'+e+'" onclick\x3d"return false;"\x3e';return d+=c.itemHtml+"\x3c/label\x3e\x3c/div\x3e"},_OnDrawItem:function(a,b){var c=this.getItemText(a),c={index:b,item:a,itemHtml:c,itemCls:"",itemStyle:""};this.fire("drawitem",c);if(null===c.itemHtml||void 0===c.itemHtml)c.itemHtml="";return c},setRepeatItems:function(a){a=parseInt(a);isNaN(a)&&(a=0);this.repeatItems!=a&&(this.repeatItems=a,this.doUpdate())},getRepeatItems:function(){return this.repeatItems},setRepeatLayout:function(a){"flow"!=a&&"table"!=a&&(a="none");this.repeatLayout!=a&&(this.repeatLayout=a,this.doUpdate())},getRepeatLayout:function(){return this.repeatLayout},setRepeatDirection:function(a){"vertical"!=a&&(a="horizontal");this.repeatDirection!=a&&(this.repeatDirection=a,this.doUpdate())},getRepeatDirection:function(){return this.repeatDirection},getAttrs:function(a){var b=mini.CheckBoxList.superclass.getAttrs.call(this,a),c=jQuery(a);mini._ParseString(a,b,["ondrawitem"]);a=parseInt(c.attr("repeatItems"));isNaN(a)||(b.repeatItems=a);if(a=c.attr("repeatLayout"))b.repeatLayout=a;if(c=c.attr("repeatDirection"))b.repeatDirection=c;return b}});mini.regClass(mini.CheckBoxList,"checkboxlist");mini.RadioButtonList=function(){mini.RadioButtonList.superclass.constructor.apply(this,arguments)};mini.extend(mini.RadioButtonList,mini.CheckBoxList,{multiSelect:!1,_itemCls:"mini-radiobuttonlist-item",_itemHoverCls:"mini-radiobuttonlist-item-hover",_itemSelectedCls:"mini-radiobuttonlist-item-selected",_tableCls:"mini-radiobuttonlist-table",_tdCls:"mini-radiobuttonlist-td",_checkType:"radio",uiCls:"mini-radiobuttonlist"});mini.regClass(mini.RadioButtonList,"radiobuttonlist");mini.Spinner=function(){mini.Spinner.superclass.constructor.apply(this,arguments);this.setValue(this.minValue)};mini.extend(mini.Spinner,mini.ButtonEdit,{value:0,minValue:0,maxValue:100,increment:1,decimalPlaces:-1,changeOnMousewheel:!0,allowLimitValue:!0,allowLoopValue:!1,allowNull:!1,set:function(a){if("string"==typeof a)return this;var b=a.value;delete a.value;mini.Spinner.superclass.set.call(this,a);mini.isNull(b)||this.setValue(b);return this},uiCls:"mini-spinner",_getButtonHtml:function(){return'\x3cspan name\x3d"trigger" class\x3d"mini-buttonedit-button mini-buttonedit-trigger" '+("onmouseover\x3d\"mini.addClass(this, '"+this._buttonHoverCls+"');\" onmouseout\x3d\"mini.removeClass(this, '"+this._buttonHoverCls+"');\"")+'\x3e\x3cspan class\x3d"mini-buttonedit-up"\x3e\x3cspan class\x3d"mini-icon"\x3e\x3c/span\x3e\x3c/span\x3e\x3cspan class\x3d"mini-buttonedit-down"\x3e\x3cspan class\x3d"mini-icon"\x3e\x3c/span\x3e\x3c/span\x3e\x3c/span\x3e'},_initEvents:function(){mini.Spinner.superclass._initEvents.call(this);mini._BindEvents(function(){this.on("buttonmousedown",this.__OnButtonMouseDown,this);mini.on(this.el,"mousewheel",this.__OnMousewheel,this)},this)},_ValueLimit:function(){0==this.allowLimitValue||mini.isNull(this.value)&&this.allowNull||(this.minValue>this.maxValue&&(this.maxValue=this.minValue+100),this.value<this.minValue&&this.setValue(this.minValue),this.value>this.maxValue&&this.setValue(this.maxValue))},getFormValue:function(){var a=this.value,a=parseFloat(a);if(this.allowNull&&isNaN(a))return"";isNaN(a)&&(a=0);var b=String(a).split("."),a=b[0];(b=b[1])||(b="");if(0<this.decimalPlaces){for(var c=b.length,d=this.decimalPlaces;c<d;c++)b+="0";b="."+b}else b&&(b="."+b);return a+b},setValue:function(a){a=mini.parseFloat(a,this.culture,this.format);a=parseFloat(a);isNaN(a)&&!this.allowNull&&(a=this.minValue);isNaN(a)&&this.allowNull&&(a=null);a&&0<=this.decimalPlaces&&(a=parseFloat(a.toFixed(this.decimalPlaces)));this.value!=a&&(this.value=a,this._ValueLimit(),this._valueEl.value=this.value);this.text=this._textEl.value=this.getFormatValue()},setMaxValue:function(a){a=parseFloat(a);isNaN(a)||(a=parseFloat(a),this.maxValue!=a&&(this.maxValue=a,this._ValueLimit()))},getMaxValue:function(a){return this.maxValue},setMinValue:function(a){a=parseFloat(a);isNaN(a)||(a=parseFloat(a),this.minValue!=a&&(this.minValue=a,this._ValueLimit()))},getMinValue:function(a){return this.minValue},setIncrement:function(a){a=parseFloat(a);isNaN(a)||this.increment==a||(this.increment=a)},getIncrement:function(a){return this.increment},setDecimalPlaces:function(a){a=parseInt(a);isNaN(a)||0>a||(this.decimalPlaces=a)},getDecimalPlaces:function(a){return this.decimalPlaces},setChangeOnMousewheel:function(a){this.changeOnMousewheel=a},getChangeOnMousewheel:function(a){return this.changeOnMousewheel},setAllowLimitValue:function(a){this.allowLimitValue=a},getAllowLimitValue:function(a){return this.allowLimitValue},setAllowNull:function(a){this.allowNull=a},getAllowNull:function(a){return this.allowNull},format:"",setFormat:function(a){"string"==typeof a&&this.format!=a&&(this.format=a,this.setText(this.getFormatValue()))},getFormat:function(){return this.format},getFormatValue:function(){return mini.isNull(this.value)?"":this.format&&mini.isNumber(this.value)?mini.formatNumber(this.value,this.format,this.culture):this.value},setAllowLoopValue:function(a){this.allowLoopValue=a},getAllowLoopValue:function(){return this.allowLoopValue},_SpinTimer:null,_StartSpin:function(a,b,c){function d(b){0<a?b>e.maxValue&&e.setValue(e.minValue):b<e.minValue&&e.setValue(e.maxValue)}this._StopSpin();var e=this,f=(1E6*this.value+1E6*a)/1E6;this.setValue(f);e.allowLoopValue&&d(f);var g=c,k=new Date;this._SpinTimer=setInterval(function(){var f=e.value+a;e.setValue(f);e.allowLoopValue&&d(f);e._OnValueChanged();c--;0==c&&50<b&&e._StartSpin(a,b-100,g+3);f=new Date;500<f-k&&e._StopSpin();k=f},b);mini.on(document,"mouseup",this._OnDocumentMouseUp,this)},_StopSpin:function(){clearInterval(this._SpinTimer);this._SpinTimer=null},__OnButtonMouseDown:function(a){this._DownValue=this.getValue();this.__OnInputTextChanged();"up"==a.spinType?this._StartSpin(this.increment,230,2):this._StartSpin(-this.increment,230,2)},__OnInputKeyDown:function(a){mini.Spinner.superclass.__OnInputKeyDown.call(this,a);var b=mini.Keyboard;if(!this.isReadOnly())switch(a.keyCode){case b.Top:this.keyNavEnabled&&(this.setValue(this.value+this.increment),this._OnValueChanged());break;case b.Bottom:this.keyNavEnabled&&(this.setValue(this.value-this.increment),this._OnValueChanged())}},__OnMousewheel:function(a){if(!this.isReadOnly()&&0!=this.changeOnMousewheel){this.text!=this._textEl.value&&this.__OnInputTextChanged();var b=a.wheelDelta||a.originalEvent.wheelDelta;mini.isNull(b)&&(b=24*-a.originalEvent.detail);a=this.increment;0>b&&(a=-a);this.setValue((1E6*this.value+1E6*a)/1E6);this._OnValueChanged();return!1}},_OnDocumentMouseUp:function(a){this._StopSpin();mini.un(document,"mouseup",this._OnDocumentMouseUp,this);this._DownValue!=this.getValue()&&this._OnValueChanged()},__OnInputTextChanged:function(a){a=this.getValue();var b=mini.parseFloat(this._textEl.value,this.culture,this.format);this.setValue(b);a!=this.getValue()&&this._OnValueChanged()},getAttrs:function(a){var b=mini.Spinner.superclass.getAttrs.call(this,a);mini._ParseString(a,b,["minValue","maxValue","increment","decimalPlaces","format"]);mini._ParseBool(a,b,["allowLimitValue","allowNull","changeOnMousewheel","allowLoopValue"]);return b}});mini.regClass(mini.Spinner,"spinner");mini.TimeSpinner=function(){mini.TimeSpinner.superclass.constructor.apply(this,arguments);this.setValue("00:00:00")};mini.extend(mini.TimeSpinner,mini.ButtonEdit,{value:null,format:"H:mm:ss",uiCls:"mini-timespinner",_getButtonHtml:function(){return'\x3cspan class\x3d"mini-buttonedit-button" '+("onmouseover\x3d\"mini.addClass(this, '"+this._buttonHoverCls+"');\" onmouseout\x3d\"mini.removeClass(this, '"+this._buttonHoverCls+"');\"")+'\x3e\x3cspan class\x3d"mini-buttonedit-up"\x3e\x3cspan class\x3d"mini-icon"\x3e\x3c/span\x3e\x3c/span\x3e\x3cspan class\x3d"mini-buttonedit-down"\x3e\x3cspan class\x3d"mini-icon"\x3e\x3c/span\x3e\x3c/span\x3e\x3c/span\x3e'},_initEvents:function(){mini.TimeSpinner.superclass._initEvents.call(this);mini._BindEvents(function(){this.on("buttonmousedown",this.__OnButtonMouseDown,this);mini.on(this.el,"mousewheel",this.__OnMousewheel,this);mini.on(this._textEl,"keydown",this.__OnKeyDown,this)},this)},setFormat:function(a){"string"==typeof a&&this.format!=a&&(this.format=a,this.text=this._textEl.value=this.getFormattedValue())},getFormat:function(){return this.format},setValue:function(a){(a=mini.parseTime(a,this.format))||(a=null);mini.isDate(a)&&(a=new Date(a.getTime()));this.value=a;this.text=this._textEl.value=this.getFormattedValue();this._valueEl.value=this.getFormValue()},getValue:function(){return null==this.value?null:new Date(this.value.getTime())},getFormValue:function(){return this.value?mini.formatDate(this.value,this.format):""},getFormattedValue:function(){return this.value?mini.formatDate(this.value,this.format):""},_ChangeValue:function(a,b){var c=this.getValue();if(c)switch(b){case "hours":var d=c.getHours()+a;23<d&&(d=23);0>d&&(d=0);c.setHours(d);break;case "minutes":d=c.getMinutes()+a;59<d&&(d=59);0>d&&(d=0);c.setMinutes(d);break;case "seconds":d=c.getSeconds()+a,59<d&&(d=59),0>d&&(d=0),c.setSeconds(d)}else c="00:00:00";this.setValue(c)},_SpinTimer:null,_StartSpin:function(a,b,c){this._StopSpin();this._ChangeValue(a,this._timeType);var d=this,e=c,f=new Date;this._SpinTimer=setInterval(function(){d._ChangeValue(a,d._timeType);c--;0==c&&50<b&&d._StartSpin(a,b-100,e+3);var g=new Date;500<g-f&&d._StopSpin();f=g},b);mini.on(document,"mouseup",this._OnDocumentMouseUp,this)},_StopSpin:function(){clearInterval(this._SpinTimer);this._SpinTimer=null},__OnButtonMouseDown:function(a){this._DownValue=this.getFormValue();this._timeType="hours";"up"==a.spinType?this._StartSpin(1,230,2):this._StartSpin(-1,230,2)},_OnDocumentMouseUp:function(a){this._StopSpin();mini.un(document,"mouseup",this._OnDocumentMouseUp,this);this._DownValue!=this.getFormValue()&&this._OnValueChanged()},__OnInputTextChanged:function(a){a=this.getFormValue();this.setValue(this._textEl.value);a!=this.getFormValue()&&this._OnValueChanged()},getAttrs:function(a){var b=mini.TimeSpinner.superclass.getAttrs.call(this,a);mini._ParseString(a,b,["format"]);return b}});mini.regClass(mini.TimeSpinner,"timespinner");mini.Lookup=function(){this.data=[];mini.Lookup.superclass.constructor.apply(this,arguments);mini.on(this._textEl,"mouseup",this.__OnMouseUp,this);this.on("showpopup",this.__OnShowPopup,this)};mini.extend(mini.Lookup,mini.PopupEdit,{allowInput:!0,valueField:"id",textField:"text",delimiter:",",setDelimiter:function(a){this.delimiter=a},getDelimiter:function(){return this.delimiter},multiSelect:!1,data:[],grid:null,_destroyPopup:!1,uiCls:"mini-lookup",destroy:function(a){this.grid&&(this.grid.un("rowclick",this.__OnGridRowClickChanged,this),this.grid.un("load",this.__OnGridLoad,this),this.grid.un("checkall",this.__OnGridRowClickChanged,this),this.grid=null);mini.Lookup.superclass.destroy.call(this,a)},setMultiSelect:function(a){this.multiSelect=a;this.grid&&this.grid.setMultiSelect(a)},setGrid:function(a){"string"==typeof a&&(mini.parse(a),a=mini.get(a));if(this.grid=mini.getAndCreate(a))this.grid.setMultiSelect(this.multiSelect),this.grid.setCheckSelectOnLoad(!1),this.grid.on("rowclick",this.__OnGridRowClickChanged,this),this.grid.on("load",this.__OnGridLoad,this),this.grid.on("checkall",this.__OnGridRowClickChanged,this)},getGrid:function(){return this.grid},setValueField:function(a){this.valueField=a},getValueField:function(){return this.valueField},setTextField:function(a){this.textField=a},getTextField:function(){return this.textField},deselectAll:function(){this.data=[];this.setValue("");this.setText("");this.grid&&this.grid.deselectAll()},getItemValue:function(a){return String(a[this.valueField])},getItemText:function(a){a=a[this.textField];return mini.isNull(a)?"":String(a)},getValueAndText:function(a){mini.isNull(a)&&(a=[]);for(var b=[],c=[],d=0,e=a.length;d<e;d++){var f=a[d];f&&(b.push(this.getItemValue(f)),c.push(this.getItemText(f)))}return[b.join(this.delimiter),c.join(this.delimiter)]},_createData:function(){this.value=mini.isNull(this.value)?"":String(this.value);this.text=mini.isNull(this.text)?"":String(this.text);var a=[],b=this.value.split(this.delimiter),c=this.text.split(this.delimiter),d=b.length;if(this.value)for(var e=0;e<d;e++){var f={},g=b[e],k=c[e];f[this.valueField]=g?g:"";f[this.textField]=k?k:"";a.push(f)}this.data=a},_getValueMaps:function(a){for(var b={},c=0,d=a.length;c<d;c++){var e=a[c];b[e[this.valueField]]=e}return b},setValue:function(a){mini.Lookup.superclass.setValue.call(this,a);this._createData()},setText:function(a){mini.Lookup.superclass.setText.call(this,a);this._createData()},__OnGridRowClickChanged:function(a){var b=this.grid,c=this._getValueMaps(b.getList());a=this._getValueMaps(b.getSelecteds());var d=this._getValueMaps(this.data);0==this.multiSelect&&(d={},this.data=[]);var e={},f;for(f in d){var g=d[f];c[f]&&!a[f]&&(e[f]=g)}for(c=this.data.length-1;0<=c;c--)g=this.data[c],f=g[this.valueField],e[f]&&this.data.removeAt(c);e=[];for(f in a)g=a[f],d[f]||e.push(g);e.sort(function(a,c){var d=b.indexOf(a),e=b.indexOf(c);return d<e?-1:d==e?0:1});this.data.addRange(e);f=this.getValueAndText(this.data);this.setValue(f[0]);this.setText(f[1]);this._OnValueChanged()},__OnGridLoad:function(a){this.__OnShowPopup(a)},__OnShowPopup:function(a){var b=String(this.value).split(this.delimiter);a={};for(var c=0,d=b.length;c<d;c++)a[b[c]]=1;for(var b=this.grid.getData(),e=[],c=0,d=b.length;c<d;c++){var f=b[c];a[f[this.valueField]]&&e.push(f)}this.grid.selects(e)},doUpdate:function(){mini.Lookup.superclass.doUpdate.call(this);this._textEl.readOnly=!0;this.el.style.cursor="default"},__OnInputKeyDown:function(a){mini.Lookup.superclass.__OnInputKeyDown.call(this,a)},__OnMouseUp:function(a){this.isReadOnly()||(a=mini.getSelectRange(this._textEl),this._findTextIndex(a[0]))},_findTextIndex:function(a){var b=-1;if(""==this.text)return b;for(var c=String(this.text).split(this.delimiter),d=0,e=0,f=c.length;e<f;e++){var g=c[e];if(d<a&&a<=d+g.length){b=e;break}d=d+g.length+1}return b},getAttrs:function(a){var b=mini.Lookup.superclass.getAttrs.call(this,a);mini._ParseString(a,b,["grid","valueField","textField","delimiter"]);mini._ParseBool(a,b,["multiSelect"]);return b}});mini.regClass(mini.Lookup,"lookup");mini.TextBoxList=function(a){mini.TextBoxList.superclass.constructor.call(this,null);this.data=[];this.selecteds=[];this.doUpdate();a&&mini.applyTo.call(this,a)};mini.extend(mini.TextBoxList,mini.ValidatorBase,{formField:!0,remote:!0,value:"",text:"",valueField:"id",textField:"text",selecteds:null,data:null,url:"",delay:150,allowInput:!0,editIndex:0,_focusCls:"mini-textboxlist-focus",_itemHoverClass:"mini-textboxlist-item-hover",_itemSelectedClass:"mini-textboxlist-item-selected",_closeHoverClass:"mini-textboxlist-close-hover",textName:"",setTextName:function(a){this.textName=a},getTextName:function(){return this.textName},getData:function(){return this.data},setData:function(a){this.data=a},getRemote:function(){return this.remote},setRemote:function(a){this.remote=a},uiCls:"mini-textboxlist",_create:function(){var a=document.createElement("div");a.innerHTML='\x3ctable class\x3d"mini-textboxlist mini-corner-all" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\x3ctr \x3e\x3ctd class\x3d"mini-textboxlist-border mini-corner-all"\x3e\x3cul\x3e\x3c/ul\x3e\x3ca href\x3d"#"\x3e\x3c/a\x3e\x3cinput type\x3d"hidden"/\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e';this.el=a.firstChild;a=this.el.getElementsByTagName("td")[0];this.ulEl=a.firstChild;this._valueEl=a.lastChild;this.focusEl=a.childNodes[1]},destroy:function(a){this.isShowPopup&&this.hidePopup();this._inputEl&&(mini.clearEvent(this._inputEl),this._inputEl.onkeyup=null,this._inputEl.onfocus=null,this._inputEl.onblur=null);mini.un(document,"mousedown",this.__OnDocMouseDown,this);mini.TextBoxList.superclass.destroy.call(this,a)},_initEvents:function(){mini.TextBoxList.superclass._initEvents.call(this);mini.on(this.el,"mousemove",this.__OnMouseMove,this);mini.on(this.el,"mouseout",this.__OnMouseOut,this);mini.on(this.el,"mousedown",this.__OnMouseDown,this);mini.on(this.el,"click",this.__OnClick,this);mini.on(this.el,"keydown",this.__OnKeyDown,this);mini.on(document,"mousedown",this.__OnDocMouseDown,this)},__OnDocMouseDown:function(a){if(!this.isReadOnly()){this.isShowPopup&&(mini.isAncestor(this.popup.el,a.target)||this.hidePopup());var b=this;this._focused&&0==this.within(a)&&(clearInterval(this._ValueChangeTimer),this.select(null,!1),setTimeout(function(){b.showInput(!1)},100),this.removeCls(this._focusCls),this._focused=!1)}},errorIconEl:null,getErrorIconEl:function(){if(!this._errorIconEl){var a=this.el.rows[0].insertCell(1);a.style.cssText="width:18px;vertical-align:top;";a.innerHTML='\x3cdiv class\x3d"mini-errorIcon"\x3e\x3c/div\x3e';this._errorIconEl=a.firstChild}return this._errorIconEl},_RemoveErrorIcon:function(){this._errorIconEl&&jQuery(this._errorIconEl.parentNode).remove();this._errorIconEl=null},doLayout:function(){0!=this.canLayout()&&(mini.TextBoxList.superclass.doLayout.call(this),this.doReadOnly())},doReadOnly:function(){this.isReadOnly()||0==this.allowInput?this._inputEl.readOnly=!0:this._inputEl.readOnly=!1},doUpdate:function(){this._ValueChangeTimer&&clearInterval(this._ValueChangeTimer);this._inputEl&&mini.un(this._inputEl,"keydown",this.__OnInputKeyDown,this);for(var a=[],b=this.uid,c=0,d=this.selecteds.length;c<d;c++){var e=b+"$text$"+c,f=mini._getMap(this.textField,this.selecteds[c]);mini.isNull(f)&&(f="");a[a.length]='\x3cli id\x3d"'+e+'" class\x3d"mini-textboxlist-item"\x3e';a[a.length]=f;a[a.length]='\x3cspan class\x3d"mini-textboxlist-close"\x3e\x3c/span\x3e\x3c/li\x3e'}a[a.length]='\x3cli id\x3d"'+(b+"$input")+'" class\x3d"mini-textboxlist-inputLi"\x3e\x3cinput class\x3d"mini-textboxlist-input" type\x3d"text" autocomplete\x3d"off"\x3e\x3c/li\x3e';this.ulEl.innerHTML=a.join("");this.editIndex=this.selecteds.length;0>this.editIndex&&(this.editIndex=0);this.inputLi=this.ulEl.lastChild;this._inputEl=this.inputLi.firstChild;this._inputEl.placeholder=this.placeholder;mini.on(this._inputEl,"keydown",this.__OnInputKeyDown,this);var g=this;this._inputEl.onkeyup=function(){g._syncInputSize()};g._ValueChangeTimer=null;g._LastInputText=g._inputEl.value;this._inputEl.onfocus=function(){g._LastInputText=g._inputEl.value;g._ValueChangeTimer=setInterval(function(){g._focused?g._LastInputText!=g._inputEl.value&&(g._startQuery(),g._LastInputText=g._inputEl.value):(clearInterval(g._ValueChangeTimer),g._ValueChangeTimer=null)},10);g.addCls(g._focusCls);g._focused=!0;g.fire("focus")};this._inputEl.onblur=function(){clearInterval(g._ValueChangeTimer);g._ValueChangeTimer=null;g.fire("blur");g.validateOnLeave&&g.isEditable()&&g._tryValidate()};this.doReadOnly()},getItemByEvent:function(a){if(a=mini.findParent(a.target,"mini-textboxlist-item"))return a=a.id.split("$"),this.selecteds[a[a.length-1]]},getItem:function(a){if("number"==typeof a)return this.selecteds[a];if("object"==typeof a)return a},getItemEl:function(a){a=this.selecteds.indexOf(a);return document.getElementById(this.uid+"$text$"+a)},hoverItem:function(a,b){if(!this.isReadOnly()&&0!=this.enabled){this.blurItem();var c=this.getItemEl(a);mini.addClass(c,this._itemHoverClass);b&&mini.hasClass(b.target,"mini-textboxlist-close")&&mini.addClass(b.target,this._closeHoverClass)}},blurItem:function(){for(var a=0,b=this.selecteds.length;a<b;a++){var c=this.getItemEl(this.selecteds[a]);c&&(mini.removeClass(c,this._itemHoverClass),mini.removeClass(c.lastChild,this._closeHoverClass))}},showInput:function(a){this.select(null);mini.isNumber(a)?this.editIndex=a:this.editIndex=this.selecteds.length;0>this.editIndex&&(this.editIndex=0);this.editIndex>this.selecteds.length&&(this.editIndex=this.selecteds.length);var b=this.inputLi;b.style.display="block";if(mini.isNumber(a)&&a<this.selecteds.length){var c=this.getItemEl(this.selecteds[a]);jQuery(c).before(b)}else this.ulEl.appendChild(b);!1!==a?setTimeout(function(){try{b.firstChild.focus(),mini.selectRange(b.firstChild,100)}catch(d){}},10):(this.lastInputText="",this._inputEl.value="");return b},select:function(a){a=this.getItem(a);if(this._selected){var b=this.getItemEl(this._selected);mini.removeClass(b,this._itemSelectedClass)}if(this._selected=a)b=this.getItemEl(this._selected),mini.addClass(b,this._itemSelectedClass);if(this._selected){this.focusEl.focus();var c=this;setTimeout(function(){try{c.focusEl.focus()}catch(d){}},50)}this._selected&&(this.addCls(this._focusCls),this._focused=!0)},_doInsertInputValue:function(){var a=this.getInputText(),b={};b[this.textField]=a;b[this.valueField]=a;this.insertItem(this.editIndex,b)},_doInsertSelectValue:function(){if(0!=this._listbox.getData().length){var a=this._listbox.getSelected(),b=this.editIndex;a&&(a=mini.clone(a),this.insertItem(b,a))}},insertItem:function(a,b){this.selecteds.insert(a,b);var c=this.getText(),d=this.getValue();this.setValue(d,!1);this.setText(c,!1);this._createSelecteds();this.doUpdate();this.showInput(a+1);this._OnValueChanged()},removeItem:function(a){if(a){var b=this.getItemEl(a);mini.removeNode(b);this.selecteds.remove(a);a=this.getText();b=this.getValue();this.setValue(b,!1);this.setText(a,!1);this._OnValueChanged()}},_createSelecteds:function(){var a=(this.text?this.text:"").split(","),b=(this.value?this.value:"").split(",");""==b[0]&&(b=[]);var c=b.length;this.selecteds.length=c;for(var d=0;d<c;d++){var e=this.selecteds[d];e||(e={},this.selecteds[d]=e);var f=mini.isNull(a[d])?"":a[d],g=mini.isNull(b[d])?"":b[d];mini._setMap(this.textField,f,e);mini._setMap(this.valueField,g,e)}this.value=this.getValue();this.text=this.getText()},getInputText:function(){return this._inputEl?this._inputEl.value:""},getText:function(){for(var a=[],b=0,c=this.selecteds.length;b<c;b++){var d=mini._getMap(this.textField,this.selecteds[b]);mini.isNull(d)&&(d="");d=d.replace(",","\uff0c");a.push(d)}return a.join(",")},getValue:function(){for(var a=[],b=0,c=this.selecteds.length;b<c;b++){var d=mini._getMap(this.valueField,this.selecteds[b]);a.push(d)}return a.join(",")},getFormValue:function(){var a=this.value;if(null===a||void 0===a)a="";return String(a)},setName:function(a){this.name!=a&&(this.name=a,this._valueEl.name=a)},setValue:function(a){mini.isNull(a)&&(a="");this.value!=a&&(this.value=a,this._valueEl.value=a,this._createSelecteds(),this.doUpdate())},setText:function(a){mini.isNull(a)&&(a="");this.text!==a&&(this.text=a,this._createSelecteds(),this.doUpdate())},setValueField:function(a){this.valueField=a;this._createSelecteds()},getValueField:function(){return this.valueField},setTextField:function(a){this.textField=a;this._createSelecteds()},getTextField:function(){return this.textField},setAllowInput:function(a){this.allowInput=a;this.doLayout()},getAllowInput:function(){return this.allowInput},setUrl:function(a){this.url=a},getUrl:function(){return this.url},setPopupHeight:function(a){this.popupHeight=a},getPopupHeight:function(){return this.popupHeight},setPopupMinHeight:function(a){this.popupMinHeight=a},getPopupMinHeight:function(){return this.popupMinHeight},setPopupMaxHeight:function(a){this.popupMaxHeight=a},getPopupMaxHeight:function(){return this.popupMaxHeight},valueFromSelect:!0,setValueFromSelect:function(a){this.valueFromSelect=a},getValueFromSelect:function(){return this.valueFromSelect},doQuery:function(){this._startQuery(!0)},_syncInputSize:function(){if(0!=this.isDisplay()){var a=this.getInputText(),a=mini.measureText(this._inputEl,a),a=20<a.width?a.width+4:20,b=mini.getWidth(this.el,!0);a>b-15&&(a=b-15);this._inputEl.style.width=a+"px"}},inputMode:!1,setIputMode:function(a){this.inputMode=a},getIputMode:function(){return this.inputMode},_startQuery:function(a){var b=this;this.inputMode||(setTimeout(function(){b._syncInputSize()},1),this.showPopup("loading"),this._stopQuery(),this._loading=!0,this.delayTimer=setTimeout(function(){b._doQuery()},this.delay))},ajaxDataType:"text",ajaxContentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",_getSelectedMap:function(){for(var a={},b=0,c=this.selecteds.length;b<c;b++){var d=this.selecteds[b];a[d[this.valueField]]=d[this.textField]}return a},_getFilterLocalData:function(a){var b=[],c=this._getSelectedMap();a=(a||"").toLowerCase();for(var d=0,e=this.data.length;d<e;d++){var f=this.data[d];if(!c[f[this.valueField]]){var g=f[this.textField];a&&-1==String(g).toLowerCase().indexOf(a)||b.push(f)}}return b},_doQuery:function(){if(0!=this.isDisplay()){var a=this.getInputText(),b=this;if(b.remote){this._listbox.getData();var c={value:this.getValue(),text:this.getText()};c[this.searchField]=a;var a=this.url,d="function"==typeof a?a:window[a];"function"==typeof d&&(a=d(this));if(a){d="post";!a||-1==a.indexOf(".txt")&&-1==a.indexOf(".json")||(d="get");var e={url:a,async:!0,params:c,data:c,type:this.ajaxType?this.ajaxType:d,cache:!1,cancel:!1};jQuery.extend(!0,e,this.ajaxOptions);this.fire("beforeload",e);if(!e.cancel){var f=this;mini.copyTo(e,{success:function(a,c,d){delete e.params;c={text:a,result:null,sender:f,options:e,xhr:d};d=null;try{mini_doload(c),(d=c.result)||(d=mini.decode(a))}catch(n){if(1==mini_debugger)throw Error("textboxlist json is error");}mini.isArray(d)&&(d={data:d});f.dataField&&(d.data=mini._getMap(f.dataField,d));d.data||(d.data=[]);b._listbox.setData(d.data);b.showPopup();b._listbox._focusItem(0,!0);b.fire("load",{data:d.data,result:d});b._loading=!1;b._selectOnLoad&&(b.__doSelectValue(),b._selectOnLoad=null)},error:function(a,c,d){b.showPopup("error")}});b._ajaxer=mini.ajax(e)}}}else c=this._getFilterLocalData(a),b._listbox.setData(c),b.showPopup(),b._listbox._focusItem(0,!0),b._loading=!1}},_stopQuery:function(){this.delayTimer&&(clearTimeout(this.delayTimer),this.delayTimer=null);this._ajaxer&&this._ajaxer.abort();this._loading=!1},within:function(a){return mini.isAncestor(this.el,a.target)||this.showPopup&&this.popup&&this.popup.within(a)?!0:!1},placeholder:"",setPlaceholder:function(a){this.placeholder=a},getPlaceholder:function(a){return this.placeholder},emptyText:"No Result",setEmptyText:function(a){this.popupEmptyText="\x3cspan class\x3d'mini-textboxlist-popup-noresult'\x3e"+a+"\x3c/span\x3e";this.emptyText=a},getEmptyText:function(a){return this.emptyText},loadingText:"Loading...",setLoadingText:function(a){this.popupLoadingText="\x3cspan class\x3d'mini-textboxlist-popup-noresult'\x3e"+a+"\x3c/span\x3e";this.loadingText=a},getLoadingText:function(a){return this.loadingText},errorText:"Error",setErrorText:function(a){this.popupEmptyText="\x3cspan class\x3d'mini-textboxlist-popup-noresult'\x3e"+a+"\x3c/span\x3e";this.errorText=a},getErrorText:function(a){return this.errorText},popupLoadingText:"\x3cspan class\x3d'mini-textboxlist-popup-loading'\x3eLoading...\x3c/span\x3e",popupErrorText:"\x3cspan class\x3d'mini-textboxlist-popup-error'\x3eError\x3c/span\x3e",popupEmptyText:"\x3cspan class\x3d'mini-textboxlist-popup-noresult'\x3eNo Result\x3c/span\x3e",isShowPopup:!1,popupHeight:"",popupMinHeight:30,popupMaxHeight:150,_createPopup:function(){this.popup||(this.popup=new mini.ListBox,this.popup.addCls("mini-textboxlist-popup"),this.popup.setStyle("position:absolute;left:0;top:0;"),this.popup.showEmpty=!0,this.popup.setValueField(this.valueField),this.popup.setTextField(this.textField),this.popup.render(document.body),this.popup.on("itemclick",function(a){this.hidePopup();this._doInsertSelectValue()},this));return this._listbox=this.popup},showPopup:function(a){if(0!=this.isDisplay()){this.isShowPopup=!0;var b=this._createPopup();b.el.style.zIndex=mini.getMaxZIndex();var c=this._listbox;c.emptyText=this.popupEmptyText;"loading"==a?(c.emptyText=this.popupLoadingText,this._listbox.setData([])):"error"==a&&(c.emptyText=this.popupLoadingText,this._listbox.setData([]));this._listbox.doUpdate();a=this.getBox();var c=a.x,d=a.y+a.height;this.popup.el.style.display="block";mini.setXY(b.el,-1E3,-1E3);this.popup.setWidth(a.width);this.popup.setHeight(this.popupHeight);this.popup.getHeight()<this.popupMinHeight&&this.popup.setHeight(this.popupMinHeight);this.popup.getHeight()>this.popupMaxHeight&&this.popup.setHeight(this.popupMaxHeight);mini.setXY(b.el,c,d)}},hidePopup:function(){this.isShowPopup=!1;this.popup&&(this.popup.el.style.display="none")},__OnMouseMove:function(a){if(0!=this.enabled){var b=this.getItemByEvent(a);b?this.hoverItem(b,a):this.blurItem()}},__OnMouseOut:function(a){this.blurItem()},__OnClick:function(a){if(!this.isReadOnly()&&0!=this.enabled&&0!=this.enabled){var b=this.getItemByEvent(a);b?(this.focusEl.focus(),this.select(b),a&&mini.hasClass(a.target,"mini-textboxlist-close")&&(this.removeItem(b),this.fire("removeitem",{item:b}))):mini.findParent(a.target,"mini-textboxlist-input")||this.showInput()}},__OnKeyDown:function(a){function b(){var a=d.selecteds[c];d.removeItem(a);(a=d.selecteds[c])||(a=d.selecteds[c-1]);d.select(a);a||d.showInput()}if(this.isReadOnly()||0==this.allowInput)return!1;var c=this.selecteds.indexOf(this._selected),d=this;switch(a.keyCode){case 8:a.preventDefault();b();break;case 37:case 38:this.select(null);this.showInput(c);break;case 39:case 40:c+=1;this.select(null);this.showInput(c);break;case 46:b()}},__doSelectValue:function(){var a=this._listbox.getFocusedItem();a?(this._listbox.setSelected(a),this.lastInputText=this.text,this.hidePopup(),this._doInsertSelectValue()):this.valueFromSelect||this.getInputText().trim()&&this._doInsertInputValue()},__OnInputKeyDown:function(a){this._selectOnLoad=null;if(this.isReadOnly()||0==this.allowInput)return!1;if(13!=a.keyCode||this.isShowPopup)if(a.stopPropagation(),!this.isReadOnly()&&0!=this.allowInput){var b=mini.getSelectRange(this._inputEl),c=b[0],d=b[1],e=this._inputEl.value.length,b=c==d&&0==c,c=c==d&&d==e;(this.isReadOnly()||0==this.allowInput)&&a.preventDefault();if(9==a.keyCode)this.hidePopup();else if(16!=a.keyCode&&17!=a.keyCode&&18!=a.keyCode)switch(a.keyCode){case 13:if(this.inputMode){this.getInputText().trim()&&this._doInsertInputValue();break}this.isShowPopup&&(a.preventDefault(),this._loading?this._selectOnLoad=!0:(a=this._listbox.getFocusedItem())&&!1===a.enabled||this.__doSelectValue());break;case 27:a.preventDefault();this.hidePopup();break;case 8:b&&a.preventDefault();case 37:b&&(this.isShowPopup?this.hidePopup():0<this.editIndex&&(c=this.editIndex-1,0>c&&(c=0),c>=this.selecteds.length&&(c=this.selecteds.length-1),this.showInput(!1),this.select(c)));break;case 39:c&&(this.isShowPopup?this.hidePopup():this.editIndex<=this.selecteds.length-1&&(c=this.editIndex,this.showInput(!1),this.select(c)));break;case 38:a.preventDefault();this.isShowPopup&&(c=-1,(a=this._listbox.getFocusedItem())&&(c=this._listbox.indexOf(a)),c--,0>c&&(c=0),this._listbox._focusItem(c,!0));break;case 40:a.preventDefault(),this.isShowPopup?(c=-1,(a=this._listbox.getFocusedItem())&&(c=this._listbox.indexOf(a)),c++,0>c&&(c=0),c>=this._listbox.getCount()&&(c=this._listbox.getCount()-1),this._listbox._focusItem(c,!0)):this._startQuery(!0)}}},focus:function(){try{this._inputEl.focus()}catch(a){}},blur:function(){try{this._inputEl.blur()}catch(a){}},searchField:"key",setSearchField:function(a){this.searchField=a},getSearchField:function(){return this.searchField},getAttrs:function(a){var b=mini.TextBox.superclass.getAttrs.call(this,a);jQuery(a);mini._ParseString(a,b,"value text valueField textField url popupHeight textName onfocus onbeforeload onload searchField emptyText loadingText errorText onblur onremoveitem placeholder".split(" "));mini._ParseBool(a,b,["allowInput","valueFromSelect","remote","inputMode"]);mini._ParseInt(a,b,["popupMinHeight","popupMaxHeight"]);return b}});mini.regClass(mini.TextBoxList,"textboxlist");mini.AutoComplete=function(){mini.AutoComplete.superclass.constructor.apply(this,arguments);var a=this;a._ValueChangeTimer=null;this._textEl.onfocus=function(){a._LastInputText=a._textEl.value;a._ValueChangeTimer=setInterval(function(){a._LastInputText!=a._textEl.value&&(a._tryQuery(),a._LastInputText=a._textEl.value,""==a._textEl.value&&""!=a.value&&(a.setValue(""),a._OnValueChanged()))},10)};this._textEl.onblur=function(){clearInterval(a._ValueChangeTimer);a.isShowPopup()||a._LastInputText==a._textEl.value||""!=a._textEl.value||""==a.value||(a.setValue(""),a._OnValueChanged())};this._buttonEl.style.display="none";this._doInputLayout()};mini.extend(mini.AutoComplete,mini.ComboBox,{remote:!0,url:"",allowInput:!0,delay:150,showButton:!1,searchField:"key",minChars:0,_buttonWidth:0,uiCls:"mini-autocomplete",_initInput:function(){var a=this;isFirefox&&(this._textEl.oninput=function(){a.enterQuery||a._tryQuery()})},getRemote:function(){return this.remote},setRemote:function(a){this.remote=a},setUrl:function(a){this.url=a;this.remote||mini.AutoComplete.superclass.setUrl.call(this,a)},setValue:function(a){mini.isNull(a)&&(a="");this.value!=a&&(this.value=a,this._valueEl.value=this.value);this.__oldText=""},setText:function(a){mini.isNull(a)&&(a="");this.text!=a&&(this._LastInputText=this.text=a);this._textEl.value=this.text},setMinChars:function(a){this.minChars=a},getMinChars:function(){return this.minChars},setSearchField:function(a){this.searchField=a},getSearchField:function(){return this.searchField},popupEmptyText:"No Result",setPopupEmptyText:function(a){this.popupEmptyText=a},getPopupEmptyText:function(a){return this.popupEmptyText},loadingText:"Loading...",setLoadingText:function(a){this.loadingText=a},getLoadingText:function(a){return this.loadingText},errorText:"Error",setErrorText:function(a){this.errorText=a},getErrorText:function(a){return this.errorText},getPopupEmptyHtml:function(){return"\x3cspan class\x3d'mini-textboxlist-popup-noresult'\x3e"+this.popupEmptyText+"\x3c/span\x3e"},getPopupLoadingHtml:function(){return"\x3cspan class\x3d'mini-textboxlist-popup-loading'\x3e"+this.loadingText+"\x3c/span\x3e"},getPopupErrorHtml:function(){return"\x3cspan class\x3d'mini-textboxlist-popup-error'\x3e"+this.errorText+"\x3c/span\x3e"},showPopup:function(a){this.getPopup();var b=this._listbox;b.showEmpty=!0;b.emptyText=this.getPopupEmptyHtml();"loading"==a?(b.emptyText=this.getPopupLoadingHtml(),this._listbox.setData([])):"error"==a&&(b.emptyText=this.getPopupErrorHtml(),this._listbox.setData([]));this._listbox.doUpdate();mini.AutoComplete.superclass.showPopup.call(this)},__OnInputKeyDown:function(a){var b={htmlEvent:a};this.fire("keydown",b);if(8==a.keyCode&&(this.isReadOnly()||0==this.allowInput))return!1;if(9==a.keyCode)this.hidePopup();else if(16!=a.keyCode&&17!=a.keyCode&&18!=a.keyCode&&!this.isReadOnly())switch(a.keyCode){case 27:this.isShowPopup()&&a.stopPropagation();this.hidePopup();break;case 13:var c=!0;if((!this.isShowPopup()||0==this._listbox.getData().length)&&this.enterQuery){var c=!1,d=this._textEl.value;this._enterSearchText==d&&this.loading||(this._enterSearchText=d,this._tryQuery(d))}this.isShowPopup()?(a.preventDefault(),a.stopPropagation(),!0!==this._requestSearch&&(a=this._listbox.getFocusedIndex(),-1!=a&&(b=this._listbox.getAt(a),a=this._listbox.getValueAndText([b]),b=a[0],this.setText(a[1]),this.setValue(b),this._OnValueChanged()))):this.fire("enter",b);c&&(this.hidePopup(),this.focus());break;case 37:break;case 38:a=this._listbox.getFocusedIndex();-1==a&&(a=0,this.multiSelect||(b=this._listbox.findItems(this.value)[0])&&(a=this._listbox.indexOf(b)));this.isShowPopup()&&!this.multiSelect&&(--a,0>a&&(a=0),this._listbox._focusItem(a,!0));break;case 39:break;case 40:a=this._listbox.getFocusedIndex();this.isShowPopup()?this.multiSelect||(a+=1,a>this._listbox.getCount()-1&&(a=this._listbox.getCount()-1),this._listbox._focusItem(a,!0)):this._tryQuery(this._textEl.value);break;default:1==this.enterQuery?(this.hidePopup(),this.focus()):this._keydownQuery()}},delay:200,_keydownQuery:function(){var a=this;a._requestSearch=!0;a.remote||(a._requestSearch=!1);a._keydownTimer&&(clearTimeout(a._keydownTimer),a._keydownTimer=null);a._keydownTimer=setTimeout(function(){var b=a._textEl.value;b!=a.__oldText&&(a._tryQuery(b),a.__oldText=b)},a.delay)},enterQuery:!1,doQuery:function(){this._tryQuery()},_tryQuery:function(a){var b=this;this._queryTimer&&(clearTimeout(this._queryTimer),this._queryTimer=null);this._queryTimer=setTimeout(function(){b._doQuery(b._textEl.value)},this.delay);!1!==b._tryHide()&&this.showPopup("loading")},_tryHide:function(){if(mini.getActiveElement()!=this._textEl&&mini.hasClass(this.el,"mini-buttonedit-focus"))return this.hidePopup(),!1},blur:function(){mini.AutoComplete.superclass.blur.apply(this);this._ajaxer&&(this._ajaxer.abort(),this._ajaxer=null);this._doloadTimer&&(clearTimeout(this._doloadTimer),this._doloadTimer=null);this._queryTimer&&(clearTimeout(this._queryTimer),this._queryTimer=null);this._keydownTimer&&(clearTimeout(this._keydownTimer),this._keydownTimer=null);this.isShowPopup()&&this.hidePopup()},_doQuery:function(a){function b(a,b){c._focused&&!1!==c._tryHide()&&(c._doloadTimer&&(clearTimeout(c._doloadTimer),c._doloadTimer=null),c._doloadTimer=setTimeout(function(){c._doloadTimer=null;c._tryHide()},100),c._listbox.setData(a),c.showPopup(),c._listbox._focusItem(0,!0),c.data=a,c.fire("load",{data:a,result:b}))}var c=this;if(mini.getActiveElement()!=c._textEl)c.hidePopup();else if(this.remote){this._ajaxer&&this._ajaxer.abort();var d=this.url,e="post";!d||-1==d.indexOf(".txt")&&-1==d.indexOf(".json")||(e="get");var f={};f[this.searchField]=a;var g={url:d,async:!0,params:f,data:f,type:this.ajaxType?this.ajaxType:e,cache:!1,cancel:!1};jQuery.extend(!0,g,this.ajaxOptions);this.fire("beforeload",g);c=this;g.cancel?(d=g.result||[],b(d,d)):(c.loading=!0,mini.copyTo(g,{success:function(a,d,e){delete g.params;d={text:a,result:null,sender:c,options:g,xhr:e};e=null;try{mini_doload(d),(e=d.result)||(e=mini.decode(a))}catch(p){if(1==mini_debugger)throw Error("autocomplete json is error");}mini.isArray(e)&&(e={data:e});c.dataField&&(e.data=mini._getMap(c.dataField,e));e.data||(e.data=[]);b(e.data,e)},error:function(a,b,c){},complete:function(){c.loading=!1;c._requestSearch=!1;c._ajaxer=null}}),this._ajaxer=mini.ajax(g))}else mini.AutoComplete.superclass._doQuery.apply(this,arguments)},setEnterQuery:function(a){this.enterQuery=a},getEnterQuery:function(){return this.enterQuery},getAttrs:function(a){var b=mini.AutoComplete.superclass.getAttrs.call(this,a);mini._ParseString(a,b,["searchField","popupEmptyText","loadingText","errorText"]);mini._ParseBool(a,b,["enterQuery","remote"]);return b}});mini.regClass(mini.AutoComplete,"autocomplete");mini.ToolTip=function(){mini.ToolTip.superclass.constructor.apply(this,arguments)};mini.extend(mini.ToolTip,mini.Control,{selector:"[title]",placement:"bottom",trigger:"hover focus",delay:200,uiCls:"mini-tooltip",_create:function(){this.el=jQuery('\x3cdiv class\x3d"mini-tooltip"\x3e\x3cdiv class\x3d"mini-tooltip-arrow"\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-tooltip-inner mini-corner-all"\x3e\x3c/div\x3e\x3c/div\x3e')[0];this.$element=jQuery(this.el);this.$element.appendTo(document.body)},_initEvents:function(){},_bindTooltip:function(){var a=jQuery(document),b=this.selector;a.unbind(".tooltip",this);for(var c=this.trigger.split(" "),d=c.length;d--;){var e=c[d];if("click"==e)a.on("click.tooltip",b,jQuery.proxy(this._toggle,this));else if("manual"!=e){var f="hover"==e?"mouseleave":"blur";a.on(("hover"==e?"mouseenter":"focus")+".tooltip",b,jQuery.proxy(this._enter,this));a.on(f+".tooltip",b,jQuery.proxy(this._leave,this))}}},setSelector:function(a){this.selector=a;this._bindTooltip()},getSelector:function(){return this.selector},setPlacement:function(a){this.placement=a},getPlacement:function(){return this.placement},setTrigger:function(a){this.trigger=a;this._bindTooltip()},getTrigger:function(){return this.trigger},openTimer:null,_enter:function(a){var b=this,c=a.currentTarget;this.getContent(c);clearTimeout(this.openTimer);this.openTimer=setTimeout(function(){b.openTimer=null;b.open(c)},b.delay)},_leave:function(a){clearTimeout(this.openTimer);this.close()},_toggle:function(a){"none"==this._getTip().css("display")?this.enter(a):this.leave(a)},open:function(a){a=jQuery(a)[0]||this.target;jQuery(a);var b=this.getContent(a),b={element:a,content:b,cancel:!b};this.fire("beforeopen",b);if(!b.cancel){this.$element.show();this._target=a;try{this.setContent(b.content)}catch(c){}this.fire("open",{element:a})}},close:function(){this._target=null;this.$element.hide()},showLoading:function(){this.setContent('\x3cdiv class\x3d"mini-tooltip-loading"\x3e\x3c/div\x3e')},setContent:function(a){this.$element.children(".mini-tooltip-inner").html(a||"\x26nbsp;");this.applyPlacement()},getContent:function(a){var b=a.title;b&&jQuery(a).attr("data-tooltip",b).attr("title","");b||(b=jQuery(a).attr("data-tooltip"));return b},applyPlacement:function(){function a(a){d.removeClass("mini-tooltip-left mini-tooltip-top mini-tooltip-right mini-tooltip-bottom mini-tooltip-bottomleft mini-tooltip-topleft mini-tooltip-bottomright mini-tooltip-topright").addClass("mini-tooltip-"+a)}if(this._target&&"none"!=this.$element.css("display")){var b=this._target,c=jQuery(b).attr("data-placement")||this.placement,d=this.$element;if(b&&d[0]){d.show().css({left:"-2000px",top:"-2000px"});var e=mini.getBox(b),b=mini.getViewportBox(),f=e.top-b.top,g=b.bottom-e.bottom;a(c);var k=mini.getBox(d[0]),l=mini.getCalculatedOffset(c,e,k.width,k.height);"left"!=c&&"right"!=c&&"top"!=c&&"bottom"!=c&&"bottomleft"==c&&f>g&&l.top+k.height>b.bottom&&(c="topleft");a(c);l=mini.getCalculatedOffset(c,e,k.width,k.height);if("right"==c||"left"==c){var c=function(){var a=e.top+e.height/2-n.height()/2-l.top;n.css("top",a)},n=jQuery(d).children(".mini-tooltip-arrow");n.css("top","");b=mini.getViewportBox();l.top<b.y?(l.top=b.y,c()):l.top+k.height>b.bottom&&(l.top=b.bottom-k.height,c())}d.offset(l)}}},getAttrs:function(a){var b=mini.ToolTip.superclass.getAttrs.call(this,a);mini._ParseString(a,b,["selector","placement","onbeforeopen","onopen","onclose"]);return b}});mini.regClass(mini.ToolTip,"tooltip");mini.getCalculatedOffset=function(a,b,c,d){return"bottom"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:"top"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:"left"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:"bottomleft"==a?{top:b.top+b.height,left:b.left}:"bottomright"==a?{top:b.top+b.height,left:b.left+b.width-c}:"topleft"==a?{top:b.top-d,left:b.left}:"topright"==a?{top:b.top-d,left:b.left+b.width-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}};mini.ProgressBar=function(){mini.ProgressBar.superclass.constructor.apply(this,arguments)};mini.extend(mini.ProgressBar,mini.Control,{formField:!0,uiCls:"mini-progressbar",showText:!1,textAlign:"center",text:"",format:"{0}%",value:0,set:function(a){if("string"==typeof a)return this;var b=a.value;delete a.value;mini.ProgressBar.superclass.set.call(this,a);mini.isNull(b)||this.setValue(b);return this},_create:function(){this.el=document.createElement("div");this.el.className="mini-progressbar";this.el.innerHTML='\x3cdiv class\x3d"mini-progressbar-border"\x3e\x3cdiv class\x3d"mini-progressbar-bar"\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-progressbar-text"\x3e\x3c/div\x3e\x3c/div\x3e';this._borderEl=this.el.firstChild;this._barEl=this._borderEl.firstChild;this._textEl=this._borderEl.lastChild},setText:function(a){this.text=a;this._textEl.innerHTML=a},setShowText:function(a){this.showText=a;this._textEl.style.display=a?"":"none"},getShowText:function(){return this.showText},setTextAlign:function(a){this.textAlign=a;this._textEl.style.textAlign=a},getTextAlign:function(){return this.textAlign},setValue:function(a){a=parseFloat(a);isNaN(a)&&(a=0);0>a&&(a=0);100<a&&(a=100);this.value=a;this._barEl.style.width=a+"%";a=String.format(this.format,a);this.setText(a)},getValue:function(){return this.value},getAttrs:function(a){var b=mini.ProgressBar.superclass.getAttrs.call(this,a);mini._ParseString(a,b,["text","format","textAlign"]);mini._ParseBool(a,b,["showText"]);return b}});mini.regClass(mini.ProgressBar,"progressbar");mini.Form=function(a){this.el=mini.byId(a);if(!this.el)throw Error("form element not null");mini.Form.superclass.constructor.apply(this,arguments)};mini.extend(mini.Form,mini.Component,{el:null,getFields:function(){return this.el?mini.findControls(function(a){return a.el&&1==a.formField?mini.isAncestor(this.el,a.el)?!0:!1:!1},this):[]},getFieldsMap:function(){for(var a=this.getFields(),b={},c=0,d=a.length;c<d;c++){var e=a[c];e.name&&(b[e.name]=e)}return b},getField:function(a){return this.el?mini.getbyName(a,this.el):null},getData:function(a,b){mini.isNull(b)&&(b=!0);for(var c=a?"getFormValue":"getValue",d=this.getFields(),e={},f=0,g=d.length;f<g;f++){var k=d[f],l=k[c];l&&(k.name&&(1==b?mini._setMap(k.name,l.call(k),e):e[k.name]=l.call(k)),k.textName&&k.getText&&(1==b?mini._setMap(k.textName,k.getText(),e):e[k.textName]=k.getText()))}return e},setData:function(a,b,c){mini.isNull(c)&&(c=!0);"object"!=typeof a&&(a={});var d=this.getFieldsMap(),e;for(e in d){var f=d[e];if(f){if(f.setValue){var g=a[e];1==c&&(g=mini._getMap(e,a));if(void 0===g&&!1===b)continue;null===g&&(g="");f.setValue(g)}f.setText&&f.textName&&(g=a[f.textName],1==c&&(g=mini._getMap(f.textName,a)),mini.isNull(g)&&(g=""),f.setText(g))}}},reset:function(){for(var a=this.getFields(),b=0,c=a.length;b<c;b++){var d=a[b];if(d.setValue){if(d.setText&&!1!==d._clearText){var e=d.defaultText;mini.isNull(e)&&(e="");d.setText(e)}d.setValue(d.defaultValue);d.clear&&d.clear()}}this.setIsValid(!0)},clear:function(){for(var a=this.getFields(),b=0,c=a.length;b<c;b++){var d=a[b];d.setValue&&(d.setText&&!1!==d._clearText&&d.setText(""),d.setValue(""),d.clear&&d.clear())}this.setIsValid(!0)},getValidateFields:function(a){function b(a){return a.isDisplay(function(a){if(mini.hasClass(a,"mini-tabs-body"))return!0})}for(var c=[],d=this.getFields(),e=0,f=d.length;e<f;e++){var g=d[e];g.validate&&g.isDisplay&&(b(g)||g.forceValidate)&&(g.enabled||a||g.forceValidate)&&c.push(g)}return c},validate:function(a,b){for(var c=this.getValidateFields(b),d=0,e=c.length;d<e&&(0!=c[d].validate()||!1!==a);d++);return this.isValid()},isValid:function(){for(var a=this.getValidateFields(),b=0,c=a.length;b<c;b++)if(0==a[b].isValid())return!1;return!0},setIsValid:function(a){for(var b=this.getFields(),c=0,d=b.length;c<d;c++){var e=b[c];e.setIsValid&&e.setIsValid(a)}},getErrorTexts:function(){for(var a=[],b=this.getErrors(),c=0,d=b.length;c<d;c++)a.push(b[c].errorText);return a},getErrors:function(){for(var a=[],b=this.getFields(),c=0,d=b.length;c<d;c++){var e=b[c];e.isValid&&0==e.isValid()&&a.push(e)}return a},mask:function(a){"string"==typeof a&&(a={html:a});a=a||{};a.el=this.el;a.cls||(a.cls=this._maskCls);mini.mask(a)},unmask:function(){mini.unmask(this.el)},_maskCls:"mini-mask-loading",loadingMsg:"\u6570\u636e\u52a0\u8f7d\u4e2d\uff0c\u8bf7\u7a0d\u540e...",loading:function(a){this.mask(a||this.loadingMsg)},__OnValueChanged:function(a){this._changed=!0},_changed:!1,setChanged:function(a){this._changed=a;a=this.getFields();for(var b=0,c=a.length;b<c;b++)a[b].on("valuechanged",this.__OnValueChanged,this)},isChanged:function(){return this._changed},setEnabled:function(a){for(var b=this.getFields(),c=0,d=b.length;c<d;c++)b[c].setEnabled(a)}});mini.Fit=function(){mini.Fit.superclass.constructor.apply(this,arguments)};mini.extend(mini.Fit,mini.Container,{style:"",_clearBorder:!1,uiCls:"mini-fit",_create:function(){this.el=document.createElement("div");this.el.className="mini-fit";this._bodyEl=this.el},_initEvents:function(){},isFixedSize:function(){return!1},doLayout:function(){if(this.canLayout()){var a=this.el.parentNode,b=mini.getChildNodes(a);a==document.body&&(this.el.style.height="0px");for(var a=mini.getHeight(a,!0),c=0,d=b.length;c<d;c++){var e=b[c],f=e.tagName?e.tagName.toLowerCase():"";if(e!=this.el&&"style"!=f&&"script"!=f&&"hidden"!=e.type&&(f=mini.getStyle(e,"position"),"absolute"!=f&&"fixed"!=f))var g=mini.getHeight(e),f=mini.getMargins(e),a=a-g-f.top-f.bottom}var g=mini.getBorders(this.el),k=mini.getPaddings(this.el),f=mini.getMargins(this.el),a=a-f.top-f.bottom;jQuery.boxModel&&(a=a-k.top-k.bottom-g.top-g.bottom);0>a&&(a=0);this.el.style.height=a+"px";try{for(b=mini.getChildNodes(this.el),c=0,d=b.length;c<d;c++)e=b[c],mini.layout(e)}catch(l){}}},set_bodyParent:function(a){if(a){for(var b=this._bodyEl;a.firstChild;)try{b.appendChild(a.firstChild)}catch(c){}this.doLayout()}},getAttrs:function(a){var b=mini.Fit.superclass.getAttrs.call(this,a);b._bodyParent=a;return b}});mini.regClass(mini.Fit,"fit");mini.Panel=function(){this._initButtons();mini.Panel.superclass.constructor.apply(this,arguments);this.url&&this.setUrl(this.url);this._contentEl=this._bodyEl;this._doVisibleEls();this._Resizer=new mini._Resizer(this);this._doTools()};mini.extend(mini.Panel,mini.Container,{width:250,title:"",iconCls:"",iconStyle:"",allowResize:!1,url:"",refreshOnExpand:!1,maskOnLoad:!0,collapseOnTitleClick:!1,showCollapseButton:!1,showCloseButton:!1,closeAction:"display",showHeader:!0,showToolbar:!1,showFooter:!1,headerCls:"",headerStyle:"",bodyCls:"",bodyStyle:"",footerCls:"",footerStyle:"",toolbarCls:"",toolbarStyle:"",minWidth:180,minHeight:100,maxWidth:5E3,maxHeight:3E3,set:function(a){if("string"==typeof a)return this;var b=this._allowLayout;this._allowLayout=!1;var c=a.toolbar;delete a.toolbar;var d=a.footer;delete a.footer;var e=a.url;delete a.url;var f=a.buttons;delete a.buttons;mini.Panel.superclass.set.call(this,a);f&&this.setButtons(f);c&&this.setToolbar(c);d&&this.setFooter(d);e&&this.setUrl(e);this._allowLayout=b;this.doLayout();return this},uiCls:"mini-panel",_create:function(){this.el=document.createElement("div");this.el.className="mini-panel";this.el.tabIndex=0;this.el.innerHTML='\x3cdiv class\x3d"mini-panel-border"\x3e\x3cdiv class\x3d"mini-panel-header" \x3e\x3cdiv class\x3d"mini-panel-header-inner" \x3e\x3cspan class\x3d"mini-panel-icon mini-icon mini-iconfont"\x3e\x3c/span\x3e\x3cdiv class\x3d"mini-panel-title" \x3e\x3c/div\x3e\x3cdiv class\x3d"mini-tools" \x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-panel-viewport"\x3e\x3cdiv class\x3d"mini-panel-toolbar"\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-panel-body" \x3e\x3c/div\x3e\x3cdiv class\x3d"mini-panel-footer"\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-resizer-trigger"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e';this.el.hideFocus=!0;this._borderEl=this.el.firstChild;this._headerEl=this._borderEl.firstChild;this._viewportEl=this._borderEl.lastChild;this._toolbarEl=mini.byClass("mini-panel-toolbar",this.el);this._bodyEl=mini.byClass("mini-panel-body",this.el);this._footerEl=mini.byClass("mini-panel-footer",this.el);this._resizeGridEl=mini.byClass("mini-resizer-trigger",this.el);mini.byClass("mini-panel-header-inner",this.el);this._iconEl=mini.byClass("mini-panel-icon",this.el);this._titleEl=mini.byClass("mini-panel-title",this.el);this._toolsEl=mini.byClass("mini-tools",this.el);mini.setStyle(this._bodyEl,this.bodyStyle);this._doTitle()},destroy:function(a){this._doRemoveIFrame();this._toolsEl=this._titleEl=this._iconEl=this._resizeGridEl=this._viewportEl=this._borderEl=this._bodyEl=this._footerEl=this._toolbarEl=this._iframeEl=null;mini.Panel.superclass.destroy.call(this,a)},_initEvents:function(){mini._BindEvents(function(){mini.on(this.el,"click",this.__OnClick,this)},this)},_doVisibleEls:function(){this._headerEl.style.display=this.showHeader?"":"none";this._toolbarEl.style.display=this.showToolbar?"":"none";this._footerEl.style.display=this.showFooter?"":"none"},_setBodyWidth:!0,doLayout:function(){if(this.canLayout()){var a=this.isAutoHeight();this.isAutoWidth();var b=parseInt(jQuery(this.el).css("max-height"));a&&b&&(this._viewportEl.style.height="auto",this._bodyEl.style.height="auto",this.el.firstChild.offsetHeight>b&&(a=!1));this._autoHeight=a;b=this.getWidth(!0);mini.isIE6&&mini.setWidth(this._bodyEl,b);a?(this._viewportEl.style.height="auto",this._bodyEl.style.height="auto"):(a=this.getViewportHeight(),mini.setHeight(this._viewportEl,a),a=this.getBodyHeight(),mini.setHeight(this._bodyEl,a));mini.layout(this._borderEl);this._resizeGridEl&&mini.repaint(this._resizeGridEl);this._resizeGridEl.style.display=this.allowResize?"":"none";this.fire("layout")}},deferLayout:function(a){a||(a=10);if(!this._layoutTimer){var b=this;this._layoutTimer=setTimeout(function(){b._layoutTimer=null;b.doLayout()},a)}},_stopLayout:function(){clearTimeout(this._layoutTimer);this._layoutTimer=null},getViewportWidth:function(a){return this.getWidth(!0)},getViewportHeight:function(a){var b=this.getHeight(!0)-this.getHeaderHeight();if(a){a=mini.getPaddings(this._viewportEl);var c=mini.getBorders(this._viewportEl),d=mini.getMargins(this._viewportEl);jQuery.boxModel&&(b=b-a.top-a.bottom-c.top-c.bottom);b=b-d.top-d.bottom}return b},getBodyHeight:function(a){var b=this.getViewportHeight(),b=b-this.getToolbarHeight()-this.getFooterHeight();if(a){a=mini.getPaddings(this._bodyEl);var c=mini.getBorders(this._bodyEl),d=mini.getMargins(this._bodyEl);jQuery.boxModel&&(b=b-a.top-a.bottom-c.top-c.bottom);b=b-d.top-d.bottom}0>b&&(b=0);return b},getHeaderHeight:function(){return this.showHeader?jQuery(this._headerEl).outerHeight():0},getToolbarHeight:function(){return this.showToolbar?jQuery(this._toolbarEl).outerHeight():0},getFooterHeight:function(){return this.showFooter?jQuery(this._footerEl).outerHeight():0},setHeaderStyle:function(a){this.headerStyle=a;mini.setStyle(this._headerEl,a);this.doLayout()},getHeaderStyle:function(){return this.headerStyle},setBodyStyle:function(a){this.bodyStyle=a;mini.setStyle(this._bodyEl,a);this.doLayout()},getBodyStyle:function(){return this.bodyStyle},setToolbarStyle:function(a){this.toolbarStyle=a;mini.setStyle(this._toolbarEl,a);this.doLayout()},getToolbarStyle:function(){return this.toolbarStyle},setFooterStyle:function(a){this.footerStyle=a;mini.setStyle(this._footerEl,a);this.doLayout()},getFooterStyle:function(){return this.footerStyle},setHeaderCls:function(a){jQuery(this._headerEl).removeClass(this.headerCls);jQuery(this._headerEl).addClass(a);this.headerCls=a;this.doLayout()},getHeaderCls:function(){return this.headerCls},setBodyCls:function(a){jQuery(this._bodyEl).removeClass(this.bodyCls);jQuery(this._bodyEl).addClass(a);this.bodyCls=a;this.doLayout()},getBodyCls:function(){return this.bodyCls},setToolbarCls:function(a){jQuery(this._toolbarEl).removeClass(this.toolbarCls);jQuery(this._toolbarEl).addClass(a);this.toolbarCls=a;this.doLayout()},getToolbarCls:function(){return this.toolbarCls},setFooterCls:function(a){jQuery(this._footerEl).removeClass(this.footerCls);jQuery(this._footerEl).addClass(a);this.footerCls=a;this.doLayout()},getFooterCls:function(){return this.footerCls},_doTitle:function(){this._titleEl.innerHTML=""==this.title?"\x26nbsp":this.title;this._iconEl.style.display=this.iconCls||this.iconStyle?"inline":"none";this._iconEl.className="mini-panel-icon mini-icon mini-iconfont "+this.iconCls;mini.setStyle(this._iconEl,this.iconStyle)},setTitle:function(a){this.title=a;this._doTitle()},getTitle:function(){return this.title},setIconCls:function(a){this.iconCls=a;this._doTitle()},getIconCls:function(){return this.iconCls},setIconStyle:function(a){this.iconStyle=a;this._doTitle()},getIconStyle:function(){return this.iconStyle},_doTools:function(){for(var a="",b=0,c=this.buttons.length;b<c;b++)var d=this.buttons[b],a=d.html?a+d.html:a+('\x3cspan id\x3d"'+b+'" class\x3d"mini-icon mini-iconfont fa '+d.cls+" "+(d.enabled?"":"mini-disabled")+'" style\x3d"'+d.style+";"+(d.visible?"":"display:none;")+'"\x3e\x3c/span\x3e');this._toolsEl.innerHTML=a},setShowCloseButton:function(a){this.showCloseButton=a;var b=this.getButton("close");b&&(b.visible=a,this._doTools())},getShowCloseButton:function(){return this.showCloseButton},setCloseAction:function(a){this.closeAction=a},getCloseAction:function(){return this.closeAction},setShowCollapseButton:function(a){this.showCollapseButton=a;var b=this.getButton("collapse");b&&(b.visible=a,this._doTools())},getShowCollapseButton:function(){return this.showCollapseButton},setShowHeader:function(a){this.showHeader=a;this._doVisibleEls();this.deferLayout()},getShowHeader:function(){return this.showHeader},setShowToolbar:function(a){this.showToolbar=a;this._doVisibleEls();this.deferLayout()},getShowToolbar:function(){return this.showToolbar},setShowFooter:function(a){this.showFooter=a;this._doVisibleEls();this.deferLayout()},getShowFooter:function(){return this.showFooter},__OnClick:function(a){if(mini.isAncestor(this._headerEl,a.target))if(mini.findParent(a.target,"mini-tools")){var b=this.getButton(parseInt(a.target.id));b&&this._OnButtonClick(b,a)}else this.collapseOnTitleClick&&this.toggle()},_OnButtonClick:function(a,b){var c={button:a,index:this.buttons.indexOf(a),name:a.name.toLowerCase(),htmlEvent:b,cancel:!1};this.fire("beforebuttonclick",c);var d=!0;try{"close"==c.name&&"destroy"==this.closeAction&&this._iframeEl&&this._iframeEl.contentWindow&&(d=this._iframeEl.contentWindow.CloseWindow?this._iframeEl.contentWindow.CloseWindow("close"):this._iframeEl.contentWindow.CloseOwnerWindow?this._iframeEl.contentWindow.CloseOwnerWindow("close"):this._CloseOwnerWindow("close"))}catch(e){d=this._CloseOwnerWindow("close")}!1===d&&(c.cancel=!0);if(1==c.cancel)return c;this.fire("buttonclick",c);"close"==c.name&&("destroy"==this.closeAction?(this.__HideAction="close",this.destroy()):this.hide());"collapse"==c.name&&(this.toggle(),this.refreshOnExpand&&this.expanded&&this.url&&this.reload());return c},onButtonClick:function(a,b){this.on("buttonclick",a,b)},_initButtons:function(){this.buttons=[];var a=this.createButton({name:"collapse",cls:"mini-tools-collapse",visible:this.showCollapseButton});this.buttons.push(a);a=this.createButton({name:"close",cls:"mini-tools-close",visible:this.showCloseButton});this.buttons.push(a)},createButton:function(a){return mini.copyTo({name:"",cls:"",style:"",visible:!0,enabled:!0,html:""},a)},setButtons:function(a){"string"==typeof a&&(a=a.split(" "));mini.isArray(a)||(a=[]);for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c];if("string"==typeof e){e=e.trim();if(!e)continue;e={name:e,cls:"mini-tools-"+e,html:""}}e=this.createButton(e);b.push(e)}this.buttons=b;this._doTools()},getButtons:function(){return this.buttons},addButton:function(a,b){"string"==typeof a&&(a={iconCls:a});a=this.createButton(a);"number"!=typeof b&&(b=this.buttons.length);this.buttons.insert(b,a);this._doTools()},updateButton:function(a,b){var c=this.getButton(a);c&&(mini.copyTo(c,b),this._doTools())},removeButton:function(a){if(a=this.getButton(a))this.buttons.remove(a),this._doTools()},getButton:function(a){if("number"==typeof a)return this.buttons[a];for(var b=0,c=this.buttons.length;b<c;b++){var d=this.buttons[b];if(d.name==a)return d}},setBody:function(a){__mini_setControls(a,this._bodyEl,this)},set_bodyParent:function(a){},setToolbar:function(a){__mini_setControls(a,this._toolbarEl,this)},setFooter:function(a){__mini_setControls(a,this._footerEl,this)},getHeaderEl:function(){return this._headerEl},getToolbarEl:function(){return this._toolbarEl},getBodyEl:function(){return this._bodyEl},getFooterEl:function(){return this._footerEl},getIFrameEl:function(a){return this._iframeEl},clearTimeStamp:!1,setClearTimeStamp:function(a){this.clearTimeStamp=a},getClearTimeStamp:function(){return this.clearTimeStamp},_getMaskWrapEl:function(){return this._bodyEl},_doRemoveIFrame:function(a){if(this._iframeEl){var b=this._iframeEl;b._ondestroy&&b._ondestroy();b.onload=function(){};jQuery(b).unbind("load");b.src="";if(mini.isIE)try{b.contentWindow.document.write(""),b.contentWindow.document.close()}catch(c){}try{this._iframeEl.parentNode.removeChild(this._iframeEl),this._iframeEl.removeNode(!0)}catch(c){}}this._iframeEl=null;!0===a&&mini.removeChilds(this._bodyEl)},_deferLoadingTime:80,_doLoad:function(){function a(a){c.__HideAction=a;var b=!0;try{c.__onDestroy&&(b=c.__onDestroy(a))}catch(g){}if(!1===b)return!1;c.fire("unload",{iframe:c._iframeEl,action:a});setTimeout(function(){c.destroy()},10)}if(this.url){this._doRemoveIFrame(!0);var b=new Date,c=this;this.loadedUrl=this.url;this.maskOnLoad&&this.loading();jQuery(this._bodyEl).css("overflow","hidden");c._CloseOwnerWindow=a;var d=mini.createIFrame(this.url,function(d,f){if(!c.destroyed){var e=b-new Date+c._deferLoadingTime;0>e&&(e=0);setTimeout(function(){c.unmask()},e);try{c._iframeEl.contentWindow.Owner=c.Owner,c._iframeEl.contentWindow.CloseOwnerWindow=a}catch(k){}if(f||c.loadOnRefresh)c.__onLoad&&c.__onLoad(),c.fire("load",{iframe:c._iframeEl})}},this.clearTimeStamp);this._bodyEl.appendChild(d);this._iframeEl=d}},load:function(a,b,c){this.setUrl(a,b,c)},reload:function(){this.setUrl(this.url)},setUrl:function(a,b,c){this.url=a;this.__onLoad=b;this.__onDestroy=c;this.expanded&&a&&this._doLoad()},getUrl:function(){return this.url},setRefreshOnExpand:function(a){this.refreshOnExpand=a},getRefreshOnExpand:function(){return this.refreshOnExpand},setMaskOnLoad:function(a){this.maskOnLoad=a},getMaskOnLoad:function(a){return this.maskOnLoad},setAllowResize:function(a){this.allowResize!=a&&(this.allowResize=a,this.doLayout())},getAllowResize:function(){return this.allowResize},setLoadOnRefresh:function(a){this.loadOnRefresh=a},getLoadOnRefresh:function(a){return this.loadOnRefresh},expanded:!0,setExpanded:function(a){this.expanded!=a&&((this.expanded=a)?this.expand():this.collapse())},getExpanded:function(){return this.expanded},toggle:function(){this.expanded?this.collapse():this.expand()},collapse:function(){this.expanded=!1;"max"!=this.state&&(this._height=this.el.style.height);this.el.style.height="auto";this._viewportEl.style.display="none";mini.addClass(this.el,"mini-panel-collapse");this.doLayout()},expand:function(){this.expanded=!0;this._height&&(this.el.style.height=this._height);this._viewportEl.style.display="block";"max"!=this.state&&delete this._height;mini.removeClass(this.el,"mini-panel-collapse");this._expandLoad();this.doLayout()},_expandLoad:function(){this.url&&this.url!=this.loadedUrl&&this._doLoad()},setCollapseOnTitleClick:function(a){this.collapseOnTitleClick=a;mini.removeClass(this.el,"mini-panel-titleclick");a&&mini.addClass(this.el,"mini-panel-titleclick")},getCollapseOnTitleClick:function(){return this.collapseOnTitleClick},getAttrs:function(a){var b=mini.Panel.superclass.getAttrs.call(this,a);mini._ParseString(a,b,"title iconCls iconStyle headerCls headerStyle bodyCls bodyStyle footerCls footerStyle toolbarCls toolbarStyle footer toolbar url closeAction loadingMsg onbeforebuttonclick onbuttonclick onload buttons".split(" "));mini._ParseBool(a,b,"allowResize showCloseButton showHeader showToolbar showFooter loadOnRefresh showCollapseButton refreshOnExpand maskOnLoad expanded collapseOnTitleClick clearTimeStamp".split(" "));a=mini.getChildNodes(a,!0);for(var c=a.length-1;0<=c;c--){var d=a[c],e=mini.getAttr(d,"property");e&&(e=e.toLowerCase(),"toolbar"==e?b.toolbar=d:"footer"==e&&(b.footer=d))}b.body=a;return b}});mini.regClass(mini.Panel,"panel");mini.Window=function(){mini.Window.superclass.constructor.apply(this,arguments);this.addCls("mini-window");this.setVisible(!1);this.setAllowDrag(this.allowDrag);this.setAllowResize(this.allowResize)};mini.extend(mini.Window,mini.Panel,{x:0,y:0,state:"restore",_dragCls:"mini-window-drag",_resizeCls:"mini-window-resize",allowDrag:!0,showCloseButton:!0,showMaxButton:!1,showMinButton:!1,showCollapseButton:!1,showModal:!0,minWidth:150,minHeight:80,maxWidth:2E3,maxHeight:2E3,uiCls:"mini-window",_create:function(){mini.Window.superclass._create.call(this);this.el.className+=" mini-corner-all";this.el.firstChild.className+=" mini-corner-all";mini.isIE&&mini_useShims&&mini.append(this.el,"\x3ciframe frameborder\x3d'0' style\x3d'position: absolute; z-index: -1; width: 100%; height: 100%; top: 0;left:0;scrolling:no;'\x3e\x3c/iframe\x3e")},_initButtons:function(){this.buttons=[];var a=this.createButton({name:"collapse",cls:"mini-tools-collapse",visible:this.showCollapseButton});this.buttons.push(a);a=this.createButton({name:"min",cls:"mini-tools-min",visible:this.showMinButton});this.buttons.push(a);a=this.createButton({name:"max",cls:"mini-tools-max",visible:this.showMaxButton});this.buttons.push(a);a=this.createButton({name:"close",cls:"mini-tools-close",visible:this.showCloseButton});this.buttons.push(a)},_initEvents:function(){mini.Window.superclass._initEvents.call(this);mini._BindEvents(function(){mini.on(this.el,"mouseover",this.__OnMouseOver,this);mini.on(window,"resize",this.__OnWindowResize,this);mini.on(this.el,"mousedown",this.__OnWindowMouseDown,this)},this)},doLayout:function(){if(this.canLayout()){if("max"==this.state){var a=this.getParentBox();this.el.style.left="0px";this.el.style.top="0px";mini.setSize(this.el,a.width,a.height)}mini.Window.superclass.doLayout.call(this);this.allowDrag&&mini.addClass(this.el,this._dragCls);"max"==this.state&&(this._resizeGridEl.style.display="none",mini.removeClass(this.el,this._dragCls));this._doModal()}},_doModal:function(){if(this.el){var a=this.showModal&&this.isDisplay()&&this.visible;this._modalEl||0!=this.showModal?(this._modalEl||(this._modalEl=mini.append(document.body,'\x3cdiv id\x3d"__modal'+this._id+'" class\x3d"mini-modal mini-widget-content" style\x3d"display:none"\x3e'+(mini_useShims?"\x3ciframe frameborder\x3d'0' style\x3d'position: absolute; z-index: -1; width: 100%; height: 100%; top: 0;left:0;scrolling:no;'\x3e\x3c/iframe\x3e":"")+"\x3c/div\x3e")),a?(this._modalEl.style.display="block",this._modalEl.style.zIndex=mini.getStyle(this.el,"zIndex")-1):this._modalEl.style.display="none"):this._modalEl&&mini.removeNode(this._modalEl)}else this._modalEl&&mini.removeNode(this._modalEl)},getParentBox:function(){var a=mini.getViewportBox(),b=this._containerEl||document.body;b!=document.body&&(a=mini.getBox(b));return a},setShowModal:function(a){this.showModal=a},getShowModal:function(){return this.showModal},setMinWidth:function(a){isNaN(a)||(this.minWidth=a)},getMinWidth:function(){return this.minWidth},setMinHeight:function(a){isNaN(a)||(this.minHeight=a)},getMinHeight:function(){return this.minHeight},setMaxWidth:function(a){isNaN(a)||(this.maxWidth=a)},getMaxWidth:function(){return this.maxWidth},setMaxHeight:function(a){isNaN(a)||(this.maxHeight=a)},getMaxHeight:function(){return this.maxHeight},setAllowDrag:function(a){this.allowDrag=a;mini.removeClass(this.el,this._dragCls);a&&mini.addClass(this.el,this._dragCls)},getAllowDrag:function(){return this.allowDrag},setShowMaxButton:function(a){this.showMaxButton=a;var b=this.getButton("max");b&&(b.visible=a,this._doTools())},getShowMaxButton:function(){return this.showMaxButton},setShowMinButton:function(a){this.showMinButton=a;var b=this.getButton("min");b&&(b.visible=a,this._doTools())},getShowMinButton:function(){return this.showMinButton},max:function(){this.state="max";this.addCls("mini-window-max");this.show();var a=this.getButton("max");a&&(a.cls="mini-tools-restore",this._doTools())},restore:function(){this.removeCls("mini-window-max");this.state="restore";this.show(this.x,this.y);var a=this.getButton("max");a&&(a.cls="mini-tools-max",this._doTools())},showInBody:!0,setShowInBody:function(a){this.showInBody=a},getShowInBody:function(){return this.showInBody},containerEl:null,showAtPos:function(a,b,c){this.show(a,b,c)},show:function(a,b,c){this._allowLayout=!1;c=this._containerEl||document.body;(!this.isRender()||this.el.parentNode!=c&&this.showInBody)&&this.render(c);this.el.style.zIndex=mini.getMaxZIndex();this._doShow(a,b);this._allowLayout=!0;this.setVisible(!0);"max"!=this.state&&(a=this.getBox(),this.x=a.x,this.y=a.y);try{document.body.focus()}catch(d){}},hide:function(){this.setVisible(!1);this._doModal()},getWidth:function(a){this._headerEl.style.width="50px";var b=mini.getWidth(this.el);this._headerEl.style.width="auto";a&&this._borderEl&&(a=mini.getBorders(this._borderEl),b=b-a.left-a.right);return b},getBox:function(){this._headerEl.style.width="50px";this.el.style.display="";var a=mini.getWidth(this.el);this._headerEl.style.width="auto";var b=mini.getBox(this.el);b.width=a;b.right=b.x+a;return b},_measureSize:function(){this.el.style.display="";var a=this.getBox();a.width>this.maxWidth&&(mini.setWidth(this.el,this.maxWidth),a=this.getBox());this.expanded&&a.height>this.maxHeight&&(mini.setHeight(this.el,this.maxHeight),a=this.getBox());a.width<this.minWidth&&(mini.setWidth(this.el,this.minWidth),a=this.getBox());this.expanded&&a.height<this.minHeight&&(mini.setHeight(this.el,this.minHeight),this.getBox())},_doShow:function(a,b){var c=this.getParentBox();if("max"==this.state){if(!this._width){var d=this.getBox();this._width=d.width;this.expanded&&(this._height=d.height);this.x=d.x;this.y=d.y}this.el.style.left="-10000px";this.el.style.top="-10000px"}else mini.isNull(a)&&(a="center"),mini.isNull(b)&&(b="middle"),this.el.style.position="absolute",this.el.style.left="-2000px",this.el.style.top="-2000px",this.el.style.display="",this._width&&(this.setWidth(this._width),this.setHeight(this._height),delete this._width,delete this._height),this._measureSize(),d=this.getBox(),"left"==a&&(a=0),"center"==a&&(a=c.width/2-d.width/2),"right"==a&&(a=c.width-d.width),"top"==b&&(b=0),"middle"==b&&(b=c.y+c.height/2-d.height/2),"bottom"==b&&(b=c.height-d.height),a+d.width>c.right&&(a=c.right-d.width),b+d.height>c.bottom&&(b=c.bottom-d.height),0>a&&(a=0),0>b&&(b=0),this.el.style.display="",mini.setX(this.el,a),mini.setY(this.el,b);this.doLayout()},_OnButtonClick:function(a,b){var c=mini.Window.superclass._OnButtonClick.call(this,a,b);if(1==c.cancel)return c;"max"==c.name&&("max"==this.state?this.restore():this.max());return c},__OnWindowResize:function(a){"max"==this.state&&this.doLayout();mini.isIE6||this._doModal()},enableDragProxy:!0,setEnableDragProxy:function(a){this.enableDragProxy=a},getEnableDragProxy:function(a){return this.enableDragProxy},allowCrossBottom:!0,setAllowCrossBottom:function(a){this.allowCrossBottom=a},getAllowCrossBottom:function(){return this.allowCrossBottom},xxx:0,__OnWindowMouseDown:function(a){var b=this;if("max"!=this.state&&this.allowDrag&&mini.isAncestor(this._headerEl,a.target)&&!mini.findParent(a.target,"mini-tools")){b=this;this.el&&(this.el.style.zIndex=mini.getMaxZIndex());var c=this.getBox();(new mini.Drag({capture:!1,onStart:function(){b._maskProxy=mini.append(document.body,'\x3cdiv class\x3d"mini-resizer-mask" style\x3d""\x3e\x3c/div\x3e');b.enableDragProxy?(b._dragProxy=mini.append(document.body,'\x3cdiv class\x3d"mini-drag-proxy"\x3e\x3c/div\x3e'),b.el.style.left="-2000px",b.el.style.top="-2000px"):b._dragProxy=b.el;var a=mini.append(document.body,'\x3cdiv class\x3d"mini-resizer-mask"\x3e\x3c/div\x3e');setTimeout(function(){mini.removeNode(a)},300)},onMove:function(a){var d=a.now[0]-a.init[0];a=a.now[1]-a.init[1];d=c.x+d;a=c.y+a;var f=b.getParentBox(),g=a+c.height;d+c.width>f.width&&(d=f.width-c.width);b.allowCrossBottom||g>f.height&&(a=f.height-c.height);0>d&&(d=0);0>a&&(a=0);b.x=d;b.y=a;mini.setBox(b._dragProxy,{x:d,y:a,width:c.width,height:c.height});this.moved=!0},onStop:function(){if(b.el&&(b.el.style.display="block",this.moved)){var a=mini.getBox(b._dragProxy);mini.setBox(b.el,a)}jQuery(b._maskProxy).remove();b._maskProxy=null;b.enableDragProxy&&jQuery(b._dragProxy).remove();b._dragProxy=null;b.fire("moveend")}})).start(a)}},destroy:function(a){mini.un(window,"resize",this.__OnWindowResize,this);this._modalEl&&(jQuery(this._modalEl).remove(),this._modalEl=null);this.shadowEl&&(jQuery(this.shadowEl).remove(),this.shadowEl=null);jQuery("[id\x3d'__modal"+this._id+"']").remove();mini.Window.superclass.destroy.call(this,a)},getAttrs:function(a){var b=mini.Window.superclass.getAttrs.call(this,a);mini._ParseString(a,b,["modalStyle","onmoveend"]);mini._ParseBool(a,b,"showModal showShadow allowDrag allowResize showMaxButton showMinButton showInBody enableDragProxy allowCrossBottom".split(" "));mini._ParseInt(a,b,["minWidth","minHeight","maxWidth","maxHeight"]);return b},showAtEl:function(a,b){if(a=mini.byId(a)){this.isRender()&&this.el.parentNode==document.body||this.render(document.body);var c={xAlign:this.xAlign,yAlign:this.yAlign,xOffset:0,yOffset:0,popupCls:this.popupCls};mini.copyTo(c,b);this._popupEl=a;this.el.style.position="absolute";this.el.style.left="-2000px";this.el.style.top="-2000px";this.el.style.display="";this.doLayout();this._measureSize();var d=mini.getViewportBox(),e=this.getBox(),f=mini.getBox(a),g=c.xy,k=d.width/2-e.width/2,l=0;g&&(k=g[0],l=g[1]);switch(c.xAlign){case "outleft":k=f.x-e.width;break;case "left":k=f.x;break;case "center":k=f.x+f.width/2-e.width/2;break;case "right":k=f.right-e.width;break;case "outright":k=f.right}switch(c.yAlign){case "above":l=f.y-e.height;break;case "top":l=f.y;break;case "middle":l=f.y+f.height/2-e.height/2;break;case "bottom":l=f.bottom-e.height;break;case "below":l=f.bottom}k=parseInt(k);l=parseInt(l);c.outYAlign||c.outXAlign?("above"==c.outYAlign&&l+e.height>d.bottom&&f.y-d.y>d.bottom-f.bottom&&(l=f.y-e.height),"outleft"==c.outXAlign&&k+e.width>d.right&&f.x-d.x>d.right-f.right&&(k=f.x-e.width),"right"==c.outXAlign&&k+e.width>d.right&&(k=f.right-e.width),this._Show(k,l)):this.showAtPos(k+c.xOffset,l+c.yOffset)}}});mini.regClass(mini.Window,"window");mini.MessageBox={alertTitle:"\u63d0\u9192",confirmTitle:"\u786e\u8ba4",prompTitle:"\u8f93\u5165",prompMessage:"\u8bf7\u8f93\u5165\u5185\u5bb9\uff1a",buttonText:{ok:"\u786e\u5b9a",cancel:"\u53d6\u6d88",yes:"\u662f",no:"\u5426"},autoFocus:!0,show:function(a){a=mini.copyTo({width:"auto",height:"auto",showModal:!0,timeout:0,minWidth:150,maxWidth:800,minHeight:50,maxHeight:350,showHeader:!0,title:"",titleIcon:"",iconCls:"",iconStyle:"",message:"",html:"",spaceStyle:"margin-right:15px",showCloseButton:!0,buttons:null,buttonWidth:58,callback:null},a);a.message=String(a.message);var b=a.callback,c=new mini.Window;c.addCls("mini-messagebox");c.setBodyStyle("overflow:hidden");c.setShowModal(a.showModal);c.setTitle(a.title||"");c.setIconCls(a.titleIcon);c.setShowHeader(a.showHeader);c.setShowCloseButton(a.showCloseButton);var d=c.uid+"$table",e=c.uid+"$content",f='\x3ctable class\x3d"mini-messagebox-table" id\x3d"'+d+'" style\x3d"" cellspacing\x3d"0" cellpadding\x3d"0"\x3e\x3ctr\x3e\x3ctd\x3e'+('\x3cdiv class\x3d"'+a.iconCls+'" style\x3d"'+a.iconStyle+'"\x3e\x3c/div\x3e')+'\x3c/td\x3e\x3ctd id\x3d"'+e+'" class\x3d"mini-messagebox-content-text"\x3e'+(a.message||"")+"\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e";c._bodyEl.innerHTML='\x3cdiv class\x3d"mini-messagebox-content"\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-messagebox-buttons"\x3e\x3c/div\x3e';var g=c._bodyEl.firstChild;a.html?"string"==typeof a.html?g.innerHTML=a.html:mini.isElement(a.html)&&g.appendChild(a.html):g.innerHTML=f;c._Buttons=[];f=c._bodyEl.lastChild;if(a.buttons&&0<a.buttons.length)for(var g=0,k=a.buttons.length;g<k;g++){var l=a.buttons[g],n=mini.MessageBox.buttonText[l];n||(n=l);var p=new mini.Button;p.setText(n);p.setWidth(a.buttonWidth);p.render(f);p.action=l;p.on("click",function(a){a=a.sender;b&&!1===b(a.action)||mini.MessageBox.hide(c)});g!=k-1&&p.setStyle(a.spaceStyle);c._Buttons.push(p)}else f.style.display="none";c.setMinWidth(a.minWidth);c.setMinHeight(a.minHeight);c.setMaxWidth(a.maxWidth);c.setMaxHeight(a.maxHeight);c.setWidth(a.width);c.setHeight(a.height);c.show(a.x,a.y,{animType:a.animType});f=c.getWidth();c.setWidth(f);f=c.getHeight();c.setHeight(f);if(d=document.getElementById(d))d.style.width="100%";if(e=document.getElementById(e))e.style.width="100%";mini.MessageBox.autoFocus&&((e=c._Buttons[0])?e.focus():c.focus());c.on("beforebuttonclick",function(a){b&&b("close");a.cancel=!0;mini.MessageBox.hide(c)});mini.on(c.el,"keydown",function(a){27==a.keyCode&&(b&&b("close"),mini.MessageBox.hide(c))});a.timeout&&setTimeout(function(){mini.MessageBox.hide(c.uid)},a.timeout);return c.uid},hide:function(a){if(a&&(a="object"==typeof a?a:mini.getbyUID(a))){for(var b=0,c=a._Buttons.length;b<c;b++)a._Buttons[b].destroy();a._Buttons=null;a.destroy()}},alert:function(a,b,c){return mini.MessageBox.show({minWidth:250,title:b||mini.MessageBox.alertTitle,buttons:["ok"],message:a,iconCls:"mini-messagebox-warning",callback:c})},confirm:function(a,b,c){return mini.MessageBox.show({minWidth:250,title:b||mini.MessageBox.confirmTitle,buttons:["ok","cancel"],message:a,iconCls:"mini-messagebox-question",callback:c})},prompt:function(a,b,c,d,e){var f="prompt$"+(new Date).getTime();a=a||mini.MessageBox.promptMessage;b=mini.MessageBox.show({title:b||mini.MessageBox.promptTitle,buttons:["ok","cancel"],width:250,html:'\x3cdiv style\x3d"padding:5px;padding-left:10px;"\x3e'+(d?a+'\x3cbr/\x3e\x3ctextarea id\x3d"'+f+'" style\x3d"width:200px;height:60px;margin-top:3px;"\x3e\x3c/textarea\x3e':a+'\x3cbr/\x3e\x3cinput id\x3d"'+f+'" type\x3d"text" style\x3d"width:200px;margin-top:3px;"/\x3e')+"\x3c/div\x3e",callback:function(a){var b=document.getElementById(f);if(c)return c(a,b.value)}});d=document.getElementById(f);d.focus();null==e&&(e="");d.value=e;return b},loading:function(a,b){return mini.MessageBox.show({minHeight:50,title:b,showCloseButton:!1,message:a,iconCls:"mini-messagebox-waiting"})},showTips:function(a){a=jQuery.extend({content:"",state:"",x:"center",y:"top",offset:[10,10],fixed:!0,timeout:2E3},a);var b=jQuery('\x3cdiv class\x3d"mini-tips mini-tips-'+a.state+'"\x3e'+a.content+"\x3c/div\x3e").appendTo(document.body);a.el=b[0];a.timeoutHandler=function(){b.slideUp();setTimeout(function(){b.remove()},2E3)};mini.showAt(a);b.hide().slideDown()}};mini.alert=mini.MessageBox.alert;mini.confirm=mini.MessageBox.confirm;mini.prompt=mini.MessageBox.prompt;mini.loading=mini.MessageBox.loading;mini.showMessageBox=mini.MessageBox.show;mini.hideMessageBox=mini.MessageBox.hide;mini.showTips=mini.MessageBox.showTips;mini.Tabs=function(){this._initTabs();mini.Tabs.superclass.constructor.apply(this,arguments)};mini.extend(mini.Tabs,mini.Control,{activeIndex:-1,tabAlign:"left",tabPosition:"top",showBody:!0,showHeader:!0,nameField:"name",titleField:"title",urlField:"url",url:"",maskOnLoad:!0,plain:!0,bodyStyle:"",_tabHoverCls:"mini-tab-hover",_tabActiveCls:"mini-tab-active",set:function(a){if("string"==typeof a)return this;var b=this._allowLayout;this._allowLayout=!1;var c=a.activeIndex;delete a.activeIndex;var d=a.url;delete a.url;mini.Tabs.superclass.set.call(this,a);d&&this.setUrl(d);mini.isNumber(c)&&this.setActiveIndex(c);this._allowLayout=b;this.doLayout();return this},uiCls:"mini-tabs",_create:function(){this.el=document.createElement("div");this.el.className="mini-tabs";this.el.innerHTML='\x3ctable class\x3d"mini-tabs-table" cellspacing\x3d"0" cellpadding\x3d"0"\x3e\x3ctr style\x3d"width:100%;"\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd style\x3d"text-align:left;vertical-align:top;width:100%;"\x3e\x3cdiv class\x3d"mini-tabs-bodys"\x3e\x3c/div\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e';this._tableEl=this.el.firstChild;var a=this.el.getElementsByTagName("td");this._td1El=a[0];this._td2El=a[1];this._td3El=a[2];this._borderEl=this._bodyEl=this._td2El.firstChild;this.doUpdate()},destroy:function(a){if(this.tabs)for(var b=0,c=this.tabs.length;b<c;b++)this.tabs[b]._iframeEl=null;this.tabs=this._bodyEl=this._borderEl=this.headerEl=this._tableEl=this._td1El=this._td2El=this._td3El=null;mini.Tabs.superclass.destroy.call(this,a)},_doClearElement:function(){mini.removeClass(this._td1El,"mini-tabs-header");mini.removeClass(this._td3El,"mini-tabs-header");this._td1El.innerHTML="";this._td3El.innerHTML="";mini.removeChilds(this._td2El,this._bodyEl)},_initEvents:function(){mini._BindEvents(function(){mini.on(this.el,"mousedown",this.__OnMouseDown,this);mini.on(this.el,"click",this.__OnClick,this);mini.on(this.el,"mouseover",this.__OnMouseOver,this);mini.on(this.el,"mouseout",this.__OnMouseOut,this);mini.on(this.el,"dblclick",this.__OnDblClick,this)},this)},_initTabs:function(){this.tabs=[]},_TabID:1,createTab:function(a){var b=mini.copyTo({_id:this._TabID++,name:"",title:"",newLine:!1,tooltip:"",iconCls:"",iconStyle:"",headerCls:"",headerStyle:"",bodyCls:"",bodyStyle:"",visible:!0,enabled:!0,showCloseButton:!1,active:!1,url:"",loaded:!1,refreshOnClick:!1},a);a&&(b=a=mini.copyTo(a,b));return b},_doLoad:function(){var a=mini._getResult(this.url,null,null,null,null,this.dataField);this.dataField&&!mini.isArray(a)&&(a=mini._getMap(this.dataField,a));a||(a=[]);this.setTabs(a);this.fire("load")},load:function(a){"string"==typeof a?this.setUrl(a):this.setTabs(a)},setUrl:function(a){this.url=a;this._doLoad()},getUrl:function(){return this.url},setNameField:function(a){this.nameField=a},getNameField:function(){return this.nameField},setTitleField:function(a){this.titleField=a},getTitleField:function(){return this.titleField},setUrlField:function(a){this.urlField=a},getUrlField:function(){return this.urlField},buttonsAlign:"right",setButtonsAlign:function(a){this.buttonsAlign=a},getButtonsAlign:function(){return this.buttonsAlign},setButtons:function(a){if(this._buttons=mini.byId(a))if(a=mini.byClass("mini-tabs-buttons",this.el))a.appendChild(this._buttons),mini.parse(a),this.doLayout()},setTabControls:function(a,b){if(a=this.getTab(a)){var c=this.getTabBodyEl(a);__mini_setControls(b,c,this)}},setTabs:function(a){if(mini.isArray(a)){this.beginUpdate();this.removeAll();for(var b=0,c=a.length;b<c;b++){var d=a[b];d.title=mini._getMap(this.titleField,d);d.url=mini._getMap(this.urlField,d);d.name=mini._getMap(this.nameField,d)}b=0;for(c=a.length;b<c;b++)this.addTab(a[b]);this.setActiveIndex(0);this.endUpdate()}},getTabs:function(){return this.tabs},removeAll:function(a){var b=this.getActiveTab();mini.isNull(a)&&(a=[]);mini.isArray(a)||(a=[a]);for(var c=a.length-1;0<=c;c--){var d=this.getTab(a[c]);d?a[c]=d:a.removeAt(c)}d=this.tabs;for(c=d.length-1;0<=c;c--){var e=d[c];-1==a.indexOf(e)&&this.removeTab(e)}a=a[0];b!=this.getActiveTab()&&a&&this.activeTab(a)},addTab:function(a,b){"string"==typeof a&&(a={title:a});a=this.createTab(a);a.name||(a.name="");var c=this.getActiveTab();"number"!=typeof b&&(b=this.tabs.length);this.tabs.insert(b,a);c&&(this.activeIndex=this.tabs.indexOf(c));c='\x3cdiv id\x3d"'+this._createTabBodyId(a)+'" class\x3d"mini-tabs-body '+a.bodyCls+'" style\x3d"'+a.bodyStyle+';display:none;"\x3e\x3c/div\x3e';mini.append(this._bodyEl,c);var c=this.getTabBodyEl(a),d=a.body;delete a.body;if(d){mini.isArray(d)||(d=[d]);for(var e=0,f=d.length;e<f;e++)mini.append(c,d[e])}if(a.bodyParent)for(d=a.bodyParent;d.firstChild;)8==d.firstChild.nodeType?d.removeChild(d.firstChild):c.appendChild(d.firstChild);delete a.bodyParent;a.controls&&(this.setTabControls(a,a.controls),delete a.controls);this.doUpdate();return a},removeTab:function(a){if((a=this.getTab(a))&&-1!=this.tabs.indexOf(a)){var b=this.getActiveTab(),c=a==b,d=this._OnTabDestroy(a);this.tabs.remove(a);this._doRemoveIFrame(a);var e=this.getTabBodyEl(a);e&&this._bodyEl.removeChild(e);if(d&&c){for(b=this.activeIndex;0<=b;b--)if((a=this.getTab(b))&&a.enabled&&a.visible){this.activeIndex=b;break}this.doUpdate();this.setActiveIndex(this.activeIndex);this.fire("activechanged")}else this.activeIndex=this.tabs.indexOf(b),this.doUpdate();return a}},moveTab:function(a,b){if(a=this.getTab(a)){var c=this.tabs[b];c!=a&&(this.tabs.remove(a),b=this.tabs.indexOf(c),-1==b?this.tabs.add(a):this.tabs.insert(b,a),this.doUpdate())}},updateTab:function(a,b){if(a=this.getTab(a)){mini.copyTo(a,b);if(!a.visible&&this.tabs.indexOf(a)==this.activeIndex){for(var c=-1,d=this.activeIndex+1,e=this.tabs.length;d<e;d++)if(this.tabs[d].visible){c=d;break}this.setActiveIndex(c)}this.doUpdate()}},_getMaskWrapEl:function(){return this._bodyEl},_doRemoveIFrame:function(a,b){if(a._iframeEl&&a._iframeEl.parentNode){var c=a._iframeEl;c.onload=function(){};jQuery(c).unbind("load");c.src="";if(mini.isIE)try{c.contentWindow.document.write(""),c.contentWindow.document.close()}catch(g){}a._iframeEl._ondestroy&&a._iframeEl._ondestroy();try{c.parentNode.removeChild(c),c.removeNode(!0)}catch(g){}}a._iframeEl=null;a.loadedUrl=null;if(!0===b&&(c=this.getTabBodyEl(a)))for(var c=mini.getChildNodes(c,!0),d=0,e=c.length;d<e;d++){var f=c[d];f&&f.parentNode&&f.parentNode.removeChild(f)}},_deferLoadingTime:180,_cancelLoadTabs:function(a){for(var b=this.tabs,c=0,d=b.length;c<d;c++){var e=b[c];e!=a&&e._loading&&e._iframeEl&&(e._loading=!1,this._doRemoveIFrame(e,!0))}a&&a==this.getActiveTab()&&a._loading||(this._loading=!1,this.unmask())},_doLoadTab:function(a){if(a&&a==this.getActiveTab()){var b=this.getTabBodyEl(a);if(b){this._cancelLoadTabs();this._doRemoveIFrame(a,!0);this._loading=!0;a._loading=!0;this.unmask();this.maskOnLoad&&this.loading();var c=new Date,d=this;d.isLoading=!0;var e=mini.createIFrame(a.url,function(b,e){try{a._iframeEl.contentWindow.Owner=window,a._iframeEl.contentWindow.CloseOwnerWindow=function(b){a.removeAction=b;var c=!0;a.ondestroy&&("string"==typeof a.ondestroy&&(a.ondestroy=window[a.ondestroy]),a.ondestroy&&(c=d._getTabEvent(a),c.action=b,c=a.ondestroy.call(d,c)));if(!1===c)return!1;setTimeout(function(){d.removeTab(a)},10)}}catch(n){}if(1==a._loading){var f=c-new Date+d._deferLoadingTime;a._loading=!1;a.loadedUrl=a.url;0>f&&(f=0);setTimeout(function(){d.unmask();d.doLayout();d.isLoading=!1},f);if(e){var g={sender:d,tab:a,index:d.tabs.indexOf(a),name:a.name,iframe:a._iframeEl};a.onload&&("string"==typeof a.onload&&(a.onload=window[a.onload]),a.onload&&a.onload.call(d,g))}d.getActiveTab()==a&&d.fire("tabload",g)}},this.clearTimeStamp,a.method,a.params);setTimeout(function(){a._iframeEl==e&&b.appendChild(e)},1);a._iframeEl=e}}},_getTabEvent:function(a){return{sender:this,tab:a,index:this.tabs.indexOf(a),name:a.name,iframe:a._iframeEl,autoActive:!0}},_OnTabDestroy:function(a){a=this._getTabEvent(a);this.fire("tabdestroy",a);return a.autoActive},loadTab:function(a,b,c,d){if(a&&((b=this.getTab(b))||(b=this.getActiveTab()),b)){var e=this.getTabBodyEl(b);e&&mini.addClass(e,"mini-tabs-hideOverflow");b.url=a;delete b.loadedUrl;c&&(b.onload=c);d&&(b.ondestroy=d);var f=this;clearTimeout(this._loadTabTimer);this._loadTabTimer=null;this._loadTabTimer=setTimeout(function(){f._doLoadTab(b)},1)}},reloadTab:function(a){(a=this.getTab(a))||(a=this.getActiveTab());a&&this.loadTab(a.url,a)},getTabRows:function(){for(var a=[],b=[],c=0,d=this.tabs.length;c<d;c++){var e=this.tabs[c];0!=c&&e.newLine&&(a.push(b),b=[]);b.push(e)}a.push(b);return a},doUpdate:function(){if(!1!==this._allowUpdate){this._buttons&&this._buttons.parentNode&&this._buttons.parentNode.removeChild(this._buttons);mini.removeClass(this.el,"mini-tabs-position-left");mini.removeClass(this.el,"mini-tabs-position-top");mini.removeClass(this.el,"mini-tabs-position-right");mini.removeClass(this.el,"mini-tabs-position-bottom");"bottom"==this.tabPosition?(mini.addClass(this.el,"mini-tabs-position-bottom"),this._doUpdateBottom()):"right"==this.tabPosition?(mini.addClass(this.el,"mini-tabs-position-right"),this._doUpdateRight()):"left"==this.tabPosition?(mini.addClass(this.el,"mini-tabs-position-left"),this._doUpdateLeft()):(mini.addClass(this.el,"mini-tabs-position-top"),this._doUpdateTop());var a=this._headerEl,b="mini-tabs-header-";mini.removeClass(a,b+"left");mini.removeClass(a,b+"top");mini.removeClass(a,b+"right");mini.removeClass(a,b+"bottom");mini.addClass(a,b+this.tabPosition);a=this._bodyEl;b="mini-tabs-body-";mini.removeClass(a,b+"left");mini.removeClass(a,b+"top");mini.removeClass(a,b+"right");mini.removeClass(a,b+"bottom");mini.addClass(a,b+this.tabPosition);this._buttons&&(a=mini.byClass("mini-tabs-buttons",this.el))&&(a.appendChild(this._buttons),mini.parse(a));this.doLayout();this.setActiveIndex(this.activeIndex,!1)}},_handleIFrameOverflow:function(){var a=this.getTabBodyEl(this.activeIndex);if(a){mini.removeClass(a,"mini-tabs-hideOverflow");var b=mini.getChildNodes(a)[0];b&&b.tagName&&"IFRAME"==b.tagName.toUpperCase()&&mini.addClass(a,"mini-tabs-hideOverflow")}},doLayout:function(){var a=this._headerEl,b=this._bodyEl,c=this.tabPosition;if(this.canLayout()){a.style.display=this.showHeader?"":"none";this._handleIFrameOverflow();var d=this.isAutoHeight(),e=this.getHeight(!0),f=this.getWidth(),g=e,k=f;b.style.display=this.showBody?"":"none";var l=this.el.firstChild;this.plain?mini.addClass(l,"mini-tabs-plain"):mini.removeClass(l,"mini-tabs-plain");if(!d&&this.showBody){var l=jQuery(a).outerHeight(),n=jQuery(a).outerWidth();if("top"==c||"bottom"==c)l=jQuery(a.parentNode).outerHeight(),--l;"left"==c||"right"==c?f-=n:e-=l;jQuery.boxModel&&(l=mini.getPaddings(b),n=mini.getBorders(b),e=e-l.top-l.bottom-n.top-n.bottom,f=f-l.left-l.right-n.left-n.right);margin=mini.getMargins(b);e=e-margin.top-margin.bottom;f=f-margin.left-margin.right;0>e&&(e=0);0>f&&(f=0);b.style.width=f+"px";b.style.height=e+"px";if("left"==c||"right"==c){for(var p=a.getElementsByTagName("tr")[0],n=p.childNodes,q=n[0].getElementsByTagName("tr"),r=last=all=0,e=0,l=q.length;e<l;e++)p=q[e],p=jQuery(p).outerHeight(),all+=p,0==e&&(r=p),e==l-1&&(last=p);switch(this.tabAlign){case "center":r=parseInt((g-(all-r-last))/2);e=0;for(l=n.length;e<l;e++)n[e].firstChild.style.height=g+"px",q=n[e].firstChild,q=q.getElementsByTagName("tr"),p=q[q.length-1],q[0].style.height=r+"px",p.style.height=r+"px";break;case "right":e=0;for(l=n.length;e<l;e++)q=n[e].firstChild,q=q.getElementsByTagName("tr"),p=q[0],q=g-(all-r),0<=q&&(p.style.height=q+"px");break;case "fit":e=0;for(l=n.length;e<l;e++)n[e].firstChild.style.height=g+"px";break;default:for(e=0,l=n.length;e<l;e++)q=n[e].firstChild,q=q.getElementsByTagName("tr"),p=q[q.length-1],q=g-(all-last),0<=q&&(p.style.height=q+"px")}}}else b.style.width="auto",b.style.height="auto";var t=this.getTabBodyEl(this.activeIndex);if(t)if(!d&&this.showBody){var e=mini.getHeight(b,!0);jQuery.boxModel&&(l=mini.getPaddings(t),n=mini.getBorders(t),e=e-l.top-l.bottom-n.top-n.bottom);t.style.height=e+"px"}else t.style.height="auto";switch(c){case "bottom":d=a.childNodes;e=0;for(l=d.length;e<l;e++)q=d[e],mini.removeClass(q,"mini-tabs-header2"),1<l&&0!=e&&mini.addClass(q,"mini-tabs-header2");break;case "left":n=a.firstChild.rows[0].cells;e=0;for(l=n.length;e<l;e++)d=n[e],mini.removeClass(d,"mini-tabs-header2"),1<l&&0==e&&mini.addClass(d,"mini-tabs-header2");break;case "right":n=a.firstChild.rows[0].cells;e=0;for(l=n.length;e<l;e++)d=n[e],mini.removeClass(d,"mini-tabs-header2"),1<l&&0!=e&&mini.addClass(d,"mini-tabs-header2");break;default:for(d=a.childNodes,e=0,l=d.length;e<l;e++)q=d[e],mini.removeClass(q,"mini-tabs-header2"),1<l&&0==e&&mini.addClass(q,"mini-tabs-header2")}mini.removeClass(this.el,"mini-tabs-scroll");d=mini.byClass("mini-tabs-lastSpace",this.el);e=mini.byClass("mini-tabs-buttons",this.el);l=a.parentNode;l.style.paddingRight="0px";this._navEl&&(this._navEl.style.display="none");this._leftNavEl&&(this._leftNavEl.style.display="none");e&&(e.style.display="none");g="right"==this.buttonsAlign;g||(e.style.right="auto",e.style.left="0");mini.setWidth(l,k);if(!("top"!=c&&"bottom"!=c||"left"!=this.tabAlign&&"right"!=this.tabAlign)){a.style.width="auto";e.style.display="block";c=e.firstChild?e.offsetWidth:0;if(a.firstChild.offsetWidth-d.offsetWidth+c>k){this._navEl.style.display="block";d=this._navEl.offsetWidth;e=0;this.showNavMenu&&(this._headerMenuEl.style.display="inline-block",e=this._headerMenuEl.offsetWidth,this._headerMenuEl.style.right=c+"px",this._headerMenu||this._createHeaderMenu());l=0;"side"==this.arrowPosition&&(this._leftNavEl.style.display="block",l=this._leftNavEl.offsetWidth,a.style.left=l+"px");this._navEl.style.right=(g?c:0)+e+"px";var f=k-c-d-l-e;mini.setWidth(a,f)}else a.style.left="0px";a.style.marginLeft=(g?0:c)+"px"}this._scrollToTab(this.activeIndex);this._doScrollButton();mini.layout(b);(a=this.getActiveTab())&&a.repaint&&t&&(f=t.style.width,t.style.width="0px",setTimeout(function(){t.style.width=f},1));this.fire("layout")}},_getTabBy_Id:function(a){for(var b=0,c=this.tabs.length;b<c;b++){var d=this.tabs[b];if(d._id==a)return d}},_createHeaderMenu:function(){this._headerMenu=new mini.Menu;this._headerMenu.setIdField("_id");this._headerMenu.setTextField("title");this._headerMenu.setPopupEl(this._headerMenuEl);this._headerMenu.setShowAction("leftclick");this._headerMenu.setHideAction("outerclick");this._headerMenu.setXAlign("left");this._headerMenu.setYAlign("below");mini.addClass(this._headerMenu.el,"mini-menu-open");this._headerMenu.on("itemclick",this._doMenuSelectTab,this);this._headerMenu.hide();this._headerMenu.owner=this._headerMenuEl},_setHeaderMenuItems:function(){for(var a=this.getTabs(),b=[],c=0,d=a.length;c<d;c++){var e=a[c];b.push({id:e._id,text:e[this.titleField]})}this._headerMenu.setItems(b)},_doMenuSelectTab:function(a){a=this._getTabBy_Id(a.item.id);this.activeTab(a)},setTabAlign:function(a){this.tabAlign=a;this.doUpdate()},setTabPosition:function(a){this.tabPosition=a;this.doUpdate()},allowClickWrap:!0,setAllowClickWrap:function(a){this.allowClickWrap=a},getAllowClickWrap:function(){return this.allowClickWrap},getTab:function(a){if("object"==typeof a)return a;if("number"==typeof a)return this.tabs[a];for(var b=0,c=this.tabs.length;b<c;b++){var d=this.tabs[b];if(d.name==a)return d}},getHeaderEl:function(){return this._headerEl},getBodyEl:function(){return this._bodyEl},getTabEl:function(a){a=this.getTab(a);if(!a)return null;a=this._createTabId(a);for(var b=this.el.getElementsByTagName("*"),c=0,d=b.length;c<d;c++){var e=b[c];if(e.id==a)return e}return null},getTabBodyEl:function(a){a=this.getTab(a);if(!a)return null;a=this._createTabBodyId(a);for(var b=this._bodyEl.childNodes,c=0,d=b.length;c<d;c++){var e=b[c];if(e.id==a)return e}return null},getTabIFrameEl:function(a){return(a=this.getTab(a))?a._iframeEl:null},_createTabId:function(a){return this.uid+"$"+a._id},_createTabBodyId:function(a){return this.uid+"$body$"+a._id},_doScrollButton:function(){if("top"==this.tabPosition||"bottom"==this.tabPosition){mini.removeClass(this._leftButtonEl,"mini-disabled");mini.removeClass(this._rightButtonEl,"mini-disabled");0==this._headerEl.scrollLeft&&mini.addClass(this._leftButtonEl,"mini-disabled");var a=this.getTabEl(this.tabs.length-1);if(a){var a=mini.getBox(a),b=mini.getBox(this._headerEl);a.right<=b.right&&mini.addClass(this._rightButtonEl,"mini-disabled")}}},setActiveIndex:function(a,b){var c=this.getTab(a),d=this.getTab(this.activeIndex),e=c!=d,f=this.getTabBodyEl(this.activeIndex);f&&(f.style.display="none");this.activeIndex=c?this.tabs.indexOf(c):-1;if(f=this.getTabBodyEl(this.activeIndex))f.style.display="";(f=this.getTabEl(d))&&mini.removeClass(f,this._tabActiveCls);(f=this.getTabEl(c))&&mini.addClass(f,this._tabActiveCls);if(f&&e){"bottom"==this.tabPosition?(d=mini.findParent(f,"mini-tabs-header"))&&jQuery(this._headerEl).prepend(d):"left"==this.tabPosition?(d=mini.findParent(f,"mini-tabs-header").parentNode)&&d.parentNode.appendChild(d):"right"==this.tabPosition?(d=mini.findParent(f,"mini-tabs-header").parentNode)&&jQuery(d.parentNode).prepend(d):(d=mini.findParent(f,"mini-tabs-header"))&&this.allowClickWrap&&this._headerEl.appendChild(d);f=(d=this.getTab(this.activeIndex))?!d._layouted:!1;if(this.isAutoHeight()||f)d&&(d._layouted=!0),this.doLayout(),d&&(d._layouted=!1);1<this.getTabRows().length||(this._scrollToTab(this.activeIndex),this._doScrollButton());d=0;for(f=this.tabs.length;d<f;d++){var g=this.getTabEl(this.tabs[d]);g&&mini.removeClass(g,this._tabHoverCls)}}var k=this;if(e){var l={tab:c,index:this.tabs.indexOf(c),name:c?c.name:""};setTimeout(function(){k.fire("ActiveChanged",l)},1)}this._cancelLoadTabs(c);!1!==b&&c&&c.url&&!c.loadedUrl&&(k=this,k.loadTab(c.url,c));c&&mini.isChrome&&(c=this.getTabIFrameEl(c))&&(c.style.position="relative",c.style.left="1px",c.offsetWidth,c.style.left="0px");if(k.canLayout())try{mini.layoutIFrames(k.el)}catch(n){}},_scrollToTab:function(a){var b=this._headerEl.scrollLeft;if("top"==this.tabPosition||"bottom"==this.tabPosition)if(this._headerEl.scrollLeft=b,a=this.getTabEl(a))a=mini.getBox(a),b=mini.getBox(this._headerEl),a.x<b.x?this._headerEl.scrollLeft-=b.x-a.x:a.right>b.right&&(this._headerEl.scrollLeft+=a.right-b.right)},getActiveIndex:function(){return this.activeIndex},activeTab:function(a){this.setActiveIndex(a)},getActiveTab:function(){return this.getTab(this.activeIndex)},getActiveIndex:function(){return this.activeIndex},_tryActiveTab:function(a){if(a=this.getTab(a)){var b=this.tabs.indexOf(a);this.activeIndex!=b&&(b={tab:a,index:b,name:a.name,cancel:!1},this.fire("BeforeActiveChanged",b),0==b.cancel&&this.activeTab(a))}},setShowHeader:function(a){this.showHeader!=a&&(this.showHeader=a,this.doLayout())},getShowHeader:function(){return this.showHeader},setShowBody:function(a){this.showBody!=a&&(this.showBody=a,this.doLayout())},getShowBody:function(){return this.showBody},setBodyStyle:function(a){this.bodyStyle=a;mini.setStyle(this._bodyEl,a);this.doLayout()},getBodyStyle:function(){return this.bodyStyle},setMaskOnLoad:function(a){this.maskOnLoad=a},getMaskOnLoad:function(){return this.maskOnLoad},setPlain:function(a){this.plain=a;this.doLayout()},getPlain:function(){return this.plain},arrowPosition:"right",setArrowPosition:function(a){this.arrowPosition=a},getArrowPosition:function(){return this.arrowPosition},showNavMenu:!1,setShowNavMenu:function(a){this.showNavMenu=a},getShowNavMenu:function(){return this.showNavMenu},clearTimeStamp:!1,setClearTimeStamp:function(a){this.clearTimeStamp=a},getClearTimeStamp:function(){return this.clearTimeStamp},getTabByEvent:function(a){return this._getTabByEvent(a)},_getTabByEvent:function(a){a=mini.findParent(a.target,"mini-tab");if(!a||a.id.split("$")[0]!=this.uid)return null;a=parseInt(jQuery(a).attr("index"));return this.getTab(a)},__OnDblClick:function(a){if(a=this._getTabByEvent(a))a={tab:a},this.fire("tabdblclick",a)},__OnClick:function(a){var b=this._getTabByEvent(a);if(b){var c=!!mini.findParent(a.target,"mini-tab-close");if((c||b!=this.getActiveTab()||b.refreshOnClick)&&b.enabled){var d=this;setTimeout(function(){if(c)d._OnCloseButtonClick(b,a);else{var e=b.loadedUrl;d._tryActiveTab(b);b.refreshOnClick&&b.url==e&&d.reloadTab(b)}},10)}}},hoverTab:null,__OnMouseOver:function(a){if((a=this._getTabByEvent(a))&&a.enabled){var b=this.getTabEl(a);mini.addClass(b,this._tabHoverCls);this.hoverTab=a}},__OnMouseOut:function(a){this.hoverTab&&(a=this.getTabEl(this.hoverTab),mini.removeClass(a,this._tabHoverCls));this.hoverTab=null},__OnMouseDown:function(a){clearInterval(this._scrollTimer);if("top"==this.tabPosition||"bottom"==this.tabPosition){var b=this,c=0,d=10;a.target==this._leftButtonEl?this._scrollTimer=setInterval(function(){b._headerEl.scrollLeft-=d;c++;5<c&&(d=18);10<c&&(d=25);b._doScrollButton()},25):a.target==this._rightButtonEl?this._scrollTimer=setInterval(function(){b._headerEl.scrollLeft+=d;c++;5<c&&(d=18);10<c&&(d=25);b._doScrollButton()},25):a.target==this._headerMenuEl&&this._setHeaderMenuItems();mini.on(document,"mouseup",this.__OnDocMouseUp,this)}},__OnDocMouseUp:function(a){clearInterval(this._scrollTimer);this._scrollTimer=null;mini.un(document,"mouseup",this.__OnDocMouseUp,this)},_doUpdateTop:function(){var a;a='\x3cdiv class\x3d"mini-tabs-scrollCt"\x3e';a="side"==this.arrowPosition?a+'\x3cdiv class\x3d"mini-tabs-leftnav"\x3e\x3ca class\x3d"mini-tabs-leftButton mini-icon" href\x3d"javascript:void(0)" hideFocus onclick\x3d"return false"\x3e\x3c/a\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-tabs-nav"\x3e\x3ca class\x3d"mini-tabs-rightButton mini-icon" href\x3d"javascript:void(0)" hideFocus onclick\x3d"return false"\x3e\x3c/a\x3e\x3c/div\x3e':a+'\x3cdiv class\x3d"mini-tabs-nav"\x3e\x3ca class\x3d"mini-tabs-leftButton mini-icon" href\x3d"javascript:void(0)" hideFocus onclick\x3d"return false"\x3e\x3c/a\x3e\x3ca class\x3d"mini-tabs-rightButton mini-icon" href\x3d"javascript:void(0)" hideFocus onclick\x3d"return false"\x3e\x3c/a\x3e\x3c/div\x3e';this.showNavMenu&&(a+='\x3ca class\x3d"mini-tabs-tabmenu mini-icon" href\x3d"javascript:void(0)" hideFocus onclick\x3d"return false"\x3e\x3c/a\x3e');a+='\x3cdiv class\x3d"mini-tabs-buttons" a\x3d1 style\x3d"'+("right"==this.buttonsAlign?"":"right:auto;left:0;")+'"\x3e\x3c/div\x3e';a+='\x3cdiv class\x3d"mini-tabs-headers"\x3e';for(var b=this.getTabRows(),c=0,d=b.length;c<d;c++){var e=b[c],f;a+='\x3ctable class\x3d"mini-tabs-header" cellspacing\x3d"0" cellpadding\x3d"0"\x3e\x3ctr\x3e\x3ctd class\x3d"mini-tabs-space mini-tabs-firstSpace"\x3e\x3cdiv\x3e\x3c/div\x3e\x3c/td\x3e';for(var g=0,k=e.length;g<k;g++){var l=e[g],n=this._createTabId(l);if(l.visible){var p=this.tabs.indexOf(l);f=l.headerCls||"";0==l.enabled&&(f+=" mini-disabled");a+='\x3ctd title\x3d"'+l.tooltip+'" id\x3d"'+n+'" index\x3d"'+p+'"  class\x3d"mini-tab mini-corner-all '+f+'" style\x3d"'+l.headerStyle+'"\x3e';if(l.iconCls||l.iconStyle)a+='\x3cspan class\x3d"mini-tab-icon mini-iconfont '+l.iconCls+'" style\x3d"'+l.iconStyle+'"\x3e\x3c/span\x3e';a+='\x3cspan class\x3d"mini-tab-text"\x3e'+l.title+"\x3c/span\x3e";l.showCloseButton&&(f="",l.enabled&&(f="onmouseover\x3d\"mini.addClass(this, 'mini-tab-close-hover')\" onmouseout\x3d\"mini.removeClass(this, 'mini-tab-close-hover')\""),a+='\x3cspan class\x3d"mini-tab-close mini-icon" '+f+" \x3e\x3c/span\x3e");a+="\x3c/td\x3e";g!=k-1&&(a+='\x3ctd class\x3d"mini-tabs-space2"\x3e\x3cdiv\x3e\x3c/div\x3e\x3c/td\x3e')}}a+='\x3ctd class\x3d"mini-tabs-space mini-tabs-lastSpace" \x3e\x3cdiv\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e'}a+="\x3c/div\x3e\x3c/div\x3e";this._doClearElement();mini.prepend(this._td2El,a);g=this._td2El;this._headerEl=g.firstChild.lastChild;"side"==this.arrowPosition?(this._leftNavEl=g.firstChild.firstChild,this._navEl=this._headerEl.parentNode.children[1],this._leftButtonEl=this._leftNavEl.firstChild,this._rightButtonEl=this._navEl.firstChild,this.showNavMenu&&(this._headerMenuEl=this._headerEl.parentNode.children[2])):(this._navEl=this._headerEl.parentNode.firstChild,this._leftButtonEl=this._navEl.firstChild,this._rightButtonEl=this._navEl.childNodes[1],this.showNavMenu&&(this._headerMenuEl=this._headerEl.parentNode.children[1]));switch(this.tabAlign){case "center":a=this._headerEl.childNodes;g=0;for(k=a.length;g<k;g++)b=a[g],b=b.getElementsByTagName("td"),b[0].style.width="50%",b[b.length-1].style.width="50%";break;case "right":a=this._headerEl.childNodes;g=0;for(k=a.length;g<k;g++)b=a[g],b=b.getElementsByTagName("td"),b[0].style.width="100%";break;case "fit":break;default:for(a=this._headerEl.childNodes,g=0,k=a.length;g<k;g++)b=a[g],b=b.getElementsByTagName("td"),b[b.length-1].style.width="100%"}},_doUpdateBottom:function(){this._doUpdateTop();var a=this._td2El;mini.append(a,a.firstChild);this._headerEl=a.lastChild.lastChild},_doUpdateLeft:function(){for(var a='\x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\x3ctr\x3e',b=this.getTabRows(),c=0,d=b.length;c<d;c++){var e=b[c],f="";1<d&&c!=d-1&&(f="mini-tabs-header2");for(var a=a+('\x3ctd class\x3d"'+f+'"\x3e\x3ctable class\x3d"mini-tabs-header" cellspacing\x3d"0" cellpadding\x3d"0"\x3e'),a=a+'\x3ctr \x3e\x3ctd class\x3d"mini-tabs-space mini-tabs-firstSpace" \x3e\x3cdiv\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e',g=0,k=e.length;g<k;g++){var l=e[g],n=this._createTabId(l);if(l.visible){var p=this.tabs.indexOf(l),f=l.headerCls||"";0==l.enabled&&(f+=" mini-disabled");a+='\x3ctr\x3e\x3ctd id\x3d"'+n+'" index\x3d"'+p+'"  class\x3d"mini-tab '+f+'" style\x3d"'+l.headerStyle+'"\x3e';if(l.iconCls||l.iconStyle)a+='\x3cspan class\x3d"mini-tab-icon mini-iconfont '+l.iconCls+'" style\x3d"'+l.iconStyle+'"\x3e\x3c/span\x3e';a+='\x3cspan class\x3d"mini-tab-text"\x3e'+l.title+"\x3c/span\x3e";l.showCloseButton&&(f="",l.enabled&&(f="onmouseover\x3d\"mini.addClass(this, 'mini-tab-close-hover')\" onmouseout\x3d\"mini.removeClass(this, 'mini-tab-close-hover')\""),a+='\x3cspan class\x3d"mini-tab-close mini-icon" '+f+"\x3e\x3c/span\x3e");a+="\x3c/td\x3e\x3c/tr\x3e";g!=k-1&&(a+='\x3ctr\x3e\x3ctd class\x3d"mini-tabs-space2"\x3e\x3cdiv\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e')}}a+='\x3ctr \x3e\x3ctd class\x3d"mini-tabs-space mini-tabs-lastSpace" \x3e\x3cdiv\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e';a+="\x3c/table\x3e\x3c/td\x3e"}a+="\x3c/tr \x3e\x3c/table\x3e";this._doClearElement();mini.addClass(this._td1El,"mini-tabs-header");mini.append(this._td1El,a);this._headerEl=this._td1El},_doUpdateRight:function(){this._doUpdateLeft();mini.removeClass(this._td1El,"mini-tabs-header");mini.removeClass(this._td3El,"mini-tabs-header");mini.append(this._td3El,this._td1El.firstChild);this._headerEl=this._td3El},_OnCloseButtonClick:function(a,b){var c={tab:a,index:this.tabs.indexOf(a),name:a.name.toLowerCase(),htmlEvent:b,cancel:!1};this.fire("beforecloseclick",c);if(1!=c.cancel){try{if(a._iframeEl&&a._iframeEl.contentWindow){var d=!0;a._iframeEl.contentWindow.CloseWindow?d=a._iframeEl.contentWindow.CloseWindow("close"):a._iframeEl.contentWindow.CloseOwnerWindow&&(d=a._iframeEl.contentWindow.CloseOwnerWindow("close"));!1===d&&(c.cancel=!0)}}catch(e){}1!=c.cancel&&(a.removeAction="close",this.removeTab(a),this.fire("closeclick",c))}},onBeforeCloseClick:function(a,b){this.on("beforecloseclick",a,b)},onCloseClick:function(a,b){this.on("closeclick",a,b)},onActiveChanged:function(a,b){this.on("activechanged",a,b)},getAttrs:function(a){var b=mini.Tabs.superclass.getAttrs.call(this,a);mini._ParseString(a,b,"tabAlign tabPosition bodyStyle onactivechanged onbeforeactivechanged url ontabload ontabdestroy onbeforecloseclick oncloseclick ontabdblclick titleField urlField nameField loadingMsg buttons arrowPosition buttonsAlign".split(" "));mini._ParseBool(a,b,"allowAnim showBody showHeader maskOnLoad plain allowClickWrap showNavMenu clearTimeStamp".split(" "));mini._ParseInt(a,b,["activeIndex"]);var c=[];a=mini.getChildNodes(a);for(var d=0,e=a.length;d<e;d++){var f=a[d],g={};c.push(g);g.style=f.style.cssText;mini._ParseString(f,g,"name title url cls iconCls iconStyle headerCls headerStyle bodyCls bodyStyle onload ondestroy data-options tooltip".split(" "));mini._ParseBool(f,g,["newLine","visible","enabled","showCloseButton","refreshOnClick"]);g.bodyParent=f;(f=g["data-options"])&&(f=window.eval("("+f+")"))&&mini.copyTo(g,f)}b.tabs=c;return b}});mini.regClass(mini.Tabs,"tabs");mini.Menu=function(){this.items=[];mini.Menu.superclass.constructor.apply(this,arguments)};mini.extend(mini.Menu,mini.Control);mini.copyTo(mini.Menu.prototype,mini.Popup_prototype);var mini_Popup_prototype_hide=mini.Popup_prototype.hide;mini.copyTo(mini.Menu.prototype,{height:"auto",width:"auto",minWidth:140,vertical:!0,allowSelectItem:!1,_selectedItem:null,_itemSelectedCls:"mini-menuitem-selected",textField:"text",resultAsTree:!1,idField:"id",parentField:"pid",itemsField:"children",iconClsField:"iconCls",showNavArrow:!0,imgPath:"",overflow:!1,_clearBorder:!1,showAction:"none",hideAction:"outerclick",menuAlign:"",setMenuAlign:function(a){this.menuAlign=a},getMenuAlign:function(){return this.menuAlign},getbyName:function(a){for(var b=0,c=this.items.length;b<c;b++){var d=this.items[b];if(d.name==a||d.menu&&(d=d.menu.getbyName(a)))return d}return null},set:function(a){if("string"==typeof a)return this;var b=a.url;delete a.url;a.imgPath&&this.setImgPath(a.imgPath);delete a.imgPath;this.ownerItem=a.ownerItem;delete a.ownerItem;mini.Menu.superclass.set.call(this,a);b&&this.setUrl(b);return this},uiCls:"mini-menu",_create:function(){this.el=document.createElement("div");this.el.className="mini-menu";this.el.innerHTML='\x3cdiv class\x3d"mini-menu-border"\x3e\x3ca class\x3d"mini-menu-topArrow mini-icon" href\x3d"#" onclick\x3d"return false"\x3e\x3c/a\x3e\x3cdiv class\x3d"mini-menu-inner"\x3e\x3c/div\x3e\x3ca class\x3d"mini-menu-bottomArrow mini-icon" href\x3d"#" onclick\x3d"return false"\x3e\x3c/a\x3e\x3c/div\x3e';this._borderEl=this.el.firstChild;this._topArrowEl=this._borderEl.childNodes[0];this._bottomArrowEl=this._borderEl.childNodes[2];this._innerEl=this._borderEl.childNodes[1];this._innerEl.innerHTML='\x3cdiv class\x3d"mini-menu-float"\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-menu-toolbar"\x3e\x3c/div\x3e\x3cdiv style\x3d"clear:both;max-height: 1px;"\x3e\x3c/div\x3e';this._contentEl=this._innerEl.firstChild;this._toolbarEl=this._innerEl.childNodes[1];0==this.isVertical()&&mini.addClass(this.el,"mini-menu-horizontal")},destroy:function(a){if(this.items)for(var b=0,c=this.items.length;b<c;b++)this.items[b].destroy();this._topArrowEl&&(this._topArrowEl.onmousedown=this._bottomArrowEl.onmousedown=null);this.window=this.owner=this._topArrowEl=this._bottomArrowEl=this._popupEl=this.popupEl=this._borderEl=this._innerEl=this._contentEl=this._toolbarEl=null;mini.un(document,"mousedown",this.__OnBodyMouseDown,this);mini.un(window,"resize",this.__OnWindowResize,this);mini.Menu.superclass.destroy.call(this,a)},_disableContextMenu:!1,_initEvents:function(){mini._BindEvents(function(){mini.on(document,"mousedown",this.__OnBodyMouseDown,this);mini_onOne(this.el,"mouseover",this.__OnMouseOver,this);mini.on(window,"resize",this.__OnWindowResize,this);this._disableContextMenu&&mini_onOne(this.el,"contextmenu",function(a){a.preventDefault()},this);mini_onOne(this._topArrowEl,"mousedown",this.__OnTopMouseDown,this);mini_onOne(this._bottomArrowEl,"mousedown",this.__OnBottomMouseDown,this)},this)},within:function(a){if(mini.isAncestor(this.el,a.target))return!0;for(var b=0,c=this.items.length;b<c;b++)if(this.items[b].within(a))return!0;return!1},setVertical:function(a){(this.vertical=a)?mini.removeClass(this.el,"mini-menu-horizontal"):mini.addClass(this.el,"mini-menu-horizontal")},getVertical:function(){return this.vertical},isVertical:function(){return this.vertical},show:function(){this.setVisible(!0)},hide:function(){this.hideItems();mini_Popup_prototype_hide.call(this)},hideItems:function(){for(var a=0,b=this.items.length;a<b;a++)this.items[a].hideMenu()},showItemMenu:function(a){for(var b=0,c=this.items.length;b<c;b++){var d=this.items[b];d==a?d.showMenu():d.hideMenu()}},hasShowItemMenu:function(){for(var a=0,b=this.items.length;a<b;a++){var c=this.items[a];if(c&&c.menu&&c.menu.isPopup)return!0}return!1},setData:function(a){mini.isArray(a)||(a=[]);this.setItems(a)},getData:function(){return this.getItems()},setItems:function(a){mini.isArray(a)||(a=[]);this.removeAll();for(var b=0,c=a.length;b<c;b++)this.addItem(a[b])},getItems:function(){return this.items},_itemType:"menuitem",addItem:function(a){"-"==a||"|"==a||"separator"==a.type?mini.append(this._contentEl,"\x3cspan "+(a.id?'id\x3d"'+a.id+'"':"")+' name\x3d"'+(a.name||"")+'" class\x3d"mini-separator"\x3e\x3c/span\x3e'):(mini.isControl(a)||mini.getClass(a.type)||(a.type=this._itemType),a.ownerMenu=this,a=mini.getAndCreate(a),this.items.push(a),this._contentEl.appendChild(a.el),a.ownerMenu=this,this.fire("itemschanged"))},removeItem:function(a){if(a=mini.get(a))this.items.remove(a),this._contentEl.removeChild(a.el),this.fire("itemschanged")},removeItemAt:function(a){this.removeItem(this.items[a])},removeAll:function(){for(var a=this.items.clone(),b=a.length-1;0<=b;b--)this.removeItem(a[b]);this._contentEl.innerHTML=""},getGroupItems:function(a){if(!a)return[];for(var b=[],c=0,d=this.items.length;c<d;c++){var e=this.items[c];e.groupName==a&&b.push(e)}return b},getItem:function(a){if("number"==typeof a)return this.items[a];if("string"==typeof a){for(var b=0,c=this.items.length;b<c;b++){var d=this.items[b];if(d.id==a)return d}return null}return a&&-1!=this.items.indexOf(a)?a:null},setAllowSelectItem:function(a){this.allowSelectItem=a},getAllowSelectItem:function(){return this.allowSelectItem},setSelectedItem:function(a){a=this.getItem(a);this._OnItemSelect(a)},getSelectedItem:function(a){return this._selectedItem},setShowNavArrow:function(a){this.showNavArrow=a},getShowNavArrow:function(){return this.showNavArrow},setTextField:function(a){this.textField=a},getTextField:function(){return this.textField},setResultAsTree:function(a){this.resultAsTree=a},getResultAsTree:function(){return this.resultAsTree},setIdField:function(a){this.idField=a},getIdField:function(){return this.idField},setParentField:function(a){this.parentField=a},getParentField:function(){return this.parentField},setIconClsField:function(a){this.iconClsField=a},getIconClsField:function(){return this.iconClsField},setOverflow:function(a){(this.overflow=a)?mini.addClass(this.el,"mini-menu-overflow"):mini.removeClass(this.el,"mini-menu-overflow")},getOverflow:function(){return this.overflow},doLayout:function(){if(this.canLayout()){var a=this._innerEl,b=this._topArrowEl,c=this._bottomArrowEl;if(this.isAutoHeight())this._borderEl.style.height="auto",this._contentEl.style.height="auto";else{var d=mini.getHeight(this.el,!0);mini.setHeight(this._borderEl,d);b.style.display=c.style.display="none";this._contentEl.style.height="auto";if(this.showNavArrow&&this._borderEl.scrollHeight>this._borderEl.clientHeight+2){b.style.display=c.style.display="block";var d=mini.getHeight(this._borderEl,!0),e=mini.getHeight(b),f=mini.getHeight(c),d=d-e-f;0>d&&(d=0);mini.setHeight(this._contentEl,d);d=mini.getWidth(this._borderEl,!0);mini.setWidth(b,d);mini.setWidth(c,d)}else this._contentEl.style.height="auto"}this.overflow&&(b.style.display=c.style.display="none",a.style.marginLeft=a.style.marginRight="0px",this._getScrollWidth()>this._innerEl.offsetWidth?(b.style.display=c.style.display="block",a.style.marginLeft=a.style.marginRight="15px"):a.scrollLeft=0)}},_measureSize:function(){if("auto"==this.height){this.el.style.height="auto";this._borderEl.style.height="auto";this._contentEl.style.height="auto";this._topArrowEl.style.display=this._bottomArrowEl.style.display="none";var a=mini.getViewportBox();mini.getBox(this.el);this.maxHeight=a.height-2;this.ownerItem&&(this.maxHeight=a.height-2)}this.el.style.display="";a=mini.getBox(this.el);a.width>this.maxWidth&&(mini.setWidth(this.el,this.maxWidth),a=mini.getBox(this.el));a.height>this.maxHeight&&(mini.setHeight(this.el,this.maxHeight),a=mini.getBox(this.el));a.width<this.minWidth&&(mini.setWidth(this.el,this.minWidth),a=mini.getBox(this.el));a.height<this.minHeight&&(mini.setHeight(this.el,this.minHeight),mini.getBox(this.el))},url:"",_doLoad:function(){var a=mini._getResult(this.url,null,null,null,null,this.dataField);this.dataField&&!mini.isArray(a)&&(a=mini._getMap(this.dataField,a));a||(a=[]);0==this.resultAsTree&&(a=mini.arrayToTree(a,this.itemsField,this.idField,this.parentField));for(var b=mini.treeToArray(a,this.itemsField,this.idField,this.parentField),c=0,d=b.length;c<d;c++){var e=b[c];e.text=mini._getMap(this.textField,e);e.iconCls=mini._getMap(this.iconClsField,e);mini.isNull(e.text)&&(e.text="")}this.setItems(a);this.fire("load")},loadList:function(a,b,c){if(a){b=b||this.idField;c=c||this.parentField;for(var d=0,e=a.length;d<e;d++){var f=a[d];f.text=mini._getMap(this.textField,f);f.iconCls=mini._getMap(this.iconClsField,f);mini.isNull(f.text)&&(f.text="")}a=mini.arrayToTree(a,this.itemsField,b,c);this.load(a)}},load:function(a){"string"==typeof a?this.setUrl(a):this.setItems(a)},setUrl:function(a){this.url=a;this._doLoad()},getUrl:function(){return this.url},hideOnClick:!0,setHideOnClick:function(a){this.hideOnClick=a},getHideOnClick:function(){return this.hideOnClick},hideOnClick:!0,setImgPath:function(a){this.imgPath=a},getImgPath:function(){return this.imgPath},_OnItemClick:function(a,b){var c={item:a,isLeaf:!a.menu,htmlEvent:b};this.hideOnClick&&(this.isPopup?this.hide():c.isLeaf&&this.hideItems());this.allowSelectItem&&this._selectedItem!=a&&this.setSelectedItem(a);this.fire("itemclick",c)},_OnItemSelect:function(a){this._selectedItem&&this._selectedItem.removeCls(this._itemSelectedCls);(this._selectedItem=a)&&this._selectedItem.addCls(this._itemSelectedCls);this.fire("itemselect",{item:this._selectedItem,isLeaf:this._selectedItem?!this._selectedItem.menu:!1})},onItemClick:function(a,b){this.on("itemclick",a,b)},onItemSelect:function(a,b){this.on("itemselect",a,b)},__OnTopMouseDown:function(a){this._startScrollMove(-20)},__OnBottomMouseDown:function(a){this._startScrollMove(20)},_getScrollWidth:function(){var a=0,b=jQuery(".mini-menuitem",this.el).first()[0],c=jQuery(".mini-menuitem",this.el).last()[0];b&&c&&(a=mini.getBox(b),a=mini.getBox(c).right-a.left);return a},_getMaxScrollLeft:function(){return parseInt(this._getScrollWidth()-this._innerEl.offsetWidth+6)},_startScrollMove:function(a){clearInterval(this._scrollTimer);var b=function(){clearInterval(d._scrollTimer);mini.un(document,"mouseup",b)};mini.on(document,"mouseup",b);var c=this._getMaxScrollLeft(),d=this;this._scrollTimer=setInterval(function(){if(0==d.isVertical()){var b=d._innerEl.scrollLeft,b=b+a;b>c&&(b=c);d._innerEl.scrollLeft=b}else d._contentEl.scrollTop+=a},50)},setToolbar:function(a){__mini_setControls(a,this._toolbarEl,this);this._toolbarEl.style.display="block"},parseItems:function(a){for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c];if("separator"==e.className)var f={type:"separator",id:e.id,name:e.name};else{var f=mini.getChildNodes(e),g=f[0],k=f[1],f=new mini.MenuItem;k?(mini.applyTo.call(f,g),f.render(document.body),e=new mini.Menu,mini.applyTo.call(e,k),f.setMenu(e),e.render(document.body)):mini.applyTo.call(f,e)}b.add(f)}return b.clone()},getAttrs:function(a){var b=mini.Menu.superclass.getAttrs.call(this,a),c=jQuery(a);mini._ParseString(a,b,"popupEl popupCls showAction hideAction xAlign yAlign modalStyle onbeforeopen open onbeforeclose onclose url onitemclick onitemselect textField idField parentField toolbar imgPath iconClsField menuAlign".split(" "));mini._ParseBool(a,b,["resultAsTree","hideOnClick","showNavArrow","showShadow","overflow"]);for(var d=mini.getChildNodes(a),e=d.length-1;0<=e;e--){var f=d[e],g=jQuery(f).attr("property");g&&(g=g.toLowerCase(),"toolbar"==g&&(b.toolbar=f,f.parentNode.removeChild(f)))}d=mini.getChildNodes(a);a=this.parseItems(d);0<a.length&&(b.items=a);if(a=c.attr("vertical"))b.vertical="true"==a?!0:!1;if(c=c.attr("allowSelectItem"))b.allowSelectItem="true"==c?!0:!1;return b}});mini.regClass(mini.Menu,"menu");mini.MenuBar=function(){mini.MenuBar.superclass.constructor.apply(this,arguments)};mini.extend(mini.MenuBar,mini.Menu,{uiCls:"mini-menubar",vertical:!1,setVertical:function(a){this.vertical=!1}});mini.regClass(mini.MenuBar,"menubar");mini.ContextMenu=function(){mini.ContextMenu.superclass.constructor.apply(this,arguments)};mini.extend(mini.ContextMenu,mini.Menu,{uiCls:"mini-contextmenu",vertical:!0,visible:!1,_disableContextMenu:!0,setVertical:function(a){this.vertical=!0}});mini.regClass(mini.ContextMenu,"contextmenu");mini.MenuItem=function(){mini.MenuItem.superclass.constructor.apply(this,arguments)};mini.extend(mini.MenuItem,mini.Control,{text:"",iconCls:"",iconStyle:"",iconPosition:"left",img:"",showIcon:!0,showAllow:!0,checked:!1,checkOnClick:!1,groupName:"",_hoverCls:"mini-menuitem-hover",_pressedCls:"mini-menuitem-pressed",_checkedCls:"mini-menuitem-checked",_clearBorder:!1,menu:null,set:function(a){if("string"==typeof a)return this;this.ownerMenu=a.ownerMenu;delete a.ownerMenu;mini.MenuItem.superclass.set.call(this,a);return this},uiCls:"mini-menuitem",_create:function(){this.el=document.createElement("div");this.el.className="mini-menuitem";this.el.innerHTML='\x3cdiv class\x3d"mini-menuitem-inner"\x3e\x3cdiv class\x3d"mini-menuitem-icon mini-icon mini-iconfont"\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-menuitem-text"\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-menuitem-allow mini-icon"\x3e\x3c/div\x3e\x3c/div\x3e';this._innerEl=this.el.firstChild;this._iconEl=this._innerEl.firstChild;this._textEl=this._innerEl.childNodes[1];this.allowEl=this._innerEl.lastChild},_initEvents:function(){mini._BindEvents(function(){mini_onOne(this.el,"mouseover",this.__OnMouseOver,this)},this)},_inputEventsInited:!1,_initInputEvents:function(){this._inputEventsInited||(this._inputEventsInited=!0,mini_onOne(this.el,"click",this.__OnClick,this),mini_onOne(this.el,"mouseup",this.__OnMouseUp,this),mini_onOne(this.el,"mouseout",this.__OnMouseOut,this))},destroy:function(a){this.menu&&this.menu.destroy();this.menu=this._innerEl=this._iconEl=this._textEl=this.allowEl=null;mini.MenuItem.superclass.destroy.call(this,a)},within:function(a){return mini.isAncestor(this.el,a.target)||this.menu&&this.menu.within(a)?!0:!1},_getIconImg:function(){return this.img&&this.getTopMenu()?this.getTopMenu().imgPath+this.img:this.img},_doUpdateIcon:function(){var a=this._getIconImg(),b=!!(this.iconStyle||this.iconCls||this.checkOnClick||a);this._iconEl&&(mini.setStyle(this._iconEl,this.iconStyle),mini.addClass(this._iconEl,this.iconCls),a&&!this.checked&&mini.setStyle(this._iconEl,"background-image:url("+a+")"),this.checked&&jQuery(this._iconEl).css({"background-image":""}),this._iconEl.style.display=b?"block":"none");"top"==this.iconPosition?mini.addClass(this.el,"mini-menuitem-icontop"):mini.removeClass(this.el,"mini-menuitem-icontop")},_hasChildMenu:function(){return this.menu&&0<this.menu.items.length},doUpdate:function(){this._textEl&&(this._textEl.innerHTML=this.text);this._doUpdateIcon();this.checked?(mini.addClass(this.el,this._checkedCls),jQuery(this._iconEl).css({"background-image":""})):mini.removeClass(this.el,this._checkedCls);this.allowEl&&(this._hasChildMenu()?this.allowEl.style.display="block":this.allowEl.style.display="none")},setText:function(a){this.text=a;this._textEl&&(this._textEl.innerHTML=this.text)},getText:function(){return this.text},setIconCls:function(a){mini.removeClass(this._iconEl,this.iconCls);this.iconCls=a;this._doUpdateIcon()},getIconCls:function(){return this.iconCls},setImg:function(a){this.img=a;this._doUpdateIcon()},getImg:function(){return this.img},setIconStyle:function(a){this.iconStyle=a;this._doUpdateIcon()},getIconStyle:function(){return this.iconStyle},setIconPosition:function(a){this.iconPosition=a;this._doUpdateIcon()},getIconPosition:function(){return this.iconPosition},setCheckOnClick:function(a){(this.checkOnClick=a)?mini.addClass(this.el,"mini-menuitem-showcheck"):mini.removeClass(this.el,"mini-menuitem-showcheck");this.doUpdate()},getCheckOnClick:function(){return this.checkOnClick},setChecked:function(a){this.checked!=a&&(this.checked=a,this.doUpdate(),this.fire("checkedchanged"))},getChecked:function(){return this.checked},setGroupName:function(a){this.groupName!=a&&(this.groupName=a)},getGroupName:function(){return this.groupName},setChildren:function(a){this.setMenu(a)},setMenu:function(a){mini.isArray(a)&&(a={type:"menu",items:a});this.menu!==a&&(a.ownerItem=this,this.menu=mini.getAndCreate(a),this.menu.hide(),this.menu.ownerItem=this,this.doUpdate(),this.menu.on("itemschanged",this.__OnItemsChanged,this))},getMenu:function(){return this.menu},showMenu:function(){if(this.menu&&0==this.menu.isDisplay()){this.menu.setHideAction("outerclick");var a={xAlign:"outright",yAlign:"top",popupCls:"mini-menu-popup",alwaysView:!0};this.ownerMenu&&0==this.ownerMenu.vertical&&(a.xAlign=this.ownerMenu.menuAlign||"left",a.yAlign="below",a.outXAlign="right");this.menu.showAtEl(this.el,a);this.menu.addCls("mini-menu-open")}},hideMenu:function(){this.menu&&this.menu.hide()},hide:function(){this.hideMenu();this.setVisible(!1)},__OnItemsChanged:function(a){this.doUpdate()},getTopMenu:function(){return this.ownerMenu?this.ownerMenu.ownerItem?this.ownerMenu.ownerItem.getTopMenu():this.ownerMenu:null},__OnClick:function(a){if(!this.isReadOnly()){if(this.checkOnClick)if(this.ownerMenu&&this.groupName){var b=this.ownerMenu.getGroupItems(this.groupName);if(0<b.length){if(0==this.checked){for(var c=0,d=b.length;c<d;c++){var e=b[c];e!=this&&e.setChecked(!1)}this.setChecked(!0)}}else this.setChecked(!this.checked)}else this.setChecked(!this.checked);this.fire("click");(b=this.getTopMenu())&&b._OnItemClick(this,a)}},__OnMouseUp:function(a){if(!this.isReadOnly()&&this.ownerMenu){var b=this;setTimeout(function(){b.isDisplay()&&b.ownerMenu.showItemMenu(b)},1)}},__OnMouseOver:function(a){this.isReadOnly()||(this._initInputEvents(),mini.addClass(this.el,this._hoverCls),this.el.title=this.text,this.el.title=this._textEl.scrollWidth>this._textEl.clientWidth?this.text:"",this.ownerMenu&&(1==this.ownerMenu.isVertical()?this.ownerMenu.showItemMenu(this):this.ownerMenu.hasShowItemMenu()&&this.ownerMenu.showItemMenu(this)))},__OnMouseOut:function(a){mini.removeClass(this.el,this._hoverCls)},onClick:function(a,b){this.on("click",a,b)},onCheckedChanged:function(a,b){this.on("checkedchanged",a,b)},getAttrs:function(a){var b=mini.MenuItem.superclass.getAttrs.call(this,a);jQuery(a);b.text=a.innerHTML;mini._ParseString(a,b,"text iconCls iconStyle iconPosition groupName onclick oncheckedchanged".split(" "));mini._ParseBool(a,b,["checkOnClick","checked"]);return b}});mini.regClass(mini.MenuItem,"menuitem");mini.Separator=function(){mini.Separator.superclass.constructor.apply(this,arguments)};mini.extend(mini.Separator,mini.Control,{_clearBorder:!1,uiCls:"mini-separator",_create:function(){this.el=document.createElement("span");this.el.className="mini-separator"}});mini.regClass(mini.Separator,"separator");mini.Pager=function(){mini.Pager.superclass.constructor.apply(this,arguments)};mini.extend(mini.Pager,mini.Control,{pageIndex:0,pageSize:10,totalCount:0,totalPage:0,showPageIndex:!0,showPageSize:!0,showTotalCount:!0,showPageInfo:!0,showReloadButton:!0,_clearBorder:!1,showButtonText:!1,showButtonIcon:!0,sizeText:"",firstText:"\u9996\u9875",prevText:"\u4e0a\u4e00\u9875",nextText:"\u4e0b\u4e00\u9875",lastText:"\u5c3e\u9875",reloadText:"\u5237\u65b0",pageInfoText:"\u6bcf\u9875 {0} \u6761, \u5171 {1} \u6761",sizeList:[10,20,50,100],set:function(a){if("string"==typeof a)return this;var b=a.pageIndex;delete a.pageIndex;mini.Pager.superclass.set.call(this,a);mini.isNull(b)||this.setPageIndex(b);return this},uiCls:"mini-pager",_create:function(){this.el=document.createElement("div");this.el.className="mini-pager";var a='\x3cdiv class\x3d"mini-pager-left"\x3e\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0"\x3e\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-pager-right"\x3e\x3c/div\x3e';if(isIE6||isIE7)a+='\x3cdiv class\x3d"mini-clearfix"\x3e\x3c/div\x3e',mini.addClass(this.el,"mini-clearfix");this.el.innerHTML=a;this._leftEl=this.el.childNodes[0];this._rightEl=this.el.childNodes[1];a=this._leftEl.getElementsByTagName("td");this._barEl=a[0];this._barEl2=a[1];this.sizeEl=mini.append(this._barEl,'\x3cspan class\x3d"mini-pager-size"\x3e\x3c/span\x3e');this.sizeTextEl=mini.before(this.sizeEl,'\x3cspan class\x3d"mini-pager-sizetext"\x3e\x3c/span\x3e');this.sizeCombo=new mini.ComboBox;this.pageSizeWidth&&this.sizeCombo.setWidth(this.pageSizeWidth);this.sizeCombo.render(this.sizeEl);mini.append(this.sizeEl,'\x3cspan class\x3d"separator"\x3e\x3c/span\x3e');this.firstButton=new mini.Button;this.firstButton.addCls("mini-pager-firstbutton");this.firstButton.render(this._barEl);this.prevButton=new mini.Button;this.prevButton.addCls("mini-pager-prevbutton");this.prevButton.render(this._barEl);this.indexEl=document.createElement("span");this.indexEl.className="mini-pager-index";this.indexEl.innerHTML='\x3cinput type\x3d"text" class\x3d"mini-pager-num"/\x3e\x3cspan class\x3d"mini-pager-pages"\x3e/ 0\x3c/span\x3e';this._barEl.appendChild(this.indexEl);this.numInput=this.indexEl.firstChild;this.pagesLabel=this.indexEl.lastChild;this.nextButton=new mini.Button;this.nextButton.addCls("mini-pager-nextbutton");this.nextButton.render(this._barEl);this.lastButton=new mini.Button;this.lastButton.addCls("mini-pager-lastbutton");this.lastButton.render(this._barEl);mini.append(this._barEl,'\x3cspan class\x3d"separator"\x3e\x3c/span\x3e');this.reloadButton=new mini.Button;this.reloadButton.render(this._barEl);this.firstButton.setPlain(!0);this.prevButton.setPlain(!0);this.nextButton.setPlain(!0);this.lastButton.setPlain(!0);this.reloadButton.setPlain(!0);this.buttonsEl=mini.append(this._barEl2,'\x3cdiv class\x3d"mini-page-buttons"\x3e\x3c/div\x3e');this.update()},destroy:function(a){this.pageSelect&&(mini.clearEvent(this.pageSelect),this.pageSelect=null);this.numInput&&(mini.clearEvent(this.numInput),this.numInput=null);this.sizeEl=this.sizeTextEl=this._barEl=this._barEl2=this._leftEl=this._rightEl=this.indexEl=this.buttonsEl=null;mini.Pager.superclass.destroy.call(this,a)},setButtons:function(a){__mini_setControls(a,this.buttonsEl,this)},getButtonsEl:function(){return this.buttonsEl},_initEvents:function(){function a(){if(!b){b=!0;var a=parseInt(this.numInput.value);isNaN(a)?this.update():this._OnPageChanged(a-1);setTimeout(function(){b=!1},100)}}mini.Pager.superclass._initEvents.call(this);this.firstButton.on("click",function(a){this._OnPageChanged(0)},this);this.prevButton.on("click",function(a){this._OnPageChanged(this.pageIndex-1)},this);this.nextButton.on("click",function(a){this._OnPageChanged(this.pageIndex+1)},this);this.lastButton.on("click",function(a){this._OnPageChanged(this.totalPage)},this);this.reloadButton.on("click",function(a){this._OnPageChanged()},this);var b=!1;mini.on(this.numInput,"change",function(b){a.call(this)},this);mini.on(this.numInput,"keydown",function(b){13==b.keyCode&&(a.call(this),b.stopPropagation())},this);this.sizeCombo.on("valuechanged",this.__OnPageSelectChanged,this)},doLayout:function(){this.canLayout()&&(mini.layout(this._leftEl),mini.layout(this._rightEl))},setPageIndex:function(a){isNaN(a)||(this.pageIndex=a,this.update())},getPageIndex:function(){return this.pageIndex},setPageSize:function(a){isNaN(a)||(this.pageSize=a,this.update())},getPageSize:function(){return this.pageSize},setTotalCount:function(a){a=parseInt(a);isNaN(a)||(this.totalCount=a,this.update())},getTotalCount:function(){return this.totalCount},setSizeList:function(a){mini.isArray(a)&&(this.sizeList=a,this.update())},getSizeList:function(){return this.sizeList},pageSizeWidth:null,setPageSizeWidth:function(a){a=parseInt(a);isNaN(a)||this.pageSizeWidth==a||(this.pageSizeWidth=a,this.sizeCombo.setWidth(a))},getPageSizeWidth:function(){return this.pageSizeWidth},setShowPageSize:function(a){this.showPageSize=a;this.update()},getShowPageSize:function(){return this.showPageSize},setShowPageIndex:function(a){this.showPageIndex=a;this.update()},getShowPageIndex:function(){return this.showPageIndex},setShowTotalCount:function(a){this.showTotalCount=a;this.update()},getShowTotalCount:function(){return this.showTotalCount},setShowPageInfo:function(a){this.showPageInfo=a;this.update()},getShowPageInfo:function(){return this.showPageInfo},setShowReloadButton:function(a){this.showReloadButton=a;this.update()},getShowReloadButton:function(){return this.showReloadButton},setShowButtonText:function(a){this.showButtonText=a;this.update()},getShowButtonText:function(){return this.showButtonText},setShowButtonIcon:function(a){this.showButtonIcon=a;this.update()},getShowButtonIcon:function(){return this.showButtonIcon},getTotalPage:function(){return this.totalPage},update:function(a,b,c){mini.isNumber(a)&&(this.pageIndex=parseInt(a));mini.isNumber(b)&&(this.pageSize=parseInt(b));mini.isNumber(c)&&(this.totalCount=parseInt(c));this.totalPage=parseInt(this.totalCount/this.pageSize)+1;(this.totalPage-1)*this.pageSize==this.totalCount&&--this.totalPage;0==this.totalCount&&(this.totalPage=0);0<=this.totalCount&&this.pageIndex>this.totalPage-1&&(this.pageIndex=this.totalPage-1);0>=this.pageIndex&&(this.pageIndex=0);0>=this.totalPage&&(this.totalPage=0);this.firstButton.enable();this.prevButton.enable();this.nextButton.enable();this.lastButton.enable();0==this.pageIndex&&(this.firstButton.disable(),this.prevButton.disable());this.pageIndex>=this.totalPage-1&&(this.nextButton.disable(),this.lastButton.disable());a=-1<this.pageIndex?this.pageIndex+1:0;0==this.totalCount&&(a=0);this.numInput.value=a;this.pagesLabel.innerHTML="/ "+this.totalPage;a=this.sizeList.clone();-1==a.indexOf(this.pageSize)&&(a.push(this.pageSize),a=a.sort(function(a,b){return a>b}));b=[];c=0;for(var d=a.length;c<d;c++){var e=a[c],f={};f.text=e;f.id=e;b.push(f)}this.sizeCombo.setData(b);this.sizeCombo.setValue(this.pageSize);this.sizeTextEl.innerHTML=this.sizeText;this.sizeTextEl.style.display=this.sizeText?"":"none";a=this.firstText;b=this.prevText;c=this.nextText;d=this.lastText;e=this.reloadText;0==this.showButtonText&&(a=b=c=d=e="");this.firstButton.setText(a);this.prevButton.setText(b);this.nextButton.setText(c);this.lastButton.setText(d);this.reloadButton.setText(e);a=this.firstText;b=this.prevText;c=this.nextText;d=this.lastText;this.showButtonText&&(this.firstButton.setTooltip(a),this.prevButton.setTooltip(b),this.nextButton.setTooltip(c),this.lastButton.setTooltip(d),this.reloadButton.setTooltip(e));this.firstButton.setIconCls(this.showButtonIcon?"mini-pager-first":"");this.prevButton.setIconCls(this.showButtonIcon?"mini-pager-prev":"");this.nextButton.setIconCls(this.showButtonIcon?"mini-pager-next":"");this.lastButton.setIconCls(this.showButtonIcon?"mini-pager-last":"");this.reloadButton.setIconCls(this.showButtonIcon?"mini-pager-reload":"");this.reloadButton.setVisible(this.showReloadButton);if(a=this.reloadButton.el.previousSibling)a.style.display=this.showReloadButton?"":"none";this._rightEl.innerHTML=String.format(this.pageInfoText,this.pageSize,this.totalCount);this.indexEl.style.display=this.showPageIndex?"":"none";this.sizeEl.style.display=this.showPageSize?"":"none";this._rightEl.style.display=this.showPageInfo?"":"none";this.firstButton.setVisible(0<=this.totalCount);this.lastButton.setVisible(0<=this.totalCount);0>this.totalCount&&(this.firstButton.enable(),this.nextButton.enable(),0==this.pageIndex&&this.firstButton.disable())},__OnPageSelectChanged:function(a){a=parseInt(this.sizeCombo.getValue());this._OnPageChanged(0,a)},_OnPageChanged:function(a,b){var c={pageIndex:mini.isNumber(a)?a:this.pageIndex,pageSize:mini.isNumber(b)?b:this.pageSize,cancel:!1};0<=this.totalCount&&c.pageIndex>this.totalPage-1&&(c.pageIndex=this.totalPage-1);0>c.pageIndex&&(c.pageIndex=0);this.fire("beforepagechanged",c);1!=c.cancel&&(this.fire("pagechanged",c),this.update(c.pageIndex,c.pageSize))},onPageChanged:function(a,b){this.on("pagechanged",a,b)},getAttrs:function(a){var b=mini.Pager.superclass.getAttrs.call(this,a);mini._ParseString(a,b,["onpagechanged","sizeList","onbeforepagechanged","buttons","sizeText"]);mini._ParseBool(a,b,"showPageIndex showPageSize showTotalCount showPageInfo showReloadButton showButtonText showButtonIcon".split(" "));mini._ParseInt(a,b,["pageIndex","pageSize","totalCount","pageSizeWidth"]);"string"==typeof b.sizeList&&(b.sizeList=window.eval(b.sizeList));b.buttons&&(b.buttons=mini.byId(b.buttons));return b}});mini.regClass(mini.Pager,"pager");mini.DataBinding=function(){this._bindFields=[];this._bindForms=[];mini.DataBinding.superclass.constructor.apply(this,arguments)};mini.extend(mini.DataBinding,mini.Component,{bindField:function(a,b,c,d,e){a=mini.get(a);b=mini.get(b);a&&b&&c&&(this._bindFields.push({control:a,source:b,field:c,convert:e,mode:d}),b.on("currentchanged",this.__OnCurrentChanged,this),a.on("valuechanged",this.__OnValueChanged,this))},bindForm:function(a,b,c,d){a=mini.byId(a);b=mini.get(b);if(a&&b){a=new mini.Form(a);a=a.getFields();for(var e=0,f=a.length;e<f;e++){var g=a[e];this.bindField(g,b,g.getName(),c,d)}}},__OnCurrentChanged:function(a){if(!this._doSetting){this._doSetting=!0;this._currentRecord=a.record;var b=a.sender;a=a.record;for(var c=0,d=this._bindFields.length;c<d;c++){var e=this._bindFields[c];if(e.source==b){var f=e.control,e=e.field;f.setValue&&(a?(e=mini._getMap(e,a),f.setValue(e)):f.setValue(""));f.setText&&f.textName&&(a?f.setText(a[f.textName]):f.setText(""))}}var g=this;setTimeout(function(){g._doSetting=!1},10)}},__OnValueChanged:function(a){if(!this._doSetting){this._doSetting=!0;a=a.sender;for(var b=a.getValue(),c=0,d=this._bindFields.length;c<d;c++){var e=this._bindFields[c];if(e.control==a&&!1!==e.mode){var f=e.source,g=this._currentRecord;if(g){var k={};k[e.field]=b;a.getText&&a.textName&&(k[a.textName]=a.getText());f.updateRow(g,k)}}}var l=this;setTimeout(function(){l._doSetting=!1},10)}}});mini.regClass(mini.DataBinding,"databinding");mini.DataSet=function(){this._sources={};this._data={};this._links=[];this._originals={};mini.DataSet.superclass.constructor.apply(this,arguments)};mini.extend(mini.DataSet,mini.Component,{add:function(a,b){a&&b&&(this._sources[a]=b,this._data[a]=[],b._set_autoCreateNewID(!0),b._set_originalIdField(b.getIdField()),b._set_clearOriginals(!1),b.on("addrow",this.__OnRowChanged,this),b.on("updaterow",this.__OnRowChanged,this),b.on("deleterow",this.__OnRowChanged,this),b.on("removerow",this.__OnRowChanged,this),b.on("preload",this.__OnDataPreLoad,this),b.on("selectionchanged",this.__OnDataSelectionChanged,this))},addLink:function(a,b,c){a&&b&&c&&this._sources[a]&&this._sources[b]&&this._links.push({parentName:a,childName:b,parentField:c})},clearData:function(){this._data={};this._originals={};for(var a in this._sources)this._data=[]},getData:function(){return this._data},_getNameByListControl:function(a){for(var b in this._sources)if(this._sources[b]==a)return b},_getRecord:function(a,b,c){a=this._data[a];if(!a)return!1;for(var d=0,e=a.length;d<e;d++){var f=a[d];if(f[c]==b[c])return f}return null},__OnRowChanged:function(a){var b=a.type,c=a.record,d=this._getNameByListControl(a.sender),e=this._getRecord(d,c,a.sender.getIdField()),f=this._data[d];e&&(f=this._data[d],f.remove(e));if("removerow"!=b||"added"!=c._state)"beforeremove"==b&&"added"==c._state||f.push(c);this._originals[d]=a.sender._get_originals();"added"==c._state&&(a=this._getParentSource(a.sender))&&((b=a.getSelected())?c._parentId=b[a.getIdField()]:f.remove(c))},__OnDataPreLoad:function(a){for(var b=a.sender,c=this._getNameByListControl(b),d=a.sender.getIdField(),e=this._data[c],f={},g=0,k=e.length;g<k;g++){var l=e[g];f[l[d]]=l}(g=this._originals[c])&&b._set_originals(g);a=a.data||[];g=0;for(k=a.length;g<k;g++)if(l=a[g],c=f[l[d]])delete c._uid,mini.copyTo(l,c);c=this._getParentSource(b);if(b.getPageIndex&&0==b.getPageIndex()){b=[];g=0;for(k=e.length;g<k;g++)if(l=e[g],"added"==l._state)if(c){var n=c.getSelected();n&&n[c.getIdField()]==l._parentId&&b.push(l)}else b.push(l);b.reverse();a.insertRange(0,b)}e=[];for(g=a.length-1;0<=g;g--)l=a[g],(c=f[l[d]])&&"removed"==c._state&&(a.removeAt(g),e.push(c))},_getParentSource:function(a){a=this._getNameByListControl(a);for(var b=0,c=this._links.length;b<c;b++){var d=this._links[b];if(d.childName==a)return this._sources[d.parentName]}},_getLinks:function(a){a=this._getNameByListControl(a);for(var b=[],c=0,d=this._links.length;c<d;c++){var e=this._links[c];e.parentName==a&&b.push(e)}return b},__OnDataSelectionChanged:function(a){a=a.sender;for(var b=a.getSelected(),c=this._getLinks(a),d=0,e=c.length;d<e;d++){var f=c[d],g=this._sources[f.childName];if(b){var k={};k[f.parentField]=b[a.getIdField()];g.load(k)}else g.loadData([])}}});mini.regClass(mini.DataSet,"dataset");"undefined"==typeof mini_doload&&(mini_doload=function(a){});mini.DataSource=function(){mini.DataSource.superclass.constructor.apply(this,arguments);this._init()};mini.extend(mini.DataSource,mini.Component,{idField:"id",textField:"text",loaded:!1,destroy:function(){this.source=[];this.dataview=[];this.list=this.visibleRows=null;this._ids={};this._removeds=[];this._clearOriginals&&(this._originals={});this._errors={};this._selected=null;this._selecteds=[];this._idSelecteds={};this._sortInfo=this._filterInfo=null;this.root={_id:-1,_level:-1};this.list=this.visibleRows=this.dataview=this.viewNodes=null;mini.DataSource.superclass.destroy.call(this)},_originalIdField:"_id",_clearOriginals:!0,_autoCreateNewID:!1,_init:function(){this.source=[];this.dataview=[];this.list=this.visibleRows=null;this._ids={};this._removeds=[];this._clearOriginals&&(this._originals={});this._errors={};this._selected=null;this._selecteds=[];this._idSelecteds={};this.__changeCount=0},getSource:function(){return this.source},getList:function(){return this.source.clone()},getDataView:function(){return this.dataview.clone()},getVisibleRows:function(){this.visibleRows||(this.visibleRows=this.getDataView().clone());return this.visibleRows},setData:function(a){this.loadData(a)},loadData:function(a){mini.isArray(a)||(a=[]);this._init();this._doLoadData(a);this._dataChanged("loaddata");this.fire("loaddata");return!0},_doLoadData:function(a){a=this.dataview=this.source=a;for(var b=this._ids,c=0,d=a.length;c<d;c++){var e=a[c];e._id=mini.DataSource.RecordId++;b[e._id]=e;e._uid=e._id}},clearData:function(){this._init();this._dataChanged();this.fire("cleardata")},clear:function(){this.clearData()},updateRecord:function(a,b,c){if(!mini.isNull(a)){var d=mini._getMap,e=mini._setMap;this.fire("beforeupdate",{record:a});if("string"==typeof b){var f=d(b,a);if(mini.isEquals(f,c))return!1;this.beginChange();e(b,c,a);this._setModified(a,b,f);this.endChange()}else{this.beginChange();for(var g in b)f=d(g,a),c=b[g],mini.isEquals(f,c)||(e(g,c,a),this._setModified(a,g,f));this.endChange("update")}this.fire("update",{record:a})}},deleteRecord:function(a){this._setDeleted(a);this._dataChanged();this.fire("delete",{record:a})},getby_id:function(a){a="object"==typeof a?a._id:a;return this._ids[a]},getbyId:function(a){if("number"==typeof a)return this.getAt(a);if("object"==typeof a){if(this.getby_id(a))return a;a=a[this.idField]}a=String(a);var b=this.ids;if(!b)for(var b=this.ids={},c=this.getList(),d=0,e=c.length;d<e;d++){var f=c[d],g=f[this.idField];mini.isNull(g)||(b[g]=f)}return b[a]},getsByIds:function(a){mini.isNull(a)&&(a="");a=String(a);var b=[];a=String(a).split(",");for(var c=0,d=a.length;c<d;c++){var e=this.getbyId(a[c]);e&&b.push(e)}return b},getRecord:function(a){return"object"==typeof a?a:this.getRow(a)},getRow:function(a){var b=typeof a;if("string"==b)return this.getbyId(a);if("number"==b)return this.getAt(a);if("object"==b)return a},delimiter:",",getValueAndText:function(a,b){mini.isNull(a)&&(a=[]);b=b||this.delimiter;"string"==typeof a||"number"==typeof a?a=this.getsByIds(a):mini.isArray(a)||(a=[a]);for(var c=[],d=[],e=0,f=a.length;e<f;e++){var g=a[e];g&&(c.push(this.getItemValue(g)),d.push(this.getItemText(g)))}return[c.join(b),d.join(b)]},getItemValue:function(a){if(!a)return"";a=mini._getMap(this.idField,a);return mini.isNull(a)?"":String(a)},getItemText:function(a){if(!a)return"";a=mini._getMap(this.textField,a);return mini.isNull(a)?"":String(a)},isModified:function(a,b){var c=this._originals[a[this._originalIdField]];return!c||mini.isNull(b)?!1:c.hasOwnProperty(b)},hasRecord:function(a){return!!this.getby_id(a)},findRecords:function(a,b){for(var c="function"==typeof a,d=b||this,e=this.source,f=[],g=0,k=e.length;g<k;g++){var l=e[g];if(c){var n=a.call(d,l);1==n&&(f[f.length]=l);if(1===n)break}else l[a]==b&&(f[f.length]=l)}return f},findRecord:function(a,b){return this.findRecords(a,b)[0]},each:function(a,b){var c=this.getDataView().clone();mini.forEach(c,a,b||this)},getCount:function(){return this.getDataView().length},setIdField:function(a){this.idField=a},setTextField:function(a){this.textField=a},__changeCount:0,beginChange:function(){this.__changeCount++},endChange:function(a,b){this.__changeCount--;0>this.__changeCount&&(this.__changeCount=0);if(!1!==b&&0==this.__changeCount||1==b)this.__changeCount=0,this._dataChanged(a)},_dataChanged:function(a){this.list=this.visibleRows=this.ids=null;0==this.__changeCount&&this.fire("datachanged")},_setAdded:function(a){a._id=mini.DataSource.RecordId++;this._autoCreateNewID&&!a[this.idField]&&(a[this.idField]=UUID());a._uid=a._id;a._state="added";this._ids[a._id]=a;delete this._originals[a[this._originalIdField]]},_setModified:function(a,b,c){"added"!=a._state&&"deleted"!=a._state&&"removed"!=a._state&&(a._state="modified",a=this._getOriginal(a),a.hasOwnProperty(b)||(a[b]=c))},_setDeleted:function(a){"added"!=a._state&&"deleted"!=a._state&&"removed"!=a._state&&(a._state="deleted")},_setRemoved:function(a){delete this._ids[a._id];"added"!=a._state&&"removed"!=a._state&&(a._state="removed",delete this._originals[a[this._originalIdField]],this._removeds.push(a))},_getOriginal:function(a){a=a[this._originalIdField];var b=this._originals[a];b||(b=this._originals[a]={});return b},_selected:null,_selecteds:[],_idSelecteds:null,multiSelect:!1,isSelected:function(a){if(!a)return!1;"string"!=typeof a&&(a=a._id);return!!this._idSelecteds[a]},setSelected:function(a){a=this.getby_id(a);this.getSelected()!=a&&((this._selected=a)?this.select(a):this.deselect(this.getSelected()),this._OnCurrentChanged(a))},getSelected:function(){return this.isSelected(this._selected)?this._selected:this._selecteds[0]},setCurrent:function(a){this.setSelected(a)},getCurrent:function(){return this.getSelected()},getSelecteds:function(){return this._selecteds.clone()},select:function(a,b){mini.isNull(a)||this.selects([a],b)},deselect:function(a,b){mini.isNull(a)||this.deselects([a],b)},selectAll:function(a){this.selects(this.getList(),a)},deselectAll:function(a){this.deselects(this.getSelecteds(),a)},_fireSelect:function(a,b){var c={record:a,cancel:!1};this.fire(b,c);return!c.cancel},selects:function(a,b){if(mini.isArray(a)){a=a.clone();0==this.multiSelect&&(this.deselects(this.getSelecteds()),0<a.length&&(a.length=1),this._selecteds=[],this._idSelecteds={});for(var c=[],d=0,e=a.length;d<e;d++){var f=this.getbyId(a[d]);!f||this.isSelected(f)||!1!==b&&!this._fireSelect(f,"beforeselect")||(this._selecteds.push(f),this._idSelecteds[f._id]=f,c.push(f),!1!==b&&this.fire("select",{record:f}))}this._OnSelectionChanged(a,!0,c,b)}},deselects:function(a,b){if(mini.isArray(a)){a=a.clone();for(var c=[],d=a.length-1;0<=d;d--){var e=this.getbyId(a[d]);e&&this.isSelected(e)&&(!1===b||this._fireSelect(e,"beforedeselect"))&&(delete this._idSelecteds[e._id],c.push(e))}this._selecteds=[];e=this._idSelecteds;for(d in e){var f=e[d];f._id&&this._selecteds.push(f)}for(d=a.length-1;0<=d;d--)(e=this.getbyId(a[d]))&&!1!==b&&this.fire("deselect",{record:e});this._OnSelectionChanged(a,!1,c,b)}},_OnSelectionChanged:function(a,b,c,d){a={fireEvent:d,records:a,select:b,selected:this.getSelected(),selecteds:this.getSelecteds(),_records:c};this.fire("SelectionChanged",a);a=this._current;b=this.getCurrent();a!=b&&(this._current=b,this._OnCurrentChanged(b))},_OnCurrentChanged:function(a){this._currentTimer&&clearTimeout(this._currentTimer);var b=this;this._currentTimer=setTimeout(function(){b._currentTimer=null;b.fire("CurrentChanged",{record:a})},30)},_checkSelecteds:function(){for(var a=this._selecteds.length-1;0<=a;a--){var b=this._selecteds[a];this.getby_id(b._id)||(this._selecteds.removeAt(a),delete this._idSelecteds[b._id])}this._selected&&null==this.getby_id(this._selected._id)&&(this._selected=null)},setMultiSelect:function(a){this.multiSelect!=a&&(this.multiSelect=a)},getMultiSelect:function(){return this.multiSelect},selectPrev:function(){var a=this.getSelected();a?(a=this.indexOf(a),a=this.getAt(a-1)):a=this.getAt(0);a&&(this.deselectAll(),this.select(a),this.setCurrent(a))},selectNext:function(){var a=this.getSelected();a?(a=this.indexOf(a),a=this.getAt(a+1)):a=this.getAt(0);a&&(this.deselectAll(),this.select(a),this.setCurrent(a))},selectFirst:function(){var a=this.getAt(0);a&&(this.deselectAll(),this.select(a),this.setCurrent(a))},selectLast:function(){var a=this.getVisibleRows();if(a=this.getAt(a.length-1))this.deselectAll(),this.select(a),this.setCurrent(a)},getSelectedsId:function(a){var b=this.getSelecteds();return this.getValueAndText(b,a)[0]},getSelectedsText:function(a){var b=this.getSelecteds();return this.getValueAndText(b,a)[1]},_filterInfo:null,_sortInfo:null,filter:function(a,b){"function"==typeof a&&(this._filterInfo=[a,b||this],this._doFilter(),this._doSort(),this._dataChanged(),this.fire("filter"))},clearFilter:function(){this._filterInfo&&(this._filterInfo=null,this._doFilter(),this._doSort(),this._dataChanged(),this.fire("filter"))},sort:function(a,b,c){"function"==typeof a&&(this._sortInfo=[a,b||this,c],this._doSort(),this._dataChanged(),this.fire("sort"))},clearSort:function(){this._sortInfo=null;this.sortField=this.sortOrder="";this._doFilter();this._dataChanged();if("server"==this.sortMode){var a=this.getLoadParams();a.sortField="";a.sortOrder="";this.load(a)}this.fire("filter")},_sortMulti:function(a){},_doClientSortField:function(a,b,c){(a=this._getSortFnByField(a,c))&&this.sort(a,this,"desc"==b)},_getSortFnByField:function(a,b){if(!a)return null;var c=mini.sortTypes[b];c||(c=mini.sortTypes.string);return function(d,e){var f=mini._getMap(a,d),g=mini._getMap(a,e),k=mini.isNull(f)||""===f,l=mini.isNull(g)||""===g;if(k)return 0;if(l)return 1;if("chinese"==b)return f.localeCompare(g,"zh");f=c(f);g=c(g);return f>g?1:0}},ajaxOptions:null,autoLoad:!1,url:"",pageSize:10,pageIndex:0,totalCount:0,totalPage:0,sortField:"",sortOrder:"",loadParams:null,getLoadParams:function(){return this.loadParams||{}},sortMode:"server",pageIndexField:"pageIndex",pageSizeField:"pageSize",sortFieldField:"sortField",sortOrderField:"sortOrder",totalField:"total",dataField:"data",startField:"",limitField:"",errorField:"error",errorMsgField:"errorMsg",stackTraceField:"stackTrace",load:function(a,b,c,d){if("string"==typeof a)this.setUrl(a);else if(this._loadTimer&&clearTimeout(this._loadTimer),this.loadParams=a||{},mini.isNumber(this.loadParams.pageIndex)||(this.loadParams.pageIndex=0),this._xhr&&this._xhr.abort(),this.ajaxAsync&&mini_ajaxAsyncInvoke){var e=this;this._loadTimer=setTimeout(function(){e._doLoadAjax(e.loadParams,b,c,d);e._loadTimer=null},1)}else this._doLoadAjax(this.loadParams,b,c,d)},reload:function(a,b,c){this.load(this.loadParams,a,b,c)},gotoPage:function(a,b){var c=this.loadParams||{};mini.isNumber(a)&&(c.pageIndex=a);mini.isNumber(b)&&(c.pageSize=b);this.load(c)},sortBy:function(a,b){this.sortField=a;this.sortOrder="asc"==b?"asc":"desc";if("server"==this.sortMode){var c=this.getLoadParams();c.sortField=a;c.sortOrder=b;c.pageIndex=this.pageIndex;this.load(c)}},setSortField:function(a){this.sortField=a;"server"==this.sortMode&&(this.getLoadParams().sortField=a)},setSortOrder:function(a){this.sortOrder=a;"server"==this.sortMode&&(this.getLoadParams().sortOrder=a)},checkSelectOnLoad:!0,selectOnLoad:!1,ajaxData:null,ajaxAsync:!0,ajaxType:"",_doLoadAjax:function(a,b,c,d,e){a=a||{};mini.isNull(a.pageIndex)&&(a.pageIndex=this.pageIndex);mini.isNull(a.pageSize)&&(a.pageSize=this.pageSize);a.sortField&&(this.sortField=a.sortField);a.sortOrder&&(this.sortOrder=a.sortOrder);a.sortField=this.sortField;a.sortOrder=this.sortOrder;this.loadParams=a;var f=this._evalUrl(),g=this._evalType(f),k=mini._evalAjaxData(this.ajaxData,this);jQuery.extend(!0,a,k);var l={url:f,async:this.ajaxAsync,type:g,data:a,params:a,cache:!1,cancel:!1};jQuery.extend(!0,l,this.ajaxOptions);this._OnBeforeLoad(l);if(1==l.cancel)a.pageIndex=this.getPageIndex(),a.pageSize=this.getPageSize();else{l.data!=l.params&&l.params!=a&&(l.data=l.params);l.url!=f&&l.type==g&&(l.type=this._evalType(l.url));g={};g[this.pageIndexField]=a.pageIndex;g[this.pageSizeField]=a.pageSize;a.sortField&&(g[this.sortFieldField]=a.sortField);a.sortOrder&&(g[this.sortOrderField]=a.sortOrder);this.startField&&this.limitField&&(g[this.startField]=a.pageIndex*a.pageSize,g[this.limitField]=a.pageSize);jQuery.extend(!0,a,g);jQuery.extend(!0,l.data,g);"client"==this.sortMode&&(a[this.sortFieldField]="",a[this.sortOrderField]="");this._currentSelectValue=(g=this.getSelected())?g[this.idField]:null;mini.isNumber(this._currentSelectValue)&&(this._currentSelectValue=String(this._currentSelectValue));for(var g=this.getSelecteds(),k=[],n=0,p=g.length;n<p;n++){var q=g[n][this.idField];mini.isNull(q)||(q=String(q));k.push(q)}this._selectedValue=0==k.length?null:k;mini.isNumber(this._selectedValue)&&(this._selectedValue=String(this._selectedValue));var r=this;r._resultObject=null;var t=l.async;mini.copyTo(l,{success:function(d,g,k){d&&"null"!=d||(d="{ total: 0, data: [] }");delete l.params;var n={text:d,result:null,sender:r,options:l,xhr:k},p=null;try{mini_doload(n),(p=n.result)||(p=mini.decode(d))}catch(C){1==mini_debugger&&alert(f+"\n json is error.")}p&&!mini.isArray(p)?(p.total=parseInt(mini._getMap(r.totalField,p)),p.data=mini._getMap(r.dataField,p)):null==p?p={data:[],total:0}:mini.isArray(p)&&(n={},n.data=p,n.total=p.length,p=n);p.data||(p.data=[]);p.total||(p.total=0);r._resultObject=p;mini.isArray(p.data)||(p.data=[p.data]);var q={xhr:k,text:d,textStatus:g,result:p,total:p.total,data:p.data.clone(),pageIndex:a[r.pageIndexField],pageSize:a[r.pageSizeField]};d=mini._getMap(r.errorField,p);g=mini._getMap(r.errorMsgField,p);p=mini._getMap(r.stackTraceField,p);if(mini.isNumber(d)&&0!=d||!1===d)q.textStatus="servererror",q.errorCode=d,q.stackTrace=p||"",q.errorMsg=g||"",1==mini_debugger&&alert(f+"\n"+q.textStatus+"\n"+q.errorMsg+"\n"+q.stackTrace),r.fire("loaderror",q),c&&c.call(r,q);else if(0<q.pageIndex&&0==q.data.length)r.gotoPage(q.pageIndex-1);else if(e)e(q);else{r.pageIndex=q.pageIndex;r.pageSize=q.pageSize;r.setTotalCount(q.total);r._OnPreLoad(q);r.loaded=!0;r.setData(q.data);if(r._selectedValue&&r.checkSelectOnLoad&&(p=[],d=r._selectedValue,0<d.length)){g=0;for(k=d.length;g<k;g++)(n=r.getbyId(d[g]))&&p.push(n);p.length&&r.selects(p);r._selected=r.getbyId(r._currentSelectValue)}null==r.getSelected()&&r.selectOnLoad&&0<r.getDataView().length&&r.select(0);r.fire("load",q);b&&(t?setTimeout(function(){b.call(r,q)},20):b.call(r,q))}},error:function(a,b,d){"abort"!=b&&(b={xhr:a,text:a.responseText,textStatus:b},b.errorMsg=a.responseText,b.errorCode=a.status,1==mini_debugger&&alert(f+"\n"+b.errorCode+"\n"+b.errorMsg),r.fire("loaderror",b),c&&c.call(r,b))},complete:function(a,b){var c={xhr:a,text:a.responseText,textStatus:b};r.fire("loadcomplete",c);d&&d.call(r,c);r._xhr=null}});this._xhr=mini.ajax(l)}},_OnBeforeLoad:function(a){this.fire("beforeload",a)},_OnPreLoad:function(a){this.fire("preload",a)},_evalUrl:function(){var a=this.url;if("function"==typeof a)a=a();else{try{a=window.eval(a)}catch(b){a=this.url}a||(a=this.url)}return a},_evalType:function(a){var b=this.ajaxType;if(!b)if(b="post",a){if(-1!=a.indexOf(".txt")||-1!=a.indexOf(".json"))b="get"}else b="get";return b},setSortMode:function(a){this.sortMode=a},getSortMode:function(){return this.sortMode},setAjaxOptions:function(a){this.ajaxOptions=a},getAjaxOptions:function(){return this.ajaxOptions},setAutoLoad:function(a){this.autoLoad=a},getAutoLoad:function(){return this.autoLoad},setUrl:function(a){this.url=a;this.autoLoad&&this.load()},getUrl:function(){return this.url},setPageIndex:function(a){this.pageIndex=a;var b=this.loadParams||{};mini.isNumber(a)&&(b.pageIndex=a);this.fire("pageinfochanged")},getPageIndex:function(){return this.pageIndex},setPageSize:function(a){this.pageSize=a;var b=this.loadParams||{};mini.isNumber(a)&&(b.pageSize=a);this.fire("pageinfochanged")},getPageSize:function(){return this.pageSize},setTotalCount:function(a){this.totalCount=parseInt(a);this.fire("pageinfochanged")},getTotalCount:function(){return this.totalCount},getTotalPage:function(){return this.totalPage},setCheckSelectOnLoad:function(a){this.checkSelectOnLoad=a},getCheckSelectOnLoad:function(){return this.checkSelectOnLoad},setSelectOnLoad:function(a){this.selectOnLoad=a},getSelectOnLoad:function(){return this.selectOnLoad}});mini.DataSource.RecordId=1;mini.DataTable=function(){mini.DataTable.superclass.constructor.apply(this,arguments)};mini.extend(mini.DataTable,mini.DataSource,{_init:function(){mini.DataTable.superclass._init.call(this);this._sortInfo=this._filterInfo=null},add:function(a){return this.insert(this.source.length,a)},addRange:function(a){this.insertRange(this.source.length,a)},insert:function(a,b){if(!b)return null;if(!mini.isNumber(a)){var c=this.getRecord(a);a=c?this.indexOf(c):this.dataview.length}c={index:a,record:b};this.fire("beforeadd",c);var d=this.dataview[a];d?this.dataview.insert(a,b):this.dataview.add(b);this.dataview!=this.source&&(d?(d=this.source.indexOf(d),this.source.insert(d,b)):this.source.add(b));this._setAdded(b);this._dataChanged();this.fire("add",c)},insertRange:function(a,b){if(mini.isArray(b)){mini.isNumber(a)||(a=this.dataview.length);this.beginChange();b=b.clone();for(var c=0,d=b.length;c<d;c++)this.insert(a+c,b[c]);this.endChange()}},remove:function(a,b){var c=this.indexOf(a);return this.removeAt(c,b)},removeAt:function(a,b){var c=this.getAt(a);if(!c)return null;var d={record:c};this.fire("beforeremove",d);var e=this.isSelected(c);this.source.remove(c);this.dataview!==this.source&&this.dataview.removeAt(a);this._setRemoved(c);this._checkSelecteds();this._dataChanged();this.fire("remove",d);e&&b&&((c=this.getAt(a))||(c=this.getAt(a-1)),this.deselectAll(),this.select(c))},removeRange:function(a,b){if(mini.isArray(a)){this.beginChange();a=a.clone();for(var c=0,d=a.length;c<d;c++)this.remove(a[c],b);this._dataChanged();this.endChange()}},move:function(a,b){if(a&&mini.isNumber(b)&&!(0>b))if(mini.isArray(a)){this.beginChange();var c=this.getAt(b),d=this;mini.sort(a,function(a,b){return d.indexOf(a)>d.indexOf(b)},this);for(var e=0,f=a.length;e<f;e++){var g=a[e],k=this.indexOf(c);this.move(g,k)}this.endChange()}else c={index:b,record:a},this.fire("beforemove",c),e=this.dataview[b],this.dataview.remove(a),f=this.dataview.indexOf(e),-1!=f&&(b=f),e?this.dataview.insert(b,a):this.dataview.add(a),this.dataview!=this.source&&(this.source.remove(a),f=this.source.indexOf(e),-1!=f&&(b=f),e?this.source.insert(b,a):this.source.add(a)),this._dataChanged(),this.fire("move",c)},indexOf:function(a){return this.getVisibleRows().indexOf(a)},getAt:function(a){return this.getVisibleRows()[a]},getRange:function(a,b){if(a>b){var c=a;a=b;b=c}for(var c=[],d=a,e=b;d<=e;d++)c.push(this.dataview[d]);return c},selectRange:function(a,b){mini.isNumber(a)||(a=this.indexOf(a));mini.isNumber(b)||(b=this.indexOf(b));if(!mini.isNull(a)&&!mini.isNull(b)){var c=this.getRange(a,b);this.selects(c)}},toArray:function(){return this.source.clone()},isChanged:function(){return 0<this.getChanges().length},getChanges:function(a,b){var c=[];"removed"!=a&&null!=a||c.addRange(this._removeds.clone());for(var d=0,e=this.source.length;d<e;d++){var f=this.source[d];!f._state||f._state!=a&&null!=a||(c[c.length]=f)}if(b)for(d=0,e=c.length;d<e;d++)if(f=c[d],"modified"==f._state){var g={};g._state=f._state;g[this.idField]=f[this.idField];for(var k in f)this.isModified(f,k)&&(g[k]=f[k]);c[d]=g}var l=this;mini.sort(c,function(a,b){var c=l.indexOf(a),d=l.indexOf(b);return c>d?1:c<d?-1:0});return c},accept:function(){this.beginChange();for(var a=0,b=this.source.length;a<b;a++)this.acceptRecord(this.source[a]);this._removeds=[];this._originals={};this.endChange()},reject:function(){this.beginChange();for(var a=this.source.clone(),b=0,c=a.length;b<c;b++)this.rejectRecord(a[b]);this._removeds=[];this._originals={};this.endChange()},acceptRecord:function(a){a._state&&(delete this._originals[a[this._originalIdField]],"deleted"==a._state?this.remove(a):(delete a._state,delete this._originals[a[this._originalIdField]],this._dataChanged()),this.fire("update",{record:a}))},rejectRecord:function(a){if(a._state)if("added"==a._state)this.remove(a);else if("modified"==a._state||"deleted"==a._state){var b=this._getOriginal(a),c;for(c in b)mini._setMap(c,b[c],a);delete a._state;delete this._originals[a[this._originalIdField]];this._dataChanged();this.fire("update",{record:a})}},_doFilter:function(){if(this._filterInfo){for(var a=this._filterInfo[0],b=this._filterInfo[1],c=[],d=this.source,e=0,f=d.length;e<f;e++){var g=d[e];!1!==a.call(b,g,e,this)&&c.push(g)}this.dataview=c}else this.dataview=this.source},_doSort:function(){if(this._sortInfo){var a=this._sortInfo[0],b=this._sortInfo[1],c=this._sortInfo[2],d=this.getDataView().clone();mini.sort(d,a,b);c&&d.reverse();this.dataview=d}}});mini.regClass(mini.DataTable,"datatable");mini.DataTree=function(){mini.DataTree.superclass.constructor.apply(this,arguments)};mini.extend(mini.DataTree,mini.DataSource,{isTree:!0,expandOnLoad:!1,idField:"id",parentField:"pid",nodesField:"children",checkedField:"checked",resultAsTree:!0,dataField:"",checkModel:"cascade",autoCheckParent:!1,onlyLeafCheckable:!1,setExpandOnLoad:function(a){this.expandOnLoad=a},getExpandOnLoad:function(){return this.expandOnLoad},setParentField:function(a){this.parentField=a},setNodesField:function(a){if(this.nodesField!=a){var b=this.root[this.nodesField];this.nodesField=a;this._doLoadData(b)}},setResultAsTree:function(a){this.resultAsTree=a},setCheckRecursive:function(a){this.checkModel=a?"cascade":"multiple"},getCheckRecursive:function(){return"cascade"==this.checkModel},setShowFolderCheckBox:function(a){this.onlyLeafCheckable=!a},getShowFolderCheckBox:function(){return!this.onlyLeafCheckable},_doExpandOnLoad:function(a){function b(a,f){for(var e=0,k=a.length;e<k;e++){var l=a[e];mini.isNull(l.expanded)&&(!0===d||mini.isNumber(d)&&f<=d?l.expanded=!0:l.expanded=!1);(l=l[c])&&b(l,f+1)}}var c=this.nodesField,d=this.expandOnLoad;b(a,0)},_OnBeforeLoad:function(a){a.node=this._loadingNode||this.root;this._isNodeLoading()&&(a.async=!0,a.isRoot=a.node==this.root,a.isRoot||(a.data[this.idField]=this.getItemValue(a.node)));this.fire("beforeload",a)},_OnPreLoad:function(a){0==this.resultAsTree&&(a.data=mini.arrayToTree(a.data,this.nodesField,this.idField,this.parentField));this.fire("preload",a)},_init:function(){mini.DataTree.superclass._init.call(this);this.root={_id:-1,_level:-1};this.source=this.root[this.nodesField]=[];this.list=this.visibleRows=this.dataview=this.viewNodes=null;this._ids[this.root._id]=this.root},_doLoadData:function(a){a=a||[];this._doExpandOnLoad(a);this.source=this.root[this.nodesField]=a;this.list=this.visibleRows=this.dataview=this.viewNodes=null;var b=mini.treeToArray(a,this.nodesField),c=this._ids;c[this.root._id]=this.root;for(var d=mini.DataSource.RecordId,e=0,f=b.length;e<f;e++){var g=b[e];g._id=d++;c[g._id]=g;g._uid=g._id}mini.DataSource.RecordId=d;d=this.checkedField;this.list=b=mini.treeToArray(a,this.nodesField,"_id","_pid",this.root._id);c=this._ids;e=0;for(f=b.length;e<f;e++)if(g=b[e],a=c[g._pid],g._level=a._level+1,g._state&&delete g._state,a=g[d])g.checked=a,g.checked&&(g.checked="false"!=g.checked);this._doUpdateLoadedCheckedNodes()},_setAdded:function(a){var b=this.getParentNode(a);a._id=mini.DataSource.RecordId++;this._autoCreateNewID&&!a[this.idField]&&(a[this.idField]=UUID());a._uid=a._id;a._pid=b._id;b[this.idField]&&(a[this.parentField]=b[this.idField]);a._level=b._level+1;a._state="added";this._ids[a._id]=a;delete this._originals[a[this._originalIdField]]},_createNodes:function(a){var b=a[this.nodesField];b||(b=a[this.nodesField]=[]);this.viewNodes&&!this.viewNodes[a._id]&&(this.viewNodes[a._id]=[]);return b},addNode:function(a,b){if(a)return this.insertNode(a,-1,b)},addNodes:function(a,b,c){if(mini.isArray(a)){mini.isNull(c)&&(c="add");for(var d=0,e=a.length;d<e;d++)this.insertNode(a[d],c,b)}},insertNodes:function(a,b,c){if(mini.isNumber(b)&&mini.isArray(a)){c||(c=this.root);this.beginChange();var d=this._createNodes(c);if(0>b||b>d.length)b=d.length;a=a.clone();for(var d=0,e=a.length;d<e;d++)this.insertNode(a[d],b+d,c);this.endChange();return a}},removeNode:function(a){var b=this.getParentNode(a);if(b)return a=this.indexOfNode(a),this.removeNodeAt(a,b)},removeNodes:function(a){if(mini.isArray(a)){this.beginChange();a=a.clone();for(var b=0,c=a.length;b<c;b++)this.removeNode(a[b]);this.endChange()}},moveNodes:function(a,b,c){if(a&&0!=a.length&&b&&c){this.beginChange();var d=this;mini.sort(a,function(a,b){return d.indexOf(a)>d.indexOf(b)},this);for(var e=0,f=a.length;e<f;e++){var g=a[e];this.moveNode(g,b,c);0!=e&&(b=g,c="after")}this.endChange()}},moveNode:function(a,b,c){if(a&&b&&!mini.isNull(c)){if(this.viewNodes){var d=b,e=c;if("before"==e)d=this.getParentNode(b),e=this.indexOfNode(b);else if("after"==e)d=this.getParentNode(b),e=this.indexOfNode(b)+1;else if("add"==e||"append"==e)d[this.nodesField]||(d[this.nodesField]=[]),e=d[this.nodesField].length;else if(!mini.isNumber(e))return;if(this.isAncestor(a,d))return!1;var f=this.viewNodes[d._id];f||(this.viewNodes[d._id]=[]);f=this.getChildNodes(d);if(0>e||e>f.length)e=f.length;var g={};f.insert(e,g);var k=this.getParentNode(a);this.getChildNodes(k).remove(a);e=f.indexOf(g);f[e]=a}d=b;e=c;f=this._createNodes(d);if("before"==e)d=this.getParentNode(b),f=this._createNodes(d),e=f.indexOf(b);else if("after"==e)d=this.getParentNode(b),f=this._createNodes(d),e=f.indexOf(b)+1;else if("add"==e||"append"==e)e=f.length;else if(!mini.isNumber(e))return;if(this.isAncestor(a,d))return!1;if(0>e||e>f.length)e=f.length;g={};f.insert(e,g);k=this.getParentNode(a);k[this.nodesField].remove(a);e=f.indexOf(g);f[e]=a;this._updateParentAndLevel(a,d);this._dataChanged();this.fire("movenode",{oldParentNode:k,parentNode:d,index:e,node:a})}},insertNode:function(a,b,c){if(a){c||(c=this.root,b="add");if(!mini.isNumber(b)){switch(b){case "before":b=this.indexOfNode(c);c=this.getParentNode(c);a=this.insertNode(a,b,c);break;case "after":b=this.indexOfNode(c);c=this.getParentNode(c);a=this.insertNode(a,b+1,c);break;case "append":case "add":a=this.addNode(a,c)}return a}var d=this._createNodes(c),e=this.getChildNodes(c);if(0>b||b>e.length)b=e.length;e.insert(b,a);this.viewNodes&&((e=e[b-1])?(e=d.indexOf(e),d.insert(e+1,a)):d.insert(0,a));a._pid=c._id;this._setAdded(a);var f=this;if(d=a[this.nodesField]){var g=function(a,b){for(var c=0,d=a.length;c<d;c++){var e=a[c];e._pid=b._id;f._setAdded(e);e[f.nodesField]&&g(e[f.nodesField])}};g(d,a)}this._dataChanged();this.fire("addnode",{parentNode:c,index:b,node:a});return a}},removeNodeAt:function(a,b){b||(b=this.root);var c=this.getChildNodes(b),d=c[a];if(!d)return null;c.removeAt(a);this.viewNodes&&b[this.nodesField].remove(d);this._setRemoved(d);this.cascadeChild(d,function(a,b,c){this._setRemoved(a)},this);this._checkSelecteds();this._dataChanged();this.fire("removenode",{parentNode:b,index:a,node:d});return d},bubbleParent:function(a,b,c){c=c||this;a&&b.call(this,a);(a=this.getParentNode(a))&&a!=this.root&&this.bubbleParent(a,b,c)},cascadeChild:function(a,b,c){if(b){a||(a=this.root);var d=this.getChildNodes(a);if(d)for(var d=d.clone(),e=0,f=d.length;e<f;e++){var g=d[e];if(!1===b.call(c||this,g,e,a))break;this.cascadeChild(g,b,c)}}},eachChild:function(a,b,c){if(b&&a){var d=a[this.nodesField];if(d)for(var d=d.clone(),e=0,f=d.length;e<f&&!1!==b.call(c||this,d[e],e,a);e++);}},collapse:function(a,b){if(a=this.getNode(a))this.beginChange(),a.expanded=!1,b&&this.eachChild(a,function(a){null!=a[this.nodesField]&&this.collapse(a,b)},this),this.endChange("collapse"),this.fire("collapse",{node:a})},expand:function(a,b){if(a=this.getNode(a))this.beginChange(),a.expanded=!0,b&&this.eachChild(a,function(a){null!=a[this.nodesField]&&this.expand(a,b)},this),this.endChange("expand"),this.fire("expand",{node:a})},toggle:function(a){this.isExpandedNode(a)?this.collapse(a):this.expand(a)},expandNode:function(a){this.expand(a)},collapseNode:function(a){this.collapse(a)},collapseAll:function(){this.collapse(this.root,!0)},expandAll:function(){this.expand(this.root,!0)},collapseLevel:function(a,b){this.beginChange();this.each(function(c){var d=this.getLevel(c);a==d&&this.collapse(c,b)},this);this.endChange()},expandLevel:function(a,b){this.beginChange();this.each(function(c){var d=this.getLevel(c);a==d&&this.expand(c,b)},this);this.endChange()},expandPath:function(a){if(a=this.getNode(a)){a=this.getAncestors(a);for(var b=0,c=a.length;b<c;b++)this.expandNode(a[b])}},collapsePath:function(a){if(a=this.getNode(a)){a=this.getAncestors(a);for(var b=0,c=a.length;b<c;b++)this.collapseNode(a[b])}},isAncestor:function(a,b){if(a==b)return!0;if(!a||!b)return!1;if(a==this.getRootNode())return!0;for(var c=this.getAncestors(b),d=0,e=c.length;d<e;d++)if(c[d]==a)return!0;return!1},getAncestors:function(a){for(var b=[];;){a=this.getParentNode(a);if(!a||a==this.root)break;b[b.length]=a}b.reverse();return b},getNode:function(a){return"object"==typeof a?a:this.getRecord(a)},getRootNode:function(){return this.root},getParentNode:function(a){return a?this.getby_id(a._pid):null},getAllChildNodes:function(a,b){return this.getChildNodes(a,!0,b)},getChildNodes:function(a,b,c){(a=this.getNode(a))||(a=this.getRootNode());var d=a[this.nodesField];this.viewNodes&&!1!==c&&(d=this.viewNodes[a._id]);if(!0===b&&d){a=[];for(var e=0,f=d.length;e<f;e++){var g=d[e];a[a.length]=g;(g=this.getChildNodes(g,b,c))&&0<g.length&&a.addRange(g)}d=a}return d||[]},getChildNodeAt:function(a,b){var c=this.getChildNodes(b);return c?c[a]:null},hasChildNodes:function(a){return 0<this.getChildNodes(a).length},getLevel:function(a){return a._level},_is_true:function(a){return"true"==String(a)||1===a||"Y"===a||"y"===a},_is_false:function(a){return"false"==String(a)||0===a||"N"===a||"n"===a},leafField:"isLeaf",isLeafNode:function(a){return this.isLeaf(a)},isLeaf:function(a){if(!a)return!1;var b=a[this.leafField];return!a||this._is_false(b)||0<this.getChildNodes(a,!1,!1).length?!1:!0},hasChildren:function(a){a=this.getChildNodes(a);return!!(a&&0<a.length)},isFirstNode:function(a){if(a==this.root)return!0;var b=this.getParentNode(a);return b?this.getFirstNode(b)==a:!1},isLastNode:function(a){if(a==this.root)return!0;var b=this.getParentNode(a);return b?this.getLastNode(b)==a:!1},isCheckedNode:function(a){return!0===a.checked},isExpandedNode:function(a){return 1==a.expanded||1==a.expanded||mini.isNull(a.expanded)},isEnabledNode:function(a){return!1!==a.enabled},isVisibleNode:function(a){return 0==a.visible?!1:(a=this._ids[a._pid])&&a!=this.root?!1===a.expanded?!1:this.isVisibleNode(a):!0},getNextNode:function(a){var b=this.getby_id(a._pid);if(!b)return null;a=this.indexOfNode(a);return this.getChildNodes(b)[a+1]},getPrevNode:function(a){var b=this.getby_id(a._pid);if(!b)return null;a=this.indexOfNode(a);return this.getChildNodes(b)[a-1]},getFirstNode:function(a){return this.getChildNodes(a)[0]},getLastNode:function(a){a=this.getChildNodes(a);return a[a.length-1]},indexOfNode:function(a){var b=this.getby_id(a._pid);return b?this.getChildNodes(b).indexOf(a):-1},indexOfList:function(a){return this.getList().indexOf(a)},getAt:function(a){return this.getVisibleRows()[a]},indexOf:function(a){return this.getVisibleRows().indexOf(a)},getRange:function(a,b){if(a>b){var c=a;a=b;b=c}for(var c=this.getChildNodes(this.root,!0),d=[],e=a,f=b;e<=f;e++){var g=c[e];g&&d.push(g)}return d},selectRange:function(a,b){var c=this.getChildNodes(this.root,!0);mini.isNumber(a)||(a=c.indexOf(a));mini.isNumber(b)||(b=c.indexOf(b));mini.isNull(a)||mini.isNull(b)||(c=this.getRange(a,b),this.selects(c))},findRecords:function(a,b){var c=this.toArray(),d="function"==typeof a,e=b||this,f=[];mini.isNull(b)||(b=String(b));for(var g=0,k=c.length;g<k;g++){var l=c[g];if(d){var n=a.call(e,l);1==n&&(f[f.length]=l);if(1===n)break}else if(-1!=b.indexOf(","))for(var n=b.split(","),p=0,q=n.length;p<q;p++)l[a]==n[p]&&(f[f.length]=l);else l[a]==b&&(f[f.length]=l)}return f},_dataChangedCount:0,_dataChanged:function(a){this._dataChangedCount++;"update"!=a&&(this.visibleRows=this.dataview=this.ids=null,"collapse"!=a&&"expand"!=a&&"loaddata"!=a&&(this.list=null));0==this.__changeCount&&this.fire("datachanged")},_createDataView:function(){return this.viewNodes?this.getChildNodes(this.root,!0):this.getList()},_createVisibleRows:function(){function a(a){return f?e[a._id]:a[d]}function b(d){for(var e=0,f=d.length;e<f;e++)g=d[e],c[c.length]=g,!1!==g.expanded&&(k=a(g))&&b(k)}var c=[],d=this.nodesField,e=this.viewNodes,f=!!e,g,k;b(a(this.root));return c},getList:function(){this.list||(this.list=mini.treeToList(this.source,this.nodesField));return this.list},getDataView:function(){this.dataview||(this.dataview=this._createDataView());return this.dataview},getVisibleRows:function(){this.visibleRows||(this.visibleRows=this._createVisibleRows());return this.visibleRows},_doFilter:function(){function a(f){var g=f[e];if(!g)return!1;f=d[f._id]=[];for(var k=0,l=g.length;k<l;k++){var n=g[k],p=a(n);(!0===b.call(c,n,k,this)||p)&&f.push(n)}return 0<f.length}if(this._filterInfo){var b=this._filterInfo[0],c=this._filterInfo[1],d=this.viewNodes={},e=this.nodesField;a(this.root)}else this.viewNodes=null},_doSort:function(){function a(e){e=g.getChildNodes(e);mini.sort(e,b,c);d&&e.reverse();for(var f=0,k=e.length;f<k;f++)a(e[f])}if(!this._filterInfo&&!this._sortInfo)this.viewNodes=null;else if(this._sortInfo){var b=this._sortInfo[0],c=this._sortInfo[1],d=this._sortInfo[2],e=this.nodesField;if(!this.viewNodes){var f=this.viewNodes={};f[this.root._id]=this.root[e].clone();this.cascadeChild(this.root,function(a,b,c){(b=a[e])&&(f[a._id]=b.clone())})}var g=this;a(this.root)}},toArray:function(){this._array&&this._dataChangedCount==this._dataChangedCount2||(this._dataChangedCount2=this._dataChangedCount,this._array=this.getChildNodes(this.root,!0,!1));return this._array},toTree:function(){return this.root[this.nodesField]},isChanged:function(){return 0<this.getChanges().length},getChanges:function(a,b){var c=[];"removed"!=a&&null!=a||c.addRange(this._removeds.clone());for(var d=this.getAllChildNodes(this.root,!1),e=0,f=d.length;e<f;e++){var g=d[e];null==g._state||""==g._state||g._state!=a&&null!=a||(c[c.length]=g)}if(b)for(e=0,f=c.length;e<f;e++)if(d=c[e],"modified"==d._state){g={};g._state=d._state;g[this.idField]=d[this.idField];for(var k in d)this.isModified(d,k)&&(g[k]=d[k]);c[e]=g}return c},accept:function(a){this.beginChange();this.cascadeChild(this.root,function(a){this.acceptRecord(a)},this);this._removeds=[];this._originals={};this.endChange()},reject:function(a){this.beginChange();this.cascadeChild(this.root,function(a){this.rejectRecord(a)},this);this._removeds=[];this._originals={};this.endChange()},acceptRecord:function(a){a._state&&(delete this._originals[a[this._originalIdField]],"deleted"==a._state?this.removeNode(a):(delete a._state,delete this._originals[a[this._originalIdField]],this._dataChanged(),this.fire("update",{record:a})))},rejectRecord:function(a){if(a._state)if("added"==a._state)this.removeNode(a);else if("modified"==a._state||"deleted"==a._state){var b=this._getOriginal(a);mini.copyTo(a,b);delete a._state;delete this._originals[a[this._originalIdField]];this._dataChanged();this.fire("update",{record:a})}},upGrade:function(a){var b=this.getParentNode(a);if(b==this.root||a==this.root)return!1;for(var c=b[this.nodesField],d=c.indexOf(a),e=a[this.nodesField]?a[this.nodesField].length:0,f=c.length-1;f>=d;f--){var g=c[f];c.removeAt(f);g!=a&&(a[this.nodesField]||(a[this.nodesField]=[]),a[this.nodesField].insert(e,g))}c=this.getParentNode(b);e=c[this.nodesField];d=e.indexOf(b);e.insert(d+1,a);this._updateParentAndLevel(a,c);this._doFilter();this._dataChanged()},downGrade:function(a){if(this.isFirstNode(a))return!1;var b=this.getParentNode(a)[this.nodesField],c=b.indexOf(a),d=b[c-1];b.removeAt(c);d[this.nodesField]||(d[this.nodesField]=[]);d[this.nodesField].add(a);this._updateParentAndLevel(a,d);this._doFilter();this._dataChanged()},_updateParentAndLevel:function(a,b){var c=this;a._pid=b._id;a._level=b._level+1;a[c.parentField]=b[c.idField];a[c.parentField]||(a[c.parentField]=b._id);this.cascadeChild(a,function(a,b,f){a._pid=f._id;a._level=f._level+1;a[c.parentField]=f[c.idField]},this);this._setModified(a)},setCheckModel:function(a){this.checkModel=a},getCheckModel:function(){return this.checkModel},setOnlyLeafCheckable:function(a){this.onlyLeafCheckable=a},getOnlyLeafCheckable:function(){return this.onlyLeafCheckable},setAutoCheckParent:function(a){this.autoCheckParent=a},getAutoCheckParent:function(){return this.autoCheckParent},_doUpdateLoadedCheckedNodes:function(){for(var a=this.getList(),b=0,c=a.length;b<c;b++){var d=a[b];1==d.checked&&(0!=this.autoCheckParent&&this.hasChildNodes(d)||this._doUpdateNodeCheckState(d))}},_doUpdateNodeCheckState:function(a){function b(a){a=q.getChildNodes(a);for(var b=0,c=a.length;b<c;b++)if(q.isCheckedNode(a[b]))return!0;return!1}if(a){var c=this.isChecked(a);if("cascade"==this.checkModel||this.autoCheckParent)if(this.cascadeChild(a,function(a){this.doCheckNodes(a,c)},this),!this.autoCheckParent){var d=this.getAncestors(a);d.reverse();for(var e=0,f=d.length;e<f;e++){for(var g=d[e],k=this.getChildNodes(g),l=!0,n=0,p=k.length;n<p;n++)this.isCheckedNode(k[n])||(l=!1);l?this.doCheckNodes(g,!0):this.doCheckNodes(g,!1);this.fire("checkchanged",{nodes:[g],_nodes:[g]})}}var q=this;if(this.autoCheckParent)for(d=this.getAncestors(a),d.reverse(),e=0,f=d.length;e<f;e++)g=d[e],g.checked=b(g),this.fire("checkchanged",{nodes:[g],_nodes:[g]})}},doCheckNodes:function(a,b,c){if(a){"string"==typeof a&&(a=a.split(","));mini.isArray(a)||(a=[a]);a=a.clone();var d=[];b=!1!==b;!0===c&&"single"==this.checkModel&&this.uncheckAllNodes();for(var e=a.length-1;0<=e;e--){var f=this.getRecord(a[e]);!f||b&&!0===f.checked||!b&&!0!==f.checked?f&&(!0===c&&this._doUpdateNodeCheckState(f),b||this.isLeaf(f)||d.push(f)):(f.checked=b,d.push(f),!0===c&&this._doUpdateNodeCheckState(f))}var g=this;setTimeout(function(){g.fire("_checkchanged",{nodes:a,_nodes:d,checked:b})},1)}},checkNode:function(a,b){this.doCheckNodes([a],!0,!1!==b)},uncheckNode:function(a,b){this.doCheckNodes([a],!1,!1!==b)},checkNodes:function(a,b){mini.isArray(a)||(a=[]);this.doCheckNodes(a,!0,!1!==b)},uncheckNodes:function(a,b){mini.isArray(a)||(a=[]);this.doCheckNodes(a,!1,!1!==b)},checkAllNodes:function(){var a=this.getList();this.doCheckNodes(a,!0,!1)},uncheckAllNodes:function(){var a=this.getList();this.doCheckNodes(a,!1,!1)},doGetCheckedNodes:function(a,b){!1===b&&(b="leaf");for(var c=[],d={},e=0,f=a.length;e<f;e++){var g=a[e],k=this.isLeafNode(g);if(!0===b){d[g._id]||(d[g._id]=g,c.push(g));for(var g=this.getAncestors(g),k=0,l=g.length;k<l;k++){var n=g[k];d[n._id]||(d[n._id]=n,c.push(n))}}else"parent"===b?k||d[g._id]||(d[g._id]=g,c.push(g)):"leaf"===b?k&&!d[g._id]&&(d[g._id]=g,c.push(g)):d[g._id]||(d[g._id]=g,c.push(g))}return c},getCheckedNodes:function(a){var b=[];this.cascadeChild(this.root,function(a){1==a.checked&&b.push(a)});return b=this.doGetCheckedNodes(b,a)},getCheckedNodesId:function(a,b){var c=this.getCheckedNodes(a);return this.getValueAndText(c,b)[0]},getCheckedNodesText:function(a,b){var c=this.getCheckedNodes(a);return this.getValueAndText(c,b)[1]},isChecked:function(a){return(a=this.getRecord(a))?!0===a.checked||1===a.checked:null},getCheckState:function(a){a=this.getRecord(a);if(!a)return null;if(!0===a.checked)return"checked";if(!a[this.nodesField])return"unchecked";if(a.indeterminate)return"indeterminate";for(var b=this.getChildNodes(a,!0),c=0,d=b.length;c<d;c++)if(a=b[c],!0===a.checked)return"indeterminate";return"unchecked"},getUnCheckableNodes:function(){var a=[];this.cascadeChild(this.root,function(b){0==this.getCheckable(b)&&a.push(b)},this);return a},setCheckable:function(a,b){if(a){mini.isArray(a)||(a=[a]);a=a.clone();for(var c=a.length-1;0<=c;c--){var d=this.getRecord(a[c]);d&&(d.checkable=checked)}}},getCheckable:function(a){return(a=this.getRecord(a))?!0===a.checkable?!0:!1===a.checkable?!1:this.isLeafNode(a)?!0:!this.onlyLeafCheckable:!1},showNodeCheckbox:function(a,b){},reload:function(a,b,c){this._loadingNode=null;this.load(this.loadParams,a,b,c)},_isNodeLoading:function(){return!!this._loadingNode},loadNode:function(a,b){this._loadingNode=a;this.fire("beforeloadnode",{node:a});var c=new Date,d=this;d._doLoadAjax(d.loadParams,null,null,null,function(e){var f=new Date-c;60>f&&(f=60-f);setTimeout(function(){e.node=a;d._OnPreLoad(e);d._loadingNode=null;d.loadParams&&delete d.loadParams[d.idField];d.removeNodes(a[d.nodesField]);var c=e.data;if(c&&0<c.length){d.collapse(a);d.addNodes(c,a);for(var c=d.getAllChildNodes(a),f=0,l=c.length;f<l;f++)delete c[f]._state;!1!==b?d.expand(a,!0):d.collapse(a,!0)}else delete a[d.leafField],d.expand(a,!0);d.fire("loadnode",e);d.fire("load",e)},f)},!0)}});mini.regClass(mini.DataTree,"datatree");mini._DataTableApplys={idField:"id",textField:"text",setAjaxData:function(a){this._dataSource.ajaxData=a},getby_id:function(a){return this._dataSource.getby_id(a)},getValueAndText:function(a,b){return this._dataSource.getValueAndText(a,b)},setIdField:function(a){this._dataSource.setIdField(a);this.idField=a},getIdField:function(){return this._dataSource.idField},setTextField:function(a){this._dataSource.setTextField(a);this.textField=a},getTextField:function(){return this._dataSource.textField},getLoadParams:function(){return this._dataSource.loadParams},clearData:function(){this._dataSource.clearData()},loadData:function(a){this._dataSource.loadData(a)},setData:function(a){this._dataSource.loadData(a)},getData:function(){return this._dataSource.getSource().clone()},getList:function(){return this._dataSource.getList()},getDataView:function(){return this._dataSource.getDataView()},getVisibleRows:function(){return this._useEmptyView?[]:this._dataSource.getVisibleRows()},toArray:function(){return this._dataSource.toArray()},getRecord:function(a){return"object"==typeof a?a:this._dataSource.getRecord(a)},getRow:function(a){return"object"==typeof a?a:this._dataSource.getRow(a)},getRange:function(a,b){if(!mini.isNull(a)&&!mini.isNull(b))return this._dataSource.getRange(a,b)},getAt:function(a){return this._dataSource.getAt(a)},indexOf:function(a){return this._dataSource.indexOf(a)},getRowByUID:function(a){return this._dataSource.getby_id(a)},getRowByUid:function(a){return this.getRowByUID(a)},getRowById:function(a){return this._dataSource.getbyId(a)},clearRows:function(){this._dataSource.clearData()},updateRow:function(a,b,c){this._dataSource.updateRecord(a,b,c)},addRow:function(a,b){var c=this._dataSource.insert(b,a);this.validateOnAdd&&this.validateRow(a);return c},removeRow:function(a,b){return this._dataSource.remove(a,b)},removeRows:function(a,b){return this._dataSource.removeRange(a,b)},removeSelected:function(){var a=this.getSelected();a&&this.removeRow(a,!0)},removeRowAt:function(a,b){return this._dataSource.removeAt(a,b)},moveRow:function(a,b){this._dataSource.move(a,b)},addRows:function(a,b){return this._dataSource.insertRange(b,a)},findRows:function(a,b){return this._dataSource.findRecords(a,b)},findRow:function(a,b){return this._dataSource.findRecord(a,b)},multiSelect:!1,setMultiSelect:function(a){this._dataSource.setMultiSelect(a);this.multiSelect=a},getMultiSelect:function(){return this._dataSource.getMultiSelect()},setCurrent:function(a){this._dataSource.setCurrent(a)},getCurrent:function(){return this._dataSource.getCurrent()},isSelected:function(a){return this._dataSource.isSelected(a)},setSelected:function(a){this._dataSource.setSelected(a)},getSelected:function(){return this._dataSource.getSelected()},getSelecteds:function(){return this._dataSource.getSelecteds()},select:function(a,b){this._dataSource.select(a,b)},selects:function(a,b){this._dataSource.selects(a,b)},deselect:function(a,b){this._dataSource.deselect(a,b)},deselects:function(a,b){this._dataSource.deselects(a,b)},selectAll:function(a){this._dataSource.selectAll(a)},deselectAll:function(a){this._dataSource.deselectAll(a)},clearSelect:function(a){this.deselectAll(a)},selectPrev:function(){this._dataSource.selectPrev()},selectNext:function(){this._dataSource.selectNext()},selectFirst:function(){this._dataSource.selectFirst()},selectLast:function(){this._dataSource.selectLast()},selectRange:function(a,b){this._dataSource.selectRange(a,b)},filter:function(a,b){this._dataSource.filter(a,b)},clearFilter:function(){this._dataSource.clearFilter()},sort:function(a,b,c){this._dataSource.sort(a,b,c)},clearSort:function(){this._dataSource.clearSort()},findItems:function(a,b,c){return this._dataSource.findRecords(c,b,c)},getResultObject:function(){return this._dataSource._resultObject||{}},isChanged:function(){return this._dataSource.isChanged()},getChanges:function(a,b){return this._dataSource.getChanges(a,b)},accept:function(){this._dataSource.accept()},reject:function(){this._dataSource.reject()},acceptRecord:function(a){this._dataSource.acceptRecord(a)},rejectRecord:function(a){this._dataSource.rejectRecord(a)}};mini._DataTreeApplys={addRow:null,removeRow:null,removeRows:null,removeRowAt:null,moveRow:null,setExpandOnLoad:function(a){this._dataSource.setExpandOnLoad(a)},getExpandOnLoad:function(){return this._dataSource.getExpandOnLoad()},isSelectedNode:function(a){a=this.getNode(a);return this.getSelectedNode()===a},selectNode:function(a,b){a?this._dataSource.select(a,b):this._dataSource.deselect(this.getSelectedNode(),b)},getSelectedNode:function(){return this.getSelected()},getSelectedNodes:function(){return this.getSelecteds()},updateNode:function(a,b,c){this._dataSource.updateRecord(a,b,c)},addNode:function(a,b,c){return this._dataSource.insertNode(a,b,c)},removeNodeAt:function(a,b){return this._dataSource.removeNodeAt(a,b)},removeNode:function(a){return this._dataSource.removeNode(a)},moveNode:function(a,b,c){this._dataSource.moveNode(a,b,c)},addNodes:function(a,b,c){return this._dataSource.addNodes(a,b,c)},insertNodes:function(a,b,c){return this._dataSource.insertNodes(b,a,c)},moveNodes:function(a,b,c){this._dataSource.moveNodes(a,b,c)},removeNodes:function(a){return this._dataSource.removeNodes(a)},expandOnLoad:!1,checkRecursive:!0,autoCheckParent:!1,showFolderCheckBox:!0,idField:"id",textField:"text",parentField:"pid",nodesField:"children",checkedField:"checked",leafField:"isLeaf",resultAsTree:!0,setShowFolderCheckBox:function(a){this._dataSource.setShowFolderCheckBox(a);this.doUpdate&&this.doUpdate();this.showFolderCheckBox=a},getShowFolderCheckBox:function(){return this._dataSource.getShowFolderCheckBox()},setCheckRecursive:function(a){this._dataSource.setCheckRecursive(a);this.checkRecursive=a},getCheckRecursive:function(){return this._dataSource.getCheckRecursive()},setResultAsTree:function(a){this._dataSource.setResultAsTree(a)},getResultAsTree:function(a){return this._dataSource.resultAsTree},setParentField:function(a){this._dataSource.setParentField(a);this.parentField=a},getParentField:function(){return this._dataSource.parentField},setLeafField:function(a){this.leafField=this._dataSource.leafField=a},getLeafField:function(){return this._dataSource.leafField},setNodesField:function(a){this._dataSource.setNodesField(a);this.nodesField=a},getNodesField:function(){return this._dataSource.nodesField},setCheckedField:function(a){this.checkedField=this._dataSource.checkedField=a},getCheckedField:function(){return this.checkedField},findNodes:function(a,b){return this._dataSource.findRecords(a,b)},getLevel:function(a){return this._dataSource.getLevel(a)},isVisibleNode:function(a){return this._dataSource.isVisibleNode(a)},isEnabledNode:function(a){return this._dataSource.isEnabledNode(a)},isExpandedNode:function(a){return this._dataSource.isExpandedNode(a)},isCheckedNode:function(a){return this._dataSource.isCheckedNode(a)},isLeaf:function(a){return this._dataSource.isLeafNode(a)},hasChildren:function(a){return this._dataSource.hasChildren(a)},isAncestor:function(a,b){return this._dataSource.isAncestor(a,b)},getNode:function(a){return this._dataSource.getRecord(a)},getRootNode:function(){return this._dataSource.getRootNode()},getParentNode:function(a){return this._dataSource.getParentNode.apply(this._dataSource,arguments)},getAncestors:function(a){return this._dataSource.getAncestors(a)},getAllChildNodes:function(a){return this._dataSource.getAllChildNodes.apply(this._dataSource,arguments)},getChildNodes:function(a,b){return this._dataSource.getChildNodes.apply(this._dataSource,arguments)},getChildNodeAt:function(a,b){return this._dataSource.getChildNodeAt.apply(this._dataSource,arguments)},indexOfNode:function(a){return this._dataSource.indexOfNode.apply(this._dataSource,arguments)},hasChildNodes:function(a){return this._dataSource.hasChildNodes.apply(this._dataSource,arguments)},isFirstNode:function(a){return this._dataSource.isFirstNode.apply(this._dataSource,arguments)},isLastNode:function(a){return this._dataSource.isLastNode.apply(this._dataSource,arguments)},getNextNode:function(a){return this._dataSource.getNextNode.apply(this._dataSource,arguments)},getPrevNode:function(a){return this._dataSource.getPrevNode.apply(this._dataSource,arguments)},getFirstNode:function(a){return this._dataSource.getFirstNode.apply(this._dataSource,arguments)},getLastNode:function(a){return this._dataSource.getLastNode.apply(this._dataSource,arguments)},toggleNode:function(a){this._dataSource.toggle(a)},collapseNode:function(a,b){this._dataSource.collapse(a,b)},expandNode:function(a,b){this._dataSource.expand(a,b)},collapseAll:function(){this.useAnimation=!1;this._dataSource.collapseAll();this.useAnimation=!0},expandAll:function(){this.useAnimation=!1;this._dataSource.expandAll();this.useAnimation=!0},expandLevel:function(a){this.useAnimation=!1;this._dataSource.expandLevel(a);this.useAnimation=!0},collapseLevel:function(a){this.useAnimation=!1;this._dataSource.collapseLevel(a);this.useAnimation=!0},expandPath:function(a){this.useAnimation=!1;this._dataSource.expandPath(a);this.useAnimation=!0},collapsePath:function(a){this.useAnimation=!1;this._dataSource.collapsePath(a);this.useAnimation=!0},loadNode:function(a,b){this._dataSource.loadNode(a,b)},setCheckModel:function(a){this._dataSource.setCheckModel(a)},getCheckModel:function(){return this._dataSource.getCheckModel()},setOnlyLeafCheckable:function(a){this._dataSource.setOnlyLeafCheckable(a)},getOnlyLeafCheckable:function(){return this._dataSource.getOnlyLeafCheckable()},setAutoCheckParent:function(a){this._dataSource.setAutoCheckParent(a)},getAutoCheckParent:function(){return this._dataSource.getAutoCheckParent()},checkNode:function(a,b){this._dataSource.checkNode(a,b)},uncheckNode:function(a,b){this._dataSource.uncheckNode(a,b)},checkNodes:function(a,b){this._dataSource.checkNodes(a,b)},uncheckNodes:function(a,b){this._dataSource.uncheckNodes(a,b)},checkAllNodes:function(){this._dataSource.checkAllNodes()},uncheckAllNodes:function(){this._dataSource.uncheckAllNodes()},getCheckedNodes:function(){return this._dataSource.getCheckedNodes.apply(this._dataSource,arguments)},getCheckedNodesId:function(){return this._dataSource.getCheckedNodesId.apply(this._dataSource,arguments)},getCheckedNodesText:function(){return this._dataSource.getCheckedNodesText.apply(this._dataSource,arguments)},getNodesByValue:function(a){mini.isNull(a)&&(a="");a=String(a);var b=[];a=String(a).split(",");for(var c=0,d=a.length;c<d;c++){var e=this.getNode(a[c]);e&&b.push(e)}return b},isChecked:function(a){return this._dataSource.isChecked.apply(this._dataSource,arguments)},getCheckState:function(a){return this._dataSource.getCheckState.apply(this._dataSource,arguments)},setCheckable:function(a,b){this._dataSource.setCheckable.apply(this._dataSource,arguments)},getCheckable:function(a){return this._dataSource.getCheckable.apply(this._dataSource,arguments)},bubbleParent:function(a,b,c){this._dataSource.bubbleParent.apply(this._dataSource,arguments)},cascadeChild:function(a,b,c){this._dataSource.cascadeChild.apply(this._dataSource,arguments)},eachChild:function(a,b,c){this._dataSource.eachChild.apply(this._dataSource,arguments)}};mini.ColumnModel=function(a){this.owner=a;mini.ColumnModel.superclass.constructor.apply(this,arguments);this._init()};mini.ColumnModel_ColumnID=1;mini.extend(mini.ColumnModel,mini.Component,{_defaultColumnWidth:100,_init:function(){this.columns=[];this._columnsRow=[];this._visibleColumnsRow=[];this._bottomColumns=[];this._visibleColumns=[];this._idColumns={};this._nameColumns={};this._fieldColumns={}},getColumns:function(){return this.columns},getAllColumns:function(){var a=[],b;for(b in this._idColumns)a.push(this._idColumns[b]);return a},getColumnsRow:function(){return this._columnsRow},getVisibleColumnsRow:function(){return this._visibleColumnsRow},getBottomColumns:function(){return this._bottomColumns},getVisibleColumns:function(){return this._visibleColumns},_getBottomColumnsByColumn:function(a){a=this.getColumn(a);for(var b=this._bottomColumns,c=[],d=0,e=b.length;d<e;d++){var f=b[d];this.isAncestorColumn(a,f)&&c.push(f)}return c},_getVisibleColumnsByColumn:function(a){a=this.getColumn(a);for(var b=this._visibleColumns,c=[],d=0,e=b.length;d<e;d++){var f=b[d];this.isAncestorColumn(a,f)&&c.push(f)}return c},setColumns:function(a){mini.isArray(a)||(a=[]);this._init();this.columns=a;this._columnsChanged()},_columnsChanged:function(){this._updateColumnsView();this.fire("columnschanged")},columnDefaults:{allowCellWrap:!1},_updateColumnsView:function(){function a(c,d,e){if(c.type&&(mini.isNull(c.header)||"function"===typeof c.header||""==c.header.trim()&&delete c.header,d=mini._getColumn(c.type))){var f=mini.copyTo({},c);mini.copyTo(c,d);mini.copyTo(c,f)}c._id||(c._id=mini.ColumnModel_ColumnID++);c._pid=e==this?-1:e._id;this._idColumns[c._id]=c;c.name&&(this._nameColumns[c.name]=c);c._level=b;b+=1;this.eachColumns(c,a,this);--b;c._level>this._maxColumnLevel&&(this._maxColumnLevel=c._level);e=parseInt(c.width);mini.isNumber(e)&&String(e)==c.width&&(c.width=e+"px");mini.isNull(c.width)&&(c.width=this._defaultColumnWidth+"px");String(c.width).indexOf("px")&&(c.pxWidth=parseInt(c.width));c.visible=!1!==c.visible;c.allowResize=!1!==c.allowResize;c.allowMove=!1!==c.allowMove;c.allowSort=!0===c.allowSort;c.allowDrag=!!c.allowDrag;c.readOnly=!!c.readOnly;c.autoEscape=!!c.autoEscape;c.enabled=!1!==c.enabled;c.showCellTip=!1!==c.showCellTip;c.valueFromSelect=!1!==c.valueFromSelect;c.vtype=c.vtype||"";null==c.allowCellWrap&&(c.allowCellWrap=this.columnDefaults.allowCellWrap);"string"==typeof c.filter&&(c.filter=window.eval("("+c.filter+")"));c.filter&&!c.filter.el&&(c.filter=mini.create(c.filter));"function"==typeof c.init&&1!=c.inited&&c.init(this.owner);c.inited=!0;c._gridUID=this.owner.uid;c._rowIdField=this.owner._rowIdField}var b=this._maxColumnLevel=0;this.eachColumns(this,a,this);this._createColumnsRow();var c=0,d=this._visibleColumns=[],e=this._bottomColumns=[];this.cascadeColumns(this,function(a){a.columns&&0!=a.columns.length||(e.push(a),this.isVisibleColumn(a)&&(d.push(a),a._index=c++))},this);this._fieldColumns={};for(var f=this.getAllColumns(),g=0,k=f.length;g<k;g++){var l=f[g];l.field&&!this._fieldColumns[l.field]&&(this._fieldColumns[l.field]=l)}this._createFrozenColSpan()},_frozenStartColumn:-1,_frozenEndColumn:-1,isFrozen:function(){return 0<=this._frozenStartColumn&&this._frozenEndColumn>=this._frozenStartColumn},isFrozenColumn:function(a){if(!this.isFrozen())return!1;a=this.getColumn(a);if(!a)return!1;a=this.getVisibleColumns().indexOf(a);return this._frozenStartColumn<=a&&a<=this._frozenEndColumn},frozen:function(a,b){a=this.getColumn(a);b=this.getColumn(b);var c=this.getVisibleColumns();this._frozenStartColumn=c.indexOf(a);this._frozenEndColumn=c.indexOf(b);a&&b&&this._columnsChanged()},unFrozen:function(){this._frozenEndColumn=this._frozenStartColumn=-1;this._columnsChanged()},setFrozenStartColumn:function(a){this.frozen(a,this._frozenEndColumn)},setFrozenEndColumn:function(a){this.frozen(this._frozenStartColumn,a)},getFrozenColumns:function(){for(var a=[],b=this.isFrozen(),c=0,d=this._visibleColumns.length;c<d;c++)b&&this._frozenStartColumn<=c&&c<=this._frozenEndColumn&&a.push(this._visibleColumns[c]);return a},getUnFrozenColumns:function(){for(var a=[],b=this.isFrozen(),c=0,d=this._visibleColumns.length;c<d;c++)(b&&c>this._frozenEndColumn||!b)&&a.push(this._visibleColumns[c]);return a},getFrozenColumnsRow:function(){return this.isFrozen()?this._columnsRow1:[]},getUnFrozenColumnsRow:function(){return this.isFrozen()?this._columnsRow2:this.getVisibleColumnsRow()},_createFrozenColSpan:function(){function a(a,b){for(var g=c.isBottomColumn(a)?[a]:c._getVisibleColumnsByColumn(a),k=0,l=g.length;k<l;k++){var n=d.indexOf(g[k]);if(0==b&&n<e||1==b&&e<=n&&n<=f||2==b&&n>f)return!0}return!1}function b(b,d){for(var e=mini.treeToList(b.columns,"columns"),f=0,g=0,k=e.length;g<k;g++){var l=e[g];0!=c.isVisibleColumn(l)&&0!=a(l,d)&&(l.columns&&0!=l.columns.length||(f+=1))}return f}for(var c=this,d=this.getVisibleColumns(),e=this._frozenStartColumn,f=this._frozenEndColumn,g=mini.treeToList(this.columns,"columns"),k=0,l=g.length;k<l;k++){var n=g[k];delete n.colspan0;delete n.colspan1;delete n.colspan2;delete n.viewIndex0;delete n.viewIndex1;delete n.viewIndex2;this.isFrozen()&&(n.columns&&0<n.columns.length?(n.colspan1=b(n,1),n.colspan2=b(n,2),n.colspan0=b(n,0)):(n.colspan1=1,n.colspan2=1,n.colspan0=1),a(n,0)&&(n.viewIndex0=!0),a(n,1)&&(n.viewIndex1=!0),a(n,2)&&(n.viewIndex2=!0))}this._getMaxColumnLevel();this._columnsRow1=[];this._columnsRow2=[];k=0;for(l=this._visibleColumnsRow.length;k<l;k++){var g=this._visibleColumnsRow[k],n=[],p=[];this._columnsRow1.push(n);this._columnsRow2.push(p);for(var q=0,r=g.length;q<r;q++){var t=g[q];t.viewIndex1&&n.push(t);t.viewIndex2&&p.push(t)}}},_createColumnsRow:function(){for(var a=this._getMaxColumnLevel(),b=[],c=[],d=0,e=a;d<=e;d++)b.push([]),c.push([]);for(var f=mini.treeToList(this.columns,"columns"),d=0,e=f.length;d<e;d++){var g=f[d],k=b[g._level],l=c[g._level];delete g.rowspan;delete g.colspan;if(g.columns&&0<g.columns.length){for(var n=g,p=mini.treeToList(g.columns,"columns"),q=0,r=0,t=p.length;r<t;r++){var u=p[r];0!=this.isVisibleColumn(u)&&(u.columns&&0!=u.columns.length||(q+=1))}n.colspan=q}(!g.columns||0==g.columns.length)&&g._level<a&&(g.rowspan=a-g._level+1);k.push(g);this.isVisibleColumn(g)&&l.push(g)}this._columnsRow=b;this._visibleColumnsRow=c},_getMaxColumnLevel:function(){return this._maxColumnLevel},cascadeColumns:function(a,b,c){if(b){var d=a.columns;if(d)for(var d=d.clone(),e=0,f=d.length;e<f;e++){var g=d[e];if(!1===b.call(c||this,g,e,a))break;this.cascadeColumns(g,b,c)}}},eachColumns:function(a,b,c){var d=a.columns;if(d)for(var d=d.clone(),e=0,f=d.length;e<f&&!1!==b.call(c,d[e],e,a);e++);},getColumn:function(a){var b=typeof a;return"number"==b?this._bottomColumns[a]:"object"==b?a:this._nameColumns[a]},getColumnByField:function(a){return a?this._fieldColumns[a]:null},_getColumnById:function(a){return this._idColumns[a]},_getDataTypeByField:function(a){for(var b="string",c=this.getBottomColumns(),d=0,e=c.length;d<e;d++){var f=c[d];if(f.field==a){f.sortType?b=f.sortType.toLowerCase():f.dataType&&(b=f.dataType.toLowerCase());break}}return b},getParentColumn:function(a){a=this.getColumn(a);a=a._pid;return-1==a?this:this._idColumns[a]},getAncestorColumns:function(a){for(var b=[a];;){a=this.getParentColumn(a);if(!a||a==this)break;b[b.length]=a}b.reverse();return b},isAncestorColumn:function(a,b){if(a==b)return!0;if(!a||!b)return!1;for(var c=this.getAncestorColumns(b),d=0,e=c.length;d<e;d++)if(c[d]==a)return!0;return!1},isVisibleColumn:function(a){a=this.getColumn(a);if(0==a.visible)return!1;for(var b=this.getAncestorColumns(a),c=0,d=b.length;c<d;c++)if(0==b[c].visible)return!1;if(a=a.columns){b=!0;c=0;for(d=a.length;c<d;c++)if(this.isVisibleColumn(a[c])){b=!1;break}if(b)return!1}return!0},isBottomColumn:function(a){a=this.getColumn(a);return!(a.columns&&0<a.columns.length)},updateColumn:function(a,b){if(a=this.getColumn(a))mini.copyTo(a,b),this._columnsChanged()},moveColumn:function(a,b,c){a=this.getColumn(a);b=this.getColumn(b);if(a&&b&&c&&a!=b&&!this.isAncestorColumn(a,b)){var d=this.getParentColumn(a);d&&d.columns.remove(a);d=b;if("before"==c)d=this.getParentColumn(b),c=d.columns.indexOf(b);else if("after"==c)d=this.getParentColumn(b),c=d.columns.indexOf(b)+1;else if("add"==c||"append"==c)d.columns||(d.columns=[]),c=d.columns.length;else if(!mini.isNumber(c))return;d.columns.insert(c,a);this._columnsChanged()}},addColumn:function(a){a&&(delete a._id,this._columnsChanged())},removeColumn:function(){this._columnsChanged()}});mini.GridView=function(){this._createTime=new Date;this._createColumnModel();this._bindColumnModel();this.data=[];this._createSource();this._bindSource();this._initData();mini.GridView.superclass.constructor.apply(this,arguments);this._doUpdateFilterRow();this._doUpdateSummaryRow();this.doUpdate();if(mini.isNull(this._paddingTop)){if(mini.isNull(mini.GridView._paddingTop)){var a=jQuery('\x3cdiv class\x3d"mini-grid-cell-inner" style\x3d"position:absolute;left:-1000px;top:-1000px;"\x3e\x3c/div\x3e').appendTo("body"),a=mini.getPaddings(a);mini.GridView._paddingTop=a.top;mini.GridView._paddingBottom=a.bottom}this._paddingTop=mini.GridView._paddingTop;this._paddingBottom=mini.GridView._paddingBottom}this._rowClsHash={}};mini.extend(mini.GridView,mini.Panel,{_displayStyle:"block",_rowIdField:"_id",width:"100%",showSortIcon:!1,showColumns:!0,showFilterRow:!1,showSummaryRow:!1,summaryRows:1,showPager:!1,allowCellWrap:!1,allowHeaderWrap:!1,showModified:!0,showNewRow:!0,showEmptyText:!1,emptyText:"No data returned.",showHGridLines:!0,showVGridLines:!0,_rowCls:"mini-grid-row",_cellCls:"mini-grid-cell",_headerCellCls:"mini-grid-headerCell",_rowSelectedCls:"mini-grid-row-selected",_rowHoverCls:"mini-grid-row-hover",_cellSelectedCls:"mini-grid-cell-selected",defaultRowHeight:25,fixedRowHeight:!1,isFixedRowHeight:function(){return this.fixedRowHeight},fitColumns:!0,isFitColumns:function(){return this.fitColumns},allowAlternating:!1,_alternatingCls:"mini-grid-row-alt",getAllowAlternating:function(){return this.allowAlternating},setAllowAlternating:function(a){this.allowAlternating=a;this.doUpdate()},showGroupSummary:!1,getShowGroupSummary:function(){return this.showGroupSummary},setShowGroupSummary:function(a){this.showGroupSummary=a},summaryPosition:"bottom",getSummaryPosition:function(){return this.summaryPosition},setSummaryPosition:function(a){this.summaryPosition=a;"top"==this.summaryPosition&&(mini.before(this._rowsEl,this._summaryEl),mini.before(this._summaryViewEl,this._summaryLockEl));jQuery(this.el).toggleClass("mini-grid-summary-top","top"==a)},uiCls:"mini-gridview",_create:function(){mini.GridView.superclass._create.call(this);mini.addClass(this.el,"mini-grid");mini.addClass(this._borderEl,"mini-grid-border");mini.addClass(this._viewportEl,"mini-grid-viewport");this._columnsEl=mini.after(this._toolbarEl,'\x3cdiv class\x3d"mini-grid-columns"\x3e\x3cdiv class\x3d"mini-grid-columns-view"\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-grid-scrollHeaderCell"\x3e\x3c/div\x3e\x3c/div\x3e');this._filterEl=mini.after(this._columnsEl,'\x3cdiv class\x3d"mini-grid-filterRow"\x3e\x3cdiv class\x3d"mini-grid-filterRow-view"\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-grid-scrollHeaderCell"\x3e\x3c/div\x3e\x3c/div\x3e');this._rowsEl=this._bodyEl;mini.addClass(this._rowsEl,"mini-grid-rows");this._summaryEl=mini.after(this._rowsEl,'\x3cdiv class\x3d"mini-grid-summaryRow"\x3e\x3cdiv class\x3d"mini-grid-summaryRow-view"\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-grid-scrollHeaderCell"\x3e\x3c/div\x3e\x3c/div\x3e');this._bottomPagerEl=mini.after(this._summaryEl,'\x3cdiv class\x3d"mini-grid-pager"\x3e\x3c/div\x3e');this._columnsViewEl=this._columnsEl.childNodes[0];this._rowsViewEl=mini.append(this._rowsEl,'\x3cdiv class\x3d"mini-grid-rows-view"\x3e\x3cdiv class\x3d"mini-grid-rows-content"\x3e\x3c/div\x3e\x3c/div\x3e');this._rowsViewContentEl=this._rowsViewEl.firstChild;this._filterViewEl=this._filterEl.childNodes[0];this._summaryViewEl=this._summaryEl.childNodes[0];this._focusEl=mini.append(this._borderEl,'\x3ca href\x3d"#" class\x3d"mini-grid-focus" style\x3d"position:absolute;left:0px;top:0px;width:0px;height:0px;outline:none;" hideFocus onclick\x3d"return false" \x3e\x3c/a\x3e');var a=this;mini.on(this._filterViewEl,"scroll",function(b){0<a._filterViewEl.scrollLeft&&(a._filterViewEl.scrollLeft=0)})},destroy:function(a){this._dataSource&&(this._dataSource.destroy(),this._dataSource=null);this._columnModel&&(this._columnModel.destroy(),this._columnModel=null);if(this._pagers){for(var b=this._pagers.clone(),c=0,d=b.length;c<d;c++)b[c].destroy(a);this._pagers=null}this._viewportEl&&mini.clearEvent(this._viewportEl);this._rowsViewEl&&mini.clearEvent(this._rowsViewEl);this._rowsEl&&mini.clearEvent(this._rowsEl);this._vscrollEl&&mini.clearEvent(this._vscrollEl);this._headerEl&&mini.clearEvent(this._headerEl);this._columnsEl&&(jQuery(this._columnsEl).unbind("mouseenter"),jQuery(this._columnsEl).unbind("mouseleave"));this._viewportEl=this._vscrollEl=this._bottomPager=this._filterViewEl=this._summaryViewEl=this._focusEl=this._columnsViewEl=this._topRightCellEl=this._rowsViewEl=this._rowsViewContentEl=this._columnsEl=this._rowsEl=this._filterEl=this._summaryEl=this._bottomPagerEl=null;mini.GridView.superclass.destroy.call(this,a)},_initEvents:function(){mini.GridView.superclass._initEvents.call(this);this._bindScrollEvent()},_bindScrollEvent:function(){var a=this;this._unbindScrollEvent();this._scrollBindTimer=setTimeout(function(){mini.on(a._rowsViewEl,"scroll",a.__OnRowViewScroll,a)},100)},_unbindScrollEvent:function(){this._scrollBindTimer&&(clearTimeout(this._scrollBindTimer),this._scrollBindTimer=null);mini.un(this._rowsViewEl,"scroll",this.__OnRowViewScroll,this)},_syncScrollOffset:function(a,b){this._unbindScrollEvent();null!=a&&(this._rowsViewEl.scrollLeft=a);null!=b&&(this._rowsViewEl.scrollTop=b);this._bindScrollEvent()},_sizeChanged:function(){mini.GridView.superclass._sizeChanged.call(this);var a=this.isAutoHeight();mini.isIE&&(a?mini.addClass(this._rowsViewEl,"mini-grid-hidden-y"):mini.removeClass(this._rowsViewEl,"mini-grid-hidden-y"))},_setBodyWidth:!1,doLayoutCardView:function(){var a=this._columnsViewEl.firstChild,b=this._rowsViewEl.scrollHeight>this._rowsViewEl.clientHeight+1?mini.getScrollOffset():0;a.parentNode.style.paddingRight=b+"px";a.style.width="100%"},doLayout:function(){function a(a){this.isFitColumns()?(e.style.width="100%",mini.isSafari||mini.isIE6?a.style.width=q+"px":n?(a.style.width="100%",a.parentNode.style.width="auto",f!=a&&(a.parentNode.style.paddingRight=mini.getScrollOffset()+"px"),mini.isIE8&&mini.removeClass(this._rowsViewEl,"mini-grid-hidden-y")):(a.style.width="100%",a.parentNode.style.width="auto",a.parentNode.style.paddingRight="0px",mini.isIE8&&mini.addClass(this._rowsViewEl,"mini-grid-hidden-y"))):(e.style.width="0px",a.style.width="0px",mini.isSafari||mini.isChrome||mini.isIE6||(a.parentNode.style.width="100%",a.parentNode.style.paddingRight="0px"))}var b=this;if(this.canLayout())if(mini.GridView.superclass.doLayout.call(this),this._stopLayout(),"cardview"==this.viewType)this.doLayoutCardView();else{var c=this._autoHeight;mini.isIE&&(c?mini.addClass(this._rowsViewEl,"mini-grid-hidden-y"):mini.removeClass(this._rowsViewEl,"mini-grid-hidden-y"));var d=this._columnsViewEl.firstChild,e=this._rowsViewContentEl.firstChild,f=this._filterViewEl.firstChild,g=this._summaryViewEl.firstChild,k=jQuery(this._columnsViewEl).height(),l=f.offsetHeight,n=this._rowsViewEl.scrollHeight>this._rowsViewEl.clientHeight+1,p=this._rowsViewEl.scrollWidth>this._rowsViewEl.clientWidth+1,q=this._rowsViewContentEl.parentNode.offsetWidth-(n?mini.getScrollOffset():0);a.call(this,d);a.call(this,f);a.call(this,g);this._syncScroll();var r=this;setTimeout(function(){mini.layout(r._filterEl);mini.layout(r._summaryEl)},10);mini.isIE6&&setTimeout(function(){a.call(b,d)},1);mini.isIE10&&(setTimeout(function(){r.isFitColumns()?(d.style.width="auto",d.offsetWidth,d.style.width="100%"):d.style.width="0px"},0),mini.repaint(e));this._topRightCellEl=this._columnsViewEl.childNodes[1];mini.isIE6&&(this._topRightCellEl.style.height=k);if(mini.isIE6||mini.isIE7)this._rowsViewContentEl.style.paddingBottom="0px",c&&p&&(this._rowsViewContentEl.style.paddingBottom="17px");this._filterViewEl.style.height=l+"px";f.style.width=this.isFitColumns()?q+"px":""}},setBody:function(){},_createTopRowHTML:function(a,b,c){b="";b=mini.isIE?mini.isIE6||mini.isIE7||!mini.boxModel?b+'\x3ctr style\x3d"display:none;height:0px;"\x3e':b+'\x3ctr style\x3d"height:0px;"\x3e':mini.isChrome&&c&&0==c.length?b+'\x3ctr style\x3d"height:1px;"\x3e':b+'\x3ctr style\x3d"height:0px;"\x3e';!1!==this._userEmptyTd&&(b+='\x3ctd style\x3d"height:0px;width:0;"\x3e\x3c/td\x3e');c=0;for(var d=a.length;c<d;c++){var e=a[c];b+='\x3ctd id\x3d"'+e._id+'" style\x3d"padding:0;border:0;margin:0;height:0px;';e.width&&(b+="width:"+e.width);e.minWidth&&(b+=";min-width:"+e.minWidth+"px");b+='" \x3e\x3c/td\x3e'}return b+'\x3ctd style\x3d"width:0px;"\x3e\x3c/td\x3e\x3c/tr\x3e'},_createColumnsHTML:function(a,b,c){c=c?c:this.getVisibleColumns();var d=['\x3ctable class\x3d"mini-grid-table" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0"\x3e'];d.push(this._createTopRowHTML(c));c=this.getSortField();for(var e=this.getSortOrder(),f=0,g=a.length;f<g;f++){var k=a[f];d[d.length]="\x3ctr\x3e";d[d.length]='\x3ctd style\x3d"width:0;"\x3e\x3c/td\x3e';for(var l=0,n=k.length;l<n;l++){var p=k[l],q=p.sortField||p.field,r=this._createHeaderText(p,b),t=this._createHeaderCellId(p,b),u="";c&&c==q&&(u="asc"==e?"mini-grid-asc":"mini-grid-desc");q="";0==this.allowHeaderWrap&&(q=" mini-grid-headerCell-nowrap ");d[d.length]='\x3ctd id\x3d"';d[d.length]=t;d[d.length]='" class\x3d"mini-grid-headerCell '+u+" "+(p.headerCls||"")+" ";p.columns&&0<p.columns.length||(d[d.length]=" mini-grid-bottomCell ");l==n-1&&(d[d.length]=" mini-grid-rightCell ");d[d.length]='" style\x3d"';p.headerStyle&&(d[d.length]=p.headerStyle+";");p.headerAlign&&(d[d.length]="text-align:"+p.headerAlign+";");d[d.length]='" ';p.rowspan&&(d[d.length]='rowspan\x3d"'+p.rowspan+'" ');this._createColumnColSpan(p,d,b);d[d.length]='\x3e\x3cdiv class\x3d"mini-grid-headerCell-outer"\x3e\x3cdiv class\x3d"mini-grid-headerCell-inner '+q+'"\x3e';d[d.length]=r;u?d[d.length]='\x3cspan class\x3d"mini-grid-sortIcon mini-icon"\x3e\x3c/span\x3e':this.showSortIcon&&p.allowSort&&(d[d.length]='\x3cspan class\x3d"mini-grid-allowsort mini-icon"\x3e\x3c/span\x3e');d[d.length]='\x3c/div\x3e\x3cdiv id\x3d"'+p._id+'" class\x3d"mini-grid-column-splitter"\x3e\x3c/div\x3e';d[d.length]="\x3c/div\x3e\x3c/td\x3e"}this.isFrozen()&&1==b&&(d[d.length]='\x3ctd class\x3d"mini-grid-headerCell" style\x3d"width:0;"\x3e\x3cdiv class\x3d"mini-grid-headerCell-inner" style\x3d"',d[d.length]='"\x3e0\x3c/div\x3e\x3c/td\x3e');d[d.length]="\x3c/tr\x3e"}d.push("\x3c/table\x3e");return d.join("")},_createHeaderText:function(a,b){var c=a.header;"function"==typeof c&&(c=c.call(this,a));if(mini.isNull(c)||""===c)c="\x26nbsp;";return c},_createColumnColSpan:function(a,b,c){a.colspan&&(b[b.length]='colspan\x3d"'+a.colspan+'" ')},doUpdateColumns:function(){var a=this._columnsViewEl.scrollLeft,b=this.getVisibleColumnsRow(),b=this._createColumnsHTML(b,2);this._columnsViewEl.innerHTML=b+'\x3cdiv class\x3d"mini-grid-topRightCell"\x3e\x3c/div\x3e';this._columnsViewEl.scrollLeft=a},doUpdate:function(){function a(){d.el&&(d.doUpdateColumns(),"cardview"==b.viewType?d.updateCardView():d.doUpdateRows(),d.doLayout(),d._doUpdateTimer=null)}if(0!=this.canUpdate()){var b=this,c=this._isCreating();this._doUpdateSummaryRow();var d=this,e=this.getScrollLeft();d.doUpdateColumns();c&&(this._useEmptyView=!0);this._doRemoveRowContent();"cardview"==b.viewType?d.updateCardView():d.doUpdateRows();0<e&&d.isVirtualScroll()&&d._syncScrollOffset(e);c&&(this._useEmptyView=!1);d.doLayout();c&&!this._doUpdateTimer&&(this._doUpdateTimer=setTimeout(a,15));this.unmask();b._fireUpdateTimer&&(clearTimeout(b._fireUpdateTimer),b._fireUpdateTimer=null);b._fireUpdateTimer=setTimeout(function(){b._fireUpdateTimer=null;b.fire("update")},100)}},_doRemoveRowContent:function(){this._rowsViewContentEl&&this._rowsViewContentEl.firstChild&&this._rowsViewContentEl.removeChild(this._rowsViewContentEl.firstChild);this._rowsLockContentEl&&this._rowsLockContentEl.firstChild&&this._rowsLockContentEl.removeChild(this._rowsLockContentEl.firstChild)},_isCreating:function(){return 1E3>new Date-this._createTime},deferUpdate:function(a){a||(a=5);if(!this._updateTimer&&!this._doUpdateTimer){var b=this;this._updateTimer=setTimeout(function(){b._updateTimer=null;b.doUpdate()},a)}},_stopDeferUpdate:function(){this._updateTimer&&(clearTimeout(this._updateTimer),this._updateTimer=null)},_pushUpdateCallback:function(a,b,c){var d=0;if(this._doUpdateTimer||this._updateTimer)d=20;0==d?a.apply(b,c):setTimeout(function(){a.apply(b,c)},d)},_updateCount:0,beginUpdate:function(){this._updateCount++},endUpdate:function(a){this._updateCount--;if(0==this._updateCount||!0===a)this._updateCount=0,this.doUpdate()},canUpdate:function(){return 0==this._updateCount},setDefaultRowHeight:function(a){this.defaultRowHeight=a},getDefaultRowHeight:function(){return this.defaultRowHeight},_getRowHeight:function(a){var b=this.defaultRowHeight;a._height&&(b=parseInt(a._height),isNaN(parseInt(a._height))&&(b=rowHeight));b=b-this._paddingTop-this._paddingBottom;return b-1},_createGroupingHTML:function(a,b){var c=this.getGroupingView(),d=this.showGroupSummary,e=this.isFrozen(),f=0,g=!1!==this.groupTitleCollapsible,k=['\x3ctable class\x3d"mini-grid-table" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0"\x3e'];k.push(this._createTopRowHTML(a));for(var l=0,n=c.length;l<n;l++)if(1!=b||this.isFrozen()){var p=c[l],q=this._createRowGroupId(p,b),r=this._createRowGroupRowsId(p,b),t=this._OnDrawGroup(p),u=p.expanded?"":" mini-grid-group-collapse ";k[k.length]='\x3ctr id\x3d"';k[k.length]=q;k[k.length]='" class\x3d"mini-grid-groupRow';k[k.length]=u;k[k.length]='"\x3e\x3ctd style\x3d"width:0;"\x3e\x3c/td\x3e\x3ctd class\x3d"mini-grid-groupCell ';k[k.length]=t.cls;k[k.length]='" style\x3d"';k[k.length]=t.style;k[k.length]='" colspan\x3d"';k[k.length]=a.length;k[k.length]='"\x3e\x3cdiv class\x3d"mini-grid-groupHeader ';g&&(k[k.length]="mini-grid-groupHeader-collapsible");k[k.length]='"\x3e';!e||e&&1==b?(k[k.length]='\x3cdiv class\x3d"mini-grid-group-ecicon"\x3e\x3c/div\x3e',k[k.length]='\x3cdiv class\x3d"mini-grid-groupTitle"\x3e'+t.cellHtml+"\x3c/div\x3e"):k[k.length]="\x26nbsp;";k[k.length]="\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e";q=p.expanded?"":"display:none";k[k.length]='\x3ctr class\x3d"mini-grid-groupRows-tr" style\x3d"';k[k.length]='"\x3e\x3ctd style\x3d"width:0;"\x3e\x3c/td\x3e\x3ctd class\x3d"mini-grid-groupRows-td" colspan\x3d"';k[k.length]=a.length;k[k.length]='"\x3e\x3cdiv id\x3d"';k[k.length]=r;k[k.length]='" class\x3d"mini-grid-groupRows" style\x3d"';mini.isChrome&&(k[k.length]="margin-left:-1px;");k[k.length]=q;k[k.length]='"\x3e';q=p.rows;k.push('\x3ctable class\x3d"mini-grid-table" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0"\x3e');if(0<a.length)for(k.push(this._createTopRowHTML(a)),t=0,r=q.length;t<r;t++)this._createRowHTML(q[t],f++,a,b,k);k.push("\x3c/table\x3e");k[k.length]="\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e";if(d&&0<a.length){k[k.length]='\x3ctr class\x3d"mini-grid-groupFooter"\x3e';k[k.length]='\x3ctd style\x3d"width:0;"\x3e\x3c/td\x3e';r=0;for(u=a.length;r<u;r++)t=a[r],q="",t=this._OnDrawSummaryCell(p.rows,t,p),k[k.length]='\x3ctd id\x3d"',k[k.length]=q,k[k.length]='" class\x3d"mini-grid-cell '+t.cellCls+'" style\x3d"'+t.cellStyle+";",k[k.length]='"\x3e\x3cdiv class\x3d"mini-grid-cell-inner"\x3e',k[k.length]=t.cellHtml,k[k.length]="\x3c/div\x3e\x3c/td\x3e";k[k.length]="\x3c/tr\x3e"}}k.push("\x3c/table\x3e");return k.join("")},_isFastCreating:function(){return 50<this.getVisibleRows().length?this._isCreating()||this.getScrollTop()<50*this._defaultRowHeight:!1},isShowRowDetail:function(a){return!1},isCellValid:function(a,b){return!0},updateCardView:function(){var a=this.getVisibleRows();this.getVisibleColumns();for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c],f={rowCls:"",rowStyle:""},g=this.itemRenderer(e,c,f,this);b[b.length]='\x3cdiv class\x3d"mini-grid-row ';b[b.length]=f.rowCls;b[b.length]='" style\x3d"';b[b.length]=f.rowStyle;b[b.length]='" id\x3d"';b[b.length]=this._createRowId(e,1);b[b.length]='"\x3e';b[b.length]=g;b[b.length]="\x3c/div\x3e"}this._rowsViewContentEl.innerHTML=b.join("")},itemRenderer:function(a,b,c,d){return""},_createRowHTML:function(a,b,c,d,e){var f=!e;e||(e=[]);var g="",k=this.isFixedRowHeight();k&&(g=this._getRowHeight(a));var l=this.defaultRowHeight-1,n,p=" ",q,r=" ";e[e.length]='\x3ctr class\x3d"mini-grid-row ';"added"==a._state&&this.showNewRow&&(e[e.length]="mini-grid-newRow ");this.isShowRowDetail(a)&&(e[e.length]="mini-grid-expandRow ");this.allowAlternating&&1==b%2&&(e[e.length]=this._alternatingCls,e[e.length]=" ");if(n=this._rowClsHash[a._id])e[e.length]=n.join(" "),e[e.length]=" ";this._dataSource.isSelected(a)&&(e[e.length]=this._rowSelectedCls,e[e.length]=" ");n=e.length;e[e.length]=p;e[e.length]='" style\x3d"';q=e.length;e[e.length]=r;e[e.length]='" id\x3d"';e[e.length]=this._createRowId(a,d);e[e.length]='"\x3e';!1!==this._userEmptyTd&&(e[e.length]='\x3ctd style\x3d"width:0;"\x3e\x3c/td\x3e');for(var t=this._currentCell,u=0,B=c.length;u<B;u++){var y=c[u],D=this._createCellId(a,y),v=this._OnDrawCell(a,y,b,y._index);if(null===v.cellHtml||void 0===v.cellHtml||""===v.cellHtml)v.cellHtml="\x26nbsp;";e[e.length]="\x3ctd ";v.rowSpan&&(e[e.length]='rowspan\x3d"'+v.rowSpan+'"');v.colSpan&&(e[e.length]='colspan\x3d"'+v.colSpan+'"');e[e.length]=' id\x3d"';e[e.length]=D;e[e.length]='" class\x3d"mini-grid-cell ';this.isCellValid(a,y)||(e[e.length]=" mini-grid-cell-error ");u==B-1&&(e[e.length]=" mini-grid-rightCell ");v.cellCls&&(e[e.length]=" "+v.cellCls+" ");t&&t[0]==a&&t[1]==y&&(e[e.length]=" ",e[e.length]=this._cellSelectedCls);e[e.length]='" style\x3d"';0==v.showHGridLines&&(e[e.length]="border-bottom:0;");0==v.showVGridLines&&(e[e.length]="border-right:0;");v.visible||(e[e.length]="display:none;");y.align&&(e[e.length]="text-align:",e[e.length]=y.align,e[e.length]=";");v.cellStyle&&(e[e.length]=v.cellStyle);e[e.length]='"\x3e';e[e.length]='\x3cdiv class\x3d"mini-grid-cell-inner ';D=y.allowCellWrap;D||(D=v.allowCellWrap);D||(e[e.length]=" mini-grid-cell-nowrap ");v.cellInnerCls&&(e[e.length]=v.cellInnerCls);y.field&&this._dataSource.isModified(a,y.field)&&this.showModified&&(e[e.length]=" mini-grid-cell-dirty");e[e.length]='" style\x3d"';k&&(e[e.length]="height:",e[e.length]=y.name&&this._treeColumn===y.name?l:g,e[e.length]="px;",e[e.length]="line-height:",e[e.length]=y.name&&this._treeColumn===y.name?l:g,e[e.length]="px;");v.cellInnerStyle&&(e[e.length]=v.cellInnerStyle);e[e.length]='"\x3e';e[e.length]=v.cellHtml;e[e.length]="\x3c/div\x3e";e[e.length]="\x3c/td\x3e";v.rowCls&&(p=v.rowCls);v.rowStyle&&(r=v.rowStyle)}this.isFrozen()&&1==d&&(e[e.length]='\x3ctd class\x3d"mini-grid-cell" style\x3d"width:0;',0==this.showHGridLines&&(e[e.length]="border-bottom:0;"),e[e.length]='"\x3e\x3cdiv class\x3d"mini-grid-cell-inner" style\x3d"',k&&(e[e.length]="height:",e[e.length]=g,e[e.length]="px;"),e[e.length]='"\x3e0\x3c/div\x3e\x3c/td\x3e');e[n]=p;e[q]=r;e[e.length]="\x3c/tr\x3e";if(f)return a=e.join(""),a=a.replace(/(<script(.*)<\/script(\s*)>)/i,"")},_createRowsHTML:function(a,b,c,d){c=c||this.getVisibleRows();var e=['\x3ctable class\x3d"mini-grid-table mini-grid-rowstable" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0"\x3e'];e.push(this._createTopRowHTML(a,!0,c));var f=this.uid+"$emptytext"+b;2==b&&(this._dataSource.loaded||this.alwaysShowEmptyText)&&e.push('\x3ctr id\x3d"'+f+'" style\x3d"'+(this.showEmptyText&&0==c.length?"":"display:none;")+'"\x3e\x3ctd style\x3d"width:0"\x3e\x3c/td\x3e\x3ctd class\x3d"mini-grid-emptyText" colspan\x3d"'+a.length+'"\x3e'+this.emptyText+"\x3c/td\x3e\x3c/tr\x3e");f=0;0<c.length&&(f=c[0],f=this.getVisibleRows().indexOf(f));for(var g=0,k=c.length;g<k;g++)this._createRowHTML(c[g],f+g,a,b,e);d&&e.push(d);e.push("\x3c/table\x3e");return e.join("")},doUpdateRows:function(){var a=this.getVisibleRows(),b=this.getVisibleColumns(),a=this.isGrouping()?this._createGroupingHTML(b,2):this._createRowsHTML(b,2,a);this._rowsViewContentEl.innerHTML=a},_createFilterRowHTML:function(a,b){var c=['\x3ctable class\x3d"mini-grid-table" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" style\x3d"position:absolute;top:0;left:0;height:100%;"\x3e'];c.push(this._createTopRowHTML(a));c[c.length]="\x3ctr\x3e";c[c.length]='\x3ctd style\x3d"width:0;"\x3e\x3c/td\x3e';for(var d=0,e=a.length;d<e;d++){var f=this._createFilterCellId(a[d]);c[c.length]='\x3ctd id\x3d"';c[c.length]=f;c[c.length]='" class\x3d"mini-grid-filterCell" style\x3d"';c[c.length]='"\x3e\x26nbsp;\x3c/td\x3e'}c[c.length]='\x3c/tr\x3e\x3c/table\x3e\x3cdiv class\x3d"mini-grid-scrollHeaderCell"\x3e\x3c/div\x3e';return c.join("")},_doRenderFilters:function(){for(var a=this.getVisibleColumns(),b=0,c=a.length;b<c;b++){var d=a[b];if(d.filter){var e=this.getFilterCellEl(d);e&&(e.innerHTML="",d.filter.render(e))}}},_doUpdateFilterRow:function(){this._filterViewEl.firstChild&&this._filterViewEl.removeChild(this._filterViewEl.firstChild);this.isFrozen();var a=this.getVisibleColumns(),a=this._createFilterRowHTML(a,2);this._filterViewEl.innerHTML=a;this._doRenderFilters()},_createSummaryRowHTML:function(a,b){var c=this.getDataView(),d=['\x3ctable class\x3d"mini-grid-table" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0"\x3e'];d.push(this._createTopRowHTML(a));for(var e=0,f=this.summaryRows;e<f;e++){d[d.length]="\x3ctr\x3e";d[d.length]='\x3ctd style\x3d"width:0;"\x3e\x3c/td\x3e';for(var g=0,k=a.length;g<k;g++){var l=a[g],n=this._createSummaryCellId(l,e),l=this._OnDrawSummaryCell(c,l,null,e);d[d.length]='\x3ctd id\x3d"';d[d.length]=n;d[d.length]='" class\x3d"mini-grid-summaryCell '+l.cellCls+'" style\x3d"'+l.cellStyle+";";d[d.length]='"\x3e';d[d.length]=l.cellHtml;d[d.length]="\x3c/td\x3e"}d[d.length]="\x3c/tr\x3e"}d[d.length]='\x3c/table\x3e\x3cdiv class\x3d"mini-grid-scrollHeaderCell"\x3e\x3c/div\x3e';return d.join("")},_doUpdateSummaryRow:function(){if(this.showSummaryRow){var a=this.getVisibleColumns(),a=this._createSummaryRowHTML(a,2);this._summaryViewEl.innerHTML=a}},_doSortByField:function(a,b){if(!a)return null;var c=this._columnModel._getDataTypeByField(a);this._dataSource._doClientSortField(a,b,c)},_expandGroupOnLoad:!0,_GroupID:1,_groupField:"",_groupDir:"",groupBy:function(a,b){a&&(this._groupField=a,"string"==typeof b&&(b=b.toLowerCase()),this._groupDir=b,this._createGroupingView(),this.deferUpdate())},clearGroup:function(){this._groupDir=this._groupField="";this._groupDataView=null;this.deferUpdate()},setGroupField:function(a){this.groupBy(a)},getGroupField:function(){return this._groupField},getGroupDir:function(){return this._groupDir},setGroupDir:function(a){this._groupDir=field;this.groupBy(this._groupField,a)},isGrouping:function(){return""!=this._groupField},getGroupingView:function(){return this._groupDataView},enableGroupOrder:!0,_createGroupingView:function(){if(0!=this.isGrouping()){this._groupDataView=null;var a=this._dataSource,b=this._groupField,c=this._groupDir;(this.enableGroupOrder||c)&&this._doSortByField(b,c);for(var d=this.getVisibleRows(),e=[],f={},g=0,k=d.length;g<k;g++){var l=d[g],n=l[b],p=mini.isDate(n)?n.getTime():n,q=f[p];q||(q=f[p]={},q.field=b,q.dir=c,q.value=n,q.rows=[],e.push(q),q.id="g"+this._GroupID++,q.expanded=this._expandGroupOnLoad);q.rows.push(l)}k=a.sortField;g=a.sortOrder;if(k&&(q=this._columnModel._getDataTypeByField(k),a=a._getSortFnByField(k,q)))for(b="desc"==g,g=0,k=e.length;g<k;g++)q=e[g],mini.sort(q.rows,a),b&&q.rows.reverse();this._groupDataView=e}},_OnDrawGroup:function(a){a={group:a,rows:a.rows,field:a.field,dir:a.dir,value:a.value,cls:"",style:"",cellHtml:a.field+" ("+a.rows.length+" Items)"};this.fire("drawgroup",a);return a},getRowGroup:function(a){var b=typeof a;return"number"==b?this.getGroupingView()[a]:"string"==b?this._getRowGroupById(a):a},_getRowGroupByEvent:function(a){return(a=mini.findParent(a.target,"mini-grid-groupRow"))?(a=a.id.split("$"),a[0]!=this._id?null:this._getRowGroupById(a[a.length-1])):null},_getRowGroupById:function(a){for(var b=this.getGroupingView(),c=0,d=b.length;c<d;c++){var e=b[c];if(e.id==a)return e}return null},_createRowGroupId:function(a,b){return this._id+"$group"+b+"$"+a.id},_createRowGroupRowsId:function(a,b){return this._id+"$grouprows"+b+"$"+a.id},_createRowId:function(a,b){return this._id+"$row"+b+"$"+a._id},_createHeaderCellId:function(a,b){return this._id+"$headerCell"+b+"$"+a._id},_createCellId:function(a,b){return a._id+"$cell$"+b._id},_createFilterCellId:function(a){return this._id+"$filter$"+a._id},_createSummaryCellId:function(a,b){return this._id+"$summary$"+a._id+"_"+b},getFilterCellEl:function(a){return(a=this.getColumn(a))?document.getElementById(this._createFilterCellId(a)):null},getSummaryCellEl:function(a,b){b||(b=0);return(a=this.getColumn(a))?document.getElementById(this._createSummaryCellId(a,b)):null},_doVisibleEls:function(){mini.GridView.superclass._doVisibleEls.call(this);this._columnsEl.style.display=this.showColumns?"block":"none";this._filterEl.style.display=this.showFilterRow?"block":"none";this._summaryEl.style.display=this.showSummaryRow?"block":"none";this._bottomPagerEl.style.display=this.showPager?"block":"none"},setShowColumns:function(a){this.showColumns=a;this._doVisibleEls();this.deferLayout()},setShowFilterRow:function(a){this.showFilterRow=a;this._doVisibleEls();this.deferLayout()},setShowSummaryRow:function(a){this.showSummaryRow=a;this._doVisibleEls();this.deferLayout()},setShowPager:function(a){this.showPager=a;this._doVisibleEls();this.deferLayout()},setFitColumns:function(a){this.fitColumns=a;mini.removeClass(this.el,"mini-grid-fixwidth");0==this.fitColumns&&mini.addClass(this.el,"mini-grid-fixwidth");this.deferLayout()},getBodyHeight:function(a){a=mini.GridView.superclass.getBodyHeight.call(this,a);return a=a-this.getColumnsHeight()-this.getFilterHeight()-this.getSummaryHeight()-this.getPagerHeight()},getColumnsHeight:function(){return this.showColumns?mini.getHeight(this._columnsEl):0},getFilterHeight:function(){return this.showFilterRow?mini.getHeight(this._filterViewEl.firstChild):0},getSummaryHeight:function(){return this.showSummaryRow?mini.getHeight(this._summaryEl):0},getPagerHeight:function(){return this.showPager?mini.getHeight(this._bottomPagerEl):0},getGridViewBox:function(a){a=mini.getBox(this._columnsEl);var b=mini.getBox(this._bodyEl);a.height=b.bottom-a.top;a.bottom=a.top+a.height;return a},getSortField:function(a){return this._dataSource.sortField},getSortOrder:function(a){return this._dataSource.sortOrder},_createSource:function(){this._dataSource=new mini.DataTable},_bindSource:function(){var a=this._dataSource;a.on("loaddata",this.__OnSourceLoadData,this);a.on("cleardata",this.__OnSourceClearData,this)},__OnSourceLoadData:function(a){this._initData();a=this.getSortField();var b=this.getSortOrder();"client"==this.sortMode&&a&&b&&this.sortBy(a,b);this.doUpdate()},__OnSourceClearData:function(a){this._initData();this.doUpdate()},_initData:function(){},isFrozen:function(){return this._columnModel.isFrozen()},_createColumnModel:function(){this._columnModel=new mini.ColumnModel(this)},_bindColumnModel:function(){this._columnModel.on("columnschanged",this.__OnColumnsChanged,this)},__OnColumnsChanged:function(a){this.columns=this._columnModel.columns;this._doUpdateFilterRow();this._doUpdateSummaryRow();this.doUpdate();this.fire("columnschanged")},setColumns:function(a){this._columnModel.setColumns(a);this.columns=this._columnModel.columns},getColumns:function(){return this._columnModel.getColumns()},getBottomColumns:function(){return this._columnModel.getBottomColumns()},getVisibleColumnsRow:function(){return this._columnModel.getVisibleColumnsRow().clone()},getVisibleColumns:function(){return this._columnModel.getVisibleColumns().clone()},getFrozenColumns:function(){return this._columnModel.getFrozenColumns().clone()},getUnFrozenColumns:function(){return this._columnModel.getUnFrozenColumns().clone()},getColumn:function(a){return this._columnModel.getColumn(a)},updateColumn:function(a,b){this._columnModel.updateColumn(a,b)},showColumns:function(a){for(var b=0,c=a.length;b<c;b++){var d=this.getColumn(a[b]);d&&(d.visible=!0)}this._columnModel._columnsChanged()},hideColumns:function(a){for(var b=0,c=a.length;b<c;b++){var d=this.getColumn(a[b]);d&&(d.visible=!1)}this._columnModel._columnsChanged()},showColumn:function(a){this.updateColumn(a,{visible:!0})},hideColumn:function(a){this.updateColumn(a,{visible:!1})},moveColumn:function(a,b,c){this._columnModel.moveColumn(a,b,c)},removeColumn:function(a){if(a=this.getColumn(a)){var b=this.getParentColumn(a);a&&b&&(b.columns.remove(a),this._columnModel._columnsChanged());return a}},setDefaultColumnWidth:function(a){this._columnModel._defaultColumnWidth=a},getDefaultColumnWidth:function(){return this._columnModel._defaultColumnWidth},setColumnWidth:function(a,b){this.updateColumn(a,{width:b})},getColumnWidth:function(a){return this.getColumnBox(a).width},getParentColumn:function(a){return this._columnModel.getParentColumn(a)},getMaxColumnLevel:function(){return this._columnModel._getMaxColumnLevel()},_isCellVisible:function(a,b){return!0},_createDrawCellEvent:function(a,b,c,d){var e=mini._getMap(b.field,a);a={sender:this,rowIndex:c,columnIndex:d,record:a,row:a,column:b,field:b.field,value:e,cellHtml:e,rowCls:"",rowStyle:null,cellCls:b.cellCls||"",cellStyle:b.cellStyle||"",allowCellWrap:this.allowCellWrap,showHGridLines:this.showHGridLines,showVGridLines:this.showVGridLines,cellInnerCls:"",cellInnnerStyle:"",autoEscape:b.autoEscape};a.visible=this._isCellVisible(c,d);1==a.visible&&this._mergedCellMaps&&(c=this._mergedCellMaps[c+":"+d])&&(a.rowSpan=c.rowSpan,a.colSpan=c.colSpan);return a},defaultColumnDateFormat:"yyyy-MM-dd",_OnDrawCell:function(a,b,c,d){c=this._createDrawCellEvent(a,b,c,d);d=c.value;var e=b.dateFormat||("date"==b.dataType?this.defaultColumnDateFormat:"");e&&(mini.isDate(c.value)?c.cellHtml=mini.formatDate(d,e):c.cellHtml=d);"float"==b.dataType&&(d=parseFloat(c.value),isNaN(d)||(decimalPlaces=parseInt(b.decimalPlaces),isNaN(decimalPlaces)&&(decimalPlaces=2),c.cellHtml=d.toFixed(decimalPlaces)));"currency"==b.dataType&&(c.cellHtml=mini.formatCurrency(c.value,b.currencyUnit));b.displayField&&(c.cellHtml=mini._getMap(b.displayField,a));b.numberFormat&&(a=parseFloat(c.cellHtml),isNaN(a)||(c.cellHtml=mini.formatNumber(a,b.numberFormat)));1==c.autoEscape&&(c.cellHtml=mini.htmlEncode(c.cellHtml));if(a=b.renderer)if(a="function"==typeof a?a:mini._getFunctoin(a))c.cellHtml=a.call(b,c);c.cellHtml=0===c.cellHtml||!1===c.cellHtml||c.cellHtml?String(c.cellHtml).trim():"";this.fire("drawcell",c);c.cellHtml&&c.cellHtml.unshift&&0==c.cellHtml.length&&(c.cellHtml="\x26nbsp;");if(null===c.cellHtml||void 0===c.cellHtml||""===c.cellHtml)c.cellHtml="\x26nbsp;";return c},_OnDrawSummaryCell:function(a,b,c,d){c={row:d,group:c,result:this.getResultObject(),sender:this,data:a,column:b,field:b.field,value:"",cellHtml:"",cellCls:b.cellCls||"",cellStyle:b.cellStyle||"",allowCellWrap:this.allowCellWrap};b.summaryType&&(d=mini.summaryTypes[b.summaryType])&&(c.value=d(a,b.field));a=c.value;(c.cellHtml=c.value)&&parseInt(c.value)!=c.value&&c.value.toFixed&&(decimalPlaces=parseInt(b.decimalPlaces),isNaN(decimalPlaces)&&(decimalPlaces=2),c.cellHtml=parseFloat(c.value.toFixed(decimalPlaces)));b.dateFormat&&(mini.isDate(c.value)?c.cellHtml=mini.formatDate(a,b.dateFormat):c.cellHtml=a);c.cellHtml&&"currency"==b.dataType&&(c.cellHtml=mini.formatCurrency(c.cellHtml,b.currencyUnit));if(a=b.summaryRenderer)if(d="function"==typeof a?a:window[a])c.cellHtml=d.call(b,c);b.summaryValue=c.value;this.fire("drawsummarycell",c);if(null===c.cellHtml||void 0===c.cellHtml||""===c.cellHtml)c.cellHtml="\x26nbsp;";return c},getScrollTop:function(){return this._rowsViewEl.scrollTop},setScrollTop:function(a){this._rowsViewEl.scrollTop=a},getScrollLeft:function(){return this._rowsViewEl.scrollLeft},setScrollLeft:function(a){this._rowsViewEl.scrollLeft=a},_syncScroll:function(){var a=this._rowsViewEl.scrollLeft;this._filterViewEl.firstChild.style.left=-a+"px";this._summaryViewEl.scrollLeft=a;this._columnsViewEl.scrollLeft=a},__OnRowViewScroll:function(a){this._syncScroll()},pagerType:"pager",getPagerType:function(){return this.pagerType},setPagerType:function(a){this.pagerType=a;(a=mini.create({type:this.pagerType}))&&this._setBottomPager(a)},_pagers:[],_createPagers:function(){this._pagers=[];var a=new mini.Pager;this._setBottomPager(a)},_setBottomPager:function(a){if(a=mini.create(a))this._bottomPager&&(this.unbindPager(this._bottomPager),this._bottomPagerEl.removeChild(this._bottomPager.el)),this._bottomPager=a,a.render(this._bottomPagerEl),this.bindPager(a)},bindPager:function(a){this._pagers.add(a)},unbindPager:function(a){this._pagers.remove(a)},alwaysShowEmptyText:!1,setAlwaysShowEmptyText:function(a){this.alwaysShowEmptyText=a},getAlwaysShowEmptyText:function(){return this.alwaysShowEmptyText},setShowEmptyText:function(a){this.showEmptyText=a;0==this.data.length&&this.deferUpdate()},getShowEmptyText:function(){return this.showEmptyText},setEmptyText:function(a){this.emptyText=a},getEmptyText:function(){return this.emptyText},setShowModified:function(a){this.showModified=a},getShowModified:function(){return this.showModified},setShowNewRow:function(a){this.showNewRow=a},getShowNewRow:function(){return this.showNewRow},setAllowCellWrap:function(a){this.allowCellWrap=a},getAllowCellWrap:function(){return this.allowCellWrap},setAllowHeaderWrap:function(a){this.allowHeaderWrap=a},getAllowHeaderWrap:function(){return this.allowHeaderWrap},setEnableGroupOrder:function(a){this.enableGroupOrder=a},getEnableGroupOrder:function(){return this.enableGroupOrder},setShowHGridLines:function(a){this.showHGridLines!=a&&(this.showHGridLines=a,this.deferUpdate())},getShowHGridLines:function(){return this.showHGridLines},setShowVGridLines:function(a){this.showVGridLines!=a&&(this.showVGridLines=a,this.deferUpdate())},getShowVGridLines:function(){return this.showVGridLines},setShowSortIcon:function(a){this.showSortIcon!=a&&(this.showSortIcon=a,this.deferUpdate())},getShowSortIcon:function(){return this.showSortIcon}});mini.copyTo(mini.GridView.prototype,mini._DataTableApplys);mini.regClass(mini.GridView,"gridview");mini.FrozenGridView=function(){mini.FrozenGridView.superclass.constructor.apply(this,arguments)};mini.extend(mini.FrozenGridView,mini.GridView,{isFixedRowHeight:function(){return this.fixedRowHeight},frozenPosition:"left",isRightFrozen:function(){return"right"==this.frozenPosition},_create:function(){mini.FrozenGridView.superclass._create.call(this);this._columnsLockEl=mini.before(this._columnsViewEl,'\x3cdiv class\x3d"mini-grid-columns-lock"\x3e\x3c/div\x3e');this._rowsLockEl=mini.before(this._rowsViewEl,'\x3cdiv class\x3d"mini-grid-rows-lock"\x3e\x3cdiv class\x3d"mini-grid-rows-content"\x3e\x3c/div\x3e\x3c/div\x3e');this._rowsLockContentEl=this._rowsLockEl.firstChild;this._filterLockEl=mini.before(this._filterViewEl,'\x3cdiv class\x3d"mini-grid-filterRow-lock" style\x3d"height:100%;"\x3e\x3c/div\x3e');this._summaryLockEl=mini.before(this._summaryViewEl,'\x3cdiv class\x3d"mini-grid-summaryRow-lock"\x3e\x3c/div\x3e')},_initEvents:function(){mini.FrozenGridView.superclass._initEvents.call(this);mini.on(this._rowsEl,"mousewheel",this.__OnMouseWheel,this)},_createHeaderText:function(a,b){var c=a.header;"function"==typeof c&&(c=c.call(this,a));if(mini.isNull(c)||""===c)c="\x26nbsp;";this.isFrozen()&&2==b&&a.viewIndex1&&(c="\x26nbsp;");return c},_createColumnColSpan:function(a,b,c){this.isFrozen()?(a=a["colspan"+c])&&(b[b.length]='colspan\x3d"'+a+'" '):a.colspan&&(b[b.length]='colspan\x3d"'+a.colspan+'" ')},doUpdateColumns:function(){var a=this._columnsViewEl.scrollLeft,b=this.isFrozen()?this.getFrozenColumnsRow():[],c=this.isFrozen()?this.getUnFrozenColumnsRow():this.getVisibleColumnsRow(),d=this.isFrozen()?this.getFrozenColumns():[],e=this.isFrozen()?this.getUnFrozenColumns():this.getVisibleColumns(),b=this._createColumnsHTML(b,1,d),c=this._createColumnsHTML(c,2,e);this._columnsLockEl.innerHTML=b+'\x3cdiv class\x3d"mini-grid-topRightCell"\x3e\x3c/div\x3e';this._columnsViewEl.innerHTML=c+'\x3cdiv class\x3d"mini-grid-topRightCell"\x3e\x3c/div\x3e';this._columnsLockEl.firstChild.style.width="0px";this._columnsViewEl.scrollLeft=a},doUpdateRows:function(){var a=this.getVisibleRows(),b=this.getFrozenColumns(),c=this.getUnFrozenColumns();this.isGrouping()?(b=this._createGroupingHTML(b,1),a=this._createGroupingHTML(c,2)):(b=this._createRowsHTML(b,1,this.isFrozen()?a:[]),a=this._createRowsHTML(c,2,a));this._rowsLockContentEl.innerHTML=b;this._rowsViewContentEl.innerHTML=a;this._rowsLockContentEl.firstChild.style.width="0px"},_doUpdateFilterRow:function(){this._filterLockEl.firstChild&&this._filterLockEl.removeChild(this._filterLockEl.firstChild);this._filterViewEl.firstChild&&this._filterViewEl.removeChild(this._filterViewEl.firstChild);var a=this.getFrozenColumns(),b=this.getUnFrozenColumns(),a=this._createFilterRowHTML(a,1),b=this._createFilterRowHTML(b,2);this._filterLockEl.innerHTML=a;this._filterViewEl.innerHTML=b;this._doRenderFilters()},_doUpdateSummaryRow:function(){var a=this.getFrozenColumns(),b=this.getUnFrozenColumns(),a=this._createSummaryRowHTML(a,1),b=this._createSummaryRowHTML(b,2);this._summaryLockEl.innerHTML=a;this._summaryViewEl.innerHTML=b},_syncRowsHeightTimer:null,syncRowDetail:function(a){var b=this._getRowDetailEl(a,1);a=this._getRowDetailEl(a,2);b&&a&&this._doSyncRowHeight(b,a)},_doSyncRowHeight:function(a,b){a.style.height=b.style.height="auto";var c=a.cells[0].offsetHeight,d=b.cells[0].offsetHeight;c<d&&(c=d);a.style.height=b.style.height=c+"px"},_syncRowsHeight:function(){function a(){for(var a=b.getDataView(),d={},e=0,f=a.length;e<f;e++){var g=a[e],k=b._getRowEl(g,1),g=b._getRowEl(g,2);k&&g&&(k.style.height=g.style.height="auto",d[e]={row1:k,row2:g})}e=0;for(f=a.length;e<f;e++){var l=d[e];l&&(k=l,g=l.row1.cells[0].offsetHeight,l=l.row2.cells[0].offsetHeight,g<l&&(g=l),k.height=g)}e=0;for(f=a.length;e<f;e++)if(l=d[e])l.row1.style.height=l.row2.style.height=l.height+"px";b._syncRowsHeightTimer=null}var b=this;this.isFrozen()&&0==this.isFixedRowHeight()&&(this._syncRowsHeightTimer&&clearTimeout(this._syncRowsHeightTimer),this._syncRowsHeightTimer=setTimeout(a,2))},_syncColumnHeight:function(){var a=this._columnsLockEl,b=this._columnsViewEl;a.style.height=b.style.height="auto";if(this.isFrozen()){var c=a.offsetHeight,d=b.offsetHeight;a.style.height=b.style.height=(c>d?c:d)+"px"}a=this._summaryLockEl;b=this._summaryViewEl;a.style.height=b.style.height="auto";this.isFrozen()&&(c=a.offsetHeight,d=b.offsetHeight,a.style.height=b.style.height=(c>d?c:d)+"px")},_layoutColumns:function(){function a(a){for(var b=[],c=0,d=a.cells.length;c<d;c++){var e=a.cells[c];"0px"!=e.style.width&&b.push(e)}return b}function b(b){b=a(b);for(var c=0,d=b.length;c<d;c++)b[c].style.height="auto"}function c(b,c){for(var d=0,e=a(b),f=0,g=e.length;f<g;f++){var k=e[f];1<parseInt(k.rowSpan)&&c||(k=k.offsetHeight,k>d&&(d=k))}return d}function d(b,d){for(var e=c(d,!0),f=a(b),g=0,k=f.length;g<k;g++){var l=f[g];1<parseInt(l.rowSpan)||mini.setHeight(l,e)}}function e(b,d){for(var e=c(d),f=a(b),g=0,k=f.length;g<k;g++){var l=f[g];1<parseInt(l.rowSpan)&&mini.setHeight(l,e)}}if(this.isFrozen()){var f=this._columnsLockEl.firstChild,g=this._columnsViewEl.firstChild;(function(){f.style.height="auto";for(var a=0,c=f.rows.length;a<c;a++){var d=g.rows[a];b(f.rows[a]);b(d)}})();for(var k=0,l=f.rows.length;k<l;k++){var n=f.rows[k],p=g.rows[k],q=c(n),r=c(p);q!=r&&(q<r?(d(n,p),e(n,p)):q>r&&(d(p,n),e(p,n)))}q=f.offsetHeight;r=g.offsetHeight;q<r?mini.setHeight(f,r):q>r&&mini.setHeight(g,q)}},doLayout:function(){if(0!=this.canLayout()){this._doLayoutScroll=!1;var a=this.isFrozen(),b=this.getViewportWidth(!0),c=this.getLockedWidth(),b=b-c;this._doEmptyText();var d=this.isRightFrozen()?"marginRight":"marginLeft",e=this.isRightFrozen()?"right":"left";if(a){this._filterViewEl.style[d]=c+"px";this._summaryViewEl.style[d]=c+"px";this._columnsViewEl.style[d]=c+"px";this._rowsViewEl.style[d]=c+"px";mini.isSafari||mini.isChrome||mini.isIE6?(this._filterViewEl.style.width=b+"px",this._summaryViewEl.style.width=b+"px",this._columnsViewEl.style.width=b+"px"):(this._filterViewEl.style.width="auto",this._summaryViewEl.style.width="auto",this._columnsViewEl.style.width="auto");if(mini.isSafari||mini.isChrome||mini.isIE6)this._rowsViewEl.style.width=b+"px";mini.setWidth(this._filterLockEl,c);mini.setWidth(this._summaryLockEl,c);mini.setWidth(this._columnsLockEl,c);mini.setWidth(this._rowsLockEl,c);this._filterLockEl.style[e]="0px";this._summaryLockEl.style[e]="0px";this._columnsLockEl.style[e]="0px";this._rowsLockEl.style[e]="0px"}else this._doClearFrozen();this._layoutColumns();this._syncColumnHeight();mini.FrozenGridView.superclass.doLayout.call(this);c=this._autoHeight;a&&(mini.isChrome||mini.isIE6)&&(this._layoutColumns(),this._syncColumnHeight(),mini.FrozenGridView.superclass.doLayout.call(this));this._rowsLockEl.style.height=c?"auto":"100%";this._syncRowsHeight()}},_doEmptyText:function(){},_getRowEl:function(a,b){a=this.getRecord(a);var c=this._createRowId(a,b);return document.getElementById(c)},_doClearFrozen:function(){this.isRightFrozen();this.isRightFrozen();this._filterLockEl.style.left="-10px";this._summaryLockEl.style.left="-10px";this._columnsLockEl.style.left="-10px";this._rowsLockEl.style.left="-10px";this._filterLockEl.style.width="0px";this._summaryLockEl.style.width="0px";this._columnsLockEl.style.width="0px";this._rowsLockEl.style.width="0px";this._filterViewEl.style.marginLeft="0px";this._summaryViewEl.style.marginLeft="0px";this._columnsViewEl.style.marginLeft="0px";this._rowsViewEl.style.marginLeft="0px";this._filterViewEl.style.width="auto";this._summaryViewEl.style.width="auto";this._columnsViewEl.style.width="auto";this._rowsViewEl.style.width="auto";if(mini.isSafari||mini.isChrome||mini.isIE6)this._filterViewEl.style.width="100%",this._summaryViewEl.style.width="100%",this._columnsViewEl.style.width="100%",this._rowsViewEl.style.width="100%"},frozenColumns:function(a,b){this.frozen(a,b)},unFrozenColumns:function(){this.unFrozen()},frozen:function(a,b){this._doClearFrozen();this._columnModel.frozen(a,b)},unFrozen:function(){this._doClearFrozen();this._columnModel.unFrozen()},setFrozenStartColumn:function(a){this._columnModel.setFrozenStartColumn(a)},setFrozenEndColumn:function(a){return this._columnModel.setFrozenEndColumn(a)},getFrozenStartColumn:function(a){return this._columnModel._frozenStartColumn},getFrozenEndColumn:function(a){return this._columnModel._frozenEndColumn},getFrozenColumnsRow:function(){return this._columnModel.getFrozenColumnsRow()},getUnFrozenColumnsRow:function(){return this._columnModel.getUnFrozenColumnsRow()},getLockedWidth:function(){if(!this.isFrozen())return 0;var a=this._rowsLockContentEl.firstChild.firstChild;return a?a.offsetWidth:0},_canDeferSyncScroll:function(){return this.isFrozen()},_syncScroll:function(){var a=this._rowsViewEl.scrollLeft;this._filterViewEl.firstChild.style.left=-a+"px";this._summaryViewEl.scrollLeft=a;this._columnsViewEl.scrollLeft=a;this._rowsLockEl.scrollTop=this._rowsViewEl.scrollTop},__OnMouseWheel:function(a){var b=this.getScrollTop()-a.wheelDelta,c=this.getScrollTop();this.setScrollTop(b);c!=this.getScrollTop()&&a.preventDefault()}});mini.regClass(mini.FrozenGridView,"FrozenGridView");mini.ScrollGridView=function(){mini.ScrollGridView.superclass.constructor.apply(this,arguments)};mini.extend(mini.ScrollGridView,mini.FrozenGridView,{virtualScroll:!0,virtualRows:25,defaultRowHeight:25,virtualColumns:!1,_canDeferSyncScroll:function(){return this.isFrozen()&&!this.isVirtualScroll()},setVirtualScroll:function(a){this.virtualScroll=a;this.doUpdate()},getVirtualScroll:function(a){return this.virtualScroll},isFitColumns:function(){return this.fitColumns&&!this.virtualColumns},setVirtualColumns:function(a){this.virtualColumns=a;this.doUpdate()},getVirtualColumns:function(a){return this.virtualColumns},isFixedRowHeight:function(){return this.fixedRowHeight||this.virtualScroll},isVirtualScroll:function(){return this.virtualScroll?0==this.isAutoHeight()&&0==this.isGrouping():!1},_getScrollView:function(){return this.getVisibleRows()},_getScrollViewCount:function(){return this._getScrollView().length},_getScrollRowHeight:function(a,b){if(b&&b._height){var c=parseInt(b._height);if(!isNaN(c))return c}return this.defaultRowHeight},_getRangeHeight:function(a,b){return(b-a)*this.defaultRowHeight},_getIndexByScrollTop:function(a){return parseInt(a/this.defaultRowHeight)},__getScrollViewRange:function(a,b){return this._getScrollView().getRange(a,b)},_getColumnByScrollLeft:function(a){for(var b=0,c=this.getUnFrozenColumns(),d=c.length,e=0;e<d;e++){var f=c[e].pxWidth;isNaN(f)||(b+=f);if(b>=a)return e}return d},_getRangeWidth:function(a,b){for(var c=0,d=this.getUnFrozenColumns(),e=a;e<b;e++){var f=d[e];f&&(f=f.pxWidth,isNaN(f)||(c+=f))}return c},_getColumnAllWidth:function(){for(var a=0,b=this.getUnFrozenColumns(),c=0,d=b.length;c<d;c++){var e=b[c].pxWidth;isNaN(e)||(a+=e)}return a},_getViewRegion:function(){var a=this._getScrollView();if(0==this.isVirtualScroll()){var b={top:0,bottom:0,rows:a,start:0,end:0};return b}var c=this._getViewNowRegion();this.getScrollTop();for(var a=this._getScrollViewCount(),b=c.start,c=c.end,d=0;d<a;d+=this.virtualRows){var e=d+this.virtualRows;d<=b&&b<e&&(b=d);d<c&&c<=e&&(c=e)}c>a&&(c=a);0==c&&(c=this.virtualRows);d=this._getRangeHeight(0,b);e=this._getRangeHeight(c,this._getScrollViewCount());a=this.__getScrollViewRange(b,c);b={top:d,bottom:e,rows:a,start:b,end:c,viewStart:b,viewEnd:c};b.viewTop=this._getRangeHeight(0,b.viewStart);b.viewBottom=this._getRangeHeight(b.viewEnd,this._getScrollViewCount());this.virtualColumns?(c=this.getScrollLeft(),a=this._rowsViewEl.offsetWidth,b.startColumn=this._getColumnByScrollLeft(c),b.endColumn=this._getColumnByScrollLeft(c+a),b.columns=this.getUnFrozenColumns().slice(b.startColumn,b.endColumn+1),b.right=this._getColumnAllWidth(),b.viewLeft=this._getRangeWidth(0,b.startColumn)):b.columns=this.getUnFrozenColumns();return b},_getViewNowRegion:function(){var a=this.getScrollTop(),b=this._rowsViewEl.offsetHeight,c=this._getIndexByScrollTop(a),a=this._getIndexByScrollTop(a+b+30),b=this._getScrollViewCount();a>b&&(a=b);return{start:c,end:a}},_canVirtualUpdate:function(){if(!this._viewRegion)return!0;var a=this._getViewNowRegion();return this._viewRegion.start<=a.start&&a.end<=this._viewRegion.end?!1:!0},__OnColumnsChanged:function(a){this.columns=this._columnModel.columns;this._doUpdateFilterRow();this._doUpdateSummaryRow();0==this.getVisibleRows().length?this.doUpdate():this.deferUpdate();this.isVirtualScroll()&&this.__OnVScroll();this.fire("columnschanged")},doLayout:function(){0!=this.canLayout()&&(mini.ScrollGridView.superclass.doLayout.call(this),this._layoutScroll(),mini.isNumber(this._scrollTop)&&this._vscrollEl.scrollTop!=this._scrollTop&&(this._vscrollEl.scrollTop=this._scrollTop))},_createRowsHTML:function(a,b,c,d,e,f){if(!this.isVirtualScroll())return mini.ScrollGridView.superclass._createRowsHTML.apply(this,arguments);var g=['\x3ctable class\x3d"mini-grid-table" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" \x3e'];g.push(this._createTopRowHTML(a));if(this.isVirtualScroll()){var k=0==d?"display:none;":"";g.push('\x3ctr class\x3d"mini-grid-virtualscroll-top" style\x3d"padding:0;border:0;'+k+'"\x3e\x3ctd colspan\x3d"'+a.length+'" style\x3d"height:'+d+"px;padding:0;border:0;"+k+'"\x3e\x3c/td\x3e\x3c/tr\x3e')}if(1!=b||0!=this.isFrozen())for(var k=0,l=c.length;k<l;k++)this._createRowHTML(c[k],f,a,b,g),f++;this.isVirtualScroll()&&g.push('\x3ctr class\x3d"mini-grid-virtualscroll-bottom" style\x3d"padding:0;border:0;"\x3e\x3ctd colspan\x3d"'+a.length+'" style\x3d"height:'+e+'px;padding:0;border:0;"\x3e\x3c/td\x3e\x3c/tr\x3e');g.push("\x3c/table\x3e");return g.join("")},doUpdateRows:function(){if(0==this.isVirtualScroll())mini.ScrollGridView.superclass.doUpdateRows.call(this);else{var a=this._getViewRegion();this._viewRegion=a;var b=this.getFrozenColumns(),c=a.columns,d=a.viewStart;if(this._scrollPaging)var e=this.getPageIndex()*this.getPageSize(),d=d-e;b=this._createRowsHTML(b,1,a.rows,a.viewTop,a.viewBottom,d);c=this._createRowsHTML(c,2,a.rows,a.viewTop,a.viewBottom,d);this._rowsLockContentEl.innerHTML=b;this._rowsViewContentEl.innerHTML=c;d=this._rowsViewContentEl.firstChild;this.virtualColumns&&(c='\x3cdiv style\x3d"position:absolute;top:0px;left:'+a.right+'px;width:1px;height:1px;overflow:hidden;"\x3e\x3c/div\x3e',jQuery(c).appendTo(this._rowsViewContentEl),d.style.width="0px",d.style.position="absolute",d.style.top="0px",d.style.left=a.viewLeft+"px");a=this.getScrollTop();this._rowsViewEl.scrollTop!=a&&this._syncScrollOffset(null,a)}},_create:function(){mini.ScrollGridView.superclass._create.call(this);this._vscrollEl=mini.append(this._rowsEl,'\x3cdiv class\x3d"mini-grid-vscroll"\x3e\x3cdiv class\x3d"mini-grid-vscroll-content"\x3e\x3c/div\x3e\x3c/div\x3e');this._vscrollContentEl=this._vscrollEl.firstChild},_initEvents:function(){mini.ScrollGridView.superclass._initEvents.call(this);var a=this;mini.on(this._vscrollEl,"scroll",this.__OnVScroll,this);mini._onScrollDownUp(this._vscrollEl,function(b){a._VScrollMouseDown=!0},function(b){a._VScrollMouseDown=!1})},_layoutScroll:function(){var a=this.isVirtualScroll();if(a){var b=this.getScrollHeight(),c=b>this._rowsViewEl.offsetHeight;a&&c?(this._vscrollEl.style.display="block",this._vscrollContentEl.style.height=b+"px"):this._vscrollEl.style.display="none";this._rowsViewEl.scrollWidth>this._rowsViewEl.clientWidth+1?(a=this.getBodyHeight(!0)-18,0>a&&(a=0),this._vscrollEl.style.height=a+"px"):this._vscrollEl.style.height="100%"}else this._vscrollEl.style.display="none"},getScrollHeight:function(){var a=this.getVisibleRows();return this._getRangeHeight(0,a.length)},setScrollTop:function(a){this.isVirtualScroll()?this._vscrollEl.scrollTop=a:this._rowsViewEl.scrollTop=a},getScrollTop:function(){return this.isVirtualScroll()?this._vscrollEl.scrollTop:this._rowsViewEl.scrollTop},__OnVScroll:function(a){if(this.isVirtualScroll()){this._scrollTop=this._vscrollEl.scrollTop;var b=this;setTimeout(function(){b._syncScrollOffset(null,b._scrollTop);b.__scrollTimer=null},8);this._scrollTopTimer&&clearTimeout(this._scrollTopTimer);this._scrollTopTimer=setTimeout(function(){b._scrollTopTimer=null;b._tryUpdateScroll();b._syncScrollOffset(null,b._scrollTop)},150)}},wheelIncrement:0,setWheelIncrement:function(a){this.wheelIncrement=a},getWheelIncrement:function(){return this.wheelIncrement},__OnMouseWheel:function(a){var b=a.wheelDelta?a:a.originalEvent,b=b.wheelDelta||40*-b.detail,b=0<b?b+this.wheelIncrement:b-this.wheelIncrement,b=this.getScrollTop()-b,c=this.getScrollTop();this.setScrollTop(b);(c!=this.getScrollTop()||this.isVirtualScroll())&&a.preventDefault()},_tryUpdateScroll:function(){if(this._canVirtualUpdate())if(this._scrollPaging)this.reload(null,null,function(a){});else{var a=this._rowsViewEl.scrollLeft;this._doRemoveRowContent();this.doUpdateRows();this.deferLayout(50);this._syncScrollOffset(a)}},_updateScrollTop:function(a){this._syncScrollOffset(null,a);this._tryUpdateScroll()},__OnRowViewScroll:function(a){this._syncScroll();this.virtualColumns&&this.doVirtualColumns()},doVirtualColumns:function(){var a=this;a._virtualColumnTimer&&(clearTimeout(a._virtualColumnTimer),a._virtualColumnTimer=null);a._virtualColumnTimer=setTimeout(function(){a._virtualColumnTimer=null;a._doRemoveRowContent();a.doUpdateRows();a.deferLayout(50)},500)}});mini.regClass(mini.ScrollGridView,"ScrollGridView");mini._onScrollDownUp=function(a,b,c){function d(a){mini.un(document,"mousemove",d);c(a)}function e(a){mini.un(document,"mouseup",e);c(a)}mini.on(a,"mousedown",function(a){if(mini.isFirefox)mini.on(document,"mouseup",e);else mini.on(document,"mousemove",d);b(a)})};mini.mousewheelEditable=!1;mini._Grid_Select=function(a){this.owner=a;el=a.el;a.on("rowmousemove",this.__OnRowMouseMove,this);mini.on(a._viewportEl,"mouseout",this.__OnMouseOut,this);mini.on(a._viewportEl,"mousewheel",this.__OnMouseWheel,this);mini.on(document,"mousewheel",this.__OnMouseWheel,this);a.on("cellmousedown",this.__OnCellMouseDown,this);a.on("cellmouseup",this.__OnGridCellClick,this);a.on("celldblclick",this.__OnGridCellClick,this);mini.on(a.el,"keydown",this.__OnGridKeyDown,this);jQuery(a._columnsEl).on("mouseenter",".mini-grid-headerCell",function(a){jQuery(a.currentTarget).addClass("mini-grid-header-over")});jQuery(a._columnsEl).on("mouseleave",".mini-grid-headerCell",function(a){jQuery(a.currentTarget).removeClass("mini-grid-header-over")})};mini._Grid_Select.prototype={__OnGridKeyDown:function(a){var b=this.owner,c=mini.findParent(a.target,"mini-grid-detailRow"),c=c?mini.isAncestor(b.el,c):!1;if(!(mini.isAncestor(b._filterEl,a.target)||mini.isAncestor(b._summaryEl,a.target)||mini.isAncestor(b._toolbarEl,a.target)||mini.isAncestor(b._footerEl,a.target)||mini.findParent(a.target,"mini-grid-detailRow")&&c||mini.findParent(a.target,"mini-grid-rowEdit")||mini.findParent(a.target,"mini-tree-editinput"))){var d=b.getCurrentCell();if(!(a.shiftKey||a.ctrlKey||a.altKey)){37!=a.keyCode&&38!=a.keyCode&&39!=a.keyCode&&40!=a.keyCode||a.preventDefault();var e=b.getVisibleColumns(),f=d?d[1]:null,c=d?d[0]:null;d||(c=b.getCurrent());var g=e.indexOf(f),k=function(a){return b.getVisibleRows().indexOf(a)}(c),l=b.getVisibleRows().length;switch(a.keyCode){case 9:if(b.allowCellEdit&&b.editOnTabKey){a.preventDefault();b._beginEditNextCell(0==a.shiftKey,!0);return}break;case 27:break;case 13:if(b.allowCellEdit&&b.editNextOnEnterKey&&f&&(b.isEditingCell(d)||!f.editor)){b._beginEditNextCell(0==a.shiftKey);return}b.allowCellEdit&&d&&!f.readOnly&&!b.isReadOnly()&&b.beginEditCell();break;case 37:f?0<g&&--g:g=0;break;case 38:c?0<k&&--k:k=0;0!=k&&b.isVirtualScroll();break;case 39:f?g<e.length-1&&(g+=1):g=0;break;case 40:c?k<l-1&&(k+=1):k=0;break;default:return}f=e[g];c=function(a){return b.getVisibleRows()[a]}(k);f&&c&&b.allowCellSelect&&(d=[c,f],b.setCurrentCell(d),b.scrollIntoView(c,f,!1));!b.onlyCheckSelection&&37!=a.keyCode&&39!=a.keyCode&&c&&b.allowRowSelect&&(a={record:c,selected:c,cancel:!1,htmlEvent:a},c&&(b.fire("beforerowselect",a),b.fire("beforeselect",a)),a.cancel||(b.deselectAll(),b.setCurrent(c),c&&b.scrollIntoView(c,null,!1)))}}},__OnMouseWheel:function(a){var b=this.owner;a.stopPropagation();if(!mini.mousewheelEditable){var c=b._editingControl;c&&c.within(a)||b.allowCellEdit&&b.commitEdit()}},__OnGridCellClick:function(a){var b=this.owner,c=a.type;"cellmouseup"==c&&(c="cellclick");0!=b.allowCellEdit&&b.cellEditAction==c&&(a.column.readOnly||b.isReadOnly()||a.htmlEvent.shiftKey||a.htmlEvent.ctrlKey||b.beginEditCell())},__OnCellMouseDown:function(a){var b=this;(b.owner.selectOnRightClick||3!=a.htmlEvent.which)&&setTimeout(function(){b.__doSelect(a)},1)},__OnRowMouseMove:function(a){var b=this.owner;b.enabled&&0!=b.enableHotTrack&&b.focusRow(a.record)},__OnMouseOut:function(a){this.owner.allowHotTrackOut&&this.owner.focusRow(null)},__doSelect:function(a){var b=a.record,c=a.column,d=this.owner;if(!1!==b.enabled&&(d.allowCellSelect&&d.setCurrentCell([b,c]),(!d.onlyCheckSelection||c._multiRowSelect)&&d.allowRowSelect&&(c={record:b,selected:b,cancel:!1,htmlEvent:a},b&&!d.isSelected(b)&&(d.fire("beforerowselect",c),d.fire("beforeselect",c)),!c.cancel)))if(d.getMultiSelect())if(d.el.onselectstart=function(){},a.htmlEvent.shiftKey){d.el.onselectstart=function(){return!1};try{a.htmlEvent.preventDefault()}catch(e){}(a=d.getCurrent())?(d.deselectAll(),d.selectRange(a,b),d.setCurrent(a)):(d.select(b),d.setCurrent(b))}else{d.el.onselectstart=function(){};if(a.htmlEvent.ctrlKey){d.el.onselectstart=function(){return!1};try{a.htmlEvent.preventDefault()}catch(e){}}!0===a.column._multiRowSelect||a.htmlEvent.ctrlKey||d.allowUnselect?d.isSelected(b)?d.deselect(b):(d.select(b),d.setCurrent(b)):d.isSelected(b)||(d.deselectAll(),d.select(b),d.setCurrent(b))}else d.isSelected(b)?(a.htmlEvent.ctrlKey||d.allowUnselect)&&d.deselectAll():(d.deselectAll(),d.select(b))}};mini._Grid_RowGroup=function(a){this.owner=a;el=a.el;mini.on(a._bodyEl,"click",this.__OnClick,this)};mini._Grid_RowGroup.prototype={__OnClick:function(a){var b=this.owner,c=b._getRowGroupByEvent(a);c&&(b.groupTitleCollapsible||mini.hasClass(a.target,"mini-grid-group-ecicon"))&&(a={htmlEvent:a,cancel:!1,group:c},b.fire("beforegroupclick",a),!0!==a.cancel&&b.toggleRowGroup(c))}};mini._Grid_ColumnsMenu=function(a){this.owner=a;this.menu=this.createMenu();mini.on(a.el,"contextmenu",this.__OnContextMenu,this);a.on("destroy",this.__OnGridDestroy,this)};mini._Grid_ColumnsMenu.prototype={__OnGridDestroy:function(a){this.menu&&this.menu.destroy();this.menu=null},createMenu:function(){var a=mini.create({type:"menu",hideOnClick:!1});a.on("itemclick",this.__OnItemClick,this);jQuery(a.el).addClass("mini-menu-open");return a},updateMenu:function(){for(var a=this.owner,b=this.menu,c=a.getBottomColumns(),d=[],e=0,f=c.length;e<f;e++){var g=c[e];if(!g.hideable){var k={};k.checked=g.visible;k.checkOnClick=!0;k.text=a._createHeaderText(g);"\x26nbsp;"==k.text&&("indexcolumn"==g.type&&(k.text="\u5e8f\u53f7"),"checkcolumn"==g.type&&(k.text="\u9009\u62e9"));d.push(k);k.enabled=g.enabled;k._column=g}}b.setItems(d)},__OnContextMenu:function(a){var b=this.owner;if(0!=b.showColumnsMenu&&0!=mini.isAncestor(b._columnsEl,a.target))return this.updateMenu(),this.menu.showAtPos(a.pageX,a.pageY),!1},__OnItemClick:function(a){var b=this.owner,c=this.menu;b.getBottomColumns();c=c.getItems();a=a.item;for(var d=a._column,e=0,f=0,g=c.length;f<g;f++)c[f].getChecked()&&e++;1>e&&a.setChecked(!0);a.getChecked()?b.showColumn(d):b.hideColumn(d)}};mini._Grid_CellToolTip=function(a){this.owner=a;mini.on(this.owner.el,"mousemove",this.__OnGridMouseMove,this)};mini._Grid_CellToolTip.prototype={__OnGridMouseMove:function(a){var b=this.owner;if(mini.hasClass(a.target,"mini-grid-headerCell-inner")){var c=a.target;c.title=c.scrollWidth>c.clientWidth?(c.innerText||c.textContent||"").trim():""}else{var d=b._getCellByEvent(a),c=b._getCellEl(d[0],d[1]),e=b.getCellError(d[0],d[1]);c&&(e?setTimeout(function(){c.title=e.errorText},10):setTimeout(function(){var a=c;c.firstChild&&(mini.hasClass(c.firstChild,"mini-grid-cell-inner")&&(a=c.firstChild),mini.hasClass(c.firstChild,"mini-tree-nodetitle")&&(a=c.firstChild));a.scrollWidth>a.clientWidth&&b.getShowCellTip()&&d[1].showCellTip?c.title=(a.innerText||a.textContent||"").trim():c.title=""},10))}}};mini._Grid_Sorter=function(a){this.owner=a;this.owner.on("headercellclick",this.__OnGridHeaderCellClick,this);this.owner.on("headercelldblclick",this.__OnGridHeaderCellClick,this);mini.on(a._headerEl,"mousemove",this.__OnGridHeaderMouseMove,this);mini.on(a._headerEl,"mouseout",this.__OnGridHeaderMouseOut,this)};mini._Grid_Sorter.prototype={__OnGridHeaderMouseOut:function(a){this._focusedColumnEl&&mini.removeClass(this._focusedColumnEl,"mini-grid-headerCell-hover")},__OnGridHeaderMouseMove:function(a){if(a=mini.findParent(a.target,"mini-grid-headerCell"))mini.addClass(a,"mini-grid-headerCell-hover"),this._focusedColumnEl=a},__OnGridHeaderCellClick:function(a){var b=this.owner,c=a.htmlEvent.type;"dblclick"==c&&!b.sortDblClick||"click"==c&&b.sortDblClick||!mini.hasClass(a.htmlEvent.target,"mini-grid-headerCell-inner")||!b.allowSortColumn||0!=b.isEditing()||(c=a.column,c.columns&&0!=c.columns.length||(a=c.sortField||c.field)&&!1!==c.allowSort&&(b.allowCancelSort&&"desc"==b.getSortOrder()?b.clearSort():(c="asc",b.getSortField()==a&&(c="asc"==b.getSortOrder()?"desc":"asc"),b.sortBy(a,c))))}};mini._Grid_ColumnMove=function(a){this.owner=a;mini.on(this.owner.el,"mousedown",this.__onGridMouseDown,this)};mini._Grid_ColumnMove.prototype={__onGridMouseDown:function(a){var b=this.owner;if(!b.isEditing()&&!mini.hasClass(a.target,"mini-grid-column-splitter")&&a.button!=mini.MouseButton.Right){var c=mini.findParent(a.target,b._headerCellCls);if(c){this._remove();var d=b._getColumnByEvent(a);b.allowMoveColumn&&d&&d.allowMove&&(this.dragColumn=d,this._columnEl=c,this.getDrag().start(a))}}},getDrag:function(){this.drag||(this.drag=new mini.Drag({capture:!1,onStart:mini.createDelegate(this._OnDragStart,this),onMove:mini.createDelegate(this._OnDragMove,this),onStop:mini.createDelegate(this._OnDragStop,this)}));return this.drag},_OnDragStart:function(a){var b=this.owner,c=this._dragProxy=mini.append(document.body,'\x3cdiv class\x3d"mini-grid-columnproxy"\x3e\x3c/div\x3e'),d=this.dragColumn,e=d.header;"function"==typeof e&&(e=e.call(b,d));if(mini.isNull(e)||""===e)e="\x26nbsp;";c.innerHTML='\x3cdiv class\x3d"mini-grid-columnproxy-inner" style\x3d"height:26px;"\x3e'+e+"\x3c/div\x3e";mini.setXY(this._dragProxy,a.now[0]+15,a.now[1]+18);mini.addClass(this._dragProxy,"mini-grid-no");this.moveTop=mini.append(document.body,'\x3cdiv class\x3d"mini-grid-movetop"\x3e\x3c/div\x3e');this.moveBottom=mini.append(document.body,'\x3cdiv class\x3d"mini-grid-movebottom"\x3e\x3c/div\x3e')},_OnDragMove:function(a){var b=this.owner,c=a.now[0];mini.setXY(this._dragProxy,c+15,a.now[1]+18);this.targetColumn=this.insertAction=null;if(mini.findParent(a.event.target,b._headerCellCls)&&(a=b._getColumnByEvent(a.event))&&a!=this.dragColumn){var d=b.getParentColumn(this.dragColumn),e=b.getParentColumn(a);d==e&&(this.targetColumn=a,this.insertAction="before",a=b.getColumnBox(this.targetColumn),c>a.x+a.width/2&&(this.insertAction="after"))}this.targetColumn?(mini.addClass(this._dragProxy,"mini-grid-ok"),mini.removeClass(this._dragProxy,"mini-grid-no"),b=b.getColumnBox(this.targetColumn),this.moveTop.style.display="block",this.moveBottom.style.display="block","before"==this.insertAction?(mini.setXY(this.moveTop,b.x-4,b.y-9),mini.setXY(this.moveBottom,b.x-4,b.bottom)):(mini.setXY(this.moveTop,b.right-4,b.y-9),mini.setXY(this.moveBottom,b.right-4,b.bottom))):(mini.removeClass(this._dragProxy,"mini-grid-ok"),mini.addClass(this._dragProxy,"mini-grid-no"),this.moveTop.style.display="none",this.moveBottom.style.display="none")},_remove:function(){mini.removeNode(this._dragProxy);mini.removeNode(this.moveTop);mini.removeNode(this.moveBottom);this._dragProxy=this.moveTop=this.moveBottom=this.dragColumn=this.targetColumn=null},_OnDragStop:function(a){this.owner.moveColumn(this.dragColumn,this.targetColumn,this.insertAction);this._remove()}};mini._Grid_ColumnSplitter=function(a){this.owner=a;mini.on(a.el,"mousedown",this.__OnMouseDown,this)};mini._Grid_ColumnSplitter.prototype={__OnMouseDown:function(a){var b=this.owner,c=a.target;mini.hasClass(c,"mini-grid-column-splitter")&&(c=b._getColumnById(c.id),!b.isEditing()&&b.allowResizeColumn&&c&&c.allowResize&&(this.splitterColumn=c,this.getDrag().start(a)))},getDrag:function(){this.drag||(this.drag=new mini.Drag({capture:!0,onStart:mini.createDelegate(this._OnDragStart,this),onMove:mini.createDelegate(this._OnDragMove,this),onStop:mini.createDelegate(this._OnDragStop,this)}));return this.drag},_OnDragStart:function(a){a=this.owner;var b=a.getColumnBox(this.splitterColumn);this.columnBox=b;this._dragProxy=mini.append(document.body,'\x3cdiv class\x3d"mini-grid-proxy"\x3e\x3c/div\x3e');var c=a.getGridViewBox();c.x=b.x;c.width=b.width;c.right=b.right;mini.setBox(this._dragProxy,c);a._ignoreClick=!0},_OnDragMove:function(a){var b=this.owner;a=mini.copyTo({},this.columnBox).width+(a.now[0]-a.init[0]);a<b.columnMinWidth&&(a=b.columnMinWidth);a>b.columnMaxWidth&&(a=b.columnMaxWidth);mini.setWidth(this._dragProxy,a)},_OnDragStop:function(a){var b=this.owner,c=mini.getBox(this._dragProxy),d=this,e=b.allowSortColumn;b.allowSortColumn=!1;setTimeout(function(){jQuery(d._dragProxy).remove();d._dragProxy=null;b.allowSortColumn=e},10);a=this.splitterColumn;var f=parseInt(a.width);if(f+"%"!=a.width){var g=b.getColumnWidth(a),c=parseInt(f/g*c.width);c<b.columnMinWidth&&(c=b.columnMinWidth);b.setColumnWidth(a,c)}setTimeout(function(){b._ignoreClick=!1},100)}};mini._Grid_DragDrop=function(a){this.owner=a;this.owner.on("CellMouseDown",this.__OnGridCellMouseDown,this)};mini._Grid_DragDrop.prototype={__OnGridCellMouseDown:function(a){if(a.htmlEvent.button!=mini.MouseButton.Right){var b=this.owner;if(!b._dragging&&(this.dropObj=b,!mini.findParent(a.htmlEvent.target,"mini-tree-editinput")&&!b.isReadOnly()&&0!=b.isAllowDrag(a.record,a.column))){var c=b._OnDragStart(a.record,a.column);c.cancel||(this.dragText=c.dragText,c=a.record,this.isTree=!!b.isTree,this.beginRecord=c,this._getDrag().start(a.htmlEvent))}}},_OnDragStart:function(a){a=this.owner;a._dragging=!0;var b=this.beginRecord;this.dragData=a._getDragData();-1==this.dragData.indexOf(b)&&this.dragData.push(b);this.feedbackEl=mini.append(document.body,'\x3cdiv class\x3d"mini-feedback"\x3e\x3c/div\x3e');this.feedbackEl.innerHTML=this.dragText;this.lastFeedbackClass="";this.enableHotTrack=a.getEnableHotTrack();a.setEnableHotTrack(!1)},_getDropTargetObj:function(a){if(a=mini.findParent(a.target,"mini-grid",500))return mini.get(a)},_OnDragMove:function(a){var b=this._getDropTargetObj(a.event);this.dropObj=b;var c=a.now[1];mini.setXY(this.feedbackEl,a.now[0]+15,c+18);if(b&&b.allowDrop){this.isTree=b.isTree;var d=b._getRecordByEvent(a.event);this.dragAction=(this.dropRecord=d)?this.isTree?this.getFeedback(d,c,3):this.getFeedback(d,c,2):"no"}else this.dragAction="no";b&&b.allowDrop&&!d&&0==b.getData().length&&(this.dragAction="add");this.lastFeedbackClass="mini-feedback-"+this.dragAction;this.feedbackEl.className="mini-feedback "+this.lastFeedbackClass;"no"==this.dragAction&&(d=null);this.setRowFeedback(d,this.dragAction)},_OnDragStop:function(a){a=this.owner;var b=this.dropObj;a._dragging=!1;mini.removeNode(this.feedbackEl);a.setEnableHotTrack(this.enableHotTrack);this.feedbackEl=null;this.setRowFeedback(null);if(this.isTree){for(var c=[],d=0,e=this.dragData.length;d<e;d++){for(var f=this.dragData[d],g=!1,k=0,l=this.dragData.length;k<l;k++){var n=this.dragData[k];if(n!=f&&(g=a.isAncestor(n,f)))break}g||c.push(f)}this.dragData=c}"add"!=this.dragAction||this.dropRecord||(this.dropRecord=b.getRootNode?b.getRootNode():{__root:!0});this.dropRecord&&b&&"no"!=this.dragAction&&(d=b._OnDragDrop(this.dragData,this.dropRecord,this.dragAction),d.cancel||(c=d.dragNodes,f=d.targetNode,e=d.action,b.isTree?a==b?b.moveNodes(c,f,e):("move"==b.dropAction?a.removeNodes(c):"copy"==b.dropAction&&(c=mini.clone(c)),b.addNodes(c,f,e)):(f=b.indexOf(f),"after"==e&&(f+=1),a==b?b.moveRow(c,f):("move"==b.dropAction?a.removeRows(c):"copy"==b.dropAction&&(c=mini.clone(c)),"add"==this.dragAction?b.addRows(c):b.addRows(c,f))),d={dragNode:d.dragNodes[0],dropNode:d.targetNode,dragAction:d.action,dragNodes:d.dragNodes,targetNode:d.targetNode},b.fire("drop",d)));this.dragData=this.dropRecord=null},setRowFeedback:function(a,b){var c=this.dropObj;this.lastAddDomRow&&c&&c.removeRowCls(this.lastAddDomRow,"mini-tree-feedback-add");if(null==a||"add"==this.dragAction)mini.removeNode(this.feedbackLine),this.feedbackLine=null;this.lastRowFeedback=a;if(null!=a)if("before"==b||"after"==b){this.feedbackLine||(this.feedbackLine=mini.append(document.body,"\x3cdiv class\x3d'mini-feedback-line'\x3e\x3c/div\x3e"));this.feedbackLine.style.display="block";var d=c.getRowBox(a),e=d.x,f=d.y-1;"after"==b&&(f+=d.height);mini.setXY(this.feedbackLine,e,f);c=c.getBox(!0);mini.setWidth(this.feedbackLine,c.width)}else c.addRowCls(a,"mini-tree-feedback-add"),this.lastAddDomRow=a},getFeedback:function(a,b,c){var d=this.owner,e=this.dropObj,f=e.getRowBox(a),g=f.height;b-=f.y;f=null;if(-1!=this.dragData.indexOf(a))return"no";var k=!1;if(3==c)for(var k=e.isLeaf(a),l=0,n=this.dragData.length;l<n;l++)if(e.isAncestor(this.dragData[l],a)){f="no";break}null==f&&(f=2==c?b>g/2?"after":"before":k&&!1===e.allowLeafDropIn?b>g/2?"after":"before":b>g/3*2?"after":g/3<=b&&b<=g/3*2?"add":"before");return e._OnGiveFeedback(f,this.dragData,a,d).effect},_getDrag:function(){this.drag||(this.drag=new mini.Drag({onStart:mini.createDelegate(this._OnDragStart,this),onMove:mini.createDelegate(this._OnDragMove,this),onStop:mini.createDelegate(this._OnDragStop,this)}));return this.drag}};mini._Grid_Events=function(a){this.owner=a;el=a.el;mini.on(el,"click",this.__OnClick,this);mini.on(el,"dblclick",this.__OnDblClick,this);mini.on(el,"mousedown",this.__OnMouseDown,this);mini.on(el,"mouseup",this.__OnMouseUp,this);mini.on(el,"mousemove",this.__OnMouseMove,this);mini.on(el,"mouseover",this.__OnMouseOver,this);mini.on(el,"mouseout",this.__OnMouseOut,this);mini.on(el,"keydown",this.__OnKeyDown,this);mini.on(el,"keyup",this.__OnKeyUp,this);mini.on(el,"contextmenu",this.__OnContextMenu,this);a.on("rowmousemove",this.__OnRowMouseMove,this);mini.on(window,"resize",this.__windowResize,this)};mini._Grid_Events.prototype={__windowResize:function(){var a=this.owner;setTimeout(function(){var b=a._getEditingControl();if(b){var c=a.getCurrentCell(),c=a.getCellBox(c[0],c[1]);a._getEditWrap(c,b);a._setEditorBox(b,c)}},100)},_row:null,__OnRowMouseMove:function(a){var b=this.owner,c=a.record;this._row!=c&&(a.record=c,a.row=c,b.fire("rowmouseenter",a));this._row=c},__OnClick:function(a){this.owner._ignoreClick||this._fireEvent(a,"Click")},__OnDblClick:function(a){this._fireEvent(a,"Dblclick")},__OnMouseDown:function(a){var b=this.owner;if(!mini.findParent(a.target,"mini-tree-editinput")&&!mini.findParent(a.target,"mini-tree-node-ecicon")){this._fireEvent(a,"MouseDown");var c=300;"a"==a.target.tagName.toLowerCase()&&a.target.href&&(c=10);setTimeout(function(){var c=mini.findParent(a.target,"mini-grid-detailRow");mini.isAncestor(b.el,c)||b._editingCell||b._tryFocus(a)},c)}},__OnMouseUp:function(a){mini.findParent(a.target,"mini-tree-editinput")||mini.findParent(a.target,"mini-tree-node-ecicon")||mini.findParent(a.target,"mini-tree-checkbox")||mini.isAncestor(this.owner.el,a.target)&&this._fireEvent(a,"MouseUp")},__OnMouseMove:function(a){this._fireEvent(a,"MouseMove")},__OnMouseOver:function(a){this._fireEvent(a,"MouseOver")},__OnMouseOut:function(a){this._fireEvent(a,"MouseOut")},__OnKeyDown:function(a){this._fireEvent(a,"KeyDown")},__OnKeyUp:function(a){this._fireEvent(a,"KeyUp")},__OnContextMenu:function(a){this._fireEvent(a,"ContextMenu")},_fireEvent:function(a,b){var c=this.owner,d=c._getCellByEvent(a),e=d[0],d=d[1];if(e){var f={record:e,row:e,htmlEvent:a},g=c["_OnRow"+b];g?g.call(c,f):c.fire("row"+b,f)}d&&(f={column:d,field:d.field,htmlEvent:a},(g=c["_OnColumn"+b])?g.call(c,f):c.fire("column"+b,f));e&&d&&(f={sender:c,record:e,row:e,column:d,field:d.field,htmlEvent:a},(g=c["_OnCell"+b])?g.call(c,f):c.fire("cell"+b,f),d["onCell"+b]&&d["onCell"+b].call(d,f));!e&&d&&mini.findParent(a.target,"mini-grid-headerCell")&&(f={column:d,htmlEvent:a},(g=c["_OnHeaderCell"+b])?g.call(c,f):(e="onheadercell"+b.toLowerCase(),d[e]&&(f.sender=c,d[e](f)),c.fire("headercell"+b,f)))}};mini.DataGrid=function(a){mini.DataGrid.superclass.constructor.call(this,null);this._Events=new mini._Grid_Events(this);this._Select=new mini._Grid_Select(this);this._DragDrop=new mini._Grid_DragDrop(this);this._RowGroup=new mini._Grid_RowGroup(this);this._Splitter=new mini._Grid_ColumnSplitter(this);this._ColumnMove=new mini._Grid_ColumnMove(this);this._Sorter=new mini._Grid_Sorter(this);this._CellToolTip=new mini._Grid_CellToolTip(this);this._ColumnsMenu=new mini._Grid_ColumnsMenu(this);this._createPagers();a&&mini.applyTo.call(this,a)};
mini.extend(mini.DataGrid,mini.ScrollGridView,{uiCls:"mini-datagrid",selectOnLoad:!1,showHeader:!1,showPager:!0,validateOnAdd:!1,getValidateOnAdd:function(){return this.validateOnAdd},setValidateOnAdd:function(a){this.validateOnAdd=a},dropAction:"move",onlyCheckSelection:!1,_$onlyCheckSelection:!0,allowUnselect:!1,allowRowSelect:!0,allowCellSelect:!1,allowCellEdit:!1,cellEditAction:"cellclick",allowCellValid:!1,allowResizeColumn:!0,allowSortColumn:!0,allowMoveColumn:!0,showColumnsMenu:!1,virtualScroll:!1,enableHotTrack:!0,allowHotTrackOut:!0,showLoading:!0,columnMinWidth:8,_expandLoad:function(){},set:function(a){if("string"==typeof a)return this;var b=a.value;delete a.value;var c=a.url;delete a.url;var d=a.data;delete a.data;var e=a.columns;delete a.columns;var f=a.defaultColumnWidth;delete a.defaultColumnWidth;f&&this.setDefaultColumnWidth(f);mini.isNull(e)||this.setColumns(e);mini.DataGrid.superclass.set.call(this,a);mini.isNull(d)||this.setData(d);mini.isNull(c)||this.setUrl(c);mini.isNull(b)||this.setValue(b);return this},doUpdate:function(){this._destroyEditors();mini.DataGrid.superclass.doUpdate.apply(this,arguments)},_destroyEditors:function(){for(var a=mini.getChildControls(this),b=[],c=0,d=a.length;c<d;c++){var e=a[c];e.el&&mini.findParent(e.el,this._rowCls)&&(b.push(e),e.destroy())}},_OnDrawCell:function(){return mini.DataGrid.superclass._OnDrawCell.apply(this,arguments)},_bindSource:function(){var a=this._dataSource;a.on("beforeload",this.__OnSourceBeforeLoad,this);a.on("preload",this.__OnSourcePreLoad,this);a.on("load",this.__OnSourceLoadSuccess,this);a.on("loaderror",this.__OnSourceLoadError,this);a.on("loaddata",this.__OnSourceLoadData,this);a.on("cleardata",this.__OnSourceClearData,this);a.on("sort",this.__OnSourceSort,this);a.on("filter",this.__OnSourceFilter,this);a.on("pageinfochanged",this.__OnPageInfoChanged,this);a.on("selectionchanged",this.__OnSelectionChanged,this);a.on("currentchanged",function(a){this.fire("currentchanged",a)},this);a.on("add",this.__OnSourceAdd,this);a.on("update",this.__OnSourceUpdate,this);a.on("remove",this.__OnSourceRemove,this);a.on("move",this.__OnSourceMove,this);a.on("beforeadd",function(a){this.fire("beforeaddrow",a)},this);a.on("beforeupdate",function(a){this.fire("beforeupdaterow",a)},this);a.on("beforeremove",function(a){this.fire("beforeremoverow",a)},this);a.on("beforemove",function(a){this.fire("beforemoverow",a)},this);a.on("beforeselect",function(a){this.fire("beforeselect",a)},this);a.on("beforedeselect",function(a){this.fire("beforedeselect",a)},this);a.on("select",function(a){this.fire("select",a)},this);a.on("deselect",function(a){this.fire("deselect",a)},this)},_getMaskWrapEl:function(){return this.el},_initData:function(){this.data=this._dataSource.getSource();this.pageIndex=this.getPageIndex();this.pageSize=this.getPageSize();this.totalCount=this.getTotalCount();this.totalPage=this.getTotalPage();this.sortField=this.getSortField();this.sortOrder=this.getSortOrder();this.url=this.getUrl();this._mergedCellMaps={};this._mergedCells={};this._cellErrors=[];this._cellMapErrors={};this.isGrouping()&&(this.groupBy(this._groupField,this._groupDir),this.collapseGroupOnLoad&&this.collapseGroups())},__OnSourceBeforeLoad:function(a){this.fire("beforeload",a);1!=a.cancel&&this.showLoading&&this.loading()},__OnSourcePreLoad:function(a){this.fire("preload",a)},__OnSourceLoadSuccess:function(a){this.fire("load",a);this.unmask()},__OnSourceLoadError:function(a){this.fire("loaderror",a);this.unmask()},__OnSourceSort:function(a){this.deferUpdate();this.fire("sort",a)},__OnSourceFilter:function(a){this.deferUpdate();this.fire("filter",a)},__OnSourceAdd:function(a){this._doAddRowEl(a.record,a.index);var b=this;b._addTimer||(b._addTimer=setTimeout(function(){b._addTimer=null;b._doUpdateSummaryRow();b._viewRegion=b._getViewRegion()},10));this.fire("addrow",a)},__OnSourceUpdate:function(a){this._doUpdateRowEl(a.record);this._doUpdateSummaryRow();this.fire("updaterow",a)},__OnSourceRemove:function(a){var b=this;this._doRemoveRowEl(a.record);b._toSummary||(b._toSummary=setTimeout(function(){b._toSummary=null;b._doUpdateSummaryRow()},10));this.fire("removerow",a);this.isVirtualScroll()&&this.deferUpdate()},__OnSourceMove:function(a){this._doMoveRowEl(a.record,a.index);this._doUpdateSummaryRow();this.fire("moverow",a)},__OnSelectionChanged:function(a){!1!==a.fireEvent&&(a.select?this.fire("rowselect",a):this.fire("rowdeselect",a));var b=this;this._selectionTimer&&(clearTimeout(this._selectionTimer),this._selectionTimer=null);this._selectionTimer=setTimeout(function(){b._selectionTimer=null;!1!==a.fireEvent&&b.fire("SelectionChanged",a);b.fire("_selectchange",a)},1);this._doRowSelect(a._records,a.select)},__OnPageInfoChanged:function(a){this._updatePagesInfo()},_updatePagesInfo:function(){var a=this.getPageIndex(),b=this.getPageSize(),c=this.getTotalCount();this.getTotalPage();for(var d=this._pagers,e=0,f=d.length;e<f;e++){var g=d[e];g.update(a,b,c);this._dataSource.totalPage=g.totalPage}},setPagerButtons:function(a){this._bottomPager.setButtons(a)},setPager:function(a){if("string"==typeof a){if(!mini.byId(a))return;mini.parse(a);a=mini.get(a)}a&&this.bindPager(a)},bindPager:function(a){a&&(this.unbindPager(a),this._pagers.add(a),a.on("beforepagechanged",this.__OnPageChanged,this))},unbindPager:function(a){a&&(this._pagers.remove(a),a.un("pagechanged",this.__OnPageChanged,this))},__OnPageChanged:function(a){a.cancel=!0;this.gotoPage(a.pageIndex,a.pageSize)},_canUpdateRowEl:!0,_doUpdateRowEl:function(a){var b=this.getFrozenColumns(),c=this.getUnFrozenColumns(),d,e=this.indexOf(a),f=this._createRowHTML(a,e,c,2),g=this._getRowEl(a,2);g&&(jQuery(g).before(f),c=g.previousSibling,g&&g.parentNode.removeChild(g),this.isFrozen()&&(f=this._createRowHTML(a,e,b,1),g=this._getRowEl(a,1),jQuery(g).before(f),d=g.previousSibling,jQuery(g).remove()),this.deferLayout(),c&&d&&this._doSyncRowHeight(c,d))},_doAddRowEl:function(a,b){function c(a,b,c,d){a=this._createRowHTML(a,k,c,b);l?(b=this._getRowEl(l,b),jQuery(b).before(a)):mini.append(d,a)}var d=this.getFrozenColumns(),e=this.getUnFrozenColumns(),f=this._rowsLockContentEl.firstChild,g=this._rowsViewContentEl.firstChild,k=mini.isNumber(b)?b:this.indexOf(a),l=this.getAt(k+1);c.call(this,a,2,e,g);this.isFrozen()&&c.call(this,a,1,d,f);this.deferLayout();this.showEmptyText&&(d=jQuery(".mini-grid-emptyText",this._bodyEl)[0])&&(d.style.display="none",d.parentNode.style.display="none")},_doRemoveRowEl:function(a){var b=this._getRowEl(a,1),c=this._getRowEl(a,2);b&&b.parentNode.removeChild(b);c&&c.parentNode.removeChild(c);c&&(b=this._getRowDetailEl(a,1),a=this._getRowDetailEl(a,2),b&&b.parentNode.removeChild(b),a&&a.parentNode.removeChild(a),this.deferLayout(),this.showEmptyText&&0==this.getVisibleRows().length&&(a=jQuery(".mini-grid-emptyText",this._bodyEl)[0]))&&(a.style.display="",a.parentNode.style.display="")},_doMoveRowEl:function(a,b){this._doRemoveRowEl(a);this._doAddRowEl(a)},_getRowGroupEl:function(a,b){if(1==b&&!this.isFrozen())return null;var c=this._createRowGroupId(a,b);return mini.byId(c,this.el)},_getRowGroupRowsEl:function(a,b){if(1==b&&!this.isFrozen())return null;var c=this._createRowGroupRowsId(a,b);return mini.byId(c,this.el)},_getRowEl:function(a,b){null==b&&(b=2);if(1==b&&!this.isFrozen())return null;a=this.getRecord(a);var c=this._createRowId(a,b);return mini.byId(c,this.el)},_getHeaderCellEl:function(a,b){null==b&&(b=2);if(1==b&&!this.isFrozen())return null;a=this.getColumn(a);var c=this._createHeaderCellId(a,b);return mini.byId(c,this.el)},getRowEl:function(a,b){return this._getRowEl(a,b)},getHeaderCellEl:function(a,b){return this._getHeaderCellEl(a,b)},_getCellEl:function(a,b){a=this.getRecord(a);b=this.getColumn(b);if(!a||!b)return null;var c=this._createCellId(a,b);return mini.byId(c,this.el)},getCellEl:function(a,b){return this._getCellEl(a,b)},getRecordByEvent:function(a){return this._getRecordByEvent(a)},_getRecordByEvent:function(a){a=mini.findParent(a.target,this._rowCls);if(!a)return null;a=a.id.split("$");return this._getRowByID(a[a.length-1])},getColumnByEvent:function(a){return a?this._getColumnByEvent(a):null},_getColumnByEvent:function(a){var b=mini.findParent(a.target,this._cellCls);b||(b=mini.findParent(a.target,this._headerCellCls));return b?(a=b.id.split("$"),this._getColumnById(a[a.length-1])):null},_getCellByEvent:function(a){var b=this._getRecordByEvent(a);a=this._getColumnByEvent(a);return[b,a]},getColumnFromEvent:function(a){return a?this._getColumnByEvent(a):null},getCellFromEvent:function(a){return this._getCellByEvent(a)},getRowFromEvent:function(a){return(a=this._getCellByEvent(a))?a[0]:null},getRowByEvent:function(a){return this.getRowFromEvent(a)},getColumnByEvent:function(a){return this.getColumnFromEvent(a)},getCellByEvent:function(a){return this.getCellFromEvent(a)},_getRowByID:function(a){return this._dataSource.getby_id(a)},_getColumnById:function(a){return this._columnModel._getColumnById(a)},hasRowCls:function(a,b){var c=this._rowClsHash[a._id];return c?-1!=c.indexOf(b):!1},addRowCls:function(a,b,c){var d=this._getRowEl(a,1),e=this._getRowEl(a,2);d&&mini.addClass(d,b);e&&mini.addClass(e,b);a&&!1!==c&&((c=this._rowClsHash[a._id])?c.remove(b):c=this._rowClsHash[a._id]=[],c.push(b))},removeRowCls:function(a,b){var c=this._getRowEl(a,1),d=this._getRowEl(a,2);c&&mini.removeClass(c,b);d&&mini.removeClass(d,b);a&&(c=this._rowClsHash[a._id])&&(c.remove(b),0==c.length&&delete this._rowClsHash[a._id])},getCellBox:function(a,b){a=this.getRow(a);b=this.getColumn(b);if(!a||!b)return null;var c=this._getCellEl(a,b);return c?mini.getBox(c):null},getColumnBox:function(a){var b=this._createHeaderCellId(a,2),b=document.getElementById(b);b||(b=this._createHeaderCellId(a,1),b=document.getElementById(b));if(b)return a=mini.getBox(b),--a.x,a.left=a.x,a.right=a.x+a.width,a},getRowBox:function(a){var b=this._getRowEl(a,1);a=this._getRowEl(a,2);if(!a)return null;a=mini.getBox(a);b&&(b=mini.getBox(b),a.x=a.left=b.left,a.width=a.right-a.x);return a},_doRowSelect:function(a,b){var c=this.isVirtualScroll(),d=this._viewRegion,e=c?d.start:-1,f=c?d.end:-1,c={};if(-1!=e)for(var g=this.getVisibleRows(),d=e;d<f;d++){var k=g[d];k&&(c[k._id]=!0)}d=0;for(f=a.length;d<f;d++)if(g=a[d],-1==e||c[g._id])b?this.addRowCls(g,this._rowSelectedCls,!1):this.removeRowCls(g,this._rowSelectedCls)},_tryFocus:function(a){try{var b=a.target.tagName.toLowerCase();"input"!=b&&"textarea"!=b&&"select"!=b&&!mini.hasClass(a.target,"mini-placeholder-label")&&mini.findParent(a.target,"mini-grid-rows-content")&&(mini.setXY(this._focusEl,a.pageX,a.pageY),this.focus(!1))}catch(c){}},focus:function(a){try{var b=this.getCurrentCell();if(b&&!1!==a){var c=this.getCellBox(b[0],b[1]);mini.setX(this._focusEl,c.x)}var d=this.getCurrent();if(d){var e=this._getRowEl(d,2);if(e){if(!1!==a){var f=mini.getBox(e);mini.setY(this._focusEl,f.top)}mini.isIE||mini.isIE11||mini.isChrome?mini.isChrome?this.el.focus():this._focusEl.focus():this.el.focus()}}else mini.isIE||mini.isIE11||mini.isChrome?this._focusEl.focus():this.el.focus()}catch(g){}},focusRow:function(a){this._focusRow!=a&&(this._focusRow&&this.removeRowCls(this._focusRow,this._rowHoverCls),(this._focusRow=a)&&this.addRowCls(a,this._rowHoverCls,!1),mini.isIE6&&mini.repaint())},scrollIntoView:function(a,b,c){if(a=this.getRow(a)){c=this.isVirtualScroll();try{b&&this._columnModel.isFrozenColumn(b)&&(b=null);if(b){var d=this._getCellEl(a,b);mini.scrollIntoView(d,this._rowsViewEl,!0,1!=c);this._syncScroll()}if(this.isVirtualScroll()){var e=this.getScrollTop(),f=this._vscrollEl.offsetHeight;this._getViewRegion();var g=this.getVisibleRows().indexOf(a),k=this._getRangeHeight(0,g),l=k+(a._height||this.defaultRowHeight);k<e?(this.setScrollTop(k),this._updateScrollTop(k)):l>e+f&&(k=e+l-(e+f),this.setScrollTop(k),this._updateScrollTop(k))}else{var n=this._getRowEl(a,2);mini.scrollIntoView(n,this._rowsViewEl,!1);this._syncScroll()}}catch(p){}}},setShowLoading:function(a){this.showLoading=a},getShowLoading:function(){return this.showLoading},setEnableHotTrack:function(a){this.enableHotTrack=a},getEnableHotTrack:function(){return this.enableHotTrack},setAllowHotTrackOut:function(a){this.allowHotTrackOut=a},getAllowHotTrackOut:function(){return this.allowHotTrackOut},setOnlyCheckSelection:function(a){this.onlyCheckSelection=a},getOnlyCheckSelection:function(){return this.onlyCheckSelection},setAllowUnselect:function(a){this.allowUnselect=a},getAllowUnselect:function(){return this.allowUnselect},setAllowRowSelect:function(a){this.allowRowSelect=a},getAllowRowSelect:function(){return this.allowRowSelect},setAllowCellSelect:function(a){this.allowCellSelect=a},getAllowCellSelect:function(){return this.allowCellSelect},setAllowCellEdit:function(a){this.allowCellEdit=a},getAllowCellEdit:function(){return this.allowCellEdit},setCellEditAction:function(a){this.cellEditAction=a},getCellEditAction:function(){return this.cellEditAction},setAllowCellValid:function(a){this.allowCellValid=a},getAllowCellValid:function(){return this.allowCellValid},setAllowResizeColumn:function(a){this.allowResizeColumn=a;mini.removeClass(this.el,"mini-grid-resizeColumns-no");a||mini.addClass(this.el,"mini-grid-resizeColumns-no")},getAllowResizeColumn:function(){return this.allowResizeColumn},setAllowSortColumn:function(a){this.allowSortColumn=a},getAllowSortColumn:function(){return this.allowSortColumn},setAllowMoveColumn:function(a){this.allowMoveColumn=a},getAllowMoveColumn:function(){return this.allowMoveColumn},setShowColumnsMenu:function(a){this.showColumnsMenu=a},getShowColumnsMenu:function(){return this.showColumnsMenu},setEditNextRowCell:function(a){this.editNextRowCell=a},getEditNextRowCell:function(){return this.editNextRowCell},setEditNextOnEnterKey:function(a){this.editNextOnEnterKey=a},getEditNextOnEnterKey:function(){return this.editNextOnEnterKey},setEditOnTabKey:function(a){this.editOnTabKey=a},getEditOnTabKey:function(){return this.editOnTabKey},setCreateOnEnter:function(a){this.createOnEnter=a},getCreateOnEnter:function(){return this.createOnEnter},_currentCell:null,_doCurrentCell:function(a){if(this._currentCell){var b=this._getCellEl(this._currentCell[0],this._currentCell[1]);b&&(a?mini.addClass(b,this._cellSelectedCls):mini.removeClass(b,this._cellSelectedCls))}},setCurrentCell:function(a){if(this._currentCell!=a){this._doCurrentCell(!1);if(this._currentCell=a){var b=this.getRow(a[0]),c=this.getColumn(a[1]);this._currentCell=b&&c?[b,c]:null}this._doCurrentCell(!0);a&&(this._getAnchorCell(a[0],a[1])||(this.isFrozen()?this.scrollIntoView(a[0],null,!1):this.scrollIntoView(a[0],a[1],!1)));this.fire("currentcellchanged")}},getCurrentCell:function(){var a=this._currentCell;a&&-1==this.indexOf(a[0])&&(a=this._currentCell=null);return a},_editingCell:null,isEditingCell:function(a){return this._editingCell&&this._editingCell[0]==a[0]&&this._editingCell[1]==a[1]},beginEditCell:function(a,b){this._pushUpdateCallback(function(a,b){a=this.getRow(a);b=this.getColumn(b);var c=[a,b];a&&b&&this.setCurrentCell(c);c=this.getCurrentCell();this._editingCell&&c&&this._editingCell[0]==c[0]&&this._editingCell[1]==c[1]||(this._editingCell&&this.commitEdit(),c&&(a=c[0],b=c[1],"inline"!=b.editMode&&!1!==this._OnCellBeginEdit(a,b,this.getCellEditor(b))&&(this.scrollIntoView(a,b,!1),this._editingCell=c,this._OnCellShowingEdit(a,b))))},this,[a,b])},cancelEdit:function(){if(this.allowCellEdit)this._editingCell&&this._OnCellEndEdit();else if(this.isEditing()){this._allowLayout=!1;for(var a=this.getDataView(),b=0,c=a.length;b<c;b++)1==a[b]._editing&&this.cancelEditRow(b);this._allowLayout=!0;this.doLayout()}},commitEdit:function(){if(this.allowCellEdit)this._editingCell&&(this._OnCellCommitEdit(this._editingCell[0],this._editingCell[1]),this._OnCellEndEdit());else if(this.isEditing()){this._allowLayout=!1;for(var a=this.getDataView(),b=0,c=a.length;b<c;b++){var d=a[b];1==d._editing&&this.commitEditRow(d)}this._allowLayout=!0;this.doLayout()}},getCellEditor:function(a,b){if(a=this.getColumn(a)){if(this.allowCellEdit){var c=a.__editor;c||(c=mini.getAndCreate(a.editor));c&&c!=a.editor&&(a.editor=c);return c}b=this.getRow(b);a=this.getColumn(a);b||(b=this.getEditingRow());return b&&a?mini.get(this.uid+"$"+b._uid+"$"+a._id+"$editor"):null}},_OnCellBeginEdit:function(a,b,c,d){var e=mini._getMap(b.field,a),f={sender:this,rowIndex:this.indexOf(a),row:a,record:a,column:b,field:b.field,editor:c,value:e,cancel:!1};this.fire("cellbeginedit",f);mini.isNull(b.defaultValue)||!mini.isNull(f.value)&&""!==f.value||(e=mini.clone({d:b.defaultValue}),f.value=e.d);c=f.editor;e=f.value;if(f.cancel||!c&&"inline"!=b.editMode||!0===b.readOnly)return!1;if(!1===d)return!0;"inline"!=b.editMode&&(mini.isNull(e)&&(e=""),c.setValue&&c.setValue(e),c.ownerRowID=a._uid,b.displayField&&c.setText&&(a=mini._getMap(b.displayField,a),mini.isNull(b.defaultText)||!mini.isNull(a)&&""!==a||(e=mini.clone({d:b.defaultText}),a=e.d),c.setText(a)),this.allowCellEdit&&(this._editingControl=f.editor));return!0},_OnCellCommitEdit:function(a,b,c,d){c={sender:this,rowIndex:this.indexOf(a),record:a,row:a,column:b,field:b.field,editor:d?d:this.getCellEditor(b),value:mini.isNull(c)?"":c,text:"",cancel:!1};if(c.editor&&c.editor.getValue){try{c.editor.blur()}catch(f){}c.value=c.editor.getValue()}c.editor&&c.editor.getText&&(c.text=c.editor.getText());d=mini._getMap(b.field,a);var e=c.value;c.oldValue=d;if(mini.isEquals(d,e))return c;this.fire("cellcommitedit",c);0==c.cancel&&this.allowCellEdit&&(d={},d[b.field]=c.value,b.displayField&&(d[b.displayField]=c.text),this.updateRow(a,d));return c},_OnCellEndEdit:function(a,b){if(this._editingCell||a){a||(a=this._editingCell[0]);b||(b=this._editingCell[1]);var c=mini._getMap(b.field,a),c={sender:this,rowIndex:this.indexOf(a),record:a,row:a,column:b,field:b.field,editor:this._editingControl,value:c};this.fire("cellendedit",c);if(this.allowCellEdit&&c.editor){(c=c.editor)&&c.setIsValid&&c.setIsValid(!0);this._editWrap&&(this._editWrap.style.display="none");for(var d=this._editWrap.childNodes,e=d.length-1;0<=e;e--)this._editWrap.removeChild(d[e]);c&&c.hidePopup&&c.hidePopup();c&&c.setValue&&c.setValue("");this._editingCell=this._editingControl=null;this.allowCellValid&&this.validateCell(a,b)}}},_OnCellShowingEdit:function(a,b){if(!this._editingControl)return!1;var c=this.getCellBox(a,b);if(c){var d=document.body.scrollWidth;c.right>d&&(c.width=d-c.left,10>c.width&&(c.width=10),c.right=c.left+c.width)}d={sender:this,rowIndex:this.indexOf(a),record:a,row:a,column:b,field:b.field,cellBox:c,editor:this._editingControl};this.fire("cellshowingedit",d);(d=d.editor)&&d.setIsValid&&d.setIsValid(!0);c&&(this._getEditWrap(d),this._editWrap.style.zIndex=mini.getMaxZIndex(),this._setEditorBox(d,c),mini.on(document,"mousedown",this.__OnBodyMouseDown,this),b.autoShowPopup&&d.showPopup&&d.showPopup());d&&this.navEditMode&&(d.keyNavEnabled=!1===b.navUpdown)},_getEditingControl:function(){return this._editingControl},_setEditorBox:function(a,b){if(a.setWidth){var c=b.width;20>c&&(c=20);a.setWidth(c)}a.setHeight&&"textarea"==a.type&&(c=b.height-1,a.minHeight&&c<a.minHeight&&(c=a.minHeight),a.setHeight(c));a.setWidth&&(c=b.width-1,a.minWidth&&c<a.minWidth&&(c=a.minWidth),a.setWidth(c));var c=a.getHeight(),d=b.y;c<b.height-2&&(d=Math.round(b.y+b.height/2-c/2));mini.setXY(this._editWrap,b.x,d);mini.setWidth(this._editWrap,b.width);b.x>document.body.scrollWidth&&mini.setX(this._editWrap,-1E3)},__OnBodyMouseDown:function(a){if(this._editingControl){var b=this._getCellByEvent(a);if(this._editingCell&&b&&this._editingCell[0]==b.record&&this._editingCell[1]==b.column)return!1;b=!1;b=this._editingControl.within?this._editingControl.within(a):mini.isAncestor(this._editWrap,a.target);if(0==b){var c=this;if(0==mini.isAncestor(this._bodyEl,a.target))setTimeout(function(){c.commitEdit()},1);else{var d=c._editingCell;setTimeout(function(){d==c._editingCell&&c.commitEdit()},70)}mini.un(document,"mousedown",this.__OnBodyMouseDown,this)}}},getEditWrap:function(){return this._editWrap},_getEditWrap:function(a){this._editWrap||(this._editWrap=mini.append(this.cellEditorContainer||mini.cellEditorContainer||document.body,'\x3cdiv class\x3d"mini-grid-editwrap" style\x3d"position:absolute;"\x3e\x3c/div\x3e'),mini.on(this._editWrap,"keydown",this.___OnEditControlKeyDown,this));this._editWrap.style.zIndex=1E9;this._editWrap.style.display="block";a.render?(a.render(this._editWrap),setTimeout(function(){a.focus();a.selectText&&setTimeout(function(){a.selectText()},11)},50),a.setVisible&&a.setVisible(!0)):a.el&&(this._editWrap.appendChild(a.el),setTimeout(function(){try{a.el.focus()}catch(b){}},50));return this._editWrap},___OnEditControlKeyDown:function(a){var b=this._editingControl;if(13!=a.keyCode||!b||"textarea"!=b.type){if(13==a.keyCode){var c=new Date;if(this._enterTimestamp&&80>c-this._enterTimestamp)return;this._enterTimestamp=c;if((c=this._editingCell)&&c[1]&&!1===c[1].enterCommit)return;this.commitEdit();this.focus();this.editNextOnEnterKey&&(this.fire("celleditenter",{record:c[0],column:c[1]}),this._beginEditNextCell(0==a.shiftKey))}else 27==a.keyCode?(this.cancelEdit(),this.focus()):9==a.keyCode&&(this.commitEdit(),this.editOnTabKey&&(a.preventDefault(),this.commitEdit(),this._beginEditNextCell(0==a.shiftKey,!0)));if(this.navEditMode){if((c=this._editingCell)&&(c=c[1])&&!1===c.navUpdown&&b&&(38==a.keyCode||40==a.keyCode))return;switch(a.keyCode){case 37:this.focus();a.preventDefault();this.commitEdit();this._beginEditNextCell(!1!==a.shiftKey);break;case 39:this.focus();this.commitEdit();this.editOnTabKey&&(a.preventDefault(),this.commitEdit(),this._beginEditNextCell(0==a.shiftKey,!0));break;case 38:this.focus();a.preventDefault();c=this._editingCell;this.commitEdit();a=c[0];c=c[1];if(a)a=this.indexOf(a),0<a&&--a;else break;a=this.getRow(a);c=[a,c];this.setCurrentCell(c);this.beginEditCell();break;case 40:this.focus(),a.preventDefault(),c=this._editingCell,this.commitEdit(),a=c[0],c=c[1],a&&(a=this.indexOf(a),b=this.getData().length,a<b-1&&(a+=1),a=this.getRow(a),c=[a,c],this.setCurrentCell(c),this.beginEditCell())}}}},navEditMode:!1,setNavEditMode:function(a){this.navEditMode=a},getNavEditMode:function(){return this.navEditMode},editNextRowCell:!1,editNextOnEnterKey:!1,editOnTabKey:!0,createOnEnter:!1,skipReadOnlyCell:!1,setSkipReadOnlyCell:function(a){this.skipReadOnlyCell=a},getSkipReadOnlyCell:function(){return this.skipReadOnlyCell},isCellCanEdit:function(a,b){return this._OnCellBeginEdit(a,b,this.getCellEditor(b),!1)},_beginEditNextCell:function(a,b){function c(a){return e.getVisibleRows()[a]}var d=new Date;if(!(this._editTimestamp&&80>d-this._editTimestamp)){this._editTimestamp=d;var e=this;if(d=this.getCurrentCell()){this.focus();var f=e.getVisibleColumns(),g=d?d[1]:null,k=d?d[0]:null,l=f.indexOf(g),n=function(a){return e.getVisibleRows().indexOf(a)}(k),d=e.getVisibleRows().length;if(!1===a)if(this.skipReadOnlyCell){var p=function(){for(var a=0===l-1?f.length:l-1;0<a;a--)if(g=f[a],q.isCellCanEdit(k,g))return g},q=this,d=p();d&&0!=l||(l=f.length,p(),k=c(n-1))}else--l,g=f[l],g||(g=f[f.length-1],k=c(n-1));else if(this.editNextRowCell&&!b)n+1<d&&(k=c(n+1));else{var p=function(){for(var a=l+1==t?0:l+1;a<t;a++)if(g=f[a],q.isCellCanEdit(k,g))return g},r=function(){k=e.getAt(n+1);!k&&e.createOnEnter&&(k={},e.addRow(k))};if(this.skipReadOnlyCell){var q=this,t=f.length,d=p();d&&l+1!=t||(l=0,p(),r())}else l+=1,g=f[l],g||(g=f[0],r())}d=[k,g];e.setCurrentCell(d);!e.onlyCheckSelection&&e.allowRowSelect&&e.getCurrent()!=k&&(e.deselectAll(),e.setCurrent(k));e.scrollIntoView(k,g,!1);if(e.isReadOnly()||g.readOnly)return!1;e.beginEditCell()}}},getEditorOwnerRow:function(a){return this.getRowByUID(a.ownerRowID)},beginEditRow:function(a){this.allowCellEdit||this._pushUpdateCallback(function(a){if(a=this.getRow(a)){var b=this._getRowEl(a,2);if(b){a._editing=!0;this._doUpdateRowEl(a);b=this._getRowEl(a,2);mini.addClass(b,"mini-grid-rowEdit");for(var b=this.getVisibleColumns(),d=0,e=b.length;d<e;d++){var f=b[d],g=this._getCellEl(a,f);if(g){"string"==typeof f.editor&&(f.editor=window.eval("("+f.editor+")"));var k=mini.copyTo({},f.editor);k.id=this.uid+"$"+a._uid+"$"+f._id+"$editor";k=mini.create(k);this._OnCellBeginEdit(a,f,k)&&k&&(mini.addClass(g,"mini-grid-cellEdit"),g.innerHTML="",g.appendChild(k.el),mini.addClass(k.el,"mini-grid-editor"))}}this.doLayout()}}},this,[a])},cancelEditRow:function(a){if(!this.allowCellEdit&&(a=this.getRow(a))&&a._editing){delete a._editing;this._getRowEl(a);for(var b=this.getVisibleColumns(),c=0,d=b.length;c<d;c++){var e=this._createCellId(a,b[c]);(e=document.getElementById(e))&&(e=mini.get(e.firstChild))&&e.destroy()}this._doUpdateRowEl(a);this.doLayout()}},commitEditRow:function(a){if(!this.allowCellEdit&&(a=this.getRow(a))&&a._editing){var b=this.getEditRowData(a,!1,!1);this._canUpdateRowEl=!1;this.updateRow(a,b);this._canUpdateRowEl=!0;this.cancelEditRow(a)}},isEditing:function(){for(var a=this.getDataView(),b=0,c=a.length;b<c;b++)if(1==a[b]._editing)return!0;return!1},isEditingRow:function(a){return(a=this.getRow(a))?!!a._editing:!1},isNewRow:function(a){return"added"==a._state},getEditingRows:function(){for(var a=[],b=this.getDataView(),c=0,d=b.length;c<d;c++){var e=b[c];1==e._editing&&a.push(e)}return a},getEditingRow:function(){return this.getEditingRows()[0]},getEditData:function(a){for(var b=[],c=this.getDataView(),d=0,e=c.length;d<e;d++)if(1==c[d]._editing){var f=this.getEditRowData(d,a);b.push(f)}return b},getEditRowData:function(a,b,c){a=this.getRow(a);if(!a||!a._editing)return null;for(var d=this.getIdField(),e=this.getParentField?this.getParentField():null,f={},g=this.getVisibleColumns(),k=0,l=g.length;k<l;k++){var n=g[k],p=this._createCellId(a,g[k]);if(p=document.getElementById(p)){if("checkboxcolumn"==n.type||"radiobuttoncolumn"==n.type)p=n.isChecked(a,n)?n.trueValue:n.falseValue,p=this._OnCellCommitEdit(a,n,p);else{p=mini.get(p.firstChild);if(!p)continue;p=this._OnCellCommitEdit(a,n,null,p)}!1!==c?(mini._setMap(n.field,p.value,f),n.displayField&&mini._setMap(n.displayField,p.text,f)):(f[n.field]=p.value,n.displayField&&(f[n.displayField]=p.text))}}f[d]=a[d];e&&(f[e]=a[e]);b&&(a=mini.copyTo({},a),f=mini.copyTo(a,f));return f},collapseGroups:function(){if(this.isGrouping()){this._allowLayout=!1;for(var a=this.getGroupingView(),b=0,c=a.length;b<c;b++)this.collapseRowGroup(a[b]);this._allowLayout=!0;this.doLayout()}},expandGroups:function(){if(this.isGrouping()){this._allowLayout=!1;for(var a=this.getGroupingView(),b=0,c=a.length;b<c;b++)this.expandRowGroup(a[b]);this._allowLayout=!0;this.doLayout()}},toggleRowGroup:function(a){a.expanded?this.collapseRowGroup(a):this.expandRowGroup(a)},collapseRowGroup:function(a){if(a=this.getRowGroup(a)){a.expanded=!1;var b=this._getRowGroupEl(a,1),c=this._getRowGroupRowsEl(a,1),d=this._getRowGroupEl(a,2);a=this._getRowGroupRowsEl(a,2);c&&(c.style.display="none");a&&(a.style.display="none");b&&mini.addClass(b,"mini-grid-group-collapse");d&&mini.addClass(d,"mini-grid-group-collapse");this.doLayout()}},expandRowGroup:function(a){if(a=this.getRowGroup(a)){a.expanded=!0;var b=this._getRowGroupEl(a,1),c=this._getRowGroupRowsEl(a,1),d=this._getRowGroupEl(a,2);a=this._getRowGroupRowsEl(a,2);c&&(c.style.display="");a&&(a.style.display="");b&&mini.removeClass(b,"mini-grid-group-collapse");d&&mini.removeClass(d,"mini-grid-group-collapse");this.doLayout()}},showAllRowDetail:function(){this._allowLayout=!1;for(var a=this.getDataView(),b=0,c=a.length;b<c;b++)this.showRowDetail(a[b]);this._allowLayout=!0;this.doLayout()},hideAllRowDetail:function(){this._allowLayout=!1;for(var a=this.getDataView(),b=0,c=a.length;b<c;b++)this.hideRowDetail(a[b]);this._allowLayout=!0;this.doLayout()},isShowRowDetail:function(a){return(a="object"==typeof a?a:this.getRow(a))?!!a._showDetail:!1},toggleRowDetail:function(a){(a=this.getRow(a))&&(grid.isShowRowDetail(a)?grid.hideRowDetail(a):grid.showRowDetail(a))},showRowDetail:function(a){if((a=this.getRow(a))&&1!=a._showDetail){a._showDetail=!0;var b=this._getRowDetailEl(a,1,!0),c=this._getRowDetailEl(a,2,!0);b&&(b.style.display="");c&&(c.style.display="");b=this._getRowEl(a,1);c=this._getRowEl(a,2);b&&mini.addClass(b,"mini-grid-expandRow");c&&mini.addClass(c,"mini-grid-expandRow");this.fire("showrowdetail",{record:a});var d=this;this.isFrozen()&&setTimeout(function(){d.syncRowDetail(a)},1);this.doLayout()}},hideRowDetail:function(a){if((a=this.getRow(a))&&!0===a._showDetail){a._showDetail=!1;var b=this._getRowDetailEl(a,1),c=this._getRowDetailEl(a,2);b&&(b.style.display="none");c&&(c.style.display="none");b=this._getRowEl(a,1);c=this._getRowEl(a,2);b&&mini.removeClass(b,"mini-grid-expandRow");c&&mini.removeClass(c,"mini-grid-expandRow");this.fire("hiderowdetail",{record:a});this.doLayout()}},_getRowDetailEl:function(a,b,c){a=this.getRow(a);if(!a)return null;var d=this._createRowDetailId(a,b);(d=document.getElementById(d))||!0!==c||(d=this._createRowDetail(a,b));return d},_createRowDetail:function(a,b){var c=this.getFrozenColumns(),d=this.getUnFrozenColumns(),c=c.length;2==b&&(c=d.length);d=this._getRowEl(a,b);if(!d)return null;var e=this._createRowDetailId(a,b),c='\x3ctr id\x3d"'+e+'" class\x3d"mini-grid-detailRow"\x3e\x3ctd style\x3d"width:0"\x3e\x3c/td\x3e\x3ctd class\x3d"mini-grid-detailCell" colspan\x3d"'+c+'"\x3e\x3c/td\x3e\x3c/tr\x3e';jQuery(d).after(c);return document.getElementById(e)},_createRowDetailId:function(a,b){return this._id+"$detail"+b+"$"+a._id},getRowDetailCellEl:function(a,b){b||(b=2);var c=this._getRowDetailEl(a,b);if(c)return c.cells[1]},autoHideRowDetail:!0,setAutoHideRowDetail:function(a){this.autoHideRowDetail=a},getAutoHideRowDetail:function(){return this.autoHideRowDetail},mergeColumns:function(a){a&&0==mini.isArray(a)&&(a=[a]);var b=this.getVisibleColumns();a||(a=b);var c=this.getDataView();c.push({});for(var d=[],e=0,f=a.length;e<f;e++){var g=a[e];if(g=this.getColumn(g)){if(g.field){for(var k=[],l=-1,n=1,p=b.indexOf(g),q=null,r=0,t=c.length;r<t;r++){var u=mini._getMap(g.field,c[r]);-1!=l&&mini.isEquals(u,q)?n++:(1<n&&k.push({rowIndex:l,columnIndex:p,rowSpan:n,colSpan:1}),l=r,n=1,q=u)}g=k}else g=void 0;d.addRange(g)}}this.mergeCells(d)},mergeCells:function(a){if(mini.isArray(a)){this._mergedCells=a;var b=this._mergedCellMaps={};if(a=this._mergedCells)for(var c=0,d=a.length;c<d;c++){var e=a[c];e.rowSpan||(e.rowSpan=1);e.colSpan||(e.colSpan=1);for(var f=e.rowIndex,g=e.columnIndex,k=e.colSpan,l=e,n=f,e=f+e.rowSpan;n<e;n++)for(var p=g,q=g+k;p<q;p++)b[n+":"+p]=n==f&&p==g?l:!0}this.doUpdate()}},margeCells:function(a){this.mergeCells(a)},_isCellVisible:function(a,b){return this._mergedCellMaps?!0!==this._mergedCellMaps[a+":"+b]:!0},_getAnchorCell:function(a,b){if(!this._mergedCellMaps)return null;var c=this.indexOf(a),d=this.getBottomColumns().indexOf(b);return this._mergedCellMaps[c+":"+d]},_getCellEls:function(a,b,c,d){var e=[];if(!mini.isNumber(a)||!mini.isNumber(b))return[];this.getVisibleColumns();this.getDataView();var f=a;for(a+=c;f<a;f++){c=b;for(var g=b+d;c<g;c++){var k=this._getCellEl(f,c);k&&e.push(k)}}return e},_getDragData:function(){var a=this.getSelecteds().clone(),b=this;mini.sort(a,function(a,d){var c=b.indexOf(a),f=b.indexOf(d);return c>f?1:c<f?-1:0},this);return a},_getDragText:function(a){return"Records "+a.length},allowDrag:!1,allowDrop:!1,allowLeafDropIn:!1,setAllowLeafDropIn:function(a){this.allowLeafDropIn=a},getAllowLeafDropIn:function(){return this.allowLeafDropIn},setAllowDrag:function(a){this.allowDrag=a},getAllowDrag:function(){return this.allowDrag},setAllowDrop:function(a){this.allowDrop=a},getAllowDrop:function(){return this.allowDrop},isAllowDrag:function(a,b){return!this.isReadOnly()&&0!=this.enabled&&this.allowDrag&&b.allowDrag&&!1!==a.allowDrag?!0:!1},_OnDragStart:function(a,b){var c={node:a,nodes:this._getDragData(),column:b,cancel:!1};c.record=c.node;c.records=c.nodes;c.dragText=this._getDragText(c.nodes);this.fire("dragstart",c);return c},_OnGiveFeedback:function(a,b,c,d){var e={};e.from=d;e.effect=a;e.nodes=b;e.node=e.nodes[0];e.targetNode=c;e.dragNodes=b;e.dragNode=e.dragNodes[0];e.dropNode=e.targetNode;e.dragAction=e.action;this.fire("givefeedback",e);return e},_OnDragDrop:function(a,b,c){a=a.clone();a={dragNodes:a,targetNode:b,action:c,cancel:!1};a.dragNode=a.dragNodes[0];a.dropNode=a.targetNode;a.dragAction=a.action;this.fire("beforedrop",a);this.fire("dragdrop",a);return a},moveUp:function(a){if(mini.isArray(a)){var b=this;a=a.sort(function(a,c){var d=b.indexOf(a),e=b.indexOf(c);return d>e?1:-1});for(var c=0,d=a.length;c<d;c++){var e=a[c],f=this.indexOf(e);this.moveRow(e,f-1)}}},moveDown:function(a){if(mini.isArray(a)){var b=this;a=a.sort(function(a,c){var d=b.indexOf(a),e=b.indexOf(c);return d>e?1:-1});a.reverse();for(var c=0,d=a.length;c<d;c++){var e=a[c],f=this.indexOf(e);this.moveRow(e,f+2)}}},pageSize:20,pageIndex:0,totalCount:0,totalPage:0,sortField:"",sortOrder:"",url:"",setAjaxAsync:function(a){this.ajaxAsync=this._dataSource.ajaxAsync=a},getAjaxAsync:function(){return this._dataSource.ajaxAsync},setAjaxMethod:function(a){this.ajaxMethod=this._dataSource.ajaxMethod=a},getAjaxMethod:function(){return this._dataSource.ajaxMethod},setAjaxType:function(a){this.ajaxType=this._dataSource.ajaxType=a},getAjaxType:function(){return this._dataSource.ajaxType},setAjaxOptions:function(a){this._dataSource.setAjaxOptions(a)},getAjaxOptions:function(){return this._dataSource.getAjaxOptions()},setAutoLoad:function(a){this._dataSource.setAutoLoad(a)},getAutoLoad:function(){return this._dataSource.getAutoLoad()},setUrl:function(a){this._dataSource.setUrl(a);this.url=a},getUrl:function(){return this._dataSource.getUrl()},load:function(a,b,c,d){this._dataSource.load(a,b,c,d)},reload:function(a,b,c){this.accept();this._dataSource.reload(a,b,c)},gotoPage:function(a,b){this._dataSource.gotoPage(a,b)},sortBy:function(a,b){if(!a)return null;var c=this._dataSource;this.sortField=c.sortField=a;this.sortOrder=c.sortOrder=b;"server"==this._dataSource.sortMode?this._dataSource.sortBy(a,b):(c=this._columnModel._getDataTypeByField(a),this._dataSource._doClientSortField(a,b,c))},sortDblClick:!1,setSortDblClick:function(a){this.sortDblClick=a},getSortDblClick:function(){return this.sortDblClick},showCellTip:!0,setShowCellTip:function(a){this.showCellTip=a},getShowCellTip:function(){return this.showCellTip},setCheckSelectOnLoad:function(a){this._dataSource.setCheckSelectOnLoad(a);this.checkSelectOnLoad=a},getCheckSelectOnLoad:function(){return this._dataSource.getCheckSelectOnLoad()},setSelectOnLoad:function(a){this._dataSource.setSelectOnLoad(a);this.selectOnLoad=a},getSelectOnLoad:function(){return this._dataSource.getSelectOnLoad()},allowCancelSort:!1,setAllowCancelSort:function(a){this.allowCancelSort=a},getAllowCancelSort:function(){return this.allowCancelSort},setSortMode:function(a){this._dataSource.setSortMode(a);this.sortMode=a},getSortMode:function(){return this._dataSource.getSortMode()},setPageIndex:function(a){this._dataSource.setPageIndex(a);this.pageIndex=a},getPageIndex:function(){return this._dataSource.getPageIndex()},setPageSize:function(a){this._dataSource.setPageSize(a);this.pageSize=this._virtualRows=a},getPageSize:function(){return this._dataSource.getPageSize()},setTotalCount:function(a){this._dataSource.setTotalCount(a);this.totalCount=a},getTotalCount:function(){return this._dataSource.getTotalCount()},getTotalPage:function(){return this._dataSource.getTotalPage()},setSortField:function(a){this._dataSource.setSortField(a);this.sortField=a},getSortField:function(){return this._dataSource.sortField},setSortOrder:function(a){this._dataSource.setSortOrder(a);this.sortOrder=a},getSortOrder:function(){return this._dataSource.sortOrder},setPageIndexField:function(a){this.pageIndexField=this._dataSource.pageIndexField=a},getPageIndexField:function(){return this._dataSource.pageIndexField},setPageSizeField:function(a){this.pageSizeField=this._dataSource.pageSizeField=a},getPageSizeField:function(){return this._dataSource.pageSizeField},setStartField:function(a){this.startField=this._dataSource.startField=a},getStartField:function(){return this._dataSource.startField},setLimitField:function(a){this.limitField=this._dataSource.limitField=a},getLimitField:function(){return this._dataSource.limitField},setSortFieldField:function(a){this.sortFieldField=this._dataSource.sortFieldField=a},getSortFieldField:function(){return this._dataSource.sortFieldField},setSortOrderField:function(a){this.sortOrderField=this._dataSource.sortOrderField=a},getSortOrderField:function(){return this._dataSource.sortOrderField},setTotalField:function(a){this.totalField=this._dataSource.totalField=a},getTotalField:function(){return this._dataSource.totalField},setDataField:function(a){this.dataField=this._dataSource.dataField=a},getDataField:function(){return this._dataSource.dataField},setErrorField:function(a){this.errorField=this._dataSource.errorField=a},getErrorField:function(){return this._dataSource.errorField},setErrorMsgField:function(a){this.errorMsgField=this._dataSource.errorMsgField=a},getErrorMsgField:function(){return this._dataSource.errorMsgField},setStackTraceField:function(a){this.stackTraceField=this._dataSource.stackTraceField=a},getStackTraceField:function(){return this._dataSource.stackTraceField},setPageSizeWidth:function(a){this._bottomPager.setPageSizeWidth(a)},getPageSizeWidth:function(){return this._bottomPager.getPageSizeWidth()},getBottomPager:function(){return this._bottomPager},sizeText:"",setSizeText:function(a){this._bottomPager.sizeText=a},getSizeText:function(){return this.sizeText},showPagerButtonText:!1,setShowPagerButtonText:function(a){this._bottomPager.setShowButtonText(a)},getShowPagerButtonText:function(){return this.showPagerButtonText},showPagerButtonIcon:!1,setShowPagerButtonIcon:function(a){this._bottomPager.setShowButtonIcon(a)},getShowPagerButtonIcon:function(){return this.showPagerButtonIcon},setShowReloadButton:function(a){this._bottomPager.setShowReloadButton(a)},getShowReloadButton:function(){return this._bottomPager.getShowReloadButton()},setShowPageInfo:function(a){this._bottomPager.setShowPageInfo(a)},getShowPageInfo:function(){return this._bottomPager.getShowPageInfo()},setSizeList:function(a){mini.isArray(a)&&this._bottomPager.setSizeList(a)},getSizeList:function(){return this._bottomPager.getSizeList()},setShowPageSize:function(a){this._bottomPager.setShowPageSize(a)},getShowPageSize:function(){return this._bottomPager.getShowPageSize()},setShowPageIndex:function(a){this.showPageIndex=a;this._bottomPager.setShowPageIndex(a)},getShowPageIndex:function(){return this._bottomPager.getShowPageIndex()},setShowTotalCount:function(a){this._bottomPager.setShowTotalCount(a)},getShowTotalCount:function(){return this._bottomPager.getShowTotalCount()},setPagerStyle:function(a){this.pagerStyle=a;mini.setStyle(this._bottomPager.el,a)},setPagerCls:function(a){this.pagerCls=a;mini.addClass(this._bottomPager.el,a)},setDropAction:function(a){this.dropAction=a},getDropAction:function(){return this.dropAction},groupTitleCollapsible:!0,setGroupTitleCollapsible:function(a){this.groupTitleCollapsible=a},getGroupTitleCollapsible:function(){return this.groupTitleCollapsible},allowEmptyContextMenu:!1,setAllowEmptyContextMenu:function(a){this.allowEmptyContextMenu=a},getAllowEmptyContextMenu:function(){return this.allowEmptyContextMenu},_beforeOpenContentMenu:function(a,b){mini.isAncestor(this._bodyEl,b.htmlEvent.target)?a.fire("BeforeOpen",b):b.cancel=!0},__OnHtmlContextMenu:function(a){var b={popupEl:this.el,htmlEvent:a,cancel:!1};if(mini.isAncestor(this._columnsEl,a.target)){if(this.headerContextMenu){this.headerContextMenu.fire("BeforeOpen",b);if(1==b.cancel)return;this.headerContextMenu.fire("opening",b);if(1==b.cancel)return;this.headerContextMenu.showAtPos(a.pageX,a.pageY);this.headerContextMenu.fire("Open",b)}}else{var c=mini.findParent(a.target,"mini-grid-detailRow");if(c&&mini.isAncestor(this.el,c)||!mini.findParent(a.target,"mini-tree-nodeshow")&&"tree"==this.type&&!this.allowEmptyContextMenu||!this.allowEmptyContextMenu&&!mini.findParent(a.target,"mini-grid-table")||mini.findParent(a.target,"mini-grid-filterRow")||mini.findParent(a.target,"mini-grid-summaryRow"))return;if(this.contextMenu){this._beforeOpenContentMenu(this.contextMenu,b);if(1==b.cancel)return;this.contextMenu.fire("opening",b);if(1==b.cancel)return;this.contextMenu.showAtPos(a.pageX,a.pageY);this.contextMenu.fire("Open",b)}}return!1},headerContextMenu:null,setHeaderContextMenu:function(a){(a=this._getContextMenu(a))&&this.headerContextMenu!==a&&(this.headerContextMenu=a,mini.addClass(a.el,"mini-menu-open"),this.headerContextMenu.owner=this,mini.on(this.el,"contextmenu",this.__OnHtmlContextMenu,this))},getHeaderContextMenu:function(){return this.headerContextMenu},selectOnRightClick:!0,setSelectOnRightClick:function(a){this.selectOnRightClick=a},getSelectOnRightClick:function(){return this.selectOnRightClick},_get_originals:function(){return this._dataSource._originals},_set_originals:function(a){this._dataSource._originals=a},_set_clearOriginals:function(a){this._dataSource._clearOriginals=a},_set_originalIdField:function(a){this._dataSource._originalIdField=a},_set_autoCreateNewID:function(a){this._dataSource._autoCreateNewID=a},getAttrs:function(a){for(var b=mini.DataGrid.superclass.getAttrs.call(this,a),c=mini.getChildNodes(a),d=0,e=c.length;d<e;d++){var f=c[d],g=mini.getAttr(f,"property");g&&(g=g.toLowerCase(),"columns"==g?(b.columns=mini._ParseColumns(f),mini.removeNode(f)):"data"==g&&(b.data=f.innerHTML,mini.removeNode(f)))}mini._ParseString(a,b,"oncelleditenter onselect ondeselect onbeforeselect onbeforedeselect url sizeList bodyCls bodyStyle footerCls footerStyle pagerCls pagerStyle onheadercellclick onheadercellmousedown onheadercellcontextmenu onrowdblclick onrowclick onrowmousedown onrowcontextmenu onrowmouseenter onrowmouseleave oncellclick oncellmousedown oncellcontextmenu oncelldblclick onbeforeload onpreload onloaderror onload onupdate ondrawcell oncellbeginedit onselectionchanged ondrawgroup onbeforeshowrowdetail onbeforehiderowdetail onshowrowdetail onhiderowdetail idField valueField pager oncellcommitedit oncellendedit headerContextMenu loadingMsg emptyText cellEditAction sortMode oncellvalidation onsort ondrawsummarycell ondrawgroupsummarycell onresize oncolumnschanged ajaxMethod ajaxOptions onaddrow onupdaterow onremoverow onmoverow onbeforeaddrow onbeforeupdaterow onbeforeremoverow onbeforemoverow pageIndexField pageSizeField sortFieldField sortOrderField startField limitField totalField dataField sortField sortOrder stackTraceField errorField errorMsgField pagerButtons onbeforegroupclick dropAction sizeText pagerType viewType itemRenderer summaryPosition".split(" "));mini._ParseBool(a,b,"showColumns showFilterRow showSummaryRow showPager showFooter enableGroupOrder validateOnAdd showHGridLines showVGridLines showSortIcon allowSortColumn allowMoveColumn allowResizeColumn fitColumns showLoading multiSelect allowAlternating resultAsData allowRowSelect allowUnselect onlyCheckSelection allowHotTrackOut enableHotTrack showPageIndex showPageSize showTotalCount checkSelectOnLoad allowResize autoLoad autoHideRowDetail allowCellSelect allowCellEdit allowCellWrap allowHeaderWrap selectOnLoad virtualScroll virtualColumns collapseGroupOnLoad showGroupSummary showEmptyText alwaysShowEmptyText allowCellValid showModified showColumnsMenu showPageInfo showReloadButton showNewRow editNextOnEnterKey createOnEnter skipReadOnlyCell ajaxAsync allowDrag allowDrop allowLeafDropIn editNextRowCell fixedRowHeight showCellTip showPagerButtonText showPagerButtonIcon groupTitleCollapsible navEditMode selectOnRightClick sortDblClick allowEmptyContextMenu showGroupSummary allowCancelSort".split(" "));mini._ParseInt(a,b,"frozenStartColumn frozenEndColumn pageSizeWidth pageIndex pageSize defaultRowHeight defaultColumnWidth wheelIncrement summaryRows".split(" "));"string"==typeof b.ajaxOptions&&(b.ajaxOptions=window.eval("("+b.ajaxOptions+")"));"string"==typeof b.sizeList&&(b.sizeList=window.eval("("+b.sizeList+")"));!b.idField&&b.valueField&&(b.idField=b.valueField);b.pagerButtons&&(b.pagerButtons=mini.byId(b.pagerButtons));b.itemRenderer&&(b.itemRenderer=window[b.itemRenderer]);return b}});mini.regClass(mini.DataGrid,"datagrid");mini_DataGrid_CellValidator_Prototype={getCellErrors:function(){for(var a=this._cellErrors.clone(),b=this._dataSource,c=0,d=a.length;c<d;c++){var e=a[c],f=e.record;b.getby_id(f._id)||(delete this._cellMapErrors[f[this._rowIdField]+"$"+e.column._id],this._cellErrors.remove(e))}return this._cellErrors},getCellError:function(a,b){a=this.getNode?this.getNode(a):this.getRow(a);b=this.getColumn(b);if(a&&b){var c=a[this._rowIdField]+"$"+b._id;return this._cellMapErrors?this._cellMapErrors[c]:null}},isValid:function(){return 0==this.getCellErrors().length},isCellValid:function(a,b){return this._cellMapErrors?!this._cellMapErrors[a[this._rowIdField]+"$"+b._id]:!0},validate:function(a){a=a||this.getDataView();mini.isArray(a)||(a=[]);for(var b=0,c=a.length;b<c;b++)this.validateRow(a[b])},validateRow:function(a){for(var b=this.getBottomColumns(),c=0,d=b.length;c<d;c++)this.validateCell(a,b[c])},validateCell:function(a,b){a=this.getNode?this.getNode(a):this.getRow(a);b=this.getColumn(b);if(a&&b&&0!=b.visible){var c=mini._getMap(b.field,a),c={record:a,row:a,node:a,column:b,field:b.field,value:c,isValid:!0,errorText:""};b.vtype&&mini._ValidateVType(b.vtype,c.value,c,b);if(1==c.isValid&&b.unique&&b.field)for(var d={},e=this.data,f=b.field,g=0,k=e.length;g<k;g++){var l=e[g],n=l[f];if(!mini.isNull(n)&&""!==String(n).trim()){var p=d[n];if(p&&l==a){c.isValid=!1;c.errorText=mini._getErrorText(b,"uniqueErrorText");this.setCellIsValid(p,b,c.isValid,c.errorText);break}d[n]=l}}this.fire("cellvalidation",c);this.setCellIsValid(a,b,c.isValid,c.errorText)}},setIsValid:function(a){if(a){a=this._cellErrors.clone();for(var b=0,c=a.length;b<c;b++){var d=a[b];this.setCellIsValid(d.record,d.column,!0)}}},_removeRowError:function(a){for(var b=this.getColumns(),c=0,d=b.length;c<d;c++){var e=a[this._rowIdField]+"$"+b[c]._id,f=this._cellMapErrors[e];f&&(delete this._cellMapErrors[e],this._cellErrors.remove(f))}},setCellIsValid:function(a,b,c,d){a=this.getRow(a);b=this.getColumn(b);if(a&&b){var e=a[this._rowIdField]+"$"+b._id,f=this._getCellEl(a,b),g=this._cellMapErrors[e];delete this._cellMapErrors[e];this._cellErrors.remove(g);!0===c?f&&g&&mini.removeClass(f,"mini-grid-cell-error"):(g={record:a,column:b,isValid:c,errorText:d},this._cellMapErrors[e]=g,this._cellErrors.add(g),f&&mini.addClass(f,"mini-grid-cell-error"))}}};mini.copyTo(mini.DataGrid.prototype,mini_DataGrid_CellValidator_Prototype);mini.TreeGrid=function(){mini.TreeGrid.superclass.constructor.apply(this,arguments);mini.addClass(this.el,"mini-tree");this.setAjaxAsync(!1);this.setAutoLoad(!0);1==this.showTreeLines&&mini.addClass(this.el,"mini-tree-treeLine");this._AsyncLoader=new mini._Tree_AsyncLoader(this);this._Expander=new mini._Tree_Expander(this);this.setShowArrow(this.showArrow)};mini.copyTo(mini.TreeGrid.prototype,mini._DataTreeApplys);mini.extend(mini.TreeGrid,mini.DataGrid,{isTree:!0,uiCls:"mini-treegrid",showPager:!1,showNewRow:!1,showCheckBox:!1,showRadioButton:!1,showTreeIcon:!0,showExpandButtons:!0,showTreeLines:!1,showArrow:!1,expandOnDblClick:!0,expandOnNodeClick:!1,loadOnExpand:!0,_checkBoxType:"checkbox",iconField:"iconCls",_treeColumn:null,leafIconCls:"mini-tree-leaf",folderIconCls:"mini-tree-folder",fixedRowHeight:!1,_checkBoxCls:"mini-tree-checkbox",_expandNodeCls:"mini-tree-expand",_collapseNodeCls:"mini-tree-collapse",_eciconCls:"mini-tree-node-ecicon",_inNodeCls:"mini-tree-nodeshow",isEditingNode:function(a){return this._editingNode==a},indexOf:function(a){return this._dataSource.indexOfList(a)},_getDragText:function(a){return"Nodes "+a.length},_initEvents:function(){mini.TreeGrid.superclass._initEvents.call(this);this.on("nodedblclick",this.__OnNodeDblClick,this);this.on("nodeclick",this.__OnNodeClick,this);this.on("cellclick",function(a){a.node=a.record;a.isLeaf=this.isLeaf(a.node);this.fire("nodeclick",a)},this);this.on("cellmousedown",function(a){a.node=a.record;a.isLeaf=this.isLeaf(a.node);this.fire("nodemousedown",a)},this);this.on("celldblclick",function(a){a.node=a.record;a.isLeaf=this.isLeaf(a.node);this.fire("nodedblclick",a)},this);this.on("beforerowselect",function(a){a.node=a.selected;a.isLeaf=this.isLeaf(a.node);this.fire("beforenodeselect",a)},this);this.on("rowselect",function(a){a.node=a.selected;a.isLeaf=this.isLeaf(a.node);this.fire("nodeselect",a)},this)},setValue:function(a,b){mini.isNull(a)&&(a="");a=String(a);if(this.getValue()!=a){var c=this.getCheckedNodes();this.uncheckNodes(c,this.checkRecursive);this.value=a;this.showCheckBox?(c=String(a).split(","),this._dataSource.doCheckNodes(c,!0,!1!==b)):this.selectNode(a,!1)}},getValue:function(a){return this.showCheckBox?(!1===a&&(a="leaf"),this._dataSource.getCheckedNodesId(a)):this._dataSource.getSelectedsId()},getText:function(){var a=[];if(this.showCheckBox)a=this.getCheckedNodes();else{var b=this.getSelectedNode();b&&a.push(b)}for(var c=[],d=this.getTextField(),e=0,f=a.length;e<f;e++)b=a[e],c.push(b[d]);return c.join(",")},isGrouping:function(){return!1},_createSource:function(){this._dataSource=new mini.DataTree},_bindSource:function(){mini.TreeGrid.superclass._bindSource.call(this);var a=this._dataSource;a.on("expand",this.__OnTreeExpand,this);a.on("collapse",this.__OnTreeCollapse,this);a.on("_checkchanged",this.__OnCheckChanged,this);a.on("addnode",this.__OnSourceAddNode,this);a.on("removenode",this.__OnSourceRemoveNode,this);a.on("movenode",this.__OnSourceMoveNode,this);a.on("beforeloadnode",this.__OnBeforeLoadNode,this);a.on("loadnode",this.__OnLoadNode,this)},__OnBeforeLoadNode:function(a){this.__showLoading=this.showLoading;this.showLoading=!1;this.addNodeCls(a.node,"mini-tree-loading");this.fire("beforeloadnode",a)},__OnLoadNode:function(a){this.showLoading=this.__showLoading;this.removeNodeCls(a.node,"mini-tree-loading");this.fire("loadnode",a)},_virtualUpdate:function(){var a=this;a._updateNodeTimer&&(clearTimeout(a._updateNodeTimer),a._updateNodeTimer=null);a._updateNodeTimer=setTimeout(function(){a._updateNodeTimer=null;a.doUpdateRows();a.deferLayout(50)},5)},__OnSourceAddNode:function(a){var b=this._dataSource.isVisibleNode(a.node);1==this.isVirtualScroll()?this._virtualUpdate():b?this._doAddNodeEl(a.node):(b=this.getParentNode(a.node),this._dataSource.isVisibleNode(b)&&this._doUpdateTreeNodeEl(b));this.fire("addnode",a)},__OnSourceRemoveNode:function(a){if(1==this.isVirtualScroll())this._virtualUpdate();else{this._doRemoveNodeEl(a.node);var b=this.getParentNode(a.node),c=this.getChildNodes(b);0==c.length?this._doUpdateTreeNodeEl(b):(b=a.index,1<b&&b==c.length&&this._doUpdateTreeNodeEl(c[c.length-1]))}this.fire("removenode",a)},__OnSourceMoveNode:function(a){this._doMoveNodeEl(a.node);this.fire("movenode",a);var b=a.oldParentNode;b!=a.parentNode&&(a=this.getChildNodes(b))&&(a=a[a.length-1])&&this._doUpdateTreeNodeEl(a)},_doAddNodeEl:function(a){function b(a,b,c){b=this._createRowHTML(a,f,b,c);a=this.indexOfNode(a)+1;(a=this.getChildNodeAt(a,e))?(c=this._getNodeEl(a,c),jQuery(c).before(b)):(c=this._getNodesEl(e,c))?mini.append(c.firstChild,b):g=!0}var c=this.getFrozenColumns(),d=this.getUnFrozenColumns(),e=this.getParentNode(a),f=this.indexOf(a),g=!1;b.call(this,a,d,2);b.call(this,a,c,1);g&&this._doUpdateTreeNodeEl(e)},_doRemoveNodeEl:function(a){this._doRemoveRowEl(a);var b=this._getNodesEl(a,1);a=this._getNodesEl(a,2);b&&b.parentNode.removeChild(b);a&&a.parentNode.removeChild(a)},_doMoveNodeEl:function(a){1==this.isVirtualScroll()?this._virtualUpdate():(this._doRemoveNodeEl(a),a=this.getParentNode(a),this._doUpdateTreeNodeEl(a))},_doUpdateNodeTitle:function(a){this._doUpdateTreeNodeEl(a,!1)},_doUpdateTreeNodeEl:function(a,b){b=!1!==b;if(this.getRootNode()==a)this.doUpdate();else if(this.isVisibleNode(a)){var c=a,d=this.getFrozenColumns(),e=this.getUnFrozenColumns(),f=this._createNodeHTML(a,d,1,null,b),e=this._createNodeHTML(a,e,2,null,b),d=this._getNodeEl(a,1),g=this._getNodeEl(a,2),k=this._getNodesTr(a,1),l=this._getNodesTr(a,2),n=this._getRowDetailEl(a,1),p=this._getRowDetailEl(a,2),f=mini.createElements(f);a=f[0];f=f[1];d&&(mini.before(d,a),b&&(n?mini.after(n,f):mini.before(d,f)),mini.removeNode(d),b&&mini.removeNode(k));f=mini.createElements(e);a=f[0];f=f[1];g&&(mini.before(g,a),b&&(p?mini.after(p,f):mini.before(g,f)),mini.removeNode(g),b&&mini.removeNode(l));1==a.checked||this.isLeaf(a)||this._doCheckNodeEl(c)}},addNodeCls:function(a,b){this.addRowCls(a,b)},removeNodeCls:function(a,b){this.removeRowCls(a,b)},doUpdate:function(){mini.TreeGrid.superclass.doUpdate.apply(this,arguments)},setData:function(a){a||(a=[]);this._dataSource.setData(a)},loadList:function(a,b,c){b=b||this.getIdField();c=c||this.getParentField();a=mini.listToTree(a,this.getNodesField(),b,c);this.setData(a)},_createDrawCellEvent:function(a,b,c,d){c=mini.TreeGrid.superclass._createDrawCellEvent.call(this,a,b,c,d);c.node=c.record;c.isLeaf=this.isLeaf(c.node);this._treeColumn&&this._treeColumn==b.name&&(c.isTreeCell=!0,c.img=a[this.imgField],c.iconCls=this._getNodeIcon(a),c.nodeCls="",c.nodeStyle="",c.nodeHtml="",c.showTreeIcon=this.showTreeIcon,c.checkBoxType=this._checkBoxType,c.showCheckBox=this.showCheckBox,c.showRadioButton=this.showRadioButton,c.showCheckBox&&!c.isLeaf&&(c.showCheckBox=this.showFolderCheckBox),c.showRadioButton&&!c.isLeaf&&(c.showRadioButton=this.showFolderCheckBox),c.enabled=!1!==c.node.enabled,c.checkable=this.getCheckable(c.node));return c},_OnDrawCell:function(a,b,c,d){a=mini.TreeGrid.superclass._OnDrawCell.call(this,a,b,c,d);this._treeColumn&&this._treeColumn==b.name&&(this.fire("drawnode",a),a.nodeStyle&&(a.cellStyle=a.nodeStyle),a.nodeCls&&(a.cellCls=a.nodeCls),a.nodeHtml&&(a.cellHtml=a.nodeHtml),this._createTreeColumn(a));return a},_isViewFirstNode:function(a){if(this._viewNodes){var b=this.getParentNode(a);return this._getViewChildNodes(b)[0]===a}return this.isFirstNode(a)},_isViewLastNode:function(a){if(this._viewNodes){var b=this.getParentNode(a),b=this._getViewChildNodes(b);return b[b.length-1]===a}return this.isLastNode(a)},_isInViewLastNode:function(a,b){if(this._viewNodes){for(var c=null,d=this.getAncestors(a),e=0,f=d.length;e<f;e++){var g=d[e];this.getLevel(g)==b&&(c=g)}return c&&c!=this.root?this._isViewLastNode(c):!1}return this.isInLastNode(a,b)},isInLastNode:function(a,b){for(var c=null,d=this.getAncestors(a),e=0,f=d.length;e<f;e++){var g=d[e];this.getLevel(g)==b&&(c=g)}return c&&c!=this.root?this.isLastNode(c):!1},_createNodeTitle:function(a,b,c){var d=!b;b||(b=[]);var e=this.isLeaf(a),f=this.getLevel(a),g=c.nodeCls;e||(g=this.isExpandedNode(a)?this._expandNodeCls:this._collapseNodeCls);!1===a.enabled&&(g+=" mini-disabled");e||(g+=" mini-tree-parentNode");this.getChildNodes(a);b[b.length]='\x3cdiv class\x3d"mini-tree-nodetitle '+g+'" \x3e';for(var g=this.getParentNode(a),k=0;k<=f;k++)if(k!=f&&!(e&&k>f-1)){var l="";this._isInViewLastNode(a,k)&&(l="background:none");b[b.length]='\x3cspan class\x3d"mini-tree-indent " style\x3d"'+l+'"\x3e\x3c/span\x3e'}k="";this._isViewFirstNode(a)&&0==f?k="mini-tree-node-ecicon-first":this._isViewLastNode(a)&&(k="mini-tree-node-ecicon-last");this._isViewFirstNode(a)&&this._isViewLastNode(a)&&(k="mini-tree-node-ecicon-firstAndlast",g==this.root&&(k="mini-tree-node-ecicon-firstLast"));b[b.length]=e?'\x3cspan class\x3d"'+this._eciconCls+" "+k+'" style\x3d"'+(this.showExpandButtons?"":"display:none")+'"\x3e\x3c/span\x3e':'\x3ca class\x3d"'+this._eciconCls+" "+k+'" style\x3d"'+(this.showExpandButtons?"":"display:none")+'" '+(mini.isChrome?"":'href\x3d"javascript:void(0);"')+' onclick\x3d"return false;" hidefocus\x3e\x3c/a\x3e';b[b.length]='\x3cspan class\x3d"mini-tree-nodeshow mini-corner-all"\x3e';c.showTreeIcon&&(b[b.length]=c.img?'\x3cspan class\x3d"mini-tree-icon mini-icon mini-iconfont" style\x3d"background-image:url('+(this.imgPath+c.img)+');"\x3e\x3c/span\x3e':'\x3cspan class\x3d"'+c.iconCls+' mini-tree-icon mini-icon mini-iconfont"\x3e\x3c/span\x3e');c.showRadioButton&&!c.showCheckBox&&(b[b.length]='\x3cspan class\x3d"mini-tree-radio mini-icon" \x3e\x3c/span\x3e');c.showCheckBox&&(e=this._createCheckNodeId(a),f=this.isCheckedNode(a),b[b.length]='\x3cspan id\x3d"'+e+'" class\x3d"mini-icon '+this._checkBoxCls+" "+(f?"mini-tree-checkbox-checked":"")+'"\x3e\x3c/span\x3e');b[b.length]='\x3cspan class\x3d"mini-tree-nodetext"\x3e';b[b.length]=this._editingNode==a?'\x3cinput id\x3d"'+(this._id+"$edit$"+a._id)+'" type\x3d"text" class\x3d"mini-tree-editinput" value\x3d"'+c.value+'"/\x3e':c.cellHtml;b[b.length]="\x3c/span\x3e";b[b.length]="\x3c/span\x3e";b[b.length]="\x3c/div\x3e";if(d)return b.join("")},_createCheckNodeId:function(a){return this._id+"$checkbox$"+a._id},_createTreeColumn:function(a){var b=a.record;a.headerCls+=" mini-tree-treecolumn";a.cellCls+=" mini-tree-treecell";a.cellStyle+=";padding:0;";var c=this.isLeaf(b);a.cellHtml=this._createNodeTitle(b,null,a);1==b.checked||c||a.showCheckBox&&this._renderCheckState(b)},_renderCheckState:function(a){this._renderCheckStateNodes||(this._renderCheckStateNodes=[]);this._renderCheckStateNodes.push(a);if(!this._renderCheckStateTimer){var b=this;this._renderCheckStateTimer=setTimeout(function(){b._renderCheckStateTimer=null;var a=b._renderCheckStateNodes;b._renderCheckStateNodes=null;for(var d=0,e=a.length;d<e;d++)b._doCheckNodeEl(a[d])},1)}},_createNodeHTML:function(a,b,c,d,e){var f=!d;d||(d=[]);var g=this._dataSource,k=g.getDataView().indexOf(a);this._createRowHTML(a,k,b,c,d);!1!==e&&(e=g.getChildNodes(a),g=this.isVisibleNode(a),e&&0<e.length&&(k=this.isExpandedNode(a),1==k&&(g=k&&g?"":"display:none",a=this._createNodesId(a,c),d[d.length]='\x3ctr class\x3d"mini-tree-nodes-tr" style\x3d"',mini.isIE&&(d[d.length]=g),d[d.length]='" \x3e\x3ctd class\x3d"mini-tree-nodes-td" colspan\x3d"',d[d.length]=b.length+1,d[d.length]='" \x3e',d[d.length]='\x3cdiv class\x3d"mini-tree-nodes" id\x3d"',d[d.length]=a,d[d.length]='" style\x3d"',d[d.length]=g,d[d.length]='"\x3e',this._createNodesHTML(e,b,c,d),d[d.length]="\x3c/div\x3e",d[d.length]="\x3c/td\x3e\x3c/tr\x3e")));if(f)return d.join("")},_createNodesHTML:function(a,b,c,d){if(!a)return"";var e=!d;d||(d=[]);d.push('\x3ctable class\x3d"mini-grid-table" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0"\x3e');d.push(this._createTopRowHTML(b,!0));if(0<b.length)for(var f=0,g=a.length;f<g;f++)this._createNodeHTML(a[f],b,c,d);d.push("\x3c/table\x3e");if(e)return d.join("")},_createRowsHTML:function(a,b){if(this.isVirtualScroll())return mini.TreeGrid.superclass._createRowsHTML.apply(this,arguments);var c=this._dataSource,d=[],e=[],f=c.getRootNode();!0!==this._useEmptyView&&(e=c.getChildNodes(f));(2==b?this._rowsViewEl.firstChild:this._rowsLockEl.firstChild).id=this._createNodesId(f,b);this._createNodesHTML(e,a,b,d);return d.join("")},_createNodesId:function(a,b){return this._id+"$nodes"+b+"$"+a._id},_getNodeEl:function(a,b){return this._getRowEl(a,b)},_getNodesEl:function(a,b){a=this.getNode(a);var c=this._createNodesId(a,b);return document.getElementById(c)},_getNodesTr:function(a,b){var c=this._getNodesEl(a,b);if(c)return c.parentNode.parentNode},checkOnTextClick:!1,setCheckOnTextClick:function(a){this.checkOnTextClick=a},getCheckOnTextClick:function(){return this.checkOnTextClick},setTreeColumn:function(a){this._treeColumn=a;this.deferUpdate()},getTreeColumn:function(){return this._treeColumn},setShowTreeIcon:function(a){this.showTreeIcon=a;this.deferUpdate()},getShowTreeIcon:function(){return this.showTreeIcon},setShowCheckBox:function(a){this.showCheckBox=a;this.deferUpdate()},getShowCheckBox:function(){return this.showCheckBox},setShowRadioButton:function(a){this.showRadioButton=a;this.deferUpdate()},getShowRadioButton:function(){return this.showRadioButton},setCheckBoxType:function(a){this._checkBoxType=a;this._doUpdateCheckState()},getCheckBoxType:function(){return this._checkBoxType},setIconsField:function(a){this._iconsField=a},getIconsField:function(){return this._iconsField},_getNodeIcon:function(a){var b=a[this.iconField];b||(b=this.isLeaf(a)?this.leafIconCls:this.folderIconCls);return b},_getCheckBoxEl:function(a){return 0==this.isVisibleNode(a)?null:mini.byId(this._id+"$checkbox$"+a._id,this.el)},useAnimation:!0,_updateNodeTimer:null,_doExpandCollapseNode:function(a){function b(){this._doUpdateTreeNodeEl(a);this.deferLayout(20)}var c=this;c._updateNodeTimer&&(clearTimeout(c._updateNodeTimer),c._updateNodeTimer=null);if(1==this.isVirtualScroll())this._updateTimer||(c._updateNodeTimer=setTimeout(function(){c._updateNodeTimer=null;c.doUpdateRows();c.deferLayout(50)},5));else if(mini.isIE6||!this.useAnimation||this.isFrozen())b.call(this);else{var d=function(a,b,c){var d=this._getNodesEl(a,b);if(d){mini.getHeight(d);var e=this;e._inAniming=!0;jQuery(d).animate({height:"0px"},180,function(){d.style.height="auto";e._inAniming=!1;c&&c.call(e);e.doLayout();mini.repaint(d)})}else c&&c.call(this)},e=function(a,b,c){var d=this._getNodesEl(a,b);if(d){a=mini.getHeight(d);d.style.overflow="hidden";d.style.height="0px";a={height:a+"px"};var e=this;e._inAniming=!0;jQuery(d).animate(a,250,function(){d.style.height="auto";e._inAniming=!1;e.doLayout();mini.repaint(d)})}},f=this.isExpandedNode(a),c=this;f?(b.call(this),e.call(this,a,2),e.call(this,a,1)):(d.call(this,a,2,b),d.call(this,a,1))}},__OnTreeCollapse:function(a){this._doExpandCollapseNode(a.node)},__OnTreeExpand:function(a){this._doExpandCollapseNode(a.node)},_doCheckNodeEl:function(a){var b=this._getCheckBoxEl(a);if(b){var c=this.getCheckModel();mini.removeClass(b,"mini-tree-checkbox-indeterminate");var d=a.indeterminate&&!a.checked;if("cascade"==c||d)"indeterminate"==(d?"indeterminate":this.getCheckState(a))?mini.addClass(b,"mini-tree-checkbox-indeterminate"):mini.removeClass(b,"mini-tree-checkbox-indeterminate");a.checked?mini.addClass(b,"mini-tree-checkbox-checked"):mini.removeClass(b,"mini-tree-checkbox-checked")}},__OnCheckChanged:function(a){for(var b=0,c=a._nodes.length;b<c;b++)this._doCheckNodeEl(a._nodes[b]);this._checkChangedTimer&&(clearTimeout(this._checkChangedTimer),this._checkChangedTimer=null);var d=this;this._checkChangedTimer=setTimeout(function(){d._checkChangedTimer=null;d.fire("_checkchanged")},1)},_tryToggleCheckNode:function(a){if(!1!==a.enabled&&0!=this.getCheckable(a)){var b=this.isCheckedNode(a),c={node:a,cancel:!1,checked:b,isLeaf:this.isLeaf(a)};this.fire("beforenodecheck",c);c.cancel||(this._dataSource.doCheckNodes(a,!b,!0),this.fire("nodecheck",c))}},_tryToggleNode:function(a){var b=this.isExpandedNode(a),c={node:a,cancel:!1};b?(this.fire("beforecollapse",c),1!=c.cancel&&(this.collapseNode(a),c.type="collapse",this.fire("collapse",c))):(this.fire("beforeexpand",c),1!=c.cancel&&(this.expandNode(a),c.type="expand",this.fire("expand",c)))},_OnCellMouseDown:function(a){mini.findParent(a.htmlEvent.target,this._eciconCls)||mini.findParent(a.htmlEvent.target,"mini-tree-checkbox")||this.fire("cellmousedown",a)},_OnCellClick:function(a){mini.findParent(a.htmlEvent.target,this._eciconCls)||(mini.findParent(a.htmlEvent.target,"mini-tree-checkbox")||this.checkOnTextClick?this._tryToggleCheckNode(a.record):this.fire("cellclick",a))},__OnNodeDblClick:function(a){},__OnNodeClick:function(a){},setNodeText:function(a,b){if(a=this.getNode(a)){var c={};c[this.getTextField()]=b;this.updateNode(a,c)}},setNodeIconCls:function(a,b){if(a=this.getNode(a)){var c={};c[this.iconField]=b;this.updateNode(a,c)}},setIconField:function(a){this.iconField=a},getIconField:function(){return this.iconField},setAllowSelect:function(a){this.setAllowRowSelect(a)},getAllowSelect:function(){return this.getAllowRowSelect()},setShowExpandButtons:function(a){this.showExpandButtons!=a&&(this.showExpandButtons=a,this.doUpdate())},getShowExpandButtons:function(){return this.showExpandButtons},setShowTreeLines:function(a){this.showTreeLines=a;1==a?mini.addClass(this.el,"mini-tree-treeLine"):mini.removeClass(this.el,"mini-tree-treeLine")},getShowTreeLines:function(){return this.showTreeLines},setShowArrow:function(a){this.showArrow=a;1==a?mini.addClass(this.el,"mini-tree-showArrows"):mini.removeClass(this.el,"mini-tree-showArrows")},getShowArrow:function(){return this.showArrow},setLeafIcon:function(a){this.leafIcon=a},getLeafIcon:function(){return this.leafIcon},setFolderIcon:function(a){this.folderIcon=a},getFolderIcon:function(){return this.folderIcon},getExpandOnDblClick:function(){return this.expandOnDblClick},setExpandOnNodeClick:function(a){(this.expandOnNodeClick=a)?mini.addClass(this.el,"mini-tree-nodeclick"):mini.removeClass(this.el,"mini-tree-nodeclick")},getExpandOnNodeClick:function(){return this.expandOnNodeClick},setLoadOnExpand:function(a){this.loadOnExpand=a},getLoadOnExpand:function(){return this.loadOnExpand},hideNode:function(a){if(a=this.getNode(a)){a.visible=!1;this._doUpdateTreeNodeEl(a);var b=this._getNodeEl(a,1);a=this._getNodeEl(a,2);b&&(b.style.display="none");a&&(a.style.display="none")}},showNode:function(a){if(a=this.getNode(a))a.visible=!0,this._doUpdateTreeNodeEl(a)},enableNode:function(a){if(a=this.getNode(a)){a.enabled=!0;var b=this._getNodeEl(a,1),c=this._getNodeEl(a,2);b&&mini.removeClass(b,"mini-disabled");c&&mini.removeClass(c,"mini-disabled");if(a=this._getCheckBoxEl(a))a.disabled=!1}},disableNode:function(a){if(a=this.getNode(a)){a.enabled=!1;var b=this._getNodeEl(a,1),c=this._getNodeEl(a,2);b&&mini.addClass(b,"mini-disabled");c&&mini.addClass(c,"mini-disabled");if(a=this._getCheckBoxEl(a))a.disabled=!0}},imgPath:"",setImgPath:function(a){this.imgPath=a},getImgPath:function(){return this.imgPath},imgField:"img",setImgField:function(a){this.imgField=a},getImgField:function(){return this.imgField},getAttrs:function(a){function b(a){for(var c=[],d=0,l=a.length;d<l;d++){var r=a[d],t=mini.getChildNodes(r),u=t[0],t=t[1];u&&t||(u=r);var B=jQuery(u),r={};r[e]=u.getAttribute("value");r[g]=B.attr("iconCls");r[f]=u.innerHTML;c.add(r);if(u=B.attr("expanded"))r.expanded="false"==u?!1:!0;if(u=B.attr("allowSelect"))r.allowSelect="false"==u?!1:!0;t&&(t=mini.getChildNodes(t),t=b(t),0<t.length&&(r[k]=t))}return c}var c=mini.TreeGrid.superclass.getAttrs.call(this,a);mini._ParseString(a,c,"value url idField textField iconField nodesField parentField valueField checkedField leafIcon folderIcon leafField ondrawnode onbeforenodeselect onnodeselect onnodemousedown onnodeclick onnodedblclick onbeforenodecheck onnodecheck onbeforeexpand onexpand onbeforecollapse oncollapse dragGroupName dropGroupName onendedit expandOnLoad ondragstart onbeforedrop ondrop ongivefeedback treeColumn onaddnode onremovenode onmovenode imgPath imgField hoverMode".split(" "));mini._ParseBool(a,c,"allowSelect showCheckBox showRadioButton showExpandButtons showTreeIcon showTreeLines checkRecursive enableHotTrack showFolderCheckBox resultAsTree allowDrag allowDrop showArrow expandOnDblClick removeOnCollapse autoCheckParent loadOnExpand expandOnNodeClick useAnimation checkOnTextClick".split(" "));if(c.expandOnLoad){var d=parseInt(c.expandOnLoad);mini.isNumber(d)?c.expandOnLoad=d:c.expandOnLoad="true"==c.expandOnLoad?!0:!1}var e=c.idField||this.getIdField(),f=c.textField||this.getTextField(),g=c.iconField||this.getIconField(),k=c.nodesField||this.getNodesField();a=b(mini.getChildNodes(a));0<a.length&&(c.data=a);!c.idField&&c.valueField&&(c.idField=c.valueField);return c}});mini.regClass(mini.TreeGrid,"TreeGrid");mini.Tree=function(){mini.Tree.superclass.constructor.apply(this,arguments);var a=[{name:"node",header:"",field:this.getTextField(),width:"auto",allowDrag:!0,editor:{type:"textbox"}}];this._columnModel.setColumns(a);this._column=this._columnModel.getColumn("node");mini.removeClass(this.el,"mini-treegrid");mini.addClass(this.el,"mini-tree-nowrap");this.setBorderStyle("border:0")};mini.extend(mini.Tree,mini.TreeGrid,{_userEmptyTd:mini.isChrome||mini.isIE6||mini.isIE7?!1:!0,setTextField:function(a){this._dataSource.setTextField(a);this._columnModel.updateColumn("node",{field:a});this.textField=a},uiCls:"mini-tree",hoverMode:"title",_rowHoverCls:"mini-tree-node-hover",_rowSelectedCls:"mini-tree-selectedNode",_getRecordByEvent:function(a,b){"node"==this.hoverMode&&(b=!1);var c=mini.Tree.superclass._getRecordByEvent.call(this,a);return!1===b||c&&mini.findParent(a.target,"mini-tree-nodeshow")?c:null},_treeColumn:"node",defaultRowHeight:22,_getRowHeight:function(a){var b=this.defaultRowHeight;a._height&&(b=parseInt(a._height),isNaN(parseInt(a._height))&&(b=rowHeight));return b},showHeader:!1,showTopbar:!1,showFooter:!1,showColumns:!1,showHGridLines:!1,showVGridLines:!1,showTreeLines:!0,setTreeColumn:null,setColumns:null,getColumns:null,frozen:null,unFrozen:null,showModified:!1,_OnCellMouseDown:function(a){this._editInput&&this._editInput.blur();this.fire("cellmousedown",a)},beginEdit:function(a){function b(){e._editInput=document.getElementById(e._id+"$edit$"+a._id);e._editInput.focus();mini.selectRange(e._editInput,0,1E3);mini.on(e._editInput,"keydown",e.__OnEditInputKeyDown,e);mini.on(e._editInput,"blur",e.__OnEditInputBlur,e)}if(a=this.getNode(a)){var c=this.getColumn(0),d=mini._getMap(c.field,a),c={record:a,node:a,column:c,field:c.field,value:d,cancel:!1};this.fire("cellbeginedit",c);if(1!=c.cancel){this._editingNode=a;this._doUpdateNodeTitle(a);var e=this;setTimeout(function(){b()},100);b()}}},cancelEdit:function(a){var b=this._editingNode;this._editingNode=null;b&&(!1!==a&&this._doUpdateNodeTitle(b),mini.un(this._editInput,"keydown",this.__OnEditInputKeyDown,this),mini.un(this._editInput,"blur",this.__OnEditInputBlur,this));this._editInput=null},__OnEditInputKeyDown:function(a){if(13==a.keyCode){a=this._editingNode;var b=this._editInput.value;this._editingNode=null;this.setNodeText(a,b);this.cancelEdit(!1);this.fire("endedit",{node:a,text:b})}else 27==a.keyCode&&this.cancelEdit()},__OnEditInputBlur:function(a){if(a=this._editingNode){var b=this._editInput.value;this.cancelEdit();this.setNodeText(a,b);this.fire("endedit",{node:a,text:b})}},addRowCls:function(a,b){var c=this._getRowEl(a,1),d=this._getRowEl(a,2);c&&mini.addClass(c,b);d&&mini.addClass(d,b);c&&mini.addClass(c.cells[1],b);d&&mini.addClass(d.cells[1],b)},removeRowCls:function(a,b){var c=this._getRowEl(a,1),d=this._getRowEl(a,2);c&&mini.removeClass(c,b);d&&mini.removeClass(d,b);c&&mini.removeClass(c.cells[1],b);d&&mini.removeClass(d.cells[1],b)},scrollIntoView:function(a){if(a=this.getNode(a)){this.isVisibleNode(a)||this.expandPath(a);var b=this;setTimeout(function(){if(b.isVirtualScroll())mini.Tree.superclass.scrollIntoView.call(b,a);else{var c=b._getNodeEl(a,2);mini.scrollIntoView(c,b._rowsViewEl,!1)}},10)}}});mini.regClass(mini.Tree,"Tree");mini._Tree_Expander=function(a){this.owner=a;mini.on(a.el,"click",this.__OnClick,this);mini.on(a.el,"dblclick",this.__OnDblClick,this)};mini._Tree_Expander.prototype={_canToggle:function(){return!this.owner._dataSource._isNodeLoading()},__OnClick:function(a){var b=this.owner,c=b._getRecordByEvent(a,!1);if(c&&!1!==c.enabled&&!mini.findParent(a.target,"mini-tree-checkbox")){var d=b.isLeaf(c);mini.findParent(a.target,b._eciconCls)?0!=this._canToggle()&&b._tryToggleNode(c):!b.expandOnNodeClick||d||b._inAniming||0==this._canToggle()||b._tryToggleNode(c)}},__OnDblClick:function(a){var b=this.owner,c=b._getRecordByEvent(a,!1);if(c&&!1!==c.enabled&&!b.isEditingNode(c)){var d=b.isLeaf(c);b._inAniming||mini.findParent(a.target,b._eciconCls)||mini.findParent(a.target,"mini-tree-checkbox")||b.expandOnNodeClick||!b.expandOnDblClick||d||0==this._canToggle()||(a.preventDefault(),b._tryToggleNode(c))}}};mini._Tree_AsyncLoader=function(a){this.owner=a;a.on("expand",this.__OnBeforeNodeExpand,this)};mini._Tree_AsyncLoader.prototype={__OnBeforeNodeExpand:function(a){var b=this.owner,c=a.node,d=b.isLeaf(c),e=c[b.getNodesField()];d||e&&0!=e.length||!b.loadOnExpand||!1===c.asyncLoad||(a.cancel=!0,b.loadNode(c))}};mini.overwrite(mini.Button,{disableMultiClick:!0,iconPosition:"left",_iconOnlyCls:"mini-button-iconOnly",_iconPosCls:{left:"mini-button-iconLeft",right:"mini-button-iconRight",top:"mini-button-iconTop",bottom:"mini-button-iconBottom"},_loadingSvg:mini.isIE8||mini.isIE9?"":'\x3csvg class\x3d"mini-button-loading-icon" version\x3d"1.1" xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 1024 1024" width\x3d"128" height\x3d"128" fill\x3d"currentColor" \x3e\x3cpath d\x3d"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 0 0-94.3-139.9 437.71 437.71 0 0 0-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"\x3e\x3c/path\x3e\x3c/svg\x3e',setIconPosition:function(a){this.iconPosition=a;this.doUpdate()},doUpdate:function(){if(!1!==this._allowUpdate){var a=this.text,b=this.iconCls,c=this.iconPosition,d=this.plain,e=[];""===a?this.addCls(this._iconOnlyCls):(this.removeCls(this._iconOnlyCls),e.push('\x3cspan class\x3d"mini-button-text"\x3e'+a+"\x3c/span\x3e"));d?this.addCls(this._plainCls):this.removeCls(this._plainCls);b?(mini.hasClass(this.el,this._iconOnlyCls)||(this.__prevIconPos&&this.removeCls(this._iconPosCls[this.__prevIconPos]),this.addCls(this._iconPosCls[c]),this.__prevIconPos=c),a='\x3ci class\x3d"mini-button-icon '+b+'"\x3e\x3c/i\x3e',"top"==c||"left"==c?(e.unshift(a),e.unshift(this._loadingSvg)):(e.push(a),e.push(this._loadingSvg)),this.removeCls("mini-button-textOnly")):(this.addCls("mini-button-textOnly"),e.unshift(this._loadingSvg));this.allowCls&&e.push('\x3cspan class\x3d"mini-button-allow '+this.allowCls+'"\x3e\x3c/span\x3e');this.el.innerHTML=e.join("")}},setIsLoading:function(){return mini.isIE8||mini.isIE9?function(a){this.isLoading=!!a;this.setEnabled(!this.isLoading)}:function(a){this.enabled&&((this.isLoading=!!a)?this.addCls("mini-btn-loading"):this.removeCls("mini-btn-loading"))}}(),getIsLoading:function(){return this.isLoading},_initEvents:function(){var a=this;mini._BindEvents(function(){mini_onOne(this.el,"mousedown",this.__OnMouseDown,this);mini_onOne(this.el,"click",function(){a.isLoading||(a.__OnClick(),a.disableMultiClick&&a.enabled&&(a.setEnabled(!1),setTimeout(function(){a.setEnabled(!0)},1E3)))},this)},this)},getExtraAttrs:function(a){var b={};mini._ParseBool(a,b,["disableMultiClick","isloading"]);return b}});(function(){var a=mini.MenuButton.prototype.setMenu,b=function(b){b=a.call(this,b);this.menu&&this.menu.setyOffset&&this.menu.setyOffset(this.yOffset);return b};mini.overwrite(mini.MenuButton,{yOffset:2,setMenu:b});mini.overwrite(mini.SplitButton,{yOffset:2,setMenu:b});var c=mini.Tabs.prototype._createHeaderMenu;mini.Tabs.prototype._createHeaderMenu=function(){var a=c.apply(this,arguments);this._headerMenu&&this._headerMenu.setyOffset&&this._headerMenu.setyOffset(2);return a}})();mini.overwrite(mini.ButtonEdit,{setText:function(a){if(null===a||void 0===a)a="";this.text=a=mini.htmlDecode(a);this._textEl.value=a;this._doEmpty()}});mini.overwrite(mini.Calendar,{__OnClick:function(a){var b=this.viewDate;if(0!=this.enabled){var c=a.target,d=mini.findParent(a.target,"mini-calendar-title");mini.findParent(c,"mini-calendar-monthNext")?(b.setDate(1),b.setMonth(b.getMonth()+1),this.setViewDate(b)):mini.findParent(c,"mini-calendar-yearNext")?(b.setDate(1),b.setFullYear(b.getFullYear()+1),this.setViewDate(b)):mini.findParent(c,"mini-calendar-monthPrev")?(b.setDate(1),b.setMonth(b.getMonth()-1),this.setViewDate(b)):mini.findParent(c,"mini-calendar-yearPrev")?(b.setDate(1),b.setFullYear(b.getFullYear()-1),this.setViewDate(b)):mini.findParent(c,"mini-calendar-tadayButton")?(b=!!mini.findParent(c,"yesterday"),c=new Date,b&&c.setDate(c.getDate()-1),this.setViewDate(c),this.setSelectedDate(c),this.currentTime&&this.setTime(new Date),this._OnDateClick(c,"today")):mini.findParent(c,"mini-calendar-clearButton")?(this.setSelectedDate(null),this.setTime(null),this._OnDateClick(null,"clear")):mini.findParent(c,"mini-calendar-okButton")?this._OnDateClick(null,"ok"):d&&this.showMenu();(a=mini.findParent(a.target,"mini-calendar-date"))&&!mini.hasClass(a,"mini-calendar-disabled")&&(a=a.id.split("$"),a=parseInt(a[a.length-1]),-1!=a&&this._OnDateClick(new Date(a)))}}});mini.supportRem&&mini.overwrite(mini.Calendar,{width:"2.20rem",height:"1.6rem"});mini.overwrite(mini.ComboBox,{autoLoad:!0,__input:function(a){document.activeElement==this._textEl&&a.which&&this._tryQuery()},setUrl:function(a,b){this.getPopup();this.autoLoad||b?(this._listbox.setUrl(a),this.url=this._listbox.url,this.data=this._listbox.data,this.doDataChange()):(this.url=a,this.isLoaded=!1)},load:function(a){a||(a=this.url);"string"==typeof a?this.setUrl(a,!0):this.setData(a)},setAutoLoad:function(a){this.autoLoad=!!a},getAutoLoad:function(){return this.autoLoad},showPopup:function(){0==this.isLoaded&&this.load();var a={cancel:!1};this.fire("beforeshowpopup",a);this._firebeforeshowpopup=!1;if(1!=a.cancel){this._listbox.setHeight("auto");mini.ComboBox.superclass.showPopup.call(this);a=this.popup.el.style.height;""==a||"auto"==a?this._listbox.setHeight("auto"):this._listbox.setHeight("100%");if(!this.multiSelect){var a=jQuery("table .mini-listbox-checkbox",this._listbox.el),b=a.css("display");a.css("display","table-cell");a.css("display",b)}this._listbox.setValueInCheckOrder(this.valueInCheckOrder);this._listbox.setValue(this.value);this.autoFocusItem&&(""==this.value||mini.isNull(this.value))&&this._listbox._focusItem(0)}},setValue:function(a){mini.isNull(a)&&(a="");var b=this._listbox.getValueAndText(a),c=b[0],b=b[1];if(""===b||mini.isNull(b))b=a;this.valueFromSelect&&(""===c||mini.isNull(c))&&(a=b="");this.value=a;this._valueEl.value=this.value;this.setText(b)},setText:function(a){if(null===a||void 0===a)a="";this.text=a=mini.htmlDecode(a);this._textEl.value=a;this._doEmpty()},doDataChange:function(){var a=this._listbox.getValueAndText(this.value),b=a[0],a=a[1];""!==b||this.clearOnLoad||(b=this.value,a=this.text,this.value=null);this.text=this._textEl.value=a;this.setValue(b);this.isLoaded=!0},getExtraAttrs:function(a){var b={};mini._ParseBool(a,b,["autoLoad"]);return b}});mini.htmlUnescape=function(a){return a+""!==a?a:mini.htmlDecode(a)};mini.htmlEscape=function(a){if(a+""!==a)return a;var b=document.createElement("div");b.appendChild(document.createTextNode(a));return b.innerHTML};(function(a){var b=mini.GridView.prototype._createPagers;mini.overwrite(mini.DataGrid,{pagerType:"pagination",_createPagers:function(){b.apply(this,arguments);"pager"!==this.pagerType&&this.setPagerType(this.pagerType)}});var c=mini.FrozenGridView.prototype._createRowsHTML;mini.FrozenGridView.prototype._createRowsHTML=function(){var b=c.apply(this,arguments),d=parseInt(a(this.el).find(".mini-grid-rows-view").height(),10);return d&&200<d?(d=.3*d>>0,b=a(b),b.find(".mini-grid-emptyText").css({paddingTop:d+56,backgroundPosition:"center "+d+"px"}),b[0].outerHTML):b};var d=mini.DataGrid.prototype.setShowVGridLines,e=mini.DataGrid.prototype.setShowHGridLines;mini.TreeGrid.prototype.setShowVGridLines=mini.DataGrid.prototype.setShowVGridLines=function(b){var c=d.apply(this,arguments);b?a(this.el).addClass("mini-grid-showVGridLines"):a(this.el).removeClass("mini-grid-showVGridLines");return c};mini.TreeGrid.prototype.setShowHGridLines=mini.DataGrid.prototype.setShowHGridLines=function(b){var c=e.apply(this,arguments);b?a(this.el).addClass("mini-grid-showHGridLines"):a(this.el).removeClass("mini-grid-showHGridLines");return c};mini.TreeGrid.prototype._afterApply=mini.DataGrid.prototype._afterApply=function(){this.showHGridLines?a(this.el).addClass("mini-grid-showHGridLines"):a(this.el).removeClass("mini-grid-showHGridLines");this.showVGridLines?a(this.el).addClass("mini-grid-showVGridLines"):a(this.el).removeClass("mini-grid-showVGridLines")}})(window.jQuery);mini.overwrite(mini.DataGrid,{allowAlternating:!1,showHGridLines:!0,showVGridLines:!1,showSortIcon:!0,allowResize:!1,showEmptyText:!0,emptyText:"\u6682\u65e0\u6570\u636e",getColumnData:function(a){for(var b=[],c=this.getData(),d=0,e=c.length;d<e;d++)b.push(c[d][a]);return b},_OnCellBeginEdit:function(a,b,c,d){var e=mini._getMap(b.field,a),f={sender:this,rowIndex:this.indexOf(a),row:a,record:a,column:b,field:b.field,editor:c,value:e,cancel:!1};this.fire("cellbeginedit",f);mini.isNull(b.defaultValue)||!mini.isNull(f.value)&&""!==f.value||(e=mini.clone({d:b.defaultValue}),f.value=e.d);c=f.editor;e=f.value;if(f.cancel||!c&&"inline"!=b.editMode||!0===b.readOnly)return!1;if(!1===d)return!0;"inline"!=b.editMode&&(mini.isNull(e)&&(e=""),c.setValue&&c.setValue(mini.htmlUnescape(e)),c.ownerRowID=a._uid,b.displayField&&c.setText&&(a=mini._getMap(b.displayField,a),mini.isNull(b.defaultText)||!mini.isNull(a)&&""!==a||(e=mini.clone({d:b.defaultText}),a=e.d),c.setText(mini.htmlUnescape(a))),this.allowCellEdit&&(this._editingControl=f.editor));return!0},_OnCellCommitEdit:function(a,b,c,d){c={sender:this,rowIndex:this.indexOf(a),record:a,row:a,column:b,field:b.field,editor:d?d:this.getCellEditor(b),value:mini.isNull(c)?"":c,text:"",cancel:!1};if(c.editor&&c.editor.getValue){try{c.editor.blur()}catch(f){}c.value=c.editor.getValue()}c.editor&&c.editor.getText&&(c.text=c.editor.getText());d=mini._getMap(b.field,a);var e=c.value;c.oldValue=d;if(mini.isEquals(d,e))return c;this.fire("cellcommitedit",c);0==c.cancel&&(c.value=mini.htmlEscape(c.value),c.text=mini.htmlEscape(c.text),this.allowCellEdit&&(d={},d[b.field]=c.value,b.displayField&&(d[b.displayField]=c.text),this.updateRow(a,d)));return c},_initData:function(){this.data=this._dataSource.getSource();this.pageIndex=this.getPageIndex();this.pageSize=this.getPageSize();this.totalCount=this.getTotalCount();this.totalPage=this.getTotalPage();this.sortField=this.getSortField();this.sortOrder=this.getSortOrder();this.url=this.getUrl();0<this.totalPage&&this.pageIndex>this.totalPage-1&&this.setPageIndex(this.totalPage-1);this._mergedCellMaps={};this._mergedCells={};this._cellErrors=[];this._cellMapErrors={};this.isGrouping()&&(this.groupBy(this._groupField,this._groupDir),this.collapseGroupOnLoad&&this.collapseGroups())},_setEditorBox:function(a,b){if(a.setHeight&&"textarea"==a.type){var c=b.height-2;a.minHeight&&c<a.minHeight&&(c=a.minHeight);a.setHeight(c)}a.setWidth&&(c=b.width-12,a.minWidth&&c<a.minWidth&&(c=a.minWidth),a.setWidth(20>c?20:c));mini.setXY(this._editWrap,b.x,b.y+1);mini.setWidth(this._editWrap,b.width-2);mini.setHeight(this._editWrap,b.height-2);b.x>document.body.scrollWidth&&mini.setX(this._editWrap,-1E3)}});(function(a){mini.ActionColumn=function(b){return mini.copyTo({width:152,cellCls:"mini-actioncolumn mini-actioncolumn-cell",headerCls:"mini-actioncolumn",hideable:!0,allowDrag:!0,minWidth:88,defaultShowItems:4,calcWidth:function(a){return Math.max(this.minWidth,32*Math.min(a,this.defaultShowItems)+24)+"px"},renderer:function(b){function c(a,b,c,d){return'\x3ci class\x3d"action-icon '+a.icon+(b?" mini-disabled":"")+'" title\x3d"'+a.title+'" data-column-id\x3d"'+p+'" data-icon-id\x3d"'+a._id+'" data-record-id\x3d"'+g._id+'" '+(c?'data-over-ids\x3d"'+c+'"':"")+(d?' data-disabled-ids\x3d"'+d+'"':"")+"\x3e\x3c/i\x3e"}var e=this,f=b.sender,g=b.record,k=b.column,l=k.__actions;if(!l||!l.length)return"";var n="",p=k._id,q={};if(k.__hasIconRender)if(a.each(l,function(c,d){d.renderer+""===d.renderer&&(d.renderer=e.__getFun(d.renderer,!0));if(d&&"function"===a.type(d.renderer)){var l={sender:f,record:g,row:b.row,column:k,icon:{icon:d.icon}},n=d.renderer.call(f,l);"string"===a.type(n)&&n.length&&window.console&&console.warn&&console.warn("\u56fe\u6807\u6e32\u67d3\u5185\u5bb9\u4e0d\u53ef\u81ea\u5b9a\u4e49\uff0c\u4ec5\u53ef\u901a\u8fc7e.icon.disabled \u548c e.icon.visible \u63a7\u5236\u56fe\u6807\u6309\u94ae\u7684\u7981\u7528\u548c\u663e\u793a\u72b6\u6001");q[d._id]={disabled:!0===l.icon.disabled?!0:!1,visible:!1===l.icon.visible?!1:!0}}else q[d._id]={disabled:!1,visible:!0}}),l=a.grep(l,function(a){return q[a._id].visible}),4<l.length){var n=a.map(l.slice(0,3),function(a){return c(a,q[a._id].disabled)}).join(""),r=[],t=[];a.map(l.slice(3),function(a){r.push(a._id);q[a._id].disabled&&t.push(a._id)}).join(",");n+=c(k.__actionsMap.showMore,!1,r.join(","),t.join(","))}else n=a.map(l,function(a){return c(a,q[a._id].disabled)}).join("");else n=a.map(l.slice(0,4),function(a){return c(a)}).join("");return'\x3cdiv class\x3d"mini-actioncolumn-wrap" data-column-id\x3d"'+p+'" data-record-id\x3d"'+g._id+'"\x3e'+n+"\x3c/div\x3e"},__onCellClick:function(b){if(b.column._id===this._id){var c=b.htmlEvent.target,e=c.getAttribute("data-icon-id");(e=b.column.__actionsMap[e])&&e.handle&&!a(c).hasClass("disabled")&&this.__callHandle(e.handle,b.record,b.sender,c)}},__callHandle:function(b,d,e,f){var c=a.type(b);if("function"===c)return b.call(e,d,f);"string"===c&&(/\(.*\)/.test(b)?eval(b):eval(b)(d,f))},__getFun:function(b,d){return window[b]&&"function"===a.type(window[b])?window[b]:d?!1:b},init:function(b){function c(c,d){e.__extMenu||e.__createExtMenu(b);e.__extMenu.__currentRecordId=c._uid;if(e.__hasIconRender){var f=(d.getAttribute("data-over-ids")||"").split(","),g=(d.getAttribute("data-disabled-ids")||"").split(",");e.__extMenu.setItems(a.map(f,function(a){var b=e.__actionsMap[a];return{id:a,text:b.title,iconCls:b.icon,enabled:-1!==g.indexOf(a)?!1:!0}}))}e.__extMenu.showAtEl(d);a(d).addClass("active")}var e=this,f=a("\x3cdiv\x3e\x3c/div\x3e").html(e.header),g=[];e.__hasIconRender=!1;var k={},l=a.map(f.find('[type\x3d"action"]').remove(),function(a,b){var c={_id:b+1,icon:a.getAttribute("icon"),title:a.textContent||a.innerText||a.getAttribute("title"),handle:a.getAttribute("onclick"),renderer:a.getAttribute("renderer")};c.handle||g.push(c);k[c._id]=c;c.renderer&&(e.__hasIconRender=!0);return c});f.find("\x3e*").remove();e.header=a.trim(f.text())||"\u64cd\u4f5c";e.__actions=l;e.__actionsMap=k;e.width=e.calcWidth(l.length);4<l.length&&(f={_id:"showMore",icon:"icon-omit",title:"\u663e\u793a\u66f4\u591a",handle:c},k[f._id]=f,e.__hasIconRender||(l.splice(3,0,f),this.__createExtMenu(b),this.__extMenu.setItems(a.map(this.__actions.slice(4),function(a){return{id:a._id,text:a.title,iconCls:a.icon}}))));g.length&&a.each(g,function(a,b){console&&console.warn&&console.warn(e.header+"\u5217\u7684\u3010"+b.icon+"\u3011\u672a\u914d\u7f6e\u70b9\u51fb\u4e8b\u4ef6\uff01\uff01\uff01")});g=null;b.on("cellClick",this.__onCellClick,this);e.__inited=!0},__createExtMenu:function(b){var c=this;if(!this.__extMenuInited){var e=new mini.Menu;e.on("itemclick",function(a){a=c.__actionsMap[a.item.id];var d=b.getRowByUID(e.__currentRecordId);a&&a.handle&&c.__callHandle(a.handle,d,b)});var f=e.hide;e.hide=function(){f.apply(this,arguments);a('[data-icon-id\x3d"showMore"]').removeClass("active")};this.__extMenu=e;this.__extMenuInited=!0}return this.__extMenu}},b)};mini._Columns.actioncolumn=mini.ActionColumn})(this.jQuery);$(document).on("keydown",".mini-calendar-timespinner",function(a){a=a.target;"INPUT"!=a.nodeName&&"TEXTAREA"!=a.nodeName||a.focus()});mini.overwrite(mini.DatePicker,{defaultTime:"",maxDate:"9999-12-31",minDate:"1753-01-01",showPopup:function(){var a={cancel:!1};this.fire("beforeshowpopup",a);1!=a.cancel&&(this._calendar=this._getCalendar(),this._calendar.beginUpdate(),this._calendar._allowLayout=!1,this._calendar.el.parentNode!=this.popup._contentEl&&this._calendar.render(this.popup._contentEl),this._calendar.set({monthPicker:this._monthPicker,showTime:this.showTime,timeFormat:this.timeFormat,showClearButton:this.showClearButton,showYesterdayButton:this.showYesterdayButton,showTodayButton:this.showTodayButton,showOkButton:this.showOkButton,showWeekNumber:this.showWeekNumber}),this._calendar.setValue(this.value||this.defaultTime),this.value?this._calendar.setViewDate(this.value):this._calendar.setViewDate(this.viewDate),this._calendar.hideMenu(),this._calendar._target&&(a=this._calendar._target,this._calendar.un("timechanged",a.__OnTimeChanged,a),this._calendar.un("dateclick",a.__OnDateClick,a),this._calendar.un("drawdate",a.__OnDrawDate,a)),this._calendar.on("timechanged",this.__OnTimeChanged,this),this._calendar.on("dateclick",this.__OnDateClick,this),this._calendar.on("drawdate",this.__OnDrawDate,this),this._calendar.endUpdate(),this._calendar._allowLayout=!0,this._calendar.doLayout(),this._calendar.focus(),this._calendar._target=this,mini.DatePicker.superclass.showPopup.call(this))},getExtraAttrs:function(a){var b={};mini._ParseString(a,b,["defaultTime"]);return b}});mini.overwrite(mini.Form,{getValidateFields:function(a){function b(a){return mini.isDisplay(a.el,function(a){if(mini.hasClass(a,"mini-tabs-body")||mini.hasClass(a,"fui-acc-bd")||mini.hasClass(a,"invisible"))return!0})}for(var c=[],d=this.getFields(),e=0,f=d.length;e<f;e++){var g=d[e];g.validate&&g.isDisplay&&(b(g)||g.forceValidate)&&(g.enabled||a||g.forceValidate)&&c.push(g)}return c}});mini.overwrite(mini.ListBox,{getItemText:function(a){a=mini._getMap(this.textField,a);return mini.isNull(a)?"":mini.htmlDecode(String(a))},_OnDrawCell:function(a,b,c){var d=c?mini._getMap(c.field,a):this.getItemText(a);a={sender:this,index:b,rowIndex:b,record:a,item:a,column:c,field:c?c.field:null,value:d,cellHtml:d,rowCls:null,cellCls:c?c.cellCls||"":"",rowStyle:null,cellStyle:c?c.cellStyle||"":""};this.columns&&0<this.columns.length||0!=b||!this.showNullItem||(a.cellHtml=this.nullItemText);a.cellHtml=mini.htmlEncode(a.cellHtml);c&&(c.dateFormat&&(mini.isDate(a.value)?a.cellHtml=mini.formatDate(d,c.dateFormat):a.cellHtml=d),b=c.renderer)&&(fn="function"==typeof b?b:window[b])&&(a.cellHtml=fn.call(c,a));this.fire("drawcell",a);if(null===a.cellHtml||void 0===a.cellHtml||""===a.cellHtml)a.cellHtml="\x26nbsp;";return a}});(function(){function a(a){a.hasClass("check-beauty")||($.map(a.find(".mini-listbox-checkbox"),function(a){var b=$(a).find('input[type\x3d"checkbox"]')[0].id;b&&$('\x3clabel class\x3d"mini-listbox-checkbox-icon" for\x3d"'+b+'"\x3e\x3c/label\x3e').appendTo(a)}),a.addClass("check-beauty"))}if(!mini.isIE8){var b=mini.ListBox.prototype.doUpdate;mini.ListBox.prototype.doUpdate=function(){var c=b.apply(this,arguments);if(!this.showCheckBox)return c;var d=$(this._viewEl).find(".mini-listbox-items"),e=$(this._headerEl).find(".mini-listbox-headerInner");a(d);a(e);return c}}})();mini.overwrite(mini.Menu,{_initEvents:function(){mini._BindEvents(function(){mini.on(document,"mousedown",this.__OnBodyMouseDown,this);mini_onOne(this.el,"mouseover",this.__OnMouseOver,this);mini.on(window,"resize",this.__OnWindowResize,this);this._disableContextMenu&&mini_onOne(this.el,"contextmenu",function(a){a.preventDefault()},this);mini_onOne(this._topArrowEl,"mousedown",this.__OnTopMouseDown,this);mini_onOne(this._bottomArrowEl,"mousedown",this.__OnBottomMouseDown,this)},this);var a=this;this.on("open",function(){a._onDocumentMousewheel()})},hide:function(){this.hideItems();this._unDocumentMousewheel();mini_Popup_prototype_hide.call(this)},_unDocumentMousewheel:function(){mini.un(document,"mousewheel",this.__OnDocumentMousewheel,this);this._mousewheelXY=null},_onDocumentMousewheel:function(){this._unDocumentMousewheel();this._mousewheelXY=mini.getXY(this.el);mini.on(document,"mousewheel",this.__OnDocumentMousewheel,this)},__OnDocumentMousewheel:function(a){function b(){if(c.isPopup){var a=c._mousewheelXY,e=mini.getXY(c.popupEl);a[0]!=e[0]||a[1]!=e[1]?c.hide():setTimeout(b,300)}}var c=this;setTimeout(b,300)}});mini.overwrite(mini.Pager,{update:function(a,b,c){mini.isNumber(a)&&(this.pageIndex=parseInt(a));mini.isNumber(b)&&(this.pageSize=parseInt(b));mini.isNumber(c)&&(this.totalCount=parseInt(c));this.showTotalCount&&(this.totalPage=parseInt(this.totalCount/this.pageSize)+1,(this.totalPage-1)*this.pageSize==this.totalCount&&--this.totalPage,0==this.totalCount&&(this.totalPage=0),0<=this.totalCount&&this.pageIndex>this.totalPage-1&&(this.pageIndex=this.totalPage-1),0>=this.pageIndex&&(this.pageIndex=0),0>=this.totalPage&&(this.totalPage=0));this.firstButton.enable();this.prevButton.enable();this.nextButton.enable();this.lastButton.enable();0==this.pageIndex&&(this.firstButton.disable(),this.prevButton.disable());this.showTotalCount&&this.pageIndex>=this.totalPage-1&&(this.nextButton.disable(),this.lastButton.disable());a=-1<this.pageIndex?this.pageIndex+1:0;this.showTotalCount&&0==this.totalCount&&(a=0);this.numInput.value=a;this.pagesLabel.innerHTML="/ "+this.totalPage;a=this.sizeList.clone();-1==a.indexOf(this.pageSize)&&(a.push(this.pageSize),this.sizeList=a=a.sort(function(a,b){return a-b}));b=[];c=0;for(var d=a.length;c<d;c++){var e=a[c],f={};f.text=e;f.id=e;b.push(f)}this.sizeCombo.setData(b);this.sizeCombo.setValue(this.pageSize);this.sizeTextEl.innerHTML=this.sizeText;this.sizeTextEl.style.display=this.sizeText?"":"none";a=this.firstText;b=this.prevText;c=this.nextText;d=this.lastText;e=this.reloadText;0==this.showButtonText&&(a=b=c=d=e="");this.firstButton.setText(a);this.prevButton.setText(b);this.nextButton.setText(c);this.lastButton.setText(d);this.reloadButton.setText(e);this.firstButton.setIconCls(this.showButtonIcon?"mini-pager-first":"");this.prevButton.setIconCls(this.showButtonIcon?"mini-pager-prev":"");this.nextButton.setIconCls(this.showButtonIcon?"mini-pager-next":"");this.lastButton.setIconCls(this.showButtonIcon?"mini-pager-last":"");this.reloadButton.setIconCls(this.showButtonIcon?"mini-pager-reload":"");this.reloadButton.setVisible(this.showReloadButton);if(a=this.reloadButton.el.previousSibling)a.style.display=this.showReloadButton?"":"none";this._rightEl.innerHTML=String.format(this.pageInfoText,this.pageSize,this.totalCount);this.indexEl.style.display=this.showPageIndex?"":"none";this.sizeEl.style.display=this.showPageSize?"":"none";this._rightEl.style.display=this.showPageInfo&&this.showTotalCount?"":"none";this.pagesLabel.style.display=this.showTotalCount?"":"none";this.showTotalCount?(this.firstButton.setVisible(0<=this.totalCount),this.lastButton.setVisible(0<=this.totalCount),0>this.totalCount&&(this.firstButton.enable(),this.nextButton.enable(),0==this.pageIndex&&this.firstButton.disable())):(this.firstButton.setVisible(!1),this.lastButton.setVisible(!1))},_OnPageChanged:function(a,b){var c={pageIndex:mini.isNumber(a)?a:this.pageIndex,pageSize:mini.isNumber(b)?b:this.pageSize,cancel:!1};this.showTotalCount&&0<=this.totalCount&&c.pageIndex>this.totalPage-1&&(c.pageIndex=this.totalPage-1);0>c.pageIndex&&(c.pageIndex=0);this.fire("beforepagechanged",c);1!=c.cancel&&(this.fire("pagechanged",c),this.update(c.pageIndex,c.pageSize))},_initEvents:function(){function a(){if(!b){b=!0;var a=parseInt(this.numInput.value);isNaN(a)?(this.update(),c=1):c!=a&&(this._OnPageChanged(a-1),c=a);setTimeout(function(){b=!1},100)}}mini.Pager.superclass._initEvents.call(this);this.firstButton.set({disableMultiClick:!1}).on("click",function(a){this._OnPageChanged(0)},this);this.prevButton.set({disableMultiClick:!1}).on("click",function(a){this._OnPageChanged(this.pageIndex-1)},this);this.nextButton.set({disableMultiClick:!1}).on("click",function(a){this._OnPageChanged(this.pageIndex+1)},this);this.lastButton.set({disableMultiClick:!1}).on("click",function(a){this._OnPageChanged(this.totalPage)},this);this.reloadButton.on("click",function(a){this._OnPageChanged()},this);var b=!1,c=parseInt(this.numInput.value);mini.on(this.numInput,"change",function(b){a.call(this)},this);mini.on(this.numInput,"keydown",function(b){13==b.keyCode&&(a.call(this),b.stopPropagation())},this);this.sizeCombo.on("valuechanged",this.__OnPageSelectChanged,this)}});mini.overwrite(mini.Panel,{_doTitle:function(){var a=""==this.title?"\x26nbsp":this.title;this._titleEl.innerHTML=a;this._titleEl.title=mini.htmlUnescape(a);this._iconEl.style.display=this.iconCls||this.iconStyle?"inline":"none";this._iconEl.className="mini-panel-icon mini-icon mini-iconfont "+this.iconCls;mini.setStyle(this._iconEl,this.iconStyle)}});mini.Popup.prototype.yOffset=2;mini.Popup.prototype._getWindowOffset=function(){return[0,2]};mini.overwrite(mini.PopupEdit,{setText:function(a){if(null===a||void 0===a)a="";this.text=a=mini.htmlDecode(a);this._textEl.value=a;this._doEmpty()}});mini.overwrite(mini.ProgressBar,{_create:function(){this.el=document.createElement("div");this.el.className="mini-progressbar";this.el.innerHTML='\x3cdiv class\x3d"mini-progressbar-border"\x3e\x3cdiv class\x3d"mini-progressbar-bar"\x3e\x3cdiv class\x3d"mini-progressbar-bar-current"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-progressbar-text"\x3e\x3c/div\x3e\x3c/div\x3e';this._borderEl=this.el.firstChild;this._barEl=this._borderEl.firstChild.firstChild;this._textEl=this._borderEl.lastChild}});(function(){var a=mini.Tabs.prototype._createHeaderMenu;mini.Tabs.prototype._createHeaderMenu=function(){var b=a.apply(this,arguments),c=this._headerMenuEl;this._headerMenu&&c&&(this._headerMenu.on("open",function(){$(c).addClass("popup")}),this._headerMenu.on("close",function(){$(c).removeClass("popup")}));return b}})();mini.overwrite(mini.TextBox,{setVtype:function(a){if(-1<a.indexOf("int")||-1<a.indexOf("float")||-1<a.indexOf("decimalLength"))this.inputStyle||this.setInputStyle("text-align: right;");this.vtype=a},__OnMouseDown:function(a){var b=this;b._textEl.focus();"textarea"!=this._InputType&&(mini.isAncestor(this._textEl,a.target)||setTimeout(function(){b.focus();mini.selectRange(b._textEl,1E4,1E4)},1))},__OnBlur:function(a){this._focused=!1;var b=this;setTimeout(function(){0==b._focused&&b.removeCls(b._focusCls)},2);mini.isIE&&this.__OnInputTextChanged();this.fire("blur",{htmlEvent:a});this.validateOnLeave&&this.isEditable()&&this._tryValidate()},getExtraAttrs:function(a){var b={};mini._ParseString(a,b,"mobileErrorText telErrorText phoneErrorText postCodeErrorText orgCodeErrorText idCardErrorText validateErrorText decimalLengthErroeText".split(" "));return b}});mini.overwrite(mini.TextArea,{__OnMouseDown:function(a){var b=this;b._textEl.focus();mini.isAncestor(this._textEl,a.target)||setTimeout(function(){b.focus();mini.selectRange(b._textEl,1E3,1E3)},1)}});mini.overwrite(mini.TextBoxList,{popupYOffset:2,showPopup:function(a){if(0!=this.isDisplay()){this.isShowPopup=!0;var b=this._createPopup();b.el.style.zIndex=mini.getMaxZIndex();var c=this._listbox;c.emptyText=this.popupEmptyText;"loading"==a?(c.emptyText=this.popupLoadingText,this._listbox.setData([])):"error"==a&&(c.emptyText=this.popupLoadingText,this._listbox.setData([]));this._listbox.doUpdate();var d=this.getBox();a=d.x;c=d.y+d.height;this.popup.el.style.display="block";mini.setXY(b.el,-1E3,-1E3);this.popup.setWidth(d.width);this.popup.setHeight(this.popupHeight);d=this.popup.getHeight();d>this.popupMaxHeight&&this.popup.setHeight(this.popupMaxHeight);d<this.popupMinHeight&&this.popup.setHeight(this.popupMinHeight);mini.setXY(b.el,a,c+this.popupYOffset)}}});mini.overwrite(mini.ToolTip,{autoHide:!0,theme:"dark",defaultTheme:"dark",setTheme:function(a){if(a){this.theme=a;var b=jQuery.grep(this.el.className.split(" "),function(a){return-1!=a.indexOf("mini-tooltip-theme-")?!0:!1}).join(" ");jQuery(this.el).removeClass(b).addClass("mini-tooltip-theme-"+a)}},getTheme:function(){return this.theme},applyTheme:function(){if(this._target){var a=jQuery(this._target).attr("data-theme");this.setTheme(a||this.defaultTheme)}},setContent:function(a){this.$element.children(".mini-tooltip-inner").html(a||"\x26nbsp;");this.applyPlacement();this.applyTheme()},_bindTooltip:function(){var a=jQuery(this.scope||document),b=this.selector;this.setTheme(this.theme);a.unbind(".tooltip");for(var c=this.trigger.split(" "),d=c.length;d--;){var e=c[d];if("click"==e)a.on("click.tooltip",b,jQuery.proxy(this._toggle,this));else if("manual"!=e){var f="hover"==e?"mouseleave":"blur";a.on(("hover"==e?"mouseenter":"focus")+".tooltip",b,jQuery.proxy(this._enter,this));if(this.autoHide)a.on(f+".tooltip",b,jQuery.proxy(this._leave,this))}}},_toggle:function(a){"none"==this.$element.css("display")?this._enter(a):this._leave(a)},applyPlacement:function(){function a(a){d.removeClass("mini-tooltip-left mini-tooltip-top mini-tooltip-right mini-tooltip-bottom mini-tooltip-bottomleft mini-tooltip-topleft mini-tooltip-bottomright mini-tooltip-topright").addClass("mini-tooltip-"+a)}if(this._target&&"none"!=this.$element.css("display")){var b=this._target,c=jQuery(b).attr("data-placement")||this.placement,d=this.$element;if(b&&d[0]){d.show().css({left:"-2000px",top:"-2000px"});var e=mini.getBox(b),b=mini.getViewportBox(),f=e.top-b.top,g=b.bottom-e.bottom,k=e.left-b.left,l=b.right-e.right;a(c);var n=mini.getBox(d[0]),p=mini.getCalculatedOffset(c,e,n.width,n.height);0===c.indexOf("bottom")?f>g&&p.top+n.height>b.bottom&&(c=c.replace("bottom","top")):0===c.indexOf("top")&&f<g&&p.top<b.top&&(c=c.replace("top","bottom"));-1!==c.indexOf("left")?k>l&&n.width+p.left>b.width&&(c=c.replace("left","right")):-1!==c.indexOf("right")&&k<l&&(0>p.left||e.left+e.width<n.wihth)&&(c=c.replace("right","left"));if("bottom"===c||"top"===c)k>l&&n.width+p.left>b.width?c+="right":k<l&&(0>p.left||e.left+e.width<n.wihth)&&(c+="left");a(c);p=mini.getCalculatedOffset(c,e,n.width,n.height);if("right"==c||"left"==c){var c=function(){var a=e.top+e.height/2-q.height()/2-p.top;q.css("top",a)},q=$(d).children(".mini-tooltip-arrow");q.css("top","");b=mini.getViewportBox();p.top<b.y?(p.top=b.y,c()):p.top+n.height>b.bottom&&(p.top=b.bottom-n.height,c())}d.offset(p)}}},setAutoHide:function(a){this.autoHide!=a&&(this.autoHide=a,this._bindTooltip())},getAutoHide:function(){return this.autoHide},getExtraAttrs:function(a){var b={};mini._ParseString(a,b,["theme"]);mini._ParseBool(a,b,["autoHide"]);return b}});mini.overwrite(mini.DataTree,{loadNode:function(a,b){this._loadingNode=a;this.fire("beforeloadnode",{node:a});var c=new Date,d=this;d._doLoadAjax(d.loadParams,null,null,null,function(e){var f=new Date-c;60>f&&(f=60-f);setTimeout(function(){e.node=a;d._OnPreLoad(e);d._loadingNode=null;d.loadParams&&delete d.loadParams[d.idField];d.removeNodes(a[d.nodesField]);var c=e.data;if(c&&0<c.length){d.collapse(a);d.addNodes(c,a);for(var c=d.getAllChildNodes(a),f=0,l=c.length;f<l;f++)delete c[f]._state;!1!==b?d.expand(a,!0):d.collapse(a,!0)}else delete a[d.leafField],d.expand(a,!0);d.fire("loadnode",e);d.fire("load",e)},10)},!0)}});mini.overwrite(mini.Tree,{showTreeLines:!1,showFullPath:!1,includeRootNode:!1,replaceNodes:function(a,b){this.removeNodes(b[this.nodesField]);this.addNodes(a,b)},_OnDrawCell:function(a,b,c,d){a=mini.TreeGrid.superclass._OnDrawCell.call(this,a,b,c,d);this._treeColumn&&this._treeColumn==b.name&&(b=a.node,!1===b.ckr&&(a.showCheckBox=!1,a.showRadioButton=!1),this.fire("drawnode",a),a.nodeStyle&&(a.cellStyle=a.nodeStyle),a.nodeCls&&(a.cellCls=a.nodeCls),a.nodeHtml?a.cellHtml=a.nodeHtml:b.textCls&&(a.cellHtml='\x3cspan class\x3d"'+b.textCls+'"\x3e'+a.cellHtml+"\x3c/span\x3e"),this._createTreeColumn(a));return a},getValueAndText:function(a,b){mini.isNull(a)&&(a=[]);b=b||this.delimiter;"string"==typeof a||"number"==typeof a?a=this._dataSource.getsByIds(a):mini.isArray(a)||(a=[a]);for(var c=[],d=[],e=0,f=a.length;e<f;e++){var g=a[e];g&&(c.push(this.getItemValue(g)),d.push(this.getItemText(g)))}return[c.join(b),d.join(b)]},getItemValue:function(a){if(!a)return"";a=mini._getMap(this.idField,a);return mini.isNull(a)?"":String(a)},getItemText:function(a){if(!a)return"";a=this.showFullPath?this.getFullPath(a):mini._getMap(this.textField,a);return mini.isNull(a)?"":String(a).replace(/<\/?.+?>/g,"")},getFullPath:function(a){if(a.fullPath)return a.fullPath;for(var b=this.getAncestors(a),c="",d=0,e=b.length;d<e;d++)if(0!=d||this.includeRootNode)c+=mini._getMap(this.textField,b[d])+"-";return a.fullPath=c+=mini._getMap(this.textField,a)},getText:function(){var a=[];if(this.showCheckBox)a=this.getCheckedNodes();else{var b=this.getSelectedNode();b&&a.push(b)}for(var c=[],d=this.getTextField(),e=0,f=a.length;e<f;e++)b=a[e],c.push(b[d].replace(/<\/?.+?>/g,""));return c.join(",")}});mini.overwrite(mini.TreeGrid,{showSortIcon:!0,_setEditorBox:function(a,b){mini.DataGrid.prototype._setEditorBox.call(this,a,b)}});(function(a){var b=mini.TreeGrid.prototype._initEvents;mini.TreeGrid.prototype._initEvents=function(){b.call(this);var c=this;this.on("layout",function(){if(c.allowAlternating){var b=a(c._contentEl).find(".mini-grid-rows-content \x3e .mini-grid-table \x3e tbody");b.find("\x3e .mini-grid-row").each(function(b,c){1==b%2&&a(c).addClass("mini-grid-row-alt")});b.find("\x3e .mini-tree-nodes-tr").each(function(b,c){a(c).prev().addClass("mini-treegrid-expandRow")})}else a(c.el).find(".mini-grid-row-alt").removeClass("mini-grid-row-alt")})}})(jQuery);mini._ValidateVType=function(a,b,c,d){(-1<a.indexOf("int")||-1<a.indexOf("float"))&&-1==a.indexOf("range")&&(a+=";range:0,"+mini._maximumNumber);-1<a.indexOf("float")&&-1==a.indexOf("rangeLength")&&(a+=";rangeLength:0,16");-1<a.indexOf("decimalLength")&&-1==a.indexOf("range")&&(a+=";range:0,"+Math.floor(mini._maximumNumber/100));for(var e=a.split(";"),f=0,g=e.length;f<g;f++){a=e[f].trim();var k=a.split(":"),l=k[0];a=(a=a.substr(l.length+1,1E3))?a.split(","):[];if((l=mini.VTypes[l])&&!0!==l(b,a)){c.isValid=!1;b=k[0]+"ErrorText";c.errorText=d.validateErrorText||d[b]||mini.VTypes[b]||"";c.errorText=String.format(c.errorText,a[0],a[1],a[2],a[3],a[4]);break}}};mini._maximumNumber=999999999999999;jQuery.extend(mini.VTypes,{mobileErrorText:"\u8f93\u5165\u7684\u624b\u673a\u53f7\u7801\u683c\u5f0f\u4e0d\u6b63\u786e",telErrorText:"\u8f93\u5165\u7684\u56fa\u5b9a\u7535\u8bdd\u53f7\u7801\u683c\u5f0f\u4e0d\u6b63\u786e",phoneErrorText:"\u8f93\u5165\u7684\u7535\u8bdd\u53f7\u7801\u683c\u5f0f\u4e0d\u6b63\u786e",phoneWithShortNumErrorText:"\u8f93\u5165\u7684\u7535\u8bdd\u53f7\u7801\u683c\u5f0f\u4e0d\u6b63\u786e",postCodeErrorText:"\u8f93\u5165\u7684\u90ae\u653f\u7f16\u7801\u683c\u5f0f\u4e0d\u6b63\u786e",orgCodeErrorText:"\u8f93\u5165\u7684\u7ec4\u7ec7\u673a\u6784\u4ee3\u7801\u683c\u5f0f\u4e0d\u6b63\u786e",idCardErrorText:"\u8f93\u5165\u7684\u8eab\u4efd\u8bc1\u53f7\u7801\u683c\u5f0f\u4e0d\u6b63\u786e",decimalLengthErrorText:"\u8bf7\u8f93\u5165\u5c0f\u6570\uff0c\u4e14\u6700\u591a\u53ea\u80fd\u8f93\u5165{0}\u4f4d\u5c0f\u6570",projectCodeErrorText:"\u8f93\u5165\u7684\u6295\u8d44\u9879\u76ee\u7edf\u4e00\u4ee3\u7801\u683c\u5f0f\u4e0d\u6b63\u786e",decimalLength:function(a,b){if(0==mini.VTypes["float"](a,b))return!1;if(mini.isNull(a)||""===a)return!0;var c=parseInt(b);if(!a||isNaN(c))return!0;a=String(a);var d=a.split(".");return 1==d.length?!0:d[1].length<=c?!0:!1},mobile:function(a,b){return mini.isNull(a)||""===a?!0:/^1[3456789]\d{9}$/.test(a)},tel:function(a,b){return mini.isNull(a)||""===a?!0:/^0\d{2,3}-?\d{7,8}$/.test(a)||/^\(0\d{2,3}\)\d{7,8}$/.test(a)},phone:function(a,b){return mini.isNull(a)||""===a?!0:/^1[3456789]\d{9}$/.test(a)||/^0\d{2,3}-?\d{7,8}$/.test(a)||/^\(0\d{2,3}\)\d{7,8}$/.test(a)},phoneWithShortNum:function(a,b){return mini.isNull(a)||""===a?!0:/^\d[\d-]{2,10}(?!-)$/.test(a)},postCode:function(a,b){return mini.isNull(a)||""===a?!0:/^\d{6}$/.test(a)},orgCode:function(a,b){return mini.isNull(a)||""===a||/^[A-Z0-9]{8}-[A-Z0-9]$/.test(a)?!0:/^(?![IOSV])([0-9A-Y])([1239])([0-9]{6})(((?![IOSV])[0-9A-Y]){10})$/.test(a)?!0:!1},idCard:function(a,b){var c;if(mini.isNull(a)||""===a)c=!0;else if(/^(^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$)|(^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[Xx])$)$/.test(a))if(18==a.length){var d=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2];c=[1,0,10,9,8,7,6,5,4,3,2];for(var e=0,f=0;17>f;f++)e+=a.substring(f,f+1)*d[f];d=e%11;e=a.substring(17);c=2==d?"X"==e||"x"==e?!0:!1:e==c[d]?!0:!1}else c=void 0;else c=!1;return c},projectCode:function(a,b){return mini.isNull(a)||""===a?!0:/^(19|20)\d{2}-\d{6}-\d{2}-\d{2}-\d{6}$/.test(a)}});mini.overwrite(mini.Window,{showRefreshButton:!1,maskOnLoad:!1,_initButtons:function(){this.buttons=[];var a=this.createButton({name:"collapse",cls:"mini-tools-collapse",visible:this.showCollapseButton});this.buttons.push(a);a=this.createButton({name:"min",cls:"mini-tools-min",visible:this.showMinButton});this.buttons.push(a);a=this.createButton({name:"max",cls:"mini-tools-max",visible:this.showMaxButton});this.buttons.push(a);a=this.createButton({name:"refresh",cls:"mini-tools-refresh",visible:this.showRefreshButton});this.buttons.push(a);a=this.createButton({name:"close",cls:"mini-tools-close",visible:this.showCloseButton});this.buttons.push(a)},_OnButtonClick:function(a,b){var c=mini.Window.superclass._OnButtonClick.call(this,a,b);if(1==c.cancel)return c;"max"==c.name?"max"==this.state?this.restore():this.max():"refresh"==c.name?this.refresh():"close"==c.name&&this.fire("close");return c},refresh:function(){this.reload();return this},restore:function(){this.state="restore";this.show(this.x,this.y);var a=this.getButton("max");a&&(a.cls="mini-tools-max",this._doTools());this.fire("restore")},setShowRefreshButton:function(a){this.showRefreshButton=a;var b=this.getButton("refresh");b&&(b.visible=a,this._doTools())},getShowRefreshButton:function(){return this.showRefreshButton},doLayout:function(){if(this.canLayout()){if("max"==this.state){var a=this.getParentBox();this.el.style.left="10px";this.el.style.top="10px";mini.setSize(this.el,a.width-20,a.height-20)}mini.Window.superclass.doLayout.call(this);this.allowDrag&&mini.addClass(this.el,this._dragCls);"max"==this.state&&(this._resizeGridEl.style.display="none",mini.removeClass(this.el,this._dragCls));this._doModal()}},_doTitle:function(){var a=""==this.title?"\x26nbsp":this.title;this._titleEl.innerHTML=a;this._titleEl.title=a;this._iconEl.style.display=this.iconCls||this.iconStyle?"inline":"none";this._iconEl.className="mini-panel-icon mini-icon mini-iconfont "+this.iconCls;mini.setStyle(this._iconEl,this.iconStyle)},getExtraAttrs:function(a){var b={};mini._ParseString(a,b,["onrestore","onclose"]);mini._ParseBool(a,b,["showRefreshButton"])}});mini.overwrite(mini.MessageBox,{show:function(a){a=mini.copyTo({width:"360",height:"226",customCls:"",showModal:!0,timeout:0,minWidth:150,maxWidth:800,minHeight:50,maxHeight:350,showHeader:!0,title:"",titleIcon:"",iconCls:"",iconStyle:"",message:"",html:"",spaceStyle:"",showCloseButton:!0,buttons:null,buttonWidth:null,callback:null,showNoTipCheck:!1,clickNoTipCheck:!1},a);a.message=String(a.message);var b=a.callback,c=new mini.Window;a.customCls&&c.addCls(a.customCls);c.addCls("mini-messagebox");c.setBodyStyle("overflow:hidden");c.setShowModal(a.showModal);c.setTitle(a.title||"");c.setIconCls(a.titleIcon);c.setShowHeader(a.showHeader);c.setShowCloseButton(a.showCloseButton);var d=c.uid+"$table",e=c.uid+"$content",f='\x3ci class\x3d"mini-messagebox-icon mini-iconfont '+a.iconCls+'" style\x3d"'+a.iconStyle+'"\x3e\x3c/i\x3e\x3cp class\x3d"mini-messagebox-msg"\x3e'+(a.message||"")+"\x3c/p\x3e";c._bodyEl.innerHTML='\x3cdiv class\x3d"mini-messagebox-content"\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-messagebox-buttons"\x3e\x3c/div\x3e';var g=c._bodyEl.firstChild;a.html?"string"==typeof a.html?g.innerHTML=a.html:mini.isElement(a.html)&&g.appendChild(a.html):(g.innerHTML=f,c._content=g.lastChild);a.showNoTipCheck&&(f=c._bodyEl.lastChild,f.innerHTML='\x3clabel class\x3d"mini-messagebox-checkbox"\x3e\x3cinput type\x3d"checkbox"\x3e\u4e0d\u518d\u63d0\u793a\x3c/label\x3e',mini.on(f.firstChild,"click",function(){a.clickNoTipCheck&&a.clickNoTipCheck.apply(this,[this.firstChild.checked])}));c._Buttons=[];f=c._bodyEl.lastChild;if(a.buttons&&0<a.buttons.length)for(var k=0,l=a.buttons.length;k<l;k++){var n=a.buttons[k],p=mini.MessageBox.buttonText[n];p||(p=n);var q=new mini.Button;q.setText(p);q.setWidth(a.buttonWidth);q.render(f);q.action=n;q.on("click",function(a){a=a.sender;b&&!1===b(a.action)||mini.MessageBox.hide(c)});k!=l-1&&q.setStyle(a.spaceStyle);q.setCls("mini-messagebox-button");"ok"==n&&(q.setCls("ok"),q.setCls("mini-btn-primary"));c._Buttons.push(q)}else f.style.display="none";c.setMinWidth(a.minWidth);c.setMinHeight(a.minHeight);c.setMaxWidth(a.maxWidth);c.setMaxHeight(a.maxHeight);c.setWidth(a.width);c.setHeight(a.height);c.show(a.x,a.y,{animType:a.animType});k=c.getWidth();c.setWidth(k+"px");g=(g=$(g).outerHeight(!0))?g+($(c._headerEl).is(":visible")?$(c._headerEl).outerHeight(!0):0)+($(f).is(":visible")?$(f).outerHeight(!0):0):c.getHeight();c.setHeight(g+"px");if(d=document.getElementById(d))d.style.width="100%";if(e=document.getElementById(e))e.style.width="100%";mini.MessageBox.autoFocus&&((e=c._Buttons[0])?e.focus():c.focus());c.on("beforebuttonclick",function(a){b&&b("close");a.cancel=!0;mini.MessageBox.hide(c)});mini.on(c.el,"keydown",function(a){27==a.keyCode&&(b&&b("close"),mini.MessageBox.hide(c))});a.timeout&&setTimeout(function(){mini.MessageBox.hide(c.uid)},a.timeout);return c.uid},prompt:function(a,b,c,d){var e="prompt$"+(new Date).getTime();a=a||mini.MessageBox.promptMessage;b=mini.MessageBox.show({title:b||mini.MessageBox.promptTitle,buttons:["ok","cancel"],width:250,html:'\x3cdiv class\x3d"mini-messagebox-prompt" \x3e'+(d?'\x3clabel class\x3d"mini-prompt-label"\x3e'+a+'\x3c/label\x3e\x3ctextarea id\x3d"'+e+'" class\x3d"mini-prompt-input"\x3e\x3c/textarea\x3e':'\x3clabel class\x3d"mini-prompt-label"\x3e'+a+'\x3c/label\x3e\x3cinput type\x3d"text" id\x3d"'+e+'" class\x3d"mini-prompt-input"\x3e')+"\x3c/div\x3e",callback:function(a){var b=document.getElementById(e);if(c)return c(a,b.value)}});document.getElementById(e).focus();return b},confirm:function(a,b,c){return mini.MessageBox.show({minWidth:250,title:b||mini.MessageBox.confirmTitle,buttons:["cancel","ok"],message:a,iconCls:"mini-messagebox-question",callback:c})}});mini.prompt=mini.MessageBox.prompt;mini.showMessageBox=mini.MessageBox.show;mini.confirm=mini.MessageBox.confirm;mini.supportRem&&mini.overwrite(mini.Window,{setWidth:function(a){parseInt(a,10)==a&&(a=parseFloat(a/100/mini.getFontSizeRatio())+"rem");this.width=a;this.el.style.width=a;this._sizeChanged()},setHeight:function(a){parseInt(a,10)==a&&(a=parseFloat(a/100/mini.getFontSizeRatio())+"rem");this.height=a;this.el.style.height=a;this._sizeChanged()}});mini.CatalogImport=function(){mini.CatalogImport.superclass.constructor.call(this)};mini.extend(mini.CatalogImport,mini.Control,{uiCls:"mini-catalogimport",url:"",pickerText:"\u5bfc\u5165\u6587\u4ef6",_create:function(){this.el=document.createElement("div");this.uploader=new mini.WebUploader;this.uploader.set({uploadUrl:this.url,pickerText:this.pickerText,fileNumLimit:1,limitType:"xls,xlsx,xlsm",showDefaultUI:!1,auto:!1,renderTo:this.el});this.uploader.on("beforefilequeued",this._onBeforeFileQueued,this);this.uploader.on("filesqueued",this._onFilesQueued,this);this.uploader.on("uploadbeforesend",this._onUploadBeforeSend,this);this.uploader.on("uploadprogress",this._onUploadProgress,this);this.uploader.on("uploadsuccess",this._onUploadSuccess,this);this.uploader._uploadBtn.hide();this.fileList=document.createElement("div");this.fileList.className="mini-catalogimport-filelist";this.el.appendChild(this.fileList);this._bindEvent()},_bindEvent:function(){var a=this;jQuery(this.fileList).on("click",".catalogimport-delete",function(){$(this).closest(".mini-catalogimport-item").remove();a.uploader.clearFile()}).on("click",".catalogimport-export",function(){a.fire("exportresult",{attachGuid:a._curAttachGuid})})},_onFilesQueued:function(a){var b=a.files[0],c=this;b&&(a=this._generateFileList({id:b.id,name:b.name,size:b.size}),this.isImportFinished=!1,jQuery(a).appendTo(this.fileList),this.uploader._uploader.md5File(b).progress(function(a){}).then(function(a){c._curFileMD5=a;a={fileMD5:a,fileName:b.name,fileSize:b.size};a[c.uploader.id+"_action"]="queryFileStatus";c.uploader.getCommonData&&(a.commonDto=mini.encode(c.uploader.getCommonData()));c._onPostFileMd5(a);$.ajax(c.url,{dataType:"json",data:a,type:"post",success:function(a){mini.getSecondRequestData&&(a=mini.getSecondRequestData(a));c._onQueryFileStatus(a)}})}))},_onPostFileMd5:function(a){this.fire("postfilemd5",{data:a})},_curFileMD5:"",_curAttachGuid:"",_onQueryFileStatus:function(a){a.msg&&mini.alert(a.msg);this.setDetailStatus(a.detail);this._curAttachGuid=a.attachGuid;this._oldAttachGuid=a.attachGuidOld;a.end?this._onFinished(a.status):(a.pollingFrequency&&(this._pollingFrequency=a.pollingFrequency),"importStatus"==a.action?this.pollingStatus(a):"upload"==a.action?this.uploader._uploader.upload():jQuery(this.fileList).find(".mini-catalogimport-action").removeClass("hidden"))},_onUploadBeforeSend:function(a){this.isContinueImport&&(a.data.attachGuid=this._curAttachGuid);a.data.fileMD5=this._curFileMD5},_onUploadProgress:function(a){var b=a.percentage;a=mini.byId(a.file.id);var c=jQuery(".mini-catalogimport-progressbar",a);a=jQuery(".progress-text",c);c=jQuery(".progress-body",c);b=Math.round(100*b)+"%";a.text(b);c.width(b)},_generateFileList:function(a){var b=[];b.push('\x3cdiv class\x3d"mini-catalogimport-item" id\x3d"'+a.id+'"\x3e');b.push('\x3cspan class\x3d"mini-catalogimport-info"\x3e'+a.name+"\x3c/span\x3e");b.push('\x3cspan class\x3d"mini-catalogimport-size"\x3e('+this._getSize(a.size)+")\x3c/span\x3e");b.push('\x3cspan class\x3d"mini-catalogimport-action hidden"\x3e\x3ca href\x3d"javascript:void(0)" class\x3d"catalogimport-delete"\x3e\u5220\u9664\x3c/a\x3e\x3c/span\x3e');b.push('\x3cspan class\x3d"mini-catalogimport-status"\x3e\u6b63\u5728\u4e0a\u4f20\x3c/span\x3e');b.push('\x3cspan class\x3d"mini-catalogimport-progressbar"\x3e\x3cspan class\x3d"progress-text"\x3e0%\x3c/span\x3e\x3cdiv class\x3d"progress-body"\x3e\x3c/div\x3e\x3c/span\x3e');b.push("\x3c/div\x3e");return b.join("")},_onPollingStatus:function(a){if(a.status){var b=mini.byId(this._currentFileId),c=jQuery(".mini-catalogimport-status",b),b=jQuery(".mini-catalogimport-progressbar",b),d=jQuery(".progress-text",b),e=jQuery(".progress-body",b);c.text(a.status);0<=a.handlepercent?(a=a.handlepercent+"%",b.removeClass("hidden"),d.text(a),e.width(a)):b.addClass("hidden")}},_generateStatuslist:function(a){var b,c,d,e=!0,f=!0,g=['\x3cdiv class\x3d"catalogimport-status-item"\x3e'];g.push('\x3ch3 class\x3d"catalogimport-status-title"\x3e'+a.sheetName+"\x3c/h3\x3e");g.push('\x3ch4 class\x3d"catalogimport-status-type"\x3e\u6821\u9a8c\u7ed3\u679c\uff1a\x3c/h4\x3e');g.push('\x3cp class\x3d"catalogimport-status-count"\x3e\u603b\u8ba1\uff1a'+a.checkCount+"\u6761\uff0c\u6210\u529f\uff1a"+a.checkSuccessCount+"\uff0c\u5931\u8d25\uff1a"+a.checkErrorCount+"\u6761\u3002");if((d=a.checkMsg)&&(c=d.length)){g.push('\x3ca href\x3d"javascript:void(0);" class\x3d"catalogimport-status-toggle"\x3e\u5c55\u5f00\u8be6\u60c5\x3c/a\x3e\x3c/p\x3e');g.push('\x3cdiv class\x3d"catalogimport-status-detail"\x3e');for(b=0;b<c;b++)g.push("\x3cp\x3e"+d[b]+"\x3c/p\x3e");g.push("\x3c/div\x3e")}else e=!1;if(a.saveCount)if(e||(g.push("\x3c/p\x3e"),e=!0),g.push('\x3ch4 class\x3d"catalogimport-status-type"\x3e\u5bfc\u5165\u7ed3\u679c\uff1a\x3c/h4\x3e'),g.push('\x3cp class\x3d"catalogimport-status-count"\x3e\u603b\u8ba1\uff1a'+a.saveCount+"\u6761\uff0c\u6210\u529f\uff1a"+a.saveSuccessCount+"\uff0c\u5931\u8d25\uff1a"+a.saveErrorCount+"\u6761\u3002"),(d=a.saveMsg)&&(c=d.length)){g.push('\x3ca href\x3d"javascript:void(0);" class\x3d"catalogimport-status-toggle"\x3e\u5c55\u5f00\u8be6\u60c5\x3c/a\x3e\x3c/p\x3e');g.push('\x3cdiv class\x3d"catalogimport-status-detail"\x3e');for(b=0;b<c;b++)g.push("\x3cp\x3e"+d[b]+"\x3c/p\x3e");g.push("\x3c/div\x3e")}else f=!1;if((d=a.taskMsg)&&(c=d.length)){g.push('\x3ca href\x3d"javascript:void(0);" class\x3d"catalogimport-status-toggle"\x3e\u5c55\u5f00\u8be6\u60c5\x3c/a\x3e\x3c/p\x3e');g.push('\x3cdiv class\x3d"catalogimport-status-detail"\x3e');for(b=0;b<c;b++)g.push("\x3cp\x3e"+d[b]+"\x3c/p\x3e");g.push("\x3c/div\x3e")}else e&&f||g.push("\x3c/p\x3e");g.push("\x3c/div\x3e");return g.join("")},_getSize:function(a){a=parseInt(a);return 1048576<a?(a/1048576).toFixed(2)+"M":(a/1024).toFixed(2)+"K"},_pollingFrequency:1E3,_oldAttachGuid:"",_onUploadSuccess:function(a){var b=a.ret;a=a.file;mini.getSecondRequestData&&(b=mini.getSecondRequestData(b));b=b.data||b;b=b.extraDatas||b;this._pollingFrequency=b.pollingFrequency;if("importStatus"==b.action)this._curAttachGuid=b.attachGuid,this._oldAttachGuid=b.attachGuidOld,b.fileId=a.id,this.pollingStatus(b);else{var c=this;mini.alert("\u6570\u636e\u5bfc\u5165\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5\uff01","",function(){c._onFinished(b)})}},_onFinished:function(a){var b=a.status||"\u5bfc\u5165\u5df2\u5b8c\u6210",c=a.success;this.isImportFinished=!0;var d=mini.byId(this._currentFileId),e=jQuery(".mini-catalogimport-status",d),f=jQuery(".mini-catalogimport-progressbar",d),d=jQuery(".mini-catalogimport-action",d);e.text(b);f.addClass("hidden");c?setTimeout(function(){e.addClass("hidden")},1E3):(e.addClass("error"),e.append('\x3ca class\x3d"catalogimport-export"\x3e\u6821\u9a8c\u7ed3\u679c\u5bfc\u51fa\x3c/a\x3e'),d.removeClass("hidden"));this._events.importfinished&&this.fire("importfinished",a)},_onBeforeFileQueued:function(a){this._events.beforefilequeued&&this.fire("beforefilequeued",a)},_currentFileId:"",pollingStatus:function(a){a.fileId&&(this._currentFileId=a.fileId);this._onPollingStatus(a);var b=this;a={fileMD5:this._curFileMD5,attachGuid:this._curAttachGuid,attachGuidOld:this._oldAttachGuid};a[this.uploader.id+"_action"]="importStatus";this.uploader.getCommonData&&(a.commonDto=mini.encode(this.uploader.getCommonData()));jQuery.ajax({url:this.url,data:a,type:"POST",dataType:"json"}).done(function(a){mini.getSecondRequestData&&(a=mini.getSecondRequestData(a));a.msg&&mini.alert(a.msg);a.end?b._onFinished(a):setTimeout(jQuery.proxy(b.pollingStatus,b,a),b._pollingFrequency);b.setDetailStatus(a.detail)})},setDetailStatus:function(a){this.detailStatus=a;this.isDetailShow&&this.renderDetailStatus()},renderDetailStatus:function(){var a=this.detailStatus,b=[],c=0,d;if(a)for(d=a.length;c<d;c++)b.push(this._generateStatuslist(a[c]));this.detailContent.innerHTML=b.join("")},showDetailStatus:function(){this.renderDetailStatus();this.detailEl.style.display="block";this.isDetailShow=!0},hideDetailStatus:function(){this.detailEl.style.display="none";this.isDetailShow=!1},setUrl:function(a){this.url=a;this.uploader&&this.uploader.setUploadUrl(a)},getUrl:function(){return this.url},setPickerText:function(a){},setEnabled:function(a){mini.CatalogImport.superclass.setEnabled.call(this,a);this.uploader&&this.uploader.setEnabled(a)},getAttrs:function(a){var b=mini.CatalogImport.superclass.getAttrs.call(this,a);mini._ParseString(a,b,"url pickerText onbeforefilequeued onpostfilemd5 onimportfinished onexportresult".split(" "));return b}});mini.regClass(mini.CatalogImport,"catalogimport");!function(a){var b=function(a){this.value={h:1,s:1,b:1,a:1};this.setColor(a)};b.prototype={constructor:b,setColor:function(b){b=b.toLowerCase();var c=this;a.each(d.stringParsers,function(a,e){var f=e.re.exec(b),f=f&&e.parse(f),g=e.space||"rgba";if(f)return c.value="hsla"===g?d.RGBtoHSB.apply(null,d.HSLtoRGB.apply(null,f)):d.RGBtoHSB.apply(null,f),!1})},setHue:function(a){this.value.h=1-a},setSaturation:function(a){this.value.s=a},setLightness:function(a){this.value.b=1-a},setAlpha:function(a){this.value.a=parseInt(100*(1-a),10)/100},toRGB:function(a,b,c,d){a||(a=this.value.h,b=this.value.s,c=this.value.b);var e,f,g;a=360*a%360/60;g=c*b;b=g*(1-Math.abs(a%2-1));c=e=f=c-g;a=~~a;c+=[g,b,0,0,b,g][a];e+=[b,g,g,b,0,0][a];f+=[0,0,b,g,g,b][a];return{r:Math.round(255*c),g:Math.round(255*e),b:Math.round(255*f),a:d||this.value.a}},toHex:function(a,b,c,d){a=this.toRGB(a,b,c,d);return"#"+(16777216|parseInt(a.r)<<16|parseInt(a.g)<<8|parseInt(a.b)).toString(16).substr(1)},toHSL:function(a,b,c,d){a||(a=this.value.h,b=this.value.s,c=this.value.b);var e=(2-b)*c;b*=c;b=0<e&&1>=e?b/e:b/(2-e);1<b&&(b=1);return{h:a,s:b,l:e/2,a:d||this.value.a}}};var c=function(b,c){this.element=a(b);var e=c.format||this.element.data("color-format")||"hex";this.format=d.translateFormats[e];this.isInput=this.element.is("input");this.component=this.element.is(".color")?this.element.find(".add-on"):!1;this.picker=a(d.template).appendTo("body").on("mousedown",a.proxy(this.mousedown,this));if(this.isInput)this.element.on({focus:a.proxy(this.show,this),keyup:a.proxy(this.update,this)});else if(this.component)this.component.on({click:a.proxy(this.show,this)});else this.element.on({click:a.proxy(this.show,this)});if("rgba"===e||"hsla"===e)this.picker.addClass("alpha"),this.alpha=this.picker.find(".colorpicker-alpha")[0].style;this.component?(this.picker.find(".colorpicker-color").hide(),this.preview=this.element.find("i")[0].style):this.preview=this.picker.find("div:last")[0].style;this.base=this.picker.find("div:first")[0].style;this.update()};c.prototype={constructor:c,show:function(b){this.picker.show();this.height=this.component?this.component.outerHeight():this.element.outerHeight();this.place();a(window).on("resize",a.proxy(this.place,this));!this.isInput&&b&&(b.stopPropagation(),b.preventDefault());a(document).on({mousedown:a.proxy(this.hide,this)});this.element.trigger({type:"show",color:this.color})},update:function(){this.color=new b(this.isInput?this.element.prop("value"):this.element.data("color"));this.picker.find("i").eq(0).css({left:100*this.color.value.s,top:100-100*this.color.value.b}).end().eq(1).css("top",100*(1-this.color.value.h)).end().eq(2).css("top",100*(1-this.color.value.a));this.previewColor()},setValue:function(a){this.color=new b(a);this.picker.find("i").eq(0).css({left:100*this.color.value.s,top:100-100*this.color.value.b}).end().eq(1).css("top",100*(1-this.color.value.h)).end().eq(2).css("top",100*(1-this.color.value.a));this.previewColor();this.element.trigger({type:"changeColor",color:this.color})},hide:function(){this.picker.hide();a(window).off("resize",this.place);this.isInput?this.element.prop("value",this.format.call(this)):(a(document).off({mousedown:this.hide}),this.component&&this.element.find("input").prop("value",this.format.call(this)),this.element.data("color",this.format.call(this)));this.element.trigger({type:"hide",color:this.color})},place:function(){var a=this.component?this.component.offset():this.element.offset();this.picker.css({top:a.top+this.height,left:a.left})},previewColor:function(){try{this.preview.backgroundColor=this.format.call(this)}catch(e){this.preview.backgroundColor=this.color.toHex()}this.base.backgroundColor=this.color.toHex(this.color.value.h,1,1,1);this.alpha&&(this.alpha.backgroundColor=this.color.toHex())},pointer:null,slider:null,mousedown:function(b){b.stopPropagation();b.preventDefault();var c=a(b.target).closest("div");if(!c.is(".colorpicker")){if(c.is(".colorpicker-saturation"))this.slider=a.extend({},d.sliders.saturation);else if(c.is(".colorpicker-hue"))this.slider=a.extend({},d.sliders.hue);else if(c.is(".colorpicker-alpha"))this.slider=a.extend({},d.sliders.alpha);else return!1;var e=c.offset();this.slider.knob=c.find("i")[0].style;this.slider.left=b.pageX-e.left;this.slider.top=b.pageY-e.top;this.pointer={left:b.pageX,top:b.pageY};a(document).on({mousemove:a.proxy(this.mousemove,this),mouseup:a.proxy(this.mouseup,this)}).trigger("mousemove")}return!1},mousemove:function(a){a.stopPropagation();a.preventDefault();var b=Math.max(0,Math.min(this.slider.maxLeft,this.slider.left+((a.pageX||this.pointer.left)-this.pointer.left)));a=Math.max(0,Math.min(this.slider.maxTop,this.slider.top+((a.pageY||this.pointer.top)-this.pointer.top)));this.slider.knob.left=b+"px";this.slider.knob.top=a+"px";this.slider.callLeft&&this.color[this.slider.callLeft].call(this.color,b/100);this.slider.callTop&&this.color[this.slider.callTop].call(this.color,a/100);this.previewColor();this.element.trigger({type:"changeColor",color:this.color});return!1},mouseup:function(b){b.stopPropagation();b.preventDefault();a(document).off({mousemove:this.mousemove,mouseup:this.mouseup});return!1}};a.fn.colorpicker=function(b,d){return this.each(function(){var e=a(this),f=e.data("colorpicker"),l="object"===typeof b&&b;f||e.data("colorpicker",f=new c(this,a.extend({},a.fn.colorpicker.defaults,l)));if("string"===typeof b)f[b](d)})};a.fn.colorpicker.defaults={};a.fn.colorpicker.Constructor=c;var d={translateFormats:{rgb:function(){var a=this.color.toRGB();return"rgb("+a.r+","+a.g+","+a.b+")"},rgba:function(){var a=this.color.toRGB();return"rgba("+a.r+","+a.g+","+a.b+","+a.a+")"},hsl:function(){var a=this.color.toHSL();return"hsl("+Math.round(360*a.h)+","+Math.round(100*a.s)+"%,"+Math.round(100*a.l)+"%)"},hsla:function(){var a=this.color.toHSL();return"hsla("+Math.round(360*a.h)+","+Math.round(100*a.s)+"%,"+Math.round(100*a.l)+"%,"+a.a+")"},hex:function(){return this.color.toHex()}},sliders:{saturation:{maxLeft:100,maxTop:100,callLeft:"setSaturation",callTop:"setLightness"},hue:{maxLeft:0,maxTop:100,callLeft:!1,callTop:"setHue"},alpha:{maxLeft:0,maxTop:100,callLeft:!1,callTop:"setAlpha"}},RGBtoHSB:function(a,b,c,d){a/=255;b/=255;c/=255;var e,f;e=Math.max(a,b,c);f=e-Math.min(a,b,c);return{h:((0===f?null:e==a?(b-c)/f:e==b?(c-a)/f+2:(a-b)/f+4)+360)%6*60/360||1,s:0===f?0:f/e,b:e,a:d||1}},HueToRGB:function(a,b,c){0>c?c+=1:1<c&&--c;return 1>6*c?a+(b-a)*c*6:1>2*c?b:2>3*c?a+(b-a)*(2/3-c)*6:a},HSLtoRGB:function(a,b,c,k){0>b&&(b=0);b=.5>=c?c*(1+b):c+b-c*b;var e=2*c-b,f=a-1/3;c=Math.round(255*d.HueToRGB(e,b,a+1/3));a=Math.round(255*d.HueToRGB(e,b,a));b=Math.round(255*d.HueToRGB(e,b,f));return[c,a,b,k||1]},stringParsers:[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],a[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(a){return[a[1]/360,a[2]/100,a[3]/100,a[4]]}}],template:'\x3cdiv class\x3d"colorpicker dropdown-menu"\x3e\x3cdiv class\x3d"colorpicker-saturation"\x3e\x3ci\x3e\x3cb\x3e\x3c/b\x3e\x3c/i\x3e\x3c/div\x3e\x3cdiv class\x3d"colorpicker-hue"\x3e\x3ci\x3e\x3c/i\x3e\x3c/div\x3e\x3cdiv class\x3d"colorpicker-alpha"\x3e\x3ci\x3e\x3c/i\x3e\x3c/div\x3e\x3cdiv class\x3d"colorpicker-color"\x3e\x3cdiv /\x3e\x3c/div\x3e\x3c/div\x3e'}}(window.jQuery);mini.ColorPicker=function(){mini.ColorPicker.superclass.constructor.call(this)};mini.extend(mini.ColorPicker,mini.Control,{value:"#ff0000",format:"hex",allowInput:!1,uiCls:"mini-colorpicker",_clearBorder:!1,_create:function(){this.el=document.createElement("div");this.el.innerHTML='\x3cspan class\x3d"mini-colorpicker-indication"\x3e\x3ci\x3e\x3c/i\x3e\x3c/span\x3e';this._valueBox=new mini.TextBox;this._indication=this.el.lastChild.firstChild;this._valueBox.setValue(this.value);this.allowInput||this._valueBox.setAllowInput(!1);this._valueBox.render(this.el,"prepend");jQuery(this._indication).css("background",this.value);this.colorPicker=jQuery(this.el).attr("data-color",this.value).colorpicker({format:this.format})},_initEvents:function(){var a=this;this.colorPicker.on("changeColor",function(b){a.value=a._getValue(b.color);a._valueBox.setValue(a.value);jQuery(a._indication).css("background",a.value);a.fire("valuechanged",{sender:a,value:a.value,type:"valuechanged"})});this._valueBox.on("blur",function(b){a.colorPicker.colorpicker("setValue",a._valueBox.getValue())})},_getValue:function(a){var b="";switch(this.format){case "rgb":a=a.toRGB();b="rgb("+a.r+","+a.g+","+a.b+")";break;case "rgba":a=a.toRGB();b="rgba("+a.r+","+a.g+","+a.b+","+a.a+")";break;case "hsl":a=a.toHSL();b="hsl("+Math.round(360*a.h)+","+Math.round(100*a.s)+"%,"+Math.round(100*a.l)+"%)";break;case "hsla":a=a.toHSL();b="hsla("+Math.round(360*a.h)+","+Math.round(100*a.s)+"%,"+Math.round(100*a.l)+"%,"+a.a+")";break;case "hex":b=a.toHex()}return b},setValue:function(a){this.colorPicker.colorpicker("setValue",a)},getValue:function(){return this.value},setFormat:function(a){this.colorPicker.colorpicker({format:a});this.format=a;this.setValue(this.value)},getFormat:function(){return this.format},setAllowInput:function(a){this._valueBox.setAllowInput(a);this.allowInput=a},getAllowInput:function(){return this.allowInput},getAttrs:function(a){var b=mini.ColorPicker.superclass.getAttrs.call(this,a);mini._ParseString(a,b,["onvaluechanged","format"]);mini._ParseBool(a,b,["allowInput"]);return b}});mini.regClass(mini.ColorPicker,"colorpicker");mini.DataExport=function(){mini.DataExport.superclass.constructor.call(this)};mini.extend(mini.DataExport,mini.Control,{gridId:"",exportUrl:"",fileName:"",position:"right",uiCls:"mini-dataexport",columnsValue:"",columnsText:"",paramName:"exportParams",dynamicColumns:!1,expandText:"\u5173\u95ed\u5bfc\u51fa\u9762\u677f",collapseText:"\u6253\u5f00\u5bfc\u51fa\u9762\u677f",exportText:"\u5bfc \u51fa",leftListTitle:"\u5f85\u9009\u5217",rightListTitle:"\u5df2\u9009\u5217",fromText:"\u4ece\u7b2c",pageNumInfo:"\u9875\u5bfc\u51fa\u5230\u7b2c",pageText:"\u9875",_clearBorder:!1,_create:function(){this.button=new mini.Button;this.button.set({text:this.collapseText,iconCls:"icon-upload",disableMultiClick:!1});this.el=this.button.el;this.popup=new mini.Popup;this.panel=new mini.Panel;this.popup.addCls("mini-dataexport-popup");this.panel.addCls("mini-dataexport-panel");this.panel.set({width:450,showToolbar:!1,showFooter:!1,showHeader:!1});this.popup.render(document.body);this.panel.render(this.popup.el);var a=['\x3cdiv class\x3d"mini-export-list"\x3e\x3cdiv class\x3d"mini-export-left"\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-export-middle"\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-export-right"\x3e\x3c/div\x3e\x3c/div\x3e'];a.push('\x3cdiv class\x3d"mini-export-line"\x3e\x3cdiv id\x3d"'+this.id+'-rbl" class\x3d"mini-radiobuttonlist" repeatItems\x3d"1" repeatLayout\x3d"table" \x3e\x3c/div\x3e\x3c/div\x3e');a.push('\x3ca id\x3d"'+this.id+'-action" class\x3d"mini-button mini-btn-primary mini-export-btn"\x3e'+this.exportText+"\x3c/a\x3e");a.push('\x3cdiv style\x3d"display:none;"\x3e\x3c/div\x3e');this.panel.setBody(a.join(""));mini.parse(this.popup.el);this._panel=this.panel.el;this._exportBtn=mini.get(this.id+"-action",this._panel);a=this.panel.getBodyEl();this._listContent=a.firstChild;this._exportRbl=mini.get(this.id+"-rbl",this._panel);this._exportRbl.setData([{text:"\u4ec5\u5bfc\u51fa\u9009\u4e2d\u884c",id:"0"},{text:"\u5bfc\u51fa\u5168\u90e8",id:"1"},{text:"\u5bfc\u51fa\u5f53\u524d\u9875",id:"2"},{text:this.fromText+'\x3cinput type\x3d"text" class\x3d"mini-export-num" id\x3d"'+this.id+'-fromnum"/\x3e'+this.pageNumInfo+'\x3cinput type\x3d"text" class\x3d"mini-export-num" id\x3d"'+this.id+'-tonum"/\x3e'+this.pageText,id:"3"}]);this._radioTrs=this._exportRbl._innerEl.getElementsByTagName("tr");this._rowTr=this._radioTrs[0];this._curPageTr=this._radioTrs[2];this._pageTr=this._radioTrs[3];this._fromNumInput=mini.byId(this.id+"-fromnum",this._pageTr);this._toNumInput=mini.byId(this.id+"-tonum",this._pageTr);this._exportFormWrap=a.lastChild;this._exportFormWrap.innerHTML='\x3cform method\x3d"post" target\x3d"exportIFrame"\x3e\x3cinput type\x3d"hidden" name\x3d"'+this.paramName+'" /\x3e\x3c/form\x3e\x3ciframe id\x3d"exportIFrame" name\x3d"exportIFrame" style\x3d"display:none;"\x3e\x3c/iframe\x3e';this._exportForm=this._exportFormWrap.firstChild;this._exportFormField=this._exportForm.firstChild;this._exportIframe=this._exportFormWrap.lastChild;this._contentL=this._listContent.firstChild;this._contentM=this._listContent.childNodes[1];this._contentR=this._listContent.lastChild;this._contentL.innerHTML='\x3cdiv class\x3d"mini-export-list-header"\x3e'+this.leftListTitle+'\x3c/div\x3e\x3cdiv class\x3d"mini-export-list-content"\x3e\x3c/div\x3e';this._contentR.innerHTML='\x3cdiv class\x3d"mini-export-list-header"\x3e'+this.rightListTitle+'\x3c/div\x3e\x3cdiv class\x3d"mini-export-list-content"\x3e\x3c/div\x3e';this.leftListBox=new mini.ListBox;this.leftListBox.set({height:170,width:180,valueField:"field",showCheckBox:!0,multiSelect:!0});this.leftListBox.render(this._contentL.lastChild);this.rightListBox=new mini.ListBox;this.rightListBox.set({height:170,width:180,valueField:"field",showCheckBox:!1,multiSelect:!1});this.rightListBox.render(this._contentR.lastChild);this._initButtons()},_initEvents:function(){var a=this;this.button.on("click",function(){mini.hasClass(a.button.el,"mini-button-popup")?a.hidePanel():a.showPanel()});this._exportBtn.on("click",function(b){a._OnExport(b)});mini.on(this._fromNumInput,"blur",function(){if(a.dataGrid){var b=a.dataGrid.getPageIndex()+1,c=a.dataGrid.getTotalPage(),d=parseInt(a._toNumInput.value,10),e=parseInt(this.value,10);e?e>c&&(e=c):e=b;e>d&&(e=d);this.value=e}});mini.on(this._toNumInput,"blur",function(){if(a.dataGrid){a.dataGrid.getPageIndex();var b=a.dataGrid.getTotalPage(),c=parseInt(a._fromNumInput.value,10),d=parseInt(this.value,10);if(!d||d>b)d=b;d<c&&(d=c);this.value=d}});mini.on(document,"mouseup",this._OnDocMouseUp,this);mini.on(this._exportIframe,"load",function(){a.fire("exportsuccess")})},_getExportData:function(){var a={columns:this.rightListBox.data,fileName:this.fileName};a.fileName||window.console&&window.console.error&&console.error("\u672a\u6307\u5b9a\u5bfc\u51fa\u6587\u4ef6\u7684filename\uff0c\u5bfc\u51fa\u6587\u4ef6\u53ef\u80fd\u4e0d\u6b63\u5e38\uff01");if(this.gridId){this.dataGrid||(this.dataGrid=mini.get(this.gridId));var b=this._exportRbl.value,c=this.dataGrid.getPageSize(),d=this.dataGrid.getTotalCount(),e=this.dataGrid.getSortField(),f=this.dataGrid.getSortOrder(),g=this.dataGrid.getTotalPage()-1,k=0,l=0,n=this.dataGrid.getPageIndex();switch(b){case "0":l=k=n;a.idField=this.dataGrid.idField;a.checkedRows={};a.checkedRows[this.dataGrid.idField]=this._getSelectedGridIds();break;case "1":k=0;l=g;break;case "2":l=k=n;break;case "3":if(k=parseInt(this._fromNumInput.value,10)-1,l=parseInt(this._toNumInput.value)-1,mini.isNumber(k)||(k=n),!mini.isNumber(l)||l<k)l=g}mini.copyTo(a,{fromIndex:k,toIndex:l,pageSize:c,totalCount:d,sortField:e,sortOrder:f})}return a},_getSelectedGridIds:function(){var a=[],b=[],c=this.dataGrid.idField;this.dataGrid&&(b=this.dataGrid.getSelecteds());for(var d=0,e=b.length;d<e;d++)a.push(b[d][c]);return a.join(",")},_OnExport:function(a){var b=this._getExportData();a={htmlEvent:a,data:b};this.fire("beforeexport",a);this._exportFormField.value="string"==typeof a.data?a.data:mini.encode(a.data);this._exportForm.submit();this.hidePanel()},_OnDocMouseUp:function(a){mini.isAncestor(this.popup.el,a.target)||this.hidePanel()},_initButtons:function(){this._contentM.innerHTML='\x3cbutton class\x3d"mini-export-listbtn mini-icon right" type\x3d"button"\x3e\x3c/button\x3e\x3cbutton class\x3d"mini-export-listbtn mini-icon right-all" type\x3d"button"\x3e\x3c/button\x3e\x3cbutton class\x3d"mini-export-listbtn mini-icon left" type\x3d"button"\x3e\x3c/button\x3e\x3cbutton class\x3d"mini-export-listbtn mini-icon left-all" type\x3d"button"\x3e\x3c/button\x3e';var a=this;mini.on(this._contentM,"click",function(b){b=b.target;mini.hasClass(b,"right")?(b=a.leftListBox.getSelecteds(),a.leftListBox.removeItems(b),a.rightListBox.addItems(b)):mini.hasClass(b,"right-all")?(b=a.leftListBox.getData(),a.leftListBox.removeItems(b),a.rightListBox.addItems(b)):mini.hasClass(b,"left")?(b=a.rightListBox.getSelecteds(),a.rightListBox.removeItems(b),a.leftListBox.addItems(b)):mini.hasClass(b,"left-all")&&(b=a.rightListBox.getData(),a.rightListBox.removeItems(b),a.leftListBox.addItems(b))})},setExportUrl:function(a){this.exportUrl=a;this._exportForm.action=a},getExportUrl:function(){return this.exportUrl},getGridId:function(){return this.gridId},setGridId:function(a){this.gridId=a;this.dataGrid=mini.get(a)},showPanel:function(){this._adjustRadioLayout();this.button.setText(this.expandText);this.button.addCls("mini-button-popup");if(!this.isInit||this.dynamicColumns){var a=this.getColumns();"left"==this.position?(this.leftListBox.setData(a),this.rightListBox.setData([])):(this.rightListBox.setData(a),this.leftListBox.setData([]));this.isInit=!0}this.popup.showAtEl(this.el)},_adjustRadioLayout:function(){!this.dataGrid&&this.gridId&&(this.dataGrid=mini.get(this.gridId));this.dataGrid?(mini.removeClass(this._exportRbl.el,"hidden"),this.dataGrid.multiSelect&&this._getSelectedGridIds()?(mini.removeClass(this._rowTr,"hidden"),this._exportRbl.setValue("0")):(mini.addClass(this._rowTr,"hidden"),this._exportRbl.setValue("1"),this.dataGrid.showPager||(mini.addClass(this._curPageTr,"hidden"),mini.addClass(this._pageTr,"hidden")),this._fromNumInput.value=this.dataGrid.getPageIndex()+1)):mini.addClass(this._exportRbl.el,"hidden")},hidePanel:function(){this.button.removeCls("mini-button-popup");this.button.setText(this.collapseText);this.popup.hide()},getColumns:function(){var a=[];if(this.columnsData)a=this.columnsData;else if(this.columnsValue)for(var b=this.columnsValue.split(","),c=this.columnsText.split(","),d=b.length,e=0;e<d;e++)a.push({text:c[e]?c[e]:b[e],field:b[e]});else this.gridId&&(this.dataGrid||(this.dataGrid=mini.get(this.gridId)),a=this.dataGrid?this._getColumns(this.dataGrid.columns):[]);a={columns:a};this.fire("beforeupdatecolumn",a);return this.columnsData=a=a.columns},_getColumns:function(a){for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c];e.field?b.push({text:jQuery.trim(e.header),field:e.field}):e.columns&&(e=this._getColumns(e.columns),b=b.concat(e))}return b},setCollapseText:function(a){this.collapseText=a;this.button&&this.button.setText(a)},getFileName:function(){return this.fileName},setFileName:function(a){this.fileName=a},getAttrs:function(a){var b=mini.DataExport.superclass.getAttrs.call(this,a);mini._ParseString(a,b,"gridId exportUrl onbeforeexport fileName columnsText columnsValue position expandText collapseText onbeforeupdatecolumn onexportsuccess".split(" "));mini._ParseBool(a,b,["dynamicColumns"]);return b}});mini.regClass(mini.DataExport,"dataexport");mini.DataImport=function(){mini.DataImport.superclass.constructor.call(this)};mini.extend(mini.DataImport,mini.Control,{uiCls:"mini-dataimport",url:"",pickerText:"\u5bfc\u5165\u6587\u4ef6",_create:function(){this.el=document.createElement("div");this.uploader=new mini.WebUploader;this.uploader.set({uploadUrl:this.url,pickerText:this.pickerText,fileNumLimit:1,limitType:"xls,xlsx,xlsm",showDefaultUI:!1,auto:!1,renderTo:this.el});this.uploader.on("beforefilequeued",this._onBeforeFileQueued,this);this.uploader.on("filesqueued",this._onFilesQueued,this);this.uploader.on("uploadbeforesend",this._onUploadBeforeSend,this);this.uploader.on("uploadprogress",this._onUploadProgress,this);this.uploader.on("uploadsuccess",this._onUploadSuccess,this);this.uploader._uploadBtn.hide();this.maskEl=document.createElement("div");this.maskEl.className="mini-dataimport-mask";this.maskEl.innerHTML='\x3cdiv class\x3d"mini-dataimport-mask-content"\x3e\x3c/div\x3e';this.maskContent=this.maskEl.firstChild;document.body.appendChild(this.maskEl);this.detailEl=document.createElement("div");this.detailEl.className="mini-dataimport-detail";this.detailEl.innerHTML='\x3cdiv class\x3d"mini-dataimport-detail-content"\x3e\x3c/div\x3e\x3ci class\x3d"dataimport-detail-close"\x3eX\x3c/i\x3e';this.detailContent=this.detailEl.firstChild;document.body.appendChild(this.detailEl);this._bindEvent()},_bindEvent:function(){var a=this;jQuery(this.maskEl).on("click",".dataimport-showdetail",function(){a.showDetailStatus();return!1}).on("click",".dataimport-continue",function(){a.isContinueImport=!0;a.uploader._uploader.upload()}).on("click",".dataimport-restart",function(){a.uploader._uploader.upload()}).on("click",function(){a.isImportFinished&&!a.isDetailShow&&(a.maskEl.style.display="none")});jQuery(this.detailEl).on("click",".dataimport-detail-close",function(){a.hideDetailStatus()}).on("click",".dataimport-status-toggle",function(){var a=$(this),c=a.parent();c.hasClass("opened")?(a.text("\u5c55\u5f00\u8be6\u60c5"),c.removeClass("opened")):(a.text("\u6536\u8d77\u8be6\u60c5"),c.addClass("opened"))})},_onFilesQueued:function(a){var b=a.files[0],c=this;b&&(a=this._generateFileList({id:b.id,name:b.name,size:b.size}),this.isImportFinished=!1,this.maskContent.innerHTML=a,this.maskEl.style.display="block",this.uploader._uploader.md5File(b).progress(function(a){}).then(function(a){c._curFileMD5=a;a={fileMD5:a,fileName:b.name,fileSize:b.size};a[c.uploader.id+"_action"]="queryFileStatus";c.uploader.getCommonData&&(a.commonDto=mini.encode(c.uploader.getCommonData()));c._onPostFileMd5(a);$.ajax(c.url,{dataType:"json",data:a,type:"post",success:function(a){mini.getSecondRequestData&&(a=mini.getSecondRequestData(a));c._onQueryFileStatus(a)}})}))},_onPostFileMd5:function(a){this.fire("postfilemd5",{data:a})},_curFileMD5:"",_curAttachGuid:"",_onQueryFileStatus:function(a){a.msg&&mini.alert(a.msg);this.setDetailStatus(a.detail);this._curAttachGuid=a.attachGuid;this._oldAttachGuid=a.attachGuidOld;a.end?this._onFinished(a.status):(a.pollingFrequency&&(this._pollingFrequency=a.pollingFrequency),"importStatus"==a.action?this.pollingStatus(a):"upload"==a.action?this.uploader._uploader.upload():jQuery(this.maskContent).find(".mini-dataimport-action").removeClass("hidden"))},_onUploadBeforeSend:function(a){this.isContinueImport&&(a.data.attachGuid=this._curAttachGuid);a.data.fileMD5=this._curFileMD5},_onUploadProgress:function(a){var b=a.percentage;a=mini.byId(a.file.id);var c=jQuery(".mini-dataimport-progressbar",a);a=jQuery(".progress-text",c);c=jQuery(".progress-body",c);b=Math.round(100*b)+"%";a.text(b);c.width(b)},_generateFileList:function(a){var b=[];b.push('\x3cdiv class\x3d"mini-dataimport-item"\x3e');b.push('\x3cspan class\x3d"mini-dataimport-info"\x3e'+a.name+"\x3c/span\x3e");b.push('\x3cspan class\x3d"mini-dataimport-size"\x3e('+this._getSize(a.size)+")\x3c/span\x3e");b.push('\x3cspan class\x3d"mini-dataimport-progressbar"\x3e\x3cspan class\x3d"progress-text"\x3e0%\x3c/span\x3e\x3cdiv class\x3d"progress-body"\x3e\x3c/div\x3e\x3c/span\x3e');b.push('\x3cspan class\x3d"mini-dataimport-action hidden"\x3e\x3ca href\x3d"javascript:void(0)" class\x3d"dataimport-continue" title\x3d"\u4e0a\u6b21\u5bfc\u5165\u4e2d\u65ad\uff0c\u4fee\u6539\u5b8c\u540e\u7ee7\u7eed\u5bfc\u5165"\x3e\u7ee7\u7eed\u5bfc\u5165\x3c/a\x3e\x3ca href\x3d"javascript:void(0)" class\x3d"dataimport-restart" title\x3d"\u91cd\u65b0\u5c1d\u8bd5\u5bfc\u5165\u8fd9\u4e2a\u6587\u4ef6"\x3e\u91cd\u65b0\u5bfc\u5165\x3c/a\x3e\x3ca href\x3d"javascript:void(0)" class\x3d"dataimport-showdetail hidden"\x3e\u67e5\u770b\u8be6\u60c5\x3c/a\x3e\x3c/span\x3e');b.push("\x3c/div\x3e");return b.join("")},_generateImportStatus:function(a){var b=[];b.push('\x3cdiv class\x3d"mini-dataimport-item"\x3e');b.push('\x3cspan class\x3d"mini-dataimport-info"\x3e'+(a.status||"")+"\x3c/span\x3e");0<=a.handlepercent&&b.push('\x3cspan class\x3d"mini-dataimport-progressbar"\x3e\x3cspan class\x3d"progress-text"\x3e'+a.handlepercent+'%\x3c/span\x3e\x3cdiv class\x3d"progress-body" style\x3d"width:'+a.handlepercent+'%;"\x3e\x3c/div\x3e\x3c/span\x3e');a.end&&b.push('\x3cspan class\x3d"mini-dataimport-action"\x3e\x3ca href\x3d"javascript:void(0)" class\x3d"dataimport-showdetail"\x3e\u67e5\u770b\u8be6\u60c5\x3c/a\x3e\x3c/span\x3e');b.push("\x3c/div\x3e");return b.join("")},_generateStatuslist:function(a){var b,c,d,e=!0,f=!0,g=['\x3cdiv class\x3d"dataimport-status-item"\x3e'];g.push('\x3ch3 class\x3d"dataimport-status-title"\x3e'+a.sheetName+"\x3c/h3\x3e");g.push('\x3ch4 class\x3d"dataimport-status-type"\x3e\u6821\u9a8c\u7ed3\u679c\uff1a\x3c/h4\x3e');g.push('\x3cp class\x3d"dataimport-status-count"\x3e\u603b\u8ba1\uff1a'+a.checkCount+"\u6761\uff0c\u6210\u529f\uff1a"+a.checkSuccessCount+"\uff0c\u5931\u8d25\uff1a"+a.checkErrorCount+"\u6761\u3002");if((d=a.checkMsg)&&(c=d.length)){g.push('\x3ca href\x3d"javascript:void(0);" class\x3d"dataimport-status-toggle"\x3e\u5c55\u5f00\u8be6\u60c5\x3c/a\x3e\x3c/p\x3e');g.push('\x3cdiv class\x3d"dataimport-status-detail"\x3e');for(b=0;b<c;b++)g.push("\x3cp\x3e"+d[b]+"\x3c/p\x3e");g.push("\x3c/div\x3e")}else e=!1;if(a.saveCount)if(e||(g.push("\x3c/p\x3e"),e=!0),g.push('\x3ch4 class\x3d"dataimport-status-type"\x3e\u5bfc\u5165\u7ed3\u679c\uff1a\x3c/h4\x3e'),g.push('\x3cp class\x3d"dataimport-status-count"\x3e\u603b\u8ba1\uff1a'+a.saveCount+"\u6761\uff0c\u6210\u529f\uff1a"+a.saveSuccessCount+"\uff0c\u5931\u8d25\uff1a"+a.saveErrorCount+"\u6761\u3002"),(d=a.saveMsg)&&(c=d.length)){g.push('\x3ca href\x3d"javascript:void(0);" class\x3d"dataimport-status-toggle"\x3e\u5c55\u5f00\u8be6\u60c5\x3c/a\x3e\x3c/p\x3e');g.push('\x3cdiv class\x3d"dataimport-status-detail"\x3e');for(b=0;b<c;b++)g.push("\x3cp\x3e"+d[b]+"\x3c/p\x3e");g.push("\x3c/div\x3e")}else f=!1;if((d=a.taskMsg)&&(c=d.length)){g.push('\x3ca href\x3d"javascript:void(0);" class\x3d"dataimport-status-toggle"\x3e\u5c55\u5f00\u8be6\u60c5\x3c/a\x3e\x3c/p\x3e');g.push('\x3cdiv class\x3d"dataimport-status-detail"\x3e');for(b=0;b<c;b++)g.push("\x3cp\x3e"+d[b]+"\x3c/p\x3e");g.push("\x3c/div\x3e")}else e&&f||g.push("\x3c/p\x3e");g.push("\x3c/div\x3e");return g.join("")},_getSize:function(a){a=parseInt(a);return 1048576<a?(a/1048576).toFixed(2)+"M":(a/1024).toFixed(2)+"K"},_pollingFrequency:1E3,_oldAttachGuid:"",_onUploadSuccess:function(a){var b=a.ret;mini.getSecondRequestData&&(b=mini.getSecondRequestData(b));b=b.data||b;b=b.extraDatas||b;this._pollingFrequency=b.pollingFrequency;if("importStatus"==b.action)this._curAttachGuid=b.attachGuid,this._oldAttachGuid=b.attachGuidOld,this.pollingStatus(b);else{var c=this;mini.alert("\u6570\u636e\u5bfc\u5165\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5\uff01","",function(){c._onFinished(b.status);c.maskEl.style.display="none"})}},_onFinished:function(a){this.isImportFinished=!0;this.maskContent.innerHTML=(a||"\u5bfc\u5165\u5df2\u5b8c\u6210")+'\x3ca href\x3d"javascript:void(0);" class\x3d"dataimport-showdetail"\x3e\u67e5\u770b\u8be6\u60c5\x3c/a\x3e';this._events.importfinished&&this.fire("importfinished");this.uploader.clearFile()},_onBeforeFileQueued:function(a){this._events.beforefilequeued&&this.fire("beforefilequeued",a)},pollingStatus:function(a){this.maskContent.innerHTML=this._generateImportStatus(a);var b=this;a={fileMD5:this._curFileMD5,attachGuid:this._curAttachGuid,attachGuidOld:this._oldAttachGuid};a[this.uploader.id+"_action"]="importStatus";this.uploader.getCommonData&&(a.commonDto=mini.encode(this.uploader.getCommonData()));jQuery.ajax({url:this.url,data:a,type:"POST",dataType:"json"}).done(function(a){mini.getSecondRequestData&&(a=mini.getSecondRequestData(a));a.msg&&mini.alert(a.msg);a.end?b._onFinished(a.status):setTimeout(jQuery.proxy(b.pollingStatus,b,a),b._pollingFrequency);b.setDetailStatus(a.detail)})},setDetailStatus:function(a){this.detailStatus=a;this.isDetailShow&&this.renderDetailStatus()},renderDetailStatus:function(){var a=this.detailStatus,b=[],c=0,d;if(a)for(d=a.length;c<d;c++)b.push(this._generateStatuslist(a[c]));this.detailContent.innerHTML=b.join("")},showDetailStatus:function(){this.renderDetailStatus();this.detailEl.style.display="block";this.isDetailShow=!0},hideDetailStatus:function(){this.detailEl.style.display="none";this.isDetailShow=!1},setUrl:function(a){this.url=a;this.uploader&&this.uploader.setUploadUrl(a)},getUrl:function(){return this.url},setPickerText:function(a){},setEnabled:function(a){mini.CatalogImport.superclass.setEnabled.call(this,a);this.uploader&&this.uploader.setEnabled(a)},getAttrs:function(a){var b=mini.DataImport.superclass.getAttrs.call(this,a);mini._ParseString(a,b,["url","pickerText","onbeforefilequeued","onpostfilemd5","onimportfinished"]);return b}});mini.regClass(mini.DataImport,"dataimport");mini.DateRangePicker=function(){mini.DateRangePicker.superclass.constructor.call(this)};mini.extend(mini.DateRangePicker,mini.ValidatorBase,{uiCls:"mini-daterangepicker",allowInput:!0,rangeType:"date",format:"yyyy-MM-dd",delimiter:"~",minDate:null,maxDate:null,set:function(a){if("string"==typeof a)return this;var b=a.rangeType;delete a.rangeType;var c=a.format;delete a.format;mini.DateRangePicker.superclass.set.call(this,a);mini.isNull(b)||this.setRangeType(b);mini.isNull(c)||this.setFormat(c);return this},_create:function(){this.el=document.createElement("div");this.el.className="mini-daterangepicker";this._buttonEdit=new mini.ButtonEdit;this._buttonEdit.render(this.el);var a=this;this._buttonEdit.set({allowInput:!1,width:"100%",onbuttonclick:function(b){b.htmlEvent.stopPropagation();jQuery(a._inputEl).trigger("click")},onblur:function(b){a.isEditable()&&a._tryValidate()}});this._borderEl=this.el.firstChild;this._inputEl=this._buttonEdit._textEl;this.externalSrc=this.externalSrc||mini.externalSrc;window.laydate?this._init():mini.loadJS(this.externalSrc+"laydate/laydate.js",function(){a._init()})},_fixedHoverScroller:function(){var a=mini._scrollBarWidth;a&&!$("#fixed-hover-scroller-for-daterange").length&&$("\x3cstyle\x3e\x3c/style\x3e",{id:"fixed-hover-scroller-for-daterange",text:[".laydate-time-list li ol {","margin-right: "+a+"px}",".laydate-time-list\x3eli:hover ol{margin-right:0;}"].join("")}).appendTo("head")},_fixedTimeScrollPos:function(){function a(a){var c=$(a.target||a.srcElement);c.closest(".laydate-time-list \x3e li li").length&&b(function(){var a=c.position().top,b=c.outerHeight(!0),d=c.parent(),k=d[0].offsetHeight;0<a&&a<k-b||(d[0].scrollTop+=a)})}var b=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.setTimeout;return document.addEventListener?function(){document.removeEventListener("click",a,!0);document.addEventListener("click",a,!0)}:function(){}}(),_init:function(){var a=this,b={elem:this._inputEl,range:this.delimiter,format:this._translateToLaydateFormat(this.format),type:this.rangeType,readOnly:this.readOnly,enabled:this.enabled,trigger:"click",done:function(b,d,e){a.setValue({startDate:a._formatDate(d),endDate:a._formatDate(e)});a._tryValidate()}};this.minDate&&(b.min=mini.formatDate(this.minDate,"yyyy-MM-dd HH:mm:ss"));this.maxDate&&(b.max=mini.formatDate(this.maxDate,"yyyy-MM-dd HH:mm:ss"));this.laydate=laydate.render(b);this._fixedHoverScroller();this._fixedTimeScrollPos()},_formatDate:function(a){var b;if(!(b=!a))a:{for(var c in a){b=!1;break a}b=!0}if(b)return"";b=this.format.replace(/yyyy/g,a.year);b=b.replace(/yy/g,(a.year+"").substring(2));b=b.replace(/MM/g,10>a.month?"0"+a.month:a.month);b=b.replace(/M/g,a.month);b=b.replace(/dd/g,10>a.date?"0"+a.date:a.date);b=b.replace(/d/g,a.date);b=b.replace(/HH/g,10>a.hours?"0"+a.hours:a.hours);b=b.replace(/H/g,a.hours);b=b.replace(/mm/g,10>a.minutes?"0"+a.minutes:a.minutes);b=b.replace(/m/g,a.minutes);b=b.replace(/ss/g,10>a.seconds?"0"+a.seconds:a.seconds);return b=b.replace(/s/g,a.seconds)},setFormat:function(a){this.format=a;this.laydate&&(this.laydate.config.format=this._translateToLaydateFormat(a))},_translateToLaydateFormat:function(a){return a.replace(/(y)\1{1}/g,function(a,c,d,e){return"y"==e.charAt(d-1)||"y"==e.charAt(d+2)?"yy":"y"})},setMinDate:function(a){this.minDate=mini.parseDate(a);this.laydate&&(this.laydate.config.min=mini.formatDate(this.minDate,"yyyy-MM-dd HH:mm:ss"))},setMaxDate:function(a){this.maxDate=mini.parseDate(a);this.laydate&&(this.laydate.config.min=mini.formatDate(this.maxDate,"yyyy-MM-dd HH:mm:ss"))},setRangeType:function(a){this.rangeType=a;this.laydate&&(this.laydate.config.type=a);"datetime"==a&&(this.format="yyyy-MM-dd HH:mm:ss")},_oldValue:{startDate:"",endDate:""},value:{startDate:"",endDate:""},setValue:function(a){a.startDate&&a.endDate?(this.value={startDate:a.startDate,endDate:a.endDate},this._inputEl.value=a.startDate+" "+this.delimiter+" "+a.endDate):(this.value={startDate:"",endDate:""},this._inputEl.value="");if(this.value.startDate!=this._oldValue.startDate||this.value.endDate!=this._oldValue.endDate)this.fire("valuechanged",{value:this.value,oldValue:this._oldValue}),this._oldValue=this.value},setReadOnly:function(a){mini.DateRangePicker.superclass.setReadOnly.call(this,a);this._buttonEdit.setReadOnly(a);this.laydate&&(this.laydate.config.readOnly=a)},setEnabled:function(a){mini.DateRangePicker.superclass.setEnabled.call(this,a);this.laydate&&(this.laydate.config.enabled=a)},validate:function(){var a={value:this.getValue(),errorText:"",isValid:!0};!this.required||""!==String(a.value.startDate).trim()&&""!==String(a.value.endDate).trim()||(a.isValid=!1,a.errorText=this.requiredErrorText);this.fire("validation",a);this.errorText=a.errorText;this.setIsValid(a.isValid);return this.isValid()},setEmptyText:function(a){this.emptyText!=a&&(this.emptyText=a,this._buttonEdit.setEmptyText(a))},getEmptyText:function(){return this.emptyText},_errorIconEl:null,getErrorIconEl:function(){this._errorIconEl||(this._errorIconEl=mini.append(this.el,'\x3cspan class\x3d"mini-errorIcon"\x3e\x3c/span\x3e'));return this._errorIconEl},_RemoveErrorIcon:function(){this._errorIconEl&&jQuery(this._errorIconEl).remove();this._errorIconEl=null},getAttrs:function(a){var b=mini.DateRangePicker.superclass.getAttrs.call(this,a);mini._ParseString(a,b,"rangeType format minDate maxDate onvaluechanged emptyText".split(" "));return b}});mini.regClass(mini.DateRangePicker,"daterangepicker");mini.FilterTree=function(){mini.FilterTree.superclass.constructor.call(this);this.initComponents();this.bindEvents()};mini.extend(mini.FilterTree,mini.Tree,{filterMode:"client",filterUrl:"",height:"100%",emptyText:"\u8bf7\u8f93\u5165\u5185\u5bb9\u67e5\u8be2",uiCls:"mini-filtertree",initComponents:function(){this.set({showToolbar:!0,toolbar:'\x3cinput name\x3d"filterInput" class\x3d"mini-buttonedit mini-filtertree-filter" emptyText\x3d"'+this.emptyText+'" /\x3e'})},_filterKey:"",bindEvents:function(){var a=this;this._filterInput=mini.getbyName("filterInput",this);this._filterInput.on("keyup",function(b){13==b.htmlEvent.keyCode&&(b=a._filterInput.value,a._doFilter(b))});this._filterInput.on("buttonclick",function(){a._doFilter(a._filterInput.value)});this.on("load",function(a){var b=a.data;a.xhr&&"client"===this.filterMode&&(this._initialData=mini.clone(b))})},setData:function(a){mini.FilterTree.superclass.setData.call(this,a);"client"===this.filterMode&&(this._initialData=mini.clone(a))},_doFilter:function(a){var b=this;b._filterKey=a;if("server"==b.filterMode){var c={data:{search_condition:a},url:b.getFilterUrl(),sender:b};b.fire("beforeload",c);jQuery.ajax({url:c.url,data:c.data,type:"post",success:function(a,e,f){a&&"null"!=a||(a="{ tatal: 0, data: [] }");delete c.params;e={text:a,result:null,sender:b,options:c,xhr:f};f=null;try{mini_doload(e),(f=e.result)||(f=mini.decode(a))}catch(g){1==mini_debugger&&alert(url+"\n json is error.")}mini.isArray(f)&&(f={data:f});b.dataField&&(f.data=mini._getMap(b.dataField,f));f.data||(f.data=[]);a={data:f.data,cancel:!1,result:f};b.fire("preload",a);1!=a.cancel&&(b.resultAsTree?b.loadData(a.data):b.loadList(a.data),b.fire("filter"),b.expandAll())}})}else""===a?(b.clearFilter(),b._initialData&&b.setData(b._initialData)):(a=a.toLowerCase(),b.filter(function(b){if(-1!=(b.text?b.text.toLowerCase():"").indexOf(a))return!0}),b.expandAll())},_OnCellClick:function(a){if(!mini.findParent(a.htmlEvent.target,this._eciconCls)){var b,c;if(this._filterKey&&(b=a.record[this.nodesField]))for(var d=0,e=b.length;d<e;d++)c=b[d][this.textField],b[d][this.textField]=c.replace(/<\/?.+?>/g,"");mini.findParent(a.htmlEvent.target,"mini-tree-checkbox")||this.checkOnTextClick?this._tryToggleCheckNode(a.record):this.fire("cellclick",a)}},_OnDrawCell:function(a,b,c,d){c=mini.TreeGrid.superclass._OnDrawCell.call(this,a,b,c,d);this._treeColumn&&this._treeColumn==b.name&&(d=c.node,!1===d.ckr&&(c.showCheckBox=!1,c.showRadioButton=!1),this._filterKey&&(a=a[b.field],/<[^>]+>/.test(a)||(c.nodeHtml=a.replace(new RegExp(this._filterKey,"gi"),'\x3cspan class\x3d"mini-highlight"\x3e'+this._filterKey+"\x3c/span\x3e"))),this.fire("drawnode",c),c.nodeStyle&&(c.cellStyle=c.nodeStyle),c.nodeCls&&(c.cellCls=c.nodeCls),c.nodeHtml?c.cellHtml=c.nodeHtml:d.textCls&&(c.cellHtml='\x3cspan class\x3d"'+d.textCls+'"\x3e'+c.cellHtml+"\x3c/span\x3e"),this._createTreeColumn(c));return c},getFilterUrl:function(){return this.filterUrl||this.url},setFilterUrl:function(a){this.filterUrl=a},getFilterMode:function(){return this.filterMode},setFilterMode:function(a){this.filterMode=a},setEmptyText:function(a){this.emptyText!=a&&(this._filterInput.emptyText=this.emptyText=a,this._filterInput._doEmpty())},getEmptyText:function(){return this.emptyText},getAttrs:function(a){var b=mini.FilterTree.superclass.getAttrs.call(this,a);mini._ParseString(a,b,["filterMode","filterUrl","emptyText"]);b.filterUrl||(b.filterUrl=b.url);return b}});mini.regClass(mini.FilterTree,"filtertree");mini.ImageUploader=function(){mini.ImageUploader.superclass.constructor.call(this)};var sourceLoader=function(a){$.Deferred()};mini.extend(mini.ImageUploader,mini.Control,{uiCls:"mini-imageuploader",_FILE_ITEM_TPL:'\x3cdiv class\x3d"{{cls}}" data-id\x3d"{{id}}" data-guid\x3d"{{fileGuid}}" data-url\x3d"{{downloadUrl}}"\x3e\r\n        \x3cimg class\x3d"mini-imageuploader-img" src\x3d"{{downloadUrl}}" /\x3e\r\n        \x3cspan class\x3d"mini-imageuploader-edit"\x3e\u7f16\u8f91\u56fe\u7247\x3c/span\x3e\r\n        \x3cspan class\x3d"mini-imageuploader-remove action-icon icon-remove"\x3e\x3c/span\x3e\r\n    \x3c/div\x3e',_cropperOptions:{dragMode:"move",aspectRatio:NaN,cropBoxResizable:!0,viewMode:2,zoomOnWheel:!0,autoCropArea:.9,preview:".image-preview",crop:function(){}},set:function(a){if("string"==typeof a)return this;a.cropperOption&&(this._cropperOptions=$.extend({},this._cropperOptions,mini.decode(a.cropperOption)),delete a.cropperOption);mini.ImageUploader.superclass.set.call(this,a);return this},_create:function(){this.externalSrc=this.externalSrc||mini.externalSrc;this.__instanceIndex?this.__instanceIndex++:this.__instanceIndex=1;var a=this.uiCls;this.el=document.createElement("div");this.el.className="clearfix";this._FILE_EL_ID=a+"-file-select-"+this.__instanceIndex;this.el.innerHTML=['\x3cinput id\x3d"'+this._FILE_EL_ID+'" style\x3d"display:block;" type\x3d"file" accept\x3d"image/*"\x3e','\x3cdiv class\x3d"'+a+'-uploader-btn mini-imageuploader-add"\x3e','\x3clabel for\x3d"'+this._FILE_EL_ID+'"\x3e','\x3cspan class\x3d"'+a+'-upload-icon action-icon icon-remove" style\x3d"transform:rotate(45deg)"\x3e\x3c/span\x3e','\x3cspan class\x3d"'+a+'-upload-text"\x3e\u4e0a\u4f20\u6587\u4ef6\x3c/span\x3e',"\x3c/label\x3e\x3c/div\x3e",'\x3cdiv class\x3d"'+a+'-list clearfix"\x3e\x3c/div\x3e'].join("");this.$fileList=$(this.el).find("."+a+"-list")},_afterApply:function(){this._initEvent();this._createImageCropper()},_genderItem:function(a){a=$.extend({cls:this.uiCls+"-item"},a);a.downloadUrl=(window._rootPath||"")+"/"+a.downloadUrl;window.Mustache||mini.loadJS(mini.externalSrc+"mustache.min.js");return Mustache.render(this._FILE_ITEM_TPL,a)},_addFileItem:function(a){return $(this._genderItem(a)).appendTo(this.$fileList)},setData:function(a){if("array"!=!$.type(a)){this.data=a;this.$fileList.empty();var b=this;$.each(a,function(a,d){b._addFileItem(d)})}},getData:function(){return this.data||[]},_initEvent:function(){var a="."+this.uiCls,b=this;$(this.el).on("click",a+"-uploader-btn",function(a){}).on("click",a+"-edit",function(c){c=$(this).closest(a+"-item");b.imageCropper.show(c.data("url"),c.data("guid"))}).on("click",a+"-remove",function(c){var d=$(this).closest(a+"-item");c=d.data("id");var e=d.data("guid");console.log({id:c,guid:e});mini.confirm("\u786e\u5b9a\u5220\u9664\u6b64\u6b21\u6587\u4ef6\uff1f","\u5220\u9664\u63d0\u9192",function(a){"ok"==a&&(d.remove(),b.data=$.map(b.data,function(a){return a.guid!=e}))})});$("#"+this._FILE_EL_ID).on("change",function(a){console.log("change");var c=this;this.files&&this.files.length&&b.__onAddImage(this.files[0],function(){c.value=""})})},__onAddImage:function(a,b){var c=new FileReader,d=this;c.onload=function(){c.onload=null;d.imageCropper.show(c.result);b&&b()};c.onerror=function(){c.onerror=null;console.log(arguments);b&&b()};c.readAsDataURL(a)},_createImageCropper:function(){if(window.HTMLCanvasElement&&window.HTMLCanvasElement.toString&&/\[native code\]/.test(window.HTMLCanvasElement.toString())){if("function"==$.type(window.$.fn.cropper))return this._initImageCropper();var a=this;mini.loadCSS(this.externalSrc+"cropper/cropper.min.css",this.uiCls+"-cropper-style");mini.loadJS(this.externalSrc+"cropper/cropper.min.js",function(){a._initImageCropper()})}},setCropperOption:function(a,b){void 0===b&&$.type(a)},_initImageCropper:function(){var a=$("#head-sculpture-img"),b=this,c=mini.get("head-sculpture-window");$(c.el).on("click",".save.btn",function(){var c=a.data("guid");b.saveCropperImage(c)}).on("click",".cancel.btn",function(){b.imageCropper.hide()});return this.imageCropper={show:function(d,e){a.attr("src",d);a.attr("data-guid",e).data("guid",e);c.setTitle("\u88c1\u526a\u5934\u50cf");c.show();a.cropper("destroy").cropper(b._cropperOptions)},hide:function(){a.attr("src","");a.attr("data-guid",null).data("guid",null);c.hide()},zoomIn:function(){return a.cropper("zoom",.1)},zoomOut:function(){return a.cropper("zoom",-.1)},zoomTo:function(b){return a.cropper("zoomTo",void 0===b?1:b)},move:function(b,c){return a.cropper("move",void 0===b?-10:b,void 0===c?-10:c)},moveTo:function(b,c){return a.cropper("moveTo",void 0===b?0:b,void 0===c?0:c)},move:function(b,c){var d=void 0===b?-10:b,e=void 0===c?-10:c,k=a.cropper("getData",!0);k.x+=d;k.y+=e;0>k.x&&(k.x=0);0>k.y&&(k.y=0);return a.cropper("setData",k)},moveTo:function(b,c){var d=a.cropper("getData",!0);d.x=void 0===b?0:b;d.y=void 0===c?0:c;return a.cropper("setData",d)},rotate:function(b){return a.cropper("clear").cropper("rotate",void 0===b?90:b).cropper("crop")},rotateTo:function(b){return a.cropper("clear").cropper("rotate",void 0===b?0:b).cropper("crop")},scaleX:function(){return a.cropper("scaleX",-a.cropper("getData").scaleX)},scaleY:function(){return a.cropper("scaleY",-a.cropper("getData").scaleY)},setAspectRatio:function(b){return a.cropper("setAspectRatio",b)},setCropperSize:function(b){var c={cropBoxResizable:!1,dragMode:"move",zoomable:!1,toggleDragModeOnDblclick:!1};c.data=$.extend({},a.cropper("getData",!0),b);a.cropper("destroy").cropper(c).cropper("crop")},reset:function(){a.cropper("destroy").cropper($.extend(this.nowOptions,this.useroptions))},getCropperImgInfo:function(b){return a.cropper("getData",void 0===b?!0:!!b)},getData:function(b,c){var d={};d.info=a.cropper("getData",!0);void 0===c&&(c="jpeg");d.data=a.cropper("getCroppedCanvas",data).toDataURL("image/"+c);return d},getImageData:function(b,c){void 0===c&&(c="jpeg");return a.cropper("getCroppedCanvas",b).toDataURL("image/"+c)},getZoom:function(){var b=a.cropper("getCanvasData");return b.width/b.naturalWidth}}},saveCropperImage:function(a){mini.mask();var b=this,c={base64:this.imageCropper.getImageData()};void 0!==a&&(c.fileGuid=a,c.mode="edit");return $.ajax({url:"./imageUploader.php",type:"post",data:c}).then(function(c){mini.unmask();"string"===$.type(c)&&(c=JSON.parse(c));b.data?b.data.push(c):b.data=[c];console.log(c.downloadUrl);a?b.$fileList.find('[data-guid\x3d"'+a+'"]').replaceWith(b._genderItem(c)):b._addFileItem(c);b.imageCropper.hide()}).fail(function(){mini.unmask();console.error(arguments)})},getAttrs:function(a){var b=mini.ImageUploader.superclass.getAttrs.call(this,a);mini._ParseString(a,b,["cropperOption"]);return b}});mini.regClass(mini.ImageUploader,"imageuploader");!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){var b,c=navigator.userAgent,d=/iphone/i.test(c),e=/chrome/i.test(c),f=/android/i.test(c);a.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},autoclear:!0,dataName:"rawMaskFn",placeholder:"_"};a.fn.extend({caret:function(a,b){var c;if(0!==this.length&&!this.is(":hidden"))return"number"==typeof a?(b="number"==typeof b?b:a,this.each(function(){this.setSelectionRange?this.setSelectionRange(a,b):this.createTextRange&&(c=this.createTextRange(),c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",a),c.select())})):(this[0].setSelectionRange?(a=this[0].selectionStart,b=this[0].selectionEnd):document.selection&&document.selection.createRange&&(c=document.selection.createRange(),a=0-c.duplicate().moveStart("character",-1E5),b=a+c.text.length),{begin:a,end:b})},unmask:function(){return this.trigger("unmask")},mask:function(c,k){var g,n,p,q,r,t,u,B;return!c&&0<this.length?(g=a(this[0]),(g=g.data(a.mask.dataName))?g():void 0):(k=a.extend({autoclear:a.mask.autoclear,placeholder:a.mask.placeholder,completed:null},k),n=a.mask.definitions,p=[],q=u=c.length,r=null,a.each(c.split(""),function(a,b){"?"==b?(u--,q=a):n[b]?(p.push(new RegExp(n[b])),null===r&&(r=p.length-1),q>a&&(t=p.length-1)):p.push(null)}),this.trigger("unmask").each(function(){function g(){if(k.completed){for(var a=r;t>=a;a++)if(p[a]&&z[a]===l(a))return;k.completed.call(w)}}function l(a){return k.placeholder.charAt(a<k.placeholder.length?a:0)}function v(a){for(;++a<u&&!p[a];);return a}function x(a,b){var c,d;if(!(0>a)){c=a;for(d=v(b);u>c;c++)if(p[c]){if(!(u>d&&p[c].test(z[d])))break;z[c]=z[d];z[d]=l(d);d=v(d)}F();w.caret(Math.max(r,a))}}function C(a){var b,c,d;b=a;for(a=l(a);u>b;b++)if(p[b]){if(c=v(b),d=z[b],z[b]=a,!(u>c&&p[c].test(d)))break;a=d}}function A(){var a=w.val(),b=w.caret();if(a.length<B.length){for(E(!0);0<b.begin&&!p[b.begin-1];)b.begin--;if(0===b.begin)for(;b.begin<r&&!p[b.begin];)b.begin++}else for(E(!0);b.begin<u&&!p[b.begin];)b.begin++;w.caret(b.begin,b.begin);g()}function G(){E();w.val()!=I&&w.change()}function H(a,b){var c;for(c=a;b>c&&u>c;c++)p[c]&&(z[c]=l(c))}function F(){w.val(z.join(""))}function E(a){var b,c,d,e=w.val(),f=-1;for(d=b=0;u>b;b++)if(p[b]){for(z[b]=l(b);d++<e.length;)if(c=e.charAt(d-1),p[b].test(c)){z[b]=c;f=b;break}if(d>e.length){H(b+1,u);break}}else z[b]===e.charAt(d)&&d++,q>b&&(f=b);return a?F():q>f+1?k.autoclear||z.join("")===J?(w.val()&&w.val(""),H(0,u)):F():(F(),w.val(w.val().substring(0,f+1))),q?b:r}var w=a(this),z=a.map(c.split(""),function(a,b){return"?"!=a?n[a]?l(b):a:void 0}),J=z.join(""),I=w.val();w.data(a.mask.dataName,function(){return a.map(z,function(a,b){return p[b]&&a!=l(b)?a:null}).join("")});w.one("unmask",function(){w.off(".mask").removeData(a.mask.dataName)}).on("focus.mask",function(){if(!w.prop("readonly")){clearTimeout(b);var a;I=w.val();a=E();b=setTimeout(function(){F();a==c.replace("?","").length?w.caret(0,a):w.caret(a)},10)}}).on("blur.mask",G).on("keydown.mask",function(a){if(!w.prop("readonly")){var b,c,e=a.which||a.keyCode;B=w.val();if(8===e||46===e||d&&127===e){b=w.caret();c=b.begin;b=b.end;if(0===b-c){if(46!==e)for(;0<=--c&&!p[c];);else c=b=v(c-1);b=46===e?v(b):b}H(c,b);x(c,b-1);a.preventDefault()}else 13===e?G.call(this,a):27===e&&(w.val(I),w.caret(0,E()),a.preventDefault())}}).on("keypress.mask",function(b){if(!w.prop("readonly")){var c,d,e,k=b.which||b.keyCode,l=w.caret();if(!(b.ctrlKey||b.altKey||b.metaKey||32>k)&&k&&13!==k){if(0!==l.end-l.begin&&(H(l.begin,l.end),x(l.begin,l.end-1)),c=v(l.begin-1),u>c&&(d=String.fromCharCode(k),p[c].test(d)))(C(c),z[c]=d,F(),e=v(c),f)?setTimeout(function(){a.proxy(a.fn.caret,w,e)()},0):w.caret(e),l.begin<=t&&g();b.preventDefault()}}}).on("input.mask paste.mask",function(){w.prop("readonly")||setTimeout(function(){var a=E(!0);w.caret(a);g()},0)});e&&f&&w.off("input.mask").on("input.mask",A);E()}))}})});mini.InputMask=function(){mini.InputMask.superclass.constructor.call(this)};mini.extend(mini.InputMask,mini.TextBox,{uiCls:"mini-inputmask",mask:"",set:function(a){if("string"==typeof a)return this;var b=a.mask;delete a.mask;mini.InputMask.superclass.set.call(this,a);b&&this.setMask(b);return this},setMask:function(a){this.mask=a;jQuery(this._textEl).mask(a)},getMask:function(){return this.mask},getAttrs:function(a){var b=mini.InputMask.superclass.getAttrs.call(this,a);mini._ParseString(a,b,["mask"]);return b}});mini.regClass(mini.InputMask,"inputmask");mini.LargeFileUploader=function(){mini.LargeFileUploader.superclass.constructor.call(this)};mini.extend(mini.LargeFileUploader,mini.Control,{uiCls:"mini-largefileuploader",uploadUrl:"",limitType:"",fileNumLimit:1,fileSizeLimit:0,fileSingleSizeLimit:0,multiSelect:!0,auto:!0,externalSrc:"",pickerText:"\u9009\u62e9\u6587\u4ef6",startText:"\u5f00\u59cb\u4e0a\u4f20",pauseText:"\u6682\u505c\u4e0a\u4f20",numLimitErrorText:"\u9009\u62e9\u7684\u6587\u4ef6\u8fc7\u591a\uff01\x3c/br\x3e\u6700\u591a\u53ef\u4e0a\u4f20{0}\u4e2a\u6587\u4ef6",sizeLimitErrorText:"\u9009\u62e9\u7684\u6587\u4ef6\u8fc7\u5927\uff01\x3c/br\x3e\u6700\u591a\u53ef\u4e0a\u4f20{0}KB\u6587\u4ef6",typeDeniedErrorText:"\u9009\u62e9\u7684\u6587\u4ef6\u7c7b\u578b\u9519\u8bef\uff01\x3c/br\x3e\u53ef\u4e0a\u4f20\u7684\u6587\u4ef6\u7c7b\u578b\u4e3a\uff1a{0}",sizeErrorText:"\u9009\u62e9\u7684\u6587\u4ef6\u8fc7\u5927\uff01\x3c/br\x3e\u53ef\u4e0a\u4f20\u7684\u5355\u6587\u4ef6\u6700\u5927\u4e3a{0}KB",emptyFileErrorText:"\u4e0d\u80fd\u4e0a\u4f20\u7a7a\u6587\u4ef6\uff01",set:function(a){if("string"==typeof a)return this;var b=a.pickerText;delete a.pickerText;var c=a.needChunkLocal;delete a.needChunkLocal;c&&(this.needChunkLocal=c);mini.LargeFileUploader.superclass.set.call(this,a);b&&(this._picker.innerHTML=b);return this},_create:function(){this.el=document.createElement("div");this.el.innerHTML='\x3cdiv class\x3d"mini-uploader-btns"\x3e\x3cdiv class\x3d"mini-ntko-pick"\x3e'+this.pickerText+'\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-uploader-list"\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-ntko"\x3e\x3c/div\x3e';this._buttons=this.el.firstChild;this._fileList=this.el.children[1];this._ntkoContent=this.el.lastChild;this._picker=this._buttons.firstChild;this._uploadBtn=new mini.Button;this._uploadBtn.setText(this.startText);this._uploadBtn.render(this._buttons);this._ntkoContent.innerHTML='\x3cobject id\x3d"'+this.uid+'-ntko" classid\x3d"clsid:882C96AC-B79E-4f50-A7A6-6E5E42431A05" codebase\x3d"'+(this.externalSrc||mini.externalSrc)+'ntkoLFUploader/NtkoLFUploader.cab#version\x3d6,1,1,8"\x3e\x3cPARAM NAME\x3d"BackColor" VALUE\x3d"16744576"\x3e\x3cPARAM NAME\x3d"ForeColor" VALUE\x3d"16777215"\x3e\x3cPARAM NAME\x3d"IsUseUTF8Data" VALUE\x3d"true"\x3e\x3cparam name\x3d"ProductCaption" value\x3d"'+(window.NTKO_ProductCaption||"\u56fd\u6cf0\u65b0\u70b9\u7528\u6237")+'"\x3e\x3cparam name\x3d"ProductKey" value\x3d"'+(window.NTKO_ProductKey||"3CF3019EA6883730AB34F0D5A8FACDB1CDB2A9EA")+'"\x3e\x3cPARAM NAME\x3d"MakerCaption" VALUE\x3d"\u6c5f\u82cf\u56fd\u6cf0\u65b0\u70b9\u8f6f\u4ef6\u6709\u9650\u516c\u53f8"\x3e\x3cPARAM NAME\x3d"MakerKey" VALUE\x3d"39337AFCA7AFD1F882A3BF53CBE1E4AC804C65A6"\x3e\x3cspan style\x3d"color: red;"\x3e\u4e0d\u80fd\u88c5\u8f7dNTKO\u5927\u6587\u4ef6\u4e0a\u4f20\u63a7\u4ef6\u3002\x3c/span\x3e\x3c/object\x3e';this._ntko=this._ntkoContent.firstChild;this._errorContent=""},_initEvents:function(){function a(a){var b=document.createElement("script");b.language="JScript";b.setAttribute("for",a.target);b.event=a.event;b.text=a.text;document.body.appendChild(b)}mini._BindEvents(function(){mini_onOne(this._picker,"click",this.__OnPickerClick,this)},this);var b=this,c=this._ntko;this._uploadBtn.on("click",function(){c.IsUploading?(b.stopUpload(),b._uploadBtn.setText(b.pauseText)):(b.beginUpload(),b._uploadBtn.setText(b.startText))});this.auto&&this._uploadBtn.hide();if(c.attachEvent)c.attachEvent("BeforeFileAdded",function(a,d,e){c.CancelLastCommand=!b._beforeFileQueued(a,d,e)}),c.attachEvent("OnLocalFileAdded",function(a,c,d){b._onFilesQueued(a,c,d)}),c.attachEvent("OnFileProcessStatusChange",function(a,c,d,e){b._onUploadProgress(a,c,d,e)}),c.attachEvent("OnOneFileUploadFinished",function(a,c){b._onFileFinished(a,c)}),c.attachEvent("OnSaveToURLFinished",function(a){b._onUploadFinished(a)});else{var d=this.uid+"-ntko",e='var lfu \x3d mini.getbyUID("'+this.uid+'");';a({target:d,event:"BeforeFileAdded(filePath, fileName, fileSize)",text:e+"lfu._ntko.CancelLastCommand \x3d !lfu._beforeFileQueued(filePath, fileName, fileSize);"});a({target:d,event:"OnLocalFileAdded(filePath, fileName, fileSize)",text:e+"lfu._onFilesQueued(filePath, fileName, fileSize);"});a({target:d,event:"OnFileProcessStatusChange(file, statusText, isPersent, persentNumber)",text:e+"lfu._onUploadProgress(file, statusText, isPersent, persentNumber);"});a({target:d,event:"OnOneFileUploadFinished(file, isAllUploaded)",text:e+"lfu._onFileFinished(file, isAllUploaded);"});a({target:d,event:"OnSaveToURLFinished(isAllSuccess)",text:e+"lfu._onUploadFinished(isAllSuccess);"})}},_afterApply:function(){void 0===this._ntko.StatusCode&&(this.el.innerHTML='\x3ca class\x3d"noflash" title\x3d"\u4e0d\u80fd\u88c5\u8f7dNTKO\u5927\u6587\u4ef6\u4e0a\u4f20\u63a7\u4ef6\u3002\u8bf7\u786e\u4fdd\u4f7f\u7528IE\u6d4f\u89c8\u5668\uff0c\u5e76\u68c0\u67e5\u6d4f\u89c8\u5668\u7684\u5b89\u5168\u8bbe\u7f6e\u3002"\x3e\u521d\u59cb\u5316\u9519\u8bef\x3c/a\x3e',mini.showPageWarning({html:"\u4e0d\u80fd\u88c5\u8f7dNTKO\u5927\u6587\u4ef6\u4e0a\u4f20\u63a7\u4ef6\u3002\u8bf7\u786e\u4fdd\u4f7f\u7528IE\u6d4f\u89c8\u5668\uff0c\u5e76\u68c0\u67e5\u6d4f\u89c8\u5668\u7684\u5b89\u5168\u8bbe\u7f6e"}))},__OnPickerClick:function(a){a=this._ntko;try{a.AddLocalFile("",this.multiSelect,this._ntkoFileType),this.auto&&this.beginUpload()}catch(b){10==a.StatusCode?window.console&&console.log("\u7528\u6237\u53d6\u6d88\u64cd\u4f5c"):window.console&&console.error("error\uff1a"+b.number+":"+b.description)}},_blocksFileField:"NTKO_LF_BLOCK",beginUpload:function(){function a(a){var b=[],c;for(c in a)b.push(c+"\x3d"+a[c]);return b.join("\x26")}if(this._onStartUpload()){var b=this._ntko;b.QueryFileStatusURL=this._ntkoQueryFileStatusURL;b.FinishedUploadURL=this._ntkoFinishedUploadURL;var c={data:{}};this._onUploadBeforeSend(c);b.BeginSaveToURL(this.uploadUrl+"\x26query\x3dupload",this._blocksFileField,a(c.data))}},stopUpload:function(){this._ntko.StopSaveToURL();this._onStopUpload()},reset:function(){this._ntko.Reset();this._onReset()},removeFile:function(a){var b=this._ntko;a=this._getFileIndex(a);var c;-1<a&&(c=b.GetFile(a),b.RemoveFile(a),this._fileIds[c.FilePath]=void 0,delete this._fileIds[c.FilePath],this._onFileDequeued(c))},_getFileIndex:function(a){var b=0,c;for(c in this._fileIds){if(this._fileIds[c].id===a)return b;b++}return-1},_ntkoFileType:"*.*",setLimitType:function(a){this.limitType=a.toLowerCase();this._ntkoFileType=this._getNtkoFileType(a)},getLimitType:function(){return this.limitType},setAuto:function(a){this.auto!=a&&((this.auto=a)?this._uploadBtn.hide():this._uploadBtn.show())},getAuto:function(){return this.auto},_getNtkoFileType:function(a){if(!a)return"*.*";var b=[];a=a.split(",");for(var c=0,d=a.length;c<d;c++)b.push("*."+a[c]);return b.join(";")},getFileList:function(){return this._fileList},setFileNumLimit:function(a){this.fileNumLimit=a=parseInt(a)||0;this.multiSelect=1===a?!1:!0},getFileNumLimit:function(){return this.fileNumLimit},setUploadUrl:function(a){var b=window.location.search.substring(1),c="?";0<a.indexOf("?")&&(c="\x26");a+=c+"type\x3dntko";b&&(a+="\x26"+b);this.needChunkLocal&&(a+="\x26needChunkLocal\x3d1");this.uploadUrl=a;this._ntkoQueryFileStatusURL=a+"\x26query\x3dgetStatus";this._ntkoFinishedUploadURL=a+"\x26query\x3dfinished"},getUploadUrl:function(){return this.uploadUrl},setFileSingleSizeLimit:function(a){this.fileSingleSizeLimit=a},getFileSingleSizeLimit:function(){return this.fileSingleSizeLimit},_validateFile:function(a){var b=this._ntko.FilesCount;return this.fileNumLimit&&b>=this.fileNumLimit?(this._errorContent=String.format(this.numLimitErrorText,this.fileNumLimit),!1):this.fileSingleSizeLimit&&a.size>1024*this.fileSingleSizeLimit?(this._errorContent=String.format(this.sizeErrorText,this.fileSingleSizeLimit),!1):0===a.size?(this._errorContent=this.emptyFileErrorText,!1):this.limitType&&-1==(","+this.limitType+",").indexOf(","+a.ext.toLowerCase()+",")?(this._errorContent=String.format(this.typeDeniedErrorText,this.limitType),!1):!0},_parseAttachFile:function(a){a={path:a.FilePath,name:a.FileName,size:a.FileSize,md5:a.MD5ID};a.ext=a.name.substr(a.name.lastIndexOf(".")+1);a.id=this._fileIds[a.path].id;return a},_beforeFileQueued:function(a,b,c){a={path:a,name:b,size:c,ext:b.substr(b.lastIndexOf(".")+1)};if(this._events.beforefilequeued&&(b={source:this,sender:this,type:"beforefilequeued",file:a,cancel:!1},this.fire("beforefilequeued",b),b.cancel))return!1;if(this._validateFile(a))return!0;this._errorContent&&mini.alert(this._errorContent);this._errorContent="";return!1},_fileIds:{},_onFilesQueued:function(a,b,c){a={path:a,name:b,size:c,ext:b.substr(b.lastIndexOf(".")+1),id:UUID()};this._fileIds[a.path]={id:a.id};this.fire("filesqueued",{files:[a]})},_onFileDequeued:function(a){this.fire("filedequeued",{file:a})},_onUploadBeforeSend:function(a){this.fire("uploadbeforesend",a)},_onUploadProgress:function(a,b,c,d){a=this._parseAttachFile(a);console.log(arguments);c?0!==b.indexOf("\u6b63\u5728\u5206\u6790\u6587\u4ef6")?this.fire("uploadprogress",{file:a,percentage:d/100}):this.fire("md5progress",{file:a,percentage:d/100}):this._fileIds[a.path].started||(this.fire("uploadstart",{file:a}),this._fileIds[a.path].started=!0)},_onFileFinished:function(a,b){a=this._parseAttachFile(a);b?this._onUploadSuccess(a):this._onUploadError(a,this._parseNtkoRet(this._ntko.LastFinishedUploadRetMes));this._onUploadComplete(a)},_onUploadSuccess:function(a){var b=this._parseNtkoRet(this._ntko.LastFinishedUploadRetMes);this.fire("uploadaccept",{ret:b,object:{file:a}});this.fire("uploadsuccess",{file:a})},_onUploadError:function(a,b){this.fire("uploaderror",{file:a,reason:b})},_onUploadComplete:function(a){this.fire("uploadcomplete",{file:a})},_onStartUpload:function(){if(this._events.startupload){var a={source:this,sender:this,type:"startupload",cancel:!1};this.fire("startupload",a);if(a.cancel)return!1}return!0},_onStopUpload:function(){this.fire("stopupload")},_onUploadFinished:function(a){this._uploadBtn.setText(this.startText);this.fire("uploadfinished",{isAllSuccess:a})},_onReset:function(){this._fileIds={};this.fire("reset")},_parseNtkoRet:function(a){var b={};a=a.split("\x26");$.each(a,function(a,d){var c=d.split("\x3d"),f=c[0],c=c[1];"undefined"==typeof b[f]?b[f]=c:"string"==typeof b[f]?b[f]=[b[f],c]:b[f].push(c)});return b},getAttrs:function(a){var b=mini.LargeFileUploader.superclass.getAttrs.call(this,a);b.text=a.innerHTML;mini._ParseString(a,b,"uploadUrl limitType onbeforefilequeued onfilesqueued onreset onstartupload onstopupload onuploadfinished onuploadstart onuploadbeforesend onuploadaccept onuploadprogress onmd5progress onuploadsuccess onuploaderror onuploadcomplete pickerText".split(" "));mini._ParseBool(a,b,["auto"]);mini._ParseInt(a,b,["fileNumLimit","fileSingleSizeLimit"]);return b}});mini.regClass(mini.LargeFileUploader,"largefileuploader");mini.Output=function(){mini.Output.superclass.constructor.apply(this,arguments)};mini.extend(mini.Output,mini.Control,{url:"",async:!1,escape:!1,autoLoad:!0,uiCls:"mini-output",_create:function(){this.el=document.createElement("div");this.el.className="mini-output"},_initEvents:function(){},doLayout:function(){if(this.canLayout()){var a=this.el.childNodes;if(a)for(var b=0,c=a.length;b<c;b++)mini.layout(a[b])}},doUpdate:function(){var a=this;jQuery.ajax({url:this.url,async:this.async}).done(function(b){a.setValue(b)})},setUrl:function(a){this.url=a;this.autoLoad&&this.doUpdate()},getUrl:function(){return this.url},setAutoLoad:function(a){this.autoLoad=!!a},getAutoLoad:function(){return this.autoLoad},setEscape:function(a){this.escape=!!a},getEscape:function(){return this.escape},setAsync:function(a){this.async=a},getAsync:function(){return this.async},setValue:function(a){a={value:a};this.fire("valuechanged",a);a=a.value;if(null===a||void 0===a)a="";this.escape&&(a=mini.htmlEncode(a));mini.innerHTML(this.el,a);mini.parse(this.el);this.doLayout()},getAttrs:function(a){var b=mini.Output.superclass.getAttrs.call(this,a);mini._ParseString(a,b,["url","onvaluechanged"]);mini._ParseBool(a,b,["escape","async","autoLoad"]);return b}});mini.regClass(mini.Output,"output");mini.OutputText=function(){mini.OutputText.superclass.constructor.apply(this,arguments)};mini.extend(mini.OutputText,mini.Control,{maxWidth:"",escape:!1,showTitle:!0,uiCls:"mini-outputtext",set:function(a){if("string"==typeof a)return this;var b=a.maxWidth;delete a.maxWidth;var c=a.escape;delete a.escape;var d=a.showTitle;delete a.showTitle;b&&this.setMaxWidth(b);c&&(this.escape=c);mini.isNull(d)||this.setShowTitle(d);mini.OutputText.superclass.set.call(this,a);return this},_create:function(){this.el=document.createElement("span")},setValue:function(a){if(null===a||void 0===a)a="";this.value=a;!0===this.escape&&(a=mini.htmlEncode(a),a=a.replace(/\n/g,"\x3cbr/\x3e"));this.el.innerHTML=a;a=jQuery(this.el).text();this.showTitle&&mini.setAttr(this.el,"title",a)},setMaxWidth:function(a){(a=a.replace(/(^\s*)|(\s*$)/g,""))?("px"!=a.substr(a.length-2)&&(a+="px"),mini.addClass(this.el,"mini-text-ellipsis")):mini.removeClass(this.el,"mini-text-ellipsis");this.maxWidth=this.el.style.maxWidth=a},getMaxWidth:function(){return this.maxWidth},getEscape:function(){return this.escape},getShowTitle:function(){return this.showTitle},setShowTitle:function(a){this.showTitle=a},getAttrs:function(a){var b=mini.OutputText.superclass.getAttrs.call(this,a);mini._ParseString(a,b,["maxWidth"]);mini._ParseBool(a,b,["escape","showTitle"]);return b}});mini.regClass(mini.OutputText,"outputtext");mini.PagerTree=function(){mini.PagerTree.superclass.constructor.call(this);mini.addClass(this.el,"mini-tree");mini.addClass(this.el,"mini-treegrid");this._Expander=new mini._PagerTree_Expander(this);this._collapseNodes=[];this._expandNodes=[];this.on("beforeload",this.__OnBeforeLoad,this)};mini.extend(mini.PagerTree,mini.DataGrid,{uiCls:"mini-pagertree",treeColumn:"",idField:"id",parentField:"pid",showTreeIcon:!0,iconField:"iconCls",imgField:"img",imgPath:"",leafIconCls:"mini-tree-leaf",folderIconCls:"mini-tree-folder",_expandNodeCls:"mini-tree-expand",_collapseNodeCls:"mini-tree-collapse",_eciconCls:"mini-tree-node-ecicon",_OnCellMouseDown:function(a){mini.findParent(a.htmlEvent.target,this._eciconCls)||mini.findParent(a.htmlEvent.target,"mini-tree-checkbox")||this.fire("cellmousedown",a)},_OnCellClick:function(a){mini.findParent(a.htmlEvent.target,this._eciconCls)||mini.findParent(a.htmlEvent.target,"mini-tree-checkbox")||this.fire("cellclick",a)},_OnDrawCell:function(a,b,c,d){c=mini.PagerTree.superclass._OnDrawCell.call(this,a,b,c,d);this.treeColumn&&this.treeColumn==b.name&&(c.headerCls+=" mini-tree-treecolumn",c.cellCls+=" mini-tree-treecell",c.cellStyle+=";padding:0;",c.img=a[this.imgField],c.iconCls=this._getNodeIcon(a),c.showTreeIcon=this.showTreeIcon,c.nodeCls="",c.nodeStyle="",this._createTreeCell(c));return c},_createTreeCell:function(a){var b=[],c=a.record,d=this.isLeafNode(c),e=this.getNodeLevel(c),c=this.isExpandedNode(c),f=a.nodeCls;d||(f=c?this._expandNodeCls:this._collapseNodeCls);d||(f+=" mini-tree-parentNode");b[b.length]='\x3cdiv class\x3d"mini-tree-nodetitle '+f+'" style\x3d"'+a.nodeStyle+'"\x3e';for(c=0;c<e-1;c++)b[b.length]='\x3cspan class\x3d"mini-tree-indent " \x3e\x3c/span\x3e';b[b.length]=d?'\x3cspan class\x3d"'+this._eciconCls+'" \x3e\x3c/span\x3e':'\x3ci class\x3d"'+this._eciconCls+'"\x3e\x3c/i\x3e';b[b.length]='\x3cspan class\x3d"mini-tree-nodeshow"\x3e';a.showTreeIcon&&(b[b.length]=a.img?'\x3cspan class\x3d"mini-tree-icon" style\x3d"background-image:url('+(this.imgPath+a.img)+');"\x3e\x3c/span\x3e':'\x3cspan class\x3d"'+a.iconCls+' mini-tree-icon mini-icon"\x3e\x3c/span\x3e');b[b.length]='\x3cspan class\x3d"mini-tree-nodetext"\x3e';b[b.length]=a.cellHtml;b[b.length]="\x3c/span\x3e";b[b.length]="\x3c/span\x3e";b[b.length]="\x3c/div\x3e";a.cellHtml=b.join("")},__OnBeforeLoad:function(a){a.data.__ecconfig=this._getEcConfig()},_getEcConfig:function(){return mini.encode({collapseNodes:this._collapseNodes,expandNodes:this._expandNodes})},load:function(){this._collapseNodes=[];this._expandNodes=[];return mini.PagerTree.superclass.load.apply(this,arguments)},expandNode:function(a){(a=this._dataSource.getbyId(a))&&!this.isLeafNode(a)&&(a=a[this.getIdField()])&&(this._expandNodes.remove(a),this._collapseNodes.remove(a),this._expandNodes.add(a));this.reload()},collapseNode:function(a){(a=this._dataSource.getbyId(a))&&!this.isLeafNode(a)&&(a=a[this.getIdField()])&&(this._expandNodes.remove(a),this._collapseNodes.remove(a),this._collapseNodes.add(a));this.reload()},toggleNode:function(a){(a=this._dataSource.getbyId(a))?this.isExpandedNode(a)?this.collapseNode(a):this.expandNode(a):this.reload()},isExpandedNode:function(a){return void 0===a.expanded?!0:"true"==a.expanded.toString()},isLeafNode:function(a){return a.isLeaf&&"true"==a.isLeaf.toString()},getNodeLevel:function(a){return a._level},_getNodeIcon:function(a){var b=a[this.iconField];b||(b=this.isLeafNode(a)?this.leafIconCls:this.folderIconCls);return b},getAttrs:function(a){var b=mini.PagerTree.superclass.getAttrs.call(this,a);mini._ParseString(a,b,"treeColumn iconField imgField imgPath idField parentField".split(" "));mini._ParseBool(a,b,["showTreeIcon"]);return b}});mini.regClass(mini.PagerTree,"pagertree");mini._PagerTree_Expander=function(a){this.owner=a;mini.on(a.el,"click",this.__OnClick,this)};mini._PagerTree_Expander.prototype={__OnClick:function(a){var b=this.owner,c=b.getRecordByEvent(a,!1);c&&(b.isLeafNode(c),mini.findParent(a.target,b._eciconCls)&&!b.isLeafNode(c)&&b.toggleNode(c))}};var Pagination=function(){Pagination.superclass.constructor.apply(this,arguments)};mini.extend(Pagination,mini.Control,{pageIndex:0,pageSize:10,totalCount:0,totalPage:0,sizeList:[10,20,50,100],set:function(a){if("string"==typeof a)return this;var b=a.pageIndex;delete a.pageIndex;Pagination.superclass.set.call(this,a);mini.isNull(b)||this.setPageIndex(b);return this},uiCls:"mini-pagination",_create:function(){this.el=document.createElement("div");this._updatePager()},_updatePagerButtons:function(){var a=parseInt(this.pageSize,10),b=parseInt(this.pageIndex,10),c=parseInt(this.totalCount,10),a=Math.ceil(c/a),c=[];c.push('\x3cdiv class\x3d"pagination-buttons"\x3e');var d="",e;0==b&&(d="disabled");c.push('\x3ca class\x3d"pagination-button pagination-prev mini-icon '+d+'" action\x3d"prev"\x3e\x3c/a\x3e');if(8>a)for(e=0;e<a;e++)d="",b==e&&(d="pagination-current"),d='\x3ca class\x3d"pagination-button '+d+'"\x3e'+(e+1)+"\x3c/a\x3e",c.push(d);else if(6>b){for(e=0;6>e;e++)d="",b==e&&(d="pagination-current"),d='\x3ca class\x3d"pagination-button '+d+'"\x3e'+(e+1)+"\x3c/a\x3e",c.push(d);c.push('\x3ca class\x3d"pagination-button pagination-button-ellipsis" action\x3d"none" data-index\x3d"'+(e+4>=a?a-1:e+4)+'"\x3e...\x3c/a\x3e');c.push('\x3ca class\x3d"pagination-button"\x3e'+a+"\x3c/a\x3e")}else if(b>a-6)for(c.push('\x3ca class\x3d"pagination-button"\x3e1\x3c/a\x3e'),c.push('\x3ca class\x3d"pagination-button pagination-button-ellipsis" action\x3d"none" data-index\x3d"'+(a-6)+'"\x3e...\x3c/a\x3e'),e=6;0<e;e--)d="",b==a-e&&(d="pagination-current"),c.push('\x3ca class\x3d"pagination-button '+d+'"\x3e'+(a-e+1)+"\x3c/a\x3e");else{c.push('\x3ca class\x3d"pagination-button"\x3e1\x3c/a\x3e');c.push('\x3ca class\x3d"pagination-button pagination-button-ellipsis" action\x3d"none" data-index\x3d"'+(b-3)+'"\x3e...\x3c/a\x3e');for(e=0;3>e;e++)d='\x3ca class\x3d"pagination-button"\x3e'+(b-(2-e))+"\x3c/a\x3e",c.push(d);c.push('\x3ca class\x3d"pagination-button pagination-current"\x3e'+(b+1)+"\x3c/a\x3e");c.push('\x3ca class\x3d"pagination-button pagination-button-ellipsis" action\x3d"none" data-index\x3d"'+(b+4>=a?a-1:b+4)+'"\x3e...\x3c/a\x3e');c.push('\x3ca class\x3d"pagination-button"\x3e'+a+"\x3c/a\x3e")}d="";b==a-1&&(d="disabled");c.push('\x3ca class\x3d"pagination-button pagination-next  mini-icon '+d+'" action\x3d"next"\x3e\x3c/a\x3e');c.push("\x3c/div\x3e");b=c.join(" ");this.el.innerHTML=b},_updatePagerInfo:function(){for(var a=this,b=parseInt(a.pageSize,10),c=parseInt(a.pageIndex,10),d=a.sizeList,e=!1,f=0,g=d.length;f<g;f++)d[f]==b&&(e=!0);e||d.push(b);d.sort(function(a,b){return a-b});e=[];f=0;for(g=d.length;f<g;f++)e.push({id:d[f],text:d[f]});a.sizeCombo=new mini.ComboBox;a.sizeCombo.setData(e);a.sizeCombo.setValue(b);a.sizeCombo.on("valuechanged",function(b){b=parseInt(b.value);a._OnPageChanged(0,b)});a.sizeCombo.render(a.el);b=document.createElement("span");b.className="pagination-pagerchange";b.innerHTML='\x26nbsp\x26nbsp\x26nbsp   \u8df3\u81f3\uff1a\x3cinput class\x3d"pagination-number"  value\x3d"'+(c+1)+'"/\x3e\t\u9875';a.el.appendChild(b)},_updatePager:function(){this._updatePagerButtons();this._updatePagerInfo()},_initEvents:function(){function a(a){var c=Math.ceil(b.totalCount/b.pageSize),e=parseInt(a.val());isNaN(e)?a.val(""):(e>c&&(e=c,a.val(e)),b._OnPageChanged(e-1))}Pagination.superclass._initEvents.call(this);var b=this;setTimeout(function(){$(b.el).on("click",".pagination-button",function(a){var c=b.pageIndex,e=Math.ceil(b.totalCount/b.pageSize),f=$(a.target).attr("action");"prev"==f?0!=c&&b._OnPageChanged(c-1):"next"==f?c<e-1&&b._OnPageChanged(b.pageIndex+1):"none"==f?(a=parseInt($(a.target).data("index"),10),0<a&&b._OnPageChanged(a-1)):$(a.target).hasClass("current")||(a=parseInt($(a.target).text(),10),0<a&&b._OnPageChanged(a-1))}).on("keydown",".pagination-number",function(b){13==b.keyCode&&a($(b.target))}).on("change",".pagination-number",function(b){a($(b.target))})},100)},_OnPageChanged:function(a,b){var c={pageIndex:mini.isNumber(a)?a:this.pageIndex,pageSize:mini.isNumber(b)?b:this.pageSize,cancel:!1};c.pageIndex>this.totalPage-1&&(c.pageIndex=this.totalPage-1);0>c.pageIndex&&(c.pageIndex=0);this.fire("beforepagechanged",c);1!=c.cancel&&(this.fire("pagechanged",c),this.update(c.pageIndex,c.pageSize))},update:function(a,b,c){mini.isNumber(a)&&(this.pageIndex=parseInt(a));mini.isNumber(b)&&(this.pageSize=parseInt(b));mini.isNumber(c)&&(this.totalCount=parseInt(c));this.totalPage=parseInt(this.totalCount/this.pageSize)+1;(this.totalPage-1)*this.pageSize==this.totalCount&&--this.totalPage;0==this.totalCount&&(this.totalPage=0);this.pageIndex>this.totalPage-1&&(this.pageIndex=this.totalPage-1);0>=this.pageIndex&&(this.pageIndex=0);0>=this.totalPage&&(this.totalPage=0);this._updatePager()},setPageIndex:function(a){isNaN(a)||(this.pageIndex=a,this.update())},getPageIndex:function(){return this.pageIndex},setPageSize:function(a){isNaN(a)||(this.pageSize=a,this.update())},getPageSize:function(){return this.pageSize},setTotalCount:function(a){a=parseInt(a);isNaN(a)||(this.totalCount=a,this.update())},getTotalCount:function(){return this.totalCount},setSizeList:function(a){mini.isArray(a)&&(this.sizeList=a,this.update())},getSizeList:function(){return this.sizeList},setShowReloadButton:function(a){},getShowReloadButton:function(){return!1},getAttrs:function(a){var b=mini.Pager.superclass.getAttrs.call(this,a);mini._ParseString(a,b,["onpagechanged","sizeList","onbeforepagechanged","buttons","sizeText"]);mini._ParseInt(a,b,["pageIndex","pageSize","totalCount"]);"string"==typeof b.sizeList&&(b.sizeList=window.eval(b.sizeList));b.buttons&&(b.buttons=mini.byId(b.buttons));return b}});mini.regClass(Pagination,"pagination");mini.PanelTip=function(){mini.PanelTip.superclass.constructor.apply(this,arguments)};mini.extend(mini.PanelTip,mini.ToolTip,{selector:".paneltip",trigger:"click",uiCls:"mini-paneltip",url:"",tplUrl:"",tpl:"",cssUrl:"",externalSrc:"",_create:function(){this.el=jQuery('\x3cdiv class\x3d"mini-tooltip mini-paneltip"\x3e\x3cdiv class\x3d"mini-tooltip-arrow"\x3e\x3c/div\x3e\x3ci class\x3d"mini-paneltip-close"\x3e\x3c/i\x3e\x3cdiv class\x3d"mini-tooltip-inner"\x3e\x3c/div\x3e\x3c/div\x3e')[0];this.$element=jQuery(this.el);this.$close=jQuery(".mini-paneltip-close",this.$element);this.$element.appendTo(document.body);this.externalSrc=this.externalSrc||mini.externalSrc},_initEvents:function(){var a=this;this.$close.on("click",function(){a.close()});this._bindTooltip()},_opened:"",open:function(a){a=jQuery(a)[0]||this.target;var b=jQuery(a).attr("data-guid"),c={element:a,data:{guid:b},cancel:!1};this.fire("beforeopen",c);c.cancel||(this.$element.show(),this._target=a,this._getData(c.data,b),this.fire("open",{element:a}))},_getData:function(a,b){var c=this;this.showLoading();mini.ajax({url:this.url,data:a,async:!0,success:function(a){var d=mini.decode(a)||"";c._opened=b;window.Mustache?c._renderContent(d):mini.loadJS(c.externalSrc+"mustache.min.js",function(){c._renderContent(d)})}})},_renderContent:function(a){a=Mustache.render(this.tpl,a);this.setContent(a);this.$close.removeClass("hidden")},_toggle:function(a){this._opened&&jQuery(a.currentTarget).attr("data-guid")===this._opened?this.applyPlacement():(this.close(),this._enter(a))},_leave:function(a){clearTimeout(this.openTimer)},showLoading:function(){this.setContent('\x3cdiv class\x3d"mini-tooltip-loading"\x3e\x3c/div\x3e');this.$close.addClass("hidden")},close:function(){this._target=null;this.$element.hide();this._opened=""},setTplUrl:function(a){this.tplUrl=a;this.tpl=jQuery.trim(mini.loadText(a))},setCssUrl:function(a){this.cssUrl=a;mini.loadCSS(a)},getAttrs:function(a){var b=mini.PanelTip.superclass.getAttrs.call(this,a);mini._ParseString(a,b,["trigger"]);return b}});mini.regClass(mini.PanelTip,"paneltip");mini.Repeat=function(){mini.Repeat.superclass.constructor.call(this)};mini.extend(mini.Repeat,mini.ListControl,{templateId:"",templateUrl:"",url:"",externalSrc:"",uiCls:"mini-repeat",_create:function(){this.el=document.createElement("div");this.externalSrc=this.externalSrc||mini.externalSrc},setTemplateUrl:function(a){this.templateUrl=a;var b=this;jQuery.ajax({url:a,async:!1}).done(function(a){b.template=jQuery.trim(a)}).fail(function(a,b,e){throw Error("template not found");})},getTemplateUrl:function(){return this.templateUrl},setTemplateId:function(a){this.templateId=a;if(a=document.getElementById(a))this.template=jQuery.trim(a.innerHTML);else throw Error("template not found");},getTemplateId:function(){return this.templateId},setData:function(a){this.data=a||[];if(this.template){var b=this;window.Mustache?this._renderHtml():mini.loadJS(this.externalSrc+"mustache.min.js",function(){b._renderHtml()})}else throw Error("template not init");},_renderHtml:function(){var a=this.data.control,b=this.data.template||this.data,c=[],d,e;d=0;for(e=b.length;d<e;d++)c.push(Mustache.render(this.template,b[d]));this.el.innerHTML=c.join("");mini.parse(this.el);if(a)for(mini.isArray(a)||(a=[]),d=0,e=a.length;d<e;d++){var b=a[d],f;for(f in b)(c=mini.get(f,this.el))&&b[f]&&(b[f].data&&(c.loadList?c.loadList(b[f].data):c.setData&&(c.setData(b[f].data),b[f].total&&c.setTotalCount&&c.setTotalCount(b[f].total))),"object"!=typeof b[f]&&c.setValue&&c.setValue(b[f]),b[f].value&&c.setValue&&c.setValue(b[f].value))}},getAttrs:function(a){var b=mini.Repeat.superclass.getAttrs.call(this,a);mini._ParseString(a,b,["templateId","templateUrl"]);return b}});mini.regClass(mini.Repeat,"repeat");mini.Slider=function(){mini.Slider.superclass.constructor.call(this)};mini.extend(mini.Slider,mini.Control,{uiCls:"mini-slider",width:"200px",formField:!0,minValue:0,maxValue:100,step:1,precision:0,showTooltip:!0,set:function(a){if("string"==typeof a)return this;var b=a.value;delete a.value;mini.Slider.superclass.set.call(this,a);mini.isNull(b)||this.setValue(b)},_create:function(){this.el=document.createElement("div");this.el.className="mini-slider";this.el.innerHTML='\x3cdiv class\x3d"mini-slider-runway"\x3e\x3cdiv class\x3d"mini-slider-bar"\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-slider-pointer"\x3e\x3c/div\x3e\x3c/div\x3e';this.runway=this.el.firstChild;this.bar=this.runway.firstChild;this.pointer=this.runway.lastChild},_initEvents:function(){function a(){e=c.value;$(window).off("mousemove",b);$(window).off("mouseup",b);$(window).off("mouseup",a);d!=e&&c.fire("valuechanged",{value:e,oldValue:d})}function b(a){c._handleChange(a)}var c=this,d,e;$(this.el).on("mousedown",function(){d=c.value;$(window).on("mousemove",b);$(window).on("mouseup",b);$(window).on("mouseup",a)})},_afterApply:function(){this.showTooltip&&(this.toolTip=new mini.ToolTip,this.toolTip.set({target:document,scope:this.el,selector:"[data-tooltip]",placement:"top"}),this.toolTip.on("beforeopen",this._onBeforeShowToolTip,this))},_onBeforeShowToolTip:function(a){var b={content:a.content};this.fire("beforeshowtooltip",b);a.content=b.content},_handleChange:function(a){a.preventDefault&&a.preventDefault();var b=this.el,c=b.clientWidth,b=b.getBoundingClientRect().left+window.pageXOffset;a=(a.pageX||(a.touches?a.touches[0].pageX:0))-b;var b=a-0,d=c-a;a=0<=b&&0<=d?a:Math.abs(b)>=Math.abs(d)?c:0;0>=a?(c=0,a=this.minValue):a>=c?(c=100,a=this.maxValue):(c=100*a/c,a=100/((this.maxValue-this.minValue)/this.step),b=Math.round(c/a),a=b*a*(this.maxValue-this.minValue)*.01+this.minValue,a=parseFloat(a.toFixed(this.precision)));this.setValue(a,c);this.showTooltip&&(c={content:a},this.fire("beforeshowtooltip",c),this.toolTip.setContent(c.content))},setPosition:function(a){this.bar.style.width=a+"%";this.pointer.style.left=a+"%"},setValue:function(a,b){a=parseFloat(a);isNaN(a)&&(a=this.minValue);0<=this.precisions&&(a=a.toFixed(this.precisions));a>this.maxValue?a=this.maxValue:a<this.minValue&&(a=this.minValue);this.value!=a&&(this.value=a,b=mini.isNumber(b)?b:(a-this.minValue)/(this.maxValue-this.minValue)*100,this.setPosition(b),this.showTooltip&&this.pointer.setAttribute("data-tooltip",a))},getValue:function(){return this.value},setMaxValue:function(a){a=parseFloat(a);isNaN(a)||(a=parseFloat(a),this.maxValue!=a&&(this.maxValue=a,this._ValueLimit()))},getMaxValue:function(a){return this.maxValue},setMinValue:function(a){a=parseFloat(a);isNaN(a)||(a=parseFloat(a),this.minValue!=a&&(this.minValue=a,this._ValueLimit()))},getMinValue:function(){return this.minValue},setStep:function(a){a=parseFloat(a);isNaN(a)||this.step==a||(this.step=a,this._adjustPrecision())},getStep:function(){return this.step},_ValueLimit:function(){this.minValue>this.maxValue&&(this.maxValue=this.minValue+100);this.value<this.minValue&&this.setValue(this.minValue);this.value>this.maxValue&&this.setValue(this.maxValue);this._adjustPrecision()},_adjustPrecision:function(){var a=[this.minValue,this.maxValue,this.step].map(function(a){return(a=(""+a).split(".")[1])?a.length:0});this.precision=Math.max.apply(null,a)},getAttrs:function(a){var b=mini.Slider.superclass.getAttrs.call(this,a);mini._ParseString(a,b,["maxValue","minValue","step","onvaluechanged","onbeforeshowtooltip"]);return b}});mini.regClass(mini.Slider,"slider");mini.TabsTreeSelect=function(){mini.TabsTreeSelect.superclass.constructor.call(this)};mini.extend(mini.TabsTreeSelect,mini.ValidatorBase,{text:"",value:"",width:660,height:353,expandOnLoad:!1,idField:"id",textField:"text",nodesField:"children",url:"",filterUrl:"",filterMode:"",autoLoad:!0,data:[],tabsConfig:[],tabKeys:[],showTreeIcon:!0,showTreeLines:!0,resultAsTree:!0,showFolderCheckBox:!0,loadChildWhenChecked:!0,parentField:"pid",canCheckParent:!1,checkRecursive:!0,autoCheckParent:!1,checkOnTextClick:!0,showSelectedCount:!0,showSort:!1,selectedPanelTitle:"\u5df2\u9009\u4eba\u5458",delimiter:",",showFullPath:!1,includeRootNode:!1,showBorder:!1,uiCls:"mini-tabstreeselect",set:function(a){if("string"==typeof a)return this;var b=a.value;delete a.value;var c=a.text;delete a.text;var d=a.data;delete a.data;var e=a.showBorder;delete a.showBorder;var f=a.tabs;delete a.tabs;var g=a.url;delete a.url;var k=a.filterUrl;delete a.filterUrl;var l=a.filterMode;delete a.filterMode;var n=a.autoLoad;delete a.autoLoad;var p=a.showFullPath;delete a.showFullPath;var q=a.includeRootNode;delete a.includeRootNode;var r=a.showSort;delete a.showSort;mini.TabsTreeSelect.superclass.set.call(this,a);mini.isNull(n)||this.setAutoLoad(n);mini.isNull(g)||this.setUrl(g);mini.isNull(f)||this.setTabs(f,this.autoLoad);mini.isNull(d)||this.setData(d);mini.isNull(b)||this.setValue(b);mini.isNull(c)||this.setText(c);mini.isNull(k)||this.setFilterUrl(k);mini.isNull(l)||this.setFilterMode(l);mini.isNull(p)||(this.showFullPath=p,this.tree.showFullPath=p);mini.isNull(q)||(this.includeRootNode=q,this.tree.includeRootNode=q);e&&(this.el.style.borderWidth="1px");r?this.showSort=r:this._buttons.removeChild(this.sortBtn);return this},actionTitles:{sort:"\u4e00\u952e\u6392\u5e8f",top:"\u7f6e\u9876",bottom:"\u7f6e\u5e95",remove:"\u5220\u9664",removeall:"\u5220\u9664\u5168\u90e8",recover:"\u56de\u5230\u521d\u59cb\u72b6\u6001"},sortTitles:{none:"\u4e00\u952e\u6392\u5e8f",asc:"\u6b63\u5e8f",desc:"\u5012\u5e8f"},_getActionBtn:function(a,b){var c=document.createElement("span");c.className="mini-tabstreeselect-action mini-icon "+a+("sort"===a?" none":"")+(b?" disabled":"");c.title=this.actionTitles[a];return c},_create:function(){this.el=document.createElement("div");this.el.className="mini-tabstreeselect";this.el.innerHTML='\x3cdiv class\x3d"mini-tabstreeselect-left"\x3e\x3cdiv class\x3d"mini-tabstreeselect-header"\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-tabstreeselect-content"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-tabstreeselect-right"\x3e\x3cdiv class\x3d"mini-tabstreeselect-header"\x3e\x3cdiv class\x3d"mini-tabstreeselect-header-main"\x3e\x3cspan class\x3d"mini-tabstreeselect-header-title"\x3e'+this.selectedPanelTitle+'\x3c/span\x3e\x3cspan class\x3d"mini-tabstreeselect-header-count hidden"\x3e\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-tabstreeselect-content"\x3e\x3c/div\x3e\x3c/div\x3e';this._leftPanel=this.el.firstChild;this._rightPanel=this.el.lastChild;this._leftHeader=this._leftPanel.firstChild;this._rightHeader=this._rightPanel.firstChild.firstChild;this._rightTitle=this._rightHeader.firstChild;this._rightCount=this._rightHeader.lastChild;this._leftHeader.innerHTML='\x3cul class\x3d"mini-tabstreeselect-tabs clearfix"\x3e\x3c/ul\x3e';this._tabs=this._leftHeader.firstChild;this._leftContent=this._leftPanel.lastChild;this._rightContent=this._rightPanel.lastChild;this.tree=new mini.FilterTree;this.tree.setShowTreeIcon(!0);this.tree.setStyle("border:0;width:100%;height:100%;overflow:hidden;");this.tree.setResultAsTree(this.resultAsTree);this.tree.setCheckRecursive(this.checkRecursive);this.tree.setShowCheckBox(!0);this.tree.setShowFolderCheckBox(this.showFolderCheckBox);this.tree.setExpandOnNodeClick(this.expandOnNodeClick);this.tree.setCheckOnTextClick(this.checkOnTextClick);this.tree.setAutoLoad(!0);this.tree.on("load",this.__OnLoad,this);this.tree.on("nodeclick",this.__OnNodeClick,this);this.tree.on("nodecheck",this.__OnCheckedChanged,this);this.tree.on("expand",this.__OnTreeExpand,this);this.tree.on("collapse",this.__OnTreeCollapse,this);this.tree.on("beforenodecheck",this.__OnTreeBeforeNodeCheck,this);this.tree.on("beforenodeselect",this.__OnTreeBeforeNodeSelect,this);this.tree.on("drawnode",this.__OnDrawNode,this);this.tree.on("loadnode",this.__OnLoadNode,this);this.tree.on("beforeload",this.__OnBeforeLoad,this);this.tree.on("filter",this.__OnFilter,this);this.tree.useAnimation=!0;this.tree.render(this._leftContent);this._rightContent.innerHTML='\x3cdiv class\x3d"mini-tabstreeselect-buttons"\x3e\x3c/div\x3e\x3cul class\x3d"mini-tabstreeselect-list"\x3e\x3c/ul\x3e';this._buttons=this._rightContent.firstChild;this._selectList=this._rightContent.lastChild;this._buttons.appendChild(this.sortBtn=this._getActionBtn("sort"));this._buttons.appendChild(this.topBtn=this._getActionBtn("top",!0));this._buttons.appendChild(this.bottomBtn=this._getActionBtn("bottom",!0));this._buttons.appendChild(this.recoverBtn=this._getActionBtn("recover"));this._buttons.appendChild(this.removeallBtn=this._getActionBtn("removeall"));this.selectNodes={};this.selectedCount=0;this._listItemTempl='\x3cli class\x3d"mini-tabstreeselect-item" guid\x3d"{{value}}"\x3e\x3cspan class\x3d"item-name" title\x3d"{{name}}"\x3e{{name}}\x3c/span\x3e\x3ci class\x3d"mini-tabstreeselect-action mini-icon remove" title\x3d"'+this.actionTitles.remove+'"\x3e\x3c/i\x3e\x3c/li\x3e';this.bindEvents()},__OnDrawNode:function(a){this.fire("drawnode",a)},__OnTreeBeforeNodeCheck:function(a){a.tree=a.sender;this.fire("beforenodecheck",a)},__OnTreeBeforeNodeSelect:function(a){a.tree=a.sender;this.fire("beforenodeselect",a)},__OnTreeExpand:function(a){this.fire("treeexpand",a)},__OnTreeCollapse:function(a){this.fire("treecollapse",a)},__OnNodeClick:function(a){this.fire("nodeclick",{node:a.node})},__OnBeforeLoad:function(a){this.fire("beforeload",a)},__OnCheckedChanged:function(a){a=a.node;a.checked?this._addNode(a):this._removeNode(a)},__OnLoadNode:function(a){var b=this.idField,c=this.tree,d=this.selectNodes;c.eachChild(a.node,function(a){d[a[b]]?c.checkNode(a):a.checked&&!a.isLeaf?c.checkNode(a):c.uncheckNode(a)})},__OnLoad:function(a){this.fire("load",a)},__OnFilter:function(a){this.tree.uncheckAllNodes();a=this.getValue().split(",");for(var b=0,c=a.length;b<c;b++){var d=this.tree.getNode(a[b]);d&&this.tree.checkNode(d)}},_addNode:function(a){var b=a[this.idField];if(this.canCheckParent||this.tree.isLeaf(a)&&!this.selectNodes[b])this.selectNodes[b]=a,"none"!=this._curAutoSortDirection?this._addNodeByDirection(a,this._curAutoSortDirection):mini.append(this._selectList,this._getItemHtml(a));else if(b=this.tree.getChildNodes(a),b.length||this.tree.isLeaf(a)){a=0;for(var c=b.length;a<c;a++)this._addNode(b[a])}else this.loadChildWhenChecked&&(this.tree._dataSource.loadParams.needAll=!0,this.tree.loadNode(a),this.tree._dataSource.loadParams.needAll=!1);this._selectList.style.height||(this._selectList.style.height=jQuery(this._rightContent).height()-jQuery(this._buttons).outerHeight(!0)+"px");this._setSelectedCount()},_addNodeByDirection:function(a,b){for(var c=this.tree.getValue().split(","),d=a[this.idField],e=0,f=c.length,g;e<f&&c[e]!==d;e++);(c="asc"===b?c[e-1]:c[e+1])&&(g=jQuery(this._selectList).find('[guid\x3d"'+c+'"]'));g&&g.length?$(this._getItemHtml(a)).insertAfter(g):$(this._selectList).prepend(this._getItemHtml(a))},_removeNode:function(a){var b=a[this.idField];delete this.selectNodes[b];jQuery(this._selectList).find('li[guid\x3d"'+b+'"]').remove();if(this.checkRecursive&!this.tree.isLeaf(a)){a=this.tree.getChildNodes(a);for(var b=0,c=a.length;b<c;b++)this._removeNode(a[b])}this._setSelectedCount()},_getItemHtml:function(a){return this._listItemTempl.replace(/{{name}}/g,this.tree.getItemText(a)).replace("{{value}}",a[this.idField])},bindEvents:function(){var a=this;jQuery(this._tabs).on("click","\x3e li",function(){var b=jQuery(this),c=b.index();b.hasClass("active")||a.activeTab(c)});jQuery(this._selectList).on("click",".remove",function(){var b=jQuery(this.parentNode),c=b.attr("guid"),d=a.tree.getNode(c);b.hasClass("selected")&&(a.selectedListNode=null);d?(a._removeNode(d),a.tree.uncheckNode(d)):(b.remove(),delete a.selectNodes[c],a._setSelectedCount());a._updateButtons()}).on("mousedown",".mini-tabstreeselect-item",function(b){a.dragItem=this;a.getDrag().start(b)}).on("click",".mini-tabstreeselect-item",function(){var b=jQuery(this);b.hasClass("selected")||(a.selectedListNode&&a.selectedListNode.removeClass("selected"),b.addClass("selected"),a.selectedListNode=b,a._updateButtons())});jQuery(this._buttons).on("click",".mini-tabstreeselect-action",function(){mini.hasClass(this,"disabled")||(mini.hasClass(this,"sort")&&a.toggleAutoSort(),mini.hasClass(this,"top")?(a.selectedListNode.insertBefore(a._selectList.firstChild),a.toggleAutoSort(!0)):mini.hasClass(this,"bottom")?(a.selectedListNode.insertAfter(a._selectList.lastChild),a.toggleAutoSort(!0)):mini.hasClass(this,"removeall")?a.clearAll():mini.hasClass(this,"recover")&&(a.setValue(a.value),a.setText(a.text)),a._updateButtons())})},getDrag:function(){this.drag||(this.drag=new mini.Drag({capture:!1,onStart:mini.createDelegate(this._OnDragStart,this),onMove:mini.createDelegate(this._OnDragMove,this),onStop:mini.createDelegate(this._OnDragStop,this)}));return this.drag},_OnDragStart:function(a){this._dragProxy=mini.append(document.body,'\x3cdiv class\x3d"mini-tabstreeselect-proxy"\x3e\x3c/div\x3e');this._dragProxy.innerHTML='\x3cdiv class\x3d"mini-tabstreeselect-proxy-inner"\x3e'+this.dragItem.outerHTML+"\x3c/div\x3e";mini.setXY(this._dragProxy,a.now[0]+15,a.now[1]+18);mini.setWidth(this._dragProxy,mini.getBox(this.dragItem).width);this.feedbackLine=mini.append(document.body,"\x3cdiv class\x3d'mini-feedback-line'\x3e\x3c/div\x3e");mini.addClass(this.dragItem,"dragging")},_OnDragMove:function(a){var b=a.now[1];mini.setXY(this._dragProxy,a.now[0]+15,b+18);this.targetItem=this.insertAction=null;(a=mini.findParent(a.event.target,"mini-tabstreeselect-item"))?(this.targetItem=a,this.insertAction="before",a=mini.getBox(this.targetItem),b>a.y+a.height/2&&(this.insertAction="after"),this.feedbackLine.style.display="block","after"==this.insertAction?mini.setXY(this.feedbackLine,a.x,a.y+a.height):mini.setXY(this.feedbackLine,a.x,a.y),mini.setWidth(this.feedbackLine,a.width)):this.feedbackLine.style.display="none"},_removeDrag:function(){mini.removeNode(this._dragProxy);mini.removeNode(this.feedbackLine);this._dragProxy=this.feedbackLine=this.dragItem=this.targetItem=null},_OnDragStop:function(a){this.targetItem&&("before"==this.insertAction?this._selectList.insertBefore(this.dragItem,this.targetItem):this._selectList.lastChild==this.targetItem?this._selectList.appendChild(this.dragItem):this._selectList.insertBefore(this.dragItem,this.targetItem.nextSibling),this.toggleAutoSort(!0));mini.removeClass(this.dragItem,"dragging");this._removeDrag()},_curAutoSortDirection:"none",toggleAutoSort:function(a){this.showSort&&(a=a?"none":this._getNextAutoSortDirection(),mini.removeClass(this.sortBtn,"asc desc none"),mini.addClass(this.sortBtn,a),this.sortBtn.setAttribute("title",this.sortTitles[a]),this._curAutoSortDirection=a,"none"!=a&&this._serverSort(a))},_getNextAutoSortDirection:function(){switch(this._curAutoSortDirection){case "asc":return"desc";default:return"asc"}},_serverSort:function(a){var b=this.getValue();a={url:this.treeUrl,data:{value:b,direction:a,eventType:"sortChanged"},sender:this};this.fire("beforesortchanged",a);b&&1<b.split(",").length&&this._loadValue(a)},_loadValue:function(a){var b=this,c=setTimeout(function(){b.mask();b.isMask=!0},100);jQuery.ajax({url:a.url,data:a.data,type:"post",dataType:"json",success:function(a){if(a=mini.getSecondRequestData(a)){var c=b.getValue(),d,g=0,k=0,l,n=[];b._selectList.innerHTML="";b.selectNodes={};if(a.value){d=a.value.split(",");a=a.text.split(",");for(k=d.length;g<k;g++)l={},l[b.idField]=d[g],l[b.textField]=a[g],b.selectNodes[d[g]]=l,n.push(b._getItemHtml(l));b._selectList.insertAdjacentHTML("afterbegin",n.join(""))}b._updateButtons();b._setSelectedCount(k);c!=b.getValue()&&b._OnValueChanged()}},complete:function(){c&&clearTimeout(c);b.isMask&&(b.unmask(),b.isMask=!1)}})},_updateButtons:function(){var a=function(a){mini.removeClass(a,"disabled")},b=function(a){mini.addClass(a,"disabled")};this.selectedListNode&&this.selectedListNode.siblings().length?this.selectedListNode.prev().length?this.selectedListNode.next().length?(a(this.topBtn),a(this.bottomBtn)):(a(this.topBtn),b(this.bottomBtn)):(b(this.topBtn),a(this.bottomBtn)):(b(this.topBtn),b(this.bottomBtn))},getSelectedNodes:function(){var a=[];jQuery(this._selectList).children("li").each(function(b,c){var d=jQuery(c);a.push({value:d.attr("guid"),text:d.text()})});return a},setSelectedNodes:function(a){for(var b=0,c=a.length;b<c;b++){var d=this.tree.getNode(a[b].value);d?this.tree.selectNode(d):(d={},d[this.textField]=a[b].text,d[this.idField]=a[b].value,this.selectNodes[a[b].value]=d,mini.append(this._selectList,this._getItemHtml(d)))}},clearAll:function(){this._selectList.innerHTML&&(this._selectList.innerHTML="",this.selectNodes={},this.selectedListNode=null,this.tree.uncheckAllNodes(),this._setSelectedCount(0))},setValue:function(a){this.value=a;var b=a.split(","),c=[];this.clearAll();if(a){a=0;for(var d=b.length;a<d;a++){var e=this.tree.getNode(b[a]);e?this.tree.checkNode(e):(e={},e[this.textField]=e[this.idField]=b[a]);this.selectNodes[b[a]]=e;c.push(this._getItemHtml(e))}mini.append(this._selectList,c.join(""));this._updateButtons();this._setSelectedCount()}},getValue:function(){var a=[];jQuery(this._selectList).children("li").each(function(b,c){a.push(jQuery(c).attr("guid"))});return a.join(",")},setText:function(a){if(this.text=a){a=a.split(",");for(var b=this.value.split(","),c=0,d=b.length,e,f;c<d;c++)if(f=b[c],e=this.selectNodes[f])e[this.textField]=a[c],jQuery(this._selectList).find('li[guid\x3d"'+f+'"]').find(".item-name").attr("title",a[c]).html(a[c])}},getText:function(){var a=[];jQuery(this._selectList).children("li").each(function(b,c){a.push(jQuery(c).find(".item-name").text())});return a.join(",")},setSelectedPanelTitle:function(a){this.selectedPanelTitle=a;this._rightTitle.innerHTML=a},_setSelectedCount:function(a){this.showSelectedCount&&(a=0<=a?a:jQuery(this._selectList).children("li").length,0!==a?mini.removeClass(this._rightCount,"hidden"):mini.addClass(this._rightCount,"hidden"),this._rightCount.innerHTML=a)},setShowSelectedCount:function(a){(this.showSelectedCount=!0===a?!0:!1)?mini.removeClass(this._rightCount,"hidden"):mini.addClass(this._rightCount,"hidden")},getShowSelectedCount:function(){return this.showSelectedCount},doLayout:function(){var a=jQuery(this.el).height();this._leftPanel.style.height=a+"px";this._rightPanel.style.height=a+"px";a=jQuery(this._rightContent).height()-jQuery(this._buttons).outerHeight(!0);this._selectList.style.height=(0<=a?a:0)+"px";this.tree.doLayout()},setTabs:function(a,b){var c,d,e=[],f=0<this.url.indexOf("?");this.tabsConfig=[];this.tabKeys=[];c=0;for(d=a.length;c<d;c++){e.push("\x3cli\x3e"+a[c].tabText+"\x3c/li\x3e");var g=(f?"\x26":"?")+"tabKey\x3d"+a[c].tabKey;this.tabsConfig.push({url:this.url+g,filterMode:a[c].filterMode,filterUrl:this.filterUrl?this.filterUrl+g:void 0});this.tabKeys.push(a[c].tabKey)}this._tabs.innerHTML=e.join("");this.doLayout();this.activeTab(0,b)},addTab:function(a,b){var c=(0<this.url.indexOf("?")?"\x26":"?")+"tabKey\x3d"+a.tabKey;this.tabsConfig.push({url:this.url+c,filterMode:a.filterMode,filterUrl:this.filterUrl?this.filterUrl+c:void 0});this.tabKeys.push(a.tabKey);jQuery("\x3cli\x3e"+a.tabText+"\x3c/li\x3e").appendTo(this._tabs);this.doLayout();!1!==b&&this.activeTab(this.tabsConfig.length-1,!0)},_activeTabIndex:0,activeTab:function(a,b){var c=this.tabsConfig[a],d=jQuery(this._tabs).children().eq(a);if(c){d.hasClass("active")||(d.siblings(".active").removeClass("active"),d.addClass("active"));this._activeTabIndex=a;d=this.tree._filterInput.getValue();this.tree._filterKey=d;c.filterMode&&this.tree.setFilterMode(c.filterMode);c.filterUrl&&this.tree.setFilterUrl(c.filterUrl);var e=d&&"server"===this.tree.filterMode;e?(this.tree.setAutoLoad(!1),this.tree.setUrl(c.url),this.treeUrl=c.url,this.tree._doFilter(d)):(!1===b?this.tree.setAutoLoad(!1):this.tree.setAutoLoad(!0),this.tree._dataSource.ajaxData={activeTab:!0},this.tree.setUrl(c.url),this.tree._dataSource.ajaxData=null,this.tree._dataSource.loadParams&&(this.tree._dataSource.loadParams.activeTab=!1),this.treeUrl=c.url,(e||!1===b)&&this.tree.setAutoLoad(!0),d&&this.tree._doFilter(d))}},setData:function(a){"string"==typeof a&&(a=eval("("+a+")"));mini.isArray(a)||(a=[]);this.resultAsTree?this.tree.setData(a):this.tree.loadList(a);this.data=this.tree.data},getData:function(){return this.data},setUrl:function(a){this.url=a;this._updateTabsUrl()},getUrl:function(){return this.url},getAutoLoad:function(){return this.autoLoad},setAutoLoad:function(a){this.autoLoad=a},setTabKeys:function(a){this.tabKeys=a;this._updateTabsUrl()},_updateTabsUrl:function(){var a,b=Math.min(this.tabKeys.length,this.tabsConfig.length),c=0<this.url.indexOf("?");if(0<b){for(a=0;a<b;a++){var d=(c?"\x26":"?")+"tabKey\x3d"+this.tabKeys[a];this.tabsConfig[a].url=this.url+d;this.tabsConfig[a].filterUrl=this.filterUrl?this.filterUrl+d:void 0}this.activeTab(0,this.autoLoad)}},load:function(){this.tree.load()},setResultAsTree:function(a){this.resultAsTree=a;this.tree&&this.tree.setResultAsTree(a)},getResultAsTree:function(){return this.resultAsTree},setParentField:function(a){this.parentField=a;this.tree&&this.tree.setParentField(a)},getParentField:function(){return this.parentField},setIdField:function(a){this.tree&&this.tree.setIdField(a);this.idField=a},getIdField:function(){return this.idField},getTextField:function(){return this.textField},setTextField:function(a){this.textField=a;this.tree&&this.tree.setTextField(a)},getNodesField:function(){return this.nodesField},setNodesField:function(a){this.nodesField=a;this.tree&&this.tree.setNodeField(a)},setShowTreeIcon:function(a){this.showTreeIcon=a;this.tree&&this.tree.setShowTreeIcon(a)},getShowTreeIcon:function(){return this.showTreeIcon},setShowTreeLines:function(a){this.showTreeLines=a;this.tree&&this.tree.setShowTreeLines(a)},getShowTreeLines:function(){return this.showTreeLines},setShowFolderCheckBox:function(a){this.showFolderCheckBox=a;this.tree&&this.tree.setShowFolderCheckBox(a)},getShowFolderCheckBox:function(){return this.showFolderCheckBox},setFilterUrl:function(a){this.filterUrl=a;this.tree&&this.tree.setFilterUrl(a)},getFilterUrl:function(){return this.filterUrl},setFilterMode:function(a){this.filterMode=a;this.tree&&this.tree.setFilterMode(a)},getFilterMode:function(){return this.filterMode},setCanCheckParent:function(a){this.canCheckParent=a;this.tree&&this.tree.setCheckRecursive(!a)},getCanCheckParent:function(){return this.canCheckParent},setCheckRecursive:function(a){this.checkRecursive=a;this.tree&&this.tree.setCheckRecursive(a)},getCheckRecursive:function(){return this.checkRecursive},setAutoCheckParent:function(a){this.autoCheckParent=a;this.tree&&this.tree.setAutoCheckParent(a)},getAutoCheckParent:function(){return this.AutoCheckParent},setExpandOnLoad:function(a){this.expandOnLoad=a;this.tree&&this.tree.setExpandOnLoad(a)},getExpandOnLoad:function(){return this.expandOnLoad},setCheckOnTextClick:function(a){this.checkOnTextClick=a;this.tree&&this.tree.setCheckOnTextClick(a)},getAttrs:function(a){var b=mini.TabsTreeSelect.superclass.getAttrs.call(this,a);mini._ParseString(a,b,"data textField pinyinField idField nodesField parentField onbeforenodecheck onbeforenodeselect onnodeclick url filterUrl filterMode onbeforeload onload ontreeexpand ontreecollapse ondrawnode selectedPanelTitle".split(" "));mini._ParseBool(a,b,"expandOnNodeClick expandOnLoad resultAsTree showTreeIcon showTreeLines showFolderCheckBox canCheckParent showBorder loadChildWhenChecked autoLoad checkRecursive autoCheckParent showFullPath includeRootNode checkOnTextClick showSelectedCount showSort".split(" "));var c=[];a=mini.getChildNodes(a);var d,e,f;e=0;for(f=a.length;e<f;e++)d={},mini._ParseString(a[e],d,["tabText","tabKey","filterMode"]),c.push(d);b.tabs=c;return b}});mini.regClass(mini.TabsTreeSelect,"tabstreeselect");mini.TreeSelect=function(){this.data=[];mini.TreeSelect.superclass.constructor.apply(this,arguments)};mini.extend(mini.TreeSelect,mini.PopupEdit,{valueFromSelect:!1,text:"",value:"",autoCheckParent:!1,expandOnLoad:!1,valueField:"id",textField:"text",nodesField:"children",dataField:"",delimiter:",",multiSelect:!1,data:[],url:"",allowInput:!1,showTreeIcon:!1,showTreeLines:!0,resultAsTree:!1,parentField:"pid",checkRecursive:!1,showFolderCheckBox:!1,showRadioButton:!1,showFilter:!1,filterMode:"client",filterUrl:"",showFullPath:!1,includeRootNode:!1,popupHeight:200,popupWidth:"100%",popupMaxHeight:250,popupMinWidth:100,setAjaxData:function(a){this.ajaxData=a;this.tree.setAjaxData(a)},setAjaxType:function(a){this.ajaxType=a;this.tree.setAjaxType(a)},setAjaxOptions:function(a){this.ajaxOptions=a;this.tree.setAjaxOptions(a)},set:function(a){if("string"==typeof a)return this;var b=a.value;delete a.value;var c=a.text;delete a.text;var d=a.url;delete a.url;var e=a.data;delete a.data;var f=a.showFullPath;delete a.showFullPath;var g=a.includeRootNode;delete a.includeRootNode;mini.TreeSelect.superclass.set.call(this,a);mini.isNull(e)||this.setData(e);mini.isNull(d)||this.setUrl(d);mini.isNull(b)||this.setValue(b);mini.isNull(c)||this.setText(c);mini.isNull(f)||(this.showFullPath=f,this.tree.showFullPath=f);mini.isNull(g)||(this.includeRootNode=g,this.tree.includeRootNode=g);return this},uiCls:"mini-treeselect",_createPopup:function(){mini.TreeSelect.superclass._createPopup.call(this);this.tree=new mini.FilterTree;this.tree.setShowTreeIcon(!0);this.tree.setStyle("border:0;width:100%;height:100%;overflow:hidden;");this.tree.setResultAsTree(this.resultAsTree);this.tree.render(this.popup._contentEl);this.tree.setCheckRecursive(this.checkRecursive);this.tree.setShowFolderCheckBox(this.showFolderCheckBox);this.tree.setShowRadioButton(this.showRadioButton);this.tree.setExpandOnNodeClick(this.expandOnNodeClick);mini.isNull(this.defaultRowHeight)||(this.tree.defaultRowHeight=this.defaultRowHeight);var a=this;this.tree.on("nodeclick",function(b){setTimeout(function(){a.__OnNodeClick(b)},10)},this);this.tree.on("nodecheck",this.__OnCheckedChanged,this);this.tree.on("expand",this.__OnTreeExpand,this);this.tree.on("collapse",this.__OnTreeCollapse,this);this.tree.on("beforenodecheck",this.__OnTreeBeforeNodeCheck,this);this.tree.on("beforenodeselect",this.__OnTreeBeforeNodeSelect,this);this.tree.on("drawnode",this.__OnDrawNode,this);this.tree.useAnimation=!1;this.tree.set({showToolbar:this.showFilter,filterMode:this.filterMode,filterUrl:this.filterUrl});a=this;this.tree.on("beforeload",function(b){a.fire("beforeload",b)},this);this.tree.on("load",function(b){a.fire("load",b)},this);this.tree.on("loaderror",function(b){a.fire("loaderror",b)},this)},__OnDrawNode:function(a){this.fire("drawnode",a)},__OnTreeBeforeNodeCheck:function(a){a.tree=a.sender;this.fire("beforenodecheck",a)},__OnTreeBeforeNodeSelect:function(a){a.tree=a.sender;this.fire("beforenodeselect",a);a.cancel&&(this._nohide=!0)},__OnTreeExpand:function(a){},__OnTreeCollapse:function(a){},findItems:function(a){return this.tree.findNodes(this.tree.getIdField(),a)},findNodes:function(a){return this.tree.getNodesByValue(a)},getSelectedNode:function(){return this.getSelectedNodes()[0]},getCheckedNodes:function(a){var b=this.tree.getNodesByValue(this.value);!1===a&&(a="leaf");return b=this.tree._dataSource.doGetCheckedNodes(b,a)},getSelectedNodes:function(){return this.tree.getNodesByValue(this.value)},getParentNode:function(a){return this.tree.getParentNode(a)},getChildNodes:function(a){return this.tree.getChildNodes(a)},showPopup:function(){var a={cancel:!1};this.fire("beforeshowpopup",a);this._firebeforeshowpopup=!1;1!=a.cancel&&(mini.TreeSelect.superclass.showPopup.call(this),this.tree.setValue(this.value,!1),this.expandOnPopup&&this.tree.expandPath(this.value),this._nohide=!1)},expandOnPopup:!1,setExpandOnPopup:function(a){this.expandOnPopup=a},getExpandOnPopup:function(){return this.expandOnPopup},__OnPopupHide:function(a){this.__doFocusCls();this.tree.clearFilter();this.fire("hidepopup")},getItem:function(a){return"object"==typeof a?a:this.data[a]},indexOf:function(a){return this.data.indexOf(a)},getAt:function(a){return this.data[a]},loadList:function(a,b,c){this.tree.loadList(a,b,c);this.data=this.tree.getData();this._getCheckedValue()},getList:function(){return this.tree.getList()},load:function(a){this.tree.load(a);this.data=this.tree.data;this._getCheckedValue()},_eval:function(a){return eval("("+a+")")},setData:function(a){"string"==typeof a&&(a=this._eval(a));mini.isArray(a)||(a=[]);this.tree.setData(a);this.data=this.tree.data;this._getCheckedValue()},getData:function(){return this.data},_getCheckedValue:function(){var a=this.tree.getValue();this.setValue(a)},setUrl:function(a){this.getPopup();this.tree.setUrl(a);this.url=this.tree.url;this.data=this.tree.data;this._getCheckedValue()},getUrl:function(){return this.url},virtualScroll:!1,setVirtualScroll:function(a){this.tree&&this.tree.setVirtualScroll(a);this.virtualScroll=a},getVirtualScroll:function(){return this.virtualScroll},defaultRowHeight:23,setDefaultRowHeight:function(a){this.tree&&(this.tree.defaultRowHeight=a);this.defaultRowHeight=a},getDefaultRowHeight:function(){return this.defaultRowHeight},pinyinField:"tag",setPinyinField:function(a){this.pinyinField=a},getPinyinField:function(){return this.pinyinField},setTextField:function(a){this.tree&&this.tree.setTextField(a);this.textField=a},getTextField:function(){return this.textField},setNodesField:function(a){this.tree&&this.tree.setNodesField(a);this.nodesField=a},getNodesField:function(){return this.nodesField},setDataField:function(a){this.tree&&this.tree.setDataField(a);this.dataField=a},getDataField:function(){return this.dataField},getValue:function(){var a=mini.TreeSelect.superclass.getValue.call(this);return this.valueFromSelect&&a&&0==this.findItems(a).length?"":a},setValue:function(a){var b=this.tree.getValueAndText(a);""!=b[1]||this.valueFromSelect||(b[0]=a,b[1]=a);this.value=a;this._valueEl.value=a;this.text=this._textEl.value=mini.htmlDecode(b[1]);this._doEmpty()},setMultiSelect:function(a){this.multiSelect!=a&&(this.multiSelect=a,this.tree.setShowCheckBox(a),this.tree.setAllowSelect(!a),this.tree.setEnableHotTrack(!a))},getMultiSelect:function(){return this.multiSelect},__OnNodeClick:function(a){if(!this.multiSelect){var b=this.tree.getSelectedNode(),b=this.tree.getValueAndText(b)[0],c=this.getValue();this.setValue(b);c!=this.getValue()&&this._OnValueChanged();!0!==this._nohide&&(this.hidePopup(),isMobile||this.focus());this._nohide=!1;this.fire("nodeclick",{node:a.node})}},__OnCheckedChanged:function(a){if(this.multiSelect){a=this.tree.getValue();var b=this.getValue();this.setValue(a);b!=this.getValue()&&this._OnValueChanged();isMobile||this.focus()}},__OnInputKeyDown:function(a){var b={htmlEvent:a};this.fire("keydown",b);if(8==a.keyCode&&(this.isReadOnly()||0==this.allowInput))return!1;if(9==a.keyCode)this.isShowPopup()&&this.hidePopup();else if(!this.isReadOnly())switch(a.keyCode){case 27:this.isShowPopup()&&a.stopPropagation();this.hidePopup();break;case 13:var c=this;setTimeout(function(){c.fire("enter",b)},10);break;case 37:break;case 38:a.preventDefault();break;case 39:break;case 40:a.preventDefault();this.showPopup();break;default:0!=this.allowInput&&(c=this,setTimeout(function(){c._doQuery()},10))}},_doQuery:function(){if(!this.multiSelect){var a=this.textField,b=this.pinyinField,c=this._textEl.value.toLowerCase();this.tree.filter(function(d){var e=String(d[a]?d[a]:"").toLowerCase();d=String(d[b]?d[b]:"").toLowerCase();return-1!=e.indexOf(c)||-1!=d.indexOf(c)?!0:!1});this.tree.expandAll();this.showPopup()}},setCheckRecursive:function(a){this.checkRecursive=a;this.tree&&this.tree.setCheckRecursive(a)},getCheckRecursive:function(){return this.checkRecursive},setResultAsTree:function(a){this.resultAsTree=a;this.tree&&this.tree.setResultAsTree(a)},getResultAsTree:function(){return this.resultAsTree},setParentField:function(a){this.parentField=a;this.tree&&this.tree.setParentField(a)},getParentField:function(){return this.parentField},setValueField:function(a){this.tree&&this.tree.setIdField(a);this.valueField=a},getValueField:function(){return this.valueField},setShowTreeIcon:function(a){this.showTreeIcon=a;this.tree&&this.tree.setShowTreeIcon(a)},getShowTreeIcon:function(){return this.showTreeIcon},setShowTreeLines:function(a){this.showTreeLines=a;this.tree&&this.tree.setShowTreeLines(a)},getShowTreeLines:function(){return this.showTreeLines},setShowFolderCheckBox:function(a){this.showFolderCheckBox=a;this.tree&&this.tree.setShowFolderCheckBox(a)},getShowFolderCheckBox:function(){return this.showFolderCheckBox},setShowRadioButton:function(a){this.showRadioButton=a;this.tree&&this.tree.setShowRadioButton(a)},getShowRadioButton:function(){return this.showRadioButton},setAutoCheckParent:function(a){this.autoCheckParent=a;this.tree&&this.tree.setAutoCheckParent(a)},getAutoCheckParent:function(){return this.autoCheckParent},setExpandOnLoad:function(a){this.expandOnLoad=a;this.tree&&this.tree.setExpandOnLoad(a)},getExpandOnLoad:function(){return this.expandOnLoad},setValueFromSelect:function(a){this.valueFromSelect=a},getValueFromSelect:function(){return this.valueFromSelect},setAjaxData:function(a){this.ajaxData=a;this.tree.setAjaxData(a)},setAjaxType:function(a){this.ajaxType=a;this.tree.setAjaxType(a)},expandOnNodeClick:!1,setExpandOnNodeClick:function(a){this.expandOnNodeClick=a;this.tree&&this.tree.setExpandOnNodeClick(a)},getExpandOnNodeClick:function(){return this.expandOnNodeClick},getFilterUrl:function(){return this.filterUrl||this.url},getShowFilter:function(){return this.showFilter},setShowFilter:function(a){this.showFilter=a;this.tree.set({showToolbar:a})},setFilterUrl:function(a){this.filterUrl=a;this.tree.setFilterUrl(a)},getFilterMode:function(){return this.filterMode},setFilterMode:function(a){this.filterMode=a;this.tree.setFilterMode(a)},clear:function(){this.tree._filterInput.setValue("");this.tree._doFilter("")},getAttrs:function(a){var b=mini.TreeSelect.superclass.getAttrs.call(this,a);mini._ParseString(a,b,"url data textField pinyinField valueField nodesField parentField onbeforenodecheck onbeforenodeselect expandOnLoad onnodeclick onbeforeload onload onloaderror ondrawnode filterMode filterUrl".split(" "));mini._ParseBool(a,b,"expandOnNodeClick multiSelect resultAsTree checkRecursive showTreeIcon showTreeLines showFolderCheckBox showRadioButton autoCheckParent valueFromSelect virtualScroll expandOnPopup showFilter showFullPath includeRootNode".split(" "));mini._ParseInt(a,b,["defaultRowHeight"]);b.expandOnLoad&&(a=parseInt(b.expandOnLoad),mini.isNumber(a)?b.expandOnLoad=a:b.expandOnLoad="true"==b.expandOnLoad?!0:!1);return b}});mini.regClass(mini.TreeSelect,"TreeSelect");jQuery(function(){setTimeout(function(){try{var a=mini.getActiveElement();if(a){var b=jQuery(a).closest(".mini-buttonedit, .mini-textbox");if(b.length){var c=mini.get(b[0]);c&&(c.blur(),c.focus())}}}catch(d){}},100)});mini.VerifyCode=function(){mini.VerifyCode.superclass.constructor.apply(this,arguments)};mini.extend(mini.VerifyCode,mini.Control,{url:"",autoLoad:!0,width:78,height:26,charLength:4,uiCls:"mini-verifycode",set:function(a){if("string"==typeof a)return this;var b=a.url;delete a.url;mini.VerifyCode.superclass.set.call(this,a);b&&this.setUrl(b);return this},_create:function(){this.el=document.createElement("div");this.el.innerHTML='\x3cimg title\x3d"\u770b\u4e0d\u6e05\u695a\uff0c\u6362\u4e00\u4e2a\uff1f"\x3e\x3c/img\x3e';this._img=this.el.firstChild},_initEvents:function(){var a=this;mini.on(this._img,"click",function(){a._doLoad({width:parseInt(this.width),height:parseInt(this.height),charLength:a.charLength})})},setData:function(a){this.value=a.value;this._img.src=a.src;this.uuid=a.uuid},setUrl:function(a){this.url=a;this.autoLoad&&this._doLoad({width:parseInt(this.width),height:parseInt(this.height),charLength:this.charLength})},getUrl:function(){return this.url},_doLoad:function(a){a=a||{};var b={url:this.url,async:!1,type:this.ajaxType?this.ajaxType:"post",data:a,params:a,cache:!1,cancel:!1};this.fire("beforeload",b);b.data!=b.params&&b.params!=a&&(b.data=b.params);if(1!=b.cancel){var c=me=this,d=b.url;mini.copyTo(b,{success:function(a,f,g){delete b.params;f={text:a,result:null,sender:me,options:b,xhr:g};g=null;try{mini_doload(f),(g=f.result)||(g=mini.decode(a))}catch(k){1==mini_debugger&&alert(d+"\njson is error.")}g={data:g};a={data:g.data,cancel:!1,result:g};c.fire("preload",a);1!=a.cancel&&(c.setData(a.data),delete a.cancel,c.fire("load",a))},error:function(a,b,g){a={xhr:a,text:a.responseText,textStatus:b,errorMsg:a.responseText,errorCode:a.status};1==mini_debugger&&alert(d+"\n"+a.errorCode+"\n"+a.errorMsg);c.fire("loaderror",a)}});this._ajaxer=mini.ajax(b)}},getAttrs:function(a){var b=mini.VerifyCode.superclass.getAttrs.call(this,a);mini._ParseString(a,b,"url data onbeforeload onload onloaderror onpreload".split(" "));mini._ParseBool(a,b,["autoLoad"]);mini._ParseInt(a,b,["charLength"]);return b}});mini.regClass(mini.VerifyCode,"verifycode");mini.WebEditor=function(){mini.WebEditor.superclass.constructor.call(this)};mini.extend(mini.WebEditor,mini.Control,{width:"100%",height:"350px",readOnly:!1,editstyle:"coolblue",editSkin:"flat10",value:"",uiCls:"mini-webeditor",formField:!0,_editorModel:window.mini_editor_model||"ewebeditor",_create:function(){this.el=document.createElement("div");this.el.innerHTML='\x3ctextarea style\x3d"display:none"\x3e\x3c/textarea\x3e';this._fromEditor=this.el.firstChild;this._editor=new mini.TextArea;this._editor.setVisible(!1);this._editor.render(this.el);var a=this;this.externalSrc=this.externalSrc||mini.externalSrc;"ewebeditor"===this._editorModel?window.EWEBEDITOR?this._initEditor():mini.loadJS(this.externalSrc+"ewebeditor/ewebeditor.js",function(){a._initEditor()}):window.UE?this._initEditor():mini.loadJS(this.externalSrc+"ueditor/ueditor.config.js",function(){mini.loadJS(a.externalSrc+"ueditor/ueditor.all.js",function(){a._initEditor()})})},render:function(a){mini.WebEditor.superclass.constructor.call(this,a)},_initEditor:function(){var a=this;setTimeout(function(){a._doInitEditor()},1)},_doInitEditor:function(){if(!1!==this.isRender()&&!this.editor){var a=this;this._editor.set({name:this.id,id:this.id+"_editor"});this._fromEditor.id=this.id+"_fromEditor";"ewebeditor"===this._editorModel?(this.editor=EWEBEDITOR.Replace(this._fromEditor.id,{width:this.width.replace("px",""),height:this.height.replace("px",""),readonly:this.readOnly?"2":"",style:this.editstyle,skin:this.editSkin}),this.fire("init",{sender:this,type:"init"})):(this.editor=UE.getEditor(this._fromEditor.id,{initialFrameWidth:this.width.replace("px",""),readonly:this.readOnly}),this.editor.ready(function(){a.editor.container.parentElement.style.display="";a.value&&a.editor.setContent(a.value);a._$toolbar=jQuery(a.editor.container).find(".edui-editor-toolbarbox");a._$footer=jQuery(a.editor.container).find(".edui-editor-bottomContainer");a.setHeight(a.height);a.fire("init",{sender:a,type:"init"})}))}},getEditor:function(){return this.editor},getEditorPromise:function(a){function b(){if(50<e++)return d.reject(Error("\u5bcc\u6587\u672c\u63a7\u4ef6\u521d\u59cb\u5316\u8d85\u65f6\uff01"));var f=c.editor;f?setTimeout(function(){d.resolve(f);"function"===typeof a&&a(f)}):setTimeout(b,20)}var c=this,d=jQuery.Deferred(),e=0;b();return d.promise()},setValue:function(a){this.value=this._fromEditor.value=a;"ewebeditor"===this._editorModel?window.EWEBEDITOR&&EWEBEDITOR.SetHtmlAsync(this._fromEditor.id,a):this.editor&&this.editor.isReady&&this.editor.setContent(a)},getValue:function(){if("ewebeditor"===this._editorModel){if(this.editor&&this.editor.getHTML)return this.editor.getHTML()}else if(this.editor&&this.editor.isReady)return this.editor.getContent();return this.value},setSubmitData:function(){this._editor&&this._editor.setValue(this.getValue())},getSubmitData:function(){return this._editor?this._editor.getValue():this.getValue()},setReadOnly:function(a){this.editor&&("ewebeditor"===this._editorModel?this.editor.setReadOnly(a?"2":""):this.editor.isReady&&(a?this.editor.setDisabled("fullscreen"):this.editor.setEnabled()));this.readOnly=a},getReadOnly:function(){return this.readOnly},setHeight:function(a){"ueditor"===this._editorModel&&(a="100%"==a?jQuery(this.el.parentElement).height():parseInt(a))&&(this.height=a,this.editor&&this.editor.isReady&&this.editor.setHeight(a-this._$toolbar.height()-this._$footer.height()))},getAttrs:function(a){var b=mini.WebEditor.superclass.getAttrs.call(this,a);b.text=a.innerHTML;mini._ParseString(a,b,["value","text","editstyle","editSkin","oninit"]);mini._ParseBool(a,b,["readOnly"]);return b}});mini.regClass(mini.WebEditor,"webeditor");mini.WebUploader=function(){mini.WebUploader.superclass.constructor.call(this)};mini.extend(mini.WebUploader,mini.Control,{uiCls:"mini-webuploader",uploadUrl:"",limitType:"",mimeTypes:"",auto:!0,fileNumLimit:void 0,fileSizeLimit:void 0,fileSingleSizeLimit:void 0,fileNameLengthLimit:100,chunked:!1,chunkSize:5120,chunkRetry:2,duplicate:void 0,needMD5:!1,compress:!1,timeout:12E4,externalSrc:"",state:"pending",pickerText:"\u9009\u62e9\u6587\u4ef6",startText:"\u5f00\u59cb\u4e0a\u4f20",pauseText:"\u6682\u505c\u4e0a\u4f20",numLimitErrorText:"\u9009\u62e9\u7684\u6587\u4ef6\u8fc7\u591a\uff01\x3c/br\x3e\u6700\u591a\u53ef\u4e0a\u4f20{0}\u4e2a\u6587\u4ef6",sizeLimitErrorText:"\u9009\u62e9\u7684\u6587\u4ef6\u8fc7\u5927\uff01\x3c/br\x3e\u6700\u591a\u53ef\u4e0a\u4f20{0}KB\u6587\u4ef6",typeDeniedErrorText:"\u9009\u62e9\u7684\u6587\u4ef6\u7c7b\u578b\u9519\u8bef\uff01\x3c/br\x3e\u53ef\u4e0a\u4f20\u7684\u6587\u4ef6\u7c7b\u578b\u4e3a\uff1a{0}",sizeErrorText:"\u9009\u62e9\u7684\u6587\u4ef6\u8fc7\u5927\uff01\x3c/br\x3e\u53ef\u4e0a\u4f20\u7684\u5355\u6587\u4ef6\u6700\u5927\u4e3a{0}KB",emptyFileErrorText:"\u4e0d\u80fd\u4e0a\u4f20\u7a7a\u6587\u4ef6\uff01",duplicateErrorText:"\u4e0d\u80fd\u4e0a\u4f20\u91cd\u590d\u7684\u6587\u4ef6\uff01",fileNameLengthErrorText:"\u9009\u62e9\u7684\u6587\u4ef6\u540d\u79f0\u957f\u5ea6\u8fc7\u957f\uff01\x3c/br\x3e\u6587\u4ef6\u540d\u6700\u957f\u4e3a{0}\u4e2a\u5b57\u7b26",set:function(a){if("string"==typeof a)return this;var b=a.pickerText;delete a.pickerText;mini.WebUploader.superclass.set.call(this,a);b&&(this.pickerText=b,this._picker.innerHTML=b);this._initUploader();return this},_create:function(){this.el=document.createElement("div");this.el.innerHTML='\x3cdiv class\x3d"mini-uploader-btns"\x3e\x3clabel class\x3d"mini-btn-pick"\x3e\x3ci class\x3d"mini-button-icon icon-upload"\x3e\x3c/i\x3e\x3cspan class\x3d"mini-btn-pick-text"\x3e'+this.pickerText+'\x3c/span\x3e\x3c/label\x3e\x3c/div\x3e\x3cdiv class\x3d"mini-uploader-list"\x3e\x3c/div\x3e';this._buttons=this.el.firstChild;this._fileList=this.el.lastChild;this._$fileList=jQuery(this._fileList);this._picker=this._buttons.firstChild;this._pickerText=this._picker.lastChild;this._uploadBtn=new mini.Button;this._uploadBtn.setText(this.startText);this._uploadBtn.render(this._buttons);this._errorContent="";this._buttons.style.visibility="hidden";this.on("render",this._initUploader,this)},_isInit:!1,_initUploader:function(){var a=this;this.isInit||(this.externalSrc=this.externalSrc||mini.externalSrc,window.WebUploader?this._createUploader():mini.loadJS(this.externalSrc+"webuploader/webuploader.min.js",function(){a._createUploader()}),this.isInit=!0)},_createUploader:function(){var a=null,b=this;this.limitType&&(a={extensions:this.limitType,mimeTypes:this.mimeTypes});this._fileMD5={};this.chunked&&!this._isInit?(this._hasFinishedList={},window.isRegWebUploader||(WebUploader.Uploader.register({"before-send-file":"preupload","before-send":"checkchunk","after-send-file":"finished"},{preupload:function(a){var c=this.owner,e=this.options.server,f=WebUploader.Deferred(),g=$(a.source._refer).closest(".mini-webuploader");b=mini.getAndCreate(g[0]);if(b.chunked)return c.md5File(a.source).fail(function(){f.reject()}).then(function(c){b._fileMD5[a.id]=c;a.uuid=UUID();c={url:e,data:{fileMD5:c,fileName:a.name,fileSize:a.size,uploadGuid:a.uuid}};b._onBeforeMd5File(c);$.ajax(c.url,{dataType:"json",data:c.data,type:"post",success:function(c){b._onMd5File(c,a);f.resolve()},error:function(){f.reject();$.ajaxSettings.error&&$.ajaxSettings.error.apply(this,arguments)}})}),f.promise()},checkchunk:function(a){if(b.chunked){a=","+a.chunk+",";var c=$.Deferred();-1<b._existFileParts.indexOf(a)?c.reject():c.resolve();return c.promise()}},finished:function(a){var c=WebUploader.Deferred();if(b.chunked)if(b._hasFinishedList[a.id])b._hasFinishedList[a.id]=!1,delete b._hasFinishedList[a.id];else{var e={url:b.uploadUrl,data:{fileMD5:b._fileMD5[a.id],fileName:a.name,fileSize:a.size,uploadGuid:a.uuid,contentType:a.type}};b._onBeforeMd5FileFinished(e);$.ajax(e.url,{dataType:"json",data:e.data,type:"post",success:function(c){b._onMd5FileFinished(c,a);delete b._fileMD5[a.id]},error:function(){c.reject();$.ajaxSettings.error&&$.ajaxSettings.error.apply(this,arguments)}})}}}),window.isRegWebUploader=!0)):this.needMD5&&WebUploader.Uploader.register({"before-send-file":"preupload"},{preupload:function(a){var c=this.owner,e=WebUploader.Deferred();c.md5File(a.source).fail(function(){e.reject()}).then(function(c){b._fileMD5[a.id]=c;e.resolve()});return e.promise()}});try{this._uploader=WebUploader.create({swf:this.externalSrc+"webuploader/Uploader.swf",server:this.uploadUrl,pick:{id:this._picker,multiple:1==this.fileNumLimit?!1:!0},auto:this.auto,fileNumLimit:this.fileNumLimit,fileSizeLimit:1024*this.fileSizeLimit,fileSingleSizeLimit:1024*this.fileSingleSizeLimit,accept:a,chunked:this.chunked,chunkSize:1024*this.chunkSize,chunkRetry:this.chunkRetry,compress:this.compress,duplicate:this.duplicate,timeout:this.timeout})}catch(c){if("Runtime Error"==c.message){if(mini.isIE9||mini.isIE8||mini.isIE7||mini.isIE6)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(d){b.el.innerHTML='\x3ca class\x3d"noflash" title\x3d"\u8981\u4f7f\u7528\u4e0a\u4f20\u529f\u80fd\uff0c\u8bf7\u4e0b\u8f7d\u5b89\u88c5Falsh\u540e\uff0c\u5237\u65b0\u9875\u9762" href\x3d"http://get.adobe.com/flashplayer/" target\x3d"_blank"\x3e\u521d\u59cb\u5316\u9519\u8bef\x3c/a\x3e',mini.showPageWarning({html:'\u68c0\u6d4b\u5230\u60a8\u7684\u7cfb\u7edf\u672a\u5b89\u88c5Flash\uff0c\u4e0a\u4f20\u529f\u80fd\u4e0d\u53ef\u7528\u3002\u8bf7\x3ca href\x3d"http://get.adobe.com/flashplayer/" target\x3d"_blank"\x3e\u4e0b\u8f7d\u5b89\u88c5Falsh\x3c/a\x3e\u540e\uff0c\u5237\u65b0\u9875\u9762'})}}else throw c;return}this._uploader.on("beforeFileQueued",function(a){return b._beforeFileQueued(a)}).on("filesQueued",function(a){b._onFilesQueued(a)}).on("fileDequeued",function(a){b._onFileDequeued(a)}).on("reset",function(){b._onReset()}).on("startUpload",function(){b._onStartUpload()}).on("stopUpload",function(){b._onStopUpload()}).on("uploadFinished",function(){b._onUploadFinished()}).on("uploadStart",function(a){b._onUploadStart(a)}).on("uploadBeforeSend",function(a,d,e){b._onUploadBeforeSend(a,d,e)}).on("uploadAccept",function(a,d){return b._onUploadAccept(a,d)}).on("uploadProgress",function(a,d){b._onUploadProgress(a,d)}).on("uploadSuccess",function(a,d){b._onUploadSuccess(a,d)}).on("uploadError",function(a,d){b._onUploadError(a,d)}).on("uploadComplete",function(a){b._onUploadComplete(a)}).on("all",function(a){"startUpload"===a?b.state="uploading":"stopUpload"===a?b.state="paused":"uploadFinished"===a&&(b.state="done");b.auto||"uploading"!==b.state?b._uploadBtn.setText(b.startText):b._uploadBtn.setText(b.pauseText)}).on("error",function(a){switch(a){case "Q_EXCEED_NUM_LIMIT":b._errorContent=String.format(b.numLimitErrorText,b.fileNumLimit);break;case "Q_EXCEED_SIZE_LIMIT":b._errorContent=String.format(b.sizeLimitErrorText,b.fileSizeLimit);break;case "Q_TYPE_DENIED":b._errorContent=String.format(b.typeDeniedErrorText,b.limitType);break;case "F_EXCEED_SIZE":b._errorContent=String.format(b.sizeErrorText,b.fileSingleSizeLimit);break;case "Q_EMPTY_FILE":b._errorContent=b.emptyFileErrorText;break;case "F_DUPLICATE":b._errorContent=b.duplicateErrorText}}).on("ready",function(){b.enabled||b._uploader.disable();b.fire("init",{sender:b,type:"init"})});if(this.auto)this._uploadBtn.hide();else this._uploadBtn.on("click",function(){"uploading"===b.state?b._uploader.stop(!0):b._uploader.upload()});this._buttons.style.visibility="visible";this._isInit=!0},getFileList:function(){return this._fileList},getUploader:function(){return this._uploader},getUploaderPromise:function(a){function b(){if(50<e++)return d.reject(Error("\u4e0a\u4f20\u63a7\u4ef6\u521d\u59cb\u5316\u8d85\u65f6\uff01"));var f=c._uploader;f?setTimeout(function(){d.resolve(f);"function"===typeof a&&a(f)}):setTimeout(b,20)}var c=this,d=jQuery.Deferred(),e=0;b();return d.promise()},retry:function(a){this._uploader.retry(a)},removeFile:function(a){this._uploader.removeFile(a,!0)},clearFile:function(){for(var a=this._uploader.getFiles(),b=a.length-1;0<=b;b--)this.removeFile(a[b])},refresh:function(){this._uploader.refresh()},_beforeFileQueued:function(a){if(this._events.beforefilequeued)return a={source:this,sender:this,type:"beforefilequeued",file:a,cancel:!1},this.fire("beforefilequeued",a),a.cancel?!1:!0},_onFilesQueued:function(a){this._errorContent&&mini.alert(this._errorContent);this._errorContent="";this.fire("filesqueued",{files:a})},_onFileDequeued:function(a){this.fire("filedequeued",{file:a})},_onReset:function(){this.fire("reset")},_onStartUpload:function(){this.fire("startupload")},_onStopUpload:function(){this.fire("stopupload")},_onUploadFinished:function(){this.fire("uploadfinished")},_onUploadStart:function(a){this.fire("uploadstart",{file:a})},_onUploadBeforeSend:function(a,b,c){!this.chunked&&this.needMD5&&(b.fileMD5=this._fileMD5[b.id],delete this._fileMD5[b.id]);this.fire("uploadbeforesend",{object:a,data:b,headers:c})},_onUploadAccept:function(a,b){if(this._events.uploadaccept){var c={source:this,sender:this,type:"uploadaccept",object:a,ret:b,cancel:!1};this.fire("uploadaccept",c);return c.cancel?!1:!0}},_onUploadProgress:function(a,b){this.fire("uploadprogress",{file:a,percentage:b})},_onUploadSuccess:function(a,b){this.fire("uploadsuccess",{file:a,ret:b})},_onUploadError:function(a,b){this.fire("uploaderror",{file:a,reason:b})},_onUploadComplete:function(a){this.fire("uploadcomplete",{file:a})},_onBeforeMd5File:function(a){this.fire("beforemd5file",a)},_onBeforeMd5FileFinished:function(a){this.fire("beforemd5filefinished",a)},_existFileParts:"",_onMd5File:function(a,b){a.fileFinished?(this._uploader.skipFile(b),this._hasFinishedList[b.id]=!0):(this._existFileParts=a.existFileParts||"",this._existFileParts=","+this._existFileParts+",")},_onMd5FileFinished:function(a,b){},setUploadUrl:function(a){this.uploadUrl=a;this._uploader&&this._uploader.option("server",a)},getUploadUrl:function(){return this.uploadUrl},setAuto:function(a){this.auto=a;this._uploader&&this._uploader.option("auto",a)},getAuto:function(){return this.auto},defaultCompres:{width:1600,height:1600,quality:90,allowMagnify:!1,crop:!1,preserveHeaders:!0,noCompressIfLarger:!1,compressSize:0},setCompress:function(a){this.compress=a?this.defaultCompres:!1;this._uploader&&this._uploader.option("compress",this.compress)},getCompress:function(){return this.compress?!0:!1},setFileNumLimit:function(a){this.fileNumLimit=a;this._uploader&&this._uploader.option("fileNumLimit",a)},getFileNumLimit:function(){return this.fileNumLimit},setFileSizeLimit:function(a){this.fileSizeLimit=a;this._uploader&&this._uploader.option("fileSizeLimit",1024*a)},getFileSizeLimit:function(){return this.fileSizeLimit},setFileSingleSizeLimit:function(a){this.fileSingleSizeLimit=a;this._uploader&&this._uploader.option("fileSingleSizeLimit",1024*a)},getFileSingleSizeLimit:function(){return this.fileSingleSizeLimit},getLimitType:function(){return this.limitType},setLimitType:function(a){this.limitType!=a&&(this.limitType=a,this._uploader&&(this._uploader.options.accept||(this._uploader.options.accept=[{}]),this._uploader.options.accept[0].extensions=this.limitType,this._uploader._init({accept:this._uploader.options.accept})))},getMimeTypes:function(){return this.mimeTypes},setMimeTypes:function(a){if(this.mimeTypes!=a&&(this.mimeTypes=a,this._uploader&&(this._uploader.options.accept||(this._uploader.options.accept=[{}]),this._uploader.options.accept[0].mimeTypes=this.mimeTypes,"flash"!=this._uploader.predictRuntimeType()))){var b=function(a){var d=jQuery(c.options.pick.id).find('input[type\x3d"file"]');d.length?d.attr("accept",a):setTimeout(function(){b(a)},100)},c=this._uploader;b(this.mimeTypes)}},setVisible:function(a){this.visible=a;this.el&&(a?(mini.removeClass(this.el,"invisible"),mini.removeClass(this._buttons,"webuploader-element-invisible")):(mini.addClass(this.el,"invisible"),mini.addClass(this._buttons,"webuploader-element-invisible")))},setEnabled:function(a){(this.enabled=a)?(this.removeCls(this._disabledCls),this._uploader&&this._uploader.enable()):(this.addCls(this._disabledCls),this._uploader&&this._uploader.disable());this._doReadOnly()},getDuplicate:function(){return this.duplicate},setPickerText:function(a){this.pickerText=a;var b=this._picker.children[0];b?b.innerHTML=a:this._picker.innerHTML=a},getPickerText:function(){return this.pickerText},getAttrs:function(a){var b=mini.WebUploader.superclass.getAttrs.call(this,a);b.text=a.innerHTML;mini._ParseString(a,b,"uploadUrl limitType mimeTypes onbeforefilequeued onfilesqueued onfiledequeued onreset onstartupload onstopupload onuploadfinished onuploadstart onuploadbeforesend onuploadaccept onuploadprogress onuploadsuccess onuploaderror onuploadcomplete pickerText onbeforemd5file onbeforemd5filefinished oninit".split(" "));mini._ParseBool(a,b,["auto","chunked","compress","needMD5","duplicate"]);mini._ParseInt(a,b,"fileNumLimit fileSizeLimit fileSingleSizeLimit chunkSize chunkRetry timeout".split(" "));return b}});mini.regClass(mini.WebUploader,"webuploader");