<!-- 
        作者：guotq
        创建时间: 2017/06/19
        版本: [1.0, 2017/07/07 ]
        版权: 江苏国泰新点软件有限公司
        描述： 典型的轮播+列表页面
        包括轮播，列表，详情，暂时轮播结构就放到下拉刷新中
-->
<!DOCTYPE html >
<html lang="zh-CN">

    <head>
        <meta charset="UTF-8">
        <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
        <meta name="format-detection" content="telephone=no, address=no, email=no">
        <title>列表</title>
        <script>
            document.write("<script src='../../../js/cssboot.js?" + Math.random() + "'></scr" + "ipt>");
        </script>
        <style>
            body,
            .mui-content {
                background-color: #F5F5F5;
            }
            
            .msg-title {
                font-size: 15px;
            }
            
            .msg-fs14 {
                font-size: 14px;
                color: #999;
            }
            
            .msg-date {
                float: right;
            }
            
            .mui-table-view-cell:after {
                left: 0;
            }
        </style>
    </head>

    <body>
        <div class="mui-content ">
            <div id="pullrefresh" class="mui-scroll-wrapper">
                <div class="mui-scroll">
                    <div id="gallery"></div>
                    <ul class="mui-table-view" id="listdata">

                    </ul>
                </div>
            </div>
        </div>

        <script type="text/x-tpl" id="item-template">
            <li class="mui-table-view-cell" id="{{guid}}">
                <h3 class="msg-title">
                    {{title}}
                </h3>
                <span class="msg-fs14 msg-date">
                    {{date}}
                </span>
            </li>
        </script>

        <script>
            document.write("<script src='../../../js/jsboot.js?" + Math.random() + "'></scr" + "ipt>");
        </script>
        <script>
            "use strict";

            Util.loadJs([
                // 下拉刷新
                'js/widgets/pulltorefresh/pulltorefresh.skin.default.js',
                'js/widgets/gallery/gallery.js'
            ], ['js/widgets/pulltorefresh/pulltorefresh.bizlogic.impl.js'], function() {
                initPage();
            });

            function initPage() {
                new Gallery({
                    url: '//115.29.151.25:8012/request.php?action=testV7Gallery',
                    dataRequest: JSON.stringify({
                        token: 'RXBvaW50X1dlYlNlcml2Y2VfKiojIzA2MDE=',
                        params: {
                            picnum: 3,
                            catenum: '222'
                        }
                    }),
                    itemClick: function(e, id) {
                        console.log("点击:" + id);
                    }
                });

                new PullToRefreshTools.bizlogic({
                    setting: {
                        scroll: {
                            // 是否嵌套，嵌套的话就不会preventDefault了
                            eventPassthrough: 'horizontal'
                        }
                    },
                    url: '//115.29.151.25:8012/request.php?action=testListDemoV7',
                    dataRequest: function(currPage) {
                        return JSON.stringify({
                            token: 'RXBvaW50X1dlYlNlcml2Y2VfKiojIzA2MDE=',
                            params: {
                                pageindex: currPage,
                                pagesize: 10,
                                keyword: 'type1'
                            }
                        });
                    },
                    itemClick: function(e) {
                        // 这里为了作为示例，方便多版本的EJS，所以用的框架内置的兼容API，实际情况请用对应版本的EJS API
                        Util.ejs.page.open('./detail.html');
                    }
                });
            }
        </script>
    </body>

</html>