<!DOCTYPE html>
<html>

<head>
<title></title>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />

<script src="../../../fui/js/cssboot.js"></script>
</head>

<body>
	<div class="page-loading"></div>

		<!-- toolbar area -->
		<div class="fui-toolbar">
			<div class="btn-group mr10">
				<div id="uploader" pickerText="Select the file upload" class="mini-webuploader" action="activityattachlistaction.getFileUploadModel" 
					fileSingleSizeLimit="5120" limitType="doc,docx,txt,rar,zip,jpg,jpeg,pdf,xls,xlsx,gif,bmp,png" mimeTypes="" auto="true"
					onuploadfinished="searchData" showDefaultUI="false"></div>
				<a style="display: none;" class="mini-button" id="del" iconCls="icon-removecircle" onclick="if(mini.get('datagrid').getSelecteds().length==0){epoint.alert('Please select you want to delete the attachment!', '', null, 'info');} else {epoint.confirm('Sure to delete?','',deleteSelected);}">delete selected</a> 
				<a class="mini-button" id="close" iconCls="icon-save" onclick="epoint.closeDialog">Confirm and close</a>
			</div>
		</div>

		<div id="fuiContent" class="fui-content">
			<div id="datagrid" name="datagrid" class="mini-datagrid" 
				idField="attachguid" multiSelect="true" action="getDataGridData"
				style="width: 100%; height: 100%;" allowResize="true"
				showPager="false"
				allowCellSelect="true">
				<div property="columns">
					<div type="checkcolumn" width="50"></div>
					<div field="attachfilename"  headerAlign="center" width="100%">
						Name of the attachment 
					</div>
					<div field="adddate" width="100"  headerAlign="center" width="200">
						Add the time 
					</div>
					<div headerAlign="center" align="center" width="80" renderer="onDownLoadRender">
					          download
					</div>
				</div>
			</div>
			
		</div>

	
 
 	<script type="text/javascript">var miniLocal='en_US.js';</script>
 	<script src="../../../../rest/resource/jsboot"></script>

	<!-- Configuration Variables -->
	<script>
		//<![CDATA[
		//Initialize the page
		epoint.initPage('activityattachlistaction', null, initCallback);
        
        function initCallback (data)
        {
	        if (data.type == "add")
	        {
	        	document.getElementById ("del").style.display = 'none';
		        document.getElementById ("uploader").style.display = '';
	        }
	        else if (data.type == "del")
	        {
		        document.getElementById ("del").style.display = '';
		        document.getElementById ("uploader").style.display = 'none';
	        }
	        else if (data.type == "addanddel")
	        {
		        document.getElementById ("del").style.display = '';
		        document.getElementById ("uploader").style.display = '';
	        }
	        else{
	        	document.getElementById ("uploader").style.display = 'none';
	            document.getElementById ("del").style.display = 'none';
	        }	
        }
	
		function deleteSelected() {
			epoint.execute('activityattachlistaction.delete', 'datagrid', searchData);
		}
		
		// Search for tables
		function searchData() {
			mini.get('uploader').clearFile();
			epoint.refresh();
		}
		
		//Apply colours to a drawingdownloadbutton
        var onDownLoadRender = function (e)
        {
        	if(e.row.attachguid)
        		return epoint.renderCell (e, "action-icon icon-download", "downloadReport", "attachguid");
        }
        
        function downloadReport(attachGuid){
        	window.open("../../../../mis/base/attach/attachdown?attachGuid=" + attachGuid);
        }
		
		//]]>
	</script>

</body>

</html>
	
	
