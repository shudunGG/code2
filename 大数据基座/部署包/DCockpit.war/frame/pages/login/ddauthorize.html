<!DOCTYPE html>
<html>

<head>
<title></title>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<meta name="renderer" content="webkit">
<link rel="stylesheet" href="sso/css/common.css" />
<link rel="stylesheet" href="sso/css/login.css" />

<script src="../../../frame/fui/js/cssboot.js"></script>
</head>

<body>
	<div class="page-loading"></div>

	<script src="../../../rest/resource/jsboot"></script>
	<script src="sso/js/dingtalk.js"></script>
	<!-- 配置变量 -->
	<script>
		dd.ready(function() {
			var corpId = Util.getUrlParams("corpid");
			dd.runtime.permission.requestAuthCode({
				corpId : corpId,
				onSuccess : function(result) {
					// 加上页面地址中的请求参数
					var all = window.location.href;
					var index = all.indexOf('?');
                    // 页面替换，防止返回到当前页
					location.replace('../rest/oauth2/authorize?' + all.substring(index + 1)+ "&code=" + result.code);
					//window.location.href = '../rest/oauth2/authorize?' + all.substring(index + 1)+ "&code=" + result.code;
					/*{
					    code: 'hYLK98jkf0m' //string authCode
					}*/
				},
				onFail : function(err) {
					alert(err);
				}
			});
		});
	</script>
</body>

</html>
