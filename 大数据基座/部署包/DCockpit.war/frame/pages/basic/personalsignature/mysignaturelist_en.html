<!DOCTYPE html>
<html>

	<head>
		<title>Individuality signature</title>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />

		<script src="../../../../frame/fui/js/cssboot.js"></script>
	</head>
	<body>

		<!-- Wait for the tooltip -->
		<div class="page-loading"></div>

		<!-- Button area -->
		<div class="fui-toolbar">
			<div class="btn-group mr10">
				<a class="mini-button" onclick="addSignature" iconCls="icon-addcircle">add</a><a
				class="mini-button" onclick="saveSignature" iconCls="icon-save">save</a><a
				class="mini-button" onclick="deleteSignature" iconCls="icon-minuscircle">delete</a>
			</div>
		</div>

		<!-- Content area -->
	<div class="fui-content">

		<div id="datagrid" name="datagrid" class="mini-datagrid"
			idField="sysGuid" multiSelect="true" allowCellValid="true"
			style="width: 100%; height: 100%;" allowResize="true"
			showPager="false" action="getDataGridData" allowCellEdit="true"
			allowCellSelect="true" editNextOnEnterKey="true" allowCellWrap="true"
			editNextRowCell="true">

			<div property="columns">
				<div type="checkcolumn" width="40"></div>
				<div type="indexcolumn" width="40" headerAlign="center">order
				</div>
				<div name="subject" field="subject" headerAlign="center" width="300"
					vtype="required;maxLength:50">
					title <input property="editor" class="mini-textbox"
						vtype="maxLength:50" required="true"
						requiredErrorText="The title cannot be empty" />
				</div>
				<div field="signContent" headerAlign="center" width="100%">
					signature</div>
				<div field="orderNumber" headerAlign="center" align="right"
					width="150" vtype="int">
					order no <input property="editor" class="mini-textbox" vtype="int" />
				</div>
				<div width="150" align="center" headerAlign="center"
					renderer="onEditRenderer">edit</div>
			</div>
		</div>
	</div>



	<script type="text/javascript">var miniLocal='en_US.js';</script>
 	<script src="../../../../rest/resource/jsboot"></script>

		<script>
			//<![CDATA[
			//Initialize the page
			epoint.initPage("mysignaturelistaction");

			//The new callback event
			function addCallBack(data) {
				epoint.refresh("datagrid",'',true);
			}

			//The new signature
			function addSignature() {
				epoint.openDialog("The new signature", 'frame/pages/basic/personalsignature/mysignature', addCallBack, {
					'width' : 1100,
					'height' : 500
				});
			}

			//Apply colours to a drawingeditbutton
			function onEditRenderer(e) {
				return epoint.renderCell(e, "action-icon icon-edit", "editSignature", "sysGuid");
			}

			//edit
			function editSignature(sysguid) {
				epoint.openDialog("editThe signature", 'frame/pages/basic/personalsignature/mysignature?sysGuid=' + sysguid, addCallBack, {
					'width' : 1100,
					'height' : 500
				});
			}

			//Save the signature
			function saveSignature() {
				var grid = mini.get("datagrid");
				grid.validate();
				if (grid.isValid() == false) {
					var error = grid.getCellErrors()[0];
					grid.beginEditCell(error.record, error.column);
					return;
				}
				var ids = grid.getSelectedIds();
				if (ids.length > 0) {
					epoint.execute("saveSignature", "datagrid", [ids.join(',')], saveCallback);
				}
			}

			//Save the callback event
			function saveCallback(data) {
				epoint.alert(data.msg, null, null, 'info');
				epoint.refresh(["datagrid"],'',true);
			}

			//Delete the signature
			function deleteSignature() {
				var datagrid = mini.get('datagrid');
				var ids = datagrid.getSelectedIds();
				if (ids.length > 0) {
					epoint.confirm("Sure to delete the selected record?", "", function(action) {
						epoint.execute("deleteSignature", "", [ids.join(',')], function(data) {
							if (data.msg) {
								epoint.alert(data.msg, null, null, 'info');
								epoint.refresh(["datagrid"],'',true);
							}
						});
					});
				} else {
					epoint.alert("Please choose to delete records!", null, null, 'info');
				}
			}

			//]]>
		</script>
	</body>
</html>
