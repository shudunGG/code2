<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta name="renderer" content="webkit">
    <script src="./config.js"></script>
    <link rel="stylesheet" href="./css/index.css">
    <title>数字一体化智能运维平台</title>
</head>

<body>
    <div class="head">
        <img src="images/title.png" alt="" />
    </div>

    <ul class="total-count clearfix">
        <li>
            <p><span id="total-visit">0</span>个</p>
            <h6>访问服务总数</h6>
        </li>
        <li>
            <p><span id="total-access">0</span>个</p>
            <h6>接入应用总数</h6>
        </li>
    </ul>
    <!-- 流程 -->
    <div class="process-count" id="processCount">
        <!-- 流程节点 -->
        <ul class="process-items">
            <li>
                <p id="logCollect"><span id="processCollect">0</span>条</p>
                <h6>日志数采集</h6>
            </li>
            <li>
                <p></p>
                <h6>实时分析服务</h6>
            </li>
            <li>
                <span class="add" id="add-storage">+1</span>
                <p><span id="processStorage">0</span><em id="storageUnit">条</em></p> 
                <h6>日志入库</h6>
            </li>
            <li>
                <p></p>
                <h6>离线分析服务</h6>
            </li>
            <li class="model-analyse">
                <h6>算法分析模型</h6>
                <ul class="analyse-lists">
                    <li>风险预警</li>
                    <li>突发事件分析</li>
                    <li>异常访问行为分析</li>
                </ul>
            </li>
            <li class="warning-con">
                <span class="add" id="add-warning">+1</span>
                <p><span id="processWarningVal">0</span><em id="warningUnit">条</em></p>
                <h6>预警警报</h6>
            </li>
        </ul>
        <!-- 线、箭头 -->
        <ul class="process-lines">
            <li>
                <span class="arrow"></span>
                <span class="arrow"></span>
            </li>
            <li>
                <span class="arrow"></span>
                <span class="arrow"></span>
            </li>
            <li>
                <span class="arrow"></span>
                <span class="arrow"></span>
                <p>读取</p>
            </li>
            <li>
                <span class="arrow"></span>
                <span class="arrow"></span>
                <p>建立、优化</p>
            </li>
            <li>
                <span class="arrow"></span>
                <span class="arrow"></span>
                <p>引用</p>
            </li>
            <li class="warning-line">
                <span class="arrow"></span>
                <span class="arrow"></span>
            </li>
        </ul>
        <div class="warning-box warning">
            <h6>API预警情况</h6>
            <div class="warning-scroll" id="warningScroll">
                <ul id="warningList">
                </ul>
            </div>
        </div>
    </div>
    <div class="row-con flex">
        <div class="item">
            <h3 class="item-title">API调用情况</h3>
            <div class="count-top clearfix">
                <div class="count-left">
                    <div class="guage-count">
                        <p><span id="call-rate">0</span>%</p>
                        <div class="gauge-con">
                            <div class="gauge">
                                <div id="gaugeRot"></div>
                            </div>
                            <div class="pointer"></div>
                        </div>
                    </div>
                    <ul>
                        <li>API累计调用次数<p><span id="callTotal">0</span><em id="callUnit">条</em></p>
                        </li>
                        <li>成功率<p><span id="call-success">0</span>%</p>
                        </li>
                    </ul>
                </div>
                <div class="trend-chart">
                    <h6 class="sub-title">调用趋势</h6>
                    <div class="chart" id="callTrend"></div>
                </div>
            </div>
            <div class="line-chart">
                <h6 class="sub-title">调用历史</h6>
                <div class="chart" id="callHistory"></div>
            </div>
        </div>
        <div class="item">
            <h3 class="item-title">API调用流量</h3>
            <div class="count-top clearfix">
                <div class="count-left flex">
                    <div class="max-count">
                        <div class="max-con">
                            <h6>API<br />请求总流量</h6>
                            <p><span id="maxRequest">0</span><em id="requestUnit">b</em></p> 
                        </div>
                        <h5>1天内</h5>
                    </div>
                    <div class="max-count">
                        <div class="max-con">
                            <h6>API<br />响应总流量</h6>
                            <p><span id="maxResponse">0</span><em id="responseUnit">b</em></p>
                        </div>
                        <h5>1天内</h5>
                    </div>
                </div>
                <div class="trend-chart">
                    <h6 class="sub-title">流量趋势</h6>
                    <div class="chart" id="flowrateTrend"></div>
                </div>
            </div>
            <div class="line-chart">
                <h6 class="sub-title">历史流量</h6>
                <div class="chart" id="responseFlowrate"></div>
            </div>
        </div>
        <div class="item response-count">
            <h3 class="item-title">API响应时间</h3>
            <div class="count-top clearfix">
                <div class="count-left">
                    <span></span>
                </div>
                <div class="trend-chart">
                    <h6 class="sub-title">响应时间趋势</h6>
                    <div class="chart" id="responseTrend"></div>
                </div>
            </div>
            <div class="line-chart">
                <h6 class="sub-title">平均响应时间</h6>
                <div class="chart" id="responseTime"></div>
            </div>
        </div>
    </div>
    <script type="text/template" id="warning-temp">
        {{#data}}
        <li>
            <div class="info-row clearfix">
                <span>发送时间：</span>
                <p>{{time}}</p>
            </div>
            <div class="info-row clearfix">
                <span>预警原因：</span>
                <p>{{reason}}</p>
            </div>
            <div class="info-row clearfix">
                <span>产生后果：</span>
                <p>{{result}}</p>
            </div>
            <div class="info-row clearfix">
                <span>处理方式：</span>
                <p>{{way}}</p>
            </div>
        </li>
        {{/data}}
    </script>
    <script>
        ResBoot.output(Config.resExport.js);

        // 此处配置主要用于对接开发人员
        // 启用页面模拟接口，实际对接修改为false
        window.isMock = false;
        // 页面模块接口
        Config.pageInterface = {
       		'time': "/getTime", // 请求流程定时刷新时间
       		'total': '/getTotal', // 访问服务总数、接入应用总数
            'process': '/getProcess', //流程图
            'callSituation': '/getCallSituation', // API调用情况
            'callFlowrate': '/getCallFlowrate', // API调用流量
            'responseTime': '/getResponseTime' // API响应时间
        }
        // mock接口
        /* Config.pageInterface = {
        		'time': "/getTime", // 请求流程定时刷新时间
                'total': 'total', // 访问服务总数、接入应用总数
                'process': 'process', //流程图
                'callSituation': 'callSituation', // API调用情况
                'callFlowrate': 'callFlowrate', // API调用流量
                'responseTime': 'responseTime' // API响应时间
         } */
        // 各模块刷新时间,单位ms
        Config.moduleRefresh = {
            'process': 10000 // 流程定时请求数据（10秒）
        }

        if (window.isMock) {
            ResBoot.output([
                './mock/jquery.mockjax.js',
                './mock/_testIndex.js'
            ]);
        }
    </script>

    <!-- 在这里引入其他第三方库 -->
    <script src="./js/libs/jquery.scrollbox.min.js"></script>
    <script src="./js/libs/mustache.min.js"></script>
    <!-- 引入页面js -->
    <script src="./js/index.js"></script>
</body>

</html>