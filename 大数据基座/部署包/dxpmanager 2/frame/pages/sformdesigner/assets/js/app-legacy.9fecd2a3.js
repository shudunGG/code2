(function(t){function e(e){for(var o,i,l=e[0],s=e[1],c=e[2],d=0,u=[];d<l.length;d++)i=l[d],a[i]&&u.push(a[i][0]),a[i]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(t[o]=s[o]);h&&h(e);while(u.length)u.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],o=!0,i=1;i<n.length;i++){var l=n[i];0!==a[l]&&(o=!1)}o&&(r.splice(e--,1),t=s(s.s=n[0]))}return t}var o={},i={app:0},a={app:0},r=[];function l(t){return s.p+"assets/js/"+({}[t]||t)+"-legacy."+{"chunk-5a3568d5":"81ef6e44"}[t]+".js"}function s(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(t){var e=[],n={"chunk-5a3568d5":1};i[t]?e.push(i[t]):0!==i[t]&&n[t]&&e.push(i[t]=new Promise(function(e,n){for(var o="assets/css/"+({}[t]||t)+"."+{"chunk-5a3568d5":"c7ca1cfc"}[t]+".css",a=s.p+o,r=document.getElementsByTagName("link"),l=0;l<r.length;l++){var c=r[l],d=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(d===o||d===a))return e()}var u=document.getElementsByTagName("style");for(l=0;l<u.length;l++){c=u[l],d=c.getAttribute("data-href");if(d===o||d===a)return e()}var h=document.createElement("link");h.rel="stylesheet",h.type="text/css",h.onload=e,h.onerror=function(e){var o=e&&e.target&&e.target.src||a,r=new Error("Loading CSS chunk "+t+" failed.\n("+o+")");r.code="CSS_CHUNK_LOAD_FAILED",r.request=o,delete i[t],h.parentNode.removeChild(h),n(r)},h.href=a;var f=document.getElementsByTagName("head")[0];f.appendChild(h)}).then(function(){i[t]=0}));var o=a[t];if(0!==o)if(o)e.push(o[2]);else{var r=new Promise(function(e,n){o=a[t]=[e,n]});e.push(o[2]=r);var c,d=document.createElement("script");d.charset="utf-8",d.timeout=120,s.nc&&d.setAttribute("nonce",s.nc),d.src=l(t),c=function(e){d.onerror=d.onload=null,clearTimeout(u);var n=a[t];if(0!==n){if(n){var o=e&&("load"===e.type?"missing":e.type),i=e&&e.target&&e.target.src,r=new Error("Loading chunk "+t+" failed.\n("+o+": "+i+")");r.type=o,r.request=i,n[1](r)}a[t]=void 0}};var u=setTimeout(function(){c({type:"timeout",target:d})},12e4);d.onerror=d.onload=c,document.head.appendChild(d)}return Promise.all(e)},s.m=t,s.c=o,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(n,o,function(e){return t[e]}.bind(null,o));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],d=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var h=d;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0015":function(t,e,n){"use strict";var o=n("2ff2"),i=n.n(o);i.a},"026d":function(t,e,n){"use strict";var o=n("b6d4"),i=n.n(o);i.a},"034f":function(t,e,n){"use strict";var o=n("64a9"),i=n.n(o);i.a},"165c":function(t,e,n){"use strict";var o=n("519c"),i=n.n(o);i.a},1728:function(t,e,n){},"25cd":function(t,e,n){"use strict";var o=n("9d87"),i=n.n(o);i.a},"2e74":function(t,e,n){"use strict";var o=n("89c5"),i=n.n(o);i.a},"2ff2":function(t,e,n){},"301b":function(t,e,n){},3176:function(t,e,n){"use strict";var o=n("82ad"),i=n.n(o);i.a},"3a3a":function(t,e,n){},"3f3e":function(t,e,n){},4260:function(t,e,n){"use strict";n("ac6a"),n("f3e2"),n("2caf"),n("6b54"),n("87b3");function o(){var t=+new Date,e=1e9*(1e4*Math.random()>>>0),n=(e+t).toString(32);return o._store[n]?o():(o._store[n]=!0,n)}o._store={},o.adapt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t.id},n=o._store;Array.isArray(t)&&t.forEach(function(t){var o=e(t);n[o]?console.warn("id duplicated",t.id):n[o]=o})};var i=o,a=n("7618");n("28a5");function r(t,e){var n=e.split(".");if(1===n.length)return t[e];var o,i=0,r=t,l=n.length;while(1){if(i==l-1)return r[n[i]];if(o=r[n[i]],!o||"object"!=Object(a["a"])(o))return console.error("无法获取嵌套属性 at "+n[i],t,e),null;r=o,i++}}function l(t,e,n){var o=e.split(".");if(1===o.length)return t[e]=n;var i,r=0,l=t,s=o.length-1;do{i=l[o[r]],i&&"object"==Object(a["a"])(i)?l=i:console.error("无法设置嵌套属性 at "+o[r],t,e),r++}while(r<s);return l.hasOwnProperty(o[r])||console.warn("设置原来没有的属性："+o[r]+" at ",l),l[o[r]]=n}function s(t){return JSON.parse(JSON.stringify(t))}var c=s,d=n("adb5");function u(t){var e=document.createElement("div");return e.appendChild(document.createTextNode(t)),e.innerHTML}function h(t){var e=document.createElement("div");return e.innerHTML=t,e.innerText}var f=n("9827");function p(t){return window.encodeURIComponent(window.btoa(window.encodeURIComponent(t)))}function m(t){return window.decodeURIComponent(window.atob(window.decodeURIComponent(t)))}function g(t,e,n){var o=t-e,i=n-t;return o>=0&&i>=0?t:Math.abs(o)>=Math.abs(i)?n:e}n.d(e,"l",function(){return i}),n.d(e,"g",function(){return r}),n.d(e,"k",function(){return l}),n.d(e,"d",function(){return c}),n.d(e,"i",function(){return d["b"]}),n.d(e,"h",function(){return u}),n.d(e,"a",function(){return g}),n.d(e,"c",function(){return f["b"]}),n.d(e,"b",function(){return f["a"]}),n.d(e,"j",function(){return f["d"]}),n.d(e,"f",function(){return p}),n.d(e,"e",function(){return m});d["a"],d["b"],f["b"],f["a"]},"469a":function(t,e,n){},"519c":function(t,e,n){},5443:function(t,e,n){"use strict";var o=n("3f3e"),i=n.n(o);i.a},"56d7":function(t,e,n){"use strict";n.r(e);n("bd49"),n("450d");var o=n("18ff"),i=n.n(o),a=(n("960d"),n("defb")),r=n.n(a),l=(n("cb70"),n("b370")),s=n.n(l),c=(n("cbb5"),n("8bbc")),d=n.n(c),u=(n("826b"),n("c263")),h=n.n(u),f=(n("a7cc"),n("df33")),p=n.n(f),m=(n("0c67"),n("299c")),g=n.n(m),v=(n("eca7"),n("3787")),b=n.n(v),y=(n("1951"),n("eedf")),C=n.n(y),w=(n("e960"),n("b35b")),x=n.n(w),_=(n("016f"),n("486c")),D=n.n(_),k=(n("1f1a"),n("4e4b")),T=n.n(k),S=(n("9d4c"),n("e450")),O=n.n(S),E=(n("fe07"),n("6ac5")),I=n.n(E),L=(n("b5d8"),n("f494")),A=n.n(L),$=(n("d4df"),n("7fc1")),j=n.n($),M=(n("560b"),n("dcdc")),R=n.n(M),z=(n("7f7f"),n("10cb"),n("f3ad")),P=n.n(z),V=(n("9e1f"),n("6ed5")),F=n.n(V),B=(n("0fb7"),n("f529")),N=n.n(B),H=(n("6611"),n("e772")),W=n.n(H),G=(n("425f"),n("4105")),U=n.n(G),q=(n("cadf"),n("551c"),n("f751"),n("097d"),n("a026")),J=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{style:"height:"+t.height+"px",attrs:{id:"app"}},[n("Main")],1)},X=[],Y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"design-container"},[n("div",{staticClass:"design-head"},[t._v("\n    "+t._s(t.formTitle)+"\n    "),n("Shuttle",{ref:"shuttle"}),t.showLocalBtns?n("span",{staticClass:"fe-mock-buttons"},[n("button",{staticStyle:{"margin-right":"10px"},on:{click:t.save}},[t._v("本地暂存")]),n("button",{staticStyle:{"margin-right":"10px"},on:{click:t.getLocalData}},[t._v("还原本地存储")]),n("button",{staticStyle:{"margin-right":"10px"},on:{click:t.clear}},[t._v("清空内容")])]):t._e(),n("div",{staticClass:"design-head-right",staticStyle:{float:"right"}},[n("el-switch",{staticClass:"view-toggle",attrs:{"active-value":"real","inactive-value":"design","active-text":"真实模式","inactive-text":"设计模式"},model:{value:t.viewType,callback:function(e){t.viewType=e},expression:"viewType"}}),t.showLocalBtns?n("el-button",{staticClass:"preview-btn",attrs:{type:"primary",size:"mini",disabled:!t.design.length},on:{click:t.preview}},[t._v("预览")]):t._e(),n("el-button",{staticClass:"js-btn",attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.openEditor("js")}}},[t._v("js编辑")]),n("el-button",{staticClass:"css-btn",attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.openEditor("css")}}},[t._v("css编辑")]),n("el-button",{staticClass:"save-btn",attrs:{type:"primary",size:"mini",disabled:!t.design.length},on:{click:t.saveToServer}},[t._v("保存")])],1)],1),n("div",{staticClass:"design-body",class:{narrow:t.narrowMode}},[n("div",{staticClass:"design-leftbar"},[n("Accordion",{attrs:{title:"布局"}},[n("PanelLayout")],1),n("Accordion",{attrs:{title:"控件"}},[n("PanelControl")],1)],1),n("div",{staticClass:"design-view-container",class:"view-"+t.viewType},[t.dataLoaded?n("Design",{attrs:{designData:t.design,size:t.formSize}}):t._e()],1),n("div",{staticClass:"design-rightbar",class:{pickup:t.narrowMode&&t.rightbarHidden}},[t.narrowMode?n("el-button",{staticClass:"design-rightbar-toggle",attrs:{icon:"el-icon-d-arrow-right",plain:""},on:{click:function(e){t.rightbarHidden=!t.rightbarHidden}}}):t._e(),n("Tabs",{attrs:{"default-active":"form",value:t.rightActiveTab},on:{input:t.activeRightTab}},[n("TabPanel",{attrs:{label:"表单设置",name:"form"}},[t.dataLoaded?n("ConfigForm"):t._e()],1),n("TabPanel",{attrs:{label:"组件设置",name:"control"}},[t.selectedControl?n("ConfigControl",{attrs:{control:t.selectedControl}}):t._e(),t.selectedRowId?n("ConfigRow",{attrs:{"row-id":t.selectedRowId}}):t._e(),t.selectedControl||t.selectedRowId?t._e():n("div",[t._v("请选择控件或行")])],1),n("TabPanel",{attrs:{label:"单元格",name:"cell"}},[t.selectedColId?n("ConfigCell",{attrs:{"selected-col":t.selectedCol}}):n("div",[t._v("请选择单元格")])],1)],1)],1)]),t.needRender?n("RowGender",{ref:"builder",attrs:{list:t.design,"global-style":t.globalStyle}}):t._e(),n("el-dialog",{attrs:{"append-to-body":"",title:t.editorDialog.title,visible:t.editorDialog.show,width:"90","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!0,fullscreen:"","custom-class":"code-editor-dialog","before-close":t.closeEditorDialog},on:{"update:visible":function(e){return t.$set(t.editorDialog,"show",e)},opened:t.onEditorDialogOpened}},[t.editorDialog.display?n("Editor",{attrs:{code:t.editorDialog.code,language:t.editorDialog.lang},on:{save:t.saveEditorCode,cancel:t.closeEditorDialog}}):t._e()],1)],1)},K=[],Q=n("75fc"),Z=(n("2caf"),n("f3e2"),n("ac6a"),n("5df3"),n("cebc")),tt=(n("386d"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tabs-view"},[n("div",{staticClass:"tabs-head"},t._l(t.panels,function(e,o){return n("div",{key:e.name,staticClass:"tab-head",class:t.active==e.name?t.activeClass:"",on:{click:function(e){return t.activeTab(o)}}},[t._v(t._s(e.label))])}),0),n("div",{staticClass:"tabs-body-wrap"},[n("div",{staticClass:"tabs-body",style:{width:t.width,marginLeft:t.marginLeft}},[t._t("default")],2)])])}),et=[],nt=(n("6d67"),n("d25f"),{methods:{getPercent:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,n=Math.pow(10,e);return(Math.floor(100*t*n)/n).toFixed(2)+"%"}}}),ot=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tab-body",style:{width:t.width},attrs:{"data-name":t.name}},[t._t("default")],2)},it=[],at={name:"tab-panel",inject:["tabCount","activeIndex"],mixins:[nt],props:{label:{type:String,required:!0},name:{type:String,required:!0}},computed:{width:function(){return this.getPercent(1/this.tabCount)}}},rt=at,lt=n("2877"),st=Object(lt["a"])(rt,ot,it,!1,null,null,null),ct=st.exports,dt={mixins:[nt],props:{defaultActive:{type:String},activeClass:{type:String,default:"active"},value:{type:String}},components:{TabPanel:ct},provide:function(){return{tabCount:this.tabCount,activeIndex:this.activeIndex}},data:function(){return{active:this.value||this.defaultActive,tabCount:0}},computed:{panels:function(){var t=this.$slots.default.filter(function(t){return t.tag&&t.componentOptions&&"tab-panel"===t.componentOptions.Ctor.options.name}),e=t.map(function(t){return t.componentOptions.propsData});return e},activeIndex:function(){if(this.panels.length)for(var t=0;t<this.panels.length;t++)if(this.panels[t].name==this.active)return t;return 0},width:function(){return this.getPercent(this.tabCount)},marginLeft:function(){return"-"+this.getPercent(this.activeIndex)}},watch:{panels:{immediate:!0,handler:function(){this.tabCount=this.panels.length}},value:function(t){t&&(this.active=t)},active:function(t){this.$emit("input",t)}},methods:{activeTab:function(t){this.active=this.panels[t].name}}},ut=dt,ht=(n("6f10"),Object(lt["a"])(ut,tt,et,!1,null,null,null)),ft=ht.exports,pt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("draggable",{staticClass:"layout-drag-area left-panel layout",attrs:{list:t.layoutList,group:{name:"layout",pull:"clone",put:!1},swapThreshold:"0.3",sort:!1,clone:t.createLayout,move:t.checkMove},on:{change:t.log,start:t.onDragStart,end:t.onDragEnd}},t._l(t.layoutList,function(e,o){return n("div",{key:e.id||o,staticClass:"template-item layout-item",class:e.type},[n("span",{staticClass:"template-item-icon layout",class:e.icon}),n("span",{staticClass:"template-item-name"},[t._v(t._s(e.name))])])}),0)},mt=[],gt=(n("0cd8"),n("2f62")),vt=n("4260");function bt(t,e,n){this.$children.forEach(function(o){var i=o.$options.name;i===t?o.$emit.apply(o,[e].concat(n)):bt.apply(o,[t,e].concat([n]))})}var yt={methods:{dispatch:function(t,e,n){var o=this.$parent||this.$root,i=o.$options.name;while(o&&(!i||i!==t))o=o.$parent,o&&(i=o.$options.name);o&&o.$emit.apply(o,[e].concat(n))},broadcast:function(t,e,n){bt.call(this,t,e,n)}}},Ct={name:"panel-layout",data:function(){return{layoutList:[{name:"一行2列",icon:"col-2",cols:[1,1],type:"row-layout"},{name:"一行4列",icon:"col-4",cols:[1,1,1,1],type:"row-layout"},{name:"一行6列",icon:"col-6",cols:[1,1,1,1,1,1],type:"row-layout"},{name:"1：5",icon:"col-2",cols:[1,5],type:"row-layout"},{name:"1：2：1：2",icon:"col-4",cols:[1,2,1,2],type:"row-layout"},{name:"多行多列",icon:"col-multi",cols:[],type:"row-layout"}]}},mixins:[yt],computed:Object(Z["a"])({},Object(gt["e"])(["formSize"]),{initialBorder:function(){return this.$store.state.globalStyle.border}}),mounted:function(){this.dispatch("accordion","updated")},methods:Object(Z["a"])({},Object(gt["d"])(["layoutDragStart","layoutDragEnd"]),{createLayout:function(t){var e=Object(vt["l"])();if("row-layout"==t.type){var n=vt["j"].getIndex(t.name),o={id:e,name:"",autoIndex:n,namePrefix:t.name,cols:this.createCols(t.cols,e),height:38};return 0==t.cols.length&&(o.asMulti=!0,o.cols=this.createCols([1],e)),o}},createCols:function(t,e){var n=this,o=t.reduce(function(t,e){return t+e},0),i=this.formSize.width;return t.map(function(t){var a=vt["b"].getIndex(e);return{id:"col-".concat(e,"-").concat(a),name:"col-".concat(a),style:{verticalAlign:"middle",textAlign:"center",width:i*t/o,border:Object(vt["d"])(n.initialBorder)},subs:[],controls:[]}})},checkMove:function(t){if(this.$el==t.to||this.$el.compareDocumentPosition(t.to)&Node.DOCUMENT_POSITION_CONTAINED_BY)return!1;var e=t.draggedContext.element;return!(1==e.cols&&!t.to.classList.contains("level-0"))&&void 0},onDragStart:function(){this.layoutDragStart()},onDragEnd:function(){this.layoutDragEnd()},log:function(){var t;(t=console).log.apply(t,arguments)}})},wt=Ct,xt=Object(lt["a"])(wt,pt,mt,!1,null,null,null),_t=xt.exports,Dt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"left-panel"},[n("draggable",{staticClass:"control-drag-area",attrs:{list:t.baseControls,group:{name:"control",pull:"clone",put:!1},swapThreshold:"0.3",sort:!1,clone:t.createControl,emptyInsertThreshold:20,move:t.checkMove},on:{change:t.log}},t._l(t.baseControls,function(e){return n("div",{key:e.type,staticClass:"template-item control-tpl-item",attrs:{"data-control-type":e.type}},[n("span",{staticClass:"template-item-icon control",class:e.icon}),n("span",{staticClass:"template-item-name"},[t._v(t._s(e.name))])])}),0),n("draggable",{staticClass:"control-drag-area",attrs:{list:t.extControls,group:{name:"control",pull:"clone",put:!1},swapThreshold:"0.3",sortable:!1,clone:t.createControl,move:t.checkMove},on:{change:t.log}},t._l(t.extControls,function(e){return n("div",{key:e.type,staticClass:"template-item control-tpl-item",attrs:{"data-control-type":e.type}},[n("span",{staticClass:"template-item-icon control",class:e.icon}),n("span",{staticClass:"template-item-name"},[t._v(t._s(e.name))])])}),0)],1)},kt=[],Tt=(n("57e7"),window.FORM_DESIGN_CONFIG.controlList),St={name:"panel-control",data:function(){return{baseControls:Object(vt["d"])(Tt)}},computed:{extControls:function(){return this.$store.state.extControls}},mixins:[yt],mounted:function(){this.update()},methods:{update:function(){this.dispatch("accordion","updated")},createControl:function(t){var e=t.type,n=t.icon,o=t.name,i=window.FORM_DESIGN_CONFIG.controls[e];if(!i)throw new Error("控件的 ".concat(e," 配置信息不存在，无法创建"));var a=Object(vt["d"])(i);delete a.configItems;var r=vt["c"].getIndex(e);return a.id=e+"-"+r,a.namePrefix=o,a.autoIndex=r,a.name="",a.icon=n,a.width||(a.width="100%"),-1!=["title","label","output"].indexOf(e)&&this.copyGlobalStyleToControl(a),a},copyGlobalStyleToControl:function(t){var e=this.$store.state.globalStyle,n=e.fontSize,o=e.fontFamily,i=e.fontColor,a=e.fontBolder,r=e.fontItalic,l=e.fontUnderline;e.textAlign,e.verticalAlign;"label"==t.type&&(t.fontSize=n),t.fontFamily=o,t.fontColor=i,t.fontBolder=a,t.fontItalic=r,t.fontUnderline=l},checkMove:function(t){if(this.$el==t.to||this.$el.compareDocumentPosition(t.to)&Node.DOCUMENT_POSITION_CONTAINED_BY)return!1;var e=t.draggedContext.element;return!("hiddenfield"===e.type^t.to.classList.contains("design-hidden-area"))},log:function(){var t;(t=console).log.apply(t,arguments)}},watch:{extControls:function(){this.update()},baseControls:function(){this.update()}}},Ot=St,Et=Object(lt["a"])(Ot,Dt,kt,!1,null,null,null),It=Et.exports,Lt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"designArea",staticClass:"design-area",staticStyle:{position:"relative"},style:{width:t.size.width+20+"px"},attrs:{id:"design-area","data-width":t.size.width,"data-height":t.size.height},on:{click:t.handleFormClick}},[n("RowLayout",{attrs:{list:t.designData}}),n("HelperLine",{directives:[{name:"show",rawName:"v-show",value:t.showVLine,expression:"showVLine"}],attrs:{type:"v"}}),n("HelperLine",{directives:[{name:"show",rawName:"v-show",value:t.showHLine,expression:"showHLine"}],attrs:{type:"h"}}),n("draggable",{staticClass:"design-hidden-area",attrs:{group:"control",move:t.checkControlMove},model:{value:t.hiddenControls,callback:function(e){t.hiddenControls=e},expression:"hiddenControls"}},t._l(t.hiddenControls,function(e,o){return n("Control",{key:e.id,class:{selected:e.id==t.selectedControlId},attrs:{"control-data":e},nativeOn:{click:function(n){return n.stopPropagation(),t.onControlClick(e,o,t.hiddenControls)}}})}),1),n("div",{domProps:{innerHTML:t._s(t.colBorderStyle)}}),n("v-contextmenu",{ref:"ctxMenu"},[n("v-contextmenu-item",{on:{click:function(e){return t.ctxMneuItemHandle("insertRowUp")}}},[t._v("向上插入1行")]),n("v-contextmenu-item",{on:{click:function(e){return t.ctxMneuItemHandle("insertRowDown")}}},[t._v("向下插入1行")]),n("v-contextmenu-item",{attrs:{divider:""}}),n("v-contextmenu-item",{on:{click:function(e){return t.ctxMneuItemHandle("insertColLeft")}}},[t._v("向左插入1列")]),n("v-contextmenu-item",{on:{click:function(e){return t.ctxMneuItemHandle("insertColRight")}}},[t._v("向右插入1列")]),n("v-contextmenu-item",{attrs:{divider:""}}),n("v-contextmenu-item",{attrs:{disabled:!t.ctxMenuData.isControl},on:{click:function(e){return t.ctxMneuItemHandle("deleteControl")}}},[t._v("删除控件")]),n("v-contextmenu-item",{attrs:{disabled:!t.ctxMenuData.colDeletable||t.ctxMenuData.isControl},on:{click:function(e){return t.ctxMneuItemHandle("removeCol")}}},[t._v("删除此列")]),n("v-contextmenu-item",{attrs:{disabled:t.ctxMenuData.isControl},on:{click:function(e){return t.ctxMneuItemHandle("removeRow")}}},[t._v("删除此行")])],1),n("el-dialog",{staticClass:"multi-row-dialog",attrs:{"append-to-body":"",title:"请输入行列",visible:t.dialogVisible,width:"460px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("el-form",{attrs:{model:t.rowData,size:"mini",inline:"","inline-message":""}},[n("el-form-item",{attrs:{label:"行数目"}},[n("el-input-number",{attrs:{min:1,max:20,controls:!1,autocomplete:"off"},model:{value:t.rowData.rowCount,callback:function(e){t.$set(t.rowData,"rowCount",e)},expression:"rowData.rowCount"}})],1),n("el-form-item",{attrs:{label:"列数目"}},[n("el-input-number",{attrs:{min:1,max:20,controls:!1},model:{value:t.rowData.colCount,callback:function(e){t.$set(t.rowData,"colCount",e)},expression:"rowData.colCount"}})],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.handleDialogClose("cancel")}}},[t._v("取 消")]),n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.handleDialogClose("ok")}}},[t._v("确 定")])],1)],1)],1)},At=[],$t=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("draggable",{staticClass:"dropArea layout",class:"level-"+t.level,attrs:{group:"layout",swapThreshold:.3,delay:0,list:t.list,move:t.checkLayoutMove,filter:".col-helper-line",preventOnFilter:!1,disabled:!1},on:{change:t.onLayoutChange,start:t.onLayoutDragStart,end:t.onLayoutDragEnd,choose:t.onDragChoose}},t._l(t.list,function(e,o){return n("div",{key:e.id,staticClass:"row",class:{isTop:0==t.level,first:0===o,mid:0!=o,selected:t.selectedRowId==e.id},style:"min-height:"+e.height+"px",attrs:{"row-id":e.id,"data-name":e.name,level:t.level}},[t._l(e.cols,function(i,a){return n("div",{key:i.id,staticClass:"col",class:t.getColCls(i,a,e.cols.length),style:t.colStyleMap[e.id][a],attrs:{id:i.id,name:i.name,"data-text-align":i.style.textAlign,"data-vertical-align":i.style.verticalAlign},on:{click:function(e){return e.stopPropagation(),t.handleColClick(a,i,e)},contextmenu:function(n){return n.stopPropagation(),n.preventDefault(),t.onContextmenu(n,{row:e,rowIndex:o,parentCol:t.parentCol,col:i,colIndex:a,colDeletable:!!e.cols.length})}}},[i.controls.length||1==e.cols.length?t._e():n("RowLayout",{directives:[{name:"show",rawName:"v-show",value:i.subs&&i.subs.length||t.inLayoutDragging,expression:"(col.subs && col.subs.length) || inLayoutDragging"}],attrs:{list:i.subs,level:t.levelNext,parentCol:i,parentRow:e}}),i.subs&&i.subs.length?t._e():n("draggable",{staticClass:"dropArea controls",class:{active:i.controls.length||t.inControlDragging},attrs:{group:"control",list:i.controls,draggable:".design-control",swapThreshold:1,invertedSwapThreshold:1,invertSwap:!1,direction:"vertical",move:t.checkControlMove},on:{start:t.onControlDragStart,end:t.onControlDragEnd,add:function(n){return t.onControlAdd(n,{col:i,colIndex:a,row:e})}}},t._l(i.controls,function(e){return n("Control",{key:e.id,class:{selected:e.id==t.selectedControlId},staticStyle:{display:"inline-block"},attrs:{"control-data":e},nativeOn:{click:function(n){return n.stopPropagation(),t.onControlClick(e)}}})}),1),a!==e.cols.length-1?n("div",{staticClass:"col-helper-line line-v",attrs:{"data-row-index":o,"data-col-index":a,"data-level":t.level}}):t._e(),0===t.level||o!==t.list.length-1?n("div",{staticClass:"col-helper-line line-h",attrs:{"data-row-index":o,"data-col-index":a}}):t._e()],1)}),n("div",{staticClass:"row-helper"},[n("el-tooltip",{attrs:{placement:"top",enterable:!1,"open-delay":300,content:"移除行"}},[n("span",{staticClass:"row-helper-btn remove el-icon-delete",on:{click:function(n){return n.stopPropagation(),t.handleRowRemove(e,o)}}})]),n("el-tooltip",{attrs:{placement:"top",enterable:!1,"open-delay":300,content:"复制行"}},[n("span",{staticClass:"row-helper-btn copy el-icon-copy-document",on:{click:function(n){return t.handleRowCopy(e,o,t.parentCol)}}})]),n("el-tooltip",{attrs:{placement:"top",enterable:!1,"open-delay":300,content:"选择"}},[n("span",{staticClass:"row-helper-btn selected el-icon-top-left",on:{click:function(n){return n.stopPropagation(),t.handleRowSelect(e.id)}}})])],1)],2)}),0)},jt=[],Mt=(n("c5f6"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"design-control",class:t.controlData.type,style:"width:"+t.controlWidth,attrs:{"data-id":t.controlData.id}},[t._t("default"),n(t.getControlComponent(t.controlData.type),{tag:"component",attrs:{"control-data":t.controlData}}),n("span",{directives:[{name:"show",rawName:"v-show",value:t.controlData.icon,expression:"controlData.icon"}],staticClass:"design-control-icon",class:t.controlIconMap[t.controlData.type]}),n("span",{staticClass:"design-control-remove",on:{click:function(e){return e.stopPropagation(),t.removeControl(e)}}})],2)}),Rt=[],zt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",{staticClass:"label",class:{"design-form-label":t.asControl,"design-control-holder":!t.asControl,colons:t.autoColons,required:t.controlData.showStar},style:t.styleText},[t._v(t._s((t.controlData.labelText||t.controlData.name)+(t.autoColons?"：":"")))])},Pt=[],Vt={name:"placeholder-label",props:{controlData:{type:Object,default:function(){return{}}},asControl:{type:Boolean,default:!1}},computed:{autoColons:function(){return this.$store.state.globalStyle.autoColons},styleText:function(){var t=this.controlData,e=t.fontSize,n=t.fontFamily,o=t.fontColor,i=t.fontBolder,a=t.fontItalic,r=t.fontUnderline,l=t.textAlign,s=t.verticalAlign,c=[];return c.push("font-size:".concat(e,"px")),c.push("font-family:".concat(n)),c.push("color:".concat(o)),c.push("font-weight:".concat(i?"bold":"normal")),c.push("font-style:".concat(a?"italic":"normal")),c.push("text-decoration:".concat(r?"underline":"none")),c.push("text-align:".concat(l)),c.push("vertical-align:".concat(s)),c.join(";")}},data:function(){return{}}},Ft=Vt,Bt=Object(lt["a"])(Ft,zt,Pt,!1,null,null,null),Nt=Bt.exports,Ht=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("input",{staticClass:"design-control-holder textbox",attrs:{type:"text",placeholder:t.controlData.emptyText||t.name,readonly:""},domProps:{value:t.controlData.value}})},Wt=[],Gt={name:"placeholder-textbox",props:["controlData"],computed:{name:function(){var t=this.controlData,e=t.name,n=t.namePrefix,o=t.autoIndex;return e||(n&&o?"".concat(n,"_").concat(o):"")}}},Ut=Gt,qt=Object(lt["a"])(Ut,Ht,Wt,!1,null,null,null),Jt=qt.exports,Xt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("h1",{staticClass:"title",class:t.asControl?"design-form-title ":"design-control-holder",style:t.styleText},[t._v(t._s(t.controlData.textContent||t.controlData.name))])},Yt=[],Kt={name:"placeholder-title",props:{controlData:{type:Object,default:function(){return{}}},asControl:{type:Boolean,default:!1}},computed:{styleText:function(){var t=this.controlData,e=t.fontSize,n=t.fontFamily,o=t.fontColor,i=t.fontBolder,a=t.fontItalic,r=t.fontUnderline,l=t.textAlign,s=t.verticalAlign,c=[];return c.push("font-size:".concat(e,"px")),c.push("font-family:".concat(n)),c.push("color:".concat(o)),c.push("font-weight:".concat(i?"bold":"normal")),c.push("font-style:".concat(a?"italic":"normal")),c.push("text-decoration:".concat(r?"underline":"none")),c.push("text-align:".concat(l)),c.push("vertical-align:".concat(s)),c.join(";")}},data:function(){return{}}},Qt=Kt,Zt=Object(lt["a"])(Qt,Xt,Yt,!1,null,null,null),te=Zt.exports,ee=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("textarea",{staticClass:"design-control-holder textbox",staticStyle:{resize:"none"},style:"height:"+(t.controlData.height||26)+"px",attrs:{type:"text",placeholder:t.controlData.emptyText||t.controlData.name,readonly:""},domProps:{value:t.controlData.value}})},ne=[],oe={name:"placeholder-textarea",props:["controlData"]},ie=oe,ae=Object(lt["a"])(ie,ee,ne,!1,null,null,null),re=ae.exports,le=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"design-control-holder checkboxlist",class:"vertical"==t.controlData.repeatDirection?"vertical":"horizontal"},[n("el-checkbox-group",{model:{value:t.valueList,callback:function(e){t.valueList=e},expression:"valueList"}},t._l(t.dataList,function(e){return n("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])}),1)],1)},se=[],ce=(n("28a5"),{computed:{dataList:function(){var t=this.controlData;return Array.isArray(t.data)?t.data:this.originData&&this.originData.length?this.originData:this.defaultDataList}},methods:{getDataList:function(){var t=this,e=this.controlData;if(Array.isArray(e.data)||!e.codeItem)return this.originData=[];this.$httpPost(window.formDesignerActions.getControlDataListUrl,{controlData:this.controlData}).then(function(e){if(!Array.isArray(e))throw new Error("获取控件数据出错!");t.originData=e}).catch(function(e){t.originData=[],console.error(e)})}},watch:{"controlData.codeItem":function(t){t&&this.getDataList()}}}),de={name:"placeholder-checkboxlist",props:["controlData"],mixins:[ce],data:function(){return{valueList:this.getValueList(),defaultDataList:[1,2,3].map(function(t){return{id:t,text:"选项-"+t}}),originData:[]}},methods:{getValueList:function(){return this.controlData.value&&this.controlData.value.split(",")||[]}},created:function(){this.getDataList()},watch:{"controlData.value":function(){this.valueList=this.getValueList()},"controlData.bind":function(){this.valueList=this.getValueList()}}},ue=de,he=Object(lt["a"])(ue,le,se,!1,null,null,null),fe=he.exports,pe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"design-control-holder radiobuttonlist",class:"vertical"==t.controlData.repeatDirection?"vertical":"horizontal"},[n("el-radio-group",{model:{value:t.currValue,callback:function(e){t.currValue=e},expression:"currValue"}},t._l(t.dataList,function(e){return n("el-radio",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])}),1)],1)},me=[],ge={name:"placeholder-radio-button-list",props:["controlData"],mixins:[ce],data:function(){return{currValue:this.controlData.value||"",defaultDataList:[1,2,3].map(function(t){return{id:t,text:"选项-"+t}}),originData:[]}},created:function(){this.getDataList()}},ve=ge,be=Object(lt["a"])(ve,pe,me,!1,null,null,null),ye=be.exports,Ce=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("table",{staticClass:"design-control-holder sub-table"},[n("colgroup",[n("col",{attrs:{for:"checkcolumn",width:"50px"}}),n("col",{attrs:{for:"indexcolumn",width:"50px"}}),t._l(t.columns,function(t){return n("col",{key:t.field,attrs:{for:"normal",width:t.width+"px"}})}),n("col",{attrs:{for:"actioncolumn",width:"100px"}})],2),n("thead",[n("tr",[t.checkcolumn?n("th",{staticClass:"text-center",class:{frozen:t.checkcolumnFrozen},attrs:{"data-column-type":"checkcolumn"}},[n("span",{staticClass:"checkcolumn-icon"})]):t._e(),t.indexcolumn?n("th",{staticClass:"text-center",class:{frozen:1==t.frozenIndex},attrs:{"data-column-type":"indexcolumn"}},[t._v("序")]):t._e(),t._l(t.columns,function(e,o){var i;return n("th",{key:e.field,class:(i={},i["text-"+e.align]=!0,i.frozen=t.frozenIndex==o+t.prevColumnCount,i),attrs:{"data-column-type":"normal"}},[t._v(t._s(e.name))])}),t.actioncolumn?n("th",{staticClass:"text-center",attrs:{"data-column-type":"actioncolumn"}},[t._v("操作")]):t._e()],2)]),n("tbody",[n("tr",[t.checkcolumn?n("td",{staticClass:"text-center",class:{frozen:t.checkcolumnFrozen}},[n("span",{staticClass:"checkcolumn-icon"})]):t._e(),t.indexcolumn?n("td",{staticClass:"text-center",class:{frozen:1==t.frozenIndex}},[t._v("1")]):t._e(),t._l(t.columns,function(e,o){var i;return n("td",{key:e.field,class:(i={},i["text-"+e.align]=!0,i.frozen=t.frozenIndex==o+t.prevColumnCount,i)},[t._v("...")])}),t.actioncolumn?n("td",{staticClass:"text-center"},[t._m(0)]):t._e()],2),n("tr",[t.checkcolumn?n("td",{staticClass:"text-center",class:{frozen:t.checkcolumnFrozen}},[n("span",{staticClass:"checkcolumn-icon"})]):t._e(),t.indexcolumn?n("td",{staticClass:"text-center",class:{frozen:1==t.frozenIndex}},[t._v("2")]):t._e(),t._l(t.columns,function(e,o){var i;return n("td",{key:e.field,class:(i={},i["text-"+e.align]=!0,i.frozen=t.frozenIndex==o+t.prevColumnCount,i)},[t._v("...")])}),t.actioncolumn?n("td",{staticClass:"text-center"},[t._m(1)]):t._e()],2)])])},we=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",[n("i",{staticClass:"action-btn el-icon-plus"}),n("i",{staticClass:"action-btn el-icon-edit"}),n("i",{staticClass:"action-btn el-icon-delete"})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",[n("i",{staticClass:"action-btn el-icon-plus"}),n("i",{staticClass:"action-btn el-icon-edit"}),n("i",{staticClass:"action-btn el-icon-delete"})])}],xe={name:"placeholder-sub-table",props:["controlData"],computed:{specificColumns:function(){return this.controlData?this.controlData.specialColumns.split(","):[]},checkcolumn:function(){return-1!==this.specificColumns.indexOf("checkcolumn")},checkcolumnFrozen:function(){return!(!this.checkcolumn||0!=this.frozenIndex)},indexcolumn:function(){return-1!==this.specificColumns.indexOf("indexcolumn")},indexcolumnForzen:function(){return this.checkcolumn?1==this.frozenIndex:0==this.frozenIndex},actioncolumn:function(){return-1!==this.specificColumns.indexOf("actioncolumn")},frozenIndex:function(){return this.controlData.frozenColumnIndex},prevColumnCount:function(){return this.checkcolumn&&this.indexcolumn?2:this.checkcolumn||this.indexcolumn?1:(this.checkcolumn||this.indexcolumn,0)},columns:function(){return this.controlData.columns.length?this.controlData.columns:[{field:"name",name:"姓名",width:100,align:"center",required:!0,vtype:"number"}]}},data:function(){return{}},methods:{}},_e=xe,De=Object(lt["a"])(_e,Ce,we,!1,null,null,null),ke=De.exports,Te=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"output",class:{"design-form-output":t.asControl,"design-control-holder":!t.asControl},style:t.styleText},[t._v(t._s(t.controlData.name||t.controlData.namePrefix+"_"+t.controlData.autoIndex))])},Se=[],Oe={name:"placeholder-output",props:{controlData:{type:Object,default:function(){return{}}},asControl:{type:Boolean,default:!1}},computed:{controlWidth:function(){var t=this.controlData.width;return t?t+""===t?t:"".concat(t,"px"):""},styleText:function(){var t=this.controlData,e=t.fontSize,n=t.fontFamily,o=t.fontColor,i=t.fontBolder,a=t.fontItalic,r=t.fontUnderline,l=t.textAlign,s=(t.width,[]);return s.push("display:inline-block"),s.push("-webkit-box-sizing:border-box;box-sizing:border-box;"),s.push("font-size:".concat(e,"px")),s.push("font-family:".concat(n)),s.push("color:".concat(o)),s.push("font-weight:".concat(i?"bold":"normal")),s.push("font-style:".concat(a?"italic":"normal")),s.push("text-decoration:".concat(r?"underline":"none")),s.push("text-align:".concat(l)),this.controlWidth&&s.push("width:".concat(this.controlWidth)),s.join(";")}},data:function(){return{}}},Ee=Oe,Ie=Object(lt["a"])(Ee,Te,Se,!1,null,null,null),Le=Ie.exports,Ae={label:Nt,textbox:Jt,title:te,textarea:re,checkboxlist:fe,radiobuttonlist:ye,subtable:ke,output:Le},$e={props:["controlData"],template:'<span class="design-control-holder" :class="controlData.type">{{controlData.name || (controlData.namePrefix + "_" + controlData.autoIndex)}}</span>'},je={name:"control",props:{controlData:{type:Object,required:!0}},components:{PlaceholderLabel:Nt,PlaceholderTextbox:Jt,PlaceholderTitle:te,PlaceholderTextArea:re,PlaceholderCheckboxList:fe,PlaceholderRadioButtonList:ye},data:function(){return{}},computed:{controlIconMap:function(){var t={};return window.FORM_DESIGN_CONFIG.controlList.concat(this.$store.state.extControls).forEach(function(e){t[e.type]=e.icon}),t},controlWidth:function(){var t=this.controlData.width;return t?t+""===t?t:"".concat(t,"px"):""}},methods:{removeControl:function(){this.$store.dispatch("deleteControl")},getControlComponent:function(t){return t in Ae?Ae[t]:$e}}},Me=je,Re=Object(lt["a"])(Me,Mt,Rt,!1,null,null,null),ze=Re.exports,Pe=n("84a2"),Ve=n.n(Pe),Fe=(n("ac4d"),n("8a81"),n("42a0")),Be=n.n(Fe),Ne={methods:{handleRowSelect:function(t){this.setSelectedLayout({id:t}),this.activeRightTab("control")},handleRowCopy:function(t,e,n){var o=this.getRowCopyData(t);this.copyRow({aimIndex:e+1,parentCol:n,newRow:o,shuttle:!0})},getRowCopyData:function(t,e){var n=Object(vt["d"])(t);return o(n),n;function o(t){var n=Object(vt["l"])(),a=t.namePrefix||t.name;t.id=n,t.autoIndex=vt["j"].getIndex(a),t.name&&(t.name="".concat(t.name,"_").concat(t.autoIndex)),t.cols.forEach(function(t){t.id="col-".concat(n,"-").concat(vt["b"].getIndex(n)),t.subs&&t.subs.forEach(o),e?t.controls=[]:t.controls.forEach(i)})}function i(t){var e=t.type,n=window.FORM_DESIGN_CONFIG.controls[e];if(!n)throw new Error("控件的 ".concat(e," 配置信息不存在，无法创建"));var o=Object(vt["d"])(n);delete o.configItems,delete o.name,delete o.width,delete o.id,delete o.type,"label"!=e&&"title"!=e&&Be()(t,o);var i=vt["c"].getIndex(e);t.id=e+"-"+i,t.autoIndex=i,t.name&&(t.name="".concat(t.name,"_").concat(i))}},handleRowRemove:function(t,e){var n=this;if(this.isEmptyRow(t))return this.doRowRemove(t,e);this.$confirm("此操作将移除此行，以及此行内的所有内容，是否确认？"," 删除提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.doRowRemove(t,e)}).catch(function(){})},doRowRemove:function(t,e){this.deleteRow({parentCol:this.parentCol,row:t,index:e})},isEmptyRow:function(t){var e=!0,n=!1,o=void 0;try{for(var i,a=t.cols[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var r=i.value;if(r.subs.length||r.controls.length)return!1}}catch(l){n=!0,o=l}finally{try{e||null==a.return||a.return()}finally{if(n)throw o}}return!0}}},He=n("bd86"),We={methods:{handleColClick:function(t,e,n){var o=n.target;if(!o.classList.contains("col-helper-line")){var i=o.closest(".col");if(i){var a=e.id==this.selectedColId;a?this.setSelectedCol({id:""}):(this.setSelectedCol({id:e.id}),this.activeRightTab("cell"))}}},removeCol:function(t){var e=this,n=t.col,o=t.parentRow,i=t.colIndex;if(this.isEmptyCol(n))return this.doColRemove(n,o,i);this.$confirm("删除后此单元格内的所有内容将一并删除，是否继续？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.doColRemove(n,o,i)}).catch(function(t){t&&console.error(t)})},doColRemove:function(t,e,n){this.$store.dispatch("removeCol",{col:t,parentRow:e,colIndex:n,shuttle:!0})},isEmptyCol:function(t){return!(t.subs.length||t.controls.length)},getColCls:function(t,e,n){var o,i=this.globalStyle,a=t.subs.length,r=t.style,l=(o={selected:this.selectedColId==t.id,isSub:!a,hasSub:a,first:0===e,mid:e&&e!==n-1,last:e===n-1},Object(He["a"])(o,"text-"+(r.textAlign||i.textAlign),!0),Object(He["a"])(o,"vertical-"+(r.verticalAlign||i.verticalAlign),!0),o);return l}}},Ge=(n("f400"),n("4f7f"),n("1c4c"),{methods:{onMouseDown:function(t){var e=t.target;if(!e.classList.contains("col-helper-line"))return!0;window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp);var n=this.rowEl=e.closest(".row"),o=this.colEl=e.closest(".col");this.rowId=n&&n.getAttribute("row-id"),this.rowData=this.findRow(this.rowId),this.startHeight=this.rowData.height||30;var i=this.getDesignContainer(),a=i.getBoundingClientRect();this.mouseOffset=this.getMouseOffset(t),this.stagElementsOffset(t,a);var r=parseInt(e.dataset.colIndex,10);this.colData=this.rowData.cols[r],this.nextColData=this.rowData.cols[r+1],this.colData.width+""===this.colData.width?this.startWidth=o.getBoundingClientRect().width:this.startWidth=this.colData.style.width,this.rowId,this.inMoving=!0,e.classList.contains("line-v")?(this.getXLimit(t,a),this.resizeMode="v",this.startOffsetX=this.getXOffset(t),this.updateLineLeft(this.startOffsetX),this.showVLine()):e.classList.contains("line-h")&&(this.getYLimit(t,a),this.resizeMode="h",this.startOffsetY=this.getYOffset(t),this.updateLineTop(this.startOffsetY),this.showHLine())},onMouseMove:function(t){if("h"==this.resizeMode){var e=this.getYOffset(t);e=Object(vt["a"])(e,this.moveRange.y[0],this.moveRange.y[1]),this.updateLineTop(e);var n=e-this.startOffsetY,o=this.startHeight+n;o<30&&(o=30),this.updateRowHeight({rowId:this.rowId,height:o,row:this.rowData,parentRowPath:this.pathMap[this.rowId],shuttle:!0})}else if("v"==this.resizeMode){var i=this.getXOffset(t);i=Object(vt["a"])(i,this.moveRange.x[0],this.moveRange.x[1]);var a=this.getSnapOffset(i);a&&(i=a),this.updateLineLeft(i);var r=i-this.startOffsetX,l=this.startWidth+r;l<10&&(l=10),this.updateColWidth({col:this.colData,width:l,nextCol:this.nextColData,shuttle:!0})}},getXLimit:function(t,e){var n,o,i=30;function a(t,e){if(!t.subs||!t.subs.length)return t.style.width;var n=t.subs.map(function(t){return a(t.cols["first"==e?0:t.cols.length-1])});return Math.min.apply(Math,Object(Q["a"])(n))}this.colData?(n=a(this.colData,"last"),n=n<i?0:n-i):n=0,this.nextColData?(o=a(this.nextColData,"first"),o=o<i?0:o-i):o=0,n=t.pageX-e.left-this.mouseOffset.x-n,o=t.pageX-e.left-this.mouseOffset.x+o,this.moveRange.x=[n,o]},getYLimit:function(t,e){var n,o,i=38,a=r(this.rowData);return n=a-i,n<0&&(n=0),n=t.pageY-e.top-this.mouseOffset.y-n,o=1/0,this.moveRange.y=[n,o],[n,o];function r(t){var e=!1,n=[];return t.cols.forEach(function(t){t.subs&&t.subs.length&&(e=!0,n.push(r(t.subs[t.subs.length-1])))}),t.height,e?Math.min.apply(Math,n):t.height}},getLimitedOffset:function(){},getYOffset:function(t){var e=this.getDesignContainer(),n=e.getBoundingClientRect(),o=t.pageY-n.top-this.mouseOffset.y;return o},getXOffset:function(t){var e=this.getDesignContainer(),n=e.getBoundingClientRect(),o=t.pageX-n.left-this.mouseOffset.x;return o},getMouseOffset:function(t){var e=t.target,n=e.getBoundingClientRect();return{x:t.pageX-n.left-n.width/2,y:t.pageY-n.top-n.height/2}},stagElementsOffset:function(t,e){var n=this.getDesignContainer(),o=t.target.closest("col"),i=[].slice.call(n.querySelectorAll(".col.isSub")),a=[];i.forEach(function(t){if(!t.classList.contains("last")&&t!=o){var n=t.getBoundingClientRect(),i=n.left+n.width-e.left;a.push(i)}}),this.otherColOffSets=Array.from(new Set(a)),this.otherColOffSets},getSnapOffset:function(t){var e=new Map;return this.otherColOffSets.forEach(function(n){var o=Math.abs(t-n);o<=10&&e.set(o,n)}),!!e.size&&e.get(Math.min.apply(Math,Object(Q["a"])(e.keys())))},onMouseUp:function(){this.hideHLine(),this.hideVLine(),this.resetMoveData(),this.removeEventListener()},resetMoveData:function(){this.inMoving=!1,this.rowEl=null,this.colEl=null,this.rowId="",this.rowData=null,this.colData=null,this.nextColData=null,this.startOffsetX=0,this.startOffsetY=0,this.mouseOffset.x=0,this.mouseOffset.y=0,this.moveRange.x=[0,0],this.moveRange.y=[0,0],this.otherColOffSets=[],this.startHeight=0,this.startWidth=0,this.resizeMode=!1},removeEventListener:function(){window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp)}}}),Ue={methods:{onContextmenu:function(t,e){var n=t.target;(1==e.row.cols.length||2===e.row.cols.length&&e.parentCol)&&(e.colDeletable=!1);var o=n.closest(".design-control");if(o){for(var i,a,r,l=o.dataset.id,s=0,c=e.col.controls.length;s<c;s++)if(r=e.col.controls[s],r.id==l){i=s,a=r;break}a&&(e.control=a,e.controlIndex=i)}this.$data._ctxMenuData=e,this.showCtxMenu(t,e,this.handleContextMenu)},handleContextMenu:function(t){var e=this.$data._ctxMenuData;switch(t){case"deleteControl":this.deleteControl({selectedControl:e.control,selectedControlParentCol:e.col,selectedControlIndex:e.controlIndex});break;case"removeCol":this.removeCol({col:e.col,parentRow:e.row,colIndex:e.colIndex});break;case"removeRow":this.handleRowRemove(e.row,e.rowIndex);break;case"insertRowUp":this.copyRow({aimIndex:e.rowIndex,parentCol:e.parentCol,newRow:this.getRowCopyData(e.row,!0),shuttle:!0});break;case"insertRowDown":this.copyRow({aimIndex:e.rowIndex+1,parentCol:e.parentCol,newRow:this.getRowCopyData(e.row,!0),shuttle:!0});break;case"insertColLeft":this.splitCol({col:e.col,colIndex:e.colIndex,parentRow:e.row,direction:"left",shuttle:!0});break;case"insertColRight":this.splitCol({col:e.col,colIndex:e.colIndex,parentRow:e.row,direction:"right",shuttle:!0});break;default:break}}}},qe={name:"RowLayout",inject:{getDesignContainer:{default:function(){return document.getElementById("design-area")}},showCtxMenu:"showCtxMenu",showMutliRowConfirm:"showMutliRowConfirm"},mixins:[Ne,We,Ge,Ue],props:{list:{type:Array,default:function(){return[]}},level:{type:Number,default:0},parentCol:{type:Object,default:null},parentRow:{type:Object,default:null}},data:function(){return{_ctxMenuData:null,inMoving:!1,rowEl:null,colEl:null,rowId:"",rowData:null,colData:null,nextColData:null,startOffsetX:0,startOffsetY:0,mouseOffset:{x:0,y:0},moveRange:{x:[0,0],y:[0,0]},otherColOffSets:[],startHeight:0,startWidth:0,resizeMode:!1}},mounted:function(){0===this.level&&this.$el.addEventListener("mousedown",this.onMouseDown)},components:{Control:ze},computed:Object(Z["a"])({},Object(gt["e"])(["leftActiveTab","selectedColId","formSize","globalStyle","selectedRowId","selectedControlId"]),Object(gt["c"])(["inControlDragging","inLayoutDragging","selectedCol"]),{levelNext:function(){return this.level+1},dataMap:function(){return this.$store.getters.rowDataMap},pathMap:function(){return this.$store.getters.subRowPathMap},colStyleMap:function(){var t={};return this.list.forEach(function(e){t[e.id]=[],e.cols.forEach(function(n){var o=n.style.width;t[e.id].push({width:"".concat(o,"px")})})}),t}}),methods:Object(Z["a"])({},Object(gt["d"])(["updateLineTop","updateLineLeft","showHLine","hideHLine","showVLine","hideVLine","updateRowHeight","updateColWidth","layoutDragStart","layoutDragEnd","controlDragStart","controlDragEnd","copyRow","splitCol"]),Object(gt["b"])(["setSelectedControl","setSelectedCol","setSelectedLayout","deleteRow","deleteControl","activeRightTab"]),{throttle:Ve()(function(t,e){t.name,t(e)},20,{leading:!0,trailing:!1}),checkLayoutMove:function(t){var e=t.draggedContext.element;if(1==e.cols.length&&!t.to.classList.contains("level-0"))return!1},checkControlMove:function(t){if(t.to.classList.contains("design-hidden-area"))return!1},onControlClick:function(t){var e=this;this.setSelectedControl({id:t.id}),this.activeRightTab("control"),setTimeout(function(){e.$bus.$emit("cntrolClick")},100)},onControlAdd:function(t,e){if(t.from.classList.contains("control-drag-area")){var n=t.item.dataset.controlType;if("title"==n||"label"==n||"subtable"==n)return;var o=e.row,i=e.colIndex,a=o.cols[i-1];if(!a)return;var r=!a.controls.length&&!a.subs.length;r&&this.$store.dispatch("autoAddLabel",{parentCol:a})}},onLayoutChange:function(t){var e=this;if(t.added){var n=t.added.element;if(this.parentCol,n.asMulti)return this.showMutliRowConfirm(function(o,i){e.$store.commit("replaceToMulti",{row:n,rowIndex:t.added.newIndex,rowCount:o,colCount:i,shuttle:!0})});var o=this.parentCol?this.parentCol.style.width:this.formSize.width,i=n.cols.reduce(function(t,e){return t+e.style.width},0),a=o/i;this.$store.commit({type:"updateRowColWidth",rowId:n.id,row:n,ratio:a,shuttle:!0,group:"adjust"});n.height;if(this.parentCol){var r=this.pathMap[n.id],l=r[0],s=l.height,c=this.parentCol.subs.reduce(function(t,e){return t+e.height},0),d=s-c;d<=0?this.updateRowHeight({rowId:l.id,row:l,height:c,bubble:!0,rowPath:this.pathMap[l.id],shuttle:!0,group:"adjust"}):this.updateRowHeight({rowId:n.id,height:n.height+d,row:n,bubble:!1,shuttle:!0,group:"adjust"})}}if(t.removed&&this.parentCol&&this.parentRow){var u=this.parentCol.subs,h=this.parentRow.height,f=u.reduce(function(t,e){return t+e.height},0),p=u[u.length-1],m=p.height+(h-f);m&&this.updateRowHeight({rowId:p.id,row:p,height:m,bubble:!1,shuttle:!0,group:"adjust"})}},onLayoutDragStart:function(){this.layoutDragStart()},onLayoutDragEnd:function(){this.layoutDragEnd()},onControlDragStart:function(){this.controlDragStart()},onControlDragEnd:function(t){this.controlDragEnd()},onDragChoose:function(){},findRow:function(t){var e=this.dataMap[t];return e?e.row:null},getColStyleText:function(t){var e=t.style.width;return"unset"==e||"auto"==e?"":"width:".concat(e,e+""===e?";":"px;")},clearSelectedStyle:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cell";if("cell"==t||"col"==t){var e=this.getDesignContainer().querySelectorAll(".col.selected");e&&e.forEach(function(t){t.classList.remove("selected")})}}}),beforeDestroy:function(){this.$el.removeEventListener("mousedown",this.onMouseDown)}},Je=qe,Xe=(n("0015"),Object(lt["a"])(Je,$t,jt,!1,null,null,null)),Ye=Xe.exports,Ke=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"helper-line",class:{"line-v":"v"===t.type,"line-h":"h"===t.type},style:t.styleText})},Qe=[],Ze={props:{type:{type:String,default:"v"}},computed:{left:function(){return this.$store.state.helper.left},top:function(){return this.$store.state.helper.top},styleText:function(){return"v"==this.type?"left: ".concat(this.left,"px;"):"h"==this.type?"top: ".concat(this.top,"px;"):void 0}}},tn=Ze,en=(n("d56b"),Object(lt["a"])(tn,Ke,Qe,!1,null,null,null)),nn=en.exports,on={name:"design",components:{RowLayout:Ye,HelperLine:nn,Control:ze},provide:function(){var t=this;return{getDesignContainer:function(){return t.$refs.designArea},showCtxMenu:this.showCtxMenu,showMutliRowConfirm:this.showMutliRowConfirm}},props:{designData:{type:Array},size:{type:Object}},data:function(){return{ctxMneuItemHandle:function(){},ctxMenuData:{isControl:!1,colDeletable:!0},rowData:{rowCount:1,colCount:1},dialogVisible:!1,dialogOkCallback:function(){}}},computed:Object(Z["a"])({},Object(gt["e"])({showVLine:function(t){return t.helper.showVLine},showHLine:function(t){return t.helper.showHLine}}),{selectedControlId:function(){return this.$store.state.selectedControlId},hiddenControls:{get:function(){return this.$store.state.hiddenControls},set:function(t){this.$store.commit("setHiddenControls",t)}},colBorderStyle:function(){return"<style>"+this.$store.getters.colStyleText+"</style>"}}),methods:Object(Z["a"])({},Object(gt["b"])(["setSelectedControl","setSelectedLayout","activeRightTab"]),{onControlClick:function(t,e,n){this.setSelectedControl({id:t.id}),this.activeRightTab("control")},checkControlMove:function(t){if(!t.to.classList.contains("design-hidden-area"))return!1},handleFormClick:function(t){var e=t.target;e.closest(".row")||this.activeRightTab("form")},showMutliRowConfirm:function(t){this.dialogVisible=!0,this.dialogOkCallback=t},adjustCtxPos:function(t,e){var n=this;this.$nextTick(function(){var o={top:e,left:t},i=n.$refs.ctxMenu.clientWidth,a=n.$refs.ctxMenu.clientHeight;a+e>=window.innerHeight&&(o.top-=a),i+t>=window.innerWidth&&(o.left-=i),n.$refs.ctxMenu.style={top:"".concat(o.top,"px"),left:"".concat(o.left,"px")}})},showCtxMenu:function(t,e,n){this.ctxMenuData.isControl=!!e.control,this.ctxMenuData.colDeletable=e.colDeletable,this.ctxMneuItemHandle=n;var o=t.pageX,i=t.pageY;this.$refs.ctxMenu.show({top:i,left:o}),this.adjustCtxPos(o,i)},handleDialogClose:function(t){this.dialogVisible=!1;var e=this.rowData,n=e.rowCount,o=e.colCount;"ok"==t?this.dialogOkCallback(n,o):this.dialogOkCallback(1,1),this.rowData.rowCount=1,this.rowData.colCount=1}})},an=on,rn=(n("026d"),n("f1a3"),Object(lt["a"])(an,Lt,At,!1,null,null,null)),ln=rn.exports,sn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.selectedCol?n("div",{staticClass:"config-cell"},[n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("\n      对齐\n    ")]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("对齐")]),n("AlignButton",{attrs:{type:"horizontal"},model:{value:t.textAlign,callback:function(e){t.textAlign=e},expression:"textAlign"}}),n("AlignButton",{attrs:{type:"vertical"},model:{value:t.verticalAlign,callback:function(e){t.verticalAlign=e},expression:"verticalAlign"}})],1)]),n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("\n      边框\n      "),n("el-tooltip",{attrs:{content:"normal"==t.currentView?"切换到详细模式":"切换到简易模式"}},[n("span",{staticClass:"border-config-toggle el-icon-d-arrow-right",on:{click:t.toggleView}})])],1),"normal"==t.currentView?n("div",[n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线宽")]),n("BorderWidthSelect",{attrs:{"border-color":t.borderColor,"border-style":t.borderStyle},model:{value:t.borderWidth,callback:function(e){t.borderWidth=e},expression:"borderWidth"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线型")]),n("BorderStyleSelect",{attrs:{"border-width":t.borderWidth,"border-color":t.borderColor,disabled:!t.borderWidth},model:{value:t.borderStyle,callback:function(e){t.borderStyle=e},expression:"borderStyle"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("颜色")]),n("ColorPicker",{model:{value:t.borderColor,callback:function(e){t.borderColor=e},expression:"borderColor"}})],1)]):t._e(),"advance"==t.currentView?n("div",[n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("边框——上")]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线宽")]),n("BorderWidthSelect",{attrs:{"border-color":t.border.top.color},model:{value:t.border.top.width,callback:function(e){t.$set(t.border.top,"width",e)},expression:"border.top.width"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线性")]),n("BorderStyleSelect",{attrs:{"border-color":t.border.top.color,disabled:!t.border.top.width},model:{value:t.border.top.style,callback:function(e){t.$set(t.border.top,"style",e)},expression:"border.top.style"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("颜色")]),n("ColorPicker",{attrs:{disabled:!t.border.top.width},model:{value:t.border.top.color,callback:function(e){t.$set(t.border.top,"color",e)},expression:"border.top.color"}})],1)]),n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("边框——右")]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线宽")]),n("BorderWidthSelect",{attrs:{"border-color":t.border.right.color},model:{value:t.border.right.width,callback:function(e){t.$set(t.border.right,"width",e)},expression:"border.right.width"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线性")]),n("BorderStyleSelect",{attrs:{"border-color":t.border.right.color,disabled:!t.border.right.width},model:{value:t.border.right.style,callback:function(e){t.$set(t.border.right,"style",e)},expression:"border.right.style"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("颜色")]),n("ColorPicker",{attrs:{disabled:!t.border.right.width},model:{value:t.border.right.color,callback:function(e){t.$set(t.border.right,"color",e)},expression:"border.right.color"}})],1)]),n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("边框——下")]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线宽")]),n("BorderWidthSelect",{attrs:{"border-color":t.border.bottom.color},model:{value:t.border.bottom.width,callback:function(e){t.$set(t.border.bottom,"width",e)},expression:"border.bottom.width"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线性")]),n("BorderStyleSelect",{attrs:{"border-color":t.border.bottom.color,disabled:!t.border.bottom.width},model:{value:t.border.bottom.style,callback:function(e){t.$set(t.border.bottom,"style",e)},expression:"border.bottom.style"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("颜色")]),n("ColorPicker",{attrs:{disabled:!t.border.bottom.width},model:{value:t.border.bottom.color,callback:function(e){t.$set(t.border.bottom,"color",e)},expression:"border.bottom.color"}})],1)]),n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("边框——左")]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线宽")]),n("BorderWidthSelect",{attrs:{"border-color":t.border.left.color},model:{value:t.border.left.width,callback:function(e){t.$set(t.border.left,"width",e)},expression:"border.left.width"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线性")]),n("BorderStyleSelect",{attrs:{"border-color":t.border.left.color,disabled:!t.border.left.width},model:{value:t.border.left.style,callback:function(e){t.$set(t.border.left,"style",e)},expression:"border.left.style"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("颜色")]),n("ColorPicker",{attrs:{disabled:!t.border.left.width},model:{value:t.border.left.color,callback:function(e){t.$set(t.border.left,"color",e)},expression:"border.left.color"}})],1)])]):t._e()])]):t._e()},cn=[],dn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"design-button-group align-group",class:t.type,attrs:{"data-value":t.active}},t._l(t.alignList,function(e){return n("el-tooltip",{key:e,attrs:{"open-delay":500,content:t.tipsText[e]}},[n("MyButton",{class:{active:t.active==e},attrs:{icon:"align-"+e},nativeOn:{click:function(n){return t.activeBtn(e)}}})],1)}),1)},un=[],hn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"design-button"},[t.icon?n("span",{staticClass:"design-button-icon",class:t.icon}):t._e(),t._t("default")],2)},fn=[],pn={name:"design-button",props:{icon:{type:String}}},mn=pn,gn=Object(lt["a"])(mn,hn,fn,!1,null,null,null),vn=gn.exports,bn={name:"align-button",components:{MyButton:vn},props:{type:{type:String,default:"horizontal",validator:function(t){var e=-1!==["horizontal","vertical"].indexOf(t);return e||console.error("type 应为 'horizontal' 或 'vertical'"),e}},value:{type:String,default:function(){return"horizontal"==this.type?"left":"vertical"==this.type?"middle":void 0}}},computed:{alignList:function(){return"horizontal"==this.type?["left","center","right"]:"vertical"==this.type?["top","middle","bottom"]:void 0}},data:function(){return{active:this.value,tipsText:{left:"左对齐",center:"居中对齐",right:"右对齐",top:"顶端对齐",middle:"垂直居中",bottom:"底端对齐"}}},watch:{value:function(){this.active=this.value},active:function(t){this.$emit("input",t)}},methods:{activeBtn:function(t){this.active=t}}},yn=bn,Cn=Object(lt["a"])(yn,dn,un,!1,null,null,null),wn=Cn.exports,xn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"colorpicker",staticClass:"color-picker",class:{disabled:t.disabled}},[n("span",{staticClass:"color-picker-toggle",on:{click:function(e){return t.togglePicker()}}},[t._t("default",[n("div",{staticClass:"current-color",style:"background-color: "+t.colorValue},[n("span",{staticClass:"current-color-value"},[t._v(t._s(t.colorValue.toLowerCase()))]),n("label",{staticClass:"current-color-label"},[t._v(t._s(t.label))])])])],2),n("div",{directives:[{name:"show",rawName:"v-show",value:t.displayPicker,expression:"displayPicker"}],ref:"panel",staticClass:"color-picker-panel"},[t.displayPicker?n("Chrome",{staticClass:"color-picker-chrome",attrs:{value:t.colors,disableAlpha:t.disableAlpha},on:{input:t.updateFromPicker}}):t._e()],1)])},_n=[],Dn=(n("6b54"),n("87b3"),n("a481"),n("c345")),kn={name:"color-picker",components:{Chrome:Dn["Chrome"]},props:{value:{type:String,default:""},label:{type:String,default:""},referColor:{type:String,default:""},disabled:{type:Boolean,default:!1}},data:function(){return{disableAlpha:!0,colors:{hex:"#000000"},colorValue:"",displayPicker:!1}},mounted:function(){this.setColor(this.value||"#000000"),this.setStyle()},methods:{setStyle:function(){var t=this.value;if("#"==t[0]){var e=[0,1,2].map(function(e,n){return parseInt(t.substr(2*n+1,2),16)||0}),n="drop-shadow(2px 2px 6px rgba( ".concat(e.join(",")," ,.15)");this.$refs.colorpicker.style.setProperty("--color",t),this.$refs.colorpicker.style.setProperty("--dropShadow",n),this.$refs.colorpicker.style.setProperty("--red",e[0]),this.$refs.colorpicker.style.setProperty("--green",e[1]),this.$refs.colorpicker.style.setProperty("--blue",e[2])}},isValid:function(t){return!this.disableAlpha||/^#[0-9a-f]{6}$/i.test(t)},setColor:function(t){this.updateColors(t),this.colorValue=t},updateColors:function(t){if("#"==t.slice(0,1))this.colors={hex:t.substr(0,7)};else if("rgba"==t.slice(0,4)){var e=t.replace(/^rgba?\(|\s+|\)$/g,"").split(","),n="#"+((1<<24)+(parseInt(e[0])<<16)+(parseInt(e[1])<<8)+parseInt(e[2])).toString(16).slice(1);this.colors={hex:n,a:e[3]}}},showPicker:function(){document.addEventListener("click",this.documentClick,!0),this.displayPicker=!0},hidePicker:function(){document.removeEventListener("click",this.documentClick,!0),this.displayPicker=!1},togglePicker:function(){this.disabled||(this.displayPicker?this.hidePicker():this.showPicker())},updateFromPicker:function(t){this.disableAlpha&&(t.rgba.a=1),this.colors=t,1==t.rgba.a?this.colorValue=t.hex:this.colorValue="rgba("+t.rgba.r+", "+t.rgba.g+", "+t.rgba.b+", "+t.rgba.a+")",this.$emit("input",this.colorValue)},documentClick:function(t){var e=this.$refs.colorpicker,n=this.$refs.panel,o=t.target;e&&(e===o||e.contains(o)||n.contains(o)||this.hidePicker())},adjustPos:function(){var t=this.$el.getBoundingClientRect(),e=t.top+t.height,n=t.left,o=this.$refs.panel,i=o.clientHeight,a=o.clientWidth;e+i>=window.innerHeight&&(e=t.top-i),n+a>=window.innerWidth&&(n-=n+a-window.innerWidth),o.style.top="".concat(e,"px"),o.style.left="".concat(n,"px")}},watch:{value:function(){this.setColor(this.value||"#000000"),this.setStyle()},colorValue:function(t){t&&(this.updateColors(t),this.setStyle(),this.$emit("input",t))},displayPicker:function(t){var e=this;t?this.$nextTick(function(){document.body.appendChild(e.$refs.panel),e.$refs.panel.style.position="fixed",e.$refs.panel.style.display="block",e.adjustPos()}):(this.$refs.panel.style.display="none",this.$refs.panel.style.top="-99999px",this.$refs.panel.style.left="-99999px")}}},Tn=kn,Sn=(n("5908"),n("b8b5"),Object(lt["a"])(Tn,xn,_n,!1,null,null,null)),On=Sn.exports,En=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"border-style-select",class:{disabled:t.disabled}},[n("el-select",{staticStyle:{width:"100px"},attrs:{disabled:t.disabled,placeholder:"请选择",size:"small"},model:{value:t.borderStyle,callback:function(e){t.borderStyle=e},expression:"borderStyle"}},t._l(t.borderStyleList,function(e){return n("el-option",{key:e.value,attrs:{label:e.label||e.value,title:e.label||e.value,value:e.value}},[e.value?n("span",{staticClass:"border-style-option",style:"border-top-color:"+t.borderColor+";border-top-width:"+(t.borderWidth||3)+"px;border-top-style:"+e.value+";"}):t._e()])}),1),n("span",{staticClass:"border-style-select-curr",style:t.selectedStyle})],1)},In=[],Ln={name:"border-style-select",props:["value","borderColor","disabled"],data:function(){return{borderWidth:4,borderStyle:this.value,borderStyleList:["solid","dashed","dotted","double"].map(function(t){return{value:t}})}},watch:{value:function(t){t!=this.borderStyle&&(this.borderStyle=t)},borderStyle:function(t){this.$emit("input",t)}},computed:{selectedStyle:function(){return"border-top-style:".concat(this.borderStyle,";border-top-color:").concat(this.borderColor,";border-top-width:").concat(this.borderWidth||3,"px;")}}},An=Ln,$n=Object(lt["a"])(An,En,In,!1,null,null,null),jn=$n.exports,Mn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"border-width-select",class:{disabled:t.disabled,none:0==t.borderWidth,normal:0!=t.borderWidth}},[n("el-select",{staticStyle:{width:"100px"},attrs:{disabled:t.disabled,placeholder:"请选择",size:"small"},model:{value:t.borderWidth,callback:function(e){t.borderWidth=e},expression:"borderWidth"}},t._l(t.borderWidthList,function(e){return n("el-option",{key:e.value,attrs:{label:e.label||e.value,value:e.value}},[e.value?n("span",{staticClass:"border-width-select-option",style:t.selectedStyle(e.value),attrs:{title:e.label||e.value}}):t._e(),e.value?t._e():n("span",{staticClass:"border-width-select-option-none",style:"color:"+t.borderColor,attrs:{title:e.label}},[t._v(t._s(e.label))])])}),1),n("span",{staticClass:"border-width-select-curr",style:t.selectedStyle()})],1)},Rn=[],zn={name:"border-width-select",props:["value","borderColor","disabled"],data:function(){return{borderStyle:"solid",borderWidth:this.value,borderWidthList:[{label:"none",value:0},{value:1},{value:2},{value:3},{value:4},{value:5}]}},watch:{value:function(t){t!=this.borderWidth&&(this.borderWidth=t)},borderWidth:function(t){this.$emit("input",t)}},methods:{selectedStyle:function(t){return void 0===t&&(t=this.borderWidth),"border-top-style:".concat(this.borderStyle,";border-top-color:").concat(this.borderColor,";border-top-width:").concat(t,"px")}}},Pn=zn,Vn=Object(lt["a"])(Pn,Mn,Rn,!1,null,null,null),Fn=Vn.exports,Bn={name:"config-cell",components:{AlignButton:wn,ColorPicker:On,BorderStyleSelect:jn,BorderWidthSelect:Fn},props:["selectedCol"],computed:{},data:function(){return this.getShowData()},methods:Object(Z["a"])({},Object(gt["d"])(["setColBorder","setColStyle"]),Object(gt["b"])(["setColAllBorder"]),{getShowData:function(){if(!this.selectedCol)return{};var t=Object(vt["d"])(this.selectedCol.style.border),e=t.bottom.width,n=t.bottom.style,o=t.bottom.color;return{textAlign:this.selectedCol.style.textAlign||"left",verticalAlign:this.selectedCol.style.verticalAlign||"middle",border:t,borderWidth:e,borderStyle:n,borderColor:o,currentView:"normal"}},toggleView:function(){this.currentView="normal"==this.currentView?"advance":"normal"}}),watch:{selectedCol:function(t,e){if(this.selectedCol){var n=Object(vt["d"])(this.selectedCol.style.border),o=n.bottom.width,i=n.bottom.style,a=n.bottom.color;e?(this.border=n,this.verticalAlign=this.selectedCol.style.verticalAlign,this.textAlign=this.selectedCol.style.textAlign,this.borderWidth=o,this.borderStyle=i,this.borderColor=a):(this.$set(this,"border",n),this.$set(this,"verticalAlign",this.selectedCol.style.verticalAlign),this.$set(this,"textAlign",this.selectedCol.style.textAlign),this.$set(this,"borderWidth",o),this.$set(this,"borderStyle",i),this.$set(this,"borderColor",a))}},border:{deep:!0,handler:function(t){var e;JSON.stringify(t)!=JSON.stringify(this.selectedCol.style.border)&&((e=console).log.apply(e,["设置单元格边框"].concat(Array.prototype.slice.call(arguments))),this.setColBorder({border:t,selectedCol:this.selectedCol,shuttle:!0}))}},borderWidth:function(t){this.setColAllBorder({prop:"width",value:t})},borderStyle:function(t){this.setColAllBorder({prop:"style",value:t})},borderColor:function(t){this.setColAllBorder({prop:"color",value:t})},textAlign:function(t){var e;t!=this.selectedCol.style.textAlign&&((e=console).log.apply(e,["设置对齐"].concat(Array.prototype.slice.call(arguments))),this.setColStyle({prop:"textAlign",value:t,selectedCol:this.selectedCol,shuttle:!0}))},verticalAlign:function(t){var e;t!=this.selectedCol.style.verticalAlign&&((e=console).log.apply(e,["设置对齐"].concat(Array.prototype.slice.call(arguments))),this.setColStyle({prop:"verticalAlign",value:t,selectedCol:this.selectedCol,shuttle:!0}))}}},Nn=Bn,Hn=Object(lt["a"])(Nn,sn,cn,!1,null,null,null),Wn=Hn.exports,Gn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"config-form"},[n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("\n      全局文字"),n("el-tooltip",{attrs:{placement:"right",content:"将影响所有控件"}},[n("span",{staticClass:"design-help"})])],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("字体")]),n("el-select",{staticClass:"font-set-select",attrs:{size:"small"},model:{value:t.fontFamily,callback:function(e){t.fontFamily=e},expression:"fontFamily"}},t._l(t.fontFamilyList,function(t){return n("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})}),1),n("el-input-number",{staticClass:"font-set-input",attrs:{size:"small",controls:!1,min:12,max:100},model:{value:t.fontSize,callback:function(e){t.fontSize=e},expression:"fontSize"}}),n("span",{staticClass:"form-control-suffix"},[t._v("px")])],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("样式")]),n("FontColor",{staticStyle:{"margin-right":"10px"},model:{value:t.fontColor,callback:function(e){t.fontColor=e},expression:"fontColor"}}),n("div",{staticClass:"design-button-group font-group"},[n("el-tooltip",{attrs:{"open-delay":500,content:"加粗"}},[n("MyButton",{class:{active:t.fontBolder},attrs:{icon:"font-bold"},nativeOn:{click:function(e){t.fontBolder=!t.fontBolder}}})],1),n("el-tooltip",{attrs:{"open-delay":500,content:"倾斜"}},[n("MyButton",{class:{active:t.fontItalic},attrs:{icon:"font-italic"},nativeOn:{click:function(e){t.fontItalic=!t.fontItalic}}})],1),n("el-tooltip",{attrs:{"open-delay":500,content:"下划线"}},[n("MyButton",{class:{active:t.fontUnderline},attrs:{icon:"font-underline"},nativeOn:{click:function(e){t.fontUnderline=!t.fontUnderline}}})],1)],1)],1)]),n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("\n      全局单元格"),n("el-tooltip",{attrs:{placement:"right",content:"将影响所有单元格"}},[n("span",{staticClass:"design-help"})])],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("对齐")]),n("AlignButton",{attrs:{type:"horizontal"},model:{value:t.textAlign,callback:function(e){t.textAlign=e},expression:"textAlign"}}),n("AlignButton",{attrs:{type:"vertical"},model:{value:t.verticalAlign,callback:function(e){t.verticalAlign=e},expression:"verticalAlign"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("高度")]),n("el-input-number",{staticClass:"height-set-input",attrs:{size:"small",controls:!1,min:38,max:2e3},on:{change:t.setHeight},model:{value:t.height,callback:function(e){t.height=e},expression:"height"}}),n("span",{staticClass:"form-control-suffix"},[t._v("px")])],1)]),n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("\n      全局边框"),n("el-tooltip",{attrs:{placement:"right",content:"将影响所有单元格"}},[n("span",{staticClass:"design-help"})])],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线宽")]),n("BorderWidthSelect",{attrs:{"border-color":t.borderColor,"border-style":t.borderStyle},model:{value:t.borderWidth,callback:function(e){t.borderWidth=e},expression:"borderWidth"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("线性")]),n("BorderStyleSelect",{attrs:{"border-width":t.borderWidth,"border-color":t.borderColor,disabled:!t.borderWidth},model:{value:t.borderStyle,callback:function(e){t.borderStyle=e},expression:"borderStyle"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("颜色")]),n("ColorPicker",{attrs:{disabled:!t.borderWidth},model:{value:t.borderColor,callback:function(e){t.borderColor=e},expression:"borderColor"}})],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("外边框")]),n("AllBorderType",{staticClass:"form-control",attrs:{"border-type":t.allBorderType},on:{active:t.handleBorderTypeChange}})],1)]),n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v("控件配置")]),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("label自动冒号")]),n("el-switch",{attrs:{"border-color":t.borderColor,"border-style":t.borderStyle},model:{value:t.autoColons,callback:function(e){t.autoColons=e},expression:"autoColons"}})],1)])])},Un=[],qn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ColorPicker",{model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}},[n("span",{staticClass:"font-color-button design-button"},[n("span",{staticClass:"font-color-holder design-button-icon"}),n("span",{staticClass:"font-current-color",style:"background:"+t.currentValue})])])},Jn=[],Xn={name:"control-font-color",props:["value"],components:{ColorPicker:On},data:function(){return{currentValue:this.value||"#000"}},watch:{value:function(t){this.currentValue=t},currentValue:function(t){this.$emit("input",t)}}},Yn=Xn,Kn=Object(lt["a"])(Yn,qn,Jn,!1,null,null,null),Qn=Kn.exports,Zn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"form-control-item  form-all-border"},t._l(t.list1,function(e){return n("el-tooltip",{key:e,attrs:{"open-delay":500,placement:"top",content:t.tipsText[e]}},[n("MyButton",{class:{active:e==t.currentType},attrs:{icon:"all-border-"+e},nativeOn:{click:function(n){return t.handleChange(e)}}})],1)}),1),n("div",{staticClass:"form-control-item form-all-border"},t._l(t.list2,function(e){return n("el-tooltip",{key:e,attrs:{"open-delay":500,placement:"top",content:t.tipsText[e]}},[n("MyButton",{class:{active:e==t.currentType},attrs:{icon:"all-border-"+e},nativeOn:{click:function(n){return t.handleChange(e)}}})],1)}),1)])},to=[],eo={name:"form-all-border-config",components:{MyButton:vn},props:{borderType:{type:String,default:"all"}},data:function(){return{currentType:this.borderType,list1:["all","inner","hline","vline","outer"],list2:["left","top","right","bottom","none"],tipsText:{all:"全部框线",inner:"仅内框线",hline:"仅水平线",vline:"仅垂直线",outer:"仅外边框",left:"仅左框线",top:"仅上框线",right:"仅右框线",bottom:"仅底框线",none:"无框线"}}},methods:{handleChange:function(t){this.currentType=t,this.$emit("active",t)}},watch:{borderType:function(t){this.currentType=t}}},no=eo,oo=Object(lt["a"])(no,Zn,to,!1,null,null,null),io=oo.exports,ao=Object(vt["d"])(window.FORM_DESIGN_CONFIG.preset.fontFamilyList),ro={name:"config-form",components:{AlignButton:wn,FontColor:Qn,BorderStyleSelect:jn,BorderWidthSelect:Fn,MyButton:vn,ColorPicker:On,AllBorderType:io},computed:Object(Z["a"])({},Object(gt["e"])(["globalStyle"]),{fontFamilyList:function(){return ao}}),data:function(){var t=this.globalStyle||this.$store.state.globalStyle,e=t.border;return{height:t.cellHeight||38,borderWidth:e.top.width||1,borderStyle:e.top.style||"solid",borderColor:e.top.color||"#dddddd",fontSize:t.fontSize,fontFamily:t.fontFamily,fontColor:t.fontColor,fontBolder:t.fontBolder,fontItalic:t.fontItalic,fontUnderline:t.fontUnderline,textAlign:t.textAlign,verticalAlign:t.verticalAlign,autoColons:t.autoColons,allBorderType:t.allBorderType||"all",heightPerset:{selected:"compact",list:[{label:"紧凑",value:"compact"},{label:"2倍",value:40},{label:"50",value:50},{label:"自定义",value:30}]}}},methods:Object(Z["a"])({getData:function(){var t=this.globalStyle||this.$store.state.globalStyle,e=t.border;return{height:t.cellHeight||38,borderWidth:e.top.width||1,borderStyle:e.top.style||"solid",borderColor:e.top.color||"#dddddd",fontSize:t.fontSize,fontFamily:t.fontFamily,fontColor:t.fontColor,fontBolder:t.fontBolder,fontItalic:t.fontItalic,fontUnderline:t.fontUnderline,textAlign:t.textAlign,verticalAlign:t.verticalAlign,autoColons:t.autoColons}}},Object(gt["b"])({setBorder:"setGlobalBorder",setStyle:"setGlobalStyle"}),{handleChange:function(t,e){t!==this.globalStyle[e]&&this.setStyle({prop:e,value:t})},setHeight:function(t){this.$store.dispatch("setAllRowHeight",{height:t})},handleBorderTypeChange:function(t){this.borderWidth,this.$store.dispatch("setAllBorderType",{type:t,borderWidth:this.borderWidth})}}),watch:{globalStyle:function(t){var e=t.border;this.height=t.cellHeight||38,this.borderWidth=e.top.width||1,this.borderStyle=e.top.style||"solid",this.borderColor=e.top.color||"#dddddd",this.fontSize=t.fontSize,this.fontFamily=t.fontFamily,this.fontColor=t.fontColor,this.fontBolder=t.fontBolder,this.fontItalic=t.fontItalic,this.fontUnderline=t.fontUnderline,this.textAlign=t.textAlign,this.verticalAlign=t.verticalAlign,this.autoColons=t.autoColons,this.allBorderType=t.allBorderType},borderWidth:function(t){this.setBorder({prop:"width",value:t})},borderStyle:function(t){this.setBorder({prop:"style",value:t})},borderColor:function(t){this.setBorder({prop:"color",value:t})},autoColons:function(t){this.handleChange(t,"autoColons")},fontSize:function(t){this.handleChange(t,"fontSize")},fontFamily:function(t){this.handleChange(t,"fontFamily")},fontColor:function(t){this.handleChange(t,"fontColor")},fontBolder:function(t){this.handleChange(t,"fontBolder")},fontItalic:function(t){this.handleChange(t,"fontItalic")},fontUnderline:function(t){this.handleChange(t,"fontUnderline")},textAlign:function(t){this.handleChange(t,"textAlign")},verticalAlign:function(t){this.handleChange(t,"verticalAlign")}}},lo=ro,so=Object(lt["a"])(lo,Gn,Un,!1,null,null,null),co=so.exports,uo=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.control?n("div",{staticClass:"config-control"},[n("NameConfig",{attrs:{"component-data":t.control,type:t.controlType},on:{change:t.onNameChange,remove:t.removeControl}}),t.supportEvent?n("div",{staticClass:"config-control-tabs"},[n("span",{staticClass:"config-control-tab",class:{active:"attribute"==t.currentView},on:{click:function(e){t.currentView="attribute"}}},[t._v("属性")]),n("span",{staticClass:"config-control-tab",class:{active:"event"==t.currentView},on:{click:function(e){t.currentView="event"}}},[t._v("事件("+t._s(t.eventCount)+")")])]):t._e(),n("div",{staticClass:"config-control-tabcontent",class:{"with-event":t.supportEvent}},["attribute"==t.currentView?n("div",{staticClass:"attribute-block"},t._l(t.controlConfig,function(e,o){return n("div",{key:o,staticClass:"config-block"},[n("h3",{staticClass:"config-category"},[t._v(t._s(e.category))]),t._l(e.items,function(e){return n("div",{key:e.label||e.extends+"",class:{"form-item":!e.extends,"form-extend":!!e.extends}},[t._l(t.getExtends(e.extends),function(e){return n(t.getControlComponent(e),{key:t.control.id+"-"+e,tag:"component",attrs:{"control-data":t.control},on:{change:t.handleExtendChange}})}),e.extends?t._e():n("label",{staticClass:"form-label"},[t._v(t._s(e.label))]),e.extends?t._e():n("div",{staticClass:"form-control"},t._l(e.controls,function(e){return n(t.getControlComponent(e.type),{key:t.control.id+"-"+e.associatedProp,tag:"component",staticClass:"form-control-item",class:e.type,attrs:{config:e,value:t.getControlValue(t.control,e)},on:{change:t.change}})}),1)],2)})],2)}),0):t._e(),"event"==t.currentView?n("div",{staticClass:"event-block"},[n("EventComponent",{attrs:{"control-data":t.control}})],1):t._e()])],1):t._e()},ho=[],fo=(n("456d"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"component-name-config config-block"},[n("h3",{staticClass:"component-type config-category"},[t._v(t._s(t.type)+" "),n("span",{staticClass:"remove-component",on:{click:t.onComponentRemove}},[t._v("删除")])]),n("div",{staticClass:"component-name-block"},[n("div",{directives:[{name:"show",rawName:"v-show",value:!t.showEditor,expression:"!showEditor"}],staticClass:"component-name",on:{click:function(e){t.editorValue=t.name,t.showEditor=!0}}},[t._v(t._s(t.name))]),t.showEditor?n("div",[n("div",{staticClass:"el-input el-input--mini",staticStyle:{width:"50%","margin-right":"6px"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.editorValue,expression:"editorValue"}],staticClass:"el-input__inner",attrs:{size:"mini"},domProps:{value:t.editorValue},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submitName(e)},input:function(e){e.target.composing||(t.editorValue=e.target.value)}}})]),n("el-button",{attrs:{icon:"el-icon-check",size:"mini",circle:""},on:{click:t.submitName}})],1):t._e()])])}),po=[],mo=(n("4f37"),{name:"name-config",props:["componentData","type"],computed:{},data:function(){return{name:this.componentData.name||this.getComponentName(),showEditor:!1,editorValue:""}},methods:{getComponentName:function(){var t=this.componentData,e=t.namePrefix,n=t.autoIndex;return e&&n?"".concat(e,"_").concat(n):this.type},onComponentRemove:function(){this.$emit("remove")},change:function(t){this.$emit("change",t)},submitName:function(){var t=this.editorValue.trim();t?(this.componentData.name!=t&&(this.name=t,this.change(t)),this.showEditor=!1):this.$message({message:"必须输入组件件名称",type:"error",showClose:!0})}},watch:{"componentData.id":function(){this.showEditor=!1,this.name=this.componentData.name||this.getComponentName()}}}),go=mo,vo=(n("d5c7"),Object(lt["a"])(go,fo,po,!1,null,null,null)),bo=vo.exports,yo=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-checkbox",{attrs:{value:t.value},on:{change:t.change}},[t._v(t._s(t.config.text))])},Co=[],wo={name:"control-checkbox",props:{value:{type:Boolean,require:!0},config:{type:Object,require:!0}},methods:{change:function(t){this.$emit("change",t,this.config)}}},xo=wo,_o=Object(lt["a"])(xo,yo,Co,!1,null,null,null),Do=_o.exports,ko=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-checkbox-group",{class:"direction-"+t.direction,on:{change:t.change},model:{value:t.valueList,callback:function(e){t.valueList=e},expression:"valueList"}},t._l(t.optionList,function(e){return n("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])}),1)},To=[],So=n("da81"),Oo=n.n(So),Eo={methods:{getOriginData:function(t,e){var n,o=this;if(!t)throw new Error("url is required!");e&&(n=Oo()({},e)),this.loading=!0,this.$httpPost(t,n).then(function(t){var e=[];if(!Array.isArray(t))throw new Error("远程数据必须为数组");return t.forEach(function(t){void 0!==t.id&&void 0!==t.text?e.push(t):console.warn("id or text is not a valid type! ".concat(JSON.stringify(t)))}),o.loading=!1,o.originOptionList=e,e}).catch(function(t){o.loading=!1,console.error(t)})}}},Io=window.FORM_DESIGN_CONFIG.preset,Lo={name:"control-checkboxlist",mixins:[Eo],props:{value:{type:String,require:!0},config:{type:Object,require:!0},styleText:{type:String,default:"width:200px"}},data:function(){return{valueList:this.getValueList(),loading:!1,originOptionList:[]}},created:function(){!this.config.data&&this.config.url&&this.getOriginData(this.config.url)},computed:{direction:function(){return this.config.direction||"horizontal"},optionList:function(){return this.config.data?this.staticOptionList:this.originOptionList},staticOptionList:function(){var t=this.config.data;if(!t)return[];if(Array.isArray(t))return t;var e=t+""===t;if(e){if(t in Io)return Io[t];var n=t.replace(/^epointsform\./,"");if(n&&Array.isArray(this.$store.state[n]))return Object(vt["d"])(this.$store.state[n])}return[]}},methods:{getValueList:function(){return this.value?this.value.split(","):[]},change:function(t){this.$emit("change",t.join(","),this.config)}}},Ao=Lo,$o=Object(lt["a"])(Ao,ko,To,!1,null,null,null),jo=$o.exports,Mo=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-select",{style:t.styleText,attrs:{value:t.value,size:"small",filterable:"",clearable:""},on:{change:t.change}},t._l(t.optionList,function(t){return n("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})}),1)},Ro=[],zo=window.FORM_DESIGN_CONFIG.preset,Po={name:"control-combobox",mixins:[Eo],props:{value:{type:String,require:!0},config:{type:Object,require:!0},styleText:{type:String,default:""}},data:function(){return{loading:!1,originOptionList:[]}},created:function(){!this.config.data&&this.config.url&&this.getOriginData(this.config.url)},computed:{optionList:function(){return this.config.data?this.staticOptionList:this.originOptionList},staticOptionList:function(){var t=this.config.data;if(!t)return[];if(Array.isArray(t))return t;var e=t+""===t;if(e){if(t in zo)return zo[t];var n=t.replace(/^epointsform\./,"");if(n&&Array.isArray(this.$store.state[n]))return Object(vt["d"])(this.$store.state[n])}return[]}},methods:{change:function(t){this.$emit("change",t,this.config)}}},Vo=Po,Fo=Object(lt["a"])(Vo,Mo,Ro,!1,null,null,null),Bo=Fo.exports,No=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{},[n("el-select",{staticStyle:{display:"block"},attrs:{size:"small"},on:{change:t.typeChange},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},t._l(t.typeList,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})}),1),t.type==t.TYPE_MAP.date?n("el-date-picker",{staticStyle:{"margin-top":"8px"},attrs:{"popper-class":"default-date-popper",type:"datetime",placeholder:"请选择一个日期",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",editable:!1,size:"small"},on:{change:t.dateChange},model:{value:t.selectDate,callback:function(e){t.selectDate=e},expression:"selectDate"}}):t._e()],1)},Ho=[],Wo="[currDate]",Go=/^\d{4}-\d{2}-\d{2}/,Uo={empty:"empty",currDate:"currDate",date:"date"},qo={name:"control-default-date",props:["config","value"],data:function(){return Object(Z["a"])({},this.getDataFromValue(this.value),{TYPE_MAP:Uo,typeList:[{id:Uo.empty,text:"留空"},{id:Uo.currDate,text:"填报日期"},{id:Uo.date,text:"指定日期"}]})},methods:{getDataFromValue:function(t){return t?/^\[.+\]$/.test(t)?{selectDate:"",type:Uo.currDate}:{selectDate:this.getValidDate(t),type:Uo.date}:{selectDate:"",type:Uo.empty}},getValidDate:function(t){return Go.test(t)?t:""},typeChange:function(t){return"empty"==t?this.change(""):"currDate"==t?this.change(Wo):"date"==t&&this.selectDate?this.change(this.selectDate):void 0},dateChange:function(){"date"==this.type&&this.change(this.selectDate)},change:function(t){this.$emit("change",t,this.config)}},watch:{value:function(t){var e=this.getDataFromValue(t);e.type!=this.type&&(this.type=e.type),e.selectDate!=this.selectDate&&(this.selectDate=e.selectDate)}}},Jo=qo,Xo=(n("d482"),Object(lt["a"])(Jo,No,Ho,!1,null,null,null)),Yo=Xo.exports,Ko=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-select",{attrs:{size:"small"},on:{change:t.configTypeChange},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},t._l(t.typeList,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})}),1),t.type==t.typeMap.select?n("div",{staticStyle:{"margin-top":"8px"}},[n("el-input",{attrs:{placeholder:"请选择",value:t.selectedTypes.join(","),size:"small",readonly:""}},[n("el-button",{attrs:{slot:"append",icon:"el-icon-more"},nativeOn:{click:function(e){return t.showDialog(e)}},slot:"append"})],1)],1):t._e(),t.type==t.typeMap.input?n("div",{staticStyle:{"margin-top":"8px"}},[n("el-input",{attrs:{placeholder:"请输入文件扩展名",size:"small"},on:{change:t.userInputChange},model:{value:t.userInputType,callback:function(e){t.userInputType=e},expression:"userInputType"}}),n("el-tooltip",{attrs:{placement:"top",content:"扩展名不带点，多个逗号分隔"}},[n("span",{staticClass:"design-help"})])],1):t._e(),n("el-dialog",{attrs:{visible:t.dialogVisible,title:"类型选择","append-to-body":""},on:{"update:visible":function(e){t.dialogVisible=e}}},[t.type==t.typeMap.select?n("div",{staticClass:"tree-like"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.dialogSelectedTypes.length,expression:"dialogSelectedTypes.length"}],staticStyle:{"margin-bottom":"10px"}},t._l(t.dialogSelectedTypes,function(e){return n("el-tag",{key:e,staticStyle:{"margin-right":"4px"},attrs:{size:"mini",closable:""},on:{close:function(n){return t.hanldeRemoveTag(e)}}},[t._v(t._s(e))])}),1),t._l(t.dialogTypeTree,function(e){return n("div",{key:e.id,staticStyle:{"margin-bottom":"10px"}},[n("div",{staticClass:"file-type-category"},[n("el-checkbox",{attrs:{indeterminate:e.halfChecked,label:e.text},on:{change:function(n){return t.cateCheckedChange(n,e)}},model:{value:e.allChecked,callback:function(n){t.$set(e,"allChecked",n)},expression:"cate.allChecked"}})],1),n("el-checkbox-group",{staticClass:"file-type-group",on:{change:function(n){return t.itemCheckedChange(n,e)}},model:{value:e.checkedArr,callback:function(n){t.$set(e,"checkedArr",n)},expression:"cate.checkedArr"}},t._l(e.items,function(t){return n("el-checkbox",{key:t.id,staticClass:"file-type-item",attrs:{label:t.id}})}),1)],1)})],2):t._e(),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:t.submitSelect}},[t._v("确 定")])],1)])],1)},Qo=[],Zo="[default]",ti={default:"default",empty:"empty",select:"select",input:"input"},ei={name:"control-file-type-picker",props:["config","value"],computed:{selectedTypes:function(){if(this.type!=this.typeMap.select)return[];var t=[];return this.typeTree.forEach(function(e){e.checkedArr&&e.checkedArr.length&&t.push.apply(t,Object(Q["a"])(e.checkedArr))}),t},dialogSelectedTypes:function(){if(this.type!=this.typeMap.select)return[];var t=[];return this.dialogTypeTree.forEach(function(e){e.checkedArr&&e.checkedArr.length&&t.push.apply(t,Object(Q["a"])(e.checkedArr))}),t}},data:function(){return{typeMap:ti,dialogVisible:!1,userInputType:"",type:"",typeList:[{id:"default",text:"系统默认"},{id:"empty",text:"不限制"},{id:"select",text:"选择类型"},{id:"input",text:"手动输入"}],typeTree:this.genderTypeTree(this.value),dialogTypeTree:[]}},created:function(){this.type=this.getTypeFromValue(this.value),this.syncConfigValue()},methods:{syncConfigValue:function(){this.type==ti.default||this.type==ti.empty?this.userInputType="":this.type==ti.select?(this.userInputType="",this.typeTree=this.genderTypeTree(this.value)):this.userInputType=this.value},getFileTypeMap:function(){var t={};return this.typeTree.forEach(function(e){e.valueArr.forEach(function(e){t[e]=!0})}),t},getTypeFromValue:function(t){if(t==Zo)return ti.default;if(""==t)return ti.empty;var e=t.split(","),n=this.getFileTypeMap(),o=!0,i=!1,a=void 0;try{for(var r,l=e[Symbol.iterator]();!(o=(r=l.next()).done);o=!0){var s=r.value;if(!n[s])return ti.input}}catch(c){i=!0,a=c}finally{try{o||null==l.return||l.return()}finally{if(i)throw a}}return ti.select},genderTypeTree:function(t){var e=this,n=[],o=Object(vt["d"])(window.FORM_DESIGN_CONFIG.preset["epointsform.fileTypes"]),i=(t||"").split(",");return o.forEach(function(t){t.valueArr=t.items,t.items=e.genderItems(t.valueArr);var o=[];t.valueArr.forEach(function(t){-1!==i.indexOf(t)&&o.push(t)}),t.checkedArr=o,0===t.checkedArr.length?t.allChecked=t.halfChecked=!1:t.checkedArr.length!==t.valueArr.length?(t.allChecked=!1,t.halfChecked=!0):(t.allChecked=!0,t.halfChecked=!1),n.push(t)}),n},genderItems:function(t){return t.map(function(t){return{id:t,text:t}})},cateCheckedChange:function(t,e){var n;t?(e.allChecked=!0,e.halfChecked=!1,(n=e.checkedArr).splice.apply(n,[0,e.checkedArr.length].concat(Object(Q["a"])(e.valueArr)))):(e.allChecked=!1,e.halfChecked=!1,e.checkedArr.splice(0,e.checkedArr.length))},itemCheckedChange:function(t,e){var n;(n=console).log.apply(n,arguments),t.length==e.items.length?(e.allChecked=!0,e.halfChecked=!1):t.length?(e.allChecked=!1,e.halfChecked=!0):(e.allChecked=!1,e.halfChecked=!1)},hanldeRemoveTag:function(t){var e,n=!0,o=!1,i=void 0;try{for(var a,r=this.dialogTypeTree[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){var l=a.value;if(e=l.checkedArr.indexOf(t),-1!==e){l.allChecked=!1,l.checkedArr.splice(e,1),l.halfChecked=0!==l.checkedArr.length&&l.checkedArr.length!=l.valueArr.length;break}}}catch(s){o=!0,i=s}finally{try{n||null==r.return||r.return()}finally{if(o)throw i}}},configTypeChange:function(t){return t==ti.default?this.change(Zo):t==ti.empty?this.change(""):t==ti.input?this.userInputType&&this.change(this.userInputType):t==ti.select?this.change(this.selectedTypes.join(",")):void 0},userInputChange:function(t){if(this.type==ti.input)return this.change(this.userInputType)},change:function(t){this.$emit("change",t,this.config)},showDialog:function(){this.dialogTypeTree=Object(vt["d"])(this.typeTree),this.dialogVisible=!0},submitSelect:function(){this.dialogVisible=!1,this.change(this.dialogSelectedTypes.join(","))}},watch:{selectedTypes:function(t){},value:function(){this.type=this.getTypeFromValue(this.value),this.type==ti.select&&(this.typeTree=this.genderTypeTree(this.value))}}},ni=ei,oi=(n("2e74"),Object(lt["a"])(ni,Ko,Qo,!1,null,null,null)),ii=oi.exports,ai=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-select",{style:t.styleText,attrs:{value:t.value,size:"small",clearable:!1,placeholder:"请选择关联字段",filterable:""},on:{change:t.change}},t._l(t.tables,function(e,o){return n("el-option-group",{key:o,attrs:{label:e.name}},t._l(e.fields,function(i,a){return n("el-option",{key:o+"_"+a,attrs:{disabled:t.selectedFieldMap[i.field],value:i.field,label:e.name+" -> "+i.name}})}),1)}),1)},ri=[],li={name:"control-form-data-combobox",props:{value:{type:String,require:!0},config:{type:Object,require:!0},styleText:{type:String,default:""}},computed:Object(Z["a"])({controlType:function(){var t=this.$store.state.selectedControlId;if(t){var e=this.$store.getters.controlDataMap[t];if(e&&e.control)return e.control.type}return null}},Object(gt["c"])(["selectedFieldMap"]),{tables:function(){var t=this.controlType,e=Object(vt["d"])(this.$store.state.fieldList),n=[];if(e.forEach(function(e){e.fields.forEach(function(o){o.field=e.id+";"+o.field,t&&o.fielddisplaytype==t&&n.push(Object(vt["d"])(o))})}),n.length){var o={name:"相关字段",id:"adapts",fields:n};e.unshift(o)}return e}}),methods:{change:function(t){this.$emit("change",t,this.config)}}},si=li,ci=Object(lt["a"])(si,ai,ri,!1,null,null,null),di=ci.exports,ui=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{suffix:t.config.suffix}},[n("el-input-number",{staticStyle:{"text-align":"left"},style:t.styleText,attrs:{placeholder:t.config.placeholder||"请输入"+(t.config.label||""),size:"small","controls-position":"right",controls:!1},on:{change:t.change},model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}}),t.config.suffix?n("span",{staticClass:"form-control-suffix"},[t._v(t._s(t.config.suffix))]):t._e()],1)},hi=[],fi={name:"control-number-textbox",props:{value:{type:[Number,String],default:function(){return""}},config:{type:Object,require:!0},styleText:{type:String,default:""}},data:function(){return{currentValue:parseInt(this.value,10)||0}},watch:{value:function(t){this.currentValue=parseInt(t,10)||0}},methods:{change:function(t){this.$emit("change",t,this.config)}}},pi=fi,mi=Object(lt["a"])(pi,ui,hi,!1,null,null,null),gi=mi.exports,vi=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-radio-group",{class:"direction-"+t.direction,on:{change:t.change},model:{value:t.currValue,callback:function(e){t.currValue=e},expression:"currValue"}},t._l(t.optionList,function(e){return n("el-radio",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])}),1)},bi=[],yi=window.FORM_DESIGN_CONFIG.preset,Ci={name:"control-radio-list",mixins:[Eo],props:{value:{type:String,require:!0},config:{type:Object,require:!0}},data:function(){return{currValue:this.value,loading:!1,originOptionList:[]}},created:function(){!this.config.data&&this.config.url&&this.getOriginData(this.config.url)},watch:{value:function(){this.currValue=this.value}},computed:{direction:function(){return this.config.direction||"horizontal"},optionList:function(){return this.config.data?this.staticOptionList:this.originOptionList},staticOptionList:function(){var t=this.config.data;if(!t)return[];if(Array.isArray(t))return t;var e=t+""===t;return e&&t in yi?yi[t]:[]}},methods:{change:function(t){this.$emit("change",t,this.config)}}},wi=Ci,xi=Object(lt["a"])(wi,vi,bi,!1,null,null,null),_i=xi.exports,Di=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-switch",{on:{change:t.change},model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}})},ki=[],Ti={name:"control-switch",props:{value:{type:Boolean,default:!1},config:{type:Object,require:!0},styleText:{type:String,default:"width:200px"}},data:function(){return{currentValue:this.value||!1}},watch:{value:function(t){this.currentValue=t}},methods:{change:function(t){this.$emit("change",t,this.config)}}},Si=Ti,Oi=Object(lt["a"])(Si,Di,ki,!1,null,null,null),Ei=Oi.exports,Ii=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{suffix:t.config.suffix}},[n("el-input",{ref:"input",style:t.styleText,attrs:{placeholder:t.config.placeholder||"请输入"+(t.config.label||""),size:"small"},on:{change:t.change},model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}}),t.config.suffix?n("span",{staticClass:"form-control-suffix"},[t._v(t._s(t.config.suffix))]):t._e()],1)},Li=[],Ai={name:"control-textbox",props:{value:{type:String,default:""},config:{type:Object,require:!0},styleText:{type:String,default:""}},data:function(){return{currentValue:this.value||""}},watch:{value:function(t){this.currentValue=t}},methods:{focus:function(){this.$refs.input.select()},change:function(t){this.$emit("change",t,this.config)}}},$i=Ai,ji=Object(lt["a"])($i,Ii,Li,!1,null,null,null),Mi=ji.exports,Ri=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-control-item width-set",style:t.styleText},[n("el-select",{staticClass:"width-set-select",attrs:{size:"small"},on:{change:t.typeChange},model:{value:t.currType,callback:function(e){t.currType=e},expression:"currType"}},[n("el-option",{attrs:{label:"百分比",value:"percent"}}),n("el-option",{attrs:{label:"像素",value:"number"}})],1),n("el-input-number",{staticClass:"width-set-input",attrs:{min:t.min,max:t.max,size:"small",controls:!1},on:{change:t.change},model:{value:t.currValue,callback:function(e){t.currValue=e},expression:"currValue"}}),n("span",{staticClass:"form-unit form-control-suffix"},[t._v(t._s("percent"==this.currType?"%":"px"))])],1)},zi=[],Pi={name:"control-width-set",props:{value:{type:[String,Number],require:!0},config:{type:Object,require:!0},styleText:{type:String,default:""}},data:function(){var t=this.getAdaptedData(this.value);return Object(Z["a"])({min:1},t)},watch:{value:function(){var t=this.getAdaptedData(this.value);this.currType=t.currType,this.currValue=t.currValue,this.max=t.max}},methods:{getAdaptedData:function(t){var e=t+""===t,n=parseInt(t,10)||100;return{currType:e?"percent":"number",currValue:e?Math.min(100,n):n,max:e?100:1/0}},typeChange:function(){this.change(this.currValue)},change:function(t){var e="percent"==this.currType?t+"%":t;this.$emit("change",e,this.config)}}},Vi=Pi,Fi=Object(lt["a"])(Vi,Ri,zi,!1,null,null,null),Bi=Fi.exports,Ni=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"preset-align"},[n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("对齐")]),n("AlignButton",{attrs:{type:"horizontal"},model:{value:t.textAlign,callback:function(e){t.textAlign=e},expression:"textAlign"}})],1)])},Hi=[],Wi={name:"extend-font-align",components:{AlignButton:wn},props:["controlData"],data:function(){return{textAlign:this.controlData.textAlign}},watch:{"controlData.textAlign":function(t){this.textAlign=t},textAlign:function(t){t!=this.controlData.textAlign&&this.$emit("change",t,"textAlign")}}},Gi=Wi,Ui=Object(lt["a"])(Gi,Ni,Hi,!1,null,null,null),qi=Ui.exports,Ji=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.controlData.popup?n("div",{staticClass:"extend-buttonedit-field"},[n("div",{staticClass:"form-item"},[n("div",{staticClass:"form-label"},[t._v("值字段")]),n("div",{staticClass:"form-control"},[n("el-select",{attrs:{size:"small"},model:{value:t.idField,callback:function(e){t.idField=e},expression:"idField"}},t._l(t.list,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})}),1)],1)]),n("div",{staticClass:"form-item"},[n("div",{staticClass:"form-label"},[t._v("显示字段")]),n("div",{staticClass:"form-control"},[n("el-select",{attrs:{size:"small"},model:{value:t.textField,callback:function(e){t.textField=e},expression:"textField"}},t._l(t.list,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})}),1)],1)])]):t._e()},Xi=[],Yi={};function Ki(t,e,n){var o=t+n;return Yi[o]||(Yi[o]=Object(vt["i"])(t,e).catch(function(t){Yi[o]=null,delete Yi[o],console.error(t)})),Yi[o]}var Qi=Ki,Zi={name:"extend-buttonedit-field",props:["controlData"],data:function(){return{list:[],idField:this.controlData.idField||"",textField:this.controlData.textField||""}},mounted:function(){this.controlData.popup&&this.getList(this.controlData.popup)},methods:{getList:function(t){var e=this;Qi(window.formDesignerActions.getListStructUrl,{listGuid:t},"buttoneditStruct-"+t).then(function(t){if(!Array.isArray(t.ListStruct))throw new TypeError("列表必须为数组");e.list=t.ListStruct,e.checkIn(e.idField,"id",e.list)||(e.idField=""),e.checkIn(e.textField,"id",e.list)||(e.textField="")}).catch(function(t){e.list=[],e.idField=e.textField="",e.console.error(t)})},checkIn:function(t,e,n){var o=!0,i=!1,a=void 0;try{for(var r,l=n[Symbol.iterator]();!(o=(r=l.next()).done);o=!0){var s=r.value;if(s[e]==t)return!0}}catch(c){i=!0,a=c}finally{try{o||null==l.return||l.return()}finally{if(i)throw a}}return!1},change:function(t,e){this.$emit("change",t,e)}},watch:{"controlData.popup":function(t){t?this.getList(t):(this.list=[],this.idField=this.textField="")},idField:function(t){t!=this.controlData.idField&&this.change(t,"idField")},textField:function(t){t!=this.controlData.textField&&this.change(t,"textField")}}},ta=Zi,ea=Object(lt["a"])(ta,Ji,Xi,!1,null,null,null),na=ea.exports,oa=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"preset-data-action",class:{disabled:t.hasAutoCodeItem}},[t.hasAutoCodeItem?n("div",{staticClass:"tips"},[n("i",{staticClass:"el-icon-info",staticStyle:{color:"#409EFF"}}),t._v(" 选中的关联字段已经有对应数据源了")]):t._e(),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("配置方式")]),n("div",{staticClass:"form-control"},[n("el-radio-group",{attrs:{disabled:t.hasAutoCodeItem},model:{value:t.sourceType,callback:function(e){t.sourceType=e},expression:"sourceType"}},t._l(t.sourceList,function(e){return n("el-radio",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])}),1)],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:"static"==t.sourceType,expression:"sourceType == 'static'"}],staticClass:"form-item"},[n("el-form",{ref:"dataActionForm",attrs:{model:t.customData,inline:!0,disabled:t.hasAutoCodeItem}},t._l(t.customData,function(e,o){return n("div",{key:o,staticClass:"data-source-item"},[n("el-form-item",{staticClass:"data-source-input value",attrs:{prop:o+".id",rules:t.rules.id}},[n("el-input",{attrs:{placeholder:"值",size:"mini"},model:{value:e.id,callback:function(n){t.$set(e,"id",n)},expression:"item.id"}})],1),n("el-form-item",{staticClass:"data-source-input text",attrs:{prop:o+".text",rules:t.rules.text}},[n("el-input",{attrs:{placeholder:"显示名称",size:"mini"},model:{value:e.text,callback:function(n){t.$set(e,"text",n)},expression:"item.text"}})],1),n("el-button",{staticClass:"data-source-item-btn del",attrs:{type:"danger",plain:"",size:"mini",icon:"el-icon-delete"},on:{click:function(e){return t.deleteItem(o)}}}),n("el-button",{staticClass:"data-source-item-btn up",attrs:{size:"mini",icon:"el-icon-caret-top",disabled:"0"==o},on:{click:function(e){return t.moveUp(o)}}}),n("el-button",{staticClass:"data-source-item-btn down",attrs:{size:"mini",icon:"el-icon-caret-bottom",disabled:o==t.customData.length-1},on:{click:function(e){return t.moveDown(o)}}})],1)}),0),n("el-button",{attrs:{icon:"el-icon-plus",size:"mini"},on:{click:t.addItem}},[t._v("添加选项")]),n("el-button",{attrs:{disabled:!t.customData.length,icon:"el-icon-save",size:"mini"},on:{click:t.applyItem}},[t._v("应用")])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:"action"==t.sourceType,expression:"sourceType == 'action'"}],staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("远程数据源")]),n("div",{staticClass:"form-control"},[n("el-select",{attrs:{placeholder:"请选择远程数据源",disabled:t.hasAutoCodeItem,size:"small",filterable:""},on:{change:t.onActionChange},model:{value:t.selectedAction,callback:function(e){t.selectedAction=e},expression:"selectedAction"}},t._l(t.actionList,function(t){return n("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})}),1)],1)])])},ia=[],aa={name:"extend-data-action",props:["controlData"],components:{},data:function(){var t=this.controlData,e=t.data,n=t.codeItem,o=Array.isArray(e);return{sourceType:o?"static":"action",sourceList:[{id:"static",text:"自定义"},{id:"action",text:"远程"}],customData:o?Object(vt["d"])(e):[],selectedAction:n||"",rules:{id:[{validator:this.validateId,trigger:"blur"}],text:[{required:!0,message:"必须输入显示名称",trigger:"blur"}]}}},computed:Object(Z["a"])({},Object(gt["e"])(["fieldList"]),{hasAutoCodeItem:function(){return!1},actionList:function(){return Object(vt["d"])(this.$store.state.codeList)}}),methods:{validateId:function(t,e,n){if(!e)return n(new Error("必填"));var o=this.customData[t.field.split(".")[0]];return this.checkDuplicated(e,o)?n(new Error("值必须唯一")):n()},checkDuplicated:function(t,e){var n=!0,o=!1,i=void 0;try{for(var a,r=this.customData[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){var l=a.value;if(l!==e&&t==l.id)return!0}}catch(s){o=!0,i=s}finally{try{n||null==r.return||r.return()}finally{if(o)throw i}}return!1},addItem:function(){var t=this;if(this.customData.length)return this.$refs.dataActionForm.validate(function(e){e?t.customData.push({id:"",text:""}):t.$message({message:"请先处理当前内容",customClass:"data-action-error-box",type:"error"})});this.customData.push({id:"",text:""})},deleteItem:function(t){this.customData.splice(t,1)},applyItem:function(){var t=this;this.$refs.dataActionForm.validate(function(e,n){var o;o=e?Object(vt["d"])(t.customData):Object(vt["d"])(t.customData.filter(function(t,e){return!(e+".id"in n||e+".text"in n)})),Array.isArray(o)&&t.useStaticData(o)})},moveUp:function(t){if(0!==t){var e=this.customData.splice(t,1)[0];this.customData.splice(t-1,0,e)}},moveDown:function(t){if(t!==this.customData.length-1){var e=this.customData.splice(t,1)[0];this.customData.splice(t+1,0,e)}},onActionChange:function(t){this.useAction(t)},useStaticData:function(t){var e;this.controlData.codeItem&&(e="dataaction"+ +new Date,this.$emit("change","","codeItem",e)),this.$emit("change",t,"data",e)},useAction:function(t){var e;this.controlData.data&&(e="dataaction"+ +new Date,this.$emit("change","","data",e)),this.$emit("change",t,"codeItem",e)}},watch:{sourceType:function(t){"action"==t&&this.useAction(this.selectedAction)},controlData:{deep:!0,handler:function(){var t=this.controlData,e=t.data,n=t.codeItem;Array.isArray(e)?(this.customData=Object(vt["d"])(e),this.sourceType="static"):this.sourceType="action",n&&(this.selectedAction=n)}}}},ra=aa,la=(n("25cd"),Object(lt["a"])(ra,oa,ia,!1,null,null,null)),sa=la.exports,ca=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"extend-daterange-config"},[n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("日期范围")]),n("div",{staticClass:"form-control"},[n("el-select",{attrs:{size:"small"},on:{change:t.onRangeTypeChange},model:{value:t.rangeType,callback:function(e){t.rangeType=e},expression:"rangeType"}},t._l(t.rangeTypeList,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})}),1)],1)]),"range"==t.rangeType?n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("开始")]),n("div",{staticClass:"form-control"},[n("el-select",{staticClass:"form-control-item",attrs:{size:"small"},on:{change:function(e){return t.selectedChange(e,"start")}},model:{value:t.selectedValue1,callback:function(e){t.selectedValue1=e},expression:"selectedValue1"}},[n("el-option",{attrs:{value:"static",label:"选择固定日期"}}),t._l(t.controlList,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})],2),t.selectedValue1==t.typeMap.static?n("el-date-picker",{staticClass:"form-control-item",attrs:{"picker-options":t.startPickerOptions,"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择开始日期",size:"small"},on:{change:function(e){return t.onDateChange("start")}},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}}):t._e()],1)]):t._e(),"range"==t.rangeType?n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("结束")]),n("div",{staticClass:"form-control"},[n("el-select",{staticClass:"form-control-item",attrs:{size:"small"},on:{change:function(e){return t.selectedChange(e,"end")}},model:{value:t.selectedValue2,callback:function(e){t.selectedValue2=e},expression:"selectedValue2"}},[n("el-option",{attrs:{value:"static",label:"选择固定日期"}}),t._l(t.controlList,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})],2),t.selectedValue2==t.typeMap.static?n("el-date-picker",{staticClass:"form-control-item",attrs:{"picker-options":t.endPickerOptions,"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择结束日期",size:"small"},on:{change:function(e){return t.onDateChange("end")}},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}}):t._e()],1)]):t._e()])},da=[],ua=/^\d{4}-\d{2}-\d{2}$/,ha=/^\{.+\}$/,fa={name:"extend-daterange-config",props:["controlData"],components:{},computed:{startType:function(){return this.getLimitType(this.controlData.minDate)},endType:function(){return this.getLimitType(this.controlData.maxDate)},controlList:function(){var t=this,e=/datepicker/i,n=this.$store.state.hiddenControls,o=this.$store.getters.allControls,i=[];return o.forEach(function(n){e.test(n.type)&&n.id!=t.controlData.id&&i.push({type:n.type,id:n.id,name:n.name||n.namePrefix+"_"+n.autoIndex})}),n.forEach(function(t){i.push({type:t.type,id:t.id,name:t.name||t.namePrefix+"_"+t.autoIndex})}),i}},data:function(){var t=this;return Object(Z["a"])({rangeType:this.getRangeType(this.controlData.minDate,this.controlData.maxDate),rangeTypeList:[{id:"empty",text:"留空"},{id:"range",text:"指定范围"}]},this.getDateFromControl(this.controlData),{typeMap:{static:"static",control:"control"},startPickerOptions:{disabledDate:function(e){return!!t.endDate&&e.getTime()>new Date(t.endDate).getTime()}},endPickerOptions:{disabledDate:function(e){return!!t.startDate&&e.getTime()<new Date(t.startDate).getTime()}}})},methods:{getDateFromControl:function(t){var e="",n="",o="",i="";return t.minDate&&(ha.test(t.minDate)?e=t.minDate.substring(1,t.minDate.length-1):ua.test(t.minDate)?(e="static",o=t.minDate):console.error("日期不合法： "+t.minDate)),t.maxDate&&(ha.test(t.maxDate)?n=t.maxDate.substring(1,t.maxDate.length-1):ua.test(t.maxDate)?(n="static",i=t.maxDate):console.error("日期不合法： "+t.maxDate)),{selectedValue1:e,selectedValue2:n,startDate:o,endDate:i}},getRangeType:function(t,e){return!t&&!e||""==t&&""==e?"empty":"range"},getLimitType:function(t){return t&&""!=t?ua.test(t)?this.typeMap.static:this.typeMap.control:this.typeMap.static},onRangeTypeChange:function(t){"empty"==t?this.clearRange():(this.startDate&&this.onDateChange("start"),this.endDate&&this.onDateChange("end"))},clearRange:function(){""!=this.controlData.minDate&&this.$emit("change","","minDate"),""!=this.controlData.maxDate&&this.$emit("change","","maxDate")},selectedChange:function(t,e){if(t!=this.typeMap.static)t&&this.$emit("change","{".concat(t,"}"),"start"==e?"minDate":"maxDate");else{var n="start"==e?this.startDate:this.endDate;n&&this.$emit("change",n,"start"==e?"minDate":"maxDate")}},onDateChange:function(t){"range"==this.rangeType&&("start"==t&&this.startType==this.typeMap.static&&this.$emit("change",this.startDate,"minDate"),"end"==t&&this.endType==this.typeMap.static&&this.$emit("change",this.endDate,"maxDate"))}}},pa=fa,ma=Object(lt["a"])(pa,ca,da,!1,null,null,null),ga=ma.exports,va=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"preset-font"},[n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("字体")]),n("el-select",{staticClass:"font-set-select",attrs:{size:"small"},model:{value:t.fontFamily,callback:function(e){t.fontFamily=e},expression:"fontFamily"}},t._l(t.fontFamilyList,function(t){return n("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})}),1),n("el-input-number",{staticClass:"font-set-input",attrs:{size:"small",controls:!1,min:12,max:100},model:{value:t.fontSize,callback:function(e){t.fontSize=e},expression:"fontSize"}}),n("span",{staticClass:"form-control-suffix"},[t._v("px")])],1),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("样式")]),n("FontColor",{staticStyle:{"margin-right":"10px"},model:{value:t.fontColor,callback:function(e){t.fontColor=e},expression:"fontColor"}}),n("div",{staticClass:"design-button-group font-group"},[n("el-tooltip",{attrs:{"open-delay":500,content:"加粗"}},[n("MyButton",{class:{active:t.fontBolder},attrs:{icon:"font-bold"},nativeOn:{click:function(e){t.fontBolder=!t.fontBolder}}})],1),n("el-tooltip",{attrs:{"open-delay":500,content:"倾斜"}},[n("MyButton",{class:{active:t.fontItalic},attrs:{icon:"font-italic"},nativeOn:{click:function(e){t.fontItalic=!t.fontItalic}}})],1),n("el-tooltip",{attrs:{"open-delay":500,content:"下划线"}},[n("MyButton",{class:{active:t.fontUnderline},attrs:{icon:"font-underline"},nativeOn:{click:function(e){t.fontUnderline=!t.fontUnderline}}})],1)],1)],1)])},ba=[],ya=window.FORM_DESIGN_CONFIG.preset.fontFamilyList,Ca={name:"extend-font-config",props:["controlData"],components:{FontColor:Qn,MyButton:vn},data:function(){return{fontFamilyList:JSON.parse(JSON.stringify(ya)),fontFamily:this.controlData.fontFamily,fontSize:this.controlData.fontSize,fontColor:this.controlData.fontColor,fontBolder:this.controlData.fontBolder,fontItalic:this.controlData.fontItalic,fontUnderline:this.controlData.fontUnderline}},methods:{handleChange:function(t,e){this.controlData[e]!=t&&this.$emit("change",t,e)}},watch:{controlData:{deep:!0,handler:function(){var t=this.controlData,e=t.fontFamily,n=t.fontSize,o=t.fontColor,i=t.fontBolder,a=t.fontItalic,r=t.fontUnderline;this.fontFamily=e,this.fontSize=n,this.fontColor=o,this.fontBolder=i,this.fontItalic=a,this.fontUnderline=r}},fontFamily:function(t){this.handleChange(t,"fontFamily")},fontSize:function(t){this.handleChange(t,"fontSize")},fontColor:function(t){this.handleChange(t,"fontColor")},fontBolder:function(t){this.handleChange(t,"fontBolder")},fontItalic:function(t){this.handleChange(t,"fontItalic")},fontUnderline:function(t){this.handleChange(t,"fontUnderline")}}},wa=Ca,xa=Object(lt["a"])(wa,va,ba,!1,null,null,null),_a=xa.exports,Da=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"frozen-column"},[n("div",{staticClass:"form-item"},[n("div",{staticClass:"form-control "},[n("el-checkbox",{on:{change:t.onSwitch},model:{value:t.isFrozen,callback:function(e){t.isFrozen=e},expression:"isFrozen"}},[t._v("冻结列")])],1)]),t.isFrozen?n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("冻结列索引")]),n("div",{staticClass:"form-control "},[n("el-input-number",{attrs:{min:0,max:t.columnLength-2,size:"mini",controls:!1},on:{change:t.change},model:{value:t.frozenIndex,callback:function(e){t.frozenIndex=e},expression:"frozenIndex"}})],1)]):t._e()])},ka=[],Ta={name:"extend-frozen-column",props:["controlData"],computed:{columnLength:function(){var t=this.controlData.specialColumns.split(",").length,e=this.controlData.columns.length||4;return t+e}},data:function(){var t=parseInt(this.controlData.frozenColumnIndex,10);return{isFrozen:-1!==t,frozenIndex:t}},methods:{change:function(t){this.controlData.frozenIndex!=t&&this.$emit("change",t,"frozenColumnIndex")},onSwitch:function(t){var e=this;t?this.$nextTick(function(){e.change(e.frozenIndex)}):this.$emit("change",-1,"frozenColumnIndex")}},watch:{"controlData.frozenColumnIndex":function(t){var e=parseInt(t,10);this.frozenIndex=e,this.isFrozen=-1!==e}}},Sa=Ta,Oa=Object(lt["a"])(Sa,Da,ka,!1,null,null,null),Ea=Oa.exports,Ia=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"extend-range-validate"},[n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v(t._s(t.validateTextMap[t.validateType]))]),n("div",{staticClass:"form-control"},[n("el-switch",{on:{change:t.change},model:{value:t.showRangeValidate,callback:function(e){t.showRangeValidate=e},expression:"showRangeValidate"}})],1)]),t.showRangeValidate?n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("值")]),n("div",{staticClass:"form-control"},[n("el-select",{staticClass:"range-validate-operation",attrs:{size:"small"},on:{change:t.change},model:{value:t.operation1,callback:function(e){t.operation1=e},expression:"operation1"}},t._l(t.operationList,function(t){return n("el-option",{key:t,attrs:{value:t,label:t}})}),1),n("el-select",{staticClass:"range-validate-value",attrs:{size:"small"},on:{change:t.change},model:{value:t.selectedValue1,callback:function(e){t.selectedValue1=e},expression:"selectedValue1"}},[n("el-option",{attrs:{value:"static",label:"输入固定值"}}),t._l(t.controlList,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})],2),"static"==t.selectedValue1?n("el-input",{staticClass:"range-validate-input",attrs:{placeholder:"请输入",size:"small"},on:{change:t.change},model:{value:t.operationValue1,callback:function(e){t.operationValue1=e},expression:"operationValue1"}}):t._e(),n("span",{directives:[{name:"show",rawName:"v-show",value:!t.showExt,expression:"!showExt"}],staticClass:"ext-btn el-icon-plus",on:{click:t.showCondition2}})],1)]):t._e(),t.showRangeValidate?n("div",{directives:[{name:"show",rawName:"v-show",value:t.showExt,expression:"showExt"}],staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("且")]),n("div",{staticClass:"form-control"},[n("el-select",{staticClass:"range-validate-operation",attrs:{size:"small"},on:{change:t.change},model:{value:t.operation2,callback:function(e){t.operation2=e},expression:"operation2"}},t._l(t.operationList,function(t){return n("el-option",{key:t,attrs:{value:t,label:t}})}),1),n("el-select",{staticClass:"range-validate-value",attrs:{size:"small"},on:{change:t.change},model:{value:t.selectedValue2,callback:function(e){t.selectedValue2=e},expression:"selectedValue2"}},[n("el-option",{attrs:{value:"static",label:"输入固定值"}}),t._l(t.controlList,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})],2),"static"==t.selectedValue2?n("el-input",{staticClass:"range-validate-input",attrs:{placeholder:"请输入",size:"small"},on:{change:t.change},model:{value:t.operationValue2,callback:function(e){t.operationValue2=e},expression:"operationValue2"}}):t._e(),n("span",{staticClass:"ext-btn el-icon-delete",on:{click:t.hideCondition2}})],1)]):t._e()])},La=[],Aa=(n("55dd"),{name:"extend-range-validate",props:["controlData"],data:function(){return Object(Z["a"])({validateTextMap:{string:"文本值比较",number:"数值比较"}},this.getCompentValueFromControl(this.controlData))},computed:{controlList:function(){var t=this,e=/textbox|textarea|radiobuttonlist|combobox|macro|treeselect/i,n=this.$store.state.hiddenControls,o=this.$store.getters.allControls,i=[];return o.forEach(function(n){e.test(n.type)&&n.id!=t.controlData.id&&i.push({type:n.type,id:n.id,name:n.name||n.namePrefix+"_"+n.autoIndex})}),n.forEach(function(t){i.push({type:t.type,id:t.id,name:t.name||t.namePrefix+"_"+t.autoIndex})}),i.sort(function(t,e){return t.type==e.type?0:"textbox"==e.type&&"textbox"!=t.type||"hiddenfield"==e.type&&"hiddenfield"!=t.type?1:-1}),i},inputType:function(){var t=this.controlData.vtype;return"int"==t||"float"==t?"number":"string"},operationList:function(){return"number"==this.inputType?["<","<=","==",">",">="]:["=="]},condition1Done:function(){return!(!this.operation1||!this.selectedValue1)&&!("static"==this.selectedValue1&&!this.operationValue1)},condition2Done:function(){return!(!this.operation2||!this.selectedValue2)&&!("static"==this.selectedValue2&&!this.operationValue2)}},methods:{getCompentValueFromControl:function(t){var e=!1,n=!1,o="",i="",a="",r="",l="",s="",c="",d=(t||this.controlData).vtype,u=(t||this.controlData).rangeValidator,h=u&&u.conditions;if(o="int"==d||"float"==d?"number":"string",h&&h.length){if(e=!0,h[0]){i=h[0].operation;var f=this.getOperationInfo(h[0].value);r=f.type,s=f.value}else i="string"==o?"==":"<=",s=r="";if(h[1]){a=h[1].operation;var p=this.getOperationInfo(h[1].value);l=p.type,c=p.value,n=!0}else a="string"==o?"==":">=",c=l="",n=!1}return{showRangeValidate:e,showExt:n,validateType:o,operation1:i,operation2:a,selectedValue1:r,selectedValue2:l,operationValue1:s,operationValue2:c}},getOperationInfo:function(t){if(/^\{.+\}$/.test(t)){var e=t.substring(1,t.length-1);return{type:e,value:""}}return{type:"static",value:t}},showCondition2:function(){if(!this.condition1Done)return this.$message({type:"error",message:"请先填好当前条件"});this.showExt=!0,this.change()},hideCondition2:function(){this.showExt=!1,this.operation2="string"==this.validateType?"==":">=",this.operationValue2=this.selectedValue2="",this.change()},getSubmitValue:function(){var t={type:this.validateType,conditions:[]};return this.condition1Done&&t.conditions.push({operation:this.operation1,value:"static"==this.selectedValue1?this.operationValue1:"{".concat(this.selectedValue1,"}")}),this.showExt&&this.condition2Done&&t.conditions.push({operation:this.operation2,value:"static"==this.selectedValue2?this.operationValue2:"{".concat(this.selectedValue2,"}")}),t},change:function(){var t=this.getSubmitValue();this.showRangeValidate&&t&&t.conditions&&t.conditions.length||(t=null),this.$emit("change",t,"rangeValidator")}},watch:{"controlData.vtype":function(){var t=this.getCompentValueFromControl(this.controlData),e=t.showRangeValidate,n=t.showExt,o=t.validateType,i=t.operation1,a=t.operation2,r=t.selectedValue1,l=t.selectedValue2,s=t.operationValue1,c=t.operationValue2;this.showRangeValidate=e,this.showExt=n,this.validateType=o,this.operation1=i,this.operation2=a,this.selectedValue1=r,this.selectedValue2=l,this.operationValue1=s,this.operationValue2=c}}}),$a=Aa,ja=Object(lt["a"])($a,Ia,La,!1,null,null,null),Ma=ja.exports,Ra=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.showFormSelect?n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("编辑页地址")]),n("div",{staticClass:"form-control"},[n("el-select",{staticClass:"form-control-item",attrs:{size:"mini"},on:{change:t.change},model:{value:t.selectedFormId,callback:function(e){t.selectedFormId=e},expression:"selectedFormId"}},t._l(t.formList,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})}),1)],1)]):t._e()},za=[],Pa={name:"extend-sub-table-edit-form",props:["controlData"],computed:{showFormSelect:function(){return"dialog"==this.controlData.editType},tableId:function(){return this.controlData.sourceTable}},data:function(){return{selectedFormId:this.controlData.editFormGuid||"",formList:[]}},mounted:function(){this.getForms()},methods:{getForms:function(){var t=this;if(!this.tableId)return this.formList=[];Qi(window.formDesignerActions.getSubTableInfoUrl,{tableId:this.tableId},"subTableData-"+this.tableId).then(function(e){var n=e.SubTableForm;if(!Array.isArray(n))throw new Error("获取编辑表单失败");t.formList=n.map(function(t){return{id:t.formGuid,text:t.formName}})}).catch(function(t){console.error(t)})},change:function(t){this.$emit("change",t,"editFormGuid")}},watch:{tableId:function(){this.showFormSelect&&this.getForms()},"controlData.editFormGuid":function(t){this.selectedFormId=t}}},Va=Pa,Fa=Object(lt["a"])(Va,Ra,za,!1,null,null,null),Ba=Fa.exports,Na=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"extend-sub-table-fields"},[n("div",{staticClass:"form-item"},[n("el-button",{attrs:{disabled:!t.tableId,size:"mini"},on:{click:function(e){t.showDialog=!0}}},[t._v("点击配置")])],1),n("el-dialog",{staticClass:"column-config-dialog",attrs:{"append-to-body":"",title:"表格字段配置",visible:t.showDialog,"before-close":t.handleClose,width:t.showEditor?"80%":"50%"},on:{"update:visible":function(e){t.showDialog=e}}},[t.showDialog?n("div",[n("div",{staticClass:"column-config-header"},[n("div",{staticClass:"span display"},[t._v("显示")]),n("div",{staticClass:"span move"},[t._v("排序")]),n("div",{staticClass:"span name"},[t._v("名称")]),t.showEditor?n("div",{staticClass:"span editor"},[t._v("编辑类型")]):t._e(),t.showEditor?n("div",{staticClass:"span required"},[t._v("必填")]):t._e(),n("div",{staticClass:"span align"},[t._v("对齐方式")]),n("div",{staticClass:"span width"},[t._v("列宽(px)")]),t.showEditor?n("div",{staticClass:"span vtype"},[t._v("格式校验")]):t._e()]),n("div",{staticClass:"column-config-list"},[n("draggable",{attrs:{list:t.columns,handle:".move",direction:"vertical"},on:{start:function(e){t.drag=!0},end:function(e){t.drag=!1},change:t.change}},t._l(t.columns,function(e){return n("column-config",{key:e.field,attrs:{field:e,showEditor:t.showEditor},on:{change:t.change}})}),1)],1)]):t._e(),n("span",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.save}},[t._v("确 定")]),n("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.beforeClose()}}},[t._v("取 消")])],1)])],1)},Ha=[],Wa=n("1980"),Ga=n.n(Wa),Ua=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"column-config-item"},[n("div",{staticClass:"span display"},[n("el-checkbox",{on:{change:function(e){return t.change("display",t.field.display)}},model:{value:t.field.display,callback:function(e){t.$set(t.field,"display",e)},expression:"field.display"}})],1),t._m(0),n("div",{staticClass:"span name"},[n("el-input",{attrs:{size:"mini"},on:{change:function(e){return t.change("name",t.field.name)}},model:{value:t.field.name,callback:function(e){t.$set(t.field,"name",e)},expression:"field.name"}})],1),t.showEditor?n("div",{staticClass:"span editor"},[n("el-select",{attrs:{size:"mini"},on:{change:function(e){return t.change("controlType",t.field.controlType)}},model:{value:t.field.controlType,callback:function(e){t.$set(t.field,"controlType",e)},expression:"field.controlType"}},t._l(t.controlTypes,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})}),1)],1):t._e(),t.showEditor?n("div",{staticClass:"span required"},[n("el-checkbox",{on:{change:function(e){return t.change("required",t.field.required)}},model:{value:t.field.required,callback:function(e){t.$set(t.field,"required",e)},expression:"field.required"}})],1):t._e(),n("div",{staticClass:"span align"},[n("AlignButton",{attrs:{type:"horizontal"},on:{change:function(e){return t.change("align",t.field.align)}},model:{value:t.field.align,callback:function(e){t.$set(t.field,"align",e)},expression:"field.align"}})],1),n("div",{staticClass:"span width"},[n("el-input-number",{attrs:{size:"mini",controls:!1},on:{change:function(e){return t.change("width",t.field.width)}},model:{value:t.field.width,callback:function(e){t.$set(t.field,"width",e)},expression:"field.width"}})],1),t.showEditor?n("div",{staticClass:"span vtype"},[n("el-select",{attrs:{size:"mini",disabled:"textbox"!=t.field.controlType},on:{change:function(e){return t.change("vtype",t.field.vtype)}},model:{value:t.field.vtype,callback:function(e){t.$set(t.field,"vtype",e)},expression:"field.vtype"}},t._l(t.vtypeList,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})}),1)],1):t._e()])},qa=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"span move"},[n("span",{staticClass:"sort-handle el-icon-rank",staticStyle:{cursor:"move"}})])}],Ja={name:"column-config",components:{AlignButton:wn},props:["field","showEditor"],computed:{},data:function(){return{vtypeList:Object(vt["d"])(window.FORM_DESIGN_CONFIG.preset["epointsform.validateTypes"]),controlTypes:Object(vt["d"])(window.FORM_DESIGN_CONFIG.preset["epointsform.columnEditors"])}},methods:{change:function(t,e){this.$emit("change",t,e)}}},Xa=Ja,Ya=Object(lt["a"])(Xa,Ua,qa,!1,null,null,null),Ka=Ya.exports,Qa={width:100,align:"center",required:!1,controlType:"",vtype:""},Za={name:"extend-sub-table-fields",components:{ColumnConfig:Ka,draggable:Ga.a},props:["controlData"],computed:{tableId:function(){return this.controlData.sourceTable},fieldMap:function(){var t={};return this.fieldList.forEach(function(e){t[e.field]=e}),t},showEditor:function(){return"dialog"!=this.controlData.editType}},mounted:function(){this.getFields()},data:function(){return{fieldList:[],columns:[],showDialog:!1,loading:!1,drag:!1,dataChanged:!1}},methods:{getConfigColumns:function(){var t=this;if(this.fieldList.length){var e=this.controlData.columns||[];if(e.length){var n=[],o={};e.forEach(function(e){t.fieldMap[e.field]&&(o[e.field]=!0,n.push(Oo()({},Qa,e)))}),this.fieldList.forEach(function(t){o[t.field]||n.push(Oo()({},Qa,t))}),this.columns=n}else this.columns=this.fieldList.map(function(t){var e=Oo()({},Qa,t);return e.display=!0,e})}else this.columns=[]},getRealColumns:function(){if(!this.columns.length)return[];var t=Object(vt["d"])(this.columns).filter(function(t){return t.display});return t.forEach(function(t){t.controlType&&"textbox"!=t.controlType&&(t.vtype="")}),t},change:function(){this.dataChanged=!0},beforeClose:function(t){var e=this;this.dataChanged?this.$confirm("确认不保存直接关闭？").then(function(){t?t():e.showDialog=!1}).catch(function(t){console.error(t)}):this.showDialog=!1},handleClose:function(t){this.beforeClose(t)},getFields:function(){var t=this;if(!this.tableId)return this.fieldList=[];this.loading=!0,Qi(window.formDesignerActions.getSubTableInfoUrl,{tableId:this.tableId},"subTableData-"+this.tableId).then(function(e){var n=e.SubTableStruct;if(!Array.isArray(n))throw new Error("获取子表字段失败");n.forEach(function(t){t.required=1==parseInt(t.required,10)}),t.fieldList=n}).catch(function(e){console.error(e),t.loading=!1})},save:function(){var t=this.getRealColumns();this.$emit("change",t,"columns"),this.showDialog=!1}},watch:{tableId:function(){this.getFields()},fieldList:function(){this.getConfigColumns()},showDialog:function(t){t||(this.dataChanged=!1)}}},tr=Za,er=(n("f5bd"),Object(lt["a"])(tr,Na,Ha,!1,null,null,null)),nr=er.exports,or={checkbox:Do,checkboxlist:jo,combobox:Bo,defaultdate:Yo,filetypepicker:ii,fontcolor:Qn,formdatacombobox:di,numbertextbox:gi,radiobuttonlist:_i,switch:Ei,textbox:Mi,widthconfig:Bi,"extend-alignconfig":qi,"extend-buttoneditfield":na,"extend-dataaction":sa,"extend-daterangeconfig":ga,"extend-fontconfig":_a,"extend-frozencolumn":Ea,"extend-rangevalidate":Ma,"extend-subtableeditform":Ba,"extend-subtablefields":nr},ir={name:"default-control-component",inheritAttrs:!1,props:["config","value","controlData"],template:'<div>{{controlData ? "配置功能" : config.type}} 开发中...</div>'},ar=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{},[n("el-dropdown",{staticClass:"add-event-drop",attrs:{size:"small",trigger:"click",placement:"bottom-start"},on:{command:t.addEvent}},[n("div",{staticClass:"add-event-drop-trigger"},[n("span",{staticClass:"el-icon-plus add-event-icon"}),t._v("添加事件")]),n("el-dropdown-menu",{staticClass:"add-event-dropmenu",attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.eventTypeList,function(e){return n("el-dropdown-item",{key:e.type,attrs:{command:e.type}},[t._v(t._s(e.name))])}),1)],1),t.eventList.length?n("div",{},t._l(t.controlData.events,function(e,o){return n("div",{key:o},t._l(e,function(e,i){return n("EventCard",{key:e.type+"-"+i,attrs:{"event-data":e,"target-name-map":t.targetNameMap},on:{"edit-event":function(e){return t.editEvent(o,i)},"remove-event":function(e){return t.removeEvent(o,i)},"remove-action":function(e){var n=arguments.length,a=Array(n);while(n--)a[n]=arguments[n];return t.removeEventAction.apply(void 0,[o,i].concat(a))}}})}),1)}),0):t._e(),n("el-dialog",{staticClass:"event-config-dialog",attrs:{width:"800px",visible:t.dialogVisible,title:"add"==t.configData.editType?"新增事件":"修改事件","close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":t.cancel,"append-to-body":""}},[t.dialogVisible?n("EventConfig",{attrs:{"control-data":t.controlData,"target-name-map":t.targetNameMap,"edit-type":t.configData.editType,"default-event-type":t.configData.eventType,"event-description":t.configData.evData,"event-type-list":t.eventTypeList},on:{save:t.saveEvent,cancel:t.cancel}}):t._e()],1)],1)},rr=[],lr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"event-config"},[n("div",{staticClass:"event-config-header"},[n("el-select",{staticClass:"event-config-typeselect",attrs:{size:"small",disabled:!t.eventTypeChangeable||!t.eventTypeList.length||1==t.eventTypeList.length},on:{change:t.onEventTypeChanged},model:{value:t.eventType,callback:function(e){t.eventType=e},expression:"eventType"}},t._l(t.eventTypeList,function(t){return n("el-option",{key:t.type,attrs:{value:t.type,label:t.name}})}),1),n("div",{directives:[{name:"show",rawName:"v-show",value:t.showCondition,expression:"showCondition"}],staticClass:"event-config-condition"},[t._v("\n      当满足 This\n      "),n("el-select",{staticClass:"event-operation",attrs:{size:"small"},model:{value:t.condition.operation,callback:function(e){t.$set(t.condition,"operation",e)},expression:"condition.operation"}},t._l(t.operationList,function(e){return n("el-option",{key:e,attrs:{value:e,label:t.operationNames[e]}})}),1),n("el-select",{attrs:{size:"small"},model:{value:t.condition.target,callback:function(e){t.$set(t.condition,"target",e)},expression:"condition.target"}},t._l(t.controlDataList,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text||t.id}})}),1)],1)],1),n("div",{staticClass:"event-config-body"},[n("div",{staticClass:"event-config-lane choice"},[n("h3",{staticClass:"event-config-title"},[t._v("选择动作")]),t.eventConfigMap[t.eventType]?n("div",{staticClass:"event-config-list choice"},t._l(t.eventConfigMap[t.eventType].actionList,function(e){return n("div",{key:e.type,staticClass:"choice-action-item",class:{disabled:t.selectedActions[e.type]},on:{click:function(n){return t.addAction(e.type)}}},[t._v(t._s(e.name))])}),0):t._e()]),n("div",{staticClass:"event-config-lane action-config"},[n("h3",{staticClass:"event-config-title"},[t._v("组织动作")]),t.actions.length?n("div",{staticClass:"event-config-list"},t._l(t.actions,function(e,o){return n("div",{key:e.type,staticClass:"action-item"},[n("h4",{staticClass:"action-header",class:{active:e.type==t.currentAction,collaspe:e.collaspe},on:{click:function(n){t.currentAction=e.type}}},[n("span",{staticClass:"el-icon-arrow-down action-toggle",on:{click:function(t){t.stopPropagation(),e.targets.length&&(e.collaspe=!e.collaspe)}}}),n("span",{staticClass:"action-name"},[t._v(t._s(e.name))]),n("span",{staticClass:"action-remove el-icon-close",on:{click:function(n){return n.stopPropagation(),t.removeAction(o,e.type==t.currentAction)}}})]),e.targets.length?n("div",{staticClass:"action-targets",style:"height:"+30*e.targets.length+"px"},t._l(e.targets,function(e){return n("div",{key:e.id},[t._v("\n              "+t._s(t.targetNameMap[e.id])+" "),e.setValueField?n("span",[t._v(t._s(t.fieldNameMap[e.setValueField]))]):t._e()])}),0):n("span",[t._v("请在右侧为动作选择目标")])])}),0):n("span",[t._v("请先从左侧添加动作")])]),n("div",{staticClass:"event-config-lane targets"},[n("h3",{staticClass:"event-config-title"},[t._v("\n        对象目标 "+t._s(t.currentActionName)+"\n        "),"assignment"==t.currentAction?n("div",[n("div",{staticClass:"event-config-target-table"},[n("label",[t._v("赋值来源数据表：")]),n("el-select",{staticStyle:{float:"right","margin-right":"10px"},attrs:{size:"mini",filterable:""},on:{change:t.onTargetTableChange},model:{value:t.targetTable,callback:function(e){t.targetTable=e},expression:"targetTable"}},t._l(t.dataTables,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})}),1)],1),"assignment"==t.currentAction?n("div",{staticClass:"event-config-target-tablefield"},[n("label",[t._v("数据查询字段：")]),n("el-select",{staticStyle:{float:"right","margin-right":"10px"},attrs:{size:"mini",filterable:""},model:{value:t.targetTableField,callback:function(e){t.targetTableField=e},expression:"targetTableField"}},t._l(t.fieldList,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})}),1)],1):t._e()]):t._e()]),t.currentAction?n("TargetDisplay",{staticClass:"event-config-list",class:{table:"assignment"==t.currentAction,tablefield:"assignment"==t.currentAction},attrs:{type:t.treeDisplayType,"default-targets":t.currentActionTargets,"action-type":t.currentAction,"field-list":t.fieldList,"field-name-map":t.fieldNameMap,"except-id":t.controlData.id},on:{"ckecked-change":t.handeTargetChange}}):n("span",[t._v("请先选择动作")])],1)]),n("div",{staticClass:"event-config-footer"},[n("el-checkbox",{model:{value:t.runAtInit,callback:function(e){t.runAtInit=e},expression:"runAtInit"}},[t._v("初始化执行")]),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.save}},[t._v("保存")]),n("el-button",{attrs:{size:"mini"},on:{click:t.cancel}},[t._v("取消")])],1)])},sr=[],cr={valuechanged:{name:"值变更",originType:"valuechanged",actions:["assignment"]},"valuechanged:compare":{name:"值变更(关系比较)",originType:"valuechanged",actions:["show","hide","assignment","clear"]},"valuechanged:getcodelist":{name:"值变更(获取代码项)",originType:"valuechanged",actions:["setData"]}},dr={show:{name:"显示"},hide:{name:"隐藏"},assignment:{name:"赋值"},clear:{name:"清空"},setData:{name:"数据源设置"}},ur=(Object.keys(dr).map(function(t){return dr[t].type=t,dr}),Object.keys(cr).map(function(t){return cr[t].type=t,cr[t].actionList=cr[t].actions.map(function(t){return dr[t]}),cr[t]})),hr={"<=":"小于等于","<":"小于","!=":"不等于","==":"等于",">":"大于",">=":"大于等于"},fr={name:"event-config",components:{TargetDisplay:function(){return n.e("chunk-5a3568d5").then(n.bind(null,"22f8"))}},props:{editType:{type:String,required:!0,validator:function(t){return/^(?:add|edit)$/.test(t)}},defaultEventType:{type:String,required:!0},eventTypeList:{type:Array,default:function(){return ur}},controlData:{type:Object},eventDescription:[Object,null],targetNameMap:{type:Object}},computed:{eventTypeChangeable:function(){return"add"==this.editType},dataTables:function(){return this.$store.state.dataTables},selectedActions:function(){var t={};return this.actions.forEach(function(e){t[e.type]=!0}),t},showCondition:function(){return"valuechanged:compare"==this.eventType},treeDisplayType:function(){return/^(?:show|hide|clear)$/.test(this.currentAction)?"all":"assignment"==this.currentAction?"controls":"setData"==this.currentAction?"combobox":""},currentActionName:function(){var t=this.actionInfo[this.currentAction];return t?"(".concat(t.name,")"):""},currentActionTargets:function(){var t=!0,e=!1,n=void 0;try{for(var o,i=this.actions[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;if(a.type==this.currentAction)return a.targets||[]}}catch(r){e=!0,n=r}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}return[]},fieldNameMap:function(){var t={};return this.fieldList.forEach(function(e){t[e.id]=e.text}),t}},data:function(){return{actionInfo:dr,eventType:this.defaultEventType,eventConfigMap:cr,condition:{operation:"==",target:""},operationList:["==","!="],operationNames:hr,actions:[],currentAction:"",runAtInit:!1,targetTable:"",targetTableField:"",fieldList:[],controlDataList:[]}},created:function(){this.getFieldList(),this.getControlDataList(),"edit"==this.editType&&this.setEditEventData()},mounted:function(){"add"==this.editType&&1==this.eventConfigMap[this.eventType].actionList.length&&this.addAction(this.eventConfigMap[this.eventType].actionList[0].type)},methods:{setEditEventData:function(){var t=this,e=Object(vt["d"])(this.eventDescription),n=e.type,o=e.runAtInit,i=e.conditions,a=e.actions;this.eventType=n,i&&i.length&&(this.condition.operation=i[0].operation,this.condition.target=i[0].target),Array.isArray(a)?(this.actions=a.map(function(e){return"assignment"==e.type&&(t.targetTable=e.sourceTableId,t.targetTableField=e.sourceTableField||""),Object(Z["a"])({},e,{name:dr[e.type].name,collaspe:!1})}),this.currentAction=this.actions[0].type):(this.actions.length&&(this.actions=[]),this.currentAction=""),this.runAtInit=o},getFieldList:function(){var t=this;if(!this.targetTable)return this.fieldList=[];Ki(window.formDesignerActions.getTableFieldsUrl,{tableId:this.targetTable},"targerTable-"+this.targetTable).then(function(e){var n=e.TableStruct;Array.isArray(n)?t.fieldList=n:t.fieldList=[]}).catch(function(t){console.error(t)})},getControlDataList:function(){var t=this;if(this.controlDataList=[],this.showCondition)return this.controlData.data?this.controlDataList=Object(vt["d"])(this.controlData.data):this.$httpPost(window.formDesignerActions.getControlDataListUrl,{controlData:this.controlData}).then(function(e){if(!Array.isArray(e))throw new Error("获取控件数据出错!");t.controlDataList=e}).catch(function(t){console.error(t)})},addAction:function(t){this.selectedActions[t]||(this.actions.push(this.createAction(t)),this.currentAction=t)},createAction:function(t){var e=dr[t].name,n={type:t,name:e,targets:[],collaspe:!1};return n},removeAction:function(t,e){this.actions.splice(t,1),e&&(this.currentAction="")},handeTargetChange:function(t){var e=this,n=this.actions.filter(function(t){return t.type==e.currentAction})[0];n?n.targets=t:console.error("目标动作不存在")},onEventTypeChanged:function(){this.actions=[],this.currentAction=""},validate:function(){var t=this;return new Promise(function(e,n){var o=[];!t.showCondition||t.condition.operation&&t.condition.target||o.push({type:"condition",message:"事件条件未填写完整"}),t.actions.length?t.actions.forEach(function(e){e.targets&&e.targets.length||o.push({type:"action",target:e,message:"【".concat(e.name,"】动作未配置任何操作目标！")}),"assignment"==e.type&&(t.targetTable||o.push({type:"targetTable",message:"赋值必须选择数据来源表"}),t.targetTableField||o.push({type:"targetTableField",message:"必须选择查询字段"}),e.targets.forEach(function(t){t.setValueField||o.push({type:"target",message:"【".concat(e.name,"】动作下的 ").concat(t.nodeName," 控件未配置赋值字段！！")})}))}):o.push({type:"action",message:"还未配置任何事件动作！"}),o.length?n(o):e()})},save:function(){var t=this;return this.validate().then(function(){t._doSave()}).catch(function(e){var n;Array.isArray(e)?(console.error(e),n=1==e.length?e[0].message:"事件配置信息不完整，请检查",t.$message({message:n,type:"error",customClass:"event-config-error",showClose:!0})):console.error(e)})},_doSave:function(){var t=this,e={type:this.eventType,originType:cr[this.eventType].originType,runAtInit:this.runAtInit};this.showCondition&&(e.conditions=[Object(vt["d"])(this.condition)]),e.actions=this.actions.map(function(e){var n={type:e.type,targets:e.targets.map(function(t){var e={type:t.nodeType||t.type,id:t.id};return t.setValueField&&(e.setValueField=t.setValueField),e})};return"assignment"==e.type&&(n.sourceTableId=t.targetTable,n.sourceTableField=t.targetTableField),n}),JSON.stringify(e,0,2),this.$emit("save",this.eventType,e)},cancel:function(){this.$emit("cancel")},clearBindValueField:function(){var t=this.actions.filter(function(t){return"assignment"==t.type})[0];t.sourceTableField="",t&&t.targets&&t.targets.forEach(function(t){t.setValueField=""})},onTargetTableChange:function(){this.clearBindValueField()}},watch:{targetTable:function(){this.fieldList=[],this.getFieldList()},showCondition:function(t){t&&this.getControlDataList()}}},pr=fr,mr=(n("165c"),Object(lt["a"])(pr,lr,sr,!1,null,null,null)),gr=mr.exports,vr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"event-card"},[n("div",{staticClass:"event-card-header"},[n("span",{staticClass:"el-icon-arrow-down event-card-toggle"}),n("span",{staticClass:"event-name"},[t._v(t._s(t.eventInfo[t.eventData.type].name))]),n("span",{staticClass:"event-card-config"},[n("span",{staticClass:"el-icon-setting event-card-setting",on:{click:t.editEvent}}),n("span",{staticClass:"el-icon-delete event-card-delete",on:{click:t.removeEvent}})])]),t.eventData.conditions&&t.eventData.conditions.length?n("div",{staticClass:"event-card-condition"},[t._v("当满足 This "+t._s(t.operationNames[t.eventData.conditions[0].operation])+" "+t._s(t.eventData.conditions[0].target)+" 时")]):t._e(),n("div",{staticClass:"event-card-actions"},t._l(t.eventData.actions,function(e,o){return n("div",{key:e.type,staticClass:"event-card-action"},[n("span",{staticClass:"event-card-action-remove el-icon-close",on:{click:function(n){return t.removeAction(e.type,o,1==t.eventData.actions.length)}}}),n("div",{staticClass:"event-card-action-name"},[t._v(t._s(t.actionInfo[e.type].name))]),n("div",{staticClass:"event-card-action-targets"},t._l(e.targets,function(e){return n("div",{key:e.id,staticClass:"event-card-action-target"},[t._v("\n          "+t._s(t.targetNameMap[e.id])+" "),e.setValueField?n("span",{staticStyle:{"margin-left":"10px"}},[t._v("[ "+t._s(e.setValueField)+" ]")]):t._e()])}),0)])}),0),t.eventData.runAtInit?n("div",{staticClass:"event-card-init"},[n("span",{staticClass:"el-icon-s-flag"}),t._v(" 初始化时执行")]):t._e()])},br=[],yr={name:"event-card",components:{},props:{eventData:{type:Object},targetNameMap:{type:Object}},data:function(){return{eventInfo:cr,actionInfo:dr,operationNames:hr}},methods:{removeAction:function(t,e,n){var o=this;this.$confirm(n?"此事件下仅有此一个动作，将删除事件，是否继续？":"确认移除此此事件动作？").then(function(){o.$emit("remove-action",t,e)}).catch(function(){})},editEvent:function(){this.$emit("edit-event")},removeEvent:function(){var t=this;this.$confirm("确认移除此事件？").then(function(){t.$emit("remove-event")}).catch(function(){})}}},Cr=yr,wr=(n("b020"),Object(lt["a"])(Cr,vr,br,!1,null,null,null)),xr=wr.exports,_r={add:"add",edit:"edit"},Dr={name:"event",components:{EventConfig:gr,EventCard:xr},props:["controlData"],computed:{eventTypeList:function(){var t=this.controlData.type,e=window.FORM_DESIGN_CONFIG.controls[t].supportEvents;return ur.filter(function(t){return-1!=e.indexOf(t.type)})},eventList:function(){var t=this.controlData.events;if(t){var e=[];return Object.keys(t).forEach(function(n){e.push.apply(e,Object(Q["a"])(t[n]))}),e}return[]},targetNameMap:function(){var t=this.$store.getters.controlNameMap,e=this.$store.getters.allRows,n={};return e.forEach(function(t){n[t.id]=t.name||"".concat(t.namePrefix,"_").concat(t.autoIndex)}),Object(Z["a"])({},t,n)}},data:function(){return{dialogVisible:!1,configData:{editType:_r.add,eventType:"",evData:null,editingIndex:-1,editingType:""}}},methods:Object(Z["a"])({},Object(gt["b"])(["setControlProp"]),{addEvent:function(t){this.configData.eventType=t,this.configData.editType=_r.add,this.configData.evData=null,this.dialogVisible=!0},editEvent:function(t,e){this.configData.eventType=t,this.configData.editType=_r.edit,this.configData.evData=this.controlData.events[t][e],this.configData.editingIndex=e,this.configData.editingType=t,this.dialogVisible=!0},saveEvent:function(t,e){var n=this.controlData.events?Object(vt["d"])(this.controlData.events):{};if(this.configData.editType==_r.add)n[t]?n[t].push(e):n[t]=[e];else{var o=this.configData,i=o.editingType,a=o.editingIndex;i&&-1!=a?n[i][a]=e:console.error("修改事件发生错误！")}this.setControlProp({prop:"events",value:n,control:this.controlData}),this.dialogVisible=!1},saveEditEvent:function(){},cancel:function(){this.dialogVisible=!1},removeEvent:function(t,e){var n=this.controlData.events;JSON.stringify(n[t][e],0,2);var o=Object(vt["d"])(n);1==o[t].length?delete o[t]:o[t].splice(e,1),JSON.stringify(o,0,2),this.setControlProp({prop:"events",value:o,control:this.controlData})},removeEventAction:function(t,e,n,o){if(void 0===o)return console.error("无法删除，错误的动作索引："+o);var i=this.controlData.events;JSON.stringify(i[t][e].actions[o],0,2);var a=Object(vt["d"])(i),r=a[t][e];r.actions&&r.actions.length?(r.actions.splice(o,1),r.actions.length||(r=null,1==a[t].length?delete a[t]:a[t].splice(e,1)),JSON.stringify(a,0,2),this.setControlProp({prop:"events",value:a,control:this.controlData})):console.error("无法删除")}})},kr=Dr,Tr=(n("ec83"),Object(lt["a"])(kr,ar,rr,!1,null,null,null)),Sr=Tr.exports,Or={name:"config-control",components:{NameConfig:bo,EventComponent:Sr},props:["control"],computed:Object(Z["a"])({},Object(gt["c"])(["controlType2nameMap"]),{controlType:function(){var t=this.control.type;return this.controlType2nameMap[t]},controlConfig:function(){var t=this.control.type,e=window.FORM_DESIGN_CONFIG.controls[t];return e?Object(vt["d"])(e.configItems):(console.error("".concat(t," 类型控件的配置不存在，请检查！！！")),[])},supportEvent:function(){var t=this.control.type,e=window.FORM_DESIGN_CONFIG.controls[t].supportEvents;return e&&e.length},eventCount:function(){if(!this.supportEvent)return 0;var t=this.control.events;return t?Object.keys(t).map(function(e){return t[e].length}).reduce(function(t,e){return t+e},0):0}}),created:function(){this.$bus.$on("cntrolClick",this.labelTextAutoFocus),document.addEventListener("keyup",this.deleteShortcurKey)},beforeDestroy:function(){this.$bus.$off("cntrolClick"),document.removeEventListener("keyup",this.deleteShortcurKey)},data:function(){return{currentView:"attribute"}},methods:{deleteShortcurKey:function(t){46===t.which&&this.$store.state.selectedControlId&&this.removeControl()},removeControl:function(){this.$store.dispatch("deleteControl")},onNameChange:function(t){this.$store.dispatch("setControlProp",{value:t,prop:"name",control:this.control})},labelTextAutoFocus:function(){var t=this;this.$nextTick(function(){if("title"==t.control.type||"label"==t.control.type)try{t.$children[1].focus()}catch(e){console.error(e)}})},getControlValue:function(t,e){return/\./.test(e.associatedProp)?Object(vt["g"])(t,e.associatedProp):t[e.associatedProp]},change:function(t,e,n){this.$store.dispatch("setControlProp",{value:t,prop:e.associatedProp,control:this.control,group:n})},getExtends:function(t){return t?t+""===t?[("extend-"+t).toLowerCase()]:t.map(function(t){return("extend-"+t).toLowerCase()}):[]},handleExtendChange:function(t,e,n){this.$store.dispatch("setControlProp",{value:t,prop:e,control:this.control,group:n})},getControlComponent:function(t){var e=t.toLowerCase();return e in or?or[e]:ir}},watch:{"control.id":function(){this.currentView="attribute"}}},Er=Or,Ir=Object(lt["a"])(Er,uo,ho,!1,null,null,null),Lr=Ir.exports,Ar=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.rowId?n("div",{staticClass:"config-row"},[n("NameConfig",{attrs:{"component-data":t.row,type:t.rowType},on:{change:t.onNameChange,remove:t.removeRow}}),t._m(0)],1):t._e()},$r=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"config-control-tabcontent"},[n("div",{staticClass:"config-block"},[n("h3",{staticClass:"config-category"}),n("div",{staticClass:"form-item"},[n("label",{staticClass:"form-label"},[t._v("行")]),n("div",{staticClass:"form-control"})])])])}],jr={name:"config-row",props:["rowId"],components:{NameConfig:bo},computed:{row:function(){var t=this.rowId;return this.$store.getters.rowDataMap[t].row},rowType:function(){return this.row.namePrefix||this.row.name}},mounted:function(){document.addEventListener("keyup",this.deleteShortcurKey)},beforeDestroy:function(){document.removeEventListener("keyup",this.deleteShortcurKey)},methods:{deleteShortcurKey:function(t){46===t.which&&this.rowId&&this.removeRow()},onNameChange:function(t){this.$store.dispatch("setLayoutProp",{value:t,prop:"name"})},removeRow:function(){var t=this,e=this.isEmptyRow(this.row);return e?this.doRemoveRow():this.$confirm("此操作将移除此行，以及此行内的所有内容，是否确认？"," 删除提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.doRemoveRow()}).catch(function(){})},doRemoveRow:function(){var t=this.$store.getters.selectedLayoutData,e=t.index,n=t.layout,o=this.$store.getters.selectedRowParentCol;-1!=e&&n?this.$store.dispatch("deleteRow",{parentCol:o,row:n,index:e}):console.error("出现错误 无法删除")},isEmptyRow:function(t){var e=!0,n=!1,o=void 0;try{for(var i,a=t.cols[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var r=i.value;if(r.subs.length||r.controls.length)return!1}}catch(l){n=!0,o=l}finally{try{e||null==a.return||a.return()}finally{if(n)throw o}}return!0}}},Mr=jr,Rr=Object(lt["a"])(Mr,Ar,$r,!1,null,null,null),zr=Rr.exports,Pr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"form-shuttle-btns"},[n("el-tooltip",{attrs:{"open-delay":200,content:t.canUndo?"撤销":"无可撤销的操作"}},[n("el-button",{attrs:{size:"mini",type:"primary",icon:"form-icon-undo",disabled:!t.canUndo},on:{click:t.undo}})],1),n("el-tooltip",{attrs:{"open-delay":200,content:t.canRedo?"还原":"无可还原的操作"}},[n("el-button",{attrs:{size:"mini",type:"primary",icon:"form-icon-redo",disabled:!t.canRedo},on:{click:t.redo}})],1)],1)},Vr=[],Fr=null,Br=function(t){var e={};return t.forEach(function(t){e[t]=!0}),e}(["activeRightTab","updateLineTop","updateLineLeft","showHLine","hideHLine","showVLine","hideVLine","layoutDragStart","layoutDragEnd","controlDragStart","controlDragEnd","setJsCode","setCssCode"]),Nr=function(t){var e={};return t.forEach(function(t){e[t]=!0}),e}(["updateRowHeight","updateColWidth"]),Hr={name:"shuttle",data:function(){return{history:[],future:[]}},mounted:function(){document.addEventListener("keyup",this.initShortcutKey)},beforeDestroy:function(){document.removeEventListener("keyup",this.initShortcutKey)},computed:{canUndo:function(){return this.history.length},canRedo:function(){return this.future.length}},methods:{init:function(){window.shuttleManager=this,this.subscribeStore()},subscribeStore:function(){var t=this;Fr=JSON.stringify(this.$store.state);var e=function(e,n){var o=e.type;e.payload&&e.payload.shuttle&&t.storeState(o,Fr,e.payload.group),Fr=JSON.stringify(n)},n=Ve()(e,300,{leading:!0,trailing:!1});this.$store.subscribe(function(t,o){var i=t.type;Br[i]||(Nr[i]?n(t,o):e(t,o))})},addHistory:function(t){if(t.group){for(var e=-1,n=0,o=this.history.length;n<o;n++){if(this.history[n].group!=t.group)break;e=n}-1===e&&this.history.unshift(t)}else this.history.unshift(t);this.history.length>10&&(this.history.length=10)},addFuture:function(t){this.future.unshift(t),this.future.length>10&&(this.future.length=10)},storeState:function(t,e,n){var o={name:t,state:e,group:n};this.addHistory(o),this.future=[]},undo:function(){if(this.canUndo){var t={name:"undo",state:JSON.stringify(this.$store.state)};this.addFuture(t);var e=this.history.shift();this.shuttle(e.state),Fr=JSON.stringify(this.$store.state)}},redo:function(){if(this.canRedo){var t={name:"undo",state:JSON.stringify(this.$store.state)};this.addHistory(t);var e=this.future.shift();this.shuttle(e.state),Fr=JSON.stringify(this.$store.state)}},shuttle:function(t){var e=JSON.parse(t);e.helper.showVLine=!1,e.helper.showHLine=!1,e.helper.inControlDragging=!1,e.helper.inLayoutDragging=!1,this.$store.replaceState(e)},initShortcutKey:function(t){t.ctrlKey&&90==t.which?this.undo():t.ctrlKey&&89==t.which&&this.redo()}}},Wr=Hr,Gr=(n("aeeb"),Object(lt["a"])(Wr,Pr,Vr,!1,null,null,null)),Ur=Gr.exports,qr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"editor-wrap"},[n("div",{staticClass:"editor-toolbar"},[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.handleDialogClose("save")}}},[t._v("保存")]),n("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.handleDialogClose("cancel")}}},[t._v("取 消")]),n("el-tooltip",{attrs:{"open-delay":200,content:"格式化"}},[n("el-button",{attrs:{size:"mini",icon:"el-icon-s-grid"},on:{click:t.format}})],1),n("el-tooltip",{attrs:{"open-delay":200,content:"搜索替换"}},[n("el-button",{attrs:{size:"mini",icon:"el-icon-search"},on:{click:t.search}})],1)],1),n("div",{staticClass:"editor-main"},[n("div",{ref:"editorEl",staticClass:"editor-el",class:{"with-right":"javascript"==t.language}}),"javascript"==t.language?n("div",{staticClass:"editor-right"},[n("Accordion",{attrs:{title:"控件"}},[n("ul",{staticClass:"control-list"},t._l(t.controlList,function(e){return n("li",{key:e.id,on:{click:function(n){return t.addControl(e.id)}}},[t._v(t._s(e.name))])}),0)]),n("Accordion",{attrs:{title:"常用值"}},[n("ul",{staticClass:"control-list"},t._l(t.valueList,function(e){return n("li",{key:e.id,on:{click:function(n){return t.addValue(e.id)}}},[t._v(t._s(e.text))])}),0)])],1):t._e()])])},Jr=[],Xr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"accordion"},[n("div",{staticClass:"accordion-header"},[n("span",{staticClass:"accordion-title"},[t._v(t._s(t.title))]),n("span",{staticClass:"accordion-toggle el-icon-arrow-down",class:{collaspe:t.collaspe},on:{click:function(e){t.collaspe=!t.collaspe}}})]),n("transition",{on:{"before-enter":t.beforeEnter,enter:t.enter,"after-enter":t.afterEnter,"before-leave":t.beforeLeave,leave:t.leave,"after-leave":t.afterLeave}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!t.collaspe,expression:"!collaspe"}],ref:"body",staticClass:"accordion-body",class:{collaspe:t.collaspe}},[t._t("default")],2)])],1)},Yr=[],Kr={name:"accordion",props:{title:{type:String,required:!0}},data:function(){return{collaspe:!1,inGroup:!1}},mounted:function(){"accordion-group"==this.$parent.$options.name&&(this.inGroup=!0)},methods:{beforeEnter:function(t){t.classList.add("collapse-transition"),t.dataset||(t.dataset={}),t.dataset.oldPaddingTop=t.style.paddingTop,t.dataset.oldPaddingBottom=t.style.paddingBottom,t.style.height="0",t.style.paddingTop=0,t.style.paddingBottom=0,t.style.opacity=0},enter:function(t){t.dataset.oldOverflow=t.style.overflow,0!==t.scrollHeight?(t.style.height=t.scrollHeight+"px",t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom):(t.style.height="",t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom),t.style.opacity=1,t.style.overflow="hidden"},afterEnter:function(t){t.classList.remove("collapse-transition"),t.style.height="",t.style.overflow=t.dataset.oldOverflow,t.style.opacity=""},beforeLeave:function(t){t.dataset||(t.dataset={}),t.dataset.oldPaddingTop=t.style.paddingTop,t.dataset.oldPaddingBottom=t.style.paddingBottom,t.dataset.oldOverflow=t.style.overflow,t.style.height=t.scrollHeight+"px",t.style.overflow="hidden",t.style.opacity=1},leave:function(t){0!==t.scrollHeight&&t.classList.add("collapse-transition"),t.style.height=0,t.style.paddingTop=0,t.style.paddingBottom=0,t.style.opacity=0},afterLeave:function(t){t.style.height="",t.style.overflow=t.dataset.oldOverflow,t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom,t.style.opacity=""},setCollaspe:function(t){this.collaspe=void 0!==t?!!t:!this.collaspe}},watch:{collaspe:function(t){this.inGroup&&this.$parent.updateStatus(t,this),this.$emit("change",t)}}},Qr=Kr,Zr=(n("5443"),Object(lt["a"])(Qr,Xr,Yr,!1,null,null,null)),tl=Zr.exports,el="./monaco-editor/vs";function nl(){if(window.__MONACO_PROMISE__)return window.__MONACO_PROMISE__;var t="\n    require.config({\n      paths: {\n        'vs': '".concat(el,"'\n      }\n    });\n    require.config({\n      'vs/nls' : {\n        availableLanguages: {\n          '*': 'zh-cn'\n        }\n      }\n    });\n    require(['vs/editor/editor.main'], function () {\n      window.__monaco_editor__ = monaco;\n    });\n  "),e=new Promise(function(t,e){var n=document.createElement("script");n.id="monaco-editor-loader",n.src=el+"/loader.js",n.onload=function(){n.onload=null,t("loader")},n.onerror=function(){n.onerror=null,e("monaco-editor资源加载失败")},document.body.appendChild(n)}).then(function(){return new Promise(function(e,n){var o=document.createElement("script");o.text=t,o.onerror=function(){o.onerror=null,n("monaco-editor资源加载失败")},document.body.appendChild(o),e("editor")})}).then(function(){return new Promise(function(t,e){var n,o=0;function i(){window.__monaco_editor__?(clearTimeout(n),t(window.__monaco_editor__)):o++<1e3?setTimeout(i,30):e("monaco-editor资源加载失败")}i()})});return window.__MONACO_PROMISE__=e}function ol(t,e,n){var o;return e=e||17,function(){var i=arguments,a=n||this;clearTimeout(o),o=setTimeout(function(){t.apply(a,i)},e)}}var il={name:"Editor",components:{Accordion:tl},props:{language:{type:String,default:"javascript",validator:function(t){return-1!==["javascript","css"].indexOf(t)}},code:{type:String,default:["function x() {",'    console.log("Hello world!");',"}",""].join("\n")}},data:function(){var t={defaultCode:{javascript:["function myScriptFn() {","\t/* todo something */\n\t","}",""].join("\n"),css:"/* 在下面加入您的 css  */ \n"},editor:null};return t.codeText=this.code||t.defaultCode[this.language],t},computed:{valueList:function(){return Object(vt["d"])(window.FORM_DESIGN_CONFIG.preset["epointsform.specificValues"])},controlList:function(){var t=this.$store.state.hiddenControls,e=this.$store.getters.allControls,n=[];return t.forEach(function(t){n.push({id:t.id,name:t.name||t.namePrefix+"_"+t.autoIndex})}),e.forEach(function(t){n.push({id:t.id,name:t.name||t.namePrefix+"_"+t.autoIndex})}),n}},mounted:function(){var t=this;"javascript"!=this.language?this.initEditor(this.codeText):this.loadTypes().then(function(){t.initEditor(t.codeText)})},beforeDestroy:function(){window.removeEventListener("resize",this.adaptLayout),this.editor&&this.editor.dispose()},methods:{handleDialogClose:function(t){this.$emit(t,this.editor.getValue())},_adaptLayout:function(){this.editor&&this.editor.layout()},search:function(){this.editor._actions["actions.find"].run()},format:function(){this.editor._actions["editor.action.formatDocument"].run()},addControl:function(t){var e="mini.get('".concat(t,"').");this.insertText(e),this.editor._actions["editor.action.triggerSuggest"].run()},addValue:function(t){this.insertText(t)},insertText:function(t){var e=this.editor.getPosition();this.editor.executeEdits("",[{range:{startLineNumber:e.lineNumber,startColumn:e.column,endLineNumber:e.lineNumber,endColumn:e.column},text:t}]);var n=this.editor.getSelection();n.selectionStartColumn=n.startColumn=n.endColumn,n.selectionStartLineNumber=n.startLineNumber=n.endLineNumber,this.editor.setSelection(n),this.editor.focus()},initEditor:function(t){var e=this;this.adaptLayout=ol(this._adaptLayout,200),window.addEventListener("resize",this.adaptLayout),nl().then(function(n){window.__meditor=e.editor=n.editor.create(e.$refs.editorEl,{value:t||"",language:e.language,lineHeight:26,autoIndent:!0,formatOnPaste:!0,lineNumbers:"on",minimap:!0,tabCompletion:"on",quickSuggestions:{comments:!0},snippetSuggestions:"top",accessibilitySupport:"on",suggest:{}}),e.editor.focus()})},loadTypes:function(){var t=this,e={"content-type":"text/plain; charset=UTF-8"};return nl().then(function(n){return t.$httpGet("./types/mini-snippets.json",!0,e).then(function(t){var e=JSON.parse(t);e.forEach(function(t){t.kind=n.languages.CompletionItemKind.Function,t.detail=t.documentation}),n.languages.registerCompletionItemProvider("javascript",{provideCompletionItems:function(){return{suggestions:e}}})}).then(function(){t.$httpGet("./types/jquery.d.ts",!0,e).then(function(t){n.languages.typescript.javascriptDefaults.addExtraLib(t,"jquery.d.ts")}),t.$httpGet("./types/miniui.d.ts",!0,e).then(function(t){n.languages.typescript.javascriptDefaults.addExtraLib(t,"miniui.d.ts")}),t.$httpGet("./types/epoint.d.ts",!0,e).then(function(t){n.languages.typescript.javascriptDefaults.addExtraLib(t,"epoint.d.ts")})})})}}},al=il,rl=(n("58d3"),Object(lt["a"])(al,qr,Jr,!1,null,null,null)),ll=rl.exports,sl=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"row-container"},[t._l(t.list,function(e,o){return n("div",{key:e.id,staticClass:"row",class:{isTop:0==t.level,first:0===o,mid:0!=o},style:"min-height:"+e.height+"px",attrs:{id:e.id,"row-id":e.id}},t._l(e.cols,function(o,i){return n("div",{key:o.id,staticClass:"col",class:t.getColCls(o,i,e.cols.length),style:t.rowColWidthMap[e.id][i],attrs:{id:o.id,name:o.name}},[o.subs&&o.subs.length?n("RowGender",{attrs:{list:o.subs,level:t.levelNext}}):t._e(),t._l(o.controls,function(e){return n(t.getControl(e.type),{key:e.id,tag:"component",attrs:{id:e.id,"control-data":e,asControl:!0}})})],2)}),0)}),0===t.level?n("div",{staticClass:"hidden-area",staticStyle:{display:"none"}},t._l(t.hiddenControls,function(e){return n(t.getControl(e.type),{key:e.id,tag:"component",attrs:{id:e.id,"control-data":e,asControl:!0}})}),1):t._e()],2)},cl=[],dl={label:Nt,title:te},ul={inheritAttrs:!1,props:["id"],template:'<span class="design-control-holder" :id="id"></span>'},hl={name:"RowGender",props:{list:{type:Array,default:function(){return[]}},level:{type:Number,default:0},globalStyle:{type:Object,default:function(){return{}}}},data:function(){return{}},created:function(){var t;(t=console).log.apply(t,arguments)},computed:{hiddenControls:function(){return this.$store.state.hiddenControls},levelNext:function(){return this.level+1},rowColWidthMap:function(){var t={};return this.list.forEach(function(e){t[e.id]=[],e.cols.forEach(function(n){var o=n.style.width;t[e.id].push({width:"".concat(o,"px"),minHeight:"".concat(e.height,"px")})})}),t}},methods:{getColCls:function(t,e,n){var o,i=this.globalStyle,a=t.subs.length,r=t.style,l=(o={isSub:!a,hasSub:a,first:0===e,mid:e&&e!==n-1,last:e===n-1},Object(He["a"])(o,"text-"+(r.textAlign||i.textAlign),!0),Object(He["a"])(o,"vertical-"+(r.verticalAlign||i.verticalAlign),!0),o);return l},getHtmlContent:function(){return this.$el.innerHTML},getControl:function(t){return t in dl?dl[t]:ul}}},fl=hl,pl=Object(lt["a"])(fl,sl,cl,!1,null,null,null),ml=pl.exports,gl=n("4be7"),vl=n("9827"),bl="0.1.7",yl="".concat(location.pathname,"-formdesign-V").concat(bl),Cl=new URLSearchParams(location.search),wl=Cl.get("designId")||"",xl=Cl.get("tableGuid")||"",_l={name:"app-main",components:{Tabs:ft,TabPanel:ct,PanelLayout:_t,Design:ln,ConfigCell:Wn,ConfigForm:co,PanelControl:It,ConfigControl:Lr,ConfigRow:zr,RowGender:ml,Shuttle:Ur,Accordion:tl,Editor:ll},data:function(){return{dataLoaded:!1,formTitle:"表单设计器",viewType:"real",needRender:!1,showLocalBtns:/useMock/i.test(location.search),editorDialog:{title:"",show:!1,code:"",display:!1,lang:""},enableRightbarCover:!0,narrowMode:!1,rightbarHidden:!1}},computed:Object(Z["a"])({},Object(gt["e"])(["leftActiveTab","rightActiveTab","formSize","selectedColId","hiddenControls","selectedRowId","jsCode","cssCode"]),Object(gt["c"])(["codeListMap","selectedCol"]),{selectedControl:function(){var t=this.$store.state.selectedControlId;if(t){var e=this.$store.getters.controlDataMap[t];if(e&&e.control)return e.control}return null},globalStyle:{get:function(){return this.$store.state.globalStyle},set:function(t){this.$store.commit("updateGlobalStyle",t)}},design:{get:function(){return this.$store.state.design},set:function(t){this.$store.commit("updateDesign",t)}}}),mounted:function(){var t=this;this.enableRightbarCover&&(this.calcWidth(),window.addEventListener("resize",this.calcWidth)),gl["Promise"].all([this.$httpPost(window.formDesignerActions.getUrl,{designId:wl,tableGuid:xl}),this.$httpPost(window.formDesignerActions.getCodeItemUrl,{designId:wl,tableGuid:xl})]).then(function(e){var n=e[0],o=e[1].codeMain,i=n.extControls,a=n.fieldList,r=n.designData,l=n.macroTypes,s=n.sourceTables,c=n.dataTables;a&&a.length&&(a.forEach(function(t){t.fields.forEach(function(t){t.required=1==parseInt(t.required,10),t.fieldtype=parseInt(t.fieldtype,10)})}),t.setFieldList(a)),n.name&&(t.formTitle=n.name),o&&o.length&&t.setCodeList(o),l&&l.length&&t.setMacroTypes(l),i&&i.length&&t.setExtControls(i),s&&s.length&&t.setSourceTables(s),c&&c.length&&t.setDataTables(c),n.jsCode&&t.setJsCode(Object(vt["e"])(n.jsCode)),n.cssCode&&t.setCssCode(Object(vt["e"])(n.cssCode)),r&&(r.globalStyle&&(t.globalStyle=r.globalStyle),r.design&&(t.design=r.design),r.hiddenControls&&t.$store.commit("setHiddenControls",r.hiddenControls),vl["c"].control.adapt(t.$store.getters.allControls),vl["c"].control.adapt(t.$store.state.hiddenControls),vl["c"].col.adapt(t.design),vt["l"].adapt(t.$store.getters.allRows,function(t){return t.id}),t.dataLoaded=!0,t.$nextTick(function(){t.$refs.shuttle.init()}))}).catch(function(t){console.error(t)}),this.$httpPost(window.formDesignerActions.getListInfoUrl,{designId:wl,tableGuid:xl}).then(function(e){var n=e.SformListInfo;Array.isArray(n)&&t.$store.commit("setButtonEditPopupList",n)}).catch(function(t){console.error(t)})},methods:Object(Z["a"])({},Object(gt["d"])(["activeLeftTab","setFieldList","setCodeList","setMacroTypes","setExtControls","setSourceTables","setDataTables","setJsCode","setCssCode"]),Object(gt["b"])(["activeRightTab"]),{calcWidth:Ve()(function(){this.narrowMode=window.innerWidth<1610},20,{leading:!0,trailing:!0}),openEditor:function(t){var e,n,o;"js"==t?(e=this.jsCode,n="js编辑",o="javascript"):(e=this.cssCode,n="css编辑",o="css"),this.editorDialog.title=n,this.editorDialog.code=e,this.editorDialog.lang=o,this.editorDialog.show=!0},onEditorDialogOpened:function(){this.editorDialog.display=!0},saveEditorCode:function(t){"javascript"==this.editorDialog.lang?this.setJsCode(t):"css"==this.editorDialog.lang&&this.setCssCode(t),this._closeEditorDialog()},_closeEditorDialog:function(){this.editorDialog.display=this.editorDialog.show=!1},closeEditorDialog:function(){var t=this;this.$confirm("不需要保存此次的代码修改吗？","保存提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t._closeEditorDialog()}).catch(function(t){console.error(t)})},viewTypeChange:function(t){this.viewType=t.target.value},getLocalData:function(){var t=localStorage.getItem(yl)||window.__designData;t&&(this.design=JSON.parse(t),vl["c"].control.adapt(this.$store.getters.allControls),vl["c"].col.adapt(t))},save:function(){localStorage.setItem(yl,JSON.stringify(this.design))},clear:function(){this.design=[]},preview:function(){var t=this;return this.getData().then(function(e){var n=e.build,o='\n      <!DOCTYPE html>\n      <html lang="en">\n      <head>\n          <meta charset="UTF-8">\n          <meta name="viewport" content="width=device-width, initial-scale=1.0">\n          <meta http-equiv="X-UA-Compatible" content="ie=edge">\n          <title>Document</title>\n          <style>html,body{margin:0;padding:0;}.container{margin:0 auto;}</style>\n          <style>.row{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap}.col{position:relative;-webkit-box-sizing:border-box;box-sizing:border-box;box-sizing:border-box;min-height:30px;padding:6px;line-height:30px;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0}.col.hasSub{padding:0}.col>*{position:relative;z-index:1}.col:after{position:absolute;z-index:0;top:0;right:0;bottom:0;left:0;display:block;-webkit-box-sizing:border-box;box-sizing:border-box;content:"";background:transparent}.col.hasSub:after{border-top-width:0!important;border-right-width:0!important;border-bottom-width:0!important;border-left-width:0!important}.col.mid:after{border-left-width:0!important}.col.mid>.row>.col.first:after,.col.mid>.row-container>.row>.col.first:after,.col.last>.row>.col.first:after,.col.last>.row-container>.row>.col.first:after{border-left-width:0!important}.col.mid ~ .col.last:after,.col.first ~ .col.last:after{border-left-width:0!important}.row.mid>.col:after{border-top-width:0!important}.row.mid>.col>.row>.col:after,.row.mid>.col>.dropArea>.row>.col:after{border-top-width:0!important}.col.text-left{text-align:left}.col.text-center{text-align:center}.col.text-right{text-align:right}.col.vertical-top{vertical-align:top}.col.vertical-middle{vertical-align:middle}.col.vertical-bottom{vertical-align:bottom}.col.vertical-top{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start}.col.vertical-middle{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center}.col.vertical-bottom{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end}.design-form-title,.design-form-label{position:relative;display:block;-webkit-box-sizing:border-box;box-sizing:border-box;width:100%}.design-form-label{padding-right:8px}.design-form-label.required:after{position:absolute;top:50%;right:-2px;display:block;width:8px;height:16px;margin-top:-8px;font-size:16px;line-height:16px;content:"*";color:red}.mini-textbox-readOnly .mini-textbox-border,.mini-textbox-readOnly .mini-textbox-input,.mini-buttonedit-readOnly .mini-buttonedit-border,.mini-buttonedit-readOnly .mini-buttonedit-input,.mini-readonly .mini-textboxlist-border{cursor:default;border:0;background:0}.mini-buttonedit-readOnly .mini-buttonedit-button,.mini-readonly .mini-textboxlist-close{display:none}.mini-readonly .mini-textboxlist-item{padding-right:8px}</style>\n          <style>'.concat(n.style,'</style>\n      </head>\n      <body>\n          <div class="container" style="width:').concat(t.formSize.width,'px;">').concat(n.html,"</div>\n      </body>\n      </html>\n      "),i=new Blob([o],{type:"text/html"}),a=document.createElement("a");a.download="测试表单设计器生成布局",a.href=URL.createObjectURL(i),document.body.appendChild(a),a.click(),document.body.removeChild(a)})},getData:function(){var t=this;return this.getHtml().then(function(e,n){if(n)return console.error(n);t.$store.dispatch("dealSubmitControl");var o=Object(vt["d"])(t.hiddenControls),i=Object(vt["d"])(t.$store.getters.allControls);i.push.apply(i,Object(Q["a"])(o));var a={designData:{globalStyle:Object(vt["d"])(t.globalStyle),hiddenControls:o,design:Object(vt["d"])(t.design)},build:{html:e,style:t.getStyle()},controls:i,jsCode:Object(vt["f"])(t.jsCode),cssCode:Object(vt["f"])(t.cssCode)};return a})},saveToServer:function(){var t=this;return this.getData().then(function(e){return e.build.html&&(e.build.html=Object(vt["h"])(e.build.html)),t.$httpPost(window.formDesignerActions.saveUrl,Oo()({designId:wl,tableGuid:xl},e)).then(function(e){var n=e;1==parseInt(n.msg,10)&&t.$message({message:"保存成功",type:"success",showClose:!0})})})},getStyle:function(){return this.$store.getters.colStyleText},getHtml:function(){var t=this;return this.needRender=!0,new gl["Promise"](function(e,n){var o=setTimeout(function(){n({msg:"渲染超时！！！"})},3e3);t.$nextTick(function(){try{var i=t.$refs.builder.getHtmlContent();e(i),clearTimeout(o),t.needRender=!1}catch(a){n(a)}})}).catch(function(e){t.needRender=!1,console.error(e)})}}),beforeDestroy:function(){this.enableRightbarCover&&window.removeEventListener("resize",this.calcWidth)},watch:{design:{deep:!1,handler:function(t){JSON.stringify(t)!=JSON.stringify(this.design)&&this.$store.commit("updateDesign",t)}}}},Dl=_l,kl=(n("bec5"),n("3176"),Object(lt["a"])(Dl,Y,K,!1,null,null,null)),Tl=kl.exports,Sl={name:"app",components:{Main:Tl},data:function(){return{height:window.innerHeight}},mounted:function(){window.addEventListener("resize",this.handelResize)},methods:{handelResize:function(){var t=this;clearTimeout(this._resizeTimer),this._resizeTimer=setTimeout(function(){t.height=window.innerHeight},200)}},beforeDestroy:function(){window.removeEventListener("resize",this.handelResize)}},Ol=Sl,El=(n("034f"),Object(lt["a"])(Ol,J,X,!1,null,null,null)),Il=El.exports,Ll=n("9aba"),Al=n.n(Ll),$l={getters:{rowDataMap:function(t){var e={};function n(t,o){e[t.id]&&console.warn("行id出现重复！！！",e[t.id],t),e[t.id]={row:t,index:o},t.cols&&t.cols.forEach(function(t){t.subs&&t.subs.forEach(n)})}return t.design.forEach(n),e},allRows:function(t,e){var n=e.rowDataMap,o=[];for(var i in n)n.hasOwnProperty(i)&&o.push(n[i].row);return o},subRowPathMap:function(t,e){var n={};function o(t){n[t.id]||(n[t.id]=[]),t.cols&&t.cols.forEach(function(e){e.subs&&(e.subs.forEach(function(e){n[e.id]=[t].concat(n[t.id])}),e.subs.forEach(o))})}for(var i in t.design.forEach(o),n)if(n.hasOwnProperty(i)){if(!n[i]||!n[i].length){delete n[i];continue}e.rowDataMap[i].row.name,document.querySelector('[row-id="'+e.rowDataMap[i].row.id+'"]'),n[i].forEach(function(t){document.querySelector('[row-id="'+t.id+'"]')})}return n},selectedRowParentCol:function(t,e){var n=t.selectedRowId;if(!n)return null;var o=e.subRowPathMap[n];if(o&&o.length){var i=!0,a=!1,r=void 0;try{for(var l,s=o[0].cols[Symbol.iterator]();!(i=(l=s.next()).done);i=!0){var c=l.value;if(c.subs&&c.subs.length){var d=!0,u=!1,h=void 0;try{for(var f,p=c.subs[Symbol.iterator]();!(d=(f=p.next()).done);d=!0){var m=f.value;if(m.id==n)return c}}catch(g){u=!0,h=g}finally{try{d||null==p.return||p.return()}finally{if(u)throw h}}}}}catch(g){a=!0,r=g}finally{try{i||null==s.return||s.return()}finally{if(a)throw r}}}return null},selectedLayoutData:function(t,e){var n=t.selectedRowId;if(!n)return{layout:null,index:-1};var o=e.rowDataMap[n];return{layout:o.row,index:o.index}}},mutations:{updateSelectedLayout:function(t,e){var n=e.id;t.selectedRowId=n},removeRow:function(t,e){var n=e.parentCol,o=e.index;n?n.subs?n.subs.splice(o,1):console.error("删除时找不到上级！！！"):t.design.splice(o,1)},updateRowHeight:function(t,e){var n=e.row,o=e.height,i=o-n.height;function a(t,e){t.cols&&t.cols.forEach(function(t){var n=t.subs;if(n&&n.length){var o=n[n.length-1],i=n.reduce(function(t,e){return t+e.height},0),r=e-i;if(r>0)o.height+=r;else{var l=o.height+r;o.height=l<30?30:l}a(o,o.height)}})}function r(t,e){if(t&&t.length){var n=t[0];n.height+=e,a(n,n.height),r(t.slice(1),e)}}n.height=o,a(n,o),!1!==e.bubble&&r(e.parentRowPath,i)},replaceToMulti:function(t,e){var n,o=e.row,i=e.rowIndex,a=e.rowCount,r=e.colCount,l=s(o,a,r);function s(t,e,n){var i=Object(vt["d"])(t),a=o.cols[0];i.cols=[],i.asMulti=!1,delete i.asMulti,a.style.width=a.style.width/n;var r=Object(Q["a"])(new Array(e)).map(function(){var t=Object(vt["l"])(),e=Object(vt["d"])(i);return e.id=t,e.autoIndex=vt["j"].getIndex(e.namePrefix||e.name),e.cols=Object(Q["a"])(new Array(n)).map(function(){var e=vt["b"].getIndex(t),n=Object(vt["d"])(a);return n.id="col-".concat(t,"-").concat(e),n.name="col-".concat(e),n}),e});return r}(n=t.design).splice.apply(n,[i,1].concat(Object(Q["a"])(l)))},copyRow:function(t,e){var n=e.aimIndex,o=e.newRow,i=e.parentCol||t.design;i.splice(n,0,o)},updateLayoutProp:function(t,e){var n=e.prop,o=e.value,i=e.layout;i?i[n]=o:console.error("组件件不存在")},updateAllRowHeight:function(t,e){var n=e.rows,o=e.height;Array.isArray(n)&&n.forEach(function(t){t.height=o})}},actions:{setAllRowHeight:function(t,e){var n=e.height,o=t.state.design.filter(function(t){var e=!0,n=!1,o=void 0;try{for(var i,a=t.cols[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var r=i.value;if(r.subs&&r.subs.length)return!1}}catch(l){n=!0,o=l}finally{try{e||null==a.return||a.return()}finally{if(n)throw o}}return!0}),i="allRowHeight"+ +new Date;t.commit("updateGlobalStyleProp",{prop:"cellHeight",value:n,shuttle:!0,group:i}),o.length&&t.commit("updateAllRowHeight",{rows:o,height:n,shuttle:!0,group:i})},setSelectedLayout:function(t,e){t.commit("updateSelectedLayout",e),t.commit({type:"setSelectedCol",selectedColId:""}),t.commit("clearSelectedControl")},setLayoutProp:function(t,e){var n=e.layout,o=e.prop,i=e.value;n||(n=t.getters.selectedLayoutData.layout),t.commit("updateLayoutProp",{layout:n,prop:o,value:i})},deleteRow:function(t,e){void 0===e.shuttle&&(e.shuttle=!0),e.row==t.getters.selectedLayoutData.layout&&t.commit("updateSelectedLayout",{id:""}),t.commit("removeRow",e)}}},jl=(n("4917"),n("9865"),{getters:{allCol:function(t,e){var n,o=[],i=e.rowDataMap;for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n=i[a].row,n.cols.forEach(function(t){o.push(t)}));return o},colStyleText:function(t,e){var n=e.allCol,o=[];return n.forEach(function(t){var e=t.style.border,n=["#".concat(t.id,":after{"),"border-top: ".concat(e.top.width,"px ").concat(e.top.style," ").concat(e.top.color,";"),"border-right: ".concat(e.right.width,"px ").concat(e.right.style," ").concat(e.right.color,";"),"border-bottom: ".concat(e.bottom.width,"px ").concat(e.bottom.style," ").concat(e.bottom.color,";"),"border-left: ".concat(e.left.width,"px ").concat(e.left.style," ").concat(e.left.color,";}")].join("");o.push(n)}),o.join("")},selectedCol:function(t,e){var n=t.selectedColId;if(!n)return null;var o=n.replace(/^col-(\w+)-\d{1,2}$/,"$1"),i=e.rowDataMap[o];if(!i)return null;var a=!0,r=!1,l=void 0;try{for(var s,c=i.row.cols[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var d=s.value;if(d.id==n)return d}}catch(u){r=!0,l=u}finally{try{a||null==c.return||c.return()}finally{if(r)throw l}}return null}},mutations:{setSelectedCol:function(t,e){t.selectedColId=e.id},removeCol:function(t,e){var n=e.col,o=e.parentRow,i=e.colIndex;if(o.cols&&1!=o.cols.length){var a=o.cols[i-1];if(a)a.style.width+=n.style.width;else{var r=o.cols[i+1];r&&(r.style.width+=n.style.width)}o.cols.splice(i,1)}},splitCol:function(t,e){var n=e.col,o=e.colIndex,i=e.parentRow,a=e.direction,r=void 0===a?"right":a;if(!i)return e.shuttle=!1,void console.error("未指定所在行！！");var l=Object(vt["d"])(n);h(i,l);var s=n.style.width,c=s/2>>0,d=s-c;n.style.width=c,l.style.width=d,l.style.border=Object(vt["d"])(n.style.border),l.controls=[];var u="left"==r?o:o+1;function h(t,e){var n=t.id,o=Math.max.apply(Math,Object(Q["a"])(t.cols.map(function(t){return parseInt(t.id.substr(t.id.lastIndexOf("-")+1),10)})));e.id="col-".concat(n,"-").concat(o+1),e.name="col-".concat(o+1)}i.cols.splice(u,0,l)},updateColAllBorder:function(t,e){var n=e.directions,o=e.prop,i=e.value;n.forEach(function(t){t&&(t[o]=i)})},setColBorder:function(t,e){var n=e.border,o=e.selectedCol;JSON.stringify(e),o.style.border=Object(vt["d"])(n)},setColStyle:function(t,e){JSON.stringify(e);var n=e.prop,o=e.value,i=e.selectedCol;i.style[n]=o},setAllColBorderWidth:function(t,e){var n=e.cols,o=e.borderWidth;Ml(n,o)},setAllColBorder_inner:function(t,e){var n=e.cols,o=e.borderWidth;Ml(n,o),Rl(t.design[0],0),zl(t.design[t.design.length-1],0),Pl(t.design,0),Vl(t.design,0)},setAllColBorder_hline:function(t,e){var n=e.cols,o=e.borderWidth;n.forEach(function(t){t.style.border.left.width=0,t.style.border.right.width=0,t.style.border.top.width=o,t.style.border.bottom.width=o})},setAllColBorder_vline:function(t,e){var n=e.cols,o=e.borderWidth;n.forEach(function(t){t.style.border.left.width=o,t.style.border.right.width=o,t.style.border.top.width=0,t.style.border.bottom.width=0})},setAllColBorder_outer:function(t,e){var n=e.cols,o=e.borderWidth;Ml(n,0),Rl(t.design[0],o),zl(t.design[t.design.length-1],o),Pl(t.design,o),Vl(t.design,o)},setAllColBorder_left:function(t,e){var n=e.cols,o=e.borderWidth;Ml(n,0),Pl(t.design,o)},setAllColBorder_top:function(t,e){var n=e.cols,o=e.borderWidth;Ml(n,0),Rl(t.design[0],o)},setAllColBorder_right:function(t,e){var n=e.cols,o=e.borderWidth;Ml(n,0),Vl(t.design,o)},setAllColBorder_bottom:function(t,e){var n=e.cols,o=e.borderWidth;Ml(n,0);var i=t.design.length;if(i){var a=t.design[i-1];zl(a,o)}},updateColWidth:function(t,e){var n=e.col,o=e.width,i=e.nextCol,a=o-n.style.width;function r(t,e,n){t.subs.forEach(function(t){var o=t.cols;if(o&&o.length){var i=o["right"==n?0:o.length-1];i.style.width+=e,r(i,e,n)}})}i&&i.style&&(i.style.width-=a,i.subs&&r(i,-a,"right")),n.style.width=o,n.subs&&r(n,a,"left")},updateRowColWidth:function(t,e){var n=e.row,o=e.ratio;function i(t){t.cols.forEach(function(t){t.style.width*=o,t.subs&&t.subs.length&&t.subs.forEach(i)})}i(n)}},actions:{setSelectedCol:function(t,e){t.commit("setSelectedCol",e),t.commit("updateSelectedLayout",{id:"",shuttle:!1}),t.commit("clearSelectedControl")},removeCol:function(t,e){var n=e.col;n.id==t.state.selectedColId&&t.commit("setSelectedCol",{id:"",shuttle:!1}),t.commit("removeCol",e)},setColAllBorder:function(t,e){var n,o,i=e.prop,a=e.value,r=t.getters.selectedCol,l=r.style.border.right,s=r.style.border.bottom,c=t.state.selectedColId.match(/col-(\w+)-\d/);if(!c)return console.error("单元格不存在！！！");var d=c[1];if(!d)return console.error("无法匹配目标行");var u=t.getters.rowDataMap[d].row,h=t.getters.rowDataMap[d].index,f=u.cols.indexOf(r);if(-1===f)return console.error("单元格不存在！！！");if(n=0===f?r.style.border.left:u.cols[f-1].style.border.right,0==h)o=r.style.border.top;else{var p,m=t.getters.subRowPathMap[d];p=m&&m.length?m[0].cols[h-1]:t.state.design[h-1],o=p.cols[f]?p.cols[f].style.border.bottom:null}t.commit("updateColAllBorder",{directions:[o,l,s,n],prop:i,value:a,shuttle:!0})}}});function Ml(t,e){t.forEach(function(t){t.style.border.top.width=e,t.style.border.right.width=e,t.style.border.bottom.width=e,t.style.border.left.width=e})}function Rl(t,e){t&&t.cols.forEach(function(t){t.style.border.top.width=e;var n=t.subs[0];Rl(n)})}function zl(t,e){t&&t.cols.forEach(function(t){t.style.border.bottom.width=e;var n=t.subs.length;n&&zl(t.subs[n-1],e)})}function Pl(t,e){Array.isArray(t)&&t.length&&t.forEach(function(t){var n=t.cols[0];n&&(n.style.border.left.width=e,Pl(n.subs,e))})}function Vl(t,e){Array.isArray(t)&&t.length&&t.forEach(function(t){var n=t.cols[t.cols.length-1];n&&(n.style.border.right.width=e,Vl(n.subs,e))})}n("d92a");var Fl={getters:{controlType2nameMap:function(t){var e=window.FORM_DESIGN_CONFIG.controlList,n=t.extControls,o={};return e.concat(n).forEach(function(t){o[t.type]=t.name}),o},fieldMap:function(t){var e={};return t.fieldList.forEach(function(t){t.fields.forEach(function(n){e[t.id+";"+n.field]=n})}),e},codeListMap:function(t){var e=t.codeList,n={};return e.forEach(function(t){n[t.id]=t}),n},selectedFieldMap:function(t,e){var n=e.allControls;if(!n.length)return{};var o={};return n.forEach(function(t){t.bind&&(o[t.bind]=!0)}),o},allControls:function(t,e){var n=e.allCol;if(!n||!n.length)return[];var o=[];return n.forEach(function(t){t.controls&&t.controls.length&&o.push.apply(o,Object(Q["a"])(t.controls))}),o},controlNameMap:function(t,e){var n=t.hiddenControls,o=e.allControls,i={};return n.forEach(function(t){i[t.id]=t.name||"".concat(t.namePrefix,"_").concat(t.autoIndex)}),o.forEach(function(t){i[t.id]=t.name||"".concat(t.namePrefix,"_").concat(t.autoIndex)}),i},controlDataMap:function(t,e){var n=t.hiddenControls,o=e.allCol,i={};return n.forEach(function(t,e){i[t.id]={control:t,index:e}}),o.forEach(function(t){t.controls&&t.controls.length&&t.controls.forEach(function(t,e){i[t.id]={control:t,index:e}})}),i},selectedControl:function(t,e){var n=t.selectedControlId,o=e.controlDataMap;if(!n)return{control:null,index:-1};var i=o[n];return i&&i.control?i:{control:null,index:-1}},selectedControlParentCol:function(t,e){var n=t.selectedControlId,o=e.allCol,i=!0,a=!1,r=void 0;try{for(var l,s=o[Symbol.iterator]();!(i=(l=s.next()).done);i=!0){var c=l.value;if(c.controls){var d=!0,u=!1,h=void 0;try{for(var f,p=c.controls[Symbol.iterator]();!(d=(f=p.next()).done);d=!0){var m=f.value;if(m.id==n)return c}}catch(g){u=!0,h=g}finally{try{d||null==p.return||p.return()}finally{if(u)throw h}}}}}catch(g){a=!0,r=g}finally{try{i||null==s.return||s.return()}finally{if(a)throw r}}return null},selectedControlParentColInfo:function(t,e){var n=e.selectedControlParentCol,o=e.rowDataMap,i={row:null,index:-1};if(!n)return i;var a=n.id,r=a.replace(/^col-(\w+)-\d{1,2}$/,"$1"),l=o[r];return l?{row:l.row,index:l.row.cols.indexOf(n)}:i}},mutations:{setHiddenControls:function(t,e){t.hiddenControls=e},setSourceTables:function(t,e){t.sourceTables=e},setDataTables:function(t,e){t.dataTables=e},setFieldList:function(t,e){t.fieldList=e},setCodeList:function(t,e){t.codeList=e},setMacroTypes:function(t,e){t.macroTypes=e},setExtControls:function(t,e){t.extControls=e},setButtonEditPopupList:function(t,e){t.buttonEditPopupList=e},removeControl:function(t,e){var n=e.selectedControl,o=e.selectedControlParentCol,i=e.selectedControlIndex;if(!n||!o||-1===i)return console.error("删除控件出错！！！");o.controls.splice(i,1)},removeHiddenControl:function(t,e){var n=e.index;t.hiddenControls.splice(n,1)},addControl:function(t,e){var n=e.parentCol,o=e.control;n.controls.push(o)},setSelectedControl:function(t,e){t.selectedControlId=e.id},clearSelectedControl:function(t){t.selectedControlId=""},updateControlProp:function(t,e){JSON.stringify(e);var n=e.control;n?/\./.test(e.prop)?(e.prop,Object(vt["g"])(n,e.prop),Object(vt["k"])(n,e.prop,e.value),Object(vt["g"])(n,e.prop)):n[e.prop]=e.value:console.error("无选中控件")}},actions:{deleteControl:function(t,e){if(e){var n=e.selectedControl,o=e.selectedControlParentCol,i=e.selectedControlIndex;t.commit("removeControl",{selectedControl:n,selectedControlParentCol:o,selectedControlIndex:i,shuttle:!0})}else{var a=t.getters.selectedControl,r=a.control,l=a.index;if(!r||-1===l)return console.error("出现错误，无法删除！");if("hiddenfield"===r.type)return t.commit("clearSelectedControl"),void t.commit("removeHiddenControl",{index:l,shuttle:!0});var s=t.getters.selectedControlParentCol;if(!s)return console.error("出现错误，无法删除！");t.commit("clearSelectedControl"),t.commit("removeControl",{selectedControl:r,selectedControlParentCol:s,selectedControlIndex:l,shuttle:!0})}},setSelectedControl:function(t,e){t.commit("setSelectedControl",e),t.commit("setSelectedCol",{id:""}),t.commit("updateSelectedLayout",{id:""})},autoAddLabel:function(t,e){var n=e.parentCol,o=Jl("",t.state.globalStyle);t.commit("addControl",{parentCol:n,control:o})},setControlProp:function(t,e){var n=e.prop,o=e.value,i=e.control;if(t.commit({control:i,type:"updateControlProp",prop:n,value:o,shuttle:!0,group:e.group}),"bind"==n){var a=t.getters.fieldMap[o];if(a&&a.datasource&&(t.commit({control:i,type:"updateControlProp",prop:"data",value:"",shuttle:!1}),t.commit({control:i,type:"updateControlProp",prop:"codeItem",value:a.datasource,shuttle:!1})),i&&o)try{t.commit({control:i,type:"updateControlProp",prop:"emptyText",value:"请输入"+t.getters.fieldMap[o].name,shuttle:!1})}catch(r){console.error("自动设置 emptyText",r)}ql(t,i),Wl(t,t.getters.fieldMap[i.bind].name),Hl(t,o,i),Nl(t,o,i)}"required"==n&&Gl(t,o),"sourceTable"==n&&Bl(t,i)},dealSubmitControl:function(t){Xl(t)}}};function Bl(t,e){e&&"subtable"==e.type&&t.commit({control:e,type:"updateControlProp",prop:"columns",value:[],shuttle:!1})}function Nl(t,e,n){var o=t.getters.fieldMap[e];if(o.fieldtype){var i;switch(o.fieldtype){case 1:i="float";break;case 2:i="int";break;default:break}i&&t.commit({control:n,type:"updateControlProp",prop:"vtype",value:i,shuttle:!1})}}function Hl(t,e,n){var o=t.getters.fieldMap[e];o.required&&n&&"required"in n&&(t.commit({control:n,type:"updateControlProp",prop:"required",value:!0,shuttle:!1}),Gl(t,!0))}function Wl(t,e){var n=Ul(t);n&&"控件label"==n.labelText&&t.commit("updateControlProp",{control:n,prop:"labelText",value:e,shuttle:!1})}function Gl(t,e){var n=Ul(t);n&&t.commit("updateControlProp",{control:n,prop:"showStar",value:e,shuttle:!1})}function Ul(t){var e=t.getters.selectedControlParentColInfo,n=e.row,o=e.index;if(n&&-1!==o){var i=n.cols[o-1];if(i&&i.controls.length){var a=!0,r=!1,l=void 0;try{for(var s,c=i.controls[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var d=s.value;if("label"==d.type)return d}}catch(u){r=!0,l=u}finally{try{a||null==c.return||c.return()}finally{if(r)throw l}}return null}}}function ql(t,e){var n=t.getters.selectedControlParentColInfo,o=n.row,i=n.index;if(e&&o){var a=o.cols[i-1];if(a&&!a.controls.length&&!a.subs.length){var r=Jl(t.getters.fieldMap[e.bind].name,t.state.globalStyle);t.commit("addControl",{parentCol:a,control:r,shuttle:!1})}}}function Jl(t,e){var n=Object(vt["d"])(window.FORM_DESIGN_CONFIG.controls.label),o=vt["c"].getIndex("label");n.id="label-"+o,n.namePrefix="label",n.autoIndex=o,n.name="",n.width="100%",t&&(n.labelText=t),delete n.configItems;var i=e.fontSize,a=e.fontFamily,r=e.fontColor,l=e.fontBolder,s=e.fontItalic,c=e.fontUnderline;return n.fontSize=i,n.fontFamily=a,n.fontColor=r,n.fontBolder=l,n.fontItalic=s,n.fontUnderline=c,n}function Xl(t){var e=t.getters.allControls,n=e.filter(function(t){return"combobox"==t.type}),o=new Map,i=new Map;n.forEach(function(t){o.set(t.id,t),t.events&&t.events["valuechanged:getcodelist"]&&t.events["valuechanged:getcodelist"].length&&i.set(t.id,t)}),Yl(i,o,t,{})}function Yl(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=!1,a=!1;t.forEach(function(t){if(t.codeItem){var r=t.events["valuechanged:getcodelist"].reduce(function(t,e){var n=e.actions.filter(function(t){return"setData"==t.type})[0];return n&&t.push.apply(t,Object(Q["a"])(n.targets)),t},[]);r.forEach(function(a){var r=a.id;o[r]||(n.commit({control:e.get(r),type:"updateControlProp",prop:"codeItem",value:t.codeItem,shuttle:!1}),o[r]=!0,i=!0)})}else a=!0}),a&&i&&Yl(t,e,n,o)}var Kl={getters:{inControlDragging:function(t){return t.helper.inControlDragging},inLayoutDragging:function(t){return t.helper.inLayoutDragging}},mutations:{updateLineTop:function(t,e){t.helper.top=e},updateLineLeft:function(t,e){t.helper.left=e},showHLine:function(t){t.helper.showHLine=!0},hideHLine:function(t){t.helper.showHLine=!1},showVLine:function(t){t.helper.showVLine=!0},hideVLine:function(t){t.helper.showVLine=!1},layoutDragStart:function(t){t.helper.inLayoutDragging=!0},layoutDragEnd:function(t){t.helper.inLayoutDragging=!1},controlDragStart:function(t){t.helper.inControlDragging=!0},controlDragEnd:function(t){t.helper.inControlDragging=!1}},actions:{}};q["default"].use(gt["a"]);var Ql=new gt["a"].Store({strict:!1,state:{formSize:{width:900,height:0},design:[],hiddenControls:[],globalStyle:{autoColons:!0,fontSize:13,fontFamily:"Microsoft Yahei",fontColor:"#333333",fontBolder:!1,fontItalic:!1,fontUnderline:!1,textAlign:"left",verticalAlign:"middle",cellHeight:38,border:{top:{width:1,style:"solid",color:"#ddd"},right:{width:1,style:"solid",color:"#ddd"},bottom:{width:1,style:"solid",color:"#ddd"},left:{width:1,style:"solid",color:"#ddd"}},allBorderType:"all"},helper:{showVLine:!1,showHLine:!1,left:0,top:0,inControlDragging:!1,inLayoutDragging:!1},jsCode:"",cssCode:"",fieldList:[],codeList:[],macroTypes:[],sourceTables:[],dataTables:[],buttonEditPopupList:[],extControls:[],leftActiveTab:"layout",rightActiveTab:"form",selectedControlId:"",selectedColId:"",selectedRowId:""},getters:Object(Z["a"])({},$l.getters,jl.getters,Fl.getters,Kl.getters,{globalStyleText:function(t){var e=t.globalStyle,n=e.fontSize,o=e.fontFamily,i=e.fontColor,a=e.fontBolder,r=e.fontItalic,l=e.fontUnderline,s=e.textAlign,c=e.verticalAlign;return"\n        font-size: ".concat(n,"px;\n        font-family: ").concat(o,";\n        color: ").concat(i,";\n        font-weight: ").concat(a?"bold":"normal",";\n        font-style: ").concat(r?"italic":"normal",";\n        text-decoration: ").concat(l?"underline":"none",";\n        text-align: ").concat(s,";\n        vertical-align: ").concat(c,";\n      ")}}),mutations:Object(Z["a"])({},$l.mutations,jl.mutations,Fl.mutations,Kl.mutations,{setJsCode:function(t,e){t.jsCode=e},setCssCode:function(t,e){t.cssCode=e},updateGlobalStyleProp:function(t,e){JSON.stringify(e),t.globalStyle[e.prop]=e.value},updateGlobalBorder:function(t,e){JSON.stringify(e),t.globalStyle.border.top[e.prop]=e.value,t.globalStyle.border.right[e.prop]=e.value,t.globalStyle.border.bottom[e.prop]=e.value,t.globalStyle.border.left[e.prop]=e.value},updateGlobalStyle:function(t,e){t.globalStyle=Oo()({},t.globalStyle,e)},applyGlobalStyle:function(t,e){var n=e.cols,o=e.prop,i=e.value;n.forEach(function(t){t.style[o]=i,t.controls&&t.controls.length&&-1!==["fontSize","fontFamily","fontColor","fontBolder","fontItalic","fontUnderline"].indexOf(o)&&t.controls.filter(function(t){return"label"==t.type||"title"==t.type}).forEach(function(t){t[o]=i})})},applyGlobalBorder:function(t,e){var n=e.cols,o=e.prop,i=e.value;n.forEach(function(t){t.style.border.top[o]=i,t.style.border.right[o]=i,t.style.border.bottom[o]=i,t.style.border.left[o]=i})},activeLeftTab:function(t,e){t.leftActiveTab=e},activeRightTab:function(t,e){t.rightActiveTab=e},updateDesign:function(t,e){t.design=e,t.design}}),actions:Object(Z["a"])({},$l.actions,jl.actions,Fl.actions,Kl.actions,{activeRightTab:function(t,e){var n=t.state,o=t.commit;n.rightActiveTab!=e&&o("activeRightTab",e)},setGlobalStyle:function(t,e){t.commit("updateGlobalStyleProp",e),t.commit("applyGlobalStyle",Object(Z["a"])({cols:t.getters.allCol},e,{shuttle:!0}))},setGlobalBorder:function(t,e){t.commit("updateGlobalBorder",e),t.commit("applyGlobalBorder",Object(Z["a"])({cols:t.getters.allCol},e,{shuttle:!0}))},setAllBorderType:function(t,e){var n=e.type,o=e.borderWidth,i="bordertype-"+ +new Date;t.commit("updateGlobalStyleProp",{prop:"allBorderType",value:n,group:i,shuttle:!0}),Zl(t,n,o,i)}})});function Zl(t,e,n,o){var i=t.getters.allCol;return"all"==e?t.commit("setAllColBorderWidth",{cols:i,group:o,borderWidth:n}):"none"==e?t.commit("setAllColBorderWidth",{cols:i,group:o,borderWidth:0}):void t.commit("setAllColBorder_"+e,{cols:i,group:o,borderWidth:n})}var ts=n("adb5"),es=n("2fdd");n("8e1f"),n("64d2");window.jsoncParse=es["a"],U.a.props.model=[Object,Array];var ns=q["default"].extend({extends:W.a,mounted:function(){this.$el&&!this.$el.title&&this.label&&this.label.length>10&&this.$el.setAttribute("title",this.label)}});q["default"].prototype.$bus=new q["default"],q["default"].prototype.$httpGet=ts["a"],q["default"].prototype.$httpPost=ts["b"],q["default"].prototype.$message=N.a,q["default"].prototype.$confirm=F.a.confirm,q["default"].config.productionTip=!1,q["default"].component("draggable",Ga.a),q["default"].component(P.a.name,P.a),q["default"].component(R.a.name,R.a),q["default"].component(j.a.name,j.a),q["default"].component(A.a.name,A.a),q["default"].component(I.a.name,I.a),q["default"].component(O.a.name,O.a),q["default"].component(T.a.name,T.a),q["default"].component(W.a.name,ns),q["default"].component(D.a.name,D.a),q["default"].component(x.a.name,x.a),q["default"].component(C.a.name,C.a),q["default"].component(U.a.name,U.a),q["default"].component(b.a.name,b.a),q["default"].component(g.a.name,g.a),q["default"].component(N.a.name,N.a),q["default"].component(p.a.name,p.a),q["default"].component(h.a.name,h.a),q["default"].component(d.a.name,d.a),q["default"].component(s.a.name,s.a),q["default"].component(r.a.name,r.a),q["default"].component(i.a.name,i.a),q["default"].use(Al.a),new q["default"]({store:Ql,render:function(t){return t(Il)}}).$mount("#app")},"587e":function(t,e,n){},"58d3":function(t,e,n){"use strict";var o=n("1728"),i=n.n(o);i.a},5908:function(t,e,n){"use strict";var o=n("301b"),i=n.n(o);i.a},"64a9":function(t,e,n){},"6f10":function(t,e,n){"use strict";var o=n("9048"),i=n.n(o);i.a},"82ad":function(t,e,n){},"89c5":function(t,e,n){},"8e1f":function(t,e,n){},9048:function(t,e,n){},9789:function(t,e,n){},9827:function(t,e,n){"use strict";n.d(e,"d",function(){return h}),n.d(e,"b",function(){return f}),n.d(e,"a",function(){return p});n("7f7f"),n("ac6a"),n("f3e2"),n("2caf");var o=n("308d"),i=n("6bb5"),a=n("4e2b"),r=n("d225"),l=n("b0b4"),s=function(){function t(){Object(r["a"])(this,t),this.store={}}return Object(l["a"])(t,[{key:"_get",value:function(t){if(!t)throw new Error("type is required!");return this.store[t]?++this.store[t]:this.store[t]=1}},{key:"adaptProp",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.store[t]?this.store[t]+=e:this.store[t]=e}}]),t}(),c=function(t){function e(){return Object(r["a"])(this,e),Object(o["a"])(this,Object(i["a"])(e).call(this))}return Object(a["a"])(e,t),Object(l["a"])(e,[{key:"getIndex",value:function(t){return this._get("control-"+t)}},{key:"adapt",value:function(t){var e=this;if(Array.isArray(t)){var n={};for(var o in t.forEach(function(t){var o=t.type,i=t.autoIndex||e.getIndex(o);n[o]?n[o]=Math.max(i,n[o]):n[o]=i}),n)this.adaptProp("control-"+o,n[o])}}}]),e}(s),d=function(t){function e(){return Object(r["a"])(this,e),Object(o["a"])(this,Object(i["a"])(e).call(this))}return Object(a["a"])(e,t),Object(l["a"])(e,[{key:"getIndex",value:function(t){return this._get("col-"+t)}},{key:"adapt",value:function(t){var e=this;Array.isArray(t)&&t.forEach(function(t){t.cols.forEach(function(n){e.adaptProp("col-"+t.id),n.subs&&n.subs.length&&e.adapt(n.subs)})})}}]),e}(s),u=function(t){function e(){return Object(r["a"])(this,e),Object(o["a"])(this,Object(i["a"])(e).call(this))}return Object(a["a"])(e,t),Object(l["a"])(e,[{key:"getIndex",value:function(t){return this._get("row-"+t)}},{key:"adapt",value:function(t){var e=this;if(Array.isArray(t)){var n={};for(var o in t.forEach(function(t){var o=t.namePrefix||t.name||"行",i=t.autoIndex||e.getIndex(o);n[o]?n[o]=Math.max(i,n[o]):n[o]=i}),n)this.adaptProp("control-"+o,n[o])}}}]),e}(s),h=new u,f=new c,p=new d;window.rowAutoIndex=h,window.controlAutoIndex=f,window.colAutoIndex=p,e["c"]={row:h,control:f,col:p}},"9d87":function(t,e,n){},adb5:function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"b",function(){return r});var o=n("7618");n("456d"),n("ac6a"),n("f3e2");function i(t){return t.custom&&(t=t.custom,"string"==typeof t&&(t=JSON.parse(t))),t}function a(t,e,n){return new Promise(function(o,a){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(r.readyState===XMLHttpRequest.DONE)if(200===r.status)try{o(e?r.responseText:i(JSON.parse(r.responseText)))}catch(t){console.error(t),o(r.responseText)}else a("There was a problem with the request.")},r.open("GET",t),n&&Object.keys(n).forEach(function(t){r.setRequestHeader(t,n[t])}),r.send()})}function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return new Promise(function(a,r){var l=new XMLHttpRequest;l.onreadystatechange=function(){if(l.readyState===XMLHttpRequest.DONE)if(200===l.status)try{a(i(JSON.parse(l.responseText)))}catch(t){console.error(t),a(l.responseText)}else r({state:l.status})},l.open("POST",t),l.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8"),n&&Object.keys(n).forEach(function(t){l.setRequestHeader(t,n[t])});var s=new URLSearchParams;for(var c in e)s.append(c,"object"==Object(o["a"])(e[c])?JSON.stringify(e[c]):e[c]);l.send(s)})}},ae24:function(t,e,n){},aeeb:function(t,e,n){"use strict";var o=n("587e"),i=n.n(o);i.a},af23:function(t,e,n){},b020:function(t,e,n){"use strict";var o=n("d466"),i=n.n(o);i.a},b6d4:function(t,e,n){},b8b5:function(t,e,n){"use strict";var o=n("ae24"),i=n.n(o);i.a},bec5:function(t,e,n){"use strict";var o=n("3a3a"),i=n.n(o);i.a},c8eb:function(t,e,n){},d466:function(t,e,n){},d482:function(t,e,n){"use strict";var o=n("af23"),i=n.n(o);i.a},d56b:function(t,e,n){"use strict";var o=n("c8eb"),i=n.n(o);i.a},d58f:function(t,e,n){},d5c7:function(t,e,n){"use strict";var o=n("eaff"),i=n.n(o);i.a},eaff:function(t,e,n){},ec83:function(t,e,n){"use strict";var o=n("d58f"),i=n.n(o);i.a},f1a3:function(t,e,n){"use strict";var o=n("9789"),i=n.n(o);i.a},f5bd:function(t,e,n){"use strict";var o=n("469a"),i=n.n(o);i.a}});