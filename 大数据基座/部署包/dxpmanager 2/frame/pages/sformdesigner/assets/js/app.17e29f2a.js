(function(t){function e(e){for(var n,i,l=e[0],r=e[1],c=e[2],d=0,u=[];d<l.length;d++)i=l[d],a[i]&&u.push(a[i][0]),a[i]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n]);h&&h(e);while(u.length)u.shift()();return s.push.apply(s,c||[]),o()}function o(){for(var t,e=0;e<s.length;e++){for(var o=s[e],n=!0,i=1;i<o.length;i++){var l=o[i];0!==a[l]&&(n=!1)}n&&(s.splice(e--,1),t=r(r.s=o[0]))}return t}var n={},i={app:0},a={app:0},s=[];function l(t){return r.p+"assets/js/"+({}[t]||t)+"."+{"chunk-5a3568d5":"d5c53ee9"}[t]+".js"}function r(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.e=function(t){var e=[],o={"chunk-5a3568d5":1};i[t]?e.push(i[t]):0!==i[t]&&o[t]&&e.push(i[t]=new Promise(function(e,o){for(var n="assets/css/"+({}[t]||t)+"."+{"chunk-5a3568d5":"c7ca1cfc"}[t]+".css",a=r.p+n,s=document.getElementsByTagName("link"),l=0;l<s.length;l++){var c=s[l],d=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(d===n||d===a))return e()}var u=document.getElementsByTagName("style");for(l=0;l<u.length;l++){c=u[l],d=c.getAttribute("data-href");if(d===n||d===a)return e()}var h=document.createElement("link");h.rel="stylesheet",h.type="text/css",h.onload=e,h.onerror=function(e){var n=e&&e.target&&e.target.src||a,s=new Error("Loading CSS chunk "+t+" failed.\n("+n+")");s.code="CSS_CHUNK_LOAD_FAILED",s.request=n,delete i[t],h.parentNode.removeChild(h),o(s)},h.href=a;var p=document.getElementsByTagName("head")[0];p.appendChild(h)}).then(function(){i[t]=0}));var n=a[t];if(0!==n)if(n)e.push(n[2]);else{var s=new Promise(function(e,o){n=a[t]=[e,o]});e.push(n[2]=s);var c,d=document.createElement("script");d.charset="utf-8",d.timeout=120,r.nc&&d.setAttribute("nonce",r.nc),d.src=l(t),c=function(e){d.onerror=d.onload=null,clearTimeout(u);var o=a[t];if(0!==o){if(o){var n=e&&("load"===e.type?"missing":e.type),i=e&&e.target&&e.target.src,s=new Error("Loading chunk "+t+" failed.\n("+n+": "+i+")");s.type=n,s.request=i,o[1](s)}a[t]=void 0}};var u=setTimeout(function(){c({type:"timeout",target:d})},12e4);d.onerror=d.onload=c,document.head.appendChild(d)}return Promise.all(e)},r.m=t,r.c=n,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(o,n,function(e){return t[e]}.bind(null,n));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],d=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var h=d;s.push([0,"chunk-vendors"]),o()})({0:function(t,e,o){t.exports=o("56d7")},"0015":function(t,e,o){"use strict";var n=o("2ff2"),i=o.n(n);i.a},"026d":function(t,e,o){"use strict";var n=o("b6d4"),i=o.n(n);i.a},"034f":function(t,e,o){"use strict";var n=o("64a9"),i=o.n(n);i.a},"165c":function(t,e,o){"use strict";var n=o("519c"),i=o.n(n);i.a},1728:function(t,e,o){},"25cd":function(t,e,o){"use strict";var n=o("9d87"),i=o.n(n);i.a},"2e74":function(t,e,o){"use strict";var n=o("89c5"),i=o.n(n);i.a},"2ff2":function(t,e,o){},"301b":function(t,e,o){},3176:function(t,e,o){"use strict";var n=o("82ad"),i=o.n(n);i.a},"3a3a":function(t,e,o){},"3f3e":function(t,e,o){},4260:function(t,e,o){"use strict";o("ac6a"),o("6b54");function n(){var t=+new Date,e=1e9*(1e4*Math.random()>>>0);const o=(e+t).toString(32);return n._store[o]?n():(n._store[o]=!0,o)}n._store={},n.adapt=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t=>t.id;const o=n._store;Array.isArray(t)&&t.forEach(t=>{const n=e(t);o[n]?console.warn("id duplicated",t.id):o[n]=n})};var i=n;o("28a5");function a(t,e){const o=e.split(".");if(1===o.length)return t[e];let n,i=0,a=t,s=o.length;while(1){if(i==s-1)return a[o[i]];if(n=a[o[i]],!n||"object"!=typeof n)return console.error("无法获取嵌套属性 at "+o[i],t,e),null;a=n,i++}}function s(t,e,o){const n=e.split(".");if(1===n.length)return t[e]=o;let i,a=0,s=t,l=n.length-1;do{i=s[n[a]],i&&"object"==typeof i?s=i:console.error("无法设置嵌套属性 at "+n[a],t,e),a++}while(a<l);return s.hasOwnProperty(n[a])||console.warn("设置原来没有的属性："+n[a]+" at ",s),s[n[a]]=o}function l(t){return JSON.parse(JSON.stringify(t))}var r=l,c=o("adb5");function d(t){const e=document.createElement("div");return e.appendChild(document.createTextNode(t)),e.innerHTML}function u(t){const e=document.createElement("div");return e.innerHTML=t,e.innerText}var h=o("9827");function p(t){return window.encodeURIComponent(window.btoa(window.encodeURIComponent(t)))}function f(t){return window.decodeURIComponent(window.atob(window.decodeURIComponent(t)))}function m(t,e,o){var n=t-e,i=o-t;return n>=0&&i>=0?t:Math.abs(n)>=Math.abs(i)?o:e}o.d(e,"l",function(){return i}),o.d(e,"g",function(){return a}),o.d(e,"k",function(){return s}),o.d(e,"d",function(){return r}),o.d(e,"i",function(){return c["b"]}),o.d(e,"h",function(){return d}),o.d(e,"a",function(){return m}),o.d(e,"c",function(){return h["b"]}),o.d(e,"b",function(){return h["a"]}),o.d(e,"j",function(){return h["d"]}),o.d(e,"f",function(){return p}),o.d(e,"e",function(){return f});c["a"],c["b"],h["b"],h["a"]},"469a":function(t,e,o){},"519c":function(t,e,o){},5443:function(t,e,o){"use strict";var n=o("3f3e"),i=o.n(n);i.a},"56d7":function(t,e,o){"use strict";o.r(e);o("bd49"),o("450d");var n=o("18ff"),i=o.n(n),a=(o("960d"),o("defb")),s=o.n(a),l=(o("cb70"),o("b370")),r=o.n(l),c=(o("cbb5"),o("8bbc")),d=o.n(c),u=(o("826b"),o("c263")),h=o.n(u),p=(o("a7cc"),o("df33")),f=o.n(p),m=(o("0c67"),o("299c")),g=o.n(m),b=(o("eca7"),o("3787")),v=o.n(b),y=(o("1951"),o("eedf")),C=o.n(y),w=(o("e960"),o("b35b")),x=o.n(w),_=(o("016f"),o("486c")),D=o.n(_),k=(o("1f1a"),o("4e4b")),T=o.n(k),S=(o("9d4c"),o("e450")),$=o.n(S),O=(o("fe07"),o("6ac5")),E=o.n(O),I=(o("b5d8"),o("f494")),L=o.n(I),A=(o("d4df"),o("7fc1")),j=o.n(A),M=(o("560b"),o("dcdc")),R=o.n(M),z=(o("10cb"),o("f3ad")),P=o.n(z),V=(o("9e1f"),o("6ed5")),F=o.n(V),B=(o("0fb7"),o("f529")),N=o.n(B),H=(o("6611"),o("e772")),W=o.n(H),G=(o("425f"),o("4105")),U=o.n(G),q=o("a026"),J=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{style:"height:"+t.height+"px",attrs:{id:"app"}},[o("Main")],1)},X=[],Y=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"design-container"},[o("div",{staticClass:"design-head"},[t._v("\n    "+t._s(t.formTitle)+"\n    "),o("Shuttle",{ref:"shuttle"}),t.showLocalBtns?o("span",{staticClass:"fe-mock-buttons"},[o("button",{staticStyle:{"margin-right":"10px"},on:{click:t.save}},[t._v("本地暂存")]),o("button",{staticStyle:{"margin-right":"10px"},on:{click:t.getLocalData}},[t._v("还原本地存储")]),o("button",{staticStyle:{"margin-right":"10px"},on:{click:t.clear}},[t._v("清空内容")])]):t._e(),o("div",{staticClass:"design-head-right",staticStyle:{float:"right"}},[o("el-switch",{staticClass:"view-toggle",attrs:{"active-value":"real","inactive-value":"design","active-text":"真实模式","inactive-text":"设计模式"},model:{value:t.viewType,callback:function(e){t.viewType=e},expression:"viewType"}}),t.showLocalBtns?o("el-button",{staticClass:"preview-btn",attrs:{type:"primary",size:"mini",disabled:!t.design.length},on:{click:t.preview}},[t._v("预览")]):t._e(),o("el-button",{staticClass:"js-btn",attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.openEditor("js")}}},[t._v("js编辑")]),o("el-button",{staticClass:"css-btn",attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.openEditor("css")}}},[t._v("css编辑")]),o("el-button",{staticClass:"save-btn",attrs:{type:"primary",size:"mini",disabled:!t.design.length},on:{click:t.saveToServer}},[t._v("保存")])],1)],1),o("div",{staticClass:"design-body",class:{narrow:t.narrowMode}},[o("div",{staticClass:"design-leftbar"},[o("Accordion",{attrs:{title:"布局"}},[o("PanelLayout")],1),o("Accordion",{attrs:{title:"控件"}},[o("PanelControl")],1)],1),o("div",{staticClass:"design-view-container",class:"view-"+t.viewType},[t.dataLoaded?o("Design",{attrs:{designData:t.design,size:t.formSize}}):t._e()],1),o("div",{staticClass:"design-rightbar",class:{pickup:t.narrowMode&&t.rightbarHidden}},[t.narrowMode?o("el-button",{staticClass:"design-rightbar-toggle",attrs:{icon:"el-icon-d-arrow-right",plain:""},on:{click:function(e){t.rightbarHidden=!t.rightbarHidden}}}):t._e(),o("Tabs",{attrs:{"default-active":"form",value:t.rightActiveTab},on:{input:t.activeRightTab}},[o("TabPanel",{attrs:{label:"表单设置",name:"form"}},[t.dataLoaded?o("ConfigForm"):t._e()],1),o("TabPanel",{attrs:{label:"组件设置",name:"control"}},[t.selectedControl?o("ConfigControl",{attrs:{control:t.selectedControl}}):t._e(),t.selectedRowId?o("ConfigRow",{attrs:{"row-id":t.selectedRowId}}):t._e(),t.selectedControl||t.selectedRowId?t._e():o("div",[t._v("请选择控件或行")])],1),o("TabPanel",{attrs:{label:"单元格",name:"cell"}},[t.selectedColId?o("ConfigCell",{attrs:{"selected-col":t.selectedCol}}):o("div",[t._v("请选择单元格")])],1)],1)],1)]),t.needRender?o("RowGender",{ref:"builder",attrs:{list:t.design,"global-style":t.globalStyle}}):t._e(),o("el-dialog",{attrs:{"append-to-body":"",title:t.editorDialog.title,visible:t.editorDialog.show,width:"90","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!0,fullscreen:"","custom-class":"code-editor-dialog","before-close":t.closeEditorDialog},on:{"update:visible":function(e){return t.$set(t.editorDialog,"show",e)},opened:t.onEditorDialogOpened}},[t.editorDialog.display?o("Editor",{attrs:{code:t.editorDialog.code,language:t.editorDialog.lang},on:{save:t.saveEditorCode,cancel:t.closeEditorDialog}}):t._e()],1)],1)},K=[],Q=(o("ac6a"),o("be94")),Z=(o("386d"),function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"tabs-view"},[o("div",{staticClass:"tabs-head"},t._l(t.panels,function(e,n){return o("div",{key:e.name,staticClass:"tab-head",class:t.active==e.name?t.activeClass:"",on:{click:function(e){return t.activeTab(n)}}},[t._v(t._s(e.label))])}),0),o("div",{staticClass:"tabs-body-wrap"},[o("div",{staticClass:"tabs-body",style:{width:t.width,marginLeft:t.marginLeft}},[t._t("default")],2)])])}),tt=[],et={methods:{getPercent(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;const o=Math.pow(10,e);return(Math.floor(100*t*o)/o).toFixed(2)+"%"}}},ot=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"tab-body",style:{width:t.width},attrs:{"data-name":t.name}},[t._t("default")],2)},nt=[],it={name:"tab-panel",inject:["tabCount","activeIndex"],mixins:[et],props:{label:{type:String,required:!0},name:{type:String,required:!0}},computed:{width(){return this.getPercent(1/this.tabCount)}}},at=it,st=o("2877"),lt=Object(st["a"])(at,ot,nt,!1,null,null,null),rt=lt.exports,ct={mixins:[et],props:{defaultActive:{type:String},activeClass:{type:String,default:"active"},value:{type:String}},components:{TabPanel:rt},provide(){return{tabCount:this.tabCount,activeIndex:this.activeIndex}},data(){return{active:this.value||this.defaultActive,tabCount:0}},computed:{panels(){const t=this.$slots.default.filter(t=>t.tag&&t.componentOptions&&"tab-panel"===t.componentOptions.Ctor.options.name),e=t.map(t=>t.componentOptions.propsData);return e},activeIndex(){if(this.panels.length)for(let t=0;t<this.panels.length;t++)if(this.panels[t].name==this.active)return t;return 0},width(){return this.getPercent(this.tabCount)},marginLeft(){return"-"+this.getPercent(this.activeIndex)}},watch:{panels:{immediate:!0,handler(){this.tabCount=this.panels.length}},value(t){t&&(this.active=t)},active(t){this.$emit("input",t)}},methods:{activeTab(t){this.active=this.panels[t].name}}},dt=ct,ut=(o("6f10"),Object(st["a"])(dt,Z,tt,!1,null,null,null)),ht=ut.exports,pt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("draggable",{staticClass:"layout-drag-area left-panel layout",attrs:{list:t.layoutList,group:{name:"layout",pull:"clone",put:!1},swapThreshold:"0.3",sort:!1,clone:t.createLayout,move:t.checkMove},on:{change:t.log,start:t.onDragStart,end:t.onDragEnd}},t._l(t.layoutList,function(e,n){return o("div",{key:e.id||n,staticClass:"template-item layout-item",class:e.type},[o("span",{staticClass:"template-item-icon layout",class:e.icon}),o("span",{staticClass:"template-item-name"},[t._v(t._s(e.name))])])}),0)},ft=[],mt=o("2f62"),gt=o("4260");function bt(t,e,o){this.$children.forEach(n=>{const i=n.$options.name;i===t?n.$emit.apply(n,[e].concat(o)):bt.apply(n,[t,e].concat([o]))})}var vt={methods:{dispatch(t,e,o){let n=this.$parent||this.$root,i=n.$options.name;while(n&&(!i||i!==t))n=n.$parent,n&&(i=n.$options.name);n&&n.$emit.apply(n,[e].concat(o))},broadcast(t,e,o){bt.call(this,t,e,o)}}},yt={name:"panel-layout",data(){return{layoutList:[{name:"一行2列",icon:"col-2",cols:[1,1],type:"row-layout"},{name:"一行4列",icon:"col-4",cols:[1,1,1,1],type:"row-layout"},{name:"一行6列",icon:"col-6",cols:[1,1,1,1,1,1],type:"row-layout"},{name:"1：5",icon:"col-2",cols:[1,5],type:"row-layout"},{name:"1：2：1：2",icon:"col-4",cols:[1,2,1,2],type:"row-layout"},{name:"多行多列",icon:"col-multi",cols:[],type:"row-layout"}]}},mixins:[vt],computed:Object(Q["a"])({},Object(mt["e"])(["formSize"]),{initialBorder(){return this.$store.state.globalStyle.border}}),mounted(){this.dispatch("accordion","updated")},methods:Object(Q["a"])({},Object(mt["d"])(["layoutDragStart","layoutDragEnd"]),{createLayout(t){var e=Object(gt["l"])();if("row-layout"==t.type){const o=gt["j"].getIndex(t.name),n={id:e,name:"",autoIndex:o,namePrefix:t.name,cols:this.createCols(t.cols,e),height:38};return 0==t.cols.length&&(n.asMulti=!0,n.cols=this.createCols([1],e)),n}},createCols(t,e){const o=t.reduce((t,e)=>t+e,0),n=this.formSize.width;return t.map(t=>{const i=gt["b"].getIndex(e);return{id:`col-${e}-${i}`,name:`col-${i}`,style:{verticalAlign:"middle",textAlign:"center",width:n*t/o,border:Object(gt["d"])(this.initialBorder)},subs:[],controls:[]}})},checkMove(t){if(this.$el==t.to||this.$el.compareDocumentPosition(t.to)&Node.DOCUMENT_POSITION_CONTAINED_BY)return!1;const e=t.draggedContext.element;return!(1==e.cols&&!t.to.classList.contains("level-0"))&&void 0},onDragStart(){this.layoutDragStart()},onDragEnd(){this.layoutDragEnd()},log(){}})},Ct=yt,wt=Object(st["a"])(Ct,pt,ft,!1,null,null,null),xt=wt.exports,_t=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"left-panel"},[o("draggable",{staticClass:"control-drag-area",attrs:{list:t.baseControls,group:{name:"control",pull:"clone",put:!1},swapThreshold:"0.3",sort:!1,clone:t.createControl,emptyInsertThreshold:20,move:t.checkMove},on:{change:t.log}},t._l(t.baseControls,function(e){return o("div",{key:e.type,staticClass:"template-item control-tpl-item",attrs:{"data-control-type":e.type}},[o("span",{staticClass:"template-item-icon control",class:e.icon}),o("span",{staticClass:"template-item-name"},[t._v(t._s(e.name))])])}),0),o("draggable",{staticClass:"control-drag-area",attrs:{list:t.extControls,group:{name:"control",pull:"clone",put:!1},swapThreshold:"0.3",sortable:!1,clone:t.createControl,move:t.checkMove},on:{change:t.log}},t._l(t.extControls,function(e){return o("div",{key:e.type,staticClass:"template-item control-tpl-item",attrs:{"data-control-type":e.type}},[o("span",{staticClass:"template-item-icon control",class:e.icon}),o("span",{staticClass:"template-item-name"},[t._v(t._s(e.name))])])}),0)],1)},Dt=[];const kt=window.FORM_DESIGN_CONFIG.controlList;var Tt={name:"panel-control",data(){return{baseControls:Object(gt["d"])(kt)}},computed:{extControls(){return this.$store.state.extControls}},mixins:[vt],mounted(){this.update()},methods:{update(){this.dispatch("accordion","updated")},createControl(t){const e=t.type,o=t.icon,n=t.name,i=window.FORM_DESIGN_CONFIG.controls[e];if(!i)throw new Error(`控件的 ${e} 配置信息不存在，无法创建`);const a=Object(gt["d"])(i);delete a.configItems;const s=gt["c"].getIndex(e);return a.id=e+"-"+s,a.namePrefix=n,a.autoIndex=s,a.name="",a.icon=o,a.width||(a.width="100%"),-1!=["title","label","output"].indexOf(e)&&this.copyGlobalStyleToControl(a),a},copyGlobalStyleToControl(t){const e=this.$store.state.globalStyle,o=e.fontSize,n=e.fontFamily,i=e.fontColor,a=e.fontBolder,s=e.fontItalic,l=e.fontUnderline;e.textAlign,e.verticalAlign;"label"==t.type&&(t.fontSize=o),t.fontFamily=n,t.fontColor=i,t.fontBolder=a,t.fontItalic=s,t.fontUnderline=l},checkMove(t){if(this.$el==t.to||this.$el.compareDocumentPosition(t.to)&Node.DOCUMENT_POSITION_CONTAINED_BY)return!1;const e=t.draggedContext.element;return!("hiddenfield"===e.type^t.to.classList.contains("design-hidden-area"))},log(){}},watch:{extControls(){this.update()},baseControls(){this.update()}}},St=Tt,$t=Object(st["a"])(St,_t,Dt,!1,null,null,null),Ot=$t.exports,Et=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{ref:"designArea",staticClass:"design-area",staticStyle:{position:"relative"},style:{width:t.size.width+20+"px"},attrs:{id:"design-area","data-width":t.size.width,"data-height":t.size.height},on:{click:t.handleFormClick}},[o("RowLayout",{attrs:{list:t.designData}}),o("HelperLine",{directives:[{name:"show",rawName:"v-show",value:t.showVLine,expression:"showVLine"}],attrs:{type:"v"}}),o("HelperLine",{directives:[{name:"show",rawName:"v-show",value:t.showHLine,expression:"showHLine"}],attrs:{type:"h"}}),o("draggable",{staticClass:"design-hidden-area",attrs:{group:"control",move:t.checkControlMove},model:{value:t.hiddenControls,callback:function(e){t.hiddenControls=e},expression:"hiddenControls"}},t._l(t.hiddenControls,function(e,n){return o("Control",{key:e.id,class:{selected:e.id==t.selectedControlId},attrs:{"control-data":e},nativeOn:{click:function(o){return o.stopPropagation(),t.onControlClick(e,n,t.hiddenControls)}}})}),1),o("div",{domProps:{innerHTML:t._s(t.colBorderStyle)}}),o("v-contextmenu",{ref:"ctxMenu"},[o("v-contextmenu-item",{on:{click:function(e){return t.ctxMneuItemHandle("insertRowUp")}}},[t._v("向上插入1行")]),o("v-contextmenu-item",{on:{click:function(e){return t.ctxMneuItemHandle("insertRowDown")}}},[t._v("向下插入1行")]),o("v-contextmenu-item",{attrs:{divider:""}}),o("v-contextmenu-item",{on:{click:function(e){return t.ctxMneuItemHandle("insertColLeft")}}},[t._v("向左插入1列")]),o("v-contextmenu-item",{on:{click:function(e){return t.ctxMneuItemHandle("insertColRight")}}},[t._v("向右插入1列")]),o("v-contextmenu-item",{attrs:{divider:""}}),o("v-contextmenu-item",{attrs:{disabled:!t.ctxMenuData.isControl},on:{click:function(e){return t.ctxMneuItemHandle("deleteControl")}}},[t._v("删除控件")]),o("v-contextmenu-item",{attrs:{disabled:!t.ctxMenuData.colDeletable||t.ctxMenuData.isControl},on:{click:function(e){return t.ctxMneuItemHandle("removeCol")}}},[t._v("删除此列")]),o("v-contextmenu-item",{attrs:{disabled:t.ctxMenuData.isControl},on:{click:function(e){return t.ctxMneuItemHandle("removeRow")}}},[t._v("删除此行")])],1),o("el-dialog",{staticClass:"multi-row-dialog",attrs:{"append-to-body":"",title:"请输入行列",visible:t.dialogVisible,width:"460px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[o("el-form",{attrs:{model:t.rowData,size:"mini",inline:"","inline-message":""}},[o("el-form-item",{attrs:{label:"行数目"}},[o("el-input-number",{attrs:{min:1,max:20,controls:!1,autocomplete:"off"},model:{value:t.rowData.rowCount,callback:function(e){t.$set(t.rowData,"rowCount",e)},expression:"rowData.rowCount"}})],1),o("el-form-item",{attrs:{label:"列数目"}},[o("el-input-number",{attrs:{min:1,max:20,controls:!1},model:{value:t.rowData.colCount,callback:function(e){t.$set(t.rowData,"colCount",e)},expression:"rowData.colCount"}})],1)],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.handleDialogClose("cancel")}}},[t._v("取 消")]),o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.handleDialogClose("ok")}}},[t._v("确 定")])],1)],1)],1)},It=[],Lt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("draggable",{staticClass:"dropArea layout",class:"level-"+t.level,attrs:{group:"layout",swapThreshold:.3,delay:0,list:t.list,move:t.checkLayoutMove,filter:".col-helper-line",preventOnFilter:!1,disabled:!1},on:{change:t.onLayoutChange,start:t.onLayoutDragStart,end:t.onLayoutDragEnd,choose:t.onDragChoose}},t._l(t.list,function(e,n){return o("div",{key:e.id,staticClass:"row",class:{isTop:0==t.level,first:0===n,mid:0!=n,selected:t.selectedRowId==e.id},style:"min-height:"+e.height+"px",attrs:{"row-id":e.id,"data-name":e.name,level:t.level}},[t._l(e.cols,function(i,a){return o("div",{key:i.id,staticClass:"col",class:t.getColCls(i,a,e.cols.length),style:t.colStyleMap[e.id][a],attrs:{id:i.id,name:i.name,"data-text-align":i.style.textAlign,"data-vertical-align":i.style.verticalAlign},on:{click:function(e){return e.stopPropagation(),t.handleColClick(a,i,e)},contextmenu:function(o){return o.stopPropagation(),o.preventDefault(),t.onContextmenu(o,{row:e,rowIndex:n,parentCol:t.parentCol,col:i,colIndex:a,colDeletable:!!e.cols.length})}}},[i.controls.length||1==e.cols.length?t._e():o("RowLayout",{directives:[{name:"show",rawName:"v-show",value:i.subs&&i.subs.length||t.inLayoutDragging,expression:"(col.subs && col.subs.length) || inLayoutDragging"}],attrs:{list:i.subs,level:t.levelNext,parentCol:i,parentRow:e}}),i.subs&&i.subs.length?t._e():o("draggable",{staticClass:"dropArea controls",class:{active:i.controls.length||t.inControlDragging},attrs:{group:"control",list:i.controls,draggable:".design-control",swapThreshold:1,invertedSwapThreshold:1,invertSwap:!1,direction:"vertical",move:t.checkControlMove},on:{start:t.onControlDragStart,end:t.onControlDragEnd,add:function(o){return t.onControlAdd(o,{col:i,colIndex:a,row:e})}}},t._l(i.controls,function(e){return o("Control",{key:e.id,class:{selected:e.id==t.selectedControlId},staticStyle:{display:"inline-block"},attrs:{"control-data":e},nativeOn:{click:function(o){return o.stopPropagation(),t.onControlClick(e)}}})}),1),a!==e.cols.length-1?o("div",{staticClass:"col-helper-line line-v",attrs:{"data-row-index":n,"data-col-index":a,"data-level":t.level}}):t._e(),0===t.level||n!==t.list.length-1?o("div",{staticClass:"col-helper-line line-h",attrs:{"data-row-index":n,"data-col-index":a}}):t._e()],1)}),o("div",{staticClass:"row-helper"},[o("el-tooltip",{attrs:{placement:"top",enterable:!1,"open-delay":300,content:"移除行"}},[o("span",{staticClass:"row-helper-btn remove el-icon-delete",on:{click:function(o){return o.stopPropagation(),t.handleRowRemove(e,n)}}})]),o("el-tooltip",{attrs:{placement:"top",enterable:!1,"open-delay":300,content:"复制行"}},[o("span",{staticClass:"row-helper-btn copy el-icon-copy-document",on:{click:function(o){return t.handleRowCopy(e,n,t.parentCol)}}})]),o("el-tooltip",{attrs:{placement:"top",enterable:!1,"open-delay":300,content:"选择"}},[o("span",{staticClass:"row-helper-btn selected el-icon-top-left",on:{click:function(o){return o.stopPropagation(),t.handleRowSelect(e.id)}}})])],1)],2)}),0)},At=[],jt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"design-control",class:t.controlData.type,style:"width:"+t.controlWidth,attrs:{"data-id":t.controlData.id}},[t._t("default"),o(t.getControlComponent(t.controlData.type),{tag:"component",attrs:{"control-data":t.controlData}}),o("span",{directives:[{name:"show",rawName:"v-show",value:t.controlData.icon,expression:"controlData.icon"}],staticClass:"design-control-icon",class:t.controlIconMap[t.controlData.type]}),o("span",{staticClass:"design-control-remove",on:{click:function(e){return e.stopPropagation(),t.removeControl(e)}}})],2)},Mt=[],Rt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("label",{staticClass:"label",class:{"design-form-label":t.asControl,"design-control-holder":!t.asControl,colons:t.autoColons,required:t.controlData.showStar},style:t.styleText},[t._v(t._s((t.controlData.labelText||t.controlData.name)+(t.autoColons?"：":"")))])},zt=[],Pt={name:"placeholder-label",props:{controlData:{type:Object,default:()=>{return{}}},asControl:{type:Boolean,default:!1}},computed:{autoColons(){return this.$store.state.globalStyle.autoColons},styleText(){const t=this.controlData,e=t.fontSize,o=t.fontFamily,n=t.fontColor,i=t.fontBolder,a=t.fontItalic,s=t.fontUnderline,l=t.textAlign,r=t.verticalAlign,c=[];return c.push(`font-size:${e}px`),c.push(`font-family:${o}`),c.push(`color:${n}`),c.push(`font-weight:${i?"bold":"normal"}`),c.push(`font-style:${a?"italic":"normal"}`),c.push(`text-decoration:${s?"underline":"none"}`),c.push(`text-align:${l}`),c.push(`vertical-align:${r}`),c.join(";")}},data(){return{}}},Vt=Pt,Ft=Object(st["a"])(Vt,Rt,zt,!1,null,null,null),Bt=Ft.exports,Nt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("input",{staticClass:"design-control-holder textbox",attrs:{type:"text",placeholder:t.controlData.emptyText||t.name,readonly:""},domProps:{value:t.controlData.value}})},Ht=[],Wt={name:"placeholder-textbox",props:["controlData"],computed:{name(){const t=this.controlData,e=t.name,o=t.namePrefix,n=t.autoIndex;return e||(o&&n?`${o}_${n}`:"")}}},Gt=Wt,Ut=Object(st["a"])(Gt,Nt,Ht,!1,null,null,null),qt=Ut.exports,Jt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("h1",{staticClass:"title",class:t.asControl?"design-form-title ":"design-control-holder",style:t.styleText},[t._v(t._s(t.controlData.textContent||t.controlData.name))])},Xt=[],Yt={name:"placeholder-title",props:{controlData:{type:Object,default:()=>{return{}}},asControl:{type:Boolean,default:!1}},computed:{styleText(){const t=this.controlData,e=t.fontSize,o=t.fontFamily,n=t.fontColor,i=t.fontBolder,a=t.fontItalic,s=t.fontUnderline,l=t.textAlign,r=t.verticalAlign,c=[];return c.push(`font-size:${e}px`),c.push(`font-family:${o}`),c.push(`color:${n}`),c.push(`font-weight:${i?"bold":"normal"}`),c.push(`font-style:${a?"italic":"normal"}`),c.push(`text-decoration:${s?"underline":"none"}`),c.push(`text-align:${l}`),c.push(`vertical-align:${r}`),c.join(";")}},data(){return{}}},Kt=Yt,Qt=Object(st["a"])(Kt,Jt,Xt,!1,null,null,null),Zt=Qt.exports,te=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("textarea",{staticClass:"design-control-holder textbox",staticStyle:{resize:"none"},style:"height:"+(t.controlData.height||26)+"px",attrs:{type:"text",placeholder:t.controlData.emptyText||t.controlData.name,readonly:""},domProps:{value:t.controlData.value}})},ee=[],oe={name:"placeholder-textarea",props:["controlData"]},ne=oe,ie=Object(st["a"])(ne,te,ee,!1,null,null,null),ae=ie.exports,se=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("span",{staticClass:"design-control-holder checkboxlist",class:"vertical"==t.controlData.repeatDirection?"vertical":"horizontal"},[o("el-checkbox-group",{model:{value:t.valueList,callback:function(e){t.valueList=e},expression:"valueList"}},t._l(t.dataList,function(e){return o("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])}),1)],1)},le=[],re=(o("28a5"),{computed:{dataList(){const t=this.controlData;return Array.isArray(t.data)?t.data:this.originData&&this.originData.length?this.originData:this.defaultDataList}},methods:{getDataList(){const t=this.controlData;if(Array.isArray(t.data)||!t.codeItem)return this.originData=[];this.$httpPost(window.formDesignerActions.getControlDataListUrl,{controlData:this.controlData}).then(t=>{if(!Array.isArray(t))throw new Error("获取控件数据出错!");this.originData=t}).catch(t=>{this.originData=[],console.error(t)})}},watch:{"controlData.codeItem"(t){t&&this.getDataList()}}}),ce={name:"placeholder-checkboxlist",props:["controlData"],mixins:[re],data(){return{valueList:this.getValueList(),defaultDataList:[1,2,3].map(t=>{return{id:t,text:"选项-"+t}}),originData:[]}},methods:{getValueList(){return this.controlData.value&&this.controlData.value.split(",")||[]}},created(){this.getDataList()},watch:{"controlData.value"(){this.valueList=this.getValueList()},"controlData.bind"(){this.valueList=this.getValueList()}}},de=ce,ue=Object(st["a"])(de,se,le,!1,null,null,null),he=ue.exports,pe=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("span",{staticClass:"design-control-holder radiobuttonlist",class:"vertical"==t.controlData.repeatDirection?"vertical":"horizontal"},[o("el-radio-group",{model:{value:t.currValue,callback:function(e){t.currValue=e},expression:"currValue"}},t._l(t.dataList,function(e){return o("el-radio",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])}),1)],1)},fe=[],me={name:"placeholder-radio-button-list",props:["controlData"],mixins:[re],data(){return{currValue:this.controlData.value||"",defaultDataList:[1,2,3].map(t=>{return{id:t,text:"选项-"+t}}),originData:[]}},created(){this.getDataList()}},ge=me,be=Object(st["a"])(ge,pe,fe,!1,null,null,null),ve=be.exports,ye=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("table",{staticClass:"design-control-holder sub-table"},[o("colgroup",[o("col",{attrs:{for:"checkcolumn",width:"50px"}}),o("col",{attrs:{for:"indexcolumn",width:"50px"}}),t._l(t.columns,function(t){return o("col",{key:t.field,attrs:{for:"normal",width:t.width+"px"}})}),o("col",{attrs:{for:"actioncolumn",width:"100px"}})],2),o("thead",[o("tr",[t.checkcolumn?o("th",{staticClass:"text-center",class:{frozen:t.checkcolumnFrozen},attrs:{"data-column-type":"checkcolumn"}},[o("span",{staticClass:"checkcolumn-icon"})]):t._e(),t.indexcolumn?o("th",{staticClass:"text-center",class:{frozen:1==t.frozenIndex},attrs:{"data-column-type":"indexcolumn"}},[t._v("序")]):t._e(),t._l(t.columns,function(e,n){var i;return o("th",{key:e.field,class:(i={},i["text-"+e.align]=!0,i.frozen=t.frozenIndex==n+t.prevColumnCount,i),attrs:{"data-column-type":"normal"}},[t._v(t._s(e.name))])}),t.actioncolumn?o("th",{staticClass:"text-center",attrs:{"data-column-type":"actioncolumn"}},[t._v("操作")]):t._e()],2)]),o("tbody",[o("tr",[t.checkcolumn?o("td",{staticClass:"text-center",class:{frozen:t.checkcolumnFrozen}},[o("span",{staticClass:"checkcolumn-icon"})]):t._e(),t.indexcolumn?o("td",{staticClass:"text-center",class:{frozen:1==t.frozenIndex}},[t._v("1")]):t._e(),t._l(t.columns,function(e,n){var i;return o("td",{key:e.field,class:(i={},i["text-"+e.align]=!0,i.frozen=t.frozenIndex==n+t.prevColumnCount,i)},[t._v("...")])}),t.actioncolumn?o("td",{staticClass:"text-center"},[t._m(0)]):t._e()],2),o("tr",[t.checkcolumn?o("td",{staticClass:"text-center",class:{frozen:t.checkcolumnFrozen}},[o("span",{staticClass:"checkcolumn-icon"})]):t._e(),t.indexcolumn?o("td",{staticClass:"text-center",class:{frozen:1==t.frozenIndex}},[t._v("2")]):t._e(),t._l(t.columns,function(e,n){var i;return o("td",{key:e.field,class:(i={},i["text-"+e.align]=!0,i.frozen=t.frozenIndex==n+t.prevColumnCount,i)},[t._v("...")])}),t.actioncolumn?o("td",{staticClass:"text-center"},[t._m(1)]):t._e()],2)])])},Ce=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("span",[o("i",{staticClass:"action-btn el-icon-plus"}),o("i",{staticClass:"action-btn el-icon-edit"}),o("i",{staticClass:"action-btn el-icon-delete"})])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("span",[o("i",{staticClass:"action-btn el-icon-plus"}),o("i",{staticClass:"action-btn el-icon-edit"}),o("i",{staticClass:"action-btn el-icon-delete"})])}],we={name:"placeholder-sub-table",props:["controlData"],computed:{specificColumns(){return this.controlData?this.controlData.specialColumns.split(","):[]},checkcolumn(){return-1!==this.specificColumns.indexOf("checkcolumn")},checkcolumnFrozen(){return!(!this.checkcolumn||0!=this.frozenIndex)},indexcolumn(){return-1!==this.specificColumns.indexOf("indexcolumn")},indexcolumnForzen(){return this.checkcolumn?1==this.frozenIndex:0==this.frozenIndex},actioncolumn(){return-1!==this.specificColumns.indexOf("actioncolumn")},frozenIndex(){return this.controlData.frozenColumnIndex},prevColumnCount(){return this.checkcolumn&&this.indexcolumn?2:this.checkcolumn||this.indexcolumn?1:(this.checkcolumn||this.indexcolumn,0)},columns(){return this.controlData.columns.length?this.controlData.columns:[{field:"name",name:"姓名",width:100,align:"center",required:!0,vtype:"number"}]}},data(){return{}},methods:{}},xe=we,_e=Object(st["a"])(xe,ye,Ce,!1,null,null,null),De=_e.exports,ke=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("span",{staticClass:"output",class:{"design-form-output":t.asControl,"design-control-holder":!t.asControl},style:t.styleText},[t._v(t._s(t.controlData.name||t.controlData.namePrefix+"_"+t.controlData.autoIndex))])},Te=[],Se={name:"placeholder-output",props:{controlData:{type:Object,default:()=>{return{}}},asControl:{type:Boolean,default:!1}},computed:{controlWidth(){const t=this.controlData.width;return t?t+""===t?t:`${t}px`:""},styleText(){const t=this.controlData,e=t.fontSize,o=t.fontFamily,n=t.fontColor,i=t.fontBolder,a=t.fontItalic,s=t.fontUnderline,l=t.textAlign,r=(t.width,[]);return r.push("display:inline-block"),r.push("-webkit-box-sizing:border-box;box-sizing:border-box;"),r.push(`font-size:${e}px`),r.push(`font-family:${o}`),r.push(`color:${n}`),r.push(`font-weight:${i?"bold":"normal"}`),r.push(`font-style:${a?"italic":"normal"}`),r.push(`text-decoration:${s?"underline":"none"}`),r.push(`text-align:${l}`),this.controlWidth&&r.push(`width:${this.controlWidth}`),r.join(";")}},data(){return{}}},$e=Se,Oe=Object(st["a"])($e,ke,Te,!1,null,null,null),Ee=Oe.exports;const Ie={label:Bt,textbox:qt,title:Zt,textarea:ae,checkboxlist:he,radiobuttonlist:ve,subtable:De,output:Ee},Le={props:["controlData"],template:'<span class="design-control-holder" :class="controlData.type">{{controlData.name || (controlData.namePrefix + "_" + controlData.autoIndex)}}</span>'};var Ae={name:"control",props:{controlData:{type:Object,required:!0}},components:{PlaceholderLabel:Bt,PlaceholderTextbox:qt,PlaceholderTitle:Zt,PlaceholderTextArea:ae,PlaceholderCheckboxList:he,PlaceholderRadioButtonList:ve},data(){return{}},computed:{controlIconMap(){const t={};return window.FORM_DESIGN_CONFIG.controlList.concat(this.$store.state.extControls).forEach(e=>{t[e.type]=e.icon}),t},controlWidth(){const t=this.controlData.width;return t?t+""===t?t:`${t}px`:""}},methods:{removeControl(){this.$store.dispatch("deleteControl")},getControlComponent(t){return t in Ie?Ie[t]:Le}}},je=Ae,Me=Object(st["a"])(je,jt,Mt,!1,null,null,null),Re=Me.exports,ze=o("84a2"),Pe=o.n(ze),Ve=o("42a0"),Fe=o.n(Ve),Be={methods:{handleRowSelect(t){this.setSelectedLayout({id:t}),this.activeRightTab("control")},handleRowCopy(t,e,o){const n=this.getRowCopyData(t);this.copyRow({aimIndex:e+1,parentCol:o,newRow:n,shuttle:!0})},getRowCopyData(t,e){const o=Object(gt["d"])(t);return n(o),o;function n(t){const o=Object(gt["l"])(),a=t.namePrefix||t.name;t.id=o,t.autoIndex=gt["j"].getIndex(a),t.name&&(t.name=`${t.name}_${t.autoIndex}`),t.cols.forEach(t=>{t.id=`col-${o}-${gt["b"].getIndex(o)}`,t.subs&&t.subs.forEach(n),e?t.controls=[]:t.controls.forEach(i)})}function i(t){const e=t.type,o=window.FORM_DESIGN_CONFIG.controls[e];if(!o)throw new Error(`控件的 ${e} 配置信息不存在，无法创建`);const n=Object(gt["d"])(o);delete n.configItems,delete n.name,delete n.width,delete n.id,delete n.type,"label"!=e&&"title"!=e&&Fe()(t,n);const i=gt["c"].getIndex(e);t.id=e+"-"+i,t.autoIndex=i,t.name&&(t.name=`${t.name}_${i}`)}},handleRowRemove(t,e){if(this.isEmptyRow(t))return this.doRowRemove(t,e);this.$confirm("此操作将移除此行，以及此行内的所有内容，是否确认？"," 删除提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.doRowRemove(t,e)}).catch(()=>{})},doRowRemove(t,e){this.deleteRow({parentCol:this.parentCol,row:t,index:e})},isEmptyRow(t){for(let e of t.cols)if(e.subs.length||e.controls.length)return!1;return!0}}},Ne={methods:{handleColClick(t,e,o){const n=o.target;if(n.classList.contains("col-helper-line"))return;const i=n.closest(".col");if(!i)return;const a=e.id==this.selectedColId;a?this.setSelectedCol({id:""}):(this.setSelectedCol({id:e.id}),this.activeRightTab("cell"))},removeCol(t){const e=t.col,o=t.parentRow,n=t.colIndex;if(this.isEmptyCol(e))return this.doColRemove(e,o,n);this.$confirm("删除后此单元格内的所有内容将一并删除，是否继续？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.doColRemove(e,o,n)}).catch(t=>{t&&console.error(t)})},doColRemove(t,e,o){this.$store.dispatch("removeCol",{col:t,parentRow:e,colIndex:o,shuttle:!0})},isEmptyCol(t){return!(t.subs.length||t.controls.length)},getColCls(t,e,o){const n=this.globalStyle,i=t.subs.length,a=t.style,s={selected:this.selectedColId==t.id,isSub:!i,hasSub:i,first:0===e,mid:e&&e!==o-1,last:e===o-1,["text-"+(a.textAlign||n.textAlign)]:!0,["vertical-"+(a.verticalAlign||n.verticalAlign)]:!0};return s}}},He={methods:{onMouseDown(t){const e=t.target;if(!e.classList.contains("col-helper-line"))return!0;window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp);var o=this.rowEl=e.closest(".row"),n=this.colEl=e.closest(".col");this.rowId=o&&o.getAttribute("row-id"),this.rowData=this.findRow(this.rowId),this.startHeight=this.rowData.height||30;const i=this.getDesignContainer(),a=i.getBoundingClientRect();this.mouseOffset=this.getMouseOffset(t),this.stagElementsOffset(t,a);const s=parseInt(e.dataset.colIndex,10);this.colData=this.rowData.cols[s],this.nextColData=this.rowData.cols[s+1],this.colData.width+""===this.colData.width?this.startWidth=n.getBoundingClientRect().width:this.startWidth=this.colData.style.width,this.rowId,this.inMoving=!0,e.classList.contains("line-v")?(this.getXLimit(t,a),this.resizeMode="v",this.startOffsetX=this.getXOffset(t),this.updateLineLeft(this.startOffsetX),this.showVLine()):e.classList.contains("line-h")&&(this.getYLimit(t,a),this.resizeMode="h",this.startOffsetY=this.getYOffset(t),this.updateLineTop(this.startOffsetY),this.showHLine())},onMouseMove(t){if("h"==this.resizeMode){let e=this.getYOffset(t);e=Object(gt["a"])(e,this.moveRange.y[0],this.moveRange.y[1]),this.updateLineTop(e);const o=e-this.startOffsetY;let n=this.startHeight+o;n<30&&(n=30),this.updateRowHeight({rowId:this.rowId,height:n,row:this.rowData,parentRowPath:this.pathMap[this.rowId],shuttle:!0})}else if("v"==this.resizeMode){let e=this.getXOffset(t);e=Object(gt["a"])(e,this.moveRange.x[0],this.moveRange.x[1]);const o=this.getSnapOffset(e);o&&(e=o),this.updateLineLeft(e);const n=e-this.startOffsetX;let i=this.startWidth+n;i<10&&(i=10),this.updateColWidth({col:this.colData,width:i,nextCol:this.nextColData,shuttle:!0})}},getXLimit(t,e){const o=30;let n,i;function a(t,e){if(!t.subs||!t.subs.length)return t.style.width;const o=t.subs.map(t=>{return a(t.cols["first"==e?0:t.cols.length-1])});return Math.min(...o)}this.colData?(n=a(this.colData,"last"),n=n<o?0:n-o):n=0,this.nextColData?(i=a(this.nextColData,"first"),i=i<o?0:i-o):i=0,n=t.pageX-e.left-this.mouseOffset.x-n,i=t.pageX-e.left-this.mouseOffset.x+i,this.moveRange.x=[n,i]},getYLimit(t,e){const o=38;let n,i;const a=s(this.rowData);return n=a-o,n<0&&(n=0),n=t.pageY-e.top-this.mouseOffset.y-n,i=1/0,this.moveRange.y=[n,i],[n,i];function s(t){let e=!1;const o=[];return t.cols.forEach(t=>{t.subs&&t.subs.length&&(e=!0,o.push(s(t.subs[t.subs.length-1])))}),t.height,e?Math.min(...o):t.height}},getLimitedOffset(){},getYOffset(t){const e=this.getDesignContainer(),o=e.getBoundingClientRect(),n=t.pageY-o.top-this.mouseOffset.y;return n},getXOffset(t){const e=this.getDesignContainer(),o=e.getBoundingClientRect(),n=t.pageX-o.left-this.mouseOffset.x;return n},getMouseOffset(t){const e=t.target,o=e.getBoundingClientRect();return{x:t.pageX-o.left-o.width/2,y:t.pageY-o.top-o.height/2}},stagElementsOffset(t,e){const o=this.getDesignContainer(),n=t.target.closest("col"),i=[].slice.call(o.querySelectorAll(".col.isSub")),a=[];i.forEach(t=>{if(t.classList.contains("last")||t==n)return;const o=t.getBoundingClientRect(),i=o.left+o.width-e.left;a.push(i)}),this.otherColOffSets=Array.from(new Set(a)),this.otherColOffSets},getSnapOffset(t){const e=new Map;return this.otherColOffSets.forEach(o=>{const n=Math.abs(t-o);n<=10&&e.set(n,o)}),!!e.size&&e.get(Math.min(...e.keys()))},onMouseUp(){this.hideHLine(),this.hideVLine(),this.resetMoveData(),this.removeEventListener()},resetMoveData(){this.inMoving=!1,this.rowEl=null,this.colEl=null,this.rowId="",this.rowData=null,this.colData=null,this.nextColData=null,this.startOffsetX=0,this.startOffsetY=0,this.mouseOffset.x=0,this.mouseOffset.y=0,this.moveRange.x=[0,0],this.moveRange.y=[0,0],this.otherColOffSets=[],this.startHeight=0,this.startWidth=0,this.resizeMode=!1},removeEventListener(){window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp)}}},We={methods:{onContextmenu(t,e){const o=t.target;(1==e.row.cols.length||2===e.row.cols.length&&e.parentCol)&&(e.colDeletable=!1);const n=o.closest(".design-control");if(n){const t=n.dataset.id;let o,i,a;for(let n=0,s=e.col.controls.length;n<s;n++)if(a=e.col.controls[n],a.id==t){o=n,i=a;break}i&&(e.control=i,e.controlIndex=o)}this.$data._ctxMenuData=e,this.showCtxMenu(t,e,this.handleContextMenu)},handleContextMenu(t){const e=this.$data._ctxMenuData;switch(t){case"deleteControl":this.deleteControl({selectedControl:e.control,selectedControlParentCol:e.col,selectedControlIndex:e.controlIndex});break;case"removeCol":this.removeCol({col:e.col,parentRow:e.row,colIndex:e.colIndex});break;case"removeRow":this.handleRowRemove(e.row,e.rowIndex);break;case"insertRowUp":this.copyRow({aimIndex:e.rowIndex,parentCol:e.parentCol,newRow:this.getRowCopyData(e.row,!0),shuttle:!0});break;case"insertRowDown":this.copyRow({aimIndex:e.rowIndex+1,parentCol:e.parentCol,newRow:this.getRowCopyData(e.row,!0),shuttle:!0});break;case"insertColLeft":this.splitCol({col:e.col,colIndex:e.colIndex,parentRow:e.row,direction:"left",shuttle:!0});break;case"insertColRight":this.splitCol({col:e.col,colIndex:e.colIndex,parentRow:e.row,direction:"right",shuttle:!0});break;default:break}}}},Ge={name:"RowLayout",inject:{getDesignContainer:{default:()=>document.getElementById("design-area")},showCtxMenu:"showCtxMenu",showMutliRowConfirm:"showMutliRowConfirm"},mixins:[Be,Ne,He,We],props:{list:{type:Array,default:()=>[]},level:{type:Number,default:0},parentCol:{type:Object,default:null},parentRow:{type:Object,default:null}},data(){return{_ctxMenuData:null,inMoving:!1,rowEl:null,colEl:null,rowId:"",rowData:null,colData:null,nextColData:null,startOffsetX:0,startOffsetY:0,mouseOffset:{x:0,y:0},moveRange:{x:[0,0],y:[0,0]},otherColOffSets:[],startHeight:0,startWidth:0,resizeMode:!1}},mounted(){0===this.level&&this.$el.addEventListener("mousedown",this.onMouseDown)},components:{Control:Re},computed:Object(Q["a"])({},Object(mt["e"])(["leftActiveTab","selectedColId","formSize","globalStyle","selectedRowId","selectedControlId"]),Object(mt["c"])(["inControlDragging","inLayoutDragging","selectedCol"]),{levelNext(){return this.level+1},dataMap(){return this.$store.getters.rowDataMap},pathMap(){return this.$store.getters.subRowPathMap},colStyleMap(){const t={};return this.list.forEach(e=>{t[e.id]=[],e.cols.forEach(o=>{const n=o.style.width;t[e.id].push({width:`${n}px`})})}),t}}),methods:Object(Q["a"])({},Object(mt["d"])(["updateLineTop","updateLineLeft","showHLine","hideHLine","showVLine","hideVLine","updateRowHeight","updateColWidth","layoutDragStart","layoutDragEnd","controlDragStart","controlDragEnd","copyRow","splitCol"]),Object(mt["b"])(["setSelectedControl","setSelectedCol","setSelectedLayout","deleteRow","deleteControl","activeRightTab"]),{throttle:Pe()((t,e)=>{t.name,t(e)},20,{leading:!0,trailing:!1}),checkLayoutMove(t){const e=t.draggedContext.element;if(1==e.cols.length&&!t.to.classList.contains("level-0"))return!1},checkControlMove(t){if(t.to.classList.contains("design-hidden-area"))return!1},onControlClick(t){this.setSelectedControl({id:t.id}),this.activeRightTab("control"),setTimeout(()=>{this.$bus.$emit("cntrolClick")},100)},onControlAdd(t,e){if(t.from.classList.contains("control-drag-area")){const o=t.item.dataset.controlType;if("title"==o||"label"==o||"subtable"==o)return;const n=e.row,i=e.colIndex,a=n.cols[i-1];if(!a)return;const s=!a.controls.length&&!a.subs.length;s&&this.$store.dispatch("autoAddLabel",{parentCol:a})}},onLayoutChange(t){if(t.added){const e=t.added.element;if(this.parentCol,e.asMulti)return this.showMutliRowConfirm((o,n)=>{this.$store.commit("replaceToMulti",{row:e,rowIndex:t.added.newIndex,rowCount:o,colCount:n,shuttle:!0})});{const t=this.parentCol?this.parentCol.style.width:this.formSize.width,o=e.cols.reduce((t,e)=>{return t+e.style.width},0),n=t/o;this.$store.commit({type:"updateRowColWidth",rowId:e.id,row:e,ratio:n,shuttle:!0,group:"adjust"})}e.height;if(this.parentCol){const t=this.pathMap[e.id],o=t[0],n=o.height,i=this.parentCol.subs.reduce((t,e)=>{return t+e.height},0),a=n-i;a<=0?this.updateRowHeight({rowId:o.id,row:o,height:i,bubble:!0,rowPath:this.pathMap[o.id],shuttle:!0,group:"adjust"}):this.updateRowHeight({rowId:e.id,height:e.height+a,row:e,bubble:!1,shuttle:!0,group:"adjust"})}}if(t.removed&&this.parentCol&&this.parentRow){const t=this.parentCol.subs,e=this.parentRow.height,o=t.reduce((t,e)=>t+e.height,0),n=t[t.length-1],i=n.height+(e-o);i&&this.updateRowHeight({rowId:n.id,row:n,height:i,bubble:!1,shuttle:!0,group:"adjust"})}},onLayoutDragStart(){this.layoutDragStart()},onLayoutDragEnd(){this.layoutDragEnd()},onControlDragStart(){this.controlDragStart()},onControlDragEnd(t){this.controlDragEnd()},onDragChoose(){},findRow(t){const e=this.dataMap[t];return e?e.row:null},getColStyleText(t){const e=t.style.width;return"unset"==e||"auto"==e?"":e+""===e?`width:${e};`:`width:${e}px;`},clearSelectedStyle(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cell";if("cell"==t||"col"==t){const t=this.getDesignContainer().querySelectorAll(".col.selected");t&&t.forEach(t=>{t.classList.remove("selected")})}}}),beforeDestroy(){this.$el.removeEventListener("mousedown",this.onMouseDown)}},Ue=Ge,qe=(o("0015"),Object(st["a"])(Ue,Lt,At,!1,null,null,null)),Je=qe.exports,Xe=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"helper-line",class:{"line-v":"v"===t.type,"line-h":"h"===t.type},style:t.styleText})},Ye=[],Ke={props:{type:{type:String,default:"v"}},computed:{left(){return this.$store.state.helper.left},top(){return this.$store.state.helper.top},styleText(){return"v"==this.type?`left: ${this.left}px;`:"h"==this.type?`top: ${this.top}px;`:void 0}}},Qe=Ke,Ze=(o("d56b"),Object(st["a"])(Qe,Xe,Ye,!1,null,null,null)),to=Ze.exports,eo={name:"design",components:{RowLayout:Je,HelperLine:to,Control:Re},provide(){return{getDesignContainer:()=>this.$refs.designArea,showCtxMenu:this.showCtxMenu,showMutliRowConfirm:this.showMutliRowConfirm}},props:{designData:{type:Array},size:{type:Object}},data(){return{ctxMneuItemHandle:()=>{},ctxMenuData:{isControl:!1,colDeletable:!0},rowData:{rowCount:1,colCount:1},dialogVisible:!1,dialogOkCallback:()=>{}}},computed:Object(Q["a"])({},Object(mt["e"])({showVLine:t=>t.helper.showVLine,showHLine:t=>t.helper.showHLine}),{selectedControlId(){return this.$store.state.selectedControlId},hiddenControls:{get(){return this.$store.state.hiddenControls},set(t){this.$store.commit("setHiddenControls",t)}},colBorderStyle(){return"<style>"+this.$store.getters.colStyleText+"</style>"}}),methods:Object(Q["a"])({},Object(mt["b"])(["setSelectedControl","setSelectedLayout","activeRightTab"]),{onControlClick(t,e,o){this.setSelectedControl({id:t.id}),this.activeRightTab("control")},checkControlMove(t){if(!t.to.classList.contains("design-hidden-area"))return!1},handleFormClick(t){const e=t.target;e.closest(".row")||this.activeRightTab("form")},showMutliRowConfirm(t){this.dialogVisible=!0,this.dialogOkCallback=t},adjustCtxPos(t,e){this.$nextTick(()=>{const o={top:e,left:t},n=this.$refs.ctxMenu.clientWidth,i=this.$refs.ctxMenu.clientHeight;i+e>=window.innerHeight&&(o.top-=i),n+t>=window.innerWidth&&(o.left-=n),this.$refs.ctxMenu.style={top:`${o.top}px`,left:`${o.left}px`}})},showCtxMenu(t,e,o){this.ctxMenuData.isControl=!!e.control,this.ctxMenuData.colDeletable=e.colDeletable,this.ctxMneuItemHandle=o;const n=t.pageX,i=t.pageY;this.$refs.ctxMenu.show({top:i,left:n}),this.adjustCtxPos(n,i)},handleDialogClose(t){this.dialogVisible=!1;const e=this.rowData,o=e.rowCount,n=e.colCount;"ok"==t?this.dialogOkCallback(o,n):this.dialogOkCallback(1,1),this.rowData.rowCount=1,this.rowData.colCount=1}})},oo=eo,no=(o("026d"),o("f1a3"),Object(st["a"])(oo,Et,It,!1,null,null,null)),io=no.exports,ao=function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.selectedCol?o("div",{staticClass:"config-cell"},[o("div",{staticClass:"config-block"},[o("h3",{staticClass:"config-category"},[t._v("\n      对齐\n    ")]),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("对齐")]),o("AlignButton",{attrs:{type:"horizontal"},model:{value:t.textAlign,callback:function(e){t.textAlign=e},expression:"textAlign"}}),o("AlignButton",{attrs:{type:"vertical"},model:{value:t.verticalAlign,callback:function(e){t.verticalAlign=e},expression:"verticalAlign"}})],1)]),o("div",{staticClass:"config-block"},[o("h3",{staticClass:"config-category"},[t._v("\n      边框\n      "),o("el-tooltip",{attrs:{content:"normal"==t.currentView?"切换到详细模式":"切换到简易模式"}},[o("span",{staticClass:"border-config-toggle el-icon-d-arrow-right",on:{click:t.toggleView}})])],1),"normal"==t.currentView?o("div",[o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("线宽")]),o("BorderWidthSelect",{attrs:{"border-color":t.borderColor,"border-style":t.borderStyle},model:{value:t.borderWidth,callback:function(e){t.borderWidth=e},expression:"borderWidth"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("线型")]),o("BorderStyleSelect",{attrs:{"border-width":t.borderWidth,"border-color":t.borderColor,disabled:!t.borderWidth},model:{value:t.borderStyle,callback:function(e){t.borderStyle=e},expression:"borderStyle"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("颜色")]),o("ColorPicker",{model:{value:t.borderColor,callback:function(e){t.borderColor=e},expression:"borderColor"}})],1)]):t._e(),"advance"==t.currentView?o("div",[o("div",{staticClass:"config-block"},[o("h3",{staticClass:"config-category"},[t._v("边框——上")]),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("线宽")]),o("BorderWidthSelect",{attrs:{"border-color":t.border.top.color},model:{value:t.border.top.width,callback:function(e){t.$set(t.border.top,"width",e)},expression:"border.top.width"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("线性")]),o("BorderStyleSelect",{attrs:{"border-color":t.border.top.color,disabled:!t.border.top.width},model:{value:t.border.top.style,callback:function(e){t.$set(t.border.top,"style",e)},expression:"border.top.style"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("颜色")]),o("ColorPicker",{attrs:{disabled:!t.border.top.width},model:{value:t.border.top.color,callback:function(e){t.$set(t.border.top,"color",e)},expression:"border.top.color"}})],1)]),o("div",{staticClass:"config-block"},[o("h3",{staticClass:"config-category"},[t._v("边框——右")]),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("线宽")]),o("BorderWidthSelect",{attrs:{"border-color":t.border.right.color},model:{value:t.border.right.width,callback:function(e){t.$set(t.border.right,"width",e)},expression:"border.right.width"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("线性")]),o("BorderStyleSelect",{attrs:{"border-color":t.border.right.color,disabled:!t.border.right.width},model:{value:t.border.right.style,callback:function(e){t.$set(t.border.right,"style",e)},expression:"border.right.style"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("颜色")]),o("ColorPicker",{attrs:{disabled:!t.border.right.width},model:{value:t.border.right.color,callback:function(e){t.$set(t.border.right,"color",e)},expression:"border.right.color"}})],1)]),o("div",{staticClass:"config-block"},[o("h3",{staticClass:"config-category"},[t._v("边框——下")]),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("线宽")]),o("BorderWidthSelect",{attrs:{"border-color":t.border.bottom.color},model:{value:t.border.bottom.width,callback:function(e){t.$set(t.border.bottom,"width",e)},expression:"border.bottom.width"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("线性")]),o("BorderStyleSelect",{attrs:{"border-color":t.border.bottom.color,disabled:!t.border.bottom.width},model:{value:t.border.bottom.style,callback:function(e){t.$set(t.border.bottom,"style",e)},expression:"border.bottom.style"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("颜色")]),o("ColorPicker",{attrs:{disabled:!t.border.bottom.width},model:{value:t.border.bottom.color,callback:function(e){t.$set(t.border.bottom,"color",e)},expression:"border.bottom.color"}})],1)]),o("div",{staticClass:"config-block"},[o("h3",{staticClass:"config-category"},[t._v("边框——左")]),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("线宽")]),o("BorderWidthSelect",{attrs:{"border-color":t.border.left.color},model:{value:t.border.left.width,callback:function(e){t.$set(t.border.left,"width",e)},expression:"border.left.width"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("线性")]),o("BorderStyleSelect",{attrs:{"border-color":t.border.left.color,disabled:!t.border.left.width},model:{value:t.border.left.style,callback:function(e){t.$set(t.border.left,"style",e)},expression:"border.left.style"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("颜色")]),o("ColorPicker",{attrs:{disabled:!t.border.left.width},model:{value:t.border.left.color,callback:function(e){t.$set(t.border.left,"color",e)},expression:"border.left.color"}})],1)])]):t._e()])]):t._e()},so=[],lo=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"design-button-group align-group",class:t.type,attrs:{"data-value":t.active}},t._l(t.alignList,function(e){return o("el-tooltip",{key:e,attrs:{"open-delay":500,content:t.tipsText[e]}},[o("MyButton",{class:{active:t.active==e},attrs:{icon:"align-"+e},nativeOn:{click:function(o){return t.activeBtn(e)}}})],1)}),1)},ro=[],co=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("span",{staticClass:"design-button"},[t.icon?o("span",{staticClass:"design-button-icon",class:t.icon}):t._e(),t._t("default")],2)},uo=[],ho={name:"design-button",props:{icon:{type:String}}},po=ho,fo=Object(st["a"])(po,co,uo,!1,null,null,null),mo=fo.exports;var go={name:"align-button",components:{MyButton:mo},props:{type:{type:String,default:"horizontal",validator(t){const e=-1!==["horizontal","vertical"].indexOf(t);return e||console.error("type 应为 'horizontal' 或 'vertical'"),e}},value:{type:String,default(){return"horizontal"==this.type?"left":"vertical"==this.type?"middle":void 0}}},computed:{alignList(){return"horizontal"==this.type?["left","center","right"]:"vertical"==this.type?["top","middle","bottom"]:void 0}},data(){return{active:this.value,tipsText:{left:"左对齐",center:"居中对齐",right:"右对齐",top:"顶端对齐",middle:"垂直居中",bottom:"底端对齐"}}},watch:{value(){this.active=this.value},active(t){this.$emit("input",t)}},methods:{activeBtn(t){this.active=t}}},bo=go,vo=Object(st["a"])(bo,lo,ro,!1,null,null,null),yo=vo.exports,Co=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{ref:"colorpicker",staticClass:"color-picker",class:{disabled:t.disabled}},[o("span",{staticClass:"color-picker-toggle",on:{click:function(e){return t.togglePicker()}}},[t._t("default",[o("div",{staticClass:"current-color",style:"background-color: "+t.colorValue},[o("span",{staticClass:"current-color-value"},[t._v(t._s(t.colorValue.toLowerCase()))]),o("label",{staticClass:"current-color-label"},[t._v(t._s(t.label))])])])],2),o("div",{directives:[{name:"show",rawName:"v-show",value:t.displayPicker,expression:"displayPicker"}],ref:"panel",staticClass:"color-picker-panel"},[t.displayPicker?o("Chrome",{staticClass:"color-picker-chrome",attrs:{value:t.colors,disableAlpha:t.disableAlpha},on:{input:t.updateFromPicker}}):t._e()],1)])},wo=[],xo=(o("6b54"),o("a481"),o("c345")),_o={name:"color-picker",components:{Chrome:xo["Chrome"]},props:{value:{type:String,default:""},label:{type:String,default:""},referColor:{type:String,default:""},disabled:{type:Boolean,default:!1}},data(){return{disableAlpha:!0,colors:{hex:"#000000"},colorValue:"",displayPicker:!1}},mounted(){this.setColor(this.value||"#000000"),this.setStyle()},methods:{setStyle(){const t=this.value;if("#"!=t[0])return;const e=[0,1,2].map((e,o)=>{return parseInt(t.substr(2*o+1,2),16)||0}),o=`drop-shadow(2px 2px 6px rgba( ${e.join(",")} ,.15)`;this.$refs.colorpicker.style.setProperty("--color",t),this.$refs.colorpicker.style.setProperty("--dropShadow",o),this.$refs.colorpicker.style.setProperty("--red",e[0]),this.$refs.colorpicker.style.setProperty("--green",e[1]),this.$refs.colorpicker.style.setProperty("--blue",e[2])},isValid(t){return!this.disableAlpha||/^#[0-9a-f]{6}$/i.test(t)},setColor(t){this.updateColors(t),this.colorValue=t},updateColors(t){if("#"==t.slice(0,1))this.colors={hex:t.substr(0,7)};else if("rgba"==t.slice(0,4)){var e=t.replace(/^rgba?\(|\s+|\)$/g,"").split(","),o="#"+((1<<24)+(parseInt(e[0])<<16)+(parseInt(e[1])<<8)+parseInt(e[2])).toString(16).slice(1);this.colors={hex:o,a:e[3]}}},showPicker(){document.addEventListener("click",this.documentClick,!0),this.displayPicker=!0},hidePicker(){document.removeEventListener("click",this.documentClick,!0),this.displayPicker=!1},togglePicker(){this.disabled||(this.displayPicker?this.hidePicker():this.showPicker())},updateFromPicker(t){this.disableAlpha&&(t.rgba.a=1),this.colors=t,1==t.rgba.a?this.colorValue=t.hex:this.colorValue="rgba("+t.rgba.r+", "+t.rgba.g+", "+t.rgba.b+", "+t.rgba.a+")",this.$emit("input",this.colorValue)},documentClick(t){var e=this.$refs.colorpicker,o=this.$refs.panel,n=t.target;e&&(e===n||e.contains(n)||o.contains(n)||this.hidePicker())},adjustPos(){const t=this.$el.getBoundingClientRect();let e=t.top+t.height,o=t.left;const n=this.$refs.panel,i=n.clientHeight,a=n.clientWidth;e+i>=window.innerHeight&&(e=t.top-i),o+a>=window.innerWidth&&(o-=o+a-window.innerWidth),n.style.top=`${e}px`,n.style.left=`${o}px`}},watch:{value(){this.setColor(this.value||"#000000"),this.setStyle()},colorValue(t){t&&(this.updateColors(t),this.setStyle(),this.$emit("input",t))},displayPicker(t){t?this.$nextTick(()=>{document.body.appendChild(this.$refs.panel),this.$refs.panel.style.position="fixed",this.$refs.panel.style.display="block",this.adjustPos()}):(this.$refs.panel.style.display="none",this.$refs.panel.style.top="-99999px",this.$refs.panel.style.left="-99999px")}}},Do=_o,ko=(o("5908"),o("b8b5"),Object(st["a"])(Do,Co,wo,!1,null,null,null)),To=ko.exports,So=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"border-style-select",class:{disabled:t.disabled}},[o("el-select",{staticStyle:{width:"100px"},attrs:{disabled:t.disabled,placeholder:"请选择",size:"small"},model:{value:t.borderStyle,callback:function(e){t.borderStyle=e},expression:"borderStyle"}},t._l(t.borderStyleList,function(e){return o("el-option",{key:e.value,attrs:{label:e.label||e.value,title:e.label||e.value,value:e.value}},[e.value?o("span",{staticClass:"border-style-option",style:"border-top-color:"+t.borderColor+";border-top-width:"+(t.borderWidth||3)+"px;border-top-style:"+e.value+";"}):t._e()])}),1),o("span",{staticClass:"border-style-select-curr",style:t.selectedStyle})],1)},$o=[],Oo={name:"border-style-select",props:["value","borderColor","disabled"],data(){return{borderWidth:4,borderStyle:this.value,borderStyleList:["solid","dashed","dotted","double"].map(t=>{return{value:t}})}},watch:{value(t){t!=this.borderStyle&&(this.borderStyle=t)},borderStyle(t){this.$emit("input",t)}},computed:{selectedStyle(){return`border-top-style:${this.borderStyle};border-top-color:${this.borderColor};border-top-width:${this.borderWidth||3}px;`}}},Eo=Oo,Io=Object(st["a"])(Eo,So,$o,!1,null,null,null),Lo=Io.exports,Ao=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"border-width-select",class:{disabled:t.disabled,none:0==t.borderWidth,normal:0!=t.borderWidth}},[o("el-select",{staticStyle:{width:"100px"},attrs:{disabled:t.disabled,placeholder:"请选择",size:"small"},model:{value:t.borderWidth,callback:function(e){t.borderWidth=e},expression:"borderWidth"}},t._l(t.borderWidthList,function(e){return o("el-option",{key:e.value,attrs:{label:e.label||e.value,value:e.value}},[e.value?o("span",{staticClass:"border-width-select-option",style:t.selectedStyle(e.value),attrs:{title:e.label||e.value}}):t._e(),e.value?t._e():o("span",{staticClass:"border-width-select-option-none",style:"color:"+t.borderColor,attrs:{title:e.label}},[t._v(t._s(e.label))])])}),1),o("span",{staticClass:"border-width-select-curr",style:t.selectedStyle()})],1)},jo=[],Mo={name:"border-width-select",props:["value","borderColor","disabled"],data(){return{borderStyle:"solid",borderWidth:this.value,borderWidthList:[{label:"none",value:0},{value:1},{value:2},{value:3},{value:4},{value:5}]}},watch:{value(t){t!=this.borderWidth&&(this.borderWidth=t)},borderWidth(t){this.$emit("input",t)}},methods:{selectedStyle(t){return void 0===t&&(t=this.borderWidth),`border-top-style:${this.borderStyle};border-top-color:${this.borderColor};border-top-width:${t}px`}}},Ro=Mo,zo=Object(st["a"])(Ro,Ao,jo,!1,null,null,null),Po=zo.exports,Vo={name:"config-cell",components:{AlignButton:yo,ColorPicker:To,BorderStyleSelect:Lo,BorderWidthSelect:Po},props:["selectedCol"],computed:{},data(){return this.getShowData()},methods:Object(Q["a"])({},Object(mt["d"])(["setColBorder","setColStyle"]),Object(mt["b"])(["setColAllBorder"]),{getShowData(){if(!this.selectedCol)return{};const t=Object(gt["d"])(this.selectedCol.style.border),e=t.bottom.width,o=t.bottom.style,n=t.bottom.color;return{textAlign:this.selectedCol.style.textAlign||"left",verticalAlign:this.selectedCol.style.verticalAlign||"middle",border:t,borderWidth:e,borderStyle:o,borderColor:n,currentView:"normal"}},toggleView(){this.currentView="normal"==this.currentView?"advance":"normal"}}),watch:{selectedCol(t,e){if(this.selectedCol){const t=Object(gt["d"])(this.selectedCol.style.border),o=t.bottom.width,n=t.bottom.style,i=t.bottom.color;e?(this.border=t,this.verticalAlign=this.selectedCol.style.verticalAlign,this.textAlign=this.selectedCol.style.textAlign,this.borderWidth=o,this.borderStyle=n,this.borderColor=i):(this.$set(this,"border",t),this.$set(this,"verticalAlign",this.selectedCol.style.verticalAlign),this.$set(this,"textAlign",this.selectedCol.style.textAlign),this.$set(this,"borderWidth",o),this.$set(this,"borderStyle",n),this.$set(this,"borderColor",i))}},border:{deep:!0,handler(t){JSON.stringify(t)!=JSON.stringify(this.selectedCol.style.border)&&this.setColBorder({border:t,selectedCol:this.selectedCol,shuttle:!0})}},borderWidth(t){this.setColAllBorder({prop:"width",value:t})},borderStyle(t){this.setColAllBorder({prop:"style",value:t})},borderColor(t){this.setColAllBorder({prop:"color",value:t})},textAlign(t){t!=this.selectedCol.style.textAlign&&this.setColStyle({prop:"textAlign",value:t,selectedCol:this.selectedCol,shuttle:!0})},verticalAlign(t){t!=this.selectedCol.style.verticalAlign&&this.setColStyle({prop:"verticalAlign",value:t,selectedCol:this.selectedCol,shuttle:!0})}}},Fo=Vo,Bo=Object(st["a"])(Fo,ao,so,!1,null,null,null),No=Bo.exports,Ho=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"config-form"},[o("div",{staticClass:"config-block"},[o("h3",{staticClass:"config-category"},[t._v("\n      全局文字"),o("el-tooltip",{attrs:{placement:"right",content:"将影响所有控件"}},[o("span",{staticClass:"design-help"})])],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("字体")]),o("el-select",{staticClass:"font-set-select",attrs:{size:"small"},model:{value:t.fontFamily,callback:function(e){t.fontFamily=e},expression:"fontFamily"}},t._l(t.fontFamilyList,function(t){return o("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})}),1),o("el-input-number",{staticClass:"font-set-input",attrs:{size:"small",controls:!1,min:12,max:100},model:{value:t.fontSize,callback:function(e){t.fontSize=e},expression:"fontSize"}}),o("span",{staticClass:"form-control-suffix"},[t._v("px")])],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("样式")]),o("FontColor",{staticStyle:{"margin-right":"10px"},model:{value:t.fontColor,callback:function(e){t.fontColor=e},expression:"fontColor"}}),o("div",{staticClass:"design-button-group font-group"},[o("el-tooltip",{attrs:{"open-delay":500,content:"加粗"}},[o("MyButton",{class:{active:t.fontBolder},attrs:{icon:"font-bold"},nativeOn:{click:function(e){t.fontBolder=!t.fontBolder}}})],1),o("el-tooltip",{attrs:{"open-delay":500,content:"倾斜"}},[o("MyButton",{class:{active:t.fontItalic},attrs:{icon:"font-italic"},nativeOn:{click:function(e){t.fontItalic=!t.fontItalic}}})],1),o("el-tooltip",{attrs:{"open-delay":500,content:"下划线"}},[o("MyButton",{class:{active:t.fontUnderline},attrs:{icon:"font-underline"},nativeOn:{click:function(e){t.fontUnderline=!t.fontUnderline}}})],1)],1)],1)]),o("div",{staticClass:"config-block"},[o("h3",{staticClass:"config-category"},[t._v("\n      全局单元格"),o("el-tooltip",{attrs:{placement:"right",content:"将影响所有单元格"}},[o("span",{staticClass:"design-help"})])],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("对齐")]),o("AlignButton",{attrs:{type:"horizontal"},model:{value:t.textAlign,callback:function(e){t.textAlign=e},expression:"textAlign"}}),o("AlignButton",{attrs:{type:"vertical"},model:{value:t.verticalAlign,callback:function(e){t.verticalAlign=e},expression:"verticalAlign"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("高度")]),o("el-input-number",{staticClass:"height-set-input",attrs:{size:"small",controls:!1,min:38,max:2e3},on:{change:t.setHeight},model:{value:t.height,callback:function(e){t.height=e},expression:"height"}}),o("span",{staticClass:"form-control-suffix"},[t._v("px")])],1)]),o("div",{staticClass:"config-block"},[o("h3",{staticClass:"config-category"},[t._v("\n      全局边框"),o("el-tooltip",{attrs:{placement:"right",content:"将影响所有单元格"}},[o("span",{staticClass:"design-help"})])],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("线宽")]),o("BorderWidthSelect",{attrs:{"border-color":t.borderColor,"border-style":t.borderStyle},model:{value:t.borderWidth,callback:function(e){t.borderWidth=e},expression:"borderWidth"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("线性")]),o("BorderStyleSelect",{attrs:{"border-width":t.borderWidth,"border-color":t.borderColor,disabled:!t.borderWidth},model:{value:t.borderStyle,callback:function(e){t.borderStyle=e},expression:"borderStyle"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("颜色")]),o("ColorPicker",{attrs:{disabled:!t.borderWidth},model:{value:t.borderColor,callback:function(e){t.borderColor=e},expression:"borderColor"}})],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("外边框")]),o("AllBorderType",{staticClass:"form-control",attrs:{"border-type":t.allBorderType},on:{active:t.handleBorderTypeChange}})],1)]),o("div",{staticClass:"config-block"},[o("h3",{staticClass:"config-category"},[t._v("控件配置")]),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("label自动冒号")]),o("el-switch",{attrs:{"border-color":t.borderColor,"border-style":t.borderStyle},model:{value:t.autoColons,callback:function(e){t.autoColons=e},expression:"autoColons"}})],1)])])},Wo=[],Go=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("ColorPicker",{model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}},[o("span",{staticClass:"font-color-button design-button"},[o("span",{staticClass:"font-color-holder design-button-icon"}),o("span",{staticClass:"font-current-color",style:"background:"+t.currentValue})])])},Uo=[],qo={name:"control-font-color",props:["value"],components:{ColorPicker:To},data(){return{currentValue:this.value||"#000"}},watch:{value(t){this.currentValue=t},currentValue(t){this.$emit("input",t)}}},Jo=qo,Xo=Object(st["a"])(Jo,Go,Uo,!1,null,null,null),Yo=Xo.exports,Ko=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"form-control-item  form-all-border"},t._l(t.list1,function(e){return o("el-tooltip",{key:e,attrs:{"open-delay":500,placement:"top",content:t.tipsText[e]}},[o("MyButton",{class:{active:e==t.currentType},attrs:{icon:"all-border-"+e},nativeOn:{click:function(o){return t.handleChange(e)}}})],1)}),1),o("div",{staticClass:"form-control-item form-all-border"},t._l(t.list2,function(e){return o("el-tooltip",{key:e,attrs:{"open-delay":500,placement:"top",content:t.tipsText[e]}},[o("MyButton",{class:{active:e==t.currentType},attrs:{icon:"all-border-"+e},nativeOn:{click:function(o){return t.handleChange(e)}}})],1)}),1)])},Qo=[],Zo={name:"form-all-border-config",components:{MyButton:mo},props:{borderType:{type:String,default:"all"}},data(){return{currentType:this.borderType,list1:["all","inner","hline","vline","outer"],list2:["left","top","right","bottom","none"],tipsText:{all:"全部框线",inner:"仅内框线",hline:"仅水平线",vline:"仅垂直线",outer:"仅外边框",left:"仅左框线",top:"仅上框线",right:"仅右框线",bottom:"仅底框线",none:"无框线"}}},methods:{handleChange(t){this.currentType=t,this.$emit("active",t)}},watch:{borderType(t){this.currentType=t}}},tn=Zo,en=Object(st["a"])(tn,Ko,Qo,!1,null,null,null),on=en.exports;const nn=Object(gt["d"])(window.FORM_DESIGN_CONFIG.preset.fontFamilyList);var an={name:"config-form",components:{AlignButton:yo,FontColor:Yo,BorderStyleSelect:Lo,BorderWidthSelect:Po,MyButton:mo,ColorPicker:To,AllBorderType:on},computed:Object(Q["a"])({},Object(mt["e"])(["globalStyle"]),{fontFamilyList(){return nn}}),data(){const t=this.globalStyle||this.$store.state.globalStyle,e=t.border;return{height:t.cellHeight||38,borderWidth:e.top.width||1,borderStyle:e.top.style||"solid",borderColor:e.top.color||"#dddddd",fontSize:t.fontSize,fontFamily:t.fontFamily,fontColor:t.fontColor,fontBolder:t.fontBolder,fontItalic:t.fontItalic,fontUnderline:t.fontUnderline,textAlign:t.textAlign,verticalAlign:t.verticalAlign,autoColons:t.autoColons,allBorderType:t.allBorderType||"all",heightPerset:{selected:"compact",list:[{label:"紧凑",value:"compact"},{label:"2倍",value:40},{label:"50",value:50},{label:"自定义",value:30}]}}},methods:Object(Q["a"])({getData(){const t=this.globalStyle||this.$store.state.globalStyle,e=t.border;return{height:t.cellHeight||38,borderWidth:e.top.width||1,borderStyle:e.top.style||"solid",borderColor:e.top.color||"#dddddd",fontSize:t.fontSize,fontFamily:t.fontFamily,fontColor:t.fontColor,fontBolder:t.fontBolder,fontItalic:t.fontItalic,fontUnderline:t.fontUnderline,textAlign:t.textAlign,verticalAlign:t.verticalAlign,autoColons:t.autoColons}}},Object(mt["b"])({setBorder:"setGlobalBorder",setStyle:"setGlobalStyle"}),{handleChange(t,e){t!==this.globalStyle[e]&&this.setStyle({prop:e,value:t})},setHeight(t){this.$store.dispatch("setAllRowHeight",{height:t})},handleBorderTypeChange(t){this.borderWidth,this.$store.dispatch("setAllBorderType",{type:t,borderWidth:this.borderWidth})}}),watch:{globalStyle(t){const e=t.border;this.height=t.cellHeight||38,this.borderWidth=e.top.width||1,this.borderStyle=e.top.style||"solid",this.borderColor=e.top.color||"#dddddd",this.fontSize=t.fontSize,this.fontFamily=t.fontFamily,this.fontColor=t.fontColor,this.fontBolder=t.fontBolder,this.fontItalic=t.fontItalic,this.fontUnderline=t.fontUnderline,this.textAlign=t.textAlign,this.verticalAlign=t.verticalAlign,this.autoColons=t.autoColons,this.allBorderType=t.allBorderType},borderWidth(t){this.setBorder({prop:"width",value:t})},borderStyle(t){this.setBorder({prop:"style",value:t})},borderColor(t){this.setBorder({prop:"color",value:t})},autoColons(t){this.handleChange(t,"autoColons")},fontSize(t){this.handleChange(t,"fontSize")},fontFamily(t){this.handleChange(t,"fontFamily")},fontColor(t){this.handleChange(t,"fontColor")},fontBolder(t){this.handleChange(t,"fontBolder")},fontItalic(t){this.handleChange(t,"fontItalic")},fontUnderline(t){this.handleChange(t,"fontUnderline")},textAlign(t){this.handleChange(t,"textAlign")},verticalAlign(t){this.handleChange(t,"verticalAlign")}}},sn=an,ln=Object(st["a"])(sn,Ho,Wo,!1,null,null,null),rn=ln.exports,cn=function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.control?o("div",{staticClass:"config-control"},[o("NameConfig",{attrs:{"component-data":t.control,type:t.controlType},on:{change:t.onNameChange,remove:t.removeControl}}),t.supportEvent?o("div",{staticClass:"config-control-tabs"},[o("span",{staticClass:"config-control-tab",class:{active:"attribute"==t.currentView},on:{click:function(e){t.currentView="attribute"}}},[t._v("属性")]),o("span",{staticClass:"config-control-tab",class:{active:"event"==t.currentView},on:{click:function(e){t.currentView="event"}}},[t._v("事件("+t._s(t.eventCount)+")")])]):t._e(),o("div",{staticClass:"config-control-tabcontent",class:{"with-event":t.supportEvent}},["attribute"==t.currentView?o("div",{staticClass:"attribute-block"},t._l(t.controlConfig,function(e,n){return o("div",{key:n,staticClass:"config-block"},[o("h3",{staticClass:"config-category"},[t._v(t._s(e.category))]),t._l(e.items,function(e){return o("div",{key:e.label||e.extends+"",class:{"form-item":!e.extends,"form-extend":!!e.extends}},[t._l(t.getExtends(e.extends),function(e){return o(t.getControlComponent(e),{key:t.control.id+"-"+e,tag:"component",attrs:{"control-data":t.control},on:{change:t.handleExtendChange}})}),e.extends?t._e():o("label",{staticClass:"form-label"},[t._v(t._s(e.label))]),e.extends?t._e():o("div",{staticClass:"form-control"},t._l(e.controls,function(e){return o(t.getControlComponent(e.type),{key:t.control.id+"-"+e.associatedProp,tag:"component",staticClass:"form-control-item",class:e.type,attrs:{config:e,value:t.getControlValue(t.control,e)},on:{change:t.change}})}),1)],2)})],2)}),0):t._e(),"event"==t.currentView?o("div",{staticClass:"event-block"},[o("EventComponent",{attrs:{"control-data":t.control}})],1):t._e()])],1):t._e()},dn=[],un=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"component-name-config config-block"},[o("h3",{staticClass:"component-type config-category"},[t._v(t._s(t.type)+" "),o("span",{staticClass:"remove-component",on:{click:t.onComponentRemove}},[t._v("删除")])]),o("div",{staticClass:"component-name-block"},[o("div",{directives:[{name:"show",rawName:"v-show",value:!t.showEditor,expression:"!showEditor"}],staticClass:"component-name",on:{click:function(e){t.editorValue=t.name,t.showEditor=!0}}},[t._v(t._s(t.name))]),t.showEditor?o("div",[o("div",{staticClass:"el-input el-input--mini",staticStyle:{width:"50%","margin-right":"6px"}},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.editorValue,expression:"editorValue"}],staticClass:"el-input__inner",attrs:{size:"mini"},domProps:{value:t.editorValue},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submitName(e)},input:function(e){e.target.composing||(t.editorValue=e.target.value)}}})]),o("el-button",{attrs:{icon:"el-icon-check",size:"mini",circle:""},on:{click:t.submitName}})],1):t._e()])])},hn=[],pn={name:"name-config",props:["componentData","type"],computed:{},data(){return{name:this.componentData.name||this.getComponentName(),showEditor:!1,editorValue:""}},methods:{getComponentName(){const t=this.componentData,e=t.namePrefix,o=t.autoIndex;return e&&o?`${e}_${o}`:this.type},onComponentRemove(){this.$emit("remove")},change(t){this.$emit("change",t)},submitName(){const t=this.editorValue.trim();t?(this.componentData.name!=t&&(this.name=t,this.change(t)),this.showEditor=!1):this.$message({message:"必须输入组件件名称",type:"error",showClose:!0})}},watch:{"componentData.id"(){this.showEditor=!1,this.name=this.componentData.name||this.getComponentName()}}},fn=pn,mn=(o("d5c7"),Object(st["a"])(fn,un,hn,!1,null,null,null)),gn=mn.exports,bn=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-checkbox",{attrs:{value:t.value},on:{change:t.change}},[t._v(t._s(t.config.text))])},vn=[],yn={name:"control-checkbox",props:{value:{type:Boolean,require:!0},config:{type:Object,require:!0}},methods:{change(t){this.$emit("change",t,this.config)}}},Cn=yn,wn=Object(st["a"])(Cn,bn,vn,!1,null,null,null),xn=wn.exports,_n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-checkbox-group",{class:"direction-"+t.direction,on:{change:t.change},model:{value:t.valueList,callback:function(e){t.valueList=e},expression:"valueList"}},t._l(t.optionList,function(e){return o("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])}),1)},Dn=[],kn=o("da81"),Tn=o.n(kn),Sn={methods:{getOriginData(t,e){if(!t)throw new Error("url is required!");let o;e&&(o=Tn()({},e)),this.loading=!0,this.$httpPost(t,o).then(t=>{const e=[];if(!Array.isArray(t))throw new Error("远程数据必须为数组");return t.forEach(t=>{void 0!==t.id&&void 0!==t.text?e.push(t):console.warn(`id or text is not a valid type! ${JSON.stringify(t)}`)}),this.loading=!1,this.originOptionList=e,e}).catch(t=>{this.loading=!1,console.error(t)})}}};const $n=window.FORM_DESIGN_CONFIG.preset;var On={name:"control-checkboxlist",mixins:[Sn],props:{value:{type:String,require:!0},config:{type:Object,require:!0},styleText:{type:String,default:"width:200px"}},data(){return{valueList:this.getValueList(),loading:!1,originOptionList:[]}},created(){!this.config.data&&this.config.url&&this.getOriginData(this.config.url)},computed:{direction(){return this.config.direction||"horizontal"},optionList(){return this.config.data?this.staticOptionList:this.originOptionList},staticOptionList(){const t=this.config.data;if(!t)return[];if(Array.isArray(t))return t;const e=t+""===t;if(e){if(t in $n)return $n[t];const e=t.replace(/^epointsform\./,"");if(e&&Array.isArray(this.$store.state[e]))return Object(gt["d"])(this.$store.state[e])}return[]}},methods:{getValueList(){return this.value?this.value.split(","):[]},change(t){this.$emit("change",t.join(","),this.config)}}},En=On,In=Object(st["a"])(En,_n,Dn,!1,null,null,null),Ln=In.exports,An=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-select",{style:t.styleText,attrs:{value:t.value,size:"small",filterable:"",clearable:""},on:{change:t.change}},t._l(t.optionList,function(t){return o("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})}),1)},jn=[];const Mn=window.FORM_DESIGN_CONFIG.preset;var Rn={name:"control-combobox",mixins:[Sn],props:{value:{type:String,require:!0},config:{type:Object,require:!0},styleText:{type:String,default:""}},data(){return{loading:!1,originOptionList:[]}},created(){!this.config.data&&this.config.url&&this.getOriginData(this.config.url)},computed:{optionList(){return this.config.data?this.staticOptionList:this.originOptionList},staticOptionList(){const t=this.config.data;if(!t)return[];if(Array.isArray(t))return t;const e=t+""===t;if(e){if(t in Mn)return Mn[t];const e=t.replace(/^epointsform\./,"");if(e&&Array.isArray(this.$store.state[e]))return Object(gt["d"])(this.$store.state[e])}return[]}},methods:{change(t){this.$emit("change",t,this.config)}}},zn=Rn,Pn=Object(st["a"])(zn,An,jn,!1,null,null,null),Vn=Pn.exports,Fn=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{},[o("el-select",{staticStyle:{display:"block"},attrs:{size:"small"},on:{change:t.typeChange},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},t._l(t.typeList,function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})}),1),t.type==t.TYPE_MAP.date?o("el-date-picker",{staticStyle:{"margin-top":"8px"},attrs:{"popper-class":"default-date-popper",type:"datetime",placeholder:"请选择一个日期",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",editable:!1,size:"small"},on:{change:t.dateChange},model:{value:t.selectDate,callback:function(e){t.selectDate=e},expression:"selectDate"}}):t._e()],1)},Bn=[];const Nn="[currDate]",Hn=/^\d{4}-\d{2}-\d{2}/,Wn={empty:"empty",currDate:"currDate",date:"date"};var Gn={name:"control-default-date",props:["config","value"],data(){return Object(Q["a"])({},this.getDataFromValue(this.value),{TYPE_MAP:Wn,typeList:[{id:Wn.empty,text:"留空"},{id:Wn.currDate,text:"填报日期"},{id:Wn.date,text:"指定日期"}]})},methods:{getDataFromValue(t){return t?/^\[.+\]$/.test(t)?{selectDate:"",type:Wn.currDate}:{selectDate:this.getValidDate(t),type:Wn.date}:{selectDate:"",type:Wn.empty}},getValidDate(t){return Hn.test(t)?t:""},typeChange(t){return"empty"==t?this.change(""):"currDate"==t?this.change(Nn):"date"==t&&this.selectDate?this.change(this.selectDate):void 0},dateChange(){"date"==this.type&&this.change(this.selectDate)},change(t){this.$emit("change",t,this.config)}},watch:{value(t){const e=this.getDataFromValue(t);e.type!=this.type&&(this.type=e.type),e.selectDate!=this.selectDate&&(this.selectDate=e.selectDate)}}},Un=Gn,qn=(o("d482"),Object(st["a"])(Un,Fn,Bn,!1,null,null,null)),Jn=qn.exports,Xn=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("el-select",{attrs:{size:"small"},on:{change:t.configTypeChange},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},t._l(t.typeList,function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})}),1),t.type==t.typeMap.select?o("div",{staticStyle:{"margin-top":"8px"}},[o("el-input",{attrs:{placeholder:"请选择",value:t.selectedTypes.join(","),size:"small",readonly:""}},[o("el-button",{attrs:{slot:"append",icon:"el-icon-more"},nativeOn:{click:function(e){return t.showDialog(e)}},slot:"append"})],1)],1):t._e(),t.type==t.typeMap.input?o("div",{staticStyle:{"margin-top":"8px"}},[o("el-input",{attrs:{placeholder:"请输入文件扩展名",size:"small"},on:{change:t.userInputChange},model:{value:t.userInputType,callback:function(e){t.userInputType=e},expression:"userInputType"}}),o("el-tooltip",{attrs:{placement:"top",content:"扩展名不带点，多个逗号分隔"}},[o("span",{staticClass:"design-help"})])],1):t._e(),o("el-dialog",{attrs:{visible:t.dialogVisible,title:"类型选择","append-to-body":""},on:{"update:visible":function(e){t.dialogVisible=e}}},[t.type==t.typeMap.select?o("div",{staticClass:"tree-like"},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.dialogSelectedTypes.length,expression:"dialogSelectedTypes.length"}],staticStyle:{"margin-bottom":"10px"}},t._l(t.dialogSelectedTypes,function(e){return o("el-tag",{key:e,staticStyle:{"margin-right":"4px"},attrs:{size:"mini",closable:""},on:{close:function(o){return t.hanldeRemoveTag(e)}}},[t._v(t._s(e))])}),1),t._l(t.dialogTypeTree,function(e){return o("div",{key:e.id,staticStyle:{"margin-bottom":"10px"}},[o("div",{staticClass:"file-type-category"},[o("el-checkbox",{attrs:{indeterminate:e.halfChecked,label:e.text},on:{change:function(o){return t.cateCheckedChange(o,e)}},model:{value:e.allChecked,callback:function(o){t.$set(e,"allChecked",o)},expression:"cate.allChecked"}})],1),o("el-checkbox-group",{staticClass:"file-type-group",on:{change:function(o){return t.itemCheckedChange(o,e)}},model:{value:e.checkedArr,callback:function(o){t.$set(e,"checkedArr",o)},expression:"cate.checkedArr"}},t._l(e.items,function(t){return o("el-checkbox",{key:t.id,staticClass:"file-type-item",attrs:{label:t.id}})}),1)],1)})],2):t._e(),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:t.submitSelect}},[t._v("确 定")])],1)])],1)},Yn=[];const Kn="[default]",Qn={default:"default",empty:"empty",select:"select",input:"input"};var Zn={name:"control-file-type-picker",props:["config","value"],computed:{selectedTypes(){if(this.type!=this.typeMap.select)return[];const t=[];return this.typeTree.forEach(e=>{e.checkedArr&&e.checkedArr.length&&t.push(...e.checkedArr)}),t},dialogSelectedTypes(){if(this.type!=this.typeMap.select)return[];const t=[];return this.dialogTypeTree.forEach(e=>{e.checkedArr&&e.checkedArr.length&&t.push(...e.checkedArr)}),t}},data(){return{typeMap:Qn,dialogVisible:!1,userInputType:"",type:"",typeList:[{id:"default",text:"系统默认"},{id:"empty",text:"不限制"},{id:"select",text:"选择类型"},{id:"input",text:"手动输入"}],typeTree:this.genderTypeTree(this.value),dialogTypeTree:[]}},created(){this.type=this.getTypeFromValue(this.value),this.syncConfigValue()},methods:{syncConfigValue(){this.type==Qn.default||this.type==Qn.empty?this.userInputType="":this.type==Qn.select?(this.userInputType="",this.typeTree=this.genderTypeTree(this.value)):this.userInputType=this.value},getFileTypeMap(){const t={};return this.typeTree.forEach(e=>{e.valueArr.forEach(e=>{t[e]=!0})}),t},getTypeFromValue(t){if(t==Kn)return Qn.default;if(""==t)return Qn.empty;const e=t.split(","),o=this.getFileTypeMap();for(let n of e)if(!o[n])return Qn.input;return Qn.select},genderTypeTree(t){const e=[],o=Object(gt["d"])(window.FORM_DESIGN_CONFIG.preset["epointsform.fileTypes"]),n=(t||"").split(",");return o.forEach(t=>{t.valueArr=t.items,t.items=this.genderItems(t.valueArr);const o=[];t.valueArr.forEach(t=>{-1!==n.indexOf(t)&&o.push(t)}),t.checkedArr=o,0===t.checkedArr.length?t.allChecked=t.halfChecked=!1:t.checkedArr.length!==t.valueArr.length?(t.allChecked=!1,t.halfChecked=!0):(t.allChecked=!0,t.halfChecked=!1),e.push(t)}),e},genderItems(t){return t.map(t=>{return{id:t,text:t}})},cateCheckedChange(t,e){t?(e.allChecked=!0,e.halfChecked=!1,e.checkedArr.splice(0,e.checkedArr.length,...e.valueArr)):(e.allChecked=!1,e.halfChecked=!1,e.checkedArr.splice(0,e.checkedArr.length))},itemCheckedChange(t,e){t.length==e.items.length?(e.allChecked=!0,e.halfChecked=!1):t.length?(e.allChecked=!1,e.halfChecked=!0):(e.allChecked=!1,e.halfChecked=!1)},hanldeRemoveTag(t){let e;for(let o of this.dialogTypeTree)if(e=o.checkedArr.indexOf(t),-1!==e){o.allChecked=!1,o.checkedArr.splice(e,1),o.halfChecked=0!==o.checkedArr.length&&o.checkedArr.length!=o.valueArr.length;break}},configTypeChange(t){return t==Qn.default?this.change(Kn):t==Qn.empty?this.change(""):t==Qn.input?this.userInputType&&this.change(this.userInputType):t==Qn.select?this.change(this.selectedTypes.join(",")):void 0},userInputChange(t){if(this.type==Qn.input)return this.change(this.userInputType)},change(t){this.$emit("change",t,this.config)},showDialog(){this.dialogTypeTree=Object(gt["d"])(this.typeTree),this.dialogVisible=!0},submitSelect(){this.dialogVisible=!1,this.change(this.dialogSelectedTypes.join(","))}},watch:{selectedTypes(t){},value(){this.type=this.getTypeFromValue(this.value),this.type==Qn.select&&(this.typeTree=this.genderTypeTree(this.value))}}},ti=Zn,ei=(o("2e74"),Object(st["a"])(ti,Xn,Yn,!1,null,null,null)),oi=ei.exports,ni=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-select",{style:t.styleText,attrs:{value:t.value,size:"small",clearable:!1,placeholder:"请选择关联字段",filterable:""},on:{change:t.change}},t._l(t.tables,function(e,n){return o("el-option-group",{key:n,attrs:{label:e.name}},t._l(e.fields,function(i,a){return o("el-option",{key:n+"_"+a,attrs:{disabled:t.selectedFieldMap[i.field],value:i.field,label:e.name+" -> "+i.name}})}),1)}),1)},ii=[],ai={name:"control-form-data-combobox",props:{value:{type:String,require:!0},config:{type:Object,require:!0},styleText:{type:String,default:""}},computed:Object(Q["a"])({controlType(){const t=this.$store.state.selectedControlId;if(t){const e=this.$store.getters.controlDataMap[t];if(e&&e.control)return e.control.type}return null}},Object(mt["c"])(["selectedFieldMap"]),{tables(){const t=this.controlType,e=Object(gt["d"])(this.$store.state.fieldList),o=[];if(e.forEach(e=>{e.fields.forEach(n=>{n.field=e.id+";"+n.field,t&&n.fielddisplaytype==t&&o.push(Object(gt["d"])(n))})}),o.length){const t={name:"相关字段",id:"adapts",fields:o};e.unshift(t)}return e}}),methods:{change(t){this.$emit("change",t,this.config)}}},si=ai,li=Object(st["a"])(si,ni,ii,!1,null,null,null),ri=li.exports,ci=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{class:{suffix:t.config.suffix}},[o("el-input-number",{staticStyle:{"text-align":"left"},style:t.styleText,attrs:{placeholder:t.config.placeholder||"请输入"+(t.config.label||""),size:"small","controls-position":"right",controls:!1},on:{change:t.change},model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}}),t.config.suffix?o("span",{staticClass:"form-control-suffix"},[t._v(t._s(t.config.suffix))]):t._e()],1)},di=[],ui={name:"control-number-textbox",props:{value:{type:[Number,String],default:()=>""},config:{type:Object,require:!0},styleText:{type:String,default:""}},data(){return{currentValue:parseInt(this.value,10)||0}},watch:{value(t){this.currentValue=parseInt(t,10)||0}},methods:{change(t){this.$emit("change",t,this.config)}}},hi=ui,pi=Object(st["a"])(hi,ci,di,!1,null,null,null),fi=pi.exports,mi=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-radio-group",{class:"direction-"+t.direction,on:{change:t.change},model:{value:t.currValue,callback:function(e){t.currValue=e},expression:"currValue"}},t._l(t.optionList,function(e){return o("el-radio",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])}),1)},gi=[];const bi=window.FORM_DESIGN_CONFIG.preset;var vi={name:"control-radio-list",mixins:[Sn],props:{value:{type:String,require:!0},config:{type:Object,require:!0}},data(){return{currValue:this.value,loading:!1,originOptionList:[]}},created(){!this.config.data&&this.config.url&&this.getOriginData(this.config.url)},watch:{value(){this.currValue=this.value}},computed:{direction(){return this.config.direction||"horizontal"},optionList(){return this.config.data?this.staticOptionList:this.originOptionList},staticOptionList(){const t=this.config.data;if(!t)return[];if(Array.isArray(t))return t;const e=t+""===t;return e&&t in bi?bi[t]:[]}},methods:{change(t){this.$emit("change",t,this.config)}}},yi=vi,Ci=Object(st["a"])(yi,mi,gi,!1,null,null,null),wi=Ci.exports,xi=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-switch",{on:{change:t.change},model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}})},_i=[],Di={name:"control-switch",props:{value:{type:Boolean,default:!1},config:{type:Object,require:!0},styleText:{type:String,default:"width:200px"}},data(){return{currentValue:this.value||!1}},watch:{value(t){this.currentValue=t}},methods:{change(t){this.$emit("change",t,this.config)}}},ki=Di,Ti=Object(st["a"])(ki,xi,_i,!1,null,null,null),Si=Ti.exports,$i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{class:{suffix:t.config.suffix}},[o("el-input",{ref:"input",style:t.styleText,attrs:{placeholder:t.config.placeholder||"请输入"+(t.config.label||""),size:"small"},on:{change:t.change},model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}}),t.config.suffix?o("span",{staticClass:"form-control-suffix"},[t._v(t._s(t.config.suffix))]):t._e()],1)},Oi=[],Ei={name:"control-textbox",props:{value:{type:String,default:""},config:{type:Object,require:!0},styleText:{type:String,default:""}},data(){return{currentValue:this.value||""}},watch:{value(t){this.currentValue=t}},methods:{focus(){this.$refs.input.select()},change(t){this.$emit("change",t,this.config)}}},Ii=Ei,Li=Object(st["a"])(Ii,$i,Oi,!1,null,null,null),Ai=Li.exports,ji=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"form-control-item width-set",style:t.styleText},[o("el-select",{staticClass:"width-set-select",attrs:{size:"small"},on:{change:t.typeChange},model:{value:t.currType,callback:function(e){t.currType=e},expression:"currType"}},[o("el-option",{attrs:{label:"百分比",value:"percent"}}),o("el-option",{attrs:{label:"像素",value:"number"}})],1),o("el-input-number",{staticClass:"width-set-input",attrs:{min:t.min,max:t.max,size:"small",controls:!1},on:{change:t.change},model:{value:t.currValue,callback:function(e){t.currValue=e},expression:"currValue"}}),o("span",{staticClass:"form-unit form-control-suffix"},[t._v(t._s("percent"==this.currType?"%":"px"))])],1)},Mi=[],Ri={name:"control-width-set",props:{value:{type:[String,Number],require:!0},config:{type:Object,require:!0},styleText:{type:String,default:""}},data(){const t=this.getAdaptedData(this.value);return Object(Q["a"])({min:1},t)},watch:{value(){const t=this.getAdaptedData(this.value);this.currType=t.currType,this.currValue=t.currValue,this.max=t.max}},methods:{getAdaptedData(t){const e=t+""===t,o=parseInt(t,10)||100;return{currType:e?"percent":"number",currValue:e?Math.min(100,o):o,max:e?100:1/0}},typeChange(){this.change(this.currValue)},change(t){const e="percent"==this.currType?t+"%":t;this.$emit("change",e,this.config)}}},zi=Ri,Pi=Object(st["a"])(zi,ji,Mi,!1,null,null,null),Vi=Pi.exports,Fi=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"preset-align"},[o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("对齐")]),o("AlignButton",{attrs:{type:"horizontal"},model:{value:t.textAlign,callback:function(e){t.textAlign=e},expression:"textAlign"}})],1)])},Bi=[],Ni={name:"extend-font-align",components:{AlignButton:yo},props:["controlData"],data(){return{textAlign:this.controlData.textAlign}},watch:{"controlData.textAlign"(t){this.textAlign=t},textAlign(t){t!=this.controlData.textAlign&&this.$emit("change",t,"textAlign")}}},Hi=Ni,Wi=Object(st["a"])(Hi,Fi,Bi,!1,null,null,null),Gi=Wi.exports,Ui=function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.controlData.popup?o("div",{staticClass:"extend-buttonedit-field"},[o("div",{staticClass:"form-item"},[o("div",{staticClass:"form-label"},[t._v("值字段")]),o("div",{staticClass:"form-control"},[o("el-select",{attrs:{size:"small"},model:{value:t.idField,callback:function(e){t.idField=e},expression:"idField"}},t._l(t.list,function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})}),1)],1)]),o("div",{staticClass:"form-item"},[o("div",{staticClass:"form-label"},[t._v("显示字段")]),o("div",{staticClass:"form-control"},[o("el-select",{attrs:{size:"small"},model:{value:t.textField,callback:function(e){t.textField=e},expression:"textField"}},t._l(t.list,function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})}),1)],1)])]):t._e()},qi=[];const Ji={};function Xi(t,e,o){const n=t+o;return Ji[n]||(Ji[n]=Object(gt["i"])(t,e).catch(t=>{Ji[n]=null,delete Ji[n],console.error(t)})),Ji[n]}var Yi=Xi,Ki={name:"extend-buttonedit-field",props:["controlData"],data(){return{list:[],idField:this.controlData.idField||"",textField:this.controlData.textField||""}},mounted(){this.controlData.popup&&this.getList(this.controlData.popup)},methods:{getList(t){Yi(window.formDesignerActions.getListStructUrl,{listGuid:t},"buttoneditStruct-"+t).then(t=>{if(!Array.isArray(t.ListStruct))throw new TypeError("列表必须为数组");this.list=t.ListStruct,this.checkIn(this.idField,"id",this.list)||(this.idField=""),this.checkIn(this.textField,"id",this.list)||(this.textField="")}).catch(t=>{this.list=[],this.idField=this.textField="",this.console.error(t)})},checkIn(t,e,o){for(let n of o)if(n[e]==t)return!0;return!1},change(t,e){this.$emit("change",t,e)}},watch:{"controlData.popup"(t){t?this.getList(t):(this.list=[],this.idField=this.textField="")},idField(t){t!=this.controlData.idField&&this.change(t,"idField")},textField(t){t!=this.controlData.textField&&this.change(t,"textField")}}},Qi=Ki,Zi=Object(st["a"])(Qi,Ui,qi,!1,null,null,null),ta=Zi.exports,ea=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"preset-data-action",class:{disabled:t.hasAutoCodeItem}},[t.hasAutoCodeItem?o("div",{staticClass:"tips"},[o("i",{staticClass:"el-icon-info",staticStyle:{color:"#409EFF"}}),t._v(" 选中的关联字段已经有对应数据源了")]):t._e(),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("配置方式")]),o("div",{staticClass:"form-control"},[o("el-radio-group",{attrs:{disabled:t.hasAutoCodeItem},model:{value:t.sourceType,callback:function(e){t.sourceType=e},expression:"sourceType"}},t._l(t.sourceList,function(e){return o("el-radio",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])}),1)],1)]),o("div",{directives:[{name:"show",rawName:"v-show",value:"static"==t.sourceType,expression:"sourceType == 'static'"}],staticClass:"form-item"},[o("el-form",{ref:"dataActionForm",attrs:{model:t.customData,inline:!0,disabled:t.hasAutoCodeItem}},t._l(t.customData,function(e,n){return o("div",{key:n,staticClass:"data-source-item"},[o("el-form-item",{staticClass:"data-source-input value",attrs:{prop:n+".id",rules:t.rules.id}},[o("el-input",{attrs:{placeholder:"值",size:"mini"},model:{value:e.id,callback:function(o){t.$set(e,"id",o)},expression:"item.id"}})],1),o("el-form-item",{staticClass:"data-source-input text",attrs:{prop:n+".text",rules:t.rules.text}},[o("el-input",{attrs:{placeholder:"显示名称",size:"mini"},model:{value:e.text,callback:function(o){t.$set(e,"text",o)},expression:"item.text"}})],1),o("el-button",{staticClass:"data-source-item-btn del",attrs:{type:"danger",plain:"",size:"mini",icon:"el-icon-delete"},on:{click:function(e){return t.deleteItem(n)}}}),o("el-button",{staticClass:"data-source-item-btn up",attrs:{size:"mini",icon:"el-icon-caret-top",disabled:"0"==n},on:{click:function(e){return t.moveUp(n)}}}),o("el-button",{staticClass:"data-source-item-btn down",attrs:{size:"mini",icon:"el-icon-caret-bottom",disabled:n==t.customData.length-1},on:{click:function(e){return t.moveDown(n)}}})],1)}),0),o("el-button",{attrs:{icon:"el-icon-plus",size:"mini"},on:{click:t.addItem}},[t._v("添加选项")]),o("el-button",{attrs:{disabled:!t.customData.length,icon:"el-icon-save",size:"mini"},on:{click:t.applyItem}},[t._v("应用")])],1),o("div",{directives:[{name:"show",rawName:"v-show",value:"action"==t.sourceType,expression:"sourceType == 'action'"}],staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("远程数据源")]),o("div",{staticClass:"form-control"},[o("el-select",{attrs:{placeholder:"请选择远程数据源",disabled:t.hasAutoCodeItem,size:"small",filterable:""},on:{change:t.onActionChange},model:{value:t.selectedAction,callback:function(e){t.selectedAction=e},expression:"selectedAction"}},t._l(t.actionList,function(t){return o("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})}),1)],1)])])},oa=[],na={name:"extend-data-action",props:["controlData"],components:{},data(){const t=this.controlData,e=t.data,o=t.codeItem,n=Array.isArray(e);return{sourceType:n?"static":"action",sourceList:[{id:"static",text:"自定义"},{id:"action",text:"远程"}],customData:n?Object(gt["d"])(e):[],selectedAction:o||"",rules:{id:[{validator:this.validateId,trigger:"blur"}],text:[{required:!0,message:"必须输入显示名称",trigger:"blur"}]}}},computed:Object(Q["a"])({},Object(mt["e"])(["fieldList"]),{hasAutoCodeItem(){return!1},actionList(){return Object(gt["d"])(this.$store.state.codeList)}}),methods:{validateId(t,e,o){if(!e)return o(new Error("必填"));const n=this.customData[t.field.split(".")[0]];return this.checkDuplicated(e,n)?o(new Error("值必须唯一")):o()},checkDuplicated(t,e){for(let o of this.customData)if(o!==e&&t==o.id)return!0;return!1},addItem(){if(this.customData.length)return this.$refs.dataActionForm.validate(t=>{t?this.customData.push({id:"",text:""}):this.$message({message:"请先处理当前内容",customClass:"data-action-error-box",type:"error"})});this.customData.push({id:"",text:""})},deleteItem(t){this.customData.splice(t,1)},applyItem(){this.$refs.dataActionForm.validate((t,e)=>{let o;o=t?Object(gt["d"])(this.customData):Object(gt["d"])(this.customData.filter((t,o)=>{return!(o+".id"in e||o+".text"in e)})),Array.isArray(o)&&this.useStaticData(o)})},moveUp(t){if(0===t)return;const e=this.customData.splice(t,1)[0];this.customData.splice(t-1,0,e)},moveDown(t){if(t===this.customData.length-1)return;const e=this.customData.splice(t,1)[0];this.customData.splice(t+1,0,e)},onActionChange(t){this.useAction(t)},useStaticData(t){let e;this.controlData.codeItem&&(e="dataaction"+ +new Date,this.$emit("change","","codeItem",e)),this.$emit("change",t,"data",e)},useAction(t){let e;this.controlData.data&&(e="dataaction"+ +new Date,this.$emit("change","","data",e)),this.$emit("change",t,"codeItem",e)}},watch:{sourceType(t){"action"==t&&this.useAction(this.selectedAction)},controlData:{deep:!0,handler(){const t=this.controlData,e=t.data,o=t.codeItem;Array.isArray(e)?(this.customData=Object(gt["d"])(e),this.sourceType="static"):this.sourceType="action",o&&(this.selectedAction=o)}}}},ia=na,aa=(o("25cd"),Object(st["a"])(ia,ea,oa,!1,null,null,null)),sa=aa.exports,la=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"extend-daterange-config"},[o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("日期范围")]),o("div",{staticClass:"form-control"},[o("el-select",{attrs:{size:"small"},on:{change:t.onRangeTypeChange},model:{value:t.rangeType,callback:function(e){t.rangeType=e},expression:"rangeType"}},t._l(t.rangeTypeList,function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})}),1)],1)]),"range"==t.rangeType?o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("开始")]),o("div",{staticClass:"form-control"},[o("el-select",{staticClass:"form-control-item",attrs:{size:"small"},on:{change:function(e){return t.selectedChange(e,"start")}},model:{value:t.selectedValue1,callback:function(e){t.selectedValue1=e},expression:"selectedValue1"}},[o("el-option",{attrs:{value:"static",label:"选择固定日期"}}),t._l(t.controlList,function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})],2),t.selectedValue1==t.typeMap.static?o("el-date-picker",{staticClass:"form-control-item",attrs:{"picker-options":t.startPickerOptions,"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择开始日期",size:"small"},on:{change:function(e){return t.onDateChange("start")}},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}}):t._e()],1)]):t._e(),"range"==t.rangeType?o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("结束")]),o("div",{staticClass:"form-control"},[o("el-select",{staticClass:"form-control-item",attrs:{size:"small"},on:{change:function(e){return t.selectedChange(e,"end")}},model:{value:t.selectedValue2,callback:function(e){t.selectedValue2=e},expression:"selectedValue2"}},[o("el-option",{attrs:{value:"static",label:"选择固定日期"}}),t._l(t.controlList,function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})],2),t.selectedValue2==t.typeMap.static?o("el-date-picker",{staticClass:"form-control-item",attrs:{"picker-options":t.endPickerOptions,"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择结束日期",size:"small"},on:{change:function(e){return t.onDateChange("end")}},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}}):t._e()],1)]):t._e()])},ra=[];const ca=/^\d{4}-\d{2}-\d{2}$/,da=/^\{.+\}$/;var ua={name:"extend-daterange-config",props:["controlData"],components:{},computed:{startType(){return this.getLimitType(this.controlData.minDate)},endType(){return this.getLimitType(this.controlData.maxDate)},controlList(){const t=/datepicker/i,e=this.$store.state.hiddenControls,o=this.$store.getters.allControls,n=[];return o.forEach(e=>{t.test(e.type)&&e.id!=this.controlData.id&&n.push({type:e.type,id:e.id,name:e.name||e.namePrefix+"_"+e.autoIndex})}),e.forEach(t=>{n.push({type:t.type,id:t.id,name:t.name||t.namePrefix+"_"+t.autoIndex})}),n}},data(){return Object(Q["a"])({rangeType:this.getRangeType(this.controlData.minDate,this.controlData.maxDate),rangeTypeList:[{id:"empty",text:"留空"},{id:"range",text:"指定范围"}]},this.getDateFromControl(this.controlData),{typeMap:{static:"static",control:"control"},startPickerOptions:{disabledDate:t=>{return!!this.endDate&&t.getTime()>new Date(this.endDate).getTime()}},endPickerOptions:{disabledDate:t=>{return!!this.startDate&&t.getTime()<new Date(this.startDate).getTime()}}})},methods:{getDateFromControl(t){let e="",o="",n="",i="";return t.minDate&&(da.test(t.minDate)?e=t.minDate.substring(1,t.minDate.length-1):ca.test(t.minDate)?(e="static",n=t.minDate):console.error("日期不合法： "+t.minDate)),t.maxDate&&(da.test(t.maxDate)?o=t.maxDate.substring(1,t.maxDate.length-1):ca.test(t.maxDate)?(o="static",i=t.maxDate):console.error("日期不合法： "+t.maxDate)),{selectedValue1:e,selectedValue2:o,startDate:n,endDate:i}},getRangeType(t,e){return!t&&!e||""==t&&""==e?"empty":"range"},getLimitType(t){return t&&""!=t?ca.test(t)?this.typeMap.static:this.typeMap.control:this.typeMap.static},onRangeTypeChange(t){"empty"==t?this.clearRange():(this.startDate&&this.onDateChange("start"),this.endDate&&this.onDateChange("end"))},clearRange(){""!=this.controlData.minDate&&this.$emit("change","","minDate"),""!=this.controlData.maxDate&&this.$emit("change","","maxDate")},selectedChange(t,e){if(t!=this.typeMap.static)t&&this.$emit("change",`{${t}}`,"start"==e?"minDate":"maxDate");else{const t="start"==e?this.startDate:this.endDate;t&&this.$emit("change",t,"start"==e?"minDate":"maxDate")}},onDateChange(t){"range"==this.rangeType&&("start"==t&&this.startType==this.typeMap.static&&this.$emit("change",this.startDate,"minDate"),"end"==t&&this.endType==this.typeMap.static&&this.$emit("change",this.endDate,"maxDate"))}}},ha=ua,pa=Object(st["a"])(ha,la,ra,!1,null,null,null),fa=pa.exports,ma=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"preset-font"},[o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("字体")]),o("el-select",{staticClass:"font-set-select",attrs:{size:"small"},model:{value:t.fontFamily,callback:function(e){t.fontFamily=e},expression:"fontFamily"}},t._l(t.fontFamilyList,function(t){return o("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})}),1),o("el-input-number",{staticClass:"font-set-input",attrs:{size:"small",controls:!1,min:12,max:100},model:{value:t.fontSize,callback:function(e){t.fontSize=e},expression:"fontSize"}}),o("span",{staticClass:"form-control-suffix"},[t._v("px")])],1),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("样式")]),o("FontColor",{staticStyle:{"margin-right":"10px"},model:{value:t.fontColor,callback:function(e){t.fontColor=e},expression:"fontColor"}}),o("div",{staticClass:"design-button-group font-group"},[o("el-tooltip",{attrs:{"open-delay":500,content:"加粗"}},[o("MyButton",{class:{active:t.fontBolder},attrs:{icon:"font-bold"},nativeOn:{click:function(e){t.fontBolder=!t.fontBolder}}})],1),o("el-tooltip",{attrs:{"open-delay":500,content:"倾斜"}},[o("MyButton",{class:{active:t.fontItalic},attrs:{icon:"font-italic"},nativeOn:{click:function(e){t.fontItalic=!t.fontItalic}}})],1),o("el-tooltip",{attrs:{"open-delay":500,content:"下划线"}},[o("MyButton",{class:{active:t.fontUnderline},attrs:{icon:"font-underline"},nativeOn:{click:function(e){t.fontUnderline=!t.fontUnderline}}})],1)],1)],1)])},ga=[];const ba=window.FORM_DESIGN_CONFIG.preset.fontFamilyList;var va={name:"extend-font-config",props:["controlData"],components:{FontColor:Yo,MyButton:mo},data(){return{fontFamilyList:JSON.parse(JSON.stringify(ba)),fontFamily:this.controlData.fontFamily,fontSize:this.controlData.fontSize,fontColor:this.controlData.fontColor,fontBolder:this.controlData.fontBolder,fontItalic:this.controlData.fontItalic,fontUnderline:this.controlData.fontUnderline}},methods:{handleChange(t,e){this.controlData[e]!=t&&this.$emit("change",t,e)}},watch:{controlData:{deep:!0,handler(){const t=this.controlData,e=t.fontFamily,o=t.fontSize,n=t.fontColor,i=t.fontBolder,a=t.fontItalic,s=t.fontUnderline;this.fontFamily=e,this.fontSize=o,this.fontColor=n,this.fontBolder=i,this.fontItalic=a,this.fontUnderline=s}},fontFamily(t){this.handleChange(t,"fontFamily")},fontSize(t){this.handleChange(t,"fontSize")},fontColor(t){this.handleChange(t,"fontColor")},fontBolder(t){this.handleChange(t,"fontBolder")},fontItalic(t){this.handleChange(t,"fontItalic")},fontUnderline(t){this.handleChange(t,"fontUnderline")}}},ya=va,Ca=Object(st["a"])(ya,ma,ga,!1,null,null,null),wa=Ca.exports,xa=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"frozen-column"},[o("div",{staticClass:"form-item"},[o("div",{staticClass:"form-control "},[o("el-checkbox",{on:{change:t.onSwitch},model:{value:t.isFrozen,callback:function(e){t.isFrozen=e},expression:"isFrozen"}},[t._v("冻结列")])],1)]),t.isFrozen?o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("冻结列索引")]),o("div",{staticClass:"form-control "},[o("el-input-number",{attrs:{min:0,max:t.columnLength-2,size:"mini",controls:!1},on:{change:t.change},model:{value:t.frozenIndex,callback:function(e){t.frozenIndex=e},expression:"frozenIndex"}})],1)]):t._e()])},_a=[],Da={name:"extend-frozen-column",props:["controlData"],computed:{columnLength(){const t=this.controlData.specialColumns.split(",").length,e=this.controlData.columns.length||4;return t+e}},data(){const t=parseInt(this.controlData.frozenColumnIndex,10);return{isFrozen:-1!==t,frozenIndex:t}},methods:{change(t){this.controlData.frozenIndex!=t&&this.$emit("change",t,"frozenColumnIndex")},onSwitch(t){t?this.$nextTick(()=>{this.change(this.frozenIndex)}):this.$emit("change",-1,"frozenColumnIndex")}},watch:{"controlData.frozenColumnIndex"(t){const e=parseInt(t,10);this.frozenIndex=e,this.isFrozen=-1!==e}}},ka=Da,Ta=Object(st["a"])(ka,xa,_a,!1,null,null,null),Sa=Ta.exports,$a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"extend-range-validate"},[o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v(t._s(t.validateTextMap[t.validateType]))]),o("div",{staticClass:"form-control"},[o("el-switch",{on:{change:t.change},model:{value:t.showRangeValidate,callback:function(e){t.showRangeValidate=e},expression:"showRangeValidate"}})],1)]),t.showRangeValidate?o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("值")]),o("div",{staticClass:"form-control"},[o("el-select",{staticClass:"range-validate-operation",attrs:{size:"small"},on:{change:t.change},model:{value:t.operation1,callback:function(e){t.operation1=e},expression:"operation1"}},t._l(t.operationList,function(t){return o("el-option",{key:t,attrs:{value:t,label:t}})}),1),o("el-select",{staticClass:"range-validate-value",attrs:{size:"small"},on:{change:t.change},model:{value:t.selectedValue1,callback:function(e){t.selectedValue1=e},expression:"selectedValue1"}},[o("el-option",{attrs:{value:"static",label:"输入固定值"}}),t._l(t.controlList,function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})],2),"static"==t.selectedValue1?o("el-input",{staticClass:"range-validate-input",attrs:{placeholder:"请输入",size:"small"},on:{change:t.change},model:{value:t.operationValue1,callback:function(e){t.operationValue1=e},expression:"operationValue1"}}):t._e(),o("span",{directives:[{name:"show",rawName:"v-show",value:!t.showExt,expression:"!showExt"}],staticClass:"ext-btn el-icon-plus",on:{click:t.showCondition2}})],1)]):t._e(),t.showRangeValidate?o("div",{directives:[{name:"show",rawName:"v-show",value:t.showExt,expression:"showExt"}],staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("且")]),o("div",{staticClass:"form-control"},[o("el-select",{staticClass:"range-validate-operation",attrs:{size:"small"},on:{change:t.change},model:{value:t.operation2,callback:function(e){t.operation2=e},expression:"operation2"}},t._l(t.operationList,function(t){return o("el-option",{key:t,attrs:{value:t,label:t}})}),1),o("el-select",{staticClass:"range-validate-value",attrs:{size:"small"},on:{change:t.change},model:{value:t.selectedValue2,callback:function(e){t.selectedValue2=e},expression:"selectedValue2"}},[o("el-option",{attrs:{value:"static",label:"输入固定值"}}),t._l(t.controlList,function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})],2),"static"==t.selectedValue2?o("el-input",{staticClass:"range-validate-input",attrs:{placeholder:"请输入",size:"small"},on:{change:t.change},model:{value:t.operationValue2,callback:function(e){t.operationValue2=e},expression:"operationValue2"}}):t._e(),o("span",{staticClass:"ext-btn el-icon-delete",on:{click:t.hideCondition2}})],1)]):t._e()])},Oa=[],Ea=(o("55dd"),{name:"extend-range-validate",props:["controlData"],data(){return Object(Q["a"])({validateTextMap:{string:"文本值比较",number:"数值比较"}},this.getCompentValueFromControl(this.controlData))},computed:{controlList(){const t=/textbox|textarea|radiobuttonlist|combobox|macro|treeselect/i,e=this.$store.state.hiddenControls,o=this.$store.getters.allControls,n=[];return o.forEach(e=>{t.test(e.type)&&e.id!=this.controlData.id&&n.push({type:e.type,id:e.id,name:e.name||e.namePrefix+"_"+e.autoIndex})}),e.forEach(t=>{n.push({type:t.type,id:t.id,name:t.name||t.namePrefix+"_"+t.autoIndex})}),n.sort((t,e)=>{return t.type==e.type?0:"textbox"==e.type&&"textbox"!=t.type||"hiddenfield"==e.type&&"hiddenfield"!=t.type?1:-1}),n},inputType(){const t=this.controlData.vtype;return"int"==t||"float"==t?"number":"string"},operationList(){return"number"==this.inputType?["<","<=","==",">",">="]:["=="]},condition1Done(){return!(!this.operation1||!this.selectedValue1)&&!("static"==this.selectedValue1&&!this.operationValue1)},condition2Done(){return!(!this.operation2||!this.selectedValue2)&&!("static"==this.selectedValue2&&!this.operationValue2)}},methods:{getCompentValueFromControl(t){let e=!1,o=!1,n="",i="",a="",s="",l="",r="",c="";const d=(t||this.controlData).vtype,u=(t||this.controlData).rangeValidator,h=u&&u.conditions;if(n="int"==d||"float"==d?"number":"string",h&&h.length){if(e=!0,h[0]){i=h[0].operation;const t=this.getOperationInfo(h[0].value);s=t.type,r=t.value}else i="string"==n?"==":"<=",r=s="";if(h[1]){a=h[1].operation;const t=this.getOperationInfo(h[1].value);l=t.type,c=t.value,o=!0}else a="string"==n?"==":">=",c=l="",o=!1}return{showRangeValidate:e,showExt:o,validateType:n,operation1:i,operation2:a,selectedValue1:s,selectedValue2:l,operationValue1:r,operationValue2:c}},getOperationInfo(t){if(/^\{.+\}$/.test(t)){const e=t.substring(1,t.length-1);return{type:e,value:""}}return{type:"static",value:t}},showCondition2(){if(!this.condition1Done)return this.$message({type:"error",message:"请先填好当前条件"});this.showExt=!0,this.change()},hideCondition2(){this.showExt=!1,this.operation2="string"==this.validateType?"==":">=",this.operationValue2=this.selectedValue2="",this.change()},getSubmitValue(){const t={type:this.validateType,conditions:[]};return this.condition1Done&&t.conditions.push({operation:this.operation1,value:"static"==this.selectedValue1?this.operationValue1:`{${this.selectedValue1}}`}),this.showExt&&this.condition2Done&&t.conditions.push({operation:this.operation2,value:"static"==this.selectedValue2?this.operationValue2:`{${this.selectedValue2}}`}),t},change(){let t=this.getSubmitValue();this.showRangeValidate&&t&&t.conditions&&t.conditions.length||(t=null),this.$emit("change",t,"rangeValidator")}},watch:{"controlData.vtype"(){const t=this.getCompentValueFromControl(this.controlData),e=t.showRangeValidate,o=t.showExt,n=t.validateType,i=t.operation1,a=t.operation2,s=t.selectedValue1,l=t.selectedValue2,r=t.operationValue1,c=t.operationValue2;this.showRangeValidate=e,this.showExt=o,this.validateType=n,this.operation1=i,this.operation2=a,this.selectedValue1=s,this.selectedValue2=l,this.operationValue1=r,this.operationValue2=c}}}),Ia=Ea,La=Object(st["a"])(Ia,$a,Oa,!1,null,null,null),Aa=La.exports,ja=function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.showFormSelect?o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("编辑页地址")]),o("div",{staticClass:"form-control"},[o("el-select",{staticClass:"form-control-item",attrs:{size:"mini"},on:{change:t.change},model:{value:t.selectedFormId,callback:function(e){t.selectedFormId=e},expression:"selectedFormId"}},t._l(t.formList,function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})}),1)],1)]):t._e()},Ma=[],Ra={name:"extend-sub-table-edit-form",props:["controlData"],computed:{showFormSelect(){return"dialog"==this.controlData.editType},tableId(){return this.controlData.sourceTable}},data(){return{selectedFormId:this.controlData.editFormGuid||"",formList:[]}},mounted(){this.getForms()},methods:{getForms(){if(!this.tableId)return this.formList=[];Yi(window.formDesignerActions.getSubTableInfoUrl,{tableId:this.tableId},"subTableData-"+this.tableId).then(t=>{const e=t.SubTableForm;if(!Array.isArray(e))throw new Error("获取编辑表单失败");this.formList=e.map(t=>{return{id:t.formGuid,text:t.formName}})}).catch(t=>{console.error(t)})},change(t){this.$emit("change",t,"editFormGuid")}},watch:{tableId(){this.showFormSelect&&this.getForms()},"controlData.editFormGuid"(t){this.selectedFormId=t}}},za=Ra,Pa=Object(st["a"])(za,ja,Ma,!1,null,null,null),Va=Pa.exports,Fa=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"extend-sub-table-fields"},[o("div",{staticClass:"form-item"},[o("el-button",{attrs:{disabled:!t.tableId,size:"mini"},on:{click:function(e){t.showDialog=!0}}},[t._v("点击配置")])],1),o("el-dialog",{staticClass:"column-config-dialog",attrs:{"append-to-body":"",title:"表格字段配置",visible:t.showDialog,"before-close":t.handleClose,width:t.showEditor?"80%":"50%"},on:{"update:visible":function(e){t.showDialog=e}}},[t.showDialog?o("div",[o("div",{staticClass:"column-config-header"},[o("div",{staticClass:"span display"},[t._v("显示")]),o("div",{staticClass:"span move"},[t._v("排序")]),o("div",{staticClass:"span name"},[t._v("名称")]),t.showEditor?o("div",{staticClass:"span editor"},[t._v("编辑类型")]):t._e(),t.showEditor?o("div",{staticClass:"span required"},[t._v("必填")]):t._e(),o("div",{staticClass:"span align"},[t._v("对齐方式")]),o("div",{staticClass:"span width"},[t._v("列宽(px)")]),t.showEditor?o("div",{staticClass:"span vtype"},[t._v("格式校验")]):t._e()]),o("div",{staticClass:"column-config-list"},[o("draggable",{attrs:{list:t.columns,handle:".move",direction:"vertical"},on:{start:function(e){t.drag=!0},end:function(e){t.drag=!1},change:t.change}},t._l(t.columns,function(e){return o("column-config",{key:e.field,attrs:{field:e,showEditor:t.showEditor},on:{change:t.change}})}),1)],1)]):t._e(),o("span",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.save}},[t._v("确 定")]),o("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.beforeClose()}}},[t._v("取 消")])],1)])],1)},Ba=[],Na=o("1980"),Ha=o.n(Na),Wa=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"column-config-item"},[o("div",{staticClass:"span display"},[o("el-checkbox",{on:{change:function(e){return t.change("display",t.field.display)}},model:{value:t.field.display,callback:function(e){t.$set(t.field,"display",e)},expression:"field.display"}})],1),t._m(0),o("div",{staticClass:"span name"},[o("el-input",{attrs:{size:"mini"},on:{change:function(e){return t.change("name",t.field.name)}},model:{value:t.field.name,callback:function(e){t.$set(t.field,"name",e)},expression:"field.name"}})],1),t.showEditor?o("div",{staticClass:"span editor"},[o("el-select",{attrs:{size:"mini"},on:{change:function(e){return t.change("controlType",t.field.controlType)}},model:{value:t.field.controlType,callback:function(e){t.$set(t.field,"controlType",e)},expression:"field.controlType"}},t._l(t.controlTypes,function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})}),1)],1):t._e(),t.showEditor?o("div",{staticClass:"span required"},[o("el-checkbox",{on:{change:function(e){return t.change("required",t.field.required)}},model:{value:t.field.required,callback:function(e){t.$set(t.field,"required",e)},expression:"field.required"}})],1):t._e(),o("div",{staticClass:"span align"},[o("AlignButton",{attrs:{type:"horizontal"},on:{change:function(e){return t.change("align",t.field.align)}},model:{value:t.field.align,callback:function(e){t.$set(t.field,"align",e)},expression:"field.align"}})],1),o("div",{staticClass:"span width"},[o("el-input-number",{attrs:{size:"mini",controls:!1},on:{change:function(e){return t.change("width",t.field.width)}},model:{value:t.field.width,callback:function(e){t.$set(t.field,"width",e)},expression:"field.width"}})],1),t.showEditor?o("div",{staticClass:"span vtype"},[o("el-select",{attrs:{size:"mini",disabled:"textbox"!=t.field.controlType},on:{change:function(e){return t.change("vtype",t.field.vtype)}},model:{value:t.field.vtype,callback:function(e){t.$set(t.field,"vtype",e)},expression:"field.vtype"}},t._l(t.vtypeList,function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})}),1)],1):t._e()])},Ga=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"span move"},[o("span",{staticClass:"sort-handle el-icon-rank",staticStyle:{cursor:"move"}})])}],Ua={name:"column-config",components:{AlignButton:yo},props:["field","showEditor"],computed:{},data(){return{vtypeList:Object(gt["d"])(window.FORM_DESIGN_CONFIG.preset["epointsform.validateTypes"]),controlTypes:Object(gt["d"])(window.FORM_DESIGN_CONFIG.preset["epointsform.columnEditors"])}},methods:{change(t,e){this.$emit("change",t,e)}}},qa=Ua,Ja=Object(st["a"])(qa,Wa,Ga,!1,null,null,null),Xa=Ja.exports;const Ya={width:100,align:"center",required:!1,controlType:"",vtype:""};var Ka={name:"extend-sub-table-fields",components:{ColumnConfig:Xa,draggable:Ha.a},props:["controlData"],computed:{tableId(){return this.controlData.sourceTable},fieldMap(){const t={};return this.fieldList.forEach(e=>{t[e.field]=e}),t},showEditor(){return"dialog"!=this.controlData.editType}},mounted(){this.getFields()},data(){return{fieldList:[],columns:[],showDialog:!1,loading:!1,drag:!1,dataChanged:!1}},methods:{getConfigColumns(){if(!this.fieldList.length)return void(this.columns=[]);const t=this.controlData.columns||[];if(t.length){const e=[],o={};t.forEach(t=>{this.fieldMap[t.field]&&(o[t.field]=!0,e.push(Tn()({},Ya,t)))}),this.fieldList.forEach(t=>{o[t.field]||e.push(Tn()({},Ya,t))}),this.columns=e}else this.columns=this.fieldList.map(t=>{const e=Tn()({},Ya,t);return e.display=!0,e})},getRealColumns(){if(!this.columns.length)return[];const t=Object(gt["d"])(this.columns).filter(t=>t.display);return t.forEach(t=>{t.controlType&&"textbox"!=t.controlType&&(t.vtype="")}),t},change(){this.dataChanged=!0},beforeClose(t){this.dataChanged?this.$confirm("确认不保存直接关闭？").then(()=>{t?t():this.showDialog=!1}).catch(t=>{console.error(t)}):this.showDialog=!1},handleClose(t){this.beforeClose(t)},getFields(){if(!this.tableId)return this.fieldList=[];this.loading=!0,Yi(window.formDesignerActions.getSubTableInfoUrl,{tableId:this.tableId},"subTableData-"+this.tableId).then(t=>{const e=t.SubTableStruct;if(!Array.isArray(e))throw new Error("获取子表字段失败");e.forEach(t=>{t.required=1==parseInt(t.required,10)}),this.fieldList=e}).catch(t=>{console.error(t),this.loading=!1})},save(){const t=this.getRealColumns();this.$emit("change",t,"columns"),this.showDialog=!1}},watch:{tableId(){this.getFields()},fieldList(){this.getConfigColumns()},showDialog(t){t||(this.dataChanged=!1)}}},Qa=Ka,Za=(o("f5bd"),Object(st["a"])(Qa,Fa,Ba,!1,null,null,null)),ts=Za.exports;const es={checkbox:xn,checkboxlist:Ln,combobox:Vn,defaultdate:Jn,filetypepicker:oi,fontcolor:Yo,formdatacombobox:ri,numbertextbox:fi,radiobuttonlist:wi,switch:Si,textbox:Ai,widthconfig:Vi,"extend-alignconfig":Gi,"extend-buttoneditfield":ta,"extend-dataaction":sa,"extend-daterangeconfig":fa,"extend-fontconfig":wa,"extend-frozencolumn":Sa,"extend-rangevalidate":Aa,"extend-subtableeditform":Va,"extend-subtablefields":ts},os={name:"default-control-component",inheritAttrs:!1,props:["config","value","controlData"],template:'<div>{{controlData ? "配置功能" : config.type}} 开发中...</div>'};var ns=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{},[o("el-dropdown",{staticClass:"add-event-drop",attrs:{size:"small",trigger:"click",placement:"bottom-start"},on:{command:t.addEvent}},[o("div",{staticClass:"add-event-drop-trigger"},[o("span",{staticClass:"el-icon-plus add-event-icon"}),t._v("添加事件")]),o("el-dropdown-menu",{staticClass:"add-event-dropmenu",attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.eventTypeList,function(e){return o("el-dropdown-item",{key:e.type,attrs:{command:e.type}},[t._v(t._s(e.name))])}),1)],1),t.eventList.length?o("div",{},t._l(t.controlData.events,function(e,n){return o("div",{key:n},t._l(e,function(e,i){return o("EventCard",{key:e.type+"-"+i,attrs:{"event-data":e,"target-name-map":t.targetNameMap},on:{"edit-event":function(e){return t.editEvent(n,i)},"remove-event":function(e){return t.removeEvent(n,i)},"remove-action":function(e){var o=arguments.length,a=Array(o);while(o--)a[o]=arguments[o];return t.removeEventAction.apply(void 0,[n,i].concat(a))}}})}),1)}),0):t._e(),o("el-dialog",{staticClass:"event-config-dialog",attrs:{width:"800px",visible:t.dialogVisible,title:"add"==t.configData.editType?"新增事件":"修改事件","close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":t.cancel,"append-to-body":""}},[t.dialogVisible?o("EventConfig",{attrs:{"control-data":t.controlData,"target-name-map":t.targetNameMap,"edit-type":t.configData.editType,"default-event-type":t.configData.eventType,"event-description":t.configData.evData,"event-type-list":t.eventTypeList},on:{save:t.saveEvent,cancel:t.cancel}}):t._e()],1)],1)},is=[],as=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"event-config"},[o("div",{staticClass:"event-config-header"},[o("el-select",{staticClass:"event-config-typeselect",attrs:{size:"small",disabled:!t.eventTypeChangeable||!t.eventTypeList.length||1==t.eventTypeList.length},on:{change:t.onEventTypeChanged},model:{value:t.eventType,callback:function(e){t.eventType=e},expression:"eventType"}},t._l(t.eventTypeList,function(t){return o("el-option",{key:t.type,attrs:{value:t.type,label:t.name}})}),1),o("div",{directives:[{name:"show",rawName:"v-show",value:t.showCondition,expression:"showCondition"}],staticClass:"event-config-condition"},[t._v("\n      当满足 This\n      "),o("el-select",{staticClass:"event-operation",attrs:{size:"small"},model:{value:t.condition.operation,callback:function(e){t.$set(t.condition,"operation",e)},expression:"condition.operation"}},t._l(t.operationList,function(e){return o("el-option",{key:e,attrs:{value:e,label:t.operationNames[e]}})}),1),o("el-select",{attrs:{size:"small"},model:{value:t.condition.target,callback:function(e){t.$set(t.condition,"target",e)},expression:"condition.target"}},t._l(t.controlDataList,function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.text||t.id}})}),1)],1)],1),o("div",{staticClass:"event-config-body"},[o("div",{staticClass:"event-config-lane choice"},[o("h3",{staticClass:"event-config-title"},[t._v("选择动作")]),t.eventConfigMap[t.eventType]?o("div",{staticClass:"event-config-list choice"},t._l(t.eventConfigMap[t.eventType].actionList,function(e){return o("div",{key:e.type,staticClass:"choice-action-item",class:{disabled:t.selectedActions[e.type]},on:{click:function(o){return t.addAction(e.type)}}},[t._v(t._s(e.name))])}),0):t._e()]),o("div",{staticClass:"event-config-lane action-config"},[o("h3",{staticClass:"event-config-title"},[t._v("组织动作")]),t.actions.length?o("div",{staticClass:"event-config-list"},t._l(t.actions,function(e,n){return o("div",{key:e.type,staticClass:"action-item"},[o("h4",{staticClass:"action-header",class:{active:e.type==t.currentAction,collaspe:e.collaspe},on:{click:function(o){t.currentAction=e.type}}},[o("span",{staticClass:"el-icon-arrow-down action-toggle",on:{click:function(t){t.stopPropagation(),e.targets.length&&(e.collaspe=!e.collaspe)}}}),o("span",{staticClass:"action-name"},[t._v(t._s(e.name))]),o("span",{staticClass:"action-remove el-icon-close",on:{click:function(o){return o.stopPropagation(),t.removeAction(n,e.type==t.currentAction)}}})]),e.targets.length?o("div",{staticClass:"action-targets",style:"height:"+30*e.targets.length+"px"},t._l(e.targets,function(e){return o("div",{key:e.id},[t._v("\n              "+t._s(t.targetNameMap[e.id])+" "),e.setValueField?o("span",[t._v(t._s(t.fieldNameMap[e.setValueField]))]):t._e()])}),0):o("span",[t._v("请在右侧为动作选择目标")])])}),0):o("span",[t._v("请先从左侧添加动作")])]),o("div",{staticClass:"event-config-lane targets"},[o("h3",{staticClass:"event-config-title"},[t._v("\n        对象目标 "+t._s(t.currentActionName)+"\n        "),"assignment"==t.currentAction?o("div",[o("div",{staticClass:"event-config-target-table"},[o("label",[t._v("赋值来源数据表：")]),o("el-select",{staticStyle:{float:"right","margin-right":"10px"},attrs:{size:"mini",filterable:""},on:{change:t.onTargetTableChange},model:{value:t.targetTable,callback:function(e){t.targetTable=e},expression:"targetTable"}},t._l(t.dataTables,function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})}),1)],1),"assignment"==t.currentAction?o("div",{staticClass:"event-config-target-tablefield"},[o("label",[t._v("数据查询字段：")]),o("el-select",{staticStyle:{float:"right","margin-right":"10px"},attrs:{size:"mini",filterable:""},model:{value:t.targetTableField,callback:function(e){t.targetTableField=e},expression:"targetTableField"}},t._l(t.fieldList,function(t){return o("el-option",{key:t.id,attrs:{value:t.id,label:t.text}})}),1)],1):t._e()]):t._e()]),t.currentAction?o("TargetDisplay",{staticClass:"event-config-list",class:{table:"assignment"==t.currentAction,tablefield:"assignment"==t.currentAction},attrs:{type:t.treeDisplayType,"default-targets":t.currentActionTargets,"action-type":t.currentAction,"field-list":t.fieldList,"field-name-map":t.fieldNameMap,"except-id":t.controlData.id},on:{"ckecked-change":t.handeTargetChange}}):o("span",[t._v("请先选择动作")])],1)]),o("div",{staticClass:"event-config-footer"},[o("el-checkbox",{model:{value:t.runAtInit,callback:function(e){t.runAtInit=e},expression:"runAtInit"}},[t._v("初始化执行")]),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.save}},[t._v("保存")]),o("el-button",{attrs:{size:"mini"},on:{click:t.cancel}},[t._v("取消")])],1)])},ss=[];const ls={valuechanged:{name:"值变更",originType:"valuechanged",actions:["assignment"]},"valuechanged:compare":{name:"值变更(关系比较)",originType:"valuechanged",actions:["show","hide","assignment","clear"]},"valuechanged:getcodelist":{name:"值变更(获取代码项)",originType:"valuechanged",actions:["setData"]}},rs={show:{name:"显示"},hide:{name:"隐藏"},assignment:{name:"赋值"},clear:{name:"清空"},setData:{name:"数据源设置"}},cs=(Object.keys(rs).map(t=>{return rs[t].type=t,rs}),Object.keys(ls).map(t=>{return ls[t].type=t,ls[t].actionList=ls[t].actions.map(t=>{return rs[t]}),ls[t]})),ds={"<=":"小于等于","<":"小于","!=":"不等于","==":"等于",">":"大于",">=":"大于等于"};var us={name:"event-config",components:{TargetDisplay:()=>o.e("chunk-5a3568d5").then(o.bind(null,"22f8"))},props:{editType:{type:String,required:!0,validator(t){return/^(?:add|edit)$/.test(t)}},defaultEventType:{type:String,required:!0},eventTypeList:{type:Array,default:()=>cs},controlData:{type:Object},eventDescription:[Object,null],targetNameMap:{type:Object}},computed:{eventTypeChangeable(){return"add"==this.editType},dataTables(){return this.$store.state.dataTables},selectedActions(){const t={};return this.actions.forEach(e=>{t[e.type]=!0}),t},showCondition(){return"valuechanged:compare"==this.eventType},treeDisplayType(){return/^(?:show|hide|clear)$/.test(this.currentAction)?"all":"assignment"==this.currentAction?"controls":"setData"==this.currentAction?"combobox":""},currentActionName(){const t=this.actionInfo[this.currentAction];return t?`(${t.name})`:""},currentActionTargets(){for(let t of this.actions)if(t.type==this.currentAction)return t.targets||[];return[]},fieldNameMap(){const t={};return this.fieldList.forEach(e=>{t[e.id]=e.text}),t}},data(){return{actionInfo:rs,eventType:this.defaultEventType,eventConfigMap:ls,condition:{operation:"==",target:""},operationList:["==","!="],operationNames:ds,actions:[],currentAction:"",runAtInit:!1,targetTable:"",targetTableField:"",fieldList:[],controlDataList:[]}},created(){this.getFieldList(),this.getControlDataList(),"edit"==this.editType&&this.setEditEventData()},mounted(){"add"==this.editType&&1==this.eventConfigMap[this.eventType].actionList.length&&this.addAction(this.eventConfigMap[this.eventType].actionList[0].type)},methods:{setEditEventData(){const t=Object(gt["d"])(this.eventDescription),e=t.type,o=t.runAtInit,n=t.conditions,i=t.actions;this.eventType=e,n&&n.length&&(this.condition.operation=n[0].operation,this.condition.target=n[0].target),Array.isArray(i)?(this.actions=i.map(t=>{return"assignment"==t.type&&(this.targetTable=t.sourceTableId,this.targetTableField=t.sourceTableField||""),Object(Q["a"])({},t,{name:rs[t.type].name,collaspe:!1})}),this.currentAction=this.actions[0].type):(this.actions.length&&(this.actions=[]),this.currentAction=""),this.runAtInit=o},getFieldList(){if(!this.targetTable)return this.fieldList=[];Xi(window.formDesignerActions.getTableFieldsUrl,{tableId:this.targetTable},"targerTable-"+this.targetTable).then(t=>{const e=t.TableStruct;Array.isArray(e)?this.fieldList=e:this.fieldList=[]}).catch(t=>{console.error(t)})},getControlDataList(){if(this.controlDataList=[],this.showCondition)return this.controlData.data?this.controlDataList=Object(gt["d"])(this.controlData.data):this.$httpPost(window.formDesignerActions.getControlDataListUrl,{controlData:this.controlData}).then(t=>{if(!Array.isArray(t))throw new Error("获取控件数据出错!");this.controlDataList=t}).catch(t=>{console.error(t)})},addAction(t){this.selectedActions[t]||(this.actions.push(this.createAction(t)),this.currentAction=t)},createAction(t){const e=rs[t].name,o={type:t,name:e,targets:[],collaspe:!1};return o},removeAction(t,e){this.actions.splice(t,1),e&&(this.currentAction="")},handeTargetChange(t){const e=this.actions.filter(t=>t.type==this.currentAction)[0];e?e.targets=t:console.error("目标动作不存在")},onEventTypeChanged(){this.actions=[],this.currentAction=""},validate(){return new Promise((t,e)=>{const o=[];!this.showCondition||this.condition.operation&&this.condition.target||o.push({type:"condition",message:"事件条件未填写完整"}),this.actions.length?this.actions.forEach(t=>{t.targets&&t.targets.length||o.push({type:"action",target:t,message:`【${t.name}】动作未配置任何操作目标！`}),"assignment"==t.type&&(this.targetTable||o.push({type:"targetTable",message:"赋值必须选择数据来源表"}),this.targetTableField||o.push({type:"targetTableField",message:"必须选择查询字段"}),t.targets.forEach(e=>{e.setValueField||o.push({type:"target",message:`【${t.name}】动作下的 ${e.nodeName} 控件未配置赋值字段！！`})}))}):o.push({type:"action",message:"还未配置任何事件动作！"}),o.length?e(o):t()})},save(){return this.validate().then(()=>{this._doSave()}).catch(t=>{if(Array.isArray(t)){let e;console.error(t),e=1==t.length?t[0].message:"事件配置信息不完整，请检查",this.$message({message:e,type:"error",customClass:"event-config-error",showClose:!0})}else console.error(t)})},_doSave(){const t={type:this.eventType,originType:ls[this.eventType].originType,runAtInit:this.runAtInit};this.showCondition&&(t.conditions=[Object(gt["d"])(this.condition)]),t.actions=this.actions.map(t=>{const e={type:t.type,targets:t.targets.map(t=>{const e={type:t.nodeType||t.type,id:t.id};return t.setValueField&&(e.setValueField=t.setValueField),e})};return"assignment"==t.type&&(e.sourceTableId=this.targetTable,e.sourceTableField=this.targetTableField),e}),JSON.stringify(t,0,2),this.$emit("save",this.eventType,t)},cancel(){this.$emit("cancel")},clearBindValueField(){const t=this.actions.filter(t=>"assignment"==t.type)[0];t.sourceTableField="",t&&t.targets&&t.targets.forEach(t=>{t.setValueField=""})},onTargetTableChange(){this.clearBindValueField()}},watch:{targetTable(){this.fieldList=[],this.getFieldList()},showCondition(t){t&&this.getControlDataList()}}},hs=us,ps=(o("165c"),Object(st["a"])(hs,as,ss,!1,null,null,null)),fs=ps.exports,ms=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"event-card"},[o("div",{staticClass:"event-card-header"},[o("span",{staticClass:"el-icon-arrow-down event-card-toggle"}),o("span",{staticClass:"event-name"},[t._v(t._s(t.eventInfo[t.eventData.type].name))]),o("span",{staticClass:"event-card-config"},[o("span",{staticClass:"el-icon-setting event-card-setting",on:{click:t.editEvent}}),o("span",{staticClass:"el-icon-delete event-card-delete",on:{click:t.removeEvent}})])]),t.eventData.conditions&&t.eventData.conditions.length?o("div",{staticClass:"event-card-condition"},[t._v("当满足 This "+t._s(t.operationNames[t.eventData.conditions[0].operation])+" "+t._s(t.eventData.conditions[0].target)+" 时")]):t._e(),o("div",{staticClass:"event-card-actions"},t._l(t.eventData.actions,function(e,n){return o("div",{key:e.type,staticClass:"event-card-action"},[o("span",{staticClass:"event-card-action-remove el-icon-close",on:{click:function(o){return t.removeAction(e.type,n,1==t.eventData.actions.length)}}}),o("div",{staticClass:"event-card-action-name"},[t._v(t._s(t.actionInfo[e.type].name))]),o("div",{staticClass:"event-card-action-targets"},t._l(e.targets,function(e){return o("div",{key:e.id,staticClass:"event-card-action-target"},[t._v("\n          "+t._s(t.targetNameMap[e.id])+" "),e.setValueField?o("span",{staticStyle:{"margin-left":"10px"}},[t._v("[ "+t._s(e.setValueField)+" ]")]):t._e()])}),0)])}),0),t.eventData.runAtInit?o("div",{staticClass:"event-card-init"},[o("span",{staticClass:"el-icon-s-flag"}),t._v(" 初始化时执行")]):t._e()])},gs=[],bs={name:"event-card",components:{},props:{eventData:{type:Object},targetNameMap:{type:Object}},data(){return{eventInfo:ls,actionInfo:rs,operationNames:ds}},methods:{removeAction(t,e,o){this.$confirm(o?"此事件下仅有此一个动作，将删除事件，是否继续？":"确认移除此此事件动作？").then(()=>{this.$emit("remove-action",t,e)}).catch(()=>{})},editEvent(){this.$emit("edit-event")},removeEvent(){this.$confirm("确认移除此事件？").then(()=>{this.$emit("remove-event")}).catch(()=>{})}}},vs=bs,ys=(o("b020"),Object(st["a"])(vs,ms,gs,!1,null,null,null)),Cs=ys.exports;const ws={add:"add",edit:"edit"};var xs={name:"event",components:{EventConfig:fs,EventCard:Cs},props:["controlData"],computed:{eventTypeList(){const t=this.controlData.type,e=window.FORM_DESIGN_CONFIG.controls[t].supportEvents;return cs.filter(t=>-1!=e.indexOf(t.type))},eventList(){const t=this.controlData.events;if(t){const e=[];return Object.keys(t).forEach(o=>{e.push(...t[o])}),e}return[]},targetNameMap(){const t=this.$store.getters.controlNameMap,e=this.$store.getters.allRows,o={};return e.forEach(t=>{o[t.id]=t.name||`${t.namePrefix}_${t.autoIndex}`}),Object(Q["a"])({},t,o)}},data(){return{dialogVisible:!1,configData:{editType:ws.add,eventType:"",evData:null,editingIndex:-1,editingType:""}}},methods:Object(Q["a"])({},Object(mt["b"])(["setControlProp"]),{addEvent(t){this.configData.eventType=t,this.configData.editType=ws.add,this.configData.evData=null,this.dialogVisible=!0},editEvent(t,e){this.configData.eventType=t,this.configData.editType=ws.edit,this.configData.evData=this.controlData.events[t][e],this.configData.editingIndex=e,this.configData.editingType=t,this.dialogVisible=!0},saveEvent(t,e){const o=this.controlData.events?Object(gt["d"])(this.controlData.events):{};if(this.configData.editType==ws.add)o[t]?o[t].push(e):o[t]=[e];else{const t=this.configData,n=t.editingType,i=t.editingIndex;n&&-1!=i?o[n][i]=e:console.error("修改事件发生错误！")}this.setControlProp({prop:"events",value:o,control:this.controlData}),this.dialogVisible=!1},saveEditEvent(){},cancel(){this.dialogVisible=!1},removeEvent(t,e){const o=this.controlData.events;JSON.stringify(o[t][e],0,2);const n=Object(gt["d"])(o);1==n[t].length?delete n[t]:n[t].splice(e,1),JSON.stringify(n,0,2),this.setControlProp({prop:"events",value:n,control:this.controlData})},removeEventAction(t,e,o,n){if(void 0===n)return console.error("无法删除，错误的动作索引："+n);const i=this.controlData.events;JSON.stringify(i[t][e].actions[n],0,2);const a=Object(gt["d"])(i);let s=a[t][e];s.actions&&s.actions.length?(s.actions.splice(n,1),s.actions.length||(s=null,1==a[t].length?delete a[t]:a[t].splice(e,1)),JSON.stringify(a,0,2),this.setControlProp({prop:"events",value:a,control:this.controlData})):console.error("无法删除")}})},_s=xs,Ds=(o("ec83"),Object(st["a"])(_s,ns,is,!1,null,null,null)),ks=Ds.exports,Ts={name:"config-control",components:{NameConfig:gn,EventComponent:ks},props:["control"],computed:Object(Q["a"])({},Object(mt["c"])(["controlType2nameMap"]),{controlType(){const t=this.control.type;return this.controlType2nameMap[t]},controlConfig(){const t=this.control.type,e=window.FORM_DESIGN_CONFIG.controls[t];return e?Object(gt["d"])(e.configItems):(console.error(`${t} 类型控件的配置不存在，请检查！！！`),[])},supportEvent(){const t=this.control.type,e=window.FORM_DESIGN_CONFIG.controls[t].supportEvents;return e&&e.length},eventCount(){if(!this.supportEvent)return 0;const t=this.control.events;return t?Object.keys(t).map(e=>t[e].length).reduce((t,e)=>t+e,0):0}}),created(){this.$bus.$on("cntrolClick",this.labelTextAutoFocus),document.addEventListener("keyup",this.deleteShortcurKey)},beforeDestroy(){this.$bus.$off("cntrolClick"),document.removeEventListener("keyup",this.deleteShortcurKey)},data(){return{currentView:"attribute"}},methods:{deleteShortcurKey(t){46===t.which&&this.$store.state.selectedControlId&&this.removeControl()},removeControl(){this.$store.dispatch("deleteControl")},onNameChange(t){this.$store.dispatch("setControlProp",{value:t,prop:"name",control:this.control})},labelTextAutoFocus(){this.$nextTick(()=>{if("title"==this.control.type||"label"==this.control.type)try{this.$children[1].focus()}catch(t){console.error(t)}})},getControlValue(t,e){return/\./.test(e.associatedProp)?Object(gt["g"])(t,e.associatedProp):t[e.associatedProp]},change(t,e,o){this.$store.dispatch("setControlProp",{value:t,prop:e.associatedProp,control:this.control,group:o})},getExtends(t){return t?t+""===t?[("extend-"+t).toLowerCase()]:t.map(t=>("extend-"+t).toLowerCase()):[]},handleExtendChange(t,e,o){this.$store.dispatch("setControlProp",{value:t,prop:e,control:this.control,group:o})},getControlComponent(t){const e=t.toLowerCase();return e in es?es[e]:os}},watch:{"control.id"(){this.currentView="attribute"}}},Ss=Ts,$s=Object(st["a"])(Ss,cn,dn,!1,null,null,null),Os=$s.exports,Es=function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.rowId?o("div",{staticClass:"config-row"},[o("NameConfig",{attrs:{"component-data":t.row,type:t.rowType},on:{change:t.onNameChange,remove:t.removeRow}}),t._m(0)],1):t._e()},Is=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"config-control-tabcontent"},[o("div",{staticClass:"config-block"},[o("h3",{staticClass:"config-category"}),o("div",{staticClass:"form-item"},[o("label",{staticClass:"form-label"},[t._v("行")]),o("div",{staticClass:"form-control"})])])])}],Ls={name:"config-row",props:["rowId"],components:{NameConfig:gn},computed:{row(){const t=this.rowId;return this.$store.getters.rowDataMap[t].row},rowType(){return this.row.namePrefix||this.row.name}},mounted(){document.addEventListener("keyup",this.deleteShortcurKey)},beforeDestroy(){document.removeEventListener("keyup",this.deleteShortcurKey)},methods:{deleteShortcurKey(t){46===t.which&&this.rowId&&this.removeRow()},onNameChange(t){this.$store.dispatch("setLayoutProp",{value:t,prop:"name"})},removeRow(){const t=this.isEmptyRow(this.row);return t?this.doRemoveRow():this.$confirm("此操作将移除此行，以及此行内的所有内容，是否确认？"," 删除提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.doRemoveRow()}).catch(()=>{})},doRemoveRow(){const t=this.$store.getters.selectedLayoutData,e=t.index,o=t.layout,n=this.$store.getters.selectedRowParentCol;-1!=e&&o?this.$store.dispatch("deleteRow",{parentCol:n,row:o,index:e}):console.error("出现错误 无法删除")},isEmptyRow(t){for(let e of t.cols)if(e.subs.length||e.controls.length)return!1;return!0}}},As=Ls,js=Object(st["a"])(As,Es,Is,!1,null,null,null),Ms=js.exports,Rs=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("span",{staticClass:"form-shuttle-btns"},[o("el-tooltip",{attrs:{"open-delay":200,content:t.canUndo?"撤销":"无可撤销的操作"}},[o("el-button",{attrs:{size:"mini",type:"primary",icon:"form-icon-undo",disabled:!t.canUndo},on:{click:t.undo}})],1),o("el-tooltip",{attrs:{"open-delay":200,content:t.canRedo?"还原":"无可还原的操作"}},[o("el-button",{attrs:{size:"mini",type:"primary",icon:"form-icon-redo",disabled:!t.canRedo},on:{click:t.redo}})],1)],1)},zs=[];let Ps=null;const Vs=(t=>{const e={};return t.forEach(t=>{e[t]=!0}),e})(["activeRightTab","updateLineTop","updateLineLeft","showHLine","hideHLine","showVLine","hideVLine","layoutDragStart","layoutDragEnd","controlDragStart","controlDragEnd","setJsCode","setCssCode"]),Fs=(t=>{const e={};return t.forEach(t=>{e[t]=!0}),e})(["updateRowHeight","updateColWidth"]);var Bs={name:"shuttle",data(){return{history:[],future:[]}},mounted(){document.addEventListener("keyup",this.initShortcutKey)},beforeDestroy(){document.removeEventListener("keyup",this.initShortcutKey)},computed:{canUndo(){return this.history.length},canRedo(){return this.future.length}},methods:{init(){window.shuttleManager=this,this.subscribeStore()},subscribeStore(){Ps=JSON.stringify(this.$store.state);const t=(t,e)=>{const o=t.type;t.payload&&t.payload.shuttle&&this.storeState(o,Ps,t.payload.group),Ps=JSON.stringify(e)},e=Pe()(t,300,{leading:!0,trailing:!1});this.$store.subscribe((o,n)=>{const i=o.type;Vs[i]||(Fs[i]?e(o,n):t(o,n))})},addHistory(t){if(t.group){let e=-1;for(let o=0,n=this.history.length;o<n;o++){if(this.history[o].group!=t.group)break;e=o}-1===e&&this.history.unshift(t)}else this.history.unshift(t);this.history.length>10&&(this.history.length=10)},addFuture(t){this.future.unshift(t),this.future.length>10&&(this.future.length=10)},storeState(t,e,o){const n={name:t,state:e,group:o};this.addHistory(n),this.future=[]},undo(){if(!this.canUndo)return;const t={name:"undo",state:JSON.stringify(this.$store.state)};this.addFuture(t);const e=this.history.shift();this.shuttle(e.state),Ps=JSON.stringify(this.$store.state)},redo(){if(!this.canRedo)return;const t={name:"undo",state:JSON.stringify(this.$store.state)};this.addHistory(t);const e=this.future.shift();this.shuttle(e.state),Ps=JSON.stringify(this.$store.state)},shuttle(t){const e=JSON.parse(t);e.helper.showVLine=!1,e.helper.showHLine=!1,e.helper.inControlDragging=!1,e.helper.inLayoutDragging=!1,this.$store.replaceState(e)},initShortcutKey(t){t.ctrlKey&&90==t.which?this.undo():t.ctrlKey&&89==t.which&&this.redo()}}},Ns=Bs,Hs=(o("aeeb"),Object(st["a"])(Ns,Rs,zs,!1,null,null,null)),Ws=Hs.exports,Gs=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"editor-wrap"},[o("div",{staticClass:"editor-toolbar"},[o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.handleDialogClose("save")}}},[t._v("保存")]),o("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.handleDialogClose("cancel")}}},[t._v("取 消")]),o("el-tooltip",{attrs:{"open-delay":200,content:"格式化"}},[o("el-button",{attrs:{size:"mini",icon:"el-icon-s-grid"},on:{click:t.format}})],1),o("el-tooltip",{attrs:{"open-delay":200,content:"搜索替换"}},[o("el-button",{attrs:{size:"mini",icon:"el-icon-search"},on:{click:t.search}})],1)],1),o("div",{staticClass:"editor-main"},[o("div",{ref:"editorEl",staticClass:"editor-el",class:{"with-right":"javascript"==t.language}}),"javascript"==t.language?o("div",{staticClass:"editor-right"},[o("Accordion",{attrs:{title:"控件"}},[o("ul",{staticClass:"control-list"},t._l(t.controlList,function(e){return o("li",{key:e.id,on:{click:function(o){return t.addControl(e.id)}}},[t._v(t._s(e.name))])}),0)]),o("Accordion",{attrs:{title:"常用值"}},[o("ul",{staticClass:"control-list"},t._l(t.valueList,function(e){return o("li",{key:e.id,on:{click:function(o){return t.addValue(e.id)}}},[t._v(t._s(e.text))])}),0)])],1):t._e()])])},Us=[],qs=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"accordion"},[o("div",{staticClass:"accordion-header"},[o("span",{staticClass:"accordion-title"},[t._v(t._s(t.title))]),o("span",{staticClass:"accordion-toggle el-icon-arrow-down",class:{collaspe:t.collaspe},on:{click:function(e){t.collaspe=!t.collaspe}}})]),o("transition",{on:{"before-enter":t.beforeEnter,enter:t.enter,"after-enter":t.afterEnter,"before-leave":t.beforeLeave,leave:t.leave,"after-leave":t.afterLeave}},[o("div",{directives:[{name:"show",rawName:"v-show",value:!t.collaspe,expression:"!collaspe"}],ref:"body",staticClass:"accordion-body",class:{collaspe:t.collaspe}},[t._t("default")],2)])],1)},Js=[],Xs={name:"accordion",props:{title:{type:String,required:!0}},data(){return{collaspe:!1,inGroup:!1}},mounted(){"accordion-group"==this.$parent.$options.name&&(this.inGroup=!0)},methods:{beforeEnter(t){t.classList.add("collapse-transition"),t.dataset||(t.dataset={}),t.dataset.oldPaddingTop=t.style.paddingTop,t.dataset.oldPaddingBottom=t.style.paddingBottom,t.style.height="0",t.style.paddingTop=0,t.style.paddingBottom=0,t.style.opacity=0},enter(t){t.dataset.oldOverflow=t.style.overflow,0!==t.scrollHeight?(t.style.height=t.scrollHeight+"px",t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom):(t.style.height="",t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom),t.style.opacity=1,t.style.overflow="hidden"},afterEnter(t){t.classList.remove("collapse-transition"),t.style.height="",t.style.overflow=t.dataset.oldOverflow,t.style.opacity=""},beforeLeave(t){t.dataset||(t.dataset={}),t.dataset.oldPaddingTop=t.style.paddingTop,t.dataset.oldPaddingBottom=t.style.paddingBottom,t.dataset.oldOverflow=t.style.overflow,t.style.height=t.scrollHeight+"px",t.style.overflow="hidden",t.style.opacity=1},leave(t){0!==t.scrollHeight&&t.classList.add("collapse-transition"),t.style.height=0,t.style.paddingTop=0,t.style.paddingBottom=0,t.style.opacity=0},afterLeave(t){t.style.height="",t.style.overflow=t.dataset.oldOverflow,t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom,t.style.opacity=""},setCollaspe(t){this.collaspe=void 0!==t?!!t:!this.collaspe}},watch:{collaspe(t){this.inGroup&&this.$parent.updateStatus(t,this),this.$emit("change",t)}}},Ys=Xs,Ks=(o("5443"),Object(st["a"])(Ys,qs,Js,!1,null,null,null)),Qs=Ks.exports;const Zs="./monaco-editor/vs";function tl(){if(window.__MONACO_PROMISE__)return window.__MONACO_PROMISE__;const t=`\n    require.config({\n      paths: {\n        'vs': '${Zs}'\n      }\n    });\n    require.config({\n      'vs/nls' : {\n        availableLanguages: {\n          '*': 'zh-cn'\n        }\n      }\n    });\n    require(['vs/editor/editor.main'], function () {\n      window.__monaco_editor__ = monaco;\n    });\n  `,e=new Promise((t,e)=>{const o=document.createElement("script");o.id="monaco-editor-loader",o.src=Zs+"/loader.js",o.onload=(()=>{o.onload=null,t("loader")}),o.onerror=(()=>{o.onerror=null,e("monaco-editor资源加载失败")}),document.body.appendChild(o)}).then(()=>{return new Promise((e,o)=>{const n=document.createElement("script");n.text=t,n.onerror=(()=>{n.onerror=null,o("monaco-editor资源加载失败")}),document.body.appendChild(n),e("editor")})}).then(()=>{return new Promise((t,e)=>{let o,n=0;function i(){window.__monaco_editor__?(clearTimeout(o),t(window.__monaco_editor__)):n++<1e3?setTimeout(i,30):e("monaco-editor资源加载失败")}i()})});return window.__MONACO_PROMISE__=e}function el(t,e,o){var n;return e=e||17,function(){var i=arguments,a=o||this;clearTimeout(n),n=setTimeout(function(){t.apply(a,i)},e)}}var ol={name:"Editor",components:{Accordion:Qs},props:{language:{type:String,default:"javascript",validator(t){return-1!==["javascript","css"].indexOf(t)}},code:{type:String,default:["function x() {",'    console.log("Hello world!");',"}",""].join("\n")}},data(){const t={defaultCode:{javascript:["function myScriptFn() {","\t/* todo something */\n\t","}",""].join("\n"),css:"/* 在下面加入您的 css  */ \n"},editor:null};return t.codeText=this.code||t.defaultCode[this.language],t},computed:{valueList(){return Object(gt["d"])(window.FORM_DESIGN_CONFIG.preset["epointsform.specificValues"])},controlList(){const t=this.$store.state.hiddenControls,e=this.$store.getters.allControls,o=[];return t.forEach(t=>{o.push({id:t.id,name:t.name||t.namePrefix+"_"+t.autoIndex})}),e.forEach(t=>{o.push({id:t.id,name:t.name||t.namePrefix+"_"+t.autoIndex})}),o}},mounted(){"javascript"!=this.language?this.initEditor(this.codeText):this.loadTypes().then(()=>{this.initEditor(this.codeText)})},beforeDestroy(){window.removeEventListener("resize",this.adaptLayout),this.editor&&this.editor.dispose()},methods:{handleDialogClose(t){this.$emit(t,this.editor.getValue())},_adaptLayout(){this.editor&&this.editor.layout()},search(){this.editor._actions["actions.find"].run()},format(){this.editor._actions["editor.action.formatDocument"].run()},addControl(t){const e=`mini.get('${t}').`;this.insertText(e),this.editor._actions["editor.action.triggerSuggest"].run()},addValue(t){this.insertText(t)},insertText(t){const e=this.editor.getPosition();this.editor.executeEdits("",[{range:{startLineNumber:e.lineNumber,startColumn:e.column,endLineNumber:e.lineNumber,endColumn:e.column},text:t}]);const o=this.editor.getSelection();o.selectionStartColumn=o.startColumn=o.endColumn,o.selectionStartLineNumber=o.startLineNumber=o.endLineNumber,this.editor.setSelection(o),this.editor.focus()},initEditor(t){this.adaptLayout=el(this._adaptLayout,200),window.addEventListener("resize",this.adaptLayout),tl().then(e=>{window.__meditor=this.editor=e.editor.create(this.$refs.editorEl,{value:t||"",language:this.language,lineHeight:26,autoIndent:!0,formatOnPaste:!0,lineNumbers:"on",minimap:!0,tabCompletion:"on",quickSuggestions:{comments:!0},snippetSuggestions:"top",accessibilitySupport:"on",suggest:{}}),this.editor.focus()})},loadTypes(){const t={"content-type":"text/plain; charset=UTF-8"};return tl().then(e=>{return this.$httpGet("./types/mini-snippets.json",!0,t).then(t=>{const o=JSON.parse(t);o.forEach(t=>{t.kind=e.languages.CompletionItemKind.Function,t.detail=t.documentation}),e.languages.registerCompletionItemProvider("javascript",{provideCompletionItems:function(){return{suggestions:o}}})}).then(()=>{this.$httpGet("./types/jquery.d.ts",!0,t).then(t=>{e.languages.typescript.javascriptDefaults.addExtraLib(t,"jquery.d.ts")}),this.$httpGet("./types/miniui.d.ts",!0,t).then(t=>{e.languages.typescript.javascriptDefaults.addExtraLib(t,"miniui.d.ts")}),this.$httpGet("./types/epoint.d.ts",!0,t).then(t=>{e.languages.typescript.javascriptDefaults.addExtraLib(t,"epoint.d.ts")})})})}}},nl=ol,il=(o("58d3"),Object(st["a"])(nl,Gs,Us,!1,null,null,null)),al=il.exports,sl=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"row-container"},[t._l(t.list,function(e,n){return o("div",{key:e.id,staticClass:"row",class:{isTop:0==t.level,first:0===n,mid:0!=n},style:"min-height:"+e.height+"px",attrs:{id:e.id,"row-id":e.id}},t._l(e.cols,function(n,i){return o("div",{key:n.id,staticClass:"col",class:t.getColCls(n,i,e.cols.length),style:t.rowColWidthMap[e.id][i],attrs:{id:n.id,name:n.name}},[n.subs&&n.subs.length?o("RowGender",{attrs:{list:n.subs,level:t.levelNext}}):t._e(),t._l(n.controls,function(e){return o(t.getControl(e.type),{key:e.id,tag:"component",attrs:{id:e.id,"control-data":e,asControl:!0}})})],2)}),0)}),0===t.level?o("div",{staticClass:"hidden-area",staticStyle:{display:"none"}},t._l(t.hiddenControls,function(e){return o(t.getControl(e.type),{key:e.id,tag:"component",attrs:{id:e.id,"control-data":e,asControl:!0}})}),1):t._e()],2)},ll=[];const rl={label:Bt,title:Zt},cl={inheritAttrs:!1,props:["id"],template:'<span class="design-control-holder" :id="id"></span>'};var dl={name:"RowGender",props:{list:{type:Array,default:()=>[]},level:{type:Number,default:0},globalStyle:{type:Object,default:()=>{return{}}}},data(){return{}},created(){},computed:{hiddenControls(){return this.$store.state.hiddenControls},levelNext(){return this.level+1},rowColWidthMap(){const t={};return this.list.forEach(e=>{t[e.id]=[],e.cols.forEach(o=>{const n=o.style.width;t[e.id].push({width:`${n}px`,minHeight:`${e.height}px`})})}),t}},methods:{getColCls(t,e,o){const n=this.globalStyle,i=t.subs.length,a=t.style,s={isSub:!i,hasSub:i,first:0===e,mid:e&&e!==o-1,last:e===o-1,["text-"+(a.textAlign||n.textAlign)]:!0,["vertical-"+(a.verticalAlign||n.verticalAlign)]:!0};return s},getHtmlContent(){return this.$el.innerHTML},getControl(t){return t in rl?rl[t]:cl}}},ul=dl,hl=Object(st["a"])(ul,sl,ll,!1,null,null,null),pl=hl.exports,fl=o("4be7"),ml=o("9827");const gl="0.1.7",bl=`${location.pathname}-formdesign-V${gl}`,vl=new URLSearchParams(location.search),yl=vl.get("designId")||"",Cl=vl.get("tableGuid")||"";var wl={name:"app-main",components:{Tabs:ht,TabPanel:rt,PanelLayout:xt,Design:io,ConfigCell:No,ConfigForm:rn,PanelControl:Ot,ConfigControl:Os,ConfigRow:Ms,RowGender:pl,Shuttle:Ws,Accordion:Qs,Editor:al},data(){return{dataLoaded:!1,formTitle:"表单设计器",viewType:"real",needRender:!1,showLocalBtns:/useMock/i.test(location.search),editorDialog:{title:"",show:!1,code:"",display:!1,lang:""},enableRightbarCover:!0,narrowMode:!1,rightbarHidden:!1}},computed:Object(Q["a"])({},Object(mt["e"])(["leftActiveTab","rightActiveTab","formSize","selectedColId","hiddenControls","selectedRowId","jsCode","cssCode"]),Object(mt["c"])(["codeListMap","selectedCol"]),{selectedControl(){const t=this.$store.state.selectedControlId;if(t){const e=this.$store.getters.controlDataMap[t];if(e&&e.control)return e.control}return null},globalStyle:{get(){return this.$store.state.globalStyle},set(t){this.$store.commit("updateGlobalStyle",t)}},design:{get(){return this.$store.state.design},set(t){this.$store.commit("updateDesign",t)}}}),mounted(){this.enableRightbarCover&&(this.calcWidth(),window.addEventListener("resize",this.calcWidth)),fl["Promise"].all([this.$httpPost(window.formDesignerActions.getUrl,{designId:yl,tableGuid:Cl}),this.$httpPost(window.formDesignerActions.getCodeItemUrl,{designId:yl,tableGuid:Cl})]).then(t=>{const e=t[0],o=t[1].codeMain,n=e.extControls,i=e.fieldList,a=e.designData,s=e.macroTypes,l=e.sourceTables,r=e.dataTables;i&&i.length&&(i.forEach(t=>{t.fields.forEach(t=>{t.required=1==parseInt(t.required,10),t.fieldtype=parseInt(t.fieldtype,10)})}),this.setFieldList(i)),e.name&&(this.formTitle=e.name),o&&o.length&&this.setCodeList(o),s&&s.length&&this.setMacroTypes(s),n&&n.length&&this.setExtControls(n),l&&l.length&&this.setSourceTables(l),r&&r.length&&this.setDataTables(r),e.jsCode&&this.setJsCode(Object(gt["e"])(e.jsCode)),e.cssCode&&this.setCssCode(Object(gt["e"])(e.cssCode)),a&&(a.globalStyle&&(this.globalStyle=a.globalStyle),a.design&&(this.design=a.design),a.hiddenControls&&this.$store.commit("setHiddenControls",a.hiddenControls),ml["c"].control.adapt(this.$store.getters.allControls),ml["c"].control.adapt(this.$store.state.hiddenControls),ml["c"].col.adapt(this.design),gt["l"].adapt(this.$store.getters.allRows,t=>t.id),this.dataLoaded=!0,this.$nextTick(()=>{this.$refs.shuttle.init()}))}).catch(t=>{console.error(t)}),this.$httpPost(window.formDesignerActions.getListInfoUrl,{designId:yl,tableGuid:Cl}).then(t=>{const e=t.SformListInfo;Array.isArray(e)&&this.$store.commit("setButtonEditPopupList",e)}).catch(t=>{console.error(t)})},methods:Object(Q["a"])({},Object(mt["d"])(["activeLeftTab","setFieldList","setCodeList","setMacroTypes","setExtControls","setSourceTables","setDataTables","setJsCode","setCssCode"]),Object(mt["b"])(["activeRightTab"]),{calcWidth:Pe()(function(){this.narrowMode=window.innerWidth<1610},20,{leading:!0,trailing:!0}),openEditor(t){let e,o,n;"js"==t?(e=this.jsCode,o="js编辑",n="javascript"):(e=this.cssCode,o="css编辑",n="css"),this.editorDialog.title=o,this.editorDialog.code=e,this.editorDialog.lang=n,this.editorDialog.show=!0},onEditorDialogOpened(){this.editorDialog.display=!0},saveEditorCode(t){"javascript"==this.editorDialog.lang?this.setJsCode(t):"css"==this.editorDialog.lang&&this.setCssCode(t),this._closeEditorDialog()},_closeEditorDialog(){this.editorDialog.display=this.editorDialog.show=!1},closeEditorDialog(){this.$confirm("不需要保存此次的代码修改吗？","保存提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this._closeEditorDialog()}).catch(t=>{console.error(t)})},viewTypeChange(t){this.viewType=t.target.value},getLocalData(){var t=localStorage.getItem(bl)||window.__designData;t&&(this.design=JSON.parse(t),ml["c"].control.adapt(this.$store.getters.allControls),ml["c"].col.adapt(t))},save(){localStorage.setItem(bl,JSON.stringify(this.design))},clear(){this.design=[]},preview(){return this.getData().then(t=>{const e=t.build,o=`\n      <!DOCTYPE html>\n      <html lang="en">\n      <head>\n          <meta charset="UTF-8">\n          <meta name="viewport" content="width=device-width, initial-scale=1.0">\n          <meta http-equiv="X-UA-Compatible" content="ie=edge">\n          <title>Document</title>\n          <style>html,body{margin:0;padding:0;}.container{margin:0 auto;}</style>\n          <style>.row{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap}.col{position:relative;-webkit-box-sizing:border-box;box-sizing:border-box;box-sizing:border-box;min-height:30px;padding:6px;line-height:30px;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0}.col.hasSub{padding:0}.col>*{position:relative;z-index:1}.col:after{position:absolute;z-index:0;top:0;right:0;bottom:0;left:0;display:block;-webkit-box-sizing:border-box;box-sizing:border-box;content:"";background:transparent}.col.hasSub:after{border-top-width:0!important;border-right-width:0!important;border-bottom-width:0!important;border-left-width:0!important}.col.mid:after{border-left-width:0!important}.col.mid>.row>.col.first:after,.col.mid>.row-container>.row>.col.first:after,.col.last>.row>.col.first:after,.col.last>.row-container>.row>.col.first:after{border-left-width:0!important}.col.mid ~ .col.last:after,.col.first ~ .col.last:after{border-left-width:0!important}.row.mid>.col:after{border-top-width:0!important}.row.mid>.col>.row>.col:after,.row.mid>.col>.dropArea>.row>.col:after{border-top-width:0!important}.col.text-left{text-align:left}.col.text-center{text-align:center}.col.text-right{text-align:right}.col.vertical-top{vertical-align:top}.col.vertical-middle{vertical-align:middle}.col.vertical-bottom{vertical-align:bottom}.col.vertical-top{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start}.col.vertical-middle{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center}.col.vertical-bottom{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end}.design-form-title,.design-form-label{position:relative;display:block;-webkit-box-sizing:border-box;box-sizing:border-box;width:100%}.design-form-label{padding-right:8px}.design-form-label.required:after{position:absolute;top:50%;right:-2px;display:block;width:8px;height:16px;margin-top:-8px;font-size:16px;line-height:16px;content:"*";color:red}.mini-textbox-readOnly .mini-textbox-border,.mini-textbox-readOnly .mini-textbox-input,.mini-buttonedit-readOnly .mini-buttonedit-border,.mini-buttonedit-readOnly .mini-buttonedit-input,.mini-readonly .mini-textboxlist-border{cursor:default;border:0;background:0}.mini-buttonedit-readOnly .mini-buttonedit-button,.mini-readonly .mini-textboxlist-close{display:none}.mini-readonly .mini-textboxlist-item{padding-right:8px}</style>\n          <style>${e.style}</style>\n      </head>\n      <body>\n          <div class="container" style="width:${this.formSize.width}px;">${e.html}</div>\n      </body>\n      </html>\n      `,n=new Blob([o],{type:"text/html"});var i=document.createElement("a");i.download="测试表单设计器生成布局",i.href=URL.createObjectURL(n),document.body.appendChild(i),i.click(),document.body.removeChild(i)})},getData(){return this.getHtml().then((t,e)=>{if(e)return console.error(e);this.$store.dispatch("dealSubmitControl");const o=Object(gt["d"])(this.hiddenControls);let n=Object(gt["d"])(this.$store.getters.allControls);n.push(...o);const i={designData:{globalStyle:Object(gt["d"])(this.globalStyle),hiddenControls:o,design:Object(gt["d"])(this.design)},build:{html:t,style:this.getStyle()},controls:n,jsCode:Object(gt["f"])(this.jsCode),cssCode:Object(gt["f"])(this.cssCode)};return i})},saveToServer(){return this.getData().then(t=>{return t.build.html&&(t.build.html=Object(gt["h"])(t.build.html)),this.$httpPost(window.formDesignerActions.saveUrl,Tn()({designId:yl,tableGuid:Cl},t)).then(t=>{const e=t;1==parseInt(e.msg,10)&&this.$message({message:"保存成功",type:"success",showClose:!0})})})},getStyle(){return this.$store.getters.colStyleText},getHtml(){return this.needRender=!0,new fl["Promise"]((t,e)=>{const o=setTimeout(()=>{e({msg:"渲染超时！！！"})},3e3);this.$nextTick(()=>{try{const i=this.$refs.builder.getHtmlContent();t(i),clearTimeout(o),this.needRender=!1}catch(n){e(n)}})}).catch(t=>{this.needRender=!1,console.error(t)})}}),beforeDestroy(){this.enableRightbarCover&&window.removeEventListener("resize",this.calcWidth)},watch:{design:{deep:!1,handler(t){JSON.stringify(t)!=JSON.stringify(this.design)&&this.$store.commit("updateDesign",t)}}}},xl=wl,_l=(o("bec5"),o("3176"),Object(st["a"])(xl,Y,K,!1,null,null,null)),Dl=_l.exports,kl={name:"app",components:{Main:Dl},data(){return{height:window.innerHeight}},mounted(){window.addEventListener("resize",this.handelResize)},methods:{handelResize(){clearTimeout(this._resizeTimer),this._resizeTimer=setTimeout(()=>{this.height=window.innerHeight},200)}},beforeDestroy(){window.removeEventListener("resize",this.handelResize)}},Tl=kl,Sl=(o("034f"),Object(st["a"])(Tl,J,X,!1,null,null,null)),$l=Sl.exports,Ol=o("9aba"),El=o.n(Ol),Il={getters:{rowDataMap:t=>{const e={};function o(t,n){e[t.id]&&console.warn("行id出现重复！！！",e[t.id],t),e[t.id]={row:t,index:n},t.cols&&t.cols.forEach(t=>{t.subs&&t.subs.forEach(o)})}return t.design.forEach(o),e},allRows:(t,e)=>{let o=e.rowDataMap;const n=[];for(let i in o)o.hasOwnProperty(i)&&n.push(o[i].row);return n},subRowPathMap:(t,e)=>{const o={};function n(t){o[t.id]||(o[t.id]=[]),t.cols&&t.cols.forEach(e=>{e.subs&&(e.subs.forEach(e=>{o[e.id]=[t].concat(o[t.id])}),e.subs.forEach(n))})}t.design.forEach(n);for(let i in o)if(o.hasOwnProperty(i)){if(!o[i]||!o[i].length){delete o[i];continue}e.rowDataMap[i].row.name,document.querySelector('[row-id="'+e.rowDataMap[i].row.id+'"]'),o[i].forEach(t=>{document.querySelector('[row-id="'+t.id+'"]')})}return o},selectedRowParentCol:(t,e)=>{const o=t.selectedRowId;if(!o)return null;const n=e.subRowPathMap[o];if(n&&n.length)for(let i of n[0].cols)if(i.subs&&i.subs.length)for(let t of i.subs)if(t.id==o)return i;return null},selectedLayoutData:(t,e)=>{const o=t.selectedRowId;if(!o)return{layout:null,index:-1};const n=e.rowDataMap[o];return{layout:n.row,index:n.index}}},mutations:{updateSelectedLayout(t,e){const o=e.id;t.selectedRowId=o},removeRow(t,e){const o=e.parentCol,n=e.index;o?o.subs?o.subs.splice(n,1):console.error("删除时找不到上级！！！"):t.design.splice(n,1)},updateRowHeight(t,e){const o=e.row,n=e.height,i=n-o.height;function a(t,e){t.cols&&t.cols.forEach(t=>{const o=t.subs;if(!o||!o.length)return;const n=o[o.length-1],i=o.reduce((t,e)=>t+e.height,0),s=e-i;if(s>0)n.height+=s;else{const t=n.height+s;n.height=t<30?30:t}a(n,n.height)})}function s(t,e){if(!t||!t.length)return;const o=t[0];o.height+=e,a(o,o.height),s(t.slice(1),e)}o.height=n,a(o,n),!1!==e.bubble&&s(e.parentRowPath,i)},replaceToMulti(t,e){const o=e.row,n=e.rowIndex,i=e.rowCount,a=e.colCount,s=l(o,i,a);function l(t,e,n){const i=Object(gt["d"])(t),a=o.cols[0];i.cols=[],i.asMulti=!1,delete i.asMulti,a.style.width=a.style.width/n;const s=[...new Array(e)].map(()=>{const t=Object(gt["l"])(),e=Object(gt["d"])(i);return e.id=t,e.autoIndex=gt["j"].getIndex(e.namePrefix||e.name),e.cols=[...new Array(n)].map(()=>{const e=gt["b"].getIndex(t),o=Object(gt["d"])(a);return o.id=`col-${t}-${e}`,o.name=`col-${e}`,o}),e});return s}t.design.splice(n,1,...s)},copyRow(t,e){const o=e.aimIndex,n=e.newRow,i=e.parentCol||t.design;i.splice(o,0,n)},updateLayoutProp(t,e){const o=e.prop,n=e.value,i=e.layout;i?i[o]=n:console.error("组件件不存在")},updateAllRowHeight(t,e){const o=e.rows,n=e.height;Array.isArray(o)&&o.forEach(t=>{t.height=n})}},actions:{setAllRowHeight(t,e){const o=e.height,n=t.state.design.filter(t=>{for(let e of t.cols)if(e.subs&&e.subs.length)return!1;return!0}),i="allRowHeight"+ +new Date;t.commit("updateGlobalStyleProp",{prop:"cellHeight",value:o,shuttle:!0,group:i}),n.length&&t.commit("updateAllRowHeight",{rows:n,height:o,shuttle:!0,group:i})},setSelectedLayout(t,e){t.commit("updateSelectedLayout",e),t.commit({type:"setSelectedCol",selectedColId:""}),t.commit("clearSelectedControl")},setLayoutProp(t,e){let o=e.layout,n=e.prop,i=e.value;o||(o=t.getters.selectedLayoutData.layout),t.commit("updateLayoutProp",{layout:o,prop:n,value:i})},deleteRow(t,e){void 0===e.shuttle&&(e.shuttle=!0),e.row==t.getters.selectedLayoutData.layout&&t.commit("updateSelectedLayout",{id:""}),t.commit("removeRow",e)}}},Ll=(o("4917"),{getters:{allCol:(t,e)=>{const o=[],n=e.rowDataMap;let i;for(let a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i=n[a].row,i.cols.forEach(t=>{o.push(t)}));return o},colStyleText:(t,e)=>{const o=e.allCol,n=[];return o.forEach(t=>{const e=t.style.border,o=[`#${t.id}:after{`,`border-top: ${e.top.width}px ${e.top.style} ${e.top.color};`,`border-right: ${e.right.width}px ${e.right.style} ${e.right.color};`,`border-bottom: ${e.bottom.width}px ${e.bottom.style} ${e.bottom.color};`,`border-left: ${e.left.width}px ${e.left.style} ${e.left.color};}`].join("");n.push(o)}),n.join("")},selectedCol:(t,e)=>{const o=t.selectedColId;if(!o)return null;const n=o.replace(/^col-(\w+)-\d{1,2}$/,"$1"),i=e.rowDataMap[n];if(!i)return null;for(let a of i.row.cols)if(a.id==o)return a;return null}},mutations:{setSelectedCol(t,e){t.selectedColId=e.id},removeCol(t,e){const o=e.col,n=e.parentRow,i=e.colIndex;if(!n.cols||1==n.cols.length)return;const a=n.cols[i-1];if(a)a.style.width+=o.style.width;else{const t=n.cols[i+1];t&&(t.style.width+=o.style.width)}n.cols.splice(i,1)},splitCol(t,e){const o=e.col,n=e.colIndex,i=e.parentRow,a=e.direction,s=void 0===a?"right":a;if(!i)return e.shuttle=!1,void console.error("未指定所在行！！");const l=Object(gt["d"])(o);h(i,l);const r=o.style.width,c=r/2>>0,d=r-c;o.style.width=c,l.style.width=d,l.style.border=Object(gt["d"])(o.style.border),l.controls=[];const u="left"==s?n:n+1;function h(t,e){const o=t.id,n=Math.max(...t.cols.map(t=>{return parseInt(t.id.substr(t.id.lastIndexOf("-")+1),10)}));e.id=`col-${o}-${n+1}`,e.name=`col-${n+1}`}i.cols.splice(u,0,l)},updateColAllBorder(t,e){const o=e.directions,n=e.prop,i=e.value;o.forEach(t=>{t&&(t[n]=i)})},setColBorder(t,e){const o=e.border,n=e.selectedCol;JSON.stringify(e),n.style.border=Object(gt["d"])(o)},setColStyle(t,e){JSON.stringify(e);const o=e.prop,n=e.value,i=e.selectedCol;i.style[o]=n},setAllColBorderWidth(t,e){const o=e.cols,n=e.borderWidth;Al(o,n)},setAllColBorder_inner(t,e){const o=e.cols,n=e.borderWidth;Al(o,n),jl(t.design[0],0),Ml(t.design[t.design.length-1],0),Rl(t.design,0),zl(t.design,0)},setAllColBorder_hline(t,e){const o=e.cols,n=e.borderWidth;o.forEach(t=>{t.style.border.left.width=0,t.style.border.right.width=0,t.style.border.top.width=n,t.style.border.bottom.width=n})},setAllColBorder_vline(t,e){const o=e.cols,n=e.borderWidth;o.forEach(t=>{t.style.border.left.width=n,t.style.border.right.width=n,t.style.border.top.width=0,t.style.border.bottom.width=0})},setAllColBorder_outer(t,e){const o=e.cols,n=e.borderWidth;Al(o,0),jl(t.design[0],n),Ml(t.design[t.design.length-1],n),Rl(t.design,n),zl(t.design,n)},setAllColBorder_left(t,e){const o=e.cols,n=e.borderWidth;Al(o,0),Rl(t.design,n)},setAllColBorder_top(t,e){const o=e.cols,n=e.borderWidth;Al(o,0),jl(t.design[0],n)},setAllColBorder_right(t,e){const o=e.cols,n=e.borderWidth;Al(o,0),zl(t.design,n)},setAllColBorder_bottom(t,e){const o=e.cols,n=e.borderWidth;Al(o,0);const i=t.design.length;if(i){const e=t.design[i-1];Ml(e,n)}},updateColWidth(t,e){const o=e.col,n=e.width,i=e.nextCol,a=n-o.style.width;function s(t,e,o){t.subs.forEach(t=>{const n=t.cols;if(!n||!n.length)return;const i=n["right"==o?0:n.length-1];i.style.width+=e,s(i,e,o)})}i&&i.style&&(i.style.width-=a,i.subs&&s(i,-a,"right")),o.style.width=n,o.subs&&s(o,a,"left")},updateRowColWidth(t,e){const o=e.row,n=e.ratio;function i(t){t.cols.forEach(t=>{t.style.width*=n,t.subs&&t.subs.length&&t.subs.forEach(i)})}i(o)}},actions:{setSelectedCol(t,e){t.commit("setSelectedCol",e),t.commit("updateSelectedLayout",{id:"",shuttle:!1}),t.commit("clearSelectedControl")},removeCol(t,e){const o=e.col;o.id==t.state.selectedColId&&t.commit("setSelectedCol",{id:"",shuttle:!1}),t.commit("removeCol",e)},setColAllBorder(t,e){const o=e.prop,n=e.value,i=t.getters.selectedCol,a=i.style.border.right,s=i.style.border.bottom;let l,r;const c=t.state.selectedColId.match(/col-(\w+)-\d/);if(!c)return console.error("单元格不存在！！！");const d=c[1];if(!d)return console.error("无法匹配目标行");const u=t.getters.rowDataMap[d].row,h=t.getters.rowDataMap[d].index,p=u.cols.indexOf(i);if(-1===p)return console.error("单元格不存在！！！");if(l=0===p?i.style.border.left:u.cols[p-1].style.border.right,0==h)r=i.style.border.top;else{let e;const o=t.getters.subRowPathMap[d];e=o&&o.length?o[0].cols[h-1]:t.state.design[h-1],r=e.cols[p]?e.cols[p].style.border.bottom:null}t.commit("updateColAllBorder",{directions:[r,a,s,l],prop:o,value:n,shuttle:!0})}}});function Al(t,e){t.forEach(t=>{t.style.border.top.width=e,t.style.border.right.width=e,t.style.border.bottom.width=e,t.style.border.left.width=e})}function jl(t,e){t&&t.cols.forEach(t=>{t.style.border.top.width=e;const o=t.subs[0];jl(o)})}function Ml(t,e){t&&t.cols.forEach(t=>{t.style.border.bottom.width=e;const o=t.subs.length;o&&Ml(t.subs[o-1],e)})}function Rl(t,e){Array.isArray(t)&&t.length&&t.forEach(t=>{const o=t.cols[0];o&&(o.style.border.left.width=e,Rl(o.subs,e))})}function zl(t,e){Array.isArray(t)&&t.length&&t.forEach(t=>{const o=t.cols[t.cols.length-1];o&&(o.style.border.right.width=e,zl(o.subs,e))})}var Pl={getters:{controlType2nameMap:t=>{const e=window.FORM_DESIGN_CONFIG.controlList,o=t.extControls,n={};return e.concat(o).forEach(t=>{n[t.type]=t.name}),n},fieldMap:t=>{const e={};return t.fieldList.forEach(t=>{t.fields.forEach(o=>{e[t.id+";"+o.field]=o})}),e},codeListMap:t=>{let e=t.codeList;const o={};return e.forEach(t=>{o[t.id]=t}),o},selectedFieldMap:(t,e)=>{let o=e.allControls;if(!o.length)return{};const n={};return o.forEach(t=>{t.bind&&(n[t.bind]=!0)}),n},allControls:(t,e)=>{let o=e.allCol;if(!o||!o.length)return[];const n=[];return o.forEach(t=>{t.controls&&t.controls.length&&n.push(...t.controls)}),n},controlNameMap:(t,e)=>{let o=t.hiddenControls,n=e.allControls;const i={};return o.forEach(t=>{i[t.id]=t.name||`${t.namePrefix}_${t.autoIndex}`}),n.forEach(t=>{i[t.id]=t.name||`${t.namePrefix}_${t.autoIndex}`}),i},controlDataMap:(t,e)=>{let o=t.hiddenControls,n=e.allCol;const i={};return o.forEach((t,e)=>{i[t.id]={control:t,index:e}}),n.forEach(t=>{t.controls&&t.controls.length&&t.controls.forEach(function(t,e){i[t.id]={control:t,index:e}})}),i},selectedControl:(t,e)=>{let o=t.selectedControlId,n=e.controlDataMap;if(!o)return{control:null,index:-1};const i=n[o];return i&&i.control?i:{control:null,index:-1}},selectedControlParentCol:(t,e)=>{let o=t.selectedControlId,n=e.allCol;for(let i of n)if(i.controls)for(let t of i.controls)if(t.id==o)return i;return null},selectedControlParentColInfo:(t,e)=>{let o=e.selectedControlParentCol,n=e.rowDataMap;const i={row:null,index:-1};if(!o)return i;const a=o.id,s=a.replace(/^col-(\w+)-\d{1,2}$/,"$1"),l=n[s];return l?{row:l.row,index:l.row.cols.indexOf(o)}:i}},mutations:{setHiddenControls(t,e){t.hiddenControls=e},setSourceTables(t,e){t.sourceTables=e},setDataTables(t,e){t.dataTables=e},setFieldList(t,e){t.fieldList=e},setCodeList(t,e){t.codeList=e},setMacroTypes(t,e){t.macroTypes=e},setExtControls(t,e){t.extControls=e},setButtonEditPopupList(t,e){t.buttonEditPopupList=e},removeControl(t,e){const o=e.selectedControl,n=e.selectedControlParentCol,i=e.selectedControlIndex;if(!o||!n||-1===i)return console.error("删除控件出错！！！");n.controls.splice(i,1)},removeHiddenControl(t,e){const o=e.index;t.hiddenControls.splice(o,1)},addControl(t,e){const o=e.parentCol,n=e.control;o.controls.push(n)},setSelectedControl(t,e){t.selectedControlId=e.id},clearSelectedControl(t){t.selectedControlId=""},updateControlProp(t,e){JSON.stringify(e);const o=e.control;o?/\./.test(e.prop)?(e.prop,Object(gt["g"])(o,e.prop),Object(gt["k"])(o,e.prop,e.value),Object(gt["g"])(o,e.prop)):o[e.prop]=e.value:console.error("无选中控件")}},actions:{deleteControl(t,e){if(e){const o=e.selectedControl,n=e.selectedControlParentCol,i=e.selectedControlIndex;t.commit("removeControl",{selectedControl:o,selectedControlParentCol:n,selectedControlIndex:i,shuttle:!0})}else{const e=t.getters.selectedControl,o=e.control,n=e.index;if(!o||-1===n)return console.error("出现错误，无法删除！");if("hiddenfield"===o.type)return t.commit("clearSelectedControl"),void t.commit("removeHiddenControl",{index:n,shuttle:!0});let i=t.getters.selectedControlParentCol;if(!i)return console.error("出现错误，无法删除！");t.commit("clearSelectedControl"),t.commit("removeControl",{selectedControl:o,selectedControlParentCol:i,selectedControlIndex:n,shuttle:!0})}},setSelectedControl(t,e){t.commit("setSelectedControl",e),t.commit("setSelectedCol",{id:""}),t.commit("updateSelectedLayout",{id:""})},autoAddLabel(t,e){const o=e.parentCol,n=Ul("",t.state.globalStyle);t.commit("addControl",{parentCol:o,control:n})},setControlProp(t,e){const o=e.prop,n=e.value,i=e.control;if(t.commit({control:i,type:"updateControlProp",prop:o,value:n,shuttle:!0,group:e.group}),"bind"==o){const e=t.getters.fieldMap[n];if(e&&e.datasource&&(t.commit({control:i,type:"updateControlProp",prop:"data",value:"",shuttle:!1}),t.commit({control:i,type:"updateControlProp",prop:"codeItem",value:e.datasource,shuttle:!1})),i&&n)try{t.commit({control:i,type:"updateControlProp",prop:"emptyText",value:"请输入"+t.getters.fieldMap[n].name,shuttle:!1})}catch(a){console.error("自动设置 emptyText",a)}Gl(t,i),Nl(t,t.getters.fieldMap[i.bind].name),Bl(t,n,i),Fl(t,n,i)}"required"==o&&Hl(t,n),"sourceTable"==o&&Vl(t,i)},dealSubmitControl(t){ql(t)}}};function Vl(t,e){e&&"subtable"==e.type&&t.commit({control:e,type:"updateControlProp",prop:"columns",value:[],shuttle:!1})}function Fl(t,e,o){const n=t.getters.fieldMap[e];if(!n.fieldtype)return;let i;switch(n.fieldtype){case 1:i="float";break;case 2:i="int";break;default:break}i&&t.commit({control:o,type:"updateControlProp",prop:"vtype",value:i,shuttle:!1})}function Bl(t,e,o){const n=t.getters.fieldMap[e];n.required&&o&&"required"in o&&(t.commit({control:o,type:"updateControlProp",prop:"required",value:!0,shuttle:!1}),Hl(t,!0))}function Nl(t,e){const o=Wl(t);o&&"控件label"==o.labelText&&t.commit("updateControlProp",{control:o,prop:"labelText",value:e,shuttle:!1})}function Hl(t,e){const o=Wl(t);o&&t.commit("updateControlProp",{control:o,prop:"showStar",value:e,shuttle:!1})}function Wl(t){const e=t.getters.selectedControlParentColInfo,o=e.row,n=e.index;if(!o||-1===n)return;const i=o.cols[n-1];if(i&&i.controls.length){for(let t of i.controls)if("label"==t.type)return t;return null}}function Gl(t,e){const o=t.getters.selectedControlParentColInfo,n=o.row,i=o.index;if(!e||!n)return;const a=n.cols[i-1];if(!a||a.controls.length||a.subs.length)return;const s=Ul(t.getters.fieldMap[e.bind].name,t.state.globalStyle);t.commit("addControl",{parentCol:a,control:s,shuttle:!1})}function Ul(t,e){const o=Object(gt["d"])(window.FORM_DESIGN_CONFIG.controls.label),n=gt["c"].getIndex("label");o.id="label-"+n,o.namePrefix="label",o.autoIndex=n,o.name="",o.width="100%",t&&(o.labelText=t),delete o.configItems;const i=e.fontSize,a=e.fontFamily,s=e.fontColor,l=e.fontBolder,r=e.fontItalic,c=e.fontUnderline;return o.fontSize=i,o.fontFamily=a,o.fontColor=s,o.fontBolder=l,o.fontItalic=r,o.fontUnderline=c,o}function ql(t){const e=t.getters.allControls,o=e.filter(t=>"combobox"==t.type),n=new Map,i=new Map;o.forEach(t=>{n.set(t.id,t),t.events&&t.events["valuechanged:getcodelist"]&&t.events["valuechanged:getcodelist"].length&&i.set(t.id,t)}),Jl(i,n,t,{})}function Jl(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=!1,a=!1;t.forEach(t=>{if(t.codeItem){const a=t.events["valuechanged:getcodelist"].reduce((t,e)=>{const o=e.actions.filter(t=>"setData"==t.type)[0];return o&&t.push(...o.targets),t},[]);a.forEach(a=>{const s=a.id;n[s]||(o.commit({control:e.get(s),type:"updateControlProp",prop:"codeItem",value:t.codeItem,shuttle:!1}),n[s]=!0,i=!0)})}else a=!0}),a&&i&&Jl(t,e,o,n)}var Xl={getters:{inControlDragging(t){return t.helper.inControlDragging},inLayoutDragging(t){return t.helper.inLayoutDragging}},mutations:{updateLineTop(t,e){t.helper.top=e},updateLineLeft(t,e){t.helper.left=e},showHLine(t){t.helper.showHLine=!0},hideHLine(t){t.helper.showHLine=!1},showVLine(t){t.helper.showVLine=!0},hideVLine(t){t.helper.showVLine=!1},layoutDragStart(t){t.helper.inLayoutDragging=!0},layoutDragEnd(t){t.helper.inLayoutDragging=!1},controlDragStart(t){t.helper.inControlDragging=!0},controlDragEnd(t){t.helper.inControlDragging=!1}},actions:{}};q["default"].use(mt["a"]);var Yl=new mt["a"].Store({strict:!1,state:{formSize:{width:900,height:0},design:[],hiddenControls:[],globalStyle:{autoColons:!0,fontSize:13,fontFamily:"Microsoft Yahei",fontColor:"#333333",fontBolder:!1,fontItalic:!1,fontUnderline:!1,textAlign:"left",verticalAlign:"middle",cellHeight:38,border:{top:{width:1,style:"solid",color:"#ddd"},right:{width:1,style:"solid",color:"#ddd"},bottom:{width:1,style:"solid",color:"#ddd"},left:{width:1,style:"solid",color:"#ddd"}},allBorderType:"all"},helper:{showVLine:!1,showHLine:!1,left:0,top:0,inControlDragging:!1,inLayoutDragging:!1},jsCode:"",cssCode:"",fieldList:[],codeList:[],macroTypes:[],sourceTables:[],dataTables:[],buttonEditPopupList:[],extControls:[],leftActiveTab:"layout",rightActiveTab:"form",selectedControlId:"",selectedColId:"",selectedRowId:""},getters:Object(Q["a"])({},Il.getters,Ll.getters,Pl.getters,Xl.getters,{globalStyleText:t=>{const e=t.globalStyle,o=e.fontSize,n=e.fontFamily,i=e.fontColor,a=e.fontBolder,s=e.fontItalic,l=e.fontUnderline,r=e.textAlign,c=e.verticalAlign;return`\n        font-size: ${o}px;\n        font-family: ${n};\n        color: ${i};\n        font-weight: ${a?"bold":"normal"};\n        font-style: ${s?"italic":"normal"};\n        text-decoration: ${l?"underline":"none"};\n        text-align: ${r};\n        vertical-align: ${c};\n      `}}),mutations:Object(Q["a"])({},Il.mutations,Ll.mutations,Pl.mutations,Xl.mutations,{setJsCode(t,e){t.jsCode=e},setCssCode(t,e){t.cssCode=e},updateGlobalStyleProp(t,e){JSON.stringify(e),t.globalStyle[e.prop]=e.value},updateGlobalBorder(t,e){JSON.stringify(e),t.globalStyle.border.top[e.prop]=e.value,t.globalStyle.border.right[e.prop]=e.value,t.globalStyle.border.bottom[e.prop]=e.value,t.globalStyle.border.left[e.prop]=e.value},updateGlobalStyle(t,e){t.globalStyle=Tn()({},t.globalStyle,e)},applyGlobalStyle(t,e){const o=e.cols,n=e.prop,i=e.value;o.forEach(t=>{t.style[n]=i,t.controls&&t.controls.length&&-1!==["fontSize","fontFamily","fontColor","fontBolder","fontItalic","fontUnderline"].indexOf(n)&&t.controls.filter(t=>"label"==t.type||"title"==t.type).forEach(t=>{t[n]=i})})},applyGlobalBorder(t,e){const o=e.cols,n=e.prop,i=e.value;o.forEach(t=>{t.style.border.top[n]=i,t.style.border.right[n]=i,t.style.border.bottom[n]=i,t.style.border.left[n]=i})},activeLeftTab(t,e){t.leftActiveTab=e},activeRightTab(t,e){t.rightActiveTab=e},updateDesign(t,e){t.design=e,t.design}}),actions:Object(Q["a"])({},Il.actions,Ll.actions,Pl.actions,Xl.actions,{activeRightTab(t,e){let o=t.state,n=t.commit;o.rightActiveTab!=e&&n("activeRightTab",e)},setGlobalStyle(t,e){t.commit("updateGlobalStyleProp",e),t.commit("applyGlobalStyle",Object(Q["a"])({cols:t.getters.allCol},e,{shuttle:!0}))},setGlobalBorder(t,e){t.commit("updateGlobalBorder",e),t.commit("applyGlobalBorder",Object(Q["a"])({cols:t.getters.allCol},e,{shuttle:!0}))},setAllBorderType(t,e){const o=e.type,n=e.borderWidth,i="bordertype-"+ +new Date;t.commit("updateGlobalStyleProp",{prop:"allBorderType",value:o,group:i,shuttle:!0}),Kl(t,o,n,i)}})});function Kl(t,e,o,n){const i=t.getters.allCol;return"all"==e?t.commit("setAllColBorderWidth",{cols:i,group:n,borderWidth:o}):"none"==e?t.commit("setAllColBorderWidth",{cols:i,group:n,borderWidth:0}):void t.commit("setAllColBorder_"+e,{cols:i,group:n,borderWidth:o})}var Ql=o("adb5"),Zl=o("2fdd");o("8e1f"),o("64d2");window.jsoncParse=Zl["a"],U.a.props.model=[Object,Array];const tr=q["default"].extend({extends:W.a,mounted:function(){this.$el&&!this.$el.title&&this.label&&this.label.length>10&&this.$el.setAttribute("title",this.label)}});q["default"].prototype.$bus=new q["default"],q["default"].prototype.$httpGet=Ql["a"],q["default"].prototype.$httpPost=Ql["b"],q["default"].prototype.$message=N.a,q["default"].prototype.$confirm=F.a.confirm,q["default"].config.productionTip=!1,q["default"].component("draggable",Ha.a),q["default"].component(P.a.name,P.a),q["default"].component(R.a.name,R.a),q["default"].component(j.a.name,j.a),q["default"].component(L.a.name,L.a),q["default"].component(E.a.name,E.a),q["default"].component($.a.name,$.a),q["default"].component(T.a.name,T.a),q["default"].component(W.a.name,tr),q["default"].component(D.a.name,D.a),q["default"].component(x.a.name,x.a),q["default"].component(C.a.name,C.a),q["default"].component(U.a.name,U.a),q["default"].component(v.a.name,v.a),q["default"].component(g.a.name,g.a),q["default"].component(N.a.name,N.a),q["default"].component(f.a.name,f.a),q["default"].component(h.a.name,h.a),q["default"].component(d.a.name,d.a),q["default"].component(r.a.name,r.a),q["default"].component(s.a.name,s.a),q["default"].component(i.a.name,i.a),q["default"].use(El.a),new q["default"]({store:Yl,render:t=>t($l)}).$mount("#app")},"587e":function(t,e,o){},"58d3":function(t,e,o){"use strict";var n=o("1728"),i=o.n(n);i.a},5908:function(t,e,o){"use strict";var n=o("301b"),i=o.n(n);i.a},"64a9":function(t,e,o){},"6f10":function(t,e,o){"use strict";var n=o("9048"),i=o.n(n);i.a},"82ad":function(t,e,o){},"89c5":function(t,e,o){},"8e1f":function(t,e,o){},9048:function(t,e,o){},9789:function(t,e,o){},9827:function(t,e,o){"use strict";o.d(e,"d",function(){return l}),o.d(e,"b",function(){return r}),o.d(e,"a",function(){return c});o("ac6a");class n{constructor(){this.store={}}_get(t){if(!t)throw new Error("type is required!");return this.store[t]?++this.store[t]:this.store[t]=1}adaptProp(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.store[t]?this.store[t]+=e:this.store[t]=e}}class i extends n{constructor(){super()}getIndex(t){return this._get("control-"+t)}adapt(t){if(Array.isArray(t)){const e={};t.forEach(t=>{const o=t.type,n=t.autoIndex||this.getIndex(o);e[o]?e[o]=Math.max(n,e[o]):e[o]=n});for(let t in e)this.adaptProp("control-"+t,e[t])}}}class a extends n{constructor(){super()}getIndex(t){return this._get("col-"+t)}adapt(t){Array.isArray(t)&&t.forEach(t=>{t.cols.forEach(e=>{this.adaptProp("col-"+t.id),e.subs&&e.subs.length&&this.adapt(e.subs)})})}}class s extends n{constructor(){super()}getIndex(t){return this._get("row-"+t)}adapt(t){if(Array.isArray(t)){const e={};t.forEach(t=>{const o=t.namePrefix||t.name||"行",n=t.autoIndex||this.getIndex(o);e[o]?e[o]=Math.max(n,e[o]):e[o]=n});for(let t in e)this.adaptProp("control-"+t,e[t])}}}const l=new s,r=new i,c=new a;window.rowAutoIndex=l,window.controlAutoIndex=r,window.colAutoIndex=c,e["c"]={row:l,control:r,col:c}},"9d87":function(t,e,o){},adb5:function(t,e,o){"use strict";o.d(e,"a",function(){return i}),o.d(e,"b",function(){return a});o("ac6a");function n(t){return t.custom&&(t=t.custom,"string"==typeof t&&(t=JSON.parse(t))),t}function i(t,e,o){return new Promise(function(i,a){var s=new XMLHttpRequest;s.onreadystatechange=function(){if(s.readyState===XMLHttpRequest.DONE)if(200===s.status)try{i(e?s.responseText:n(JSON.parse(s.responseText)))}catch(t){console.error(t),i(s.responseText)}else a("There was a problem with the request.")},s.open("GET",t),o&&Object.keys(o).forEach(t=>{s.setRequestHeader(t,o[t])}),s.send()})}function a(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;return new Promise(function(i,a){var s=new XMLHttpRequest;s.onreadystatechange=function(){if(s.readyState===XMLHttpRequest.DONE)if(200===s.status)try{i(n(JSON.parse(s.responseText)))}catch(t){console.error(t),i(s.responseText)}else a({state:s.status})},s.open("POST",t),s.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8"),o&&Object.keys(o).forEach(t=>{s.setRequestHeader(t,o[t])});const l=new URLSearchParams;for(let t in e)l.append(t,"object"==typeof e[t]?JSON.stringify(e[t]):e[t]);s.send(l)})}},ae24:function(t,e,o){},aeeb:function(t,e,o){"use strict";var n=o("587e"),i=o.n(n);i.a},af23:function(t,e,o){},b020:function(t,e,o){"use strict";var n=o("d466"),i=o.n(n);i.a},b6d4:function(t,e,o){},b8b5:function(t,e,o){"use strict";var n=o("ae24"),i=o.n(n);i.a},bec5:function(t,e,o){"use strict";var n=o("3a3a"),i=o.n(n);i.a},c8eb:function(t,e,o){},d466:function(t,e,o){},d482:function(t,e,o){"use strict";var n=o("af23"),i=o.n(n);i.a},d56b:function(t,e,o){"use strict";var n=o("c8eb"),i=o.n(n);i.a},d58f:function(t,e,o){},d5c7:function(t,e,o){"use strict";var n=o("eaff"),i=o.n(n);i.a},eaff:function(t,e,o){},ec83:function(t,e,o){"use strict";var n=o("d58f"),i=o.n(n);i.a},f1a3:function(t,e,o){"use strict";var n=o("9789"),i=o.n(n);i.a},f5bd:function(t,e,o){"use strict";var n=o("469a"),i=o.n(n);i.a}});