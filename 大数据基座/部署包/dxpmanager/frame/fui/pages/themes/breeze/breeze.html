<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title></title>
    <script src="../../../js/cssboot.js"></script>
</head>

<body>
    <div class="breeze-body">
        <!-- 内容区 -->
        <div class="surface">
            <!-- 左侧菜单 -->
            <div class="surface-menu l no-search" id="menu">
                <div class="logo">
                    <img src="images/logo.png" id="logo-img" alt="logo">
                </div>
                <div class="search">
                    <div class="search-container relative" id="search-container">
                        <span class="search-btn"></span>
                        <div class="search-wrap" id="header-search"></div>
                    </div>
                </div>
                <div class="menu-contain relative" id="menu-contain">
                    <!-- 一级菜单 -->
                    <div class="sidebar-main">
                        <ul id="top-menu"></ul>
                    </div>
                    <!-- 二级菜单 -->
                    <div class="sidebar-popup" id="sidebar-popup">
                        <a class="popup-name" href="javascript:;">
                            <div class="text-name-contain popup-title text-ellipsis"><span class="text-name" id="popup-title" title=""></span></div>
                        </a>
                        <div class="second-warp">
                            <ul id="second-menu"></ul>
                        </div>
                    </div>
                </div>
                <div class="menu-btns">
                    <div class="l quick-btns">
                        <i class="icons-quick relative" id="icon-quick"></i>
                    </div>
                    <div class="l quick-btns">
                        <span class="text-name">快捷菜单</span>
                    </div>
                    <div class="r icons icons-trigger active" id="icons-trigger"></div>
                </div>
            </div>
            <!-- 右侧功能区 -->
            <div class="surface-main showtab l" id="surface-main">
                <!-- 右侧头部 -->
                <div class="surface-header" id="header">
                    <!-- 固定头部 -->
                    <div class="fix-header clearfix">
                        <i class="icons l change-tab"></i>
                        <span class="c-dark" id="current-title">我的桌面</span>

                        <!-- 右侧多图标 -->
                        <div class="r" id="top-icons">
                            <div class="l icons icons-emsg js-panel  relative" data-ref="msgRemind">
                                <span class="tip-num hidden fz-12"></span>
                            </div>
                            <div class="l icons icons-chat js-panel relative" data-ref="msgEMsg">
                                <span class="tip-num hidden fz-12"></span>
                            </div>
                            <div class="l icons icons-theme" id="themes-btn"></div>
                            <div class="l user-info relative" id="user-info">
                                <div class="user-info-summary">
                                    <img src="./images/header/user.png" alt="" class="user-portrait">
                                </div>
                                <div class="user-action-panel">
                                    <div class="user-action-panel-inner">
                                        <div class="user-info-detail" id="user-info-detail">
                                            <img src="./images/header/user.png" alt="" class="user-portrait">
                                            <span class="user-name"></span>
                                            <span class="user-dept"></span>
                                        </div>
                                        <ul class="user-action-list">
                                            <li class="user-action-item person-info" data-id="person-info-setting" id="person-info-setting"
                                                data-name="个人信息维护" title="个人信息维护" data-url="frame/pages/basic/personalset/personalinfo/personalinfo.html">个人信息维护</li>
                                            <li class="user-action-item role-change hidden" data-id="user-role-change"
                                                data-name="兼职切换" title="兼职切换">兼职切换</li>
                                            <!-- 此处扩展时添加 li 即可 -->
                                            <!-- <li class="user-action-item css样式类需定义图标" title="显示的名字"  url="要打开的链接地址" data-opentype="打开方式 tabsnav/dialog/blank之一" data-id="一个标识，请勿重复，可以不配置自动生成生成" script="如果打开一个链接不能满足需求，可以在此配置一段js脚本，将在点击时执行，配置url后此项无效" >显示的名字</li> -->
                                            <!-- 扩展demo -->
                                            <li class="user-action-item logout" title="注销登录">注销登录</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- tab区域 -->
                    <div class="tabs relative" id="tabs">
                    </div>
                </div>
                <!-- 右侧内容区 -->
                <div class="surface-content" id="surface-content">
                    <!-- 遮罩 -->
                    <div class="main-content-cover-container" id="page-cover"></div>
                </div>
            </div>
        </div>
        <!-- 右侧滑动区 -->
        <div id="msg-panel" class="msg-panel hidden">
            <!-- 消息 -->
            <div id="msgRemind" class="msg-panel-detail js-detail">
                <h2 class="msg-panel-head">消 &nbsp; 息
                    <i class="msg-panel-hide"></i>
                </h2>
                <div class="msg-panel-content">
                </div>
            </div>
            <!-- E讯 -->
            <div id="msgEMsg" class="msg-panel-detail">
                <h2 class="msg-panel-head tab">
                    <span class="panel-hd-tab active">E讯提醒</span>
                    <span class="panel-hd-tab hidden" data-ref="online-user">在线人员(<span class="online-user-num">0</span>)</span>
                    <i class="msg-panel-hide"></i>
                </h2>
                <div class="msg-panel-content">
                    <ul class="emsg-recent-list empty"></ul>
                    <iframe id="online-user" class="emsg-online-user hidden" width="100%" height="100%" frameborder="0"></iframe>
                </div>
            </div>
        </div>
    </div>

    <!-- 声音提示 js动态添加IE加载iframe 非IE使用audio -->
    <div id="msg-sound"></div>

    <script src="../../../../../rest/resource/jsboot"></script>
    <script>
        SrcBoot.output([
            'frame/fui/js/widgets/classifysearch/classifysearch.js',
            'frame/fui/js/widgets/msgcenter/msgcenter.js',
            'frame/fui/js/widgets/epcontextmenu/epcontextmenu.js',
            'frame/fui/js/widgets/epTabsNav/epTabsNav.js'
        ]);
    </script>

    <script>
        var EmsgConfig = {
            baseUrl: epoint.dealRestfulUrl('exundataaction/eXun'),
            treeUrl: epoint.dealRestfulUrl("exundataaction/getTree"),
            websocketUrl: "../../../../../websocket/eXun",
            historyUrl: "frame/pages/basic/communication/exun/exunmsg",
            groupImg: "../../emsg/images/emsg-group-bg.png",
            userImg: "../../emsg/images/emsg-user-error.jpg",
            // 发送邮件的地址，如果配置了将显示E讯窗口上方显示发送邮件 经在URL后自动拼接收件人guid，多个以“;”分隔
            // 约定 如果有多人，参数名为ToUserGuidList 一个人则参数名为ToUserGuid
            sendEmailUrl: '',
            showErrorMsg: true
        };

        // 用户配置
        var UserSettings = {
            logout: function () {
                // 已经默认做了是否退出的提醒，确定后才会调用此函数
                window.location.href = Util
                    .getRightUrl('rest/logout?isCommondto=true');
            },
            // 兼职切换处理函数
            changeRole: function (userGuid) {
                // 未做提醒 逻辑需要自己实现
                // 参数为后端返回的userGuid
                var url = "frame/pages/login/switchparttime?userguid=" + userGuid;
                epoint.openDialog("账号选择", url, function (result) {
                    if (result == 'success') {
                        window.location.reload();
                    }
                }, {
                    'width': 850,
                    'height': 350
                });
            }
        };
        var DEFAULT_LOGO_URL = './images/logo.png';

        // 获取数据的通用请求地址，后面直接+/方法名即可
        var getDataUrl = 'themedataaction';
        // 主题获取
        var getPagesUrl = epoint.dealRestfulUrl(getDataUrl + '/getAllPage');
        // 主题保存
        var savePageUrl = epoint.dealRestfulUrl(getDataUrl + '/setAsDefault');
        // 搜索相关的配置
        var _searchCfg = {
            // 用户模块搜索
            userModuleSearchUrl: 'fullsearchaction/getFrameInformation',

            // 实时搜索到的用户的点击处理函数 参数为人员guid name
            userClick: function (userGuid, userName) {
                epoint.openDialog('人员详情', Util.getRightUrl('frame/pages/basic/communication/businesscard/innerdetail.html?uid=' + userGuid), function () {}, {
                    width: 800,
                    height: 380
                });
            },
            // 全文检索分类
            fullSearchCateUrl: epoint.dealRestfulUrl('fullsearchaction/getftsSystem')
        };
        var onlineUserIframe = document.getElementById('online-user');
        var OnlineUserSettings = {
			// 是否显示
			show: true,
			// 对应页面地址
			url: '../../../../../framemanager/orga/orga/user/onlineuser',
			// 每次显示E讯面板时都会触发该方法
			onRefreshData: function (callback) {
				// 调用在线人员页面中的刷新数据方法
				// 同时tab上的在线人数需要更新，但考虑到获取数据是异步操作，所以需要在refreshData方法中获取到在线人数后调用callback方法
				try {
					onlineUserIframe.contentWindow.refreshData(callback);
				} catch (e) {
					console.error(e);
				}

			}
        };
        // 消息中心配置
        var MsgCenterConfig = {
            "typeListUrl": epoint.dealRestfulUrl(getDataUrl +
				'/getTypeListUrl'), // 类型接口
			"msglistUrl": epoint.dealRestfulUrl(getDataUrl + '/getMsglistUrl'), // 右侧列表接口
			"markToReadUrl": epoint.dealRestfulUrl(getDataUrl +
				'/markToReadUrl'), // 标记为已读接口，多个用逗号隔开
			"deleteUrl": epoint.dealRestfulUrl(getDataUrl + '/deleteUrl'), // 删除接口, 类型为all表示删除所有，不然直接传id，多个逗号隔开
			"msgTipsUrl": epoint.dealRestfulUrl(getDataUrl + '/getMsgTipsUrl')
			// 消息提醒接口，返回各个类别的数据和总数
        }

        //消息中心高级设置
        var MsgCenterSetting = {
            getMessageSettingUrl: epoint
				.dealRestfulUrl('mypagesettingaction/getMessageSetting'), // 获取参数数据
			saveMessageSettingUrl: epoint
				.dealRestfulUrl('mypagesettingaction/saveMessageSetting')
        };
        //底部任务栏配置
        var tabsNavConfig = {
            ifrContainer: '#surface-content', //内容父容器
            tabsContainer: '#tabs', //任务栏容器
            refreshTab: true, //是否刷新内容页的表格，注意：如果需要个性化刷新，则这个必须为true(个性化刷新方法见下方说明)
            scroller: true, //是否显示任务栏两侧点击按钮
            scrollerSite: 'sides', //点击按钮的位置，两侧：'sides',右侧：'right'。仅在showButtons 为true时有效
            onSelect: function (opt) { // 是否在选中tab 时调用回调方法
                $('#current-title').text(opt.name);;
            },
            dropList: false
        };
    </script>

    <script>
        var path = [
            'frame/fui/pages/themes/breeze/breeze' + (SrcBoot.debug ? '' : '.min') + '.js'
        ];
        SrcBoot.output(path);
    </script>
</body>

</html>