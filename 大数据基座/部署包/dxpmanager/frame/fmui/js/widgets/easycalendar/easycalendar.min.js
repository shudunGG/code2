!function(){"use strict";function t(t){if(!t.el)throw new Error("请传入正确的容器元素");this.el=this.getHTMLElement(t.el),this.cls=t.cls||"",this.loadTpl(),this.showDateEl=this.getHTMLElement("[data-title=date]"),this.tableBodyEl=this.getHTMLElement("[data-body=body]"),this.leftBtnEl=this.getHTMLElement("[data-type=leftbtn]"),this.rightBtnEl=this.getHTMLElement("[data-type=rightbtn]"),this.itemClick="function"==typeof t.itemClick?t.itemClick:function(){},this._addEvent()}var e=['<div class="ui-datepicker-header">','    <a href="javascript:void(0);" class="ui-datepicker-btn ui-datepicker-prev-btn" data-type="leftbtn">&lt;</a>','    <a href="javascript:void(0);" class="ui-datepicker-btn ui-datepicker-next-btn" data-type="rightbtn">&gt;</a>','    <span class="ui-datepicker-curr-month" data-title="date"></span>',"</div>",'<div class="ui-datepicker-body">',"    <table>","        <thead>","            <tr>","                <th>一</th>","                <th>二</th>","                <th>三</th>","                <th>四</th>","                <th>五</th>","                <th>六</th>","                <th>日</th>","            </tr>","        </thead>",'        <tbody data-body="body"></tbody>',"    </table>","</div>"].join("");t.prototype={createCalendar:function(t,e,a){var n=this.getNowDay();t||(t=n.getFullYear()),a||(a=n.getDate()),void 0===e?e=n.getMonth():(e-=1,e<0?e=11:e>11&&(e=0));var i=new Date(t,e,1),r=i.getFullYear(),l=i.getMonth()+1,d=i.getDay(),s=new Date(t,e,0),h=s.getFullYear(),o=s.getMonth()+1,c=s.getDate(),y=new Date(t,e+1,0),u=y.getDate(),g=new Date(t,e+1,1),p=g.getFullYear(),f=g.getMonth()+1;if(a>u)throw new Error("当前传入天数，超出本月应有天数，本月只有："+u+"天");0===d&&(d=7);for(var m=d-1,v=[],b=0,E=0,T=0,C="",D="",w=0,L=0,M=42;L<M;L++)w=L-m,w<0&&(b=h,E=o,T=c+w+1,C="exceed"),w>=0&&w<u&&(b=r,E=l,T=w+1,C=""),w>=u&&(b=p,E=f,T=w-u+1,C="exceed"),D=E===l&&b===r&&T===a?this.cls:"",v.push({year:b,month:E,day:T,cls:C,dayCls:D});this.showDateEl.innerHTML=r+"-"+this.appendZero(l),this.year=r,this.month=l,this.day=a,this._renderCalendar(v)},_renderCalendar:function(t){for(var e="",a=1,n=t.length;a<=n;a++){var i=t[a-1];e+=1===a?'<tr><td class="'+i.cls+" "+i.dayCls+'" data-year="'+i.year+'" data-month="'+i.month+'">'+i.day+"</td>":a%7===0?'<td class="'+i.cls+" "+i.dayCls+'" data-year="'+i.year+'" data-month="'+i.month+'">'+i.day+"</td></tr><tr>":'<td class="'+i.cls+" "+i.dayCls+'" data-year="'+i.year+'" data-month="'+i.month+'">'+i.day+"</td>"}this.tableBodyEl.innerHTML=e},getCalendarData:function(){return{year:this.year.toString(),month:this.month.toString(),day:this.day.toString()}},_addEvent:function(){var t=this._handleTriggerDate.bind(this),e=this,a=this.cls;this.leftBtnEl.addEventListener("tap",function(){t(this,"-")}),this.rightBtnEl.addEventListener("tap",function(){t(this,"+")}),this.tableBodyEl.addEventListener("tap",function(t){var n=t.target,i=e.month;if("TD"===n.tagName){a&&(n.classList.add(a),e.removeSiblingsCls(n,a));var r=n.dataset.year,l=n.dataset.month,d=n.innerHTML;e.itemClick.call(n,{year:r,month:l,day:n.innerHTML}),(l>i||l<i)&&e.createCalendar(r,l,parseInt(d,10))}})},removeSiblingsCls:function(t,e){var a=[].slice.call(this.tableBodyEl.querySelectorAll("td"));a.forEach(function(a,n){a!==t&&a.classList.remove(e)})},_handleTriggerDate:function(t,e){var a=this.month,n=this.year,i=t.style;i.paddingTop="1px",setTimeout(function(){i.paddingTop=0},100),"+"===e?a++:"-"===e&&a--,a<=0?n--:a>12&&n++,this.createCalendar(n,a)},appendZero:function(t){return t<10?"0"+t:t},showCalendar:function(){this.el.style.display="block"},hideCalendar:function(){this.el.style.display="none"},toggleCalendar:function(){var t=this.el.style;"none"===t.display?t.display="block":t.display="none"},getNowDay:function(){return new Date},loadTpl:function(){this.el.innerHTML=e},getHTMLElement:function(t){var e=this.el&&1===this.el.nodeType?this.el:document;return 1!==t.nodeType?e.querySelector(t):t}},window.EasyCalendar=t}();