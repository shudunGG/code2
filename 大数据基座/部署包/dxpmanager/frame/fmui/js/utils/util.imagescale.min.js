!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):t.imageScale=i()}(window.Util,function(){"use strict";function t(t,i,a,e,r,o){for(var n=r/i,h=o/a,d=e,f=function(e,o){var f=Math.min(i-1,e/n),c=Math.min(a-1,o/h),v=Math.floor(f),u=Math.floor(c),g=o*r+e,m=u*i+v;g*=4,m*=4;for(var l=0;l<=3;l+=1)d[g+l]=t[m+l]},c=0;c<r;c+=1)for(var v=0;v<o;v+=1)f(c,v)}function i(i,a){return t(i.data,i.width,i.height,a.data,a.width,a.height),a}function a(t,i,a,e,r){var o=e,n=r;o>=a?o=a-1:o<0&&(o=0),n>=i?n=i-1:n<0&&(n=0);var h=o*i+n;return h*=4,[t[h+0],t[h+1],t[h+2],t[h+3]]}function e(t,i,e,r,o,n){for(var h=o/i,d=n/e,f=r,c=function(r,n){var c=Math.min(i-1,r/h),v=Math.min(e-1,n/d),u=Math.floor(c),g=Math.floor(v),m=c-u,l=v-g,s=1-m,w=1-l,M=n*o+r;M*=4;for(var p=a(t,i,e,g+0,u+0),x=a(t,i,e,g+0,u+1),R=a(t,i,e,g+1,u+0),S=a(t,i,e,g+1,u+1),y=0;y<=3;y+=1){var I=l*(s*R[y]+m*S[y]),k=w*(s*p[y]+m*x[y]);f[M+y]=I+k}},v=0;v<o;v+=1)for(var u=0;u<n;u+=1)c(v,u)}function r(t,i){return e(t.data,t.width,t.height,i.data,i.width,i.height),i}function o(t,i,a,e,r,o){for(var n=e,h=r/i,d=o/a,f=function(e,o){var f=Math.min(i-1,e/h),c=Math.min(a-1,o/d),v=Math.floor(f),u=Math.floor(c),g=f-v,m=c-u,l=o*r+e;l*=4;for(var s=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],w=0;w<=3;w+=1){for(var M=-1;M<=2;M+=1)for(var p=-1;p<=2;p+=1)s[M+1][p+1]=W(t,i,a,u+M,v+p,w);E(s),n[l+w]=B(O(m,g))}},c=0;c<r;c+=1)for(var v=0;v<o;v+=1)f(c,v)}function n(t,i){return o(t.data,t.width,t.height,i.data,i.width,i.height),i}function h(t){var i=t>=0?t:-t,a=t*t,e=i*a;return i<=1?1-(j+3)*a+(j+2)*e:i<=2?-4*j+8*j*i-5*j*a+j*e:0}function d(t){var i=t;return i=Math.min(255,i),i=Math.max(0,i)}function f(t,i,a,e,r){var o=e,n=r;o>=a?o=a-1:o<0&&(o=0),n>=i?n=i-1:n<0&&(n=0);var h=o*i+n;return h*=4,[t[h+0],t[h+1],t[h+2],t[h+3]]}function c(t,i,a,e,r,o){for(var n=e,c=r/i,v=o/a,u=function(e,o){var u=Math.min(i-1,e/c),g=Math.min(a-1,o/v),m=Math.floor(u),l=Math.floor(g),s=u-m,w=g-l,M=o*r+e;M*=4;for(var p=[0,0,0,0],x=-1;x<=2;x+=1)for(var R=-1;R<=2;R+=1){var S=f(t,i,a,l+x,m+R),y=h(x-w),I=h(R-s),k=y*I;p[0]+=S[0]*k,p[1]+=S[1]*k,p[2]+=S[2]*k,p[3]+=S[3]*k}n[M+0]=d(p[0]),n[M+1]=d(p[1]),n[M+2]=d(p[2]),n[M+3]=d(p[3])},g=0;g<r;g+=1)for(var m=0;m<o;m+=1)u(g,m)}function v(t,i){return c(t.data,t.width,t.height,i.data,i.width,i.height),i}function u(t){for(var i=t,a=arguments.length,e=Array(a>1?a-1:0),r=1;r<a;r++)e[r-1]=arguments[r];return e.forEach(function(t){t&&Object.keys(t).forEach(function(a){i[a]=t[a]})}),i}function g(t){function a(t){var i=t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1,a=(window.devicePixelRatio||1)/i;return a}var e=t;e.scaleImageData=function(t,a,e){var o=u({},z,e),h=[i,r,n,v],d=h[o.processType];d(t,a)},e.scaleImage=function(t,i){var a=t.width,r=t.height,o=u({},z,i),n=document.createElement("canvas"),h=n.getContext("2d");n.width=a,n.height=r,h.drawImage(t,0,0,a,r);var d=h.getImageData(0,0,a,r),f=h.createImageData(o.width,o.height);return e.scaleImageData(d,f,o),n.width=f.width,n.height=f.height,h.putImageData(f,0,0,0,0,n.width,n.height),n.toDataURL(o.mime,.9)},e.compressImage=function(t,i){var e=t.width,r=t.height,o=e/r,n=u({},q,i),h=document.createElement("canvas"),d=h.getContext("2d"),f=a(d);f*=n.compressScaleRatio||1,navigator.userAgent.match(/(iPhone\sOS)\s([\d_]+)/)&&(f*=n.iphoneFixedRatio||1);var c=window.innerWidth*f;(n.isUseOriginSize||c>e)&&(c=e);var v=n.maxWidth;v&&e>v&&c>v&&(c=v);var g=n.forceWidth,m=n.forceHeight;g&&(c=g);var l=c/o;return m&&(l=m),h.width=c,h.height=l,d.drawImage(t,0,0,e,r,0,0,h.width,h.height),h.toDataURL(n.mime,n.quality)}}var m=void 0,l=void 0,s=void 0,w=void 0,M=void 0,p=void 0,x=void 0,R=void 0,S=void 0,y=void 0,I=void 0,k=void 0,P=void 0,D=void 0,b=void 0,U=void 0,W=function(t,i,a,e,r,o){var n=e,h=r;n>=a?n=a-1:n<0&&(n=0),h>=i?h=i-1:h<0&&(h=0);var d=n*i+h;return d*=4,t[d+o]},B=function(t){var i=t;return i=Math.min(255,i),i=Math.max(0,i)},E=function(t){var i=t;m=i[1][1],l=-.5*i[1][0]+.5*i[1][2],s=i[1][0]-2.5*i[1][1]+2*i[1][2]-.5*i[1][3],w=-.5*i[1][0]+1.5*i[1][1]-1.5*i[1][2]+.5*i[1][3],M=-.5*i[0][1]+.5*i[2][1],p=.25*i[0][0]-.25*i[0][2]-.25*i[2][0]+.25*i[2][2],x=-.5*i[0][0]+1.25*i[0][1]-i[0][2]+.25*i[0][3]+.5*i[2][0]-1.25*i[2][1]+i[2][2]-.25*i[2][3],R=.25*i[0][0]-.75*i[0][1]+.75*i[0][2]-.25*i[0][3]-.25*i[2][0]+.75*i[2][1]-.75*i[2][2]+.25*i[2][3],S=i[0][1]-2.5*i[1][1]+2*i[2][1]-.5*i[3][1],y=-.5*i[0][0]+.5*i[0][2]+1.25*i[1][0]-1.25*i[1][2]-i[2][0]+i[2][2]+.25*i[3][0]-.25*i[3][2],I=i[0][0]-2.5*i[0][1]+2*i[0][2]-.5*i[0][3]-2.5*i[1][0]+6.25*i[1][1]-5*i[1][2]+1.25*i[1][3]+2*i[2][0]-5*i[2][1]+4*i[2][2]-i[2][3]-.5*i[3][0]+1.25*i[3][1]-i[3][2]+.25*i[3][3],k=-.5*i[0][0]+1.5*i[0][1]-1.5*i[0][2]+.5*i[0][3]+1.25*i[1][0]-3.75*i[1][1]+3.75*i[1][2]-1.25*i[1][3]-i[2][0]+3*i[2][1]-3*i[2][2]+i[2][3]+.25*i[3][0]-.75*i[3][1]+.75*i[3][2]-.25*i[3][3],P=-.5*i[0][1]+1.5*i[1][1]-1.5*i[2][1]+.5*i[3][1],D=.25*i[0][0]-.25*i[0][2]-.75*i[1][0]+.75*i[1][2]+.75*i[2][0]-.75*i[2][2]-.25*i[3][0]+.25*i[3][2],b=-.5*i[0][0]+1.25*i[0][1]-i[0][2]+.25*i[0][3]+1.5*i[1][0]-3.75*i[1][1]+3*i[1][2]-.75*i[1][3]-1.5*i[2][0]+3.75*i[2][1]-3*i[2][2]+.75*i[2][3]+.5*i[3][0]-1.25*i[3][1]+i[3][2]-.25*i[3][3],U=.25*i[0][0]-.75*i[0][1]+.75*i[0][2]-.25*i[0][3]-.75*i[1][0]+2.25*i[1][1]-2.25*i[1][2]+.75*i[1][3]+.75*i[2][0]-2.25*i[2][1]+2.25*i[2][2]-.75*i[2][3]-.25*i[3][0]+.75*i[3][1]-.75*i[3][2]+.25*i[3][3]},O=function(t,i){var a=t*t,e=a*t,r=i*i,o=r*i;return m+l*i+s*r+w*o+(M+p*i+x*r+R*o)*t+(S+y*i+I*r+k*o)*a+(P+D*i+b*r+U*o)*e},j=-1,z={width:80,height:80,mime:"image/png",processType:1},q={quality:.92,mime:"image/jpeg",compressScaleRatio:1,iphoneFixedRatio:1.5,isUseOriginSize:!1,maxWidth:0,forceWidth:0,forceHeight:0},A={};return g(A),A});