<!DOCTYPE html>
<html lang="zh-CN">

<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />
<title></title>
<script src="../../../frame/fui/js/cssboot.js"></script>
<script>
	SrcBoot.output([ "../../dataintegration/css/common.css",
			"../../css/common.css", "../../dataintegration/css/mission.css",
			"../../dataintegration/css/mission_node.css" ]);
</script>
<style>
.search-button {
	margin: 6px 14px 0 6px;
}

.search-input {
	margin: 6px 15px 0 0;
}

.work-name {
	margin-top: -8px;
}

.top {
	padding-left: 13px;
}
</style>
</head>

<body>
	<div class="main">
		<div class="top">
			<a href="javascript:void(0);" onclick="back();" class="back l">返回</a>
			<div class="r">
				<div class="fui-form" id="fui-form">
					<div role="form">
						<p class="l work-name">积压量：</p>
						<select id="data-choose" class="search-input">
							<option value=""></option>
							<option value="0-100">&lt;100</option>
							<option value="100-500">100&ndash;500</option>
							<option value="500-1000">500&ndash;1000</option>
							<option value="1000-10000">1000&ndash;10000</option>
							<option value="10000-">&gt;10000</option>
						</select>
						<p class="l work-name">topic名称：</p>
						<input class="search-input" placeholder="请输入关键词" id="search"
							type="text"> <a class="search-button btn"
							href="javascript:void(0);" onclick="searchData();">搜索</a> <input
							id="groupName" class="mini-textbox" bind="groupName"
							style="display: none;" /> <input id="backlog"
							class="mini-textbox" bind="backlog" style="display: none;" />
					</div>
				</div>
			</div>
		</div>
		<div class="content clearfix mini-fit">
			<div id="datagrid" name="datagrid" class="mini-datagrid"
				idField="rowguid" multiSelect="true" action="getDataGridModel"
				;
				style="width: 100%; height: 100%" showPager="true">
				<div property="columns">
					<div type="indexcolumn" width="20" headerAlign="center">序</div>
					<div field="groupname" headerAlign="center" align="center">消费组</div>
					<div field="backlog" headerAlign="center" align="center">待消费数量</div>
					<div field="consumecount" headerAlign="center" align="center">已消费数量</div>
					<div field="latesttime" headerAlign="center" align="center"
						data-options="{'format': 'yyyy-MM-dd HH:mm:ss'}">最后消费的消息的时间</div>
					<div headerAlign="center" align="center" renderer="onOptRender">操作</div>
				</div>
			</div>

		</div>
	</div>
	<script src="../../../rest/resource/jsboot"></script>
	<script>
		epoint.initPage('dxpkafkagroupmonitoraction');

		function back() {
			Util.getSafeLocation().setHref('dxpkafkatopicmonitor');
		}

		function searchData() {
			epoint.refresh([ 'datagrid', 'fui-form' ]);
		}

		var $dataChoose = $("#data-choose");
		$dataChoose.bind('change', function() {
			mini.get('backlog').setValue($dataChoose.val());
		});

		$('#search').bind('input propertychange', function() {
			mini.get('groupName').setValue($('#search').val());
		}).bind('keyup', function(event) {
			if (event.keyCode == "13") {
				searchData();
			}
		});

		function onOptRender(e) {
			return '<a href="javascript:void(0);" onclick="resetOffset(' + "'"
					+ e.row.rowguid + "'" + ');" >' + '重置消费位点' + '</a>';
		}

		function resetOffset(rowguid) {
			epoint.openDialog("重置消费位点",
					'dxp/kafka/monitor/dxpkafkagroupresetoffset?groupGuid='
							+ rowguid, function() {
						searchData();
					}, {
						'width' : 800,
						'height' : 600
					});
		}
	</script>
</body>

</html>