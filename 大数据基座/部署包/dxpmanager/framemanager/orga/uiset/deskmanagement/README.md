# 我的桌面元件管理可视化配置页面数据接口

目前可视化配置页面规划如下。

- 页面行数不限，可以一直往下排布。列数限制为8列。

- 元件按行规划，同一行内的元件高度应该一致，即`rowspan`值相同。

- 一个元件最多跨2行，最多跨8列。

- 某用户某元件无权限时，在展示页面将不显示此元件，当前行内的其他元件自动按比例占据此元件空出的区域。

## 初始化数据

由于元件按行规划，整体数据为一个数组，数组内的每个元素仍为一个数组，表示一行，行内元素为每个元件的数据。

数据格式可参考`./test/data.json`

## 新增元件

点击头部的新增按钮，弹出新增元件的页面，返回数据应如下所示：

```json
{
    "code": "@id", // 元件id
    "name": "@cword(3,8)", // 元件名称
    "url": "@url" // 元件内嵌ifrma的地址。
}
```

## 从禁用中挑选元件

返回数据为：

```json
[
    {
        "code": "@id", // 元件id
        "name": "@cword(3,8)", // 元件名称
        "url": "@url" // 元件内嵌ifrma的地址。
    },
    {},
    {},...
]
```

## 删除元件

点击从禁用元件的处理地址 参数 {id:'元件guid',query:'desabled-elem'}

## 元件的权限管理

将打开元件的权限管理页面，进行操作，具体可在页面上的进行指定：

```js
// 权限管理点击处理函数
var settingsFn = function () {
    var elemId = $(this).closest('.elem-item').data('id');

    epoint.openDialog('权限管理', 'xxxurl?elemId = ' + elemId);
};
```

## 保存元件

可视化配置页面中，点击元件名称和其url可对其名称和url进行修改。同时可以拖动元件调整位置和大小，但是这些操作都**不会立即保存**。位置信息和其他信息的修改将一次在保存时进行提交。

保存元件前会验证元件数据，不符合会给出提醒，对闪动不符合条件的两个元件。

若验证通过，提交数据格式如下：

```json
[   
    // 第一行元件
    [
        {
            "code": "110000198603016282",
            "name": "桌面元件1",
            "url": "https://www.baidu.com/",
            "col": 1, // 元件所在列 1开始
            "row": 1, // 元件所在行 1 开始
            "rowspan": 1, // 元件跨行数目
            "colspan": 2 // 元件跨列数目
        },
        {},
        {},
        ...
    ],
    // 第二行元件
    [{},{},...],
    ...
]
```